using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using System.IO;
using Oracle.DataAccess.Client;
using FF.BusinessObjects.Sales;
using FF.BusinessObjects;
using FF.BusinessObjects.General;
using FF.BusinessObjects.InventoryNew;
using FF.BusinessObjects.BITool;
using FF.BusinessObjects.Financial;


namespace FF.DataAccessLayer
{
    public class SalesDAL : BaseDAL
    {      
        //kapila
        public List<MasterInvoiceType> GetInvoiceTypeByCode(string _code)
        {
            List<MasterInvoiceType> _masterInvoiceType = new List<MasterInvoiceType>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceType = QueryDataTable("tblInvoiceType", "sp_getinvoicetypebycode", CommandType.StoredProcedure, false, param);
            if (_tblInvoiceType.Rows.Count > 0)
            {
                _masterInvoiceType = DataTableExtensions.ToGenericList<MasterInvoiceType>(_tblInvoiceType, MasterInvoiceType.ConvertTotal);
            }

            return _masterInvoiceType;

        }
        //kapila
        public DataTable HPMobileIntIncomeReport(string _user, DateTime _from, DateTime _to, string _item, string _cate, string _brand, string _group, string _com, string _pc)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[11];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            param[1] = new OracleParameter("a_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate;
            (param[7] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("p_group", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _group;
            (param[9] = new OracleParameter("TMP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[10] = new OracleParameter("TMP_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            _dtResults = QueryDataTable("int_req", "sp_rpt_col_cap_int", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetServiceCostMargin(string _com, string _chnl, string _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tbl", "sp_get_scv_cst_marg", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable SP_CHECK_MST_SYS_PARA_MRN(string _com, string _pc, string _loc, string _item, decimal _qty)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("in_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_CHECK_MST_SYS_PARA_MRN", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable Get_Gp_Data_new(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor,
    int _freeissue, string _itemclasif, string _brndmgr, bool withReversal, int _rplitm, DateTime _fromDate2, DateTime _toDate2, Int16 _intercom)
        {  // Lakshan 2016/01/04 - Sanjeewa 2016-05-27 - Lakshika 2016/10/18(inv direction)
            OracleParameter[] param = new OracleParameter[29];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[14] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[15] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[16] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[17] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[18] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[19] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[20] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[21] = new OracleParameter("in_itm_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemclasif;
            (param[22] = new OracleParameter("in_btnd_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndmgr;
            (param[23] = new OracleParameter("in_consider_invdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N";
            //(param[24] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[24] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (withReversal == true ? 0 : 1);
            (param[25] = new OracleParameter("in_replitem", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rplitm;
            (param[26] = new OracleParameter("fdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate2.Date;
            (param[27] = new OracleParameter("tdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate2.Date;
            (param[28] = new OracleParameter("in_intercom", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intercom;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_gp_dtl_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetReqAppByType(string _com, string _Pc, string _type)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[3] = new OracleParameter("in_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_req_app_by_type", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable Get_Cash_Comm_Summ(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to.Date;
            (param[2] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_rep_sales.sp_print_cs_comm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable Get_ClosedAccountsDet(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tblRcc", "sp_print_closed_acc_det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable Get_CIH_Summary(DateTime _asatdate, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate.Date;

            (param[1] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_rep_sales.sp_print_cih_sum", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSOSReconcilation(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_rep_sales.sp_process_sos_recon", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public int SavePriceDetailsSchRem(string _circ, string _rem)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[1] = new OracleParameter("p_circ_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_savepriceSchRemark", CommandType.StoredProcedure, param);


            return _effect;
        }
        public int SavePriceDetailsSch(Circular_Schemes _priceDetSch)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetSch.Circ;
            (param[1] = new OracleParameter("p_circ_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetSch.Circ_Sch;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_savepriceSch", CommandType.StoredProcedure, param);


            return _effect;
        }
        //kapila
        public DataTable GetSchDetByPriceCirc(string _circ, string _type)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getsch_detby_pricecirc", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable PrintHPServiceCharge(string _com, string _pc, DateTime _from, DateTime _to, string _item, string _cate1, string _cate2, string _cate3, string _brand, string _model)
        {
            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
            (param[6] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2;
            (param[7] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3;
            (param[8] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;

            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_print_HP_Service_Charge", CommandType.StoredProcedure, false, param);
            return _tblData;


        }
        //kapila
        public DataTable GET_SI_ITEMS(string _si, Int32 _wfoc)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_si", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _si;
            (param[1] = new OracleParameter("p_wfoc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _wfoc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "SP_GET_SI_ITEMS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public DataTable GET_SI_4_Price(string _com, string _si, DateTime _from, DateTime _to, string _item, string _cat1, string _cat2, string _model)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_si", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _si;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GET_SI_4_Price", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public DataTable getProVouRdmPb(Int32 _seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GET_sar_provou_rdm_pb", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public DataTable getReqAppByCrNo(string _com, string _crno, string _anal5)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_crno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _crno;
            (param[2] = new OracleParameter("p_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _anal5;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_req_app_by_CR", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public Int16 Update_Invoice_Anal_8(string _invno, decimal _val)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inv_anal_8", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Update_PV_Pages(string _inv, Int32 _page, string _prefix, string _cust)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_page", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _page;
            (param[2] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            (param[3] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_reverse_gvpage", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 DeleteTempPromoVoucherRedeemPB(string CreateUser)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_spd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CreateUser;
            param[1] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_dlt_temprdmpb_byuser", CommandType.StoredProcedure, param);

            return effects;
        }

        //kapila
        public Int16 SaveTempPromoVoucherRedeemPB(PromoVouRedeemPB _ProVouRdmPb)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ProVouRdmPb.SPRPB_USER;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ProVouRdmPb.SPRPB_COMP;
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ProVouRdmPb.SPRPB_PB;
            (param[3] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ProVouRdmPb.SPRPB_LVL;
            (param[4] = new OracleParameter("p_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ProVouRdmPb.SPRPB_PERIOD;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int16)UpdateRecords("sp_temp_save_sar_provou_rdm_pb", CommandType.StoredProcedure, param);
        }
        //kapila
        public DataTable GetCreditInvoices(DateTime _from, DateTime _to, string _cust, string _com, Int32 _isall, Int32 _outs)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isall;
            (param[5] = new OracleParameter("p_outs", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _outs;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_crd_invoices", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila    
        public Boolean IsExchangeReqFound(string _ser, Int32 _isinv)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (_para[1] = new OracleParameter("p_is_inv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isinv;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isItem = QueryDataTable("tblItem", "sp_is_exchange_req_new", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _isItem;
        }

        //kapila
        public DataTable GetInvoiceAdj(string _invoice)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoiceadj", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public Int32 Update_Item_Tax(string _com, string _pc, DateTime _date)
        {

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_temp_pc", CommandType.StoredProcedure, param);
            return effects;

        }

        //kapila
        public Int16 UpdateDispatchReservation(string _ref, string _com, string _loc, string _quono, string _item, string _serial, string _newser, string _newser2)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_quono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quono;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[6] = new OracleParameter("p_newser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newser;
            (param[7] = new OracleParameter("p_newser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newser2;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_update_dispatch_reservation", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        //kapila
        public Int16 UpdateQuoSerial(string _QutNo, string _itm, string _Ser, string _newSer, string _newSer2)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QutNo;
            (param[1] = new OracleParameter("p_itm", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_ser", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Ser;
            (param[3] = new OracleParameter("p_newser", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _newSer;
            (param[4] = new OracleParameter("p_newser2", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _newSer2;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_quo_ser", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable SP_CHECK_MST_SYS_PARA(string _com, string _pc, string _loc, string _item)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_CHECK_MST_SYS_PARA", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila
        public DataTable ProcessMyAbansReport(string _com, string _pc, DateTime _fdate, DateTime _tdate, Int32 _opt)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[5] = new OracleParameter("in_opt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _opt;

            DataTable _tblData = QueryDataTable("tbl", "SP_MYABANS_DET", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable ProcessDayEndProcessReport(string _com, string _pc, DateTime _fdate, DateTime _tdate)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;


            DataTable _tblData = QueryDataTable("tbl", "sp_dayend_process_details", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        //kapila
        public DataTable ProcessECDVoucherDetReport(string _com, string _pc, DateTime _fdate, DateTime _tdate)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;


            DataTable _tblData = QueryDataTable("tbl", "SP_ECD_VOU_DET", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila
        public DataTable ProcessHPIntroCommReport(string _com, string _pc, DateTime _fdate, DateTime _tdate)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;


            DataTable _tblData = QueryDataTable("tbl", "SP_HP_PROMOT_COMM_DET", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila
        public DataTable GetTransPBSupplier(string _com, string _pb, string _level)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_trans_pb_sup", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //kapila
        public DataTable RegisProcessReport(string _com, string _chnl, DateTime _fdate, DateTime _tdate, Int32 _opt, string _fincomp)
        {
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[3] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[5] = new OracleParameter("in_opt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _opt;
            (param[6] = new OracleParameter("in_fin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fincomp;

            DataTable _tblData = QueryDataTable("tbl", "sp_veh_reg_pro", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila
        public Int32 SaveVehRegCompany(VehicleRegCompany _RegComp)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_SVFC_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RegComp.Svfc_seq;
            (param[1] = new OracleParameter("p_SVFC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_com;
            (param[2] = new OracleParameter("p_SVFC_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_pc;
            (param[3] = new OracleParameter("p_SVFC_REC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_rec_no;
            (param[4] = new OracleParameter("p_SVFC_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_inv_no;
            (param[5] = new OracleParameter("p_SVFC_ENGINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_engine;
            (param[6] = new OracleParameter("p_SVFC_CHASIS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_chasis;
            (param[7] = new OracleParameter("p_SVFC_CUS_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_cus_name;
            (param[8] = new OracleParameter("p_SVFC_FIN_COMP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_fin_comp;
            (param[9] = new OracleParameter("p_SVFC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RegComp.Svfc_dt;
            (param[10] = new OracleParameter("p_SVFC_POD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_pod;
            (param[11] = new OracleParameter("p_SVFC_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_rem;
            (param[12] = new OracleParameter("p_SVFC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RegComp.Svfc_cre_by;
            //(param[13] = new OracleParameter("p_SVFC_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RegComp.Svfc_cre_when;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_insertvehregcompany", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public Int32 SaveAdditionalRecDetails(ReceiptAddDetails _recDet)
        {
            OracleParameter[] param = new OracleParameter[18];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_SRA_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recDet.SRA_SEQ;
            (param[1] = new OracleParameter("p_SRA_LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recDet.SRA_LINE_NO;
            (param[2] = new OracleParameter("p_SRA_REC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_REC_NO;
            (param[3] = new OracleParameter("p_SRA_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_REF_NO;
            (param[4] = new OracleParameter("p_SRA_UNITS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recDet.SRA_UNITS;
            (param[5] = new OracleParameter("p_SRA_REQ_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recDet.SRA_REQ_DT;
            (param[6] = new OracleParameter("p_SRA_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_TP;
            (param[7] = new OracleParameter("p_SRA_OTH_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_OTH_TP;
            (param[8] = new OracleParameter("p_SRA_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_RMKS;
            (param[9] = new OracleParameter("p_SRA_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recDet.SRA_AMT;
            (param[10] = new OracleParameter("p_SRA_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_ANAL1;
            (param[11] = new OracleParameter("p_SRA_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_ANAL2;
            (param[12] = new OracleParameter("p_SRA_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_ANAL3;
            (param[13] = new OracleParameter("p_SRA_ANAL4", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recDet.SRA_ANAL4;
            (param[14] = new OracleParameter("p_SRA_ANAL5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recDet.SRA_ANAL5;
            (param[15] = new OracleParameter("p_SRA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recDet.SRA_CRE_BY;
            (param[16] = new OracleParameter("p_SRA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recDet.SRA_CRE_DT;


            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_save_add_rec_det", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public DataTable GetMailLocations(string _pb, string _lvl)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[1] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getmaillocations", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetMailPBLevels(string _promocode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promocode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getmailpblevels", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public Int32 CancelSerialPrice(string _pb, string _lvl, string _item, string _ser, string _circ, string _modby, DateTime _validto)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[1] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[4] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[5] = new OracleParameter("p_mod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modby;
            (param[6] = new OracleParameter("p_valto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _validto;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int32)UpdateRecords("sp_cancel_serial_price", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public Int32 SaveMyAbansDetails(MyAbans _myab)
        {

            OracleParameter[] param = new OracleParameter[77];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_MYAB_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_seq;
            (param[1] = new OracleParameter("p_MYAB_SER_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_ser_no;
            (param[2] = new OracleParameter("p_MYAB_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_nic;
            (param[3] = new OracleParameter("p_MYAB_TIT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_tit;
            (param[4] = new OracleParameter("p_MYAB_FNAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_fname;
            (param[5] = new OracleParameter("p_MYAB_SNAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_sname;
            (param[6] = new OracleParameter("p_MYAB_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_stus;
            (param[7] = new OracleParameter("p_MYAB_SPOUSE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_spouse;
            (param[8] = new OracleParameter("p_MYAB_WR_DESIGNATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_wr_designation;
            (param[9] = new OracleParameter("p_MYAB_CUST_LANG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_cust_lang;
            (param[10] = new OracleParameter("p_MYAB_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_add1;
            (param[11] = new OracleParameter("p_MYAB_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_add2;
            (param[12] = new OracleParameter("p_MYAB_CLOSE_SR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_close_sr;
            (param[13] = new OracleParameter("p_MYAB_MOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_mob;
            (param[14] = new OracleParameter("p_MYAB_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_tel;
            (param[15] = new OracleParameter("p_MYAB_TV_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_tv_chnl;
            (param[16] = new OracleParameter("p_MYAB_RADIO_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_radio_chnl;
            (param[17] = new OracleParameter("p_MYAB_NEWS_PAPER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_news_paper;
            (param[18] = new OracleParameter("p_MYAB_DECISION_RT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_decision_rt;
            (param[19] = new OracleParameter("p_MYAB_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_email;
            (param[20] = new OracleParameter("p_MYAB_BUY_ONLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_online;
            (param[21] = new OracleParameter("p_MYAB_IS_CHILD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_is_child;
            (param[22] = new OracleParameter("p_MYAB_BD_CH1", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_bd_ch1;
            (param[23] = new OracleParameter("p_MYAB_BD_CH2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_bd_ch2;
            (param[24] = new OracleParameter("p_MYAB_BD_CH3", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_bd_ch3;
            (param[25] = new OracleParameter("p_MYAB_USE_TV", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_tv;
            (param[26] = new OracleParameter("p_MYAB_USE_TV_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_tv_yr;
            (param[27] = new OracleParameter("p_MYAB_USE_FR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_fr;
            (param[28] = new OracleParameter("p_MYAB_USE_FR_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_fr_yr;
            (param[29] = new OracleParameter("p_MYAB_USE_WM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_wm;
            (param[30] = new OracleParameter("p_MYAB_USE_WM_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_wm_yr;
            (param[31] = new OracleParameter("p_MYAB_USE_LAP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_lap;
            (param[32] = new OracleParameter("p_MYAB_USE_LAP_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_lap_yr;
            (param[33] = new OracleParameter("p_MYAB_USE_TAB", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_tab;
            (param[34] = new OracleParameter("p_MYAB_USE_TAB_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_tab_yr;
            (param[35] = new OracleParameter("p_MYAB_USE_DTOP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_dtop;
            (param[36] = new OracleParameter("p_MYAB_USE_DTOP_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_dtop_yr;
            (param[37] = new OracleParameter("p_MYAB_USE_SP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_sp;
            (param[38] = new OracleParameter("p_MYAB_USE_SP_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_sp_yr;
            (param[39] = new OracleParameter("p_MYAB_USE_CK_ELE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_mo;
            (param[40] = new OracleParameter("p_MYAB_USE_CK_ELE_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_mo_yr;
            (param[41] = new OracleParameter("p_MYAB_USE_CK_GAS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_ck_gas;
            (param[42] = new OracleParameter("p_MYAB_USE_CK_GAS_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_ck_gas_yr;
            (param[43] = new OracleParameter("p_MYAB_USE_CK_DTOP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_ck_dtop;
            (param[44] = new OracleParameter("p_MYAB_USE_CK_DTOP_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_ck_dtop_yr;
            (param[45] = new OracleParameter("p_MYAB_USE_MG", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_mg;
            (param[46] = new OracleParameter("p_MYAB_USE_MG_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_mg_yr;
            (param[47] = new OracleParameter("p_MYAB_USE_HIFI", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_hifi;
            (param[48] = new OracleParameter("p_MYAB_USE_HIFI_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_hifi_yr;
            (param[49] = new OracleParameter("p_MYAB_USE_AC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_ac;
            (param[50] = new OracleParameter("p_MYAB_USE_AC_YR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_use_ac_yr;
            (param[51] = new OracleParameter("p_MYAB_BUY_TV", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_tv;
            (param[52] = new OracleParameter("p_MYAB_BUY_FR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_fr;
            (param[53] = new OracleParameter("p_MYAB_BUY_WM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_wm;
            (param[54] = new OracleParameter("p_MYAB_BUY_PC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_pc;
            (param[55] = new OracleParameter("p_MYAB_BUY_SP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_sp;
            (param[56] = new OracleParameter("p_MYAB_BUY_CK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_ck;
            (param[57] = new OracleParameter("p_MYAB_BUY_CK_DTOP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_ck_dtop;
            (param[58] = new OracleParameter("p_MYAB_BUY_MG", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_mg;
            (param[59] = new OracleParameter("p_MYAB_BUY_HIFI", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_hifi;
            (param[60] = new OracleParameter("p_MYAB_BUY_AC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_buy_ac;
            (param[61] = new OracleParameter("p_MYAB_IS_BUY_AB", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_is_buy_ab;
            (param[62] = new OracleParameter("p_MYAB_PAY_METHOD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_pay_method;
            (param[63] = new OracleParameter("p_MYAB_DOB", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_dob;
            (param[64] = new OracleParameter("p_MYAB_SPOUSE_DOB", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_spouse_dob;
            (param[65] = new OracleParameter("p_MYAB_IS_NEED_CARD_SP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_is_need_card_sp;
            (param[66] = new OracleParameter("p_MYAB_NAME_IN_CARD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_name_in_card;
            (param[67] = new OracleParameter("p_MYAB_BD_CH4", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_bd_ch4;
            (param[68] = new OracleParameter("p_MYAB_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _myab.Myab_dt;
            (param[69] = new OracleParameter("p_MYAB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_com;
            (param[70] = new OracleParameter("p_MYAB_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_pc;
            (param[71] = new OracleParameter("p_MYAB_add3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_add3;
            (param[72] = new OracleParameter("p_MYAB_add4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_add4;
            (param[73] = new OracleParameter("p_MYAB_oth_rem1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_oth_rem1;
            (param[74] = new OracleParameter("p_MYAB_oth_rem2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _myab.Myab_oth_rem2;
            (param[75] = new OracleParameter("p_MYAB_need_card", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _myab.Myab_need_card;

            param[76] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_myabans", CommandType.StoredProcedure, param);

            return effects;

        }
        //kapila
        public Int32 UpdateAccountManagerLog(string _pc, string _acc, string _oldmgrcd, string _newmgrcd, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[2] = new OracleParameter("p_mgrcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldmgrcd;
            (param[3] = new OracleParameter("p_newcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newmgrcd;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("SP_INSERT_ACC_MAN_LOG", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public Int32 UpdateAccountManager(string _com, string _pc, string _acc, string _mgrcd)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[3] = new OracleParameter("p_mgrcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mgrcd;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_updateaccountmanager", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetLoyaltyMemberByCardNo(string _cardNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_loyal_by_card", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetSalesHdrByReq(string _com, string _req)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_hdr_byreq", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila
        public int Update_veh_DocReg_stus(Int32 seq, DateTime recDate, string FinRemark, string recBy, Int32 _stus)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_recDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = recDate;
            (param[2] = new OracleParameter("p_recRmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FinRemark;
            (param[3] = new OracleParameter("p_recBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recBy;
            (param[4] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_vehDocREC_stus", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila

        public DataTable GetinvBySer(string _com, string _loc, string _ser, string _war)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[3] = new OracleParameter("p_war", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _war;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_by_ser", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila
        public DataTable getSubLocationByCode(string _com, string _mloc, string _sloc)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mloc;
            (param[2] = new OracleParameter("p_sloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sloc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_subloc_by_code", CommandType.StoredProcedure, false, param);

            return tblDet;
        }
        //kapila
        public DataTable ReqAppDetByReasonReport(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _reason, string _status, string _User)
        {
            // kapila      
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("in_reason", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reason;
            (param[5] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_sun_upload.sp_get_app_det_by_reason", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable ReqAppDetByReasonReport_new(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _reason, string _User, string _cat, string _tp)
        {
            // Sanjeewa      
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("p_reason", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reason;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[6] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[7] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_exch_det_for_cate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetHPSalesDet(string _com, DateTime _frmDt, DateTime _toDt, string _cus, string _invNo)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[2] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            (param[3] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[4] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblCusSales", "sp_get_HP_inv_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetCustomerHPSalesDet(string _com, DateTime _frmDt, DateTime _toDt, string _cus, string _invNo)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[2] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            (param[3] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[4] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblCusSales", "sp_get_cust_inv_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable getReqHdrByReqNo(string _com, string _pc, string _req)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getreqhdrby_reqno", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        //kapila
        public Int32 UpdateSupplierItems(BusEntityItem _item)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_mbii_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_COM;
            (param[1] = new OracleParameter("p_mbii_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_CD;
            (param[2] = new OracleParameter("p_mbii_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_TP;
            (param[3] = new OracleParameter("p_mbii_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_ITM_CD;
            (param[4] = new OracleParameter("p_mbii_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.MBII_ACT;
            (param[5] = new OracleParameter("p_mbii_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_CRE_BY;
            (param[6] = new OracleParameter("p_mbii_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.MBII_CRE_DT;
            (param[7] = new OracleParameter("p_mbii_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_MOD_BY;
            (param[8] = new OracleParameter("p_mbii_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.MBII_MOD_DT;
            (param[9] = new OracleParameter("p_mbii_warr_peri", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_WARR_PERI;
            (param[10] = new OracleParameter("p_mbii_warr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_WARR_RMK;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //  ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_supplier_items", CommandType.StoredProcedure, param);
            //  ConnectionClose();
            return _eff;
        }



        //kapila
        public List<ReptPickSerials> GetInvoiceSerial_Rep(string _company, string _location, string _user, string _session, string _defBin, string _invoice, int _baseRefline)
        {
            //sp_getdoserialdetail(p_com in NVARCHAR2, p_invoiceno in NVARCHAR2,p_base_refline in NUMBER, c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _baseRefline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetail_Rep", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = Convert.ToDateTime(_row["ITS_DOC_DT"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_doc_dt = Convert.ToDateTime(_row["ITS_DOC_DT"]);
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }
        //kapila
        public List<ReptPickSerials> GetInvoiceSerialForReversal_Rep(string _company, string _location, string _user, string _session, string _defBin, string _invoice, int _baseRefline)
        {
            //sp_getdoserialdetail(p_com in NVARCHAR2, p_invoiceno in NVARCHAR2,p_base_refline in NUMBER, c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _baseRefline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailforrev_Rep", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }

        public MasterItem GetItem(string _company, string _item)
        {
            MasterItem _itemList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_allitemdetails", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal)[0];
            }
            return _itemList;
        }

        //kapila
        public Boolean IsMainItemReplace(string _item)
        {
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isExternal = QueryDataTable("tbl", "sp_chk_is_mainunit_rep", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _isExternal;
        }

        //kapila
        public Int32 sp_process_promotor_comm(string _com, string _pc, DateTime _date, string _user)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_process_promotor_comm", CommandType.StoredProcedure, param);

            return effects;
        }

        //kapila
        public Int32 UpdateBulkToDipositBank(string _com, string _pc, string _ref, string _curBankCd, string _dipBankCd, string _modby)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_cur_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _curBankCd;
            (param[4] = new OracleParameter("p_dip_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dipBankCd;
            (param[5] = new OracleParameter("p_modBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modby;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_upd_bulk_chq", CommandType.StoredProcedure, param);

            return effects;
        }
        //kapila
        public DataTable GetReceiptByRecNo(string _recNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_rec_by_recno", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintExtraAddBankDocs(string com, string _accNo, DateTime _from, DateTime _to, string _user, string _docType)
        {
            //kapila    
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;            
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_sun_upload.sp_print_extra_add_docs", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetHPCreditNoteDetails(string _accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;

            DataTable _tblData = QueryDataTable("tbl", "sp_getHPCreditNotedetails", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable ReqAppCurrentStatusUserWise(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _reqtp, string _status, string _User, string _userID)
        {
            // kapila
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqtp;
            (param[6] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[8] = new OracleParameter("in_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_app_curr_stus_user", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public Int32 SavePromotorCommDef(HPPrmotorCommDef _hpPromotComm)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0; ;

            (param[0] = new OracleParameter("p_HPCM_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_circ;
            (param[1] = new OracleParameter("p_HPCM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_com;
            (param[2] = new OracleParameter("p_HPCM_SCH_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_sch_cd;
            (param[3] = new OracleParameter("p_HPCM_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_itm_cd;
            (param[4] = new OracleParameter("p_HPCM_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_from_dt;
            (param[5] = new OracleParameter("p_HPCM_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_to_dt;
            (param[6] = new OracleParameter("p_HPCM_COMM_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_comm_amt;
            (param[7] = new OracleParameter("p_HPCM_COMM_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_comm_rt;
            (param[8] = new OracleParameter("p_HPCM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_cre_by;
            (param[9] = new OracleParameter("p_HPCM_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpPromotComm.Hpcm_mod_by;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_promotor_comm", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable PrintCompletedHPAgreement(string _com, DateTime _from, DateTime _to, string _pc, string _agrUser, string _user)
        {
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_agr_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrUser;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "pkg_reports.sp_print_completed_adr_det", CommandType.StoredProcedure, false, param);
            return _tblData;


        }

        //kapila
        public Int32 deleteCustPrioLevels(string _Code)
        {
            Int32 _effect = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_del_cust_prio_lvl", CommandType.StoredProcedure, param);
            return _effect;


        }

        //kapila
        public Int32 SaveCustomerPriorityLevel(MST_BUSPRIT_LVL _busPritLvl)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0; ;

            (param[0] = new OracleParameter("p_MBL_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_cd;
            (param[1] = new OracleParameter("p_MBL_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_com;
            (param[2] = new OracleParameter("p_MBL_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_pty_tp;
            (param[3] = new OracleParameter("p_MBL_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_pty_cd;
            (param[4] = new OracleParameter("p_MBL_PRIT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_prit_cd;
            (param[5] = new OracleParameter("p_MBL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_act;
            (param[6] = new OracleParameter("p_MBL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_cre_by;
            (param[7] = new OracleParameter("p_MBL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_cre_dt;
            (param[8] = new OracleParameter("p_MBL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_mod_by;
            (param[9] = new OracleParameter("p_MBL_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_mod_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_upd_custprio_lvl", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable getSerialByInvLine(string _inv, Int32 _line)
        {

            OracleParameter[] param1 = new OracleParameter[3];
            (param1[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param1[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param1[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_get_ser_by_inv_line", CommandType.StoredProcedure, false, param1);
            return _tblInvoiceDet;
        }

        //KAPILA
        public Int32 UPDATE_SCV_CONF_HDR(Int32 Status, string _job)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Status;
            (param[1] = new OracleParameter("P_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[2] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_upd_cof_hdr", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetESDManagerEPF(string _company, string _profitcenter, DateTime _fromDate, DateTime _toDate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_From", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_To", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_get_esd_man_epf", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //kapila
        public Int32 SaveTownMaster(MasterTown _mstTown)
        {
            OracleParameter[] param = new OracleParameter[22];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_MT_COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_country_cd;
            (param[1] = new OracleParameter("p_MT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_cd;
            (param[2] = new OracleParameter("p_MT_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_desc;
            (param[3] = new OracleParameter("p_MT_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_tp;
            (param[4] = new OracleParameter("p_MT_PROVINCE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_province_cd;
            (param[5] = new OracleParameter("p_MT_DISTRIC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_distric_cd;
            (param[6] = new OracleParameter("p_MT_POSTAL_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_postal_cd;
            (param[7] = new OracleParameter("p_MT_DISTANCE_FROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_distance_from;
            (param[8] = new OracleParameter("p_MT_DISTANCE_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_distance_uom;
            (param[9] = new OracleParameter("p_MT_DISTANCE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mstTown.Mt_distance;
            (param[10] = new OracleParameter("p_MT_LAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_lat;
            (param[11] = new OracleParameter("p_MT_LON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_lon;
            (param[12] = new OracleParameter("p_MT_HEIGHT_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_height_uom;
            (param[13] = new OracleParameter("p_MT_HEIGHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mstTown.Mt_height;
            (param[14] = new OracleParameter("p_MT_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mstTown.Mt_act;
            (param[15] = new OracleParameter("p_MT_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_cre_by;
            (param[16] = new OracleParameter("p_MT_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mstTown.Mt_cre_dt;
            (param[17] = new OracleParameter("p_MT_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_mod_by;
            (param[18] = new OracleParameter("p_MT_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mstTown.Mt_mod_dt;
            (param[19] = new OracleParameter("p_MT_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_session_id;
            (param[20] = new OracleParameter("p_MT_DS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstTown.Mt_ds_cd;
            param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_town", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable BOCCustReceipt(string _com, string _loc, string _ser)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;


            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_BOC_Cust_rec", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable BOCCustomersPrint(string _com, string _loc, string _batch, DateTime _fromDate, DateTime _toDate, string _user)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch;
            (param[3] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[4] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_sun_upload.sp_print_BOC_Cust_List", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable get_Def_dep_Bank(string _com, string _pc, string _paytp)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paytp;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_def_bnk", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable get_Dep_Bank_Name(string _com, string _pc, string _paytp, string _acc)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paytp;
            (param[3] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_dep_bnk_name", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateCustomerProfile(MasterBusinessEntity _businessEntity)
        {
            OracleParameter[] param = new OracleParameter[69];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************
            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0;

            (param[64] = new OracleParameter("p_mbe_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_TIT;
            (param[65] = new OracleParameter("p_mbe_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_INI;
            (param[66] = new OracleParameter("p_mbe_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_FNAME;
            (param[67] = new OracleParameter("p_mbe_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_SNAME;

            //----------------------------------------------------------------------------------------------------------------------
            param[68] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_upd_cus_profie", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 DeleteGenDiscDefByCirc(string _circ)
        {
            Int32 _effect = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_del_discbycirc", CommandType.StoredProcedure, param);
            return _effect;


        }

        public Int32 SaveGeneralDiscDef(CashGeneralDicountDef _genDiscDef)
        {

            OracleParameter[] param = new OracleParameter[24];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SGDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_seq;
            (param[1] = new OracleParameter("p_SGDD_CIRCULAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_circular;
            (param[2] = new OracleParameter("p_SGDD_SALE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_sale_tp;
            (param[3] = new OracleParameter("p_SGDD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_com;
            (param[4] = new OracleParameter("p_SGDD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_pc;
            (param[5] = new OracleParameter("p_SGDD_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_from_dt;
            (param[6] = new OracleParameter("p_SGDD_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_to_dt;
            (param[7] = new OracleParameter("p_SGDD_CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_cust_cd;
            (param[8] = new OracleParameter("p_SGDD_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_pb;
            (param[9] = new OracleParameter("p_SGDD_PB_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_pb_lvl;
            (param[10] = new OracleParameter("p_SGDD_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_itm;
            (param[11] = new OracleParameter("p_SGDD_ALW_SER", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_alw_ser;
            (param[12] = new OracleParameter("p_SGDD_ALW_PRO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_alw_pro;
            (param[13] = new OracleParameter("p_SGDD_REQ_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_req_ref;
            (param[14] = new OracleParameter("p_SGDD_DISC_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_disc_val;
            (param[15] = new OracleParameter("p_SGDD_DISC_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_disc_rt;
            (param[16] = new OracleParameter("p_SGDD_NO_OF_TIMES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_no_of_times;
            (param[17] = new OracleParameter("p_SGDD_NO_OF_USED_TIMES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_no_of_used_times;
            (param[18] = new OracleParameter("p_SGDD_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_stus;
            (param[19] = new OracleParameter("p_SGDD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_cre_by;
            (param[20] = new OracleParameter("p_SGDD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_cre_dt;
            (param[21] = new OracleParameter("p_SGDD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_mod_by;
            (param[22] = new OracleParameter("p_SGDD_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _genDiscDef.Sgdd_mod_dt;

            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_gen_disc_def", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Chamal De Silva 21/08/2012
        public Int16? CheckSalesNo(string _fnName, string _param, string _paramVal)
        {
            OracleParameter[] param = new OracleParameter[1];
            (param[0] = new OracleParameter(_param, OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramVal;
            OracleParameter _outParam = new OracleParameter("p_out", OracleDbType.Int32, null, ParameterDirection.Output);
            Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue(_fnName, CommandType.StoredProcedure, _outParam, param));
            return _effect;
        }

        #region SalesInvoice

        /// <summary>
        /// Get Invoice header details.
        /// Code By : M.Geeganage on 18/04/2012  
        /// </summary>
        /// <param name="_invoiceNo"></param>
        /// <returns></returns>
        public InvoiceHeader GetInvoiceHeaderDetails(string _invoiceNo)
        {
            InvoiceHeader _invoiceHeader = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "sp_get_all_invoice_details", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_invoiceDT, InvoiceHeader.ConvertTotal)[0];
            }
            return _invoiceHeader;
        }

        public List<InvoiceItem> GetInvoiceHeaderDetailsList(string _invoiceNo)
        {
            List<InvoiceItem> _invoiceHeader = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "sp_get_all_invoice_details2", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceItem>(_invoiceDT, InvoiceItem.ConverterTours);
            }
            return _invoiceHeader;
        }
        public List<InvoiceItem> GetRefInvHeaderDetailsList(string _invoiceNo, int status)
        {
            List<InvoiceItem> _invoiceHeader = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "sp_get_all_invoice_detbyref", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceItem>(_invoiceDT, InvoiceItem.ConverterTours);
            }
            return _invoiceHeader;
        }
        //written by darshana 16/06/2012
        public List<InvoiceItem> GetPendingInvoiceItems(string _inv)
        {
            List<InvoiceItem> _invoiceitem = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getpendinginvoiceitems", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItem);
            }

            return _invoiceitem;
        }

        //written by chamal 15/08/2012
        public InvoiceItem GetPendingInvoiceItemsByItem(string _inv, string _itemcode)
        {
            InvoiceItem _invoiceitem = new InvoiceItem();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getsalesitmbyitmcd", CommandType.StoredProcedure, false, param);
            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItem)[0];
            }
            else
            {
                _invoiceitem = null;
            }
            return _invoiceitem;
        }

        //written by darshana 19/07/2012
        public List<InvoiceItem> GetAllInvoiceItems(string _inv)
        {
            List<InvoiceItem> _invoiceitem = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getallinvoiceitems", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItemnew);
            }

            return _invoiceitem;
        }

        //written by darshana 15/06/2012
        public List<InvoiceHeader> GetPendingInvoices(string _com, string _pc, string _cus, string _inv, string _status, string _fdate, string _tdate)
        {

            List<InvoiceHeader> _invoiceHeader = new List<InvoiceHeader>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_fdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fdate;
            (param[6] = new OracleParameter("p_tdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tdate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_getpendinginvoice", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblInvoice, InvoiceHeader.ConvertTotal);
            }
            return _invoiceHeader;

        }
        public List<InvoiceHeader> GetPendingInvoicesweb(string _com, string _pc, string _cus, string _inv, string _status, string _fdate, string _tdate)
        {

            List<InvoiceHeader> _invoiceHeader = new List<InvoiceHeader>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_fdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fdate;
            (param[6] = new OracleParameter("p_tdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tdate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_getpendinginvoweb", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblInvoice, InvoiceHeader.ConvertTotal);
            }
            return _invoiceHeader;

        }
        public List<InvoiceHeaderTBS> GetPendingInvoicesTBS(string _com, string _pc, string _cus, string _inv, string _status, string _fdate, string _tdate)
        {

            List<InvoiceHeaderTBS> _invoiceHeader = new List<InvoiceHeaderTBS>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_fdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fdate;
            (param[6] = new OracleParameter("p_tdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tdate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_getpendinginvoicetbs", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeaderTBS>(_tblInvoice, InvoiceHeaderTBS.ConvertTotal);
            }
            return _invoiceHeader;

        }


        //written by darshana 18/06/2012
        public List<InvoiceHeader> GetHireSaleInvoiceForReverse(string _com, string _pc, string _cus, string _inv, string _fdate, string _tdate, string _AccNo)
        {

            List<InvoiceHeader> _invoiceHeader = new List<InvoiceHeader>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_fdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fdate;
            (param[5] = new OracleParameter("p_tdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tdate;
            (param[6] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AccNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_gethpsalesforreverse", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblInvoice, InvoiceHeader.ConvertTotal);
            }
            return _invoiceHeader;

        }


        //Written By Prabhath on 28/04/2012
        public List<InvoiceItem> GetAllSaleDocumentItemList(string _company, string _profitCenter, string _documentType, string _invoiceNo, string _status)
        {
            List<InvoiceItem> _invoiceItem = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentType;
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "sp_getinvoiceitem", CommandType.StoredProcedure, false, param);

            if (_tblItem.Rows.Count > 0)
            {
                //_invoiceItem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblItem, InvoiceItem.ConvertTotal);
                _invoiceItem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblItem, InvoiceItem.ConvertTotal_1);
            }
            return _invoiceItem;
        }

        //Written By Chamal on 12/06/2012
        public InvoiceHeader GetPendingInvoiceHeader(string _company, string _profitCenter, string _documentType, string _invoiceNo, string _status)
        {
            InvoiceHeader _invoiceHdr = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentType;
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "sp_getinvoiceitem", CommandType.StoredProcedure, false, param);

            if (_tblItem.Rows.Count > 0)
            {
                _invoiceHdr = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblItem, InvoiceHeader.ConvertTotal)[0];
            }

            return _invoiceHdr;
        }

        public DataTable GetAllSaleDocumentItemTable(string _company, string _profitCenter, string _documentType, string _invoiceNo, string _status)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentType;
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "sp_getinvoiceitem", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }
        public DataTable GetCustInBOCProject(string _company, string _loc, string _custID)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_custid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custID;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "sp_chk_cust_boc_prj", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }

        //kapila 17/6/2014
        public Boolean IsRegInsuAllowed(string _com, string _type, string _itmStus, string _saleType)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (_para[2] = new OracleParameter("p_itmStus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStus;
            (_para[3] = new OracleParameter("p_saleType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saleType;

            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsInvRev = QueryDataTable("tbl", "sp_is_regins_restrict", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsInvRev;
        }

        /// <summary>
        /// Get Pending Invoice details.
        /// Code By : Shani on 28/04/2012  
        /// </summary>
        /// <param name="p_prof_center"></param>
        /// <param name="p_company"></param>
        /// <param name="p_from_dt"></param>
        /// <param name="p_to_date"></param>
        /// <returns></returns>
        public DataTable GetPendingInvoiceDetails(string prof_center, string company, string from_dt, string to_date, string _del_loc)
        {
            //List<InvoiceHeader> _invoicelist = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_prof_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_center;
            //(param[2] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from_dt;
            //(param[3] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = to_date;
            (param[2] = new OracleParameter("p_from_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = from_dt;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = to_date;
            (param[4] = new OracleParameter("p_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _del_loc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_pending_invoice_details", CommandType.StoredProcedure, false, param);
            //Add Chamal new procedure 31/05/2012
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_pending_invoice", CommandType.StoredProcedure, false, param);

            //if (_invoiceDT.Rows.Count > 0)
            //{
            //    _invoicelist = DataTableExtensions.ToGenericList<InvoiceHeader>(_invoiceDT, InvoiceHeader.ConvertTotal);
            //}
            return _invoiceDT;

        }

        //Add Chamal new procedure 09/02/2013
        public DataTable GetPendingInvoicesToDO(string _company, DateTime _fromDate, DateTime _toDate, string _delLoc, string _custCode, string _invoiceNo, Int32 _delanyloc)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _delLoc;
            (param[4] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            (param[5] = new OracleParameter("p_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[6] = new OracleParameter("p_delanyloc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _delanyloc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_pending_invoice_to_do", CommandType.StoredProcedure, false, param);
            return _invoiceDT;

        }

        #endregion
        // Nadeeka 
        public DataTable GetInvoicesToChangeCust(string _company, DateTime _fromDate, DateTime _toDate, string _delLoc, string _custCode, string _invoiceNo, Int32 _delanyloc)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _delLoc;
            (param[4] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            (param[5] = new OracleParameter("p_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[6] = new OracleParameter("p_delanyloc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _delanyloc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_All_Invoice_Header", CommandType.StoredProcedure, false, param);
            return _invoiceDT;

        }



        #region QuatationBased DO

        public DataTable GetDeliveredQuotation(string _company, string _quo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_quo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_Delivered_Quotation", CommandType.StoredProcedure, false, param);
            return _invoiceDT;

        }




        public DataTable GetPendingDoToInv(string _company, DateTime _fromDate, DateTime _toDate, string _doNo, string _sts, string _pc)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_do_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[4] = new OracleParameter("p_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sts;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_pending_quo_to_inv", CommandType.StoredProcedure, false, param);
            return _invoiceDT;

        }

        // Nadeeka 25-03-2015
        public DataTable GetPendingQuotationToDO(string _company, DateTime _fromDate, DateTime _toDate, string _custCode, string _QuoNo, string _sts, string _pc)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            (param[4] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoNo;
            (param[5] = new OracleParameter("p_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sts;
            (param[6] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_pending_quotation_to_do", CommandType.StoredProcedure, false, param);
            return _invoiceDT;

        }


        public List<QoutationDetails> GetAllQuotationItemList(string _QuoNo)
        {
            List<QoutationDetails> _invoiceItem = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "sp_get_pending_quotation_det", CommandType.StoredProcedure, false, param);

            if (_tblItem.Rows.Count > 0)
            {
                _invoiceItem = DataTableExtensions.ToGenericList<QoutationDetails>(_tblItem, QoutationDetails.ConvertTotalDO);
            }
            return _invoiceItem;
        }

        #endregion
        //Written By Prabhath on 02/05/2012
        public DataTable GetProfitCenterTable(string _company, string _profitCenter)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_getprofitcenterdetail", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }

        //public DataTable GetInvoicesToChangeCust(string _company, DateTime _fromDate, DateTime _toDate, string _delLoc, string _custCode, string _invoiceNo, Int32 _delanyloc)
        //{
        //    OracleParameter[] param = new OracleParameter[8];
        //    (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
        //    (param[1] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
        //    (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
        //    (param[3] = new OracleParameter("p_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _delLoc;
        //    (param[4] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
        //    (param[5] = new OracleParameter("p_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
        //    (param[6] = new OracleParameter("p_delanyloc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _delanyloc;
        //    param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
        //    DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_invoice_to_change_cust", CommandType.StoredProcedure, false, param);
        //    return _invoiceDT;

        //}

        public Int32 Update_CustomerName(string _invNo, string _custCode, string _custName, string _custAdd1, string _custAdd2, string _com, string _user)
        {

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custName;
            (param[3] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custAdd1;
            (param[4] = new OracleParameter("p_add12", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custAdd2;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_Customer_invoice", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetGenDiscByCirc(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_get_gen_discbycirc", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }

        //Written By Sanjeewa on 11/07/2013
        public DataTable GetCompanyTable()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblCompany = QueryDataTable("tblPc", "sp_getallcompanies", CommandType.StoredProcedure, false, param);

            return _tblCompany;
        }

        //Written By Sanjeewa on 11/07/2013
        public DataTable GetEmployeeTable(string _company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblEmp = QueryDataTable("tblPc", "get_allemployee", CommandType.StoredProcedure, false, param);

            return _tblEmp;
        }

        //Written By Sanjeewa on 11/07/2013
        public DataTable GetEliteCommDetails(string _circular, Int16 _year, Int16 _month, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("year_", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _year;
            (param[3] = new OracleParameter("month_", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _month;
            (param[4] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_elitecommdtl", CommandType.StoredProcedure, false, param);

            return _tbl;
        }


        //Written By Sanjeewa on 15/07/2013
        public DataTable GetEliteCommDefDetails(string _circular, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_elitecomdef", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        //Written By Sanjeewa on 15/07/2013
        public DataTable GetEliteCommDtlDetails(string _circular, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_elitecomdet", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        //Written By Sanjeewa on 15/07/2013
        public DataTable GetEliteCommPartyDetails(string _circular, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_elitecomparty", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        //Written By Sanjeewa on 11/07/2013
        public DataTable GetEliteCommAdditionalDetails(string _circular)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_elitecommadd", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        //Written By Prabhath on 02/05/2012
        public MasterProfitCenter GetProfitCenter(string _company, string _profitCenter)
        {
            MasterProfitCenter _masterProfitCenter = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_getprofitcenterdetail", CommandType.StoredProcedure, false, param);

            if (_tblProfitCenter.Rows.Count > 0)
            {
                _masterProfitCenter = DataTableExtensions.ToGenericList<MasterProfitCenter>(_tblProfitCenter, MasterProfitCenter.ConvertTotal)[0];
            }

            return _masterProfitCenter;
        }

        public List<MasterProfitCenter> GetProfitCenterList(string _company, string _profitCenter)
        {
            List<MasterProfitCenter> _masterProfitCenter = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_getprofitcenterdetail", CommandType.StoredProcedure, false, param);

            if (_tblProfitCenter.Rows.Count > 0)
            {
                _masterProfitCenter = DataTableExtensions.ToGenericList<MasterProfitCenter>(_tblProfitCenter, MasterProfitCenter.ConvertTotal);
            }

            return _masterProfitCenter;
        }

        public List<MasterProfitCenter> GetProfitCenterListbyLike(string _company, string _profitCenter, string _description)
        {
            List<MasterProfitCenter> _masterProfitCenter = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_getprofitcenterdetailbylike", CommandType.StoredProcedure, false, param);

            if (_tblProfitCenter.Rows.Count > 0)
            {
                _masterProfitCenter = DataTableExtensions.ToGenericList<MasterProfitCenter>(_tblProfitCenter, MasterProfitCenter.ConvertTotal);
            }

            return _masterProfitCenter;
        }
        /// <summary>
        /// Written by Prabhath on 04/05/2012
        /// Return price book details for the sepcific book or for the company
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_book"></param>
        /// <returns>Return price book details for the sepcific book</returns>
        public PriceBookRef GetPriceBook(string _company, string _book)
        {
            PriceBookRef _priceBookRef = new PriceBookRef();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getpricebook", CommandType.StoredProcedure, false, param);
            if (_tblPriceBook.Rows.Count > 0)
            {
                _priceBookRef = DataTableExtensions.ToGenericList<PriceBookRef>(_tblPriceBook, PriceBookRef.ConvertTotal)[0];
            }

            return _priceBookRef;

        }

        public List<PriceBookRef> GetPriceBooklist(string _company)
        {
            List<PriceBookRef> _priceBookRef = new List<PriceBookRef>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.Empty;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getpricebook", CommandType.StoredProcedure, false, param);
            if (_tblPriceBook.Rows.Count > 0)
            {
                _priceBookRef = DataTableExtensions.ToGenericList<PriceBookRef>(_tblPriceBook, PriceBookRef.ConvertTotal);
            }

            return _priceBookRef;

        }

        public List<GetPCCategory> GetPCCatlist(string _company)
        {
            List<GetPCCategory> _pccategory = new List<GetPCCategory>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.Empty;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPCCat = QueryDataTable("tblPb", "sp_getpccategory", CommandType.StoredProcedure, false, param);
            if (_tblPCCat.Rows.Count > 0)
            {
                _pccategory = DataTableExtensions.ToGenericList<GetPCCategory>(_tblPCCat, GetPCCategory.webConverter);
            }

            return _pccategory;

        }

        /// <summary>
        /// Written by Prabhath on 04/05/2012
        /// Return price book details for the sepcific book or for the company
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_book"></param>
        /// <returns>Return price book details for the sepcific book</returns>
        public DataTable GetPriceBookTable(string _company, string _book)
        {
            PriceBookRef _priceBookRef = new PriceBookRef();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getpricebook", CommandType.StoredProcedure, false, param);


            return _tblPriceBook;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return the price level detail for the specific book and the level or only for Book
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_book"></param>
        /// <param name="_level"></param>
        /// <returns>Return the price level detail for the specific book and the level</returns>
        public PriceBookLevelRef GetPriceLevel(string _company, string _book, string _level)
        {
            PriceBookLevelRef _priceBookLevelRef = new PriceBookLevelRef();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceLevel = QueryDataTable("tblPl", "sp_getpricelevel", CommandType.StoredProcedure, false, param);
            if (_tblPriceLevel.Rows.Count > 0)
            {
                _priceBookLevelRef = DataTableExtensions.ToGenericList<PriceBookLevelRef>(_tblPriceLevel, PriceBookLevelRef.ConvertTotal)[0];
            }

            return _priceBookLevelRef;
        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return the price level detail for the specific book and the level or only for Book
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_book"></param>
        /// <param name="_level"></param>
        /// <returns>Return the price level detail for the specific book and the level</returns>
        public List<PriceBookLevelRef> GetPriceLevelList(string _company, string _book, string _level)
        {
            List<PriceBookLevelRef> _priceBookLevelRef = new List<PriceBookLevelRef>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceLevel = QueryDataTable("tblPl", "sp_getpricelevel", CommandType.StoredProcedure, false, param);
            if (_tblPriceLevel.Rows.Count > 0)
            {
                _priceBookLevelRef = DataTableExtensions.ToGenericList<PriceBookLevelRef>(_tblPriceLevel, PriceBookLevelRef.ConvertTotal);
            }

            return _priceBookLevelRef;
        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return the price level detail for the specific book and the level or only for Book
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_book"></param>
        /// <param name="_level"></param>
        /// <returns>Return the price level detail for the specific book and the level</returns>
        public DataTable GetPriceLevelTable(string _company, string _book, string _level)
        {
            PriceBookLevelRef _priceBookLevelRef = new PriceBookLevelRef();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceLevel = QueryDataTable("tblPl", "sp_getpricelevel", CommandType.StoredProcedure, false, param);


            return _tblPriceLevel;
        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return Price definition for the specific profit center,invoice type ,book and the level
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_profitCenter"></param>
        /// <param name="_invType"></param>
        /// <param name="_book"></param>
        /// <param name="_level"></param>
        /// <returns>Return Price definition for the specific profit center,invoice type ,book and the level</returns>
        public PriceDefinitionRef GetPriceDefinition(string _company, string _profitCenter, string _invType, string _book, string _level)
        {
            PriceDefinitionRef _priceDefinitionRef = new PriceDefinitionRef();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invType;
            (param[3] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDefinition = QueryDataTable("tblPriceDefinition", "sp_getpricedefinition", CommandType.StoredProcedure, false, param);

            if (_tblPriceDefinition.Rows.Count > 0)
            {
                _priceDefinitionRef = DataTableExtensions.ToGenericList<PriceDefinitionRef>(_tblPriceDefinition, PriceDefinitionRef.ConvertTotal)[0];
            }

            return _priceDefinitionRef;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return Price definition for the specific profit center,invoice type ,book and the level
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_profitCenter"></param>
        /// <param name="_invType"></param>
        /// <param name="_book"></param>
        /// <param name="_level"></param>
        /// <returns>Return Price definition for the specific profit center,invoice type ,book and the level</returns>
        public List<PriceDefinitionRef> GetPriceDefinitionByBookAndLevel(string _company, string _book, string _level, string _invoiceType, string _profitCenter)
        {
            // sp_getpricedefinitionbybook   (p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_invtype in NVARCHAR2,p_profit in NVARCHAR2,c_data OUT sys_refcursor)
            List<PriceDefinitionRef> _priceDefinitionRef = new List<PriceDefinitionRef>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;

            (param[3] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceType;
            (param[4] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDefinition = QueryDataTable("tblPriceDefinition", "sp_getpricedefinitionbybook", CommandType.StoredProcedure, false, param);

            if (_tblPriceDefinition.Rows.Count > 0)
            {
                _priceDefinitionRef = DataTableExtensions.ToGenericList<PriceDefinitionRef>(_tblPriceDefinition, PriceDefinitionRef.ConvertTotal);
            }

            return _priceDefinitionRef;

        }

        public List<SAR_DOC_CHANNEL_PRICE_DEFN> GetPriceDefinitionByBookAndLevelSubChannel(string _company, string _book, string _level, string _invoiceType, string _subchannel)
        {

            List<SAR_DOC_CHANNEL_PRICE_DEFN> _priceDefinitionRef = new List<SAR_DOC_CHANNEL_PRICE_DEFN>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;

            (param[3] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceType;
            (param[4] = new OracleParameter("p_schannel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subchannel;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDefinition = QueryDataTable("tblPriceDefinition", "sp_getpricedefinitionbysChanel", CommandType.StoredProcedure, false, param);

            if (_tblPriceDefinition.Rows.Count > 0)
            {
                _priceDefinitionRef = DataTableExtensions.ToGenericList<SAR_DOC_CHANNEL_PRICE_DEFN>(_tblPriceDefinition, SAR_DOC_CHANNEL_PRICE_DEFN.Converter);
            }

            return _priceDefinitionRef;

        }


        public DataTable GetPriceDefinitionByBookAndLevelTable(string _company, string _book, string _level, string _invoiceType, string _profitCenter)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceType;
            (param[4] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDefinition = QueryDataTable("tblPriceDefinition", "sp_getpricedefinitionbybook", CommandType.StoredProcedure, false, param);



            return _tblPriceDefinition;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return Price Details according to the book,level,item,qty,date and the customer
        /// Specifically, the price picking having two main criteria
        /// 1. With Specific Customer
        /// 2. Without Specific Customer
        /// The Usag will be handle in the busines layer according to the requirement.
        /// </summary>
        /// <param name="_book"></param>
        /// <param name="_level"></param>
        /// <param name="_item"></param>
        /// <param name="_qty"></param>
        /// <param name="_date"></param>
        /// <param name="_customer"></param>
        /// <returns>Return Price Details according to the book,level,item,qty,date and the customer</returns>
        public List<PriceDetailRef> GetPriceDetail(string _book, string _level, string _item, decimal _qty, DateTime _date, string _customer)
        {
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[5] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpricedetail", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertWithPriceType);
            }

            return _priceDetailRef;

        }

        /// <summary>
        /// Written by Prabhath on 03/05/2012
        /// Return Combine Items which was setup for the specific price book sequance
        /// The Function can be write to filter by the criteria which used to get the price detail
        /// </summary>
        /// <param name="_priceBookSeq"></param>
        /// <param name="_mainItem"></param>
        /// <returns>Return Combine Items which was setup for the specific price book sequance</returns>
        public List<PriceCombinedItemRef> GetPriceCombinedItem(Int32 _priceBookSeq, string _mainItem, string _mainSerial)
        {
            List<PriceCombinedItemRef> _priceCombinedItemRef = new List<PriceCombinedItemRef>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceBookSeq;
            (param[1] = new OracleParameter("p_mainitem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainItem;
            (param[2] = new OracleParameter("p_mainserial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainSerial;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceCombineItem = QueryDataTable("tblPriceCombineItem", "sp_getpricecombineitem", CommandType.StoredProcedure, false, param);
            if (_tblPriceCombineItem.Rows.Count > 0)
            {
                _priceCombinedItemRef = DataTableExtensions.ToGenericList<PriceCombinedItemRef>(_tblPriceCombineItem, PriceCombinedItemRef.ConvertWithDescription);
            }

            return _priceCombinedItemRef;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Return Customer account information for the specific company and the customer
        /// </summary>
        /// <param name="_company"></param>
        /// <param name="_customer"></param>
        /// <returns>Return Customer account information for the specific company and the customer</returns>
        public CustomerAccountRef GetCustomerAccount(string _company, string _customer)
        {
            CustomerAccountRef _customerAccountRef = new CustomerAccountRef();
            //p_com in NVARCHAR2,p_customer in NVARCHAR2

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblCustomerAccount = QueryDataTable("tblCustomerAccount", "sp_getcustomeraccount", CommandType.StoredProcedure, false, param);
            if (_tblCustomerAccount.Rows.Count > 0)
            {
                _customerAccountRef = DataTableExtensions.ToGenericList<CustomerAccountRef>(_tblCustomerAccount, CustomerAccountRef.ConvertTotal)[0];
            }

            return _customerAccountRef;
        }

        //written by darshana on 25/07/2012
        //save HP account 
        public Int32 SaveHPAccount(HpAccount _HpAccount)
        {
            OracleParameter[] param = new OracleParameter[53];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hpa_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_seq_no;
            (param[1] = new OracleParameter("p_hpa_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_acc_no;
            (param[2] = new OracleParameter("p_hpa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_com;
            (param[3] = new OracleParameter("p_hpa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_pc;
            (param[4] = new OracleParameter("p_hpa_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_seq;
            (param[5] = new OracleParameter("p_hpa_acc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_acc_cre_dt;
            (param[6] = new OracleParameter("p_hpa_grup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_grup_cd;
            (param[7] = new OracleParameter("p_hpa_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_invc_no;
            (param[8] = new OracleParameter("p_hpa_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_sch_tp;
            (param[9] = new OracleParameter("p_hpa_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_sch_cd;
            (param[10] = new OracleParameter("p_hpa_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_term;
            (param[11] = new OracleParameter("p_hpa_intr_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_intr_rt;
            (param[12] = new OracleParameter("p_hpa_dp_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_dp_comm;
            (param[13] = new OracleParameter("p_hpa_inst_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_inst_comm;
            (param[14] = new OracleParameter("p_hpa_cash_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_cash_val;
            (param[15] = new OracleParameter("p_hpa_tot_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_tot_vat;
            (param[16] = new OracleParameter("p_hpa_net_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_net_val;
            (param[17] = new OracleParameter("p_hpa_dp_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_dp_val;
            (param[18] = new OracleParameter("p_hpa_af_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_af_val;
            (param[19] = new OracleParameter("p_hpa_tot_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_tot_intr;
            (param[20] = new OracleParameter("p_hpa_ser_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_ser_chg;
            (param[21] = new OracleParameter("p_hpa_hp_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_hp_val;
            (param[22] = new OracleParameter("p_hpa_tc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_tc_val;
            (param[23] = new OracleParameter("p_hpa_init_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_init_ins;
            (param[24] = new OracleParameter("p_hpa_init_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_init_vat;
            (param[25] = new OracleParameter("p_hpa_init_stm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_init_stm;
            (param[26] = new OracleParameter("p_hpa_init_ser_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_init_ser_chg;
            (param[27] = new OracleParameter("p_hpa_inst_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_inst_ins;
            (param[28] = new OracleParameter("p_hpa_inst_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_inst_vat;
            (param[29] = new OracleParameter("p_hpa_inst_stm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_inst_stm;
            (param[30] = new OracleParameter("p_hpa_inst_ser_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_inst_ser_chg;
            (param[31] = new OracleParameter("p_hpa_buy_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_buy_val;
            (param[32] = new OracleParameter("p_hpa_oth_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_oth_chg;
            (param[33] = new OracleParameter("p_hpa_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_stus;
            (param[34] = new OracleParameter("p_hpa_cls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_cls_dt;
            (param[35] = new OracleParameter("p_hpa_rv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_rv_dt;
            (param[36] = new OracleParameter("p_hpa_rls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_rls_dt;
            (param[37] = new OracleParameter("p_hpa_ecd_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_ecd_stus;
            (param[38] = new OracleParameter("p_hpa_ecd_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_ecd_tp;
            (param[39] = new OracleParameter("p_hpa_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_mgr_cd;
            (param[40] = new OracleParameter("p_hpa_is_rsch", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_is_rsch;
            (param[41] = new OracleParameter("p_hpa_rsch_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_rsch_dt;
            (param[42] = new OracleParameter("p_hpa_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_bank;
            (param[43] = new OracleParameter("p_hpa_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_flag;
            (param[44] = new OracleParameter("p_hpa_prt_ack", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_prt_ack;
            (param[45] = new OracleParameter("p_hpa_val_01", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_val_01;
            (param[46] = new OracleParameter("p_hpa_val_02", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_val_02;
            (param[47] = new OracleParameter("p_hpa_val_03", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_val_03;
            (param[48] = new OracleParameter("p_hpa_val_04", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_val_04;
            (param[49] = new OracleParameter("p_hpa_val_05", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_val_05;
            (param[50] = new OracleParameter("p_hpa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_cre_by;
            (param[51] = new OracleParameter("p_hpa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccount.Hpa_cre_dt;
            param[52] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_save_hp_account", CommandType.StoredProcedure, param);
            return effects;
        }

        /// <summary>
        /// Written by Prabhath on 03/05/2012
        /// Save Sales header
        /// </summary>
        /// <param name="_invoiceHeader"></param>
        /// <returns>return the transaction compete 1/0</returns>
        /// 

        public Int32 SaveSalesHeader(InvoiceHeader _invoiceHeader)
        {
            OracleParameter[] param = new OracleParameter[72];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_1;
            (param[1] = new OracleParameter("p_anal_10", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_10;
            (param[2] = new OracleParameter("p_anal_11", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_11;
            (param[3] = new OracleParameter("p_anal_12", OracleDbType.Date, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_12;
            (param[4] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_2;
            (param[5] = new OracleParameter("p_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_3;
            (param[6] = new OracleParameter("p_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_4;
            (param[7] = new OracleParameter("p_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_5;
            (param[8] = new OracleParameter("p_anal_6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_6;
            (param[9] = new OracleParameter("p_anal_7", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_7;
            (param[10] = new OracleParameter("p_anal_8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_8;
            (param[11] = new OracleParameter("p_anal_9", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_anal_9;
            (param[12] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_com;
            (param[13] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cre_by;
            (param[14] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cre_when;
            (param[15] = new OracleParameter("p_currency", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_currency;
            (param[16] = new OracleParameter("p_cus_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cus_add1;
            (param[17] = new OracleParameter("p_cus_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cus_add2;
            (param[18] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cus_cd;
            (param[19] = new OracleParameter("p_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cus_name;
            (param[20] = new OracleParameter("p_d_cust_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_d_cust_add1;
            (param[21] = new OracleParameter("p_d_cust_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_d_cust_add2;
            (param[22] = new OracleParameter("p_d_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_d_cust_cd;
            (param[23] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_dt;
            (param[24] = new OracleParameter("p_epf_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_epf_rt;
            (param[25] = new OracleParameter("p_esd_rt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_esd_rt;
            (param[26] = new OracleParameter("p_ex_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_ex_rt;
            (param[27] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_inv_no;
            (param[28] = new OracleParameter("p_inv_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_inv_sub_tp;
            (param[29] = new OracleParameter("p_inv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_inv_tp;
            (param[30] = new OracleParameter("p_is_acc_upload", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_is_acc_upload;
            (param[31] = new OracleParameter("p_man_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_man_cd;
            (param[32] = new OracleParameter("p_man_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_man_ref;
            (param[33] = new OracleParameter("p_manual", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_manual;
            (param[34] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_mod_by;
            (param[35] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_mod_when;
            (param[36] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_pc;
            (param[37] = new OracleParameter("p_pdi_req", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_pdi_req;
            (param[38] = new OracleParameter("p_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_ref_doc;
            (param[39] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_remarks;
            (param[40] = new OracleParameter("p_sales_chn_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_chn_cd;
            (param[41] = new OracleParameter("p_sales_chn_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_chn_man;
            (param[42] = new OracleParameter("p_sales_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_ex_cd;
            (param[43] = new OracleParameter("p_sales_region_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_region_cd;
            (param[44] = new OracleParameter("p_sales_region_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_region_man;
            (param[45] = new OracleParameter("p_sales_sbu_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_sbu_cd;
            (param[46] = new OracleParameter("p_sales_sbu_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_sbu_man;
            (param[47] = new OracleParameter("p_sales_str_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_str_cd;
            (param[48] = new OracleParameter("p_sales_zone_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_zone_cd;
            (param[49] = new OracleParameter("p_sales_zone_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_sales_zone_man;
            (param[50] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_seq_no;
            (param[51] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_session_id;
            (param[52] = new OracleParameter("p_structure_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_structure_seq;
            (param[53] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_stus;
            (param[54] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_town_cd;
            (param[55] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_tp;
            (param[56] = new OracleParameter("p_wht_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_wht_rt;
            (param[57] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_direct ? 1 : 0;
            (param[58] = new OracleParameter("p_tax_inv", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_tax_inv;

            (param[59] = new OracleParameter("p_grup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_grup_cd;
            (param[60] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_acc_no;
            (param[61] = new OracleParameter("p_tax_exempted", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_tax_exempted;
            (param[62] = new OracleParameter("p_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_is_svat;
            (param[63] = new OracleParameter("p_fin_chrg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_fin_chrg;
            (param[64] = new OracleParameter("p_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_del_loc;
            (param[65] = new OracleParameter("p_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_grn_com;
            (param[66] = new OracleParameter("p_grn_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_grn_loc;
            (param[67] = new OracleParameter("p_is_grn", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_is_grn;
            (param[68] = new OracleParameter("p_d_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_d_cust_name;//Edit by Chamal 27/05/2013
            (param[69] = new OracleParameter("p_is_dayend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_is_dayend;//Edit by Prabhath on  20/06/2013
            (param[70] = new OracleParameter("P_CCT_TRAN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceHeader.Sah_cct_tran_no; // add by akila 2017/10/12
            param[71] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_sathdr", CommandType.StoredProcedure, param);
            return effects;


        }

        /// <summary>
        /// Written by Prabhath on 03/05/2012
        /// Save Sales Items
        /// </summary>
        /// <param name="_invoiceItem"></param>
        /// <returns>Retrn the transaction compete 1/0</returns>
        public Int32 SaveSalesItem(InvoiceItem _invoiceItem)
        {
            OracleParameter[] param = new OracleParameter[47];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_alt_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_alt_itm_cd;
            (param[1] = new OracleParameter("p_alt_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_alt_itm_desc;
            (param[2] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_comm_amt;
            (param[3] = new OracleParameter("p_disc_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_disc_amt;
            (param[4] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_disc_rt;
            (param[5] = new OracleParameter("p_do_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_do_qty;
            (param[6] = new OracleParameter("p_fws_ignore_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_fws_ignore_qty;
            (param[7] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_inv_no;
            (param[8] = new OracleParameter("p_is_promo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_is_promo;
            (param[9] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_cd;
            (param[10] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_line;
            (param[11] = new OracleParameter("p_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_seq;
            (param[12] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_stus;
            (param[13] = new OracleParameter("p_itm_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_tax_amt;
            (param[14] = new OracleParameter("p_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_tp;
            (param[15] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_job_line;
            (param[16] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_job_no;
            (param[17] = new OracleParameter("p_merge_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_merge_itm;
            (param[18] = new OracleParameter("p_outlet_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_outlet_dept;
            (param[19] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_pb_lvl;
            (param[20] = new OracleParameter("p_pb_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_pb_price;
            (param[21] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_pbook;
            (param[22] = new OracleParameter("p_print_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_print_stus;
            (param[23] = new OracleParameter("p_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_promo_cd;
            (param[24] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_qty;
            (param[25] = new OracleParameter("p_res_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_res_line_no;
            (param[26] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_res_no;
            (param[27] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_seq;
            (param[28] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_seq_no;
            (param[29] = new OracleParameter("p_srn_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_srn_qty;
            (param[30] = new OracleParameter("p_tot_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_tot_amt;
            (param[31] = new OracleParameter("p_unit_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = (_invoiceItem.Sad_unit_rt * _invoiceItem.Sad_qty);
            (param[32] = new OracleParameter("p_unit_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_unit_rt;
            (param[33] = new OracleParameter("p_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_uom;
            (param[34] = new OracleParameter("p_warr_based", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_warr_based;
            (param[35] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_warr_period;
            (param[36] = new OracleParameter("p_warr_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_warr_remarks;
            (param[37] = new OracleParameter("p_sad_isapp", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_isapp;
            (param[38] = new OracleParameter("p_sad_iscovernote", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_iscovernote;
            (param[39] = new OracleParameter("p_dis_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_dis_seq;//Added by Prabhath on 20/sp_save_sathdr06/2013
            (param[40] = new OracleParameter("p_dis_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_dis_line;//Added by Prabhath on 20/06/2013
            (param[41] = new OracleParameter("p_dis_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_dis_type;//Added by Prabhath on 20/06/2013
            (param[42] = new OracleParameter("P_SAD_CONF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_conf_no;//Added by Tharaka 2015-10-16
            (param[43] = new OracleParameter("P_SAD_CONF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_conf_line;//Added by Tharaka 2015-10-16
            (param[44] = new OracleParameter("P_SAD_TRD_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.sad_trd_rt;//Added Y THARANGA 2018/05/18
            (param[45] = new OracleParameter("P_SAD_SIM_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_sim_itm_cd;//Added Y THARANGA 2018/05/18

            param[46] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satitm", CommandType.StoredProcedure, param);
            return effects;

        }

        //Add by darshana - 27-06-2012 (Ai gon darayooooo sat item 1 ta sp 1k tiyeddi thawa bambuwak luwe)
        public Int32 SaveReverseItem(InvoiceItem _invoiceItem)
        {
            OracleParameter[] param = new OracleParameter[47];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_alt_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_alt_itm_cd;
            (param[1] = new OracleParameter("p_alt_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_alt_itm_desc;
            (param[2] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_comm_amt;
            (param[3] = new OracleParameter("p_disc_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_disc_amt;
            (param[4] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_disc_rt;
            (param[5] = new OracleParameter("p_do_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_srn_qty;
            (param[6] = new OracleParameter("p_fws_ignore_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_fws_ignore_qty;
            (param[7] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_inv_no;
            (param[8] = new OracleParameter("p_is_promo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_is_promo;
            (param[9] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_cd;
            (param[10] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_line;
            (param[11] = new OracleParameter("p_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_seq;
            (param[12] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_stus;
            (param[13] = new OracleParameter("p_itm_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_tax_amt;
            (param[14] = new OracleParameter("p_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_itm_tp;
            (param[15] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_job_line;
            (param[16] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_job_no;
            (param[17] = new OracleParameter("p_merge_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_merge_itm;
            (param[18] = new OracleParameter("p_outlet_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_outlet_dept;
            (param[19] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_pb_lvl;
            (param[20] = new OracleParameter("p_pb_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_pb_price;
            (param[21] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_pbook;
            (param[22] = new OracleParameter("p_print_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_print_stus;
            (param[23] = new OracleParameter("p_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_promo_cd;
            (param[24] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_srn_qty;
            (param[25] = new OracleParameter("p_res_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_res_line_no;
            (param[26] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_res_no;
            (param[27] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_seq;
            (param[28] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_seq_no;
            (param[29] = new OracleParameter("p_srn_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = 0;
            (param[30] = new OracleParameter("p_tot_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_tot_amt;
            (param[31] = new OracleParameter("p_unit_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_unit_amt;
            (param[32] = new OracleParameter("p_unit_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_unit_rt;
            (param[33] = new OracleParameter("p_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_uom;
            (param[34] = new OracleParameter("p_warr_based", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_warr_based;
            (param[35] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_warr_period;
            (param[36] = new OracleParameter("p_warr_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_warr_remarks;
            (param[37] = new OracleParameter("p_sad_isapp", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_isapp; //add chamal 05-12-2012
            (param[38] = new OracleParameter("p_sad_iscovernote", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_iscovernote; //add chamal 05-12-2012
            (param[39] = new OracleParameter("p_dis_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_dis_seq;//Added by darshana on 21/06/2013
            (param[40] = new OracleParameter("p_dis_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_dis_line;//Added by darshana on 21/06/2013
            (param[41] = new OracleParameter("p_dis_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_dis_type;//Added by darshana on 21/06/2013
            (param[42] = new OracleParameter("P_SAD_CONF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_conf_no;//Added by Tharaka 2015-10-16
            (param[43] = new OracleParameter("P_SAD_CONF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_conf_line;//Added by Tharaka 2015-10-16
            (param[44] = new OracleParameter("P_SAD_TRD_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItem.sad_trd_rt;//Added Y THARANGA 2018/05/18
            (param[45] = new OracleParameter("P_SAD_SIM_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItem.Sad_sim_itm_cd;//Added Y THARANGA 2018/05/18
            param[46] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satitm", CommandType.StoredProcedure, param);
            return effects;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Sales Item with Tax breakup
        /// </summary>
        /// <param name="_invoiceItemTax"></param>
        /// <returns> Return the transaction complete 1/0 </returns>
        public Int32 SaveSalesItemTax(InvoiceItemTax _invoiceItemTax)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_inv_no;
            (param[1] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_itm_cd;
            (param[2] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_itm_line;
            (param[3] = new OracleParameter("p_itm_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_itm_tax_amt;
            (param[4] = new OracleParameter("p_itm_tax_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_itm_tax_rt;
            (param[5] = new OracleParameter("p_itm_tax_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_itm_tax_tp;
            (param[6] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_job_line;
            (param[7] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_job_no;
            (param[8] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceItemTax.Satx_seq_no;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satitmtax", CommandType.StoredProcedure, param);
            return effects;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Receipt Header on payment
        /// </summary>
        /// <param name="_recieptHeader"></param>
        /// <returns> Return the transaction complete 1/0</returns>
        public Int32 SaveReceiptHeader(RecieptHeader _recieptHeader)
        {
            OracleParameter[] param = new OracleParameter[61];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_acc_no;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_act;
            (param[2] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_1;
            (param[3] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_2;
            (param[4] = new OracleParameter("p_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_3;
            (param[5] = new OracleParameter("p_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_4;
            (param[6] = new OracleParameter("p_anal_5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_5;
            (param[7] = new OracleParameter("p_anal_6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_6;
            (param[8] = new OracleParameter("p_anal_7", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_7;
            (param[9] = new OracleParameter("p_anal_8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_8;
            (param[10] = new OracleParameter("p_anal_9", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_anal_9;
            (param[11] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_com_cd;
            (param[12] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_comm_amt;
            (param[13] = new OracleParameter("p_create_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_create_by;
            (param[14] = new OracleParameter("p_create_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_create_when;
            (param[15] = new OracleParameter("p_currency_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_currency_cd;
            (param[16] = new OracleParameter("p_debtor_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_debtor_add_1;
            (param[17] = new OracleParameter("p_debtor_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_debtor_add_2;
            (param[18] = new OracleParameter("p_debtor_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_debtor_cd;
            (param[19] = new OracleParameter("p_debtor_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_debtor_name;
            (param[20] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_direct;
            (param[21] = new OracleParameter("p_direct_deposit_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_direct_deposit_bank_cd;
            (param[22] = new OracleParameter("p_direct_deposit_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_direct_deposit_branch;
            (param[23] = new OracleParameter("p_epf_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_epf_rate;
            (param[24] = new OracleParameter("p_esd_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_esd_rate;
            (param[25] = new OracleParameter("p_is_mgr_iss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_is_mgr_iss;
            (param[26] = new OracleParameter("p_is_oth_shop", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_is_oth_shop;
            (param[27] = new OracleParameter("p_is_used", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_is_used;
            (param[28] = new OracleParameter("p_manual_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_manual_ref_no;
            (param[29] = new OracleParameter("p_mob_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_mob_no;
            (param[30] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_mod_by;
            (param[31] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_mod_when;
            (param[32] = new OracleParameter("p_nic_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_nic_no;
            (param[33] = new OracleParameter("p_oth_sr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_oth_sr;
            (param[34] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_prefix;
            (param[35] = new OracleParameter("p_profit_center_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_profit_center_cd;
            (param[36] = new OracleParameter("p_receipt_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_receipt_date;
            (param[37] = new OracleParameter("p_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_receipt_no;
            (param[38] = new OracleParameter("p_receipt_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_receipt_type;
            (param[39] = new OracleParameter("p_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_ref_doc;
            (param[40] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_remarks;
            (param[41] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_seq_no;
            (param[42] = new OracleParameter("p_ser_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_ser_job_no;
            (param[43] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_session_id;
            (param[44] = new OracleParameter("p_tel_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_tel_no;
            (param[45] = new OracleParameter("p_tot_settle_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_tot_settle_amt;
            (param[46] = new OracleParameter("p_uploaded_to_finance", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_uploaded_to_finance;
            (param[47] = new OracleParameter("p_used_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_used_amt;
            (param[48] = new OracleParameter("p_wht_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_wht_rate;
            (param[49] = new OracleParameter("p_is_dayend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_is_dayend;//Added by Prabhath on 20/06/2013
            (param[50] = new OracleParameter("p_sar_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.SAR_VALID_TO;
            (param[51] = new OracleParameter("p_sar_inv_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_inv_type;
            (param[52] = new OracleParameter("p_sar_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_scheme;
            (param[53] = new OracleParameter("p_sar_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.SAR_MGR_CD;
            (param[54] = new OracleParameter("p_sar_colect_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.SAR_COLECT_MGR_CD;
            (param[55] = new OracleParameter("p_SAR_BK_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.SAR_BK_NO;
            (param[56] = new OracleParameter("p_sar_free_reg", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.SAR_FREE_REG;
            (param[57] = new OracleParameter("p_subrec_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_subrec_tp;
            (param[58] = new OracleParameter("p_itmpr_validto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_itmpr_validto;
            (param[59] = new OracleParameter("p_refund_validto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_refund_validto;

            param[60] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satreceipt", CommandType.StoredProcedure, param);
            return effects;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Receipt Header on payment
        /// </summary>
        /// <param name="_recieptHeader"></param>
        /// <returns> Return the transaction complete 1/0</returns>
        public Int32 SaveReceiptHeaderTBS(RecieptHeaderTBS _recieptHeader)
        {
            OracleParameter[] param = new OracleParameter[56];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_acc_no;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_act;
            (param[2] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_1;
            (param[3] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_2;
            (param[4] = new OracleParameter("p_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_3;
            (param[5] = new OracleParameter("p_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_4;
            (param[6] = new OracleParameter("p_anal_5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_5;
            (param[7] = new OracleParameter("p_anal_6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_6;
            (param[8] = new OracleParameter("p_anal_7", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_7;
            (param[9] = new OracleParameter("p_anal_8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_8;
            (param[10] = new OracleParameter("p_anal_9", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_anal_9;
            (param[11] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_com_cd;
            (param[12] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_comm_amt;
            (param[13] = new OracleParameter("p_create_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_create_by;
            (param[14] = new OracleParameter("p_create_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_create_when;
            (param[15] = new OracleParameter("p_currency_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_currency_cd;
            (param[16] = new OracleParameter("p_debtor_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_debtor_add_1;
            (param[17] = new OracleParameter("p_debtor_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_debtor_add_2;
            (param[18] = new OracleParameter("p_debtor_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_debtor_cd;
            (param[19] = new OracleParameter("p_debtor_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_debtor_name;
            (param[20] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_direct;
            (param[21] = new OracleParameter("p_direct_deposit_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_direct_deposit_bank_cd;
            (param[22] = new OracleParameter("p_direct_deposit_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_direct_deposit_branch;
            (param[23] = new OracleParameter("p_epf_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_epf_rate;
            (param[24] = new OracleParameter("p_esd_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_esd_rate;
            (param[25] = new OracleParameter("p_is_mgr_iss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_is_mgr_iss;
            (param[26] = new OracleParameter("p_is_oth_shop", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_is_oth_shop;
            (param[27] = new OracleParameter("p_is_used", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_is_used;
            (param[28] = new OracleParameter("p_manual_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_manual_ref_no;
            (param[29] = new OracleParameter("p_mob_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_mob_no;
            (param[30] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_mod_by;
            (param[31] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_mod_when;
            (param[32] = new OracleParameter("p_nic_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_nic_no;
            (param[33] = new OracleParameter("p_oth_sr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_oth_sr;
            (param[34] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_prefix;
            (param[35] = new OracleParameter("p_profit_center_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_profit_center_cd;
            (param[36] = new OracleParameter("p_receipt_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_receipt_date;
            (param[37] = new OracleParameter("p_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_receipt_no;
            (param[38] = new OracleParameter("p_receipt_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_receipt_type;
            (param[39] = new OracleParameter("p_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_ref_doc;
            (param[40] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_remarks;
            (param[41] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_seq_no;
            (param[42] = new OracleParameter("p_ser_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_ser_job_no;
            (param[43] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_session_id;
            (param[44] = new OracleParameter("p_tel_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_tel_no;
            (param[45] = new OracleParameter("p_tot_settle_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_tot_settle_amt;
            (param[46] = new OracleParameter("p_uploaded_to_finance", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_uploaded_to_finance;
            (param[47] = new OracleParameter("p_used_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_used_amt;
            (param[48] = new OracleParameter("p_wht_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_wht_rate;
            (param[49] = new OracleParameter("p_is_dayend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_is_dayend;//Added by Prabhath on 20/06/2013
            (param[50] = new OracleParameter("p_sar_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_VALID_TO;

            (param[51] = new OracleParameter("p_sar_oth_party", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_oth_party;
            (param[52] = new OracleParameter("p_sar_oth_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_oth_partycd;
            (param[53] = new OracleParameter("p_sar_oth_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_oth_partyname;
            (param[54] = new OracleParameter("p_sar_stleamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sir_oth_partystltamt;

            param[55] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satreceipttbs", CommandType.StoredProcedure, param);
            return effects;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Receipt Item
        /// </summary>
        /// <param name="_recieptItem"></param>
        /// <returns>Return the transaction complete 1/0</returns>
        public Int32 SaveReceiptItem(RecieptItem _recieptItem)
        {
            OracleParameter[] param = new OracleParameter[25];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_anal_1;
            (param[1] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_anal_2;
            (param[2] = new OracleParameter("p_anal_3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptItem.Sard_anal_3;
            (param[3] = new OracleParameter("p_anal_4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptItem.Sard_anal_4;
            (param[4] = new OracleParameter("p_anal_5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptItem.Sard_anal_5;
            (param[5] = new OracleParameter("p_cc_expiry_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptItem.Sard_cc_expiry_dt;
            (param[6] = new OracleParameter("p_cc_is_promo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptItem.Sard_cc_is_promo;
            (param[7] = new OracleParameter("p_cc_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptItem.Sard_cc_period;
            (param[8] = new OracleParameter("p_cc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_cc_tp;
            (param[9] = new OracleParameter("p_chq_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_chq_bank_cd;
            (param[10] = new OracleParameter("p_chq_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_chq_branch;
            (param[11] = new OracleParameter("p_credit_card_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_credit_card_bank;
            (param[12] = new OracleParameter("p_deposit_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_deposit_bank_cd;
            (param[13] = new OracleParameter("p_deposit_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_deposit_branch;
            (param[14] = new OracleParameter("p_gv_issue_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptItem.Sard_gv_issue_dt;
            (param[15] = new OracleParameter("p_gv_issue_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_gv_issue_loc;
            (param[16] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_inv_no;
            (param[17] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptItem.Sard_line_no;
            (param[18] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_pay_tp;
            (param[19] = new OracleParameter("p_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_receipt_no;
            (param[20] = new OracleParameter("p_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_ref_no;
            (param[21] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptItem.Sard_seq_no;
            (param[22] = new OracleParameter("p_settle_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptItem.Sard_settle_amt;
            (param[23] = new OracleParameter("p_sim_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sard_sim_ser;
            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satreceiptitm", CommandType.StoredProcedure, param);
            return effects;
        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Receipt Item
        /// </summary>
        /// <param name="_recieptItem"></param>
        /// <returns>Return the transaction complete 1/0</returns>
        public Int32 SaveReceiptItemTBS(RecieptItemTBS _recieptItem)
        {
            OracleParameter[] param = new OracleParameter[25];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_anal_1;
            (param[1] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_anal_2;
            (param[2] = new OracleParameter("p_anal_3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptItem.Sird_anal_3;
            (param[3] = new OracleParameter("p_anal_4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptItem.Sird_anal_4;
            (param[4] = new OracleParameter("p_anal_5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptItem.Sird_anal_5;
            (param[5] = new OracleParameter("p_cc_expiry_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptItem.Sird_cc_expiry_dt;
            (param[6] = new OracleParameter("p_cc_is_promo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptItem.Sird_cc_is_promo;
            (param[7] = new OracleParameter("p_cc_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptItem.Sird_cc_period;
            (param[8] = new OracleParameter("p_cc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_cc_tp;
            (param[9] = new OracleParameter("p_chq_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_chq_bank_cd;
            (param[10] = new OracleParameter("p_chq_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_chq_branch;
            (param[11] = new OracleParameter("p_credit_card_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_credit_card_bank;
            (param[12] = new OracleParameter("p_deposit_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_deposit_bank_cd;
            (param[13] = new OracleParameter("p_deposit_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_deposit_branch;
            (param[14] = new OracleParameter("p_gv_issue_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recieptItem.Sird_gv_issue_dt;
            (param[15] = new OracleParameter("p_gv_issue_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_gv_issue_loc;
            (param[16] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_inv_no;
            (param[17] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptItem.Sird_line_no;
            (param[18] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_pay_tp;
            (param[19] = new OracleParameter("p_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_receipt_no;
            (param[20] = new OracleParameter("p_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_ref_no;
            (param[21] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recieptItem.Sird_seq_no;
            (param[22] = new OracleParameter("p_settle_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptItem.Sird_settle_amt;
            (param[23] = new OracleParameter("p_sim_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptItem.Sird_sim_ser;
            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satreceiptitmtbs", CommandType.StoredProcedure, param);
            return effects;
        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Invoice Tax
        /// </summary>
        /// <param name="_invoiceTax"></param>
        /// <returns>Return the transaction complete 1/0</returns>
        public Int32 SaveSaleDocumentTax(InvoiceTax _invoiceTax)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceTax.Sadx_inv_no;
            (param[1] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceTax.Sadx_seq_no;
            (param[2] = new OracleParameter("p_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceTax.Sadx_tax_amt;
            (param[3] = new OracleParameter("p_tax_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invoiceTax.Sadx_tax_rt;
            (param[4] = new OracleParameter("p_tax_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceTax.Sadx_tax_tp;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satdoctax", CommandType.StoredProcedure, param);
            return effects;
        }

        /// <summary>
        ///  Written By Prabhath on 03/05/2012
        ///  Save Sales Serials
        /// </summary>
        /// <param name="_invoiceSerial"></param>
        /// <returns>Return the transaction complete 1/0</returns>
        public Int32 SaveSalesSerial(InvoiceSerial _invoiceSerial)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_del_loc;
            (param[1] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_inv_no;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_itm_cd;
            (param[3] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_itm_line;
            (param[4] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_remarks;
            (param[5] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_seq_no;
            (param[6] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_ser_1;
            (param[7] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_ser_2;
            (param[8] = new OracleParameter("p_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_ser_line;
            (param[9] = new OracleParameter("p_sev_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceSerial.Sap_sev_loc;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satser", CommandType.StoredProcedure, param);
            return effects;

        }

        /// <summary>
        /// Written By Prabhath on 03/05/2012
        /// Save Sales Commission
        /// </summary>
        /// <param name="_saleCommission"></param>
        /// <returns>Return the transaction complete 1/0</returns>
        public Int32 SaveSalesCommission(SaleCommission _saleCommission)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_calc_on", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_calc_on;
            (param[1] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_comm_amt;
            (param[2] = new OracleParameter("p_comm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _saleCommission.Sac_comm_line;
            (param[3] = new OracleParameter("p_comm_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_comm_rate;
            (param[4] = new OracleParameter("p_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saleCommission.Sac_invoice_no;
            (param[5] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saleCommission.Sac_itm_cd;
            (param[6] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _saleCommission.Sac_itm_line;
            (param[7] = new OracleParameter("p_pay_mode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saleCommission.Sac_pay_mode;
            (param[8] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _saleCommission.Sac_seq_no;
            (param[9] = new OracleParameter("p_comm_rate_final", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_comm_rate_final;
            (param[10] = new OracleParameter("p_comm_amt_final", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_comm_amt_final;
            (param[11] = new OracleParameter("p_sac_ce_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_ce_rate;
            (param[12] = new OracleParameter("p_sac_ce_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_ce_amt;

            (param[13] = new OracleParameter("p_sac_add_comm_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_add_comm_rate;
            (param[14] = new OracleParameter("p_sac_add_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saleCommission.Sac_add_comm;
            (param[15] = new OracleParameter("p_sac_add_epf", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _saleCommission.Sac_add_epf;

            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_satcom", CommandType.StoredProcedure, param);
            return effects;

        }

        public bool IsValidInvoiceType(string _company, string _profitCenter, string _invType)
        {
            OracleParameter[] param = new OracleParameter[4];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invType;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDefinition = QueryDataTable("tblPriceDefinition", "sp_checkValidInvoiceType", CommandType.StoredProcedure, false, param);
            if (_tblPriceDefinition.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }

        //darshana on 19-06-2012
        public MasterBankAccount GetBankDetails(string _company, string _BankCode, string _AccCode)
        {
            MasterBankAccount _bankAccounts = new MasterBankAccount();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BankCode;
            (param[2] = new OracleParameter("p_acccode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AccCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBusinessCompany = QueryDataTable("tblBankAccounts", "sp_getbankaccounts", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _bankAccounts = DataTableExtensions.ToGenericList<MasterBankAccount>(_tblBusinessCompany, MasterBankAccount.Converter)[0];
            }

            return _bankAccounts;

        }

        public MasterBusinessEntity GetBusinessCompanyDetail(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {
            MasterBusinessEntity _masterBusinessCompany = new MasterBusinessEntity();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompany = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter)[0];
            }
            return _masterBusinessCompany;
        }

        //Chamal 10/04/2014
        public MasterBusinessEntity GetActiveBusinessCompanyDetail(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {
            MasterBusinessEntity _masterBusinessCompany = new MasterBusinessEntity();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetActiveCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompany = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter)[0];
            }
            return _masterBusinessCompany;
        }

        //Nadeeka 28-12-12
        public DataTable GetPromotionByInvoice(string _inv)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_Promotion_by_invoice", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable GetBusinessCompanyDetailTable(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {   // 19/01/2013 Nadeeka

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetCustomerDetail", CommandType.StoredProcedure, false, param);


            return _tblBusinessCompany;

        }

        public DataTable ProcessHPReceiptPrint(string _refNo)
        {   // Nadeeka 13-07-13
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_RefNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_RECEIPT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable ProcessHPReceiptPrintPayment(string _refNo)
        {   // Nadeeka 13-07-13
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_RefNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_RECEIPT_PAYMENT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ProcessHPReceiptList(DateTime _fromDate, DateTime _toDate, string _com, string _pc)
        {   // Nadeeka 20-11-13
            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.sp_getCollectionPayments", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessHPReceiptPrintPayMode(string _refNo)
        {   // Nadeeka 13-07-13
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_RefNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.GLB_HP_RECEIPT_PAYMODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ProcessInsuranceCoverNote(string _refNo)
        {   // Nadeeka 13-03-13
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_InsRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            DataTable _dtResults = QueryDataTable("tbl", "sp_insuranceCoverNote", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable InternalPaymentVoucher(string _vouNo)
        {   // Nadeeka 13-03-13
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_vouNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouNo;
            DataTable _dtResults = QueryDataTable("tbl", "sp_InternalVoucher", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ProcessManagerCommission(string _profit, string _user, string _epfNo, string _comCode, DateTime _fromDate, DateTime _toDate)
        {   // Nadeeka 08-04-13
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_epfNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epfNo;
            (param[3] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[4] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ProcessManagerCommission", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ProcessManagerCollBonus(string _profit, string _user, string _epfNo, string _comCode, DateTime _fromDate, DateTime _toDate)
        {   // Nadeeka 08-04-13
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_epfNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epfNo;
            (param[3] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[4] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ProcessManagerCollBonus", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessVehicleInsurance(string _user, string _comCode, DateTime _fromDate, DateTime _toDate)
        {   // Nadeeka 10-04-13
            OracleParameter[] param = new OracleParameter[5];


            (param[0] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[2] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ProcessVehicleInsurance", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getHPPureCreationDetails(DateTime _fromDate, DateTime _toDate, string _user, string _comCode, string _Pc)
        {   // Sanjeewa 06-06-14
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[5] = new OracleParameter("in_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults = QueryDataTable("tbl", "sp_pure_hp_creation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable DeliveredSalesWithSerial(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_model, string in_Profit)
        {   // Nadeeka 04-07-13
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[11] = new OracleParameter("in_Profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Profit;


            //DataTable _dtResults = QueryDataTable("tblRcc", "pkg_hp_sales_scm2.process_DeliveredSalesSerial", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_delivered_sale_serial", CommandType.StoredProcedure, false, param); // SP Changed due to DB slowness - 2017-05-17 Sanjeewa
            return _dtResults;
        }




        public DataTable GetCutomerDetails(DateTime in_FromDate, DateTime in_ToDate, DateTime in_asatDate, string in_user_id, Int16 in_NoOfMonths, string _com, string _pc, int in_ISlast)
        {   // Sanjeewa 05-10-13
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_asatDate;
            (param[4] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[5] = new OracleParameter("vNoOfMonths", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_NoOfMonths;
            (param[6] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[7] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[8] = new OracleParameter("islast", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_ISlast;
            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_customedetailsnew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetCutomerDetails_ReduceBal(DateTime in_FromDate, DateTime in_ToDate, DateTime in_asatDate, string in_user_id, Int16 in_NoOfMonths, string _com, string _pc, int in_ISlast)
        {   // Nadeeka 27-aug-2014
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_asatDate;
            (param[4] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[5] = new OracleParameter("vNoOfMonths", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_NoOfMonths;
            (param[6] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[7] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[8] = new OracleParameter("islast", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_ISlast;
            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_customedetails_Withint", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetReduceBalInterest(DateTime in_FromDate, DateTime in_ToDate, string _com, string _pc, Int16 _issum, Int16 _isSch)
        {
            // Nadeeka 29-aug-2014
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("issum", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _issum;
            (param[6] = new OracleParameter("in_type", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isSch;
            DataTable _dtResults = QueryDataTable("tblRcc", "sp_calc_reduce_balance_report", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable GetReduceBalInterestAccno(DateTime in_ToDate, string _com, string _pc, string _accNo)
        {
            // Nadeeka 08-04-2015
            OracleParameter[] param = new OracleParameter[6];
            DateTime firstDayOfTheMonth = new DateTime(in_ToDate.Year, in_ToDate.Month, 1);
            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = firstDayOfTheMonth;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblRcc", "sp_calc_reduce_balance_accno", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable GetDiscountPromoDetails(DateTime in_FromDate, DateTime in_ToDate, string in_Circular, string in_equal, string _com, string _pc, string in_user_id)
        {   // Sanjeewa 2014-05-28
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Circular;
            (param[4] = new OracleParameter("in_equal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_equal;
            (param[5] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_disc_promo", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetSalesInfoDetails(DateTime _FromDate, DateTime _ToDate, string _invtp, string _invsubtp, string _com, string _pc, string _user_id)
        {   // Sanjeewa 2015-01-12
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invtp;
            (param[4] = new OracleParameter("in_docsubtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invsubtp;
            (param[5] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_sales_info", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetPriceDefinitionDetails(string _com, string _pc, string _user_id)
        {   // Sanjeewa 2016-05-30
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_price_definition", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetInsurancePremiumDetails(DateTime _FromDate, DateTime _ToDate, string _com, string _pc, string _user_id)
        {   // Sanjeewa 2015-09-04
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_insu_premium_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetRevertInfoDetails(DateTime _FromDate, DateTime _ToDate, string _invtp, string _com, string _pc, string _user_id)
        {   // Sanjeewa 2015-01-12
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invtp;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_revert_info", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetReceivableDetails(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string _com, string _pc, string _item, string _cat, string _stype)
        {   // Nadeeka 20-Jan-2014
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("IN_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("IN_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("IN_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[7] = new OracleParameter("IN_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[8] = new OracleParameter("IN_stype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stype;
            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_HP_Receivable", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ProcessVehicleInsPay(string _user, string _comCode, DateTime _fromDate, DateTime _toDate)
        {   // Nadeeka 17-04-13
            OracleParameter[] param = new OracleParameter[5];


            (param[0] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[2] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ProcessVehicleInsPay", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessVehicleInsClaims(string _user, string _comCode, DateTime _fromDate, DateTime _toDate)
        {   // Nadeeka 17-04-13
            OracleParameter[] param = new OracleParameter[5];


            (param[0] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[2] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ProcessVehicleInsClaims", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessVehicleColletion(string _pc, string _comCode, DateTime _fromDate, DateTime _toDate)
        {   // Nadeeka 02-07-2015
            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[3] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[4] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;

            DataTable _dtResults = QueryDataTable("tbl", "sp_insuranceCollection", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessVehicleInsuranceArrears(string _user, string _comCode, DateTime _fromDate, DateTime _toDate, string _pc)
        {   // Nadeeka 12-06-13
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_INSURANCE_ARREARS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessVehicleInsuranceArrearsDet()
        {   // Nadeeka 12-06-13
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ins_det_rep", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessHPMultipleAccounts(string _user, DateTime _asatDate, string _com, string _scheme, string _cusId, Double _cusAccBal, string _pc)
        {   // Nadeeka 03-06-13
            OracleParameter[] param = new OracleParameter[8];

            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_scmheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[5] = new OracleParameter("in_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusId;
            (param[6] = new OracleParameter("in_bal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusAccBal;
            (param[7] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;


            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_MULTIPLE_ACCOUNTS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<RecieptItem> GetReceiptItemList(string _invoice)
        {
            List<RecieptItem> _recieptItem = new List<RecieptItem>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblRecieptItem = QueryDataTable("tblRecieptItem", "sp_getreceiptitm", CommandType.StoredProcedure, false, param);
            if (_tblRecieptItem.Rows.Count > 0)
            {
                _recieptItem = DataTableExtensions.ToGenericList<RecieptItem>(_tblRecieptItem, RecieptItem.ConvertTotal);
            }

            return _recieptItem;

        }

        public DataTable GetReceiptItemTable(string _invoice)
        {
            RecieptItem _recieptItem = new RecieptItem();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblRecieptItem = QueryDataTable("tblRecieptItem", "sp_getreceiptitm", CommandType.StoredProcedure, false, param);

            return _tblRecieptItem;

        }

        #region Quotation
        //21-5-2012
        public List<QoutationDetails> Get_all_linesForQoutation(string qoutation_no)
        {
            List<QoutationDetails> all_lines = new List<QoutationDetails>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qoutation_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblQout_lineDetail = QueryDataTable("tbl_lineDetail", "SP_Getall_lines_in_Qoutation", CommandType.StoredProcedure, false, param);

            if (_tblQout_lineDetail.Rows.Count > 0)
            {
                all_lines = DataTableExtensions.ToGenericList<QoutationDetails>(_tblQout_lineDetail, QoutationDetails.ConvertTotal);
            }

            return all_lines;
        }
        public List<QuotationHeader> Get_all_Quotations(string p_company, string p_profCenter, string p_supCD, string p_status, string p_fromDT, string p_toDT)
        {
            //  (p_company in NVARCHAR2,p_profCenter in NVARCHAR2,p_supCD in VARCHAR2,p_status in NVARCHAR2,p_fromDT in DATE,p_toDT in DATE,c_data OUT sys_refcursor)
            List<QuotationHeader> _DetailRef = new List<QuotationHeader>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_company;
            (param[1] = new OracleParameter("p_profCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_profCenter;
            (param[2] = new OracleParameter("p_supCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_supCD;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_status;
            (param[4] = new OracleParameter("p_fromDT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_fromDT;
            (param[5] = new OracleParameter("p_toDT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_toDT;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query QUO_HDR table
            DataTable _tblQoutDetail = QueryDataTable("tblPriceDetail", "SP_GET_Supplier_Quotations", CommandType.StoredProcedure, false, param);
            if (_tblQoutDetail.Rows.Count > 0)
            {
                _DetailRef = DataTableExtensions.ToGenericList<QuotationHeader>(_tblQoutDetail, QuotationHeader.ConvertTotal);
            }

            return _DetailRef;

        }

        public Int32 Save_QuotationHDR(QuotationHeader header)
        {
            //save to QUO_HDR
            OracleParameter[] param = new OracleParameter[48];
            (param[0] = new OracleParameter("p_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Qh_seq_no;
            (param[1] = new OracleParameter("p_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_no;
            (param[2] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_com;
            (param[3] = new OracleParameter("p_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_tp;
            (param[4] = new OracleParameter("p_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_sub_tp;
            (param[5] = new OracleParameter("p_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Qh_dt;


            (param[6] = new OracleParameter("p_FRM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Qh_frm_dt;
            (param[7] = new OracleParameter("p_EX_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Qh_ex_dt;
            (param[8] = new OracleParameter("p_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_ref;
            (param[9] = new OracleParameter("p_PARTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_party_cd;
            (param[10] = new OracleParameter("p_PARTY_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_party_name;
            (param[11] = new OracleParameter("p_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_add1;

            (param[12] = new OracleParameter("p_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_add2;
            (param[13] = new OracleParameter("p_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_tel;
            (param[14] = new OracleParameter("p_MOBI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_mobi;
            (param[15] = new OracleParameter("p_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_email;
            (param[16] = new OracleParameter("p_REMARKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_remarks;
            (param[17] = new OracleParameter("p_CUR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_cur_cd;
            (param[18] = new OracleParameter("p_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = header.Qh_ex_rt;

            (param[19] = new OracleParameter("p_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_stus;
            (param[20] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_pc;
            (param[21] = new OracleParameter("p_SALES_EX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_sales_ex;
            (param[22] = new OracleParameter("p_IS_TAX", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Qh_is_tax;
            (param[23] = new OracleParameter("p_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_jobno;
            (param[24] = new OracleParameter("p_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_cre_by;

            (param[25] = new OracleParameter("p_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Qh_cre_when;
            (param[26] = new OracleParameter("p_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_mod_by;
            (param[27] = new OracleParameter("p_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Qh_mod_when;
            (param[28] = new OracleParameter("p_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_session_id;
            (param[29] = new OracleParameter("p_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_anal_1;
            (param[30] = new OracleParameter("p_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_anal_2;

            (param[31] = new OracleParameter("p_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_anal_3;
            (param[32] = new OracleParameter("p_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_anal_4;
            (param[33] = new OracleParameter("p_ANAL_5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Qh_anal_5;
            (param[34] = new OracleParameter("p_ANAL_6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Qh_anal_6;
            (param[35] = new OracleParameter("p_ANAL_7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Qh_anal_7;
            (param[36] = new OracleParameter("p_ANAL_8", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Qh_anal_8;
            (param[37] = new OracleParameter("p_qh_del_cuscd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cuscd;
            (param[38] = new OracleParameter("p_qh_del_cusname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cusname;
            (param[39] = new OracleParameter("p_qh_del_cusadd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cusadd1;
            (param[40] = new OracleParameter("p_qh_del_cusadd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cusadd2;
            (param[41] = new OracleParameter("p_qh_del_custel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_custel;
            (param[42] = new OracleParameter("p_qh_del_cusfax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cusfax;
            (param[43] = new OracleParameter("p_qh_del_cusid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cusid;
            (param[44] = new OracleParameter("p_qh_del_cusvatreg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_del_cusvatreg;
            (param[45] = new OracleParameter("p_qh_add_wararmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Qh_add_wararmk;
            (param[46] = new OracleParameter("p_qh_quo_base", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Qh_quo_base;
            param[47] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects = (Int16)UpdateRecords("sp_save_QUO_HDR", CommandType.StoredProcedure, param);
            return effects;

        }

        public QuotationHeader Get_Quotation_HDR(string quotation_no)
        {
            //Query the QUO_DHR table
            QuotationHeader q_header;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = quotation_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblQout_HDR = QueryDataTable("tbl_HDR", "SP_Get_Qoutation_HDR", CommandType.StoredProcedure, false, param);

            if (_tblQout_HDR.Rows.Count > 0)
            {
                q_header = DataTableExtensions.ToGenericList<QuotationHeader>(_tblQout_HDR, QuotationHeader.ConvertTotal)[0];
            }
            else
            {
                return q_header = null;
            }
            return q_header;

        }

        public Int32 Update_Quotation_HDR_status(string quotation_no, string newStatus)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = quotation_no;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = newStatus;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_updateQoutation_HDR_status", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Update_Quotation_HDR_DO(string quotation_no, string _inv, string _do)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = quotation_no;
            (param[1] = new OracleParameter("p_do", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _do;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_updateQoutation_do", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Delete_Quotation_DET(string quotation_no)
        {
            //delete all quataion lines from the QUO_DET table which are belong to this quotation No.
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = quotation_no;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_Delete_Quo_det", CommandType.StoredProcedure, param);
            return effects;
        }



        public Int32 Save_QuotationDET(List<QoutationDetails> det_line_list)
        {
            Int32 count = 0;
            foreach (QoutationDetails line in det_line_list)
            {
                //save to QUO_HDR
                OracleParameter[] param = new OracleParameter[38];
                (param[0] = new OracleParameter("p_qd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_seq_no;
                (param[1] = new OracleParameter("p_qd_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_line_no;
                (param[2] = new OracleParameter("p_qd_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_no;

                (param[3] = new OracleParameter("p_qd_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_itm_cd;
                (param[4] = new OracleParameter("p_qd_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_itm_desc;
                (param[5] = new OracleParameter("p_qd_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_itm_stus == null ? "1" : line.Qd_itm_stus;


                (param[6] = new OracleParameter("p_qd_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_uom == null ? "1" : line.Qd_uom;
                (param[7] = new OracleParameter("p_qd_quo_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_quo_tp == null ? "1" : line.Qd_quo_tp;
                (param[8] = new OracleParameter("p_qd_frm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_frm_qty == null ? 1 : line.Qd_frm_qty;
                (param[9] = new OracleParameter("p_qd_to_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_to_qty == null ? 1 : line.Qd_to_qty;
                (param[10] = new OracleParameter("p_qd_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_unit_price == null ? 1 : line.Qd_unit_price;
                (param[11] = new OracleParameter("p_qd_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_amt == null ? 1 : line.Qd_amt;

                (param[12] = new OracleParameter("p_qd_dit_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_dit_rt == null ? 1 : line.Qd_dit_rt;
                (param[13] = new OracleParameter("p_qd_dis_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_dis_amt == null ? 1 : line.Qd_dis_amt;
                (param[14] = new OracleParameter("p_qd_itm_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_itm_tax == null ? 1 : line.Qd_itm_tax;
                (param[15] = new OracleParameter("p_qd_tot_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_tot_amt == null ? 1 : line.Qd_tot_amt;
                (param[16] = new OracleParameter("p_qd_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_pbook;
                (param[17] = new OracleParameter("p_qd_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_pb_lvl;

                (param[18] = new OracleParameter("p_qd_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_pb_seq;
                (param[19] = new OracleParameter("p_qd_pb_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_pb_price == null ? 1 : line.Qd_pb_price;
                (param[20] = new OracleParameter("p_qd_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_res_no;
                (param[21] = new OracleParameter("p_qd_resreq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_resreq_no;
                (param[22] = new OracleParameter("p_qd_resline_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_resline_no == null ? 1 : line.Qd_resline_no;
                if (!string.IsNullOrEmpty(line.Qd_resitm_cd))
                {
                    if (line.Qd_resitm_cd.Length > 20)
                    {
                        line.Qd_resitm_cd = line.Qd_resitm_cd.Substring(0, 20).ToString();
                    }
                }
                (param[23] = new OracleParameter("p_qd_resitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_resitm_cd;

                (param[24] = new OracleParameter("p_qd_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_res_qty;
                (param[25] = new OracleParameter("p_qd_resbal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_resbal_qty;
                (param[26] = new OracleParameter("p_qd_nitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_nitm_cd;
                (param[27] = new OracleParameter("p_qd_nitm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_nitm_desc;
                (param[28] = new OracleParameter("p_qd_issue_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_issue_qty;
                (param[29] = new OracleParameter("p_qd_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_unit_cost;


                (param[30] = new OracleParameter("p_qd_cost_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_cost_amt;
                (param[31] = new OracleParameter("p_qd_cdoc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_cdoc_no;
                (param[32] = new OracleParameter("p_qd_citm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_citm_line;
                (param[33] = new OracleParameter("p_qd_cbatch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_cbatch_line;
                (param[34] = new OracleParameter("p_qd_warr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_warr_rmk;
                (param[35] = new OracleParameter("p_qd_warr_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_warr_pd;
                (param[36] = new OracleParameter("p_qd_quo_base", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_quo_base;

                param[37] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int16)UpdateRecords("sp_save_QUO_DET", CommandType.StoredProcedure, param);

                if (effects > 0)
                    count++;

            }

            return count;


        }
        #endregion Quotation

        public Int32 SavePriceLevel(PriceBookLevelRef _level)
        {
            OracleParameter[] param = new OracleParameter[29];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_act;
            (param[1] = new OracleParameter("p_base_on_tot_inv_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _level.Sapl_base_on_tot_inv_qty;
            (param[2] = new OracleParameter("p_chk_st_tp", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_chk_st_tp;
            (param[3] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_com_cd;
            (param[4] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_cre_by;
            (param[5] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _level.Sapl_cre_when;
            (param[6] = new OracleParameter("p_credit_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _level.Sapl_credit_period;
            (param[7] = new OracleParameter("p_currency_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_currency_cd;
            (param[8] = new OracleParameter("p_erp_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_erp_ref;
            (param[9] = new OracleParameter("p_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_grn_com;
            (param[10] = new OracleParameter("p_is_def", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_def;
            (param[11] = new OracleParameter("p_is_for_po", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_for_po;
            (param[12] = new OracleParameter("p_is_pos", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_pos;
            (param[13] = new OracleParameter("p_is_print", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_print;
            (param[14] = new OracleParameter("p_is_sales", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_sales;
            (param[15] = new OracleParameter("p_is_serialized", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_serialized;
            (param[16] = new OracleParameter("p_is_transfer", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_transfer;
            (param[17] = new OracleParameter("p_is_valid", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_valid;
            (param[18] = new OracleParameter("p_is_without_p", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_is_without_p;
            (param[19] = new OracleParameter("p_itm_stuts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_itm_stuts;
            (param[20] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_mod_by;
            (param[21] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _level.Sapl_mod_when;
            (param[22] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_pb;
            (param[23] = new OracleParameter("p_pb_lvl_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_pb_lvl_cd;
            (param[24] = new OracleParameter("p_pb_lvl_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level.Sapl_pb_lvl_desc;
            (param[25] = new OracleParameter("p_set_warr", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_set_warr;
            (param[26] = new OracleParameter("p_vat_calc", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _level.Sapl_vat_calc;
            (param[27] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _level.Sapl_warr_period;
            param[28] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_pb_lvl", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SavePriceBook(PriceBookRef _book)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _book.Sapb_act;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book.Sapb_com;
            (param[2] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book.Sapb_cre_by;
            (param[3] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _book.Sapb_cre_when;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book.Sapb_desc;
            (param[5] = new OracleParameter("p_hierachy_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _book.Sapb_hierachy_lvl;
            (param[6] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book.Sapb_mod_by;
            (param[7] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _book.Sapb_mod_when;
            (param[8] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book.Sapb_pb;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_pb", CommandType.StoredProcedure, param);
            return effects;
        }



        public Int32 SavePriceBookDefinition(sar_pb_def _pbdef)
        { // Nadeeka 04-09-2015


            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_spd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbdef.Spd_seq;
            (param[1] = new OracleParameter("p_spd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_com;
            (param[2] = new OracleParameter("p_spd_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_circular;
            (param[3] = new OracleParameter("p_spd_base_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_base_pb;
            (param[4] = new OracleParameter("p_spd_base_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_base_pblvl;
            (param[5] = new OracleParameter("p_spd_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_pb;
            (param[6] = new OracleParameter("p_spd_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_pblvl;
            (param[7] = new OracleParameter("p_spd_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_type;
            (param[8] = new OracleParameter("p_spd_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pbdef.Spd_from.Date;
            (param[9] = new OracleParameter("p_spd_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pbdef.Spd_to.Date;
            (param[10] = new OracleParameter("p_spd_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbdef.Spd_act;
            (param[11] = new OracleParameter("p_spd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_cre_by;
            (param[12] = new OracleParameter("p_spd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_mod_by;
            (param[13] = new OracleParameter("p_spd_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spd_cate;
            (param[14] = new OracleParameter("p_spd_price_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbdef.SPD_PRICE_TYPE;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_sar_pb_def", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SavePriceBookDefinitionDet(sar_pb_def_det _pbdef)
        { // Nadeeka 04-09-2015


            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_spdd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbdef.Spdd_seq;
            (param[1] = new OracleParameter("p_spdd_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_item;
            (param[2] = new OracleParameter("p_spdd_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_cat1;
            (param[3] = new OracleParameter("p_spdd_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_cat2;
            (param[4] = new OracleParameter("p_spdd_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_cat3;
            (param[5] = new OracleParameter("p_spdd_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_cat4;
            (param[6] = new OracleParameter("p_spdd_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_cat5;
            (param[7] = new OracleParameter("p_spdd_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_brand;
            (param[8] = new OracleParameter("p_spdd_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbdef.Spdd_active;
            (param[9] = new OracleParameter("p_spdd_margin", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pbdef.Spdd_margin;
            (param[10] = new OracleParameter("p_spdd_ch_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdef.Spdd_ch_code;
            (param[11] = new OracleParameter("p_spdd_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbdef.Spdd_line_no;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_sar_pb_def_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public int DeletepbDefDet(Int32 _seqNo)
        { // NADEEKA   
            int effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_spdd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_delete_pdDef_det", CommandType.StoredProcedure, param);

            return effect;
        }

        //Nadeeka 2014-12-31
        public Int32 GetPricedefSeq()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getpriceDefSeq", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<MasterInvoiceType> GetAllInvoiceType()
        {
            List<MasterInvoiceType> _masterInvoiceType = new List<MasterInvoiceType>();
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceType = QueryDataTable("tblInvoiceType", "sp_getallinvoicetype", CommandType.StoredProcedure, false, param);
            if (_tblInvoiceType.Rows.Count > 0)
            {
                _masterInvoiceType = DataTableExtensions.ToGenericList<MasterInvoiceType>(_tblInvoiceType, MasterInvoiceType.ConvertTotal);
            }

            return _masterInvoiceType;

        }


        public Int32 SavePriceDefinition(PriceDefinitionRef _priceDef)
        {
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_p_lvl;
            (param[3] = new OracleParameter("p_is_bank_ex_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_is_bank_ex_rt;
            (param[4] = new OracleParameter("p_is_disc", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_is_disc;
            (param[5] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDef.Sadd_disc_rt;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_com;
            (param[7] = new OracleParameter("p_chk_credit_bal", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_chk_credit_bal;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_cre_by;
            (param[9] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDef.Sadd_cre_when;
            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_mod_by;
            (param[11] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDef.Sadd_mod_when;
            (param[12] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_pb;
            (param[13] = new OracleParameter("p_def", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_def;
            (param[14] = new OracleParameter("p_def_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_def_stus;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_sar_doc_price_defn", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<PriceCategoryRef> GetAllPriceCategory(string _code)
        {
            List<PriceCategoryRef> _list = new List<PriceCategoryRef>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getallpricecategory", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceCategoryRef>(_tblData, PriceCategoryRef.ConvertTotal);
            }
            return _list;
        }

        public List<PriceTypeRef> GetAllPriceType(string _code)
        {
            List<PriceTypeRef> _list = new List<PriceTypeRef>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getallpricetype", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceTypeRef>(_tblData, PriceTypeRef.ConvertTotal);
            }

            return _list;

        }

        public List<PriceSerialRef> GetAllPriceSerial(string _book, string _level, string _item, DateTime _date, string _customer)
        {
            List<PriceSerialRef> _list = new List<PriceSerialRef>();
            // sp_getallserialprice ( p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_date in date,p_customer in NVARCHAR2,p_serial in NVARCHAR2,  c_data OUT SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getallserialprice", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblData, PriceSerialRef.ConverterWithPriceType);
            }
            return _list;

        }

        public List<PriceSerialRef> GetAllPriceSerialFromSerial(string _book, string _level, string _item, DateTime _date, string _customer, string _serial)
        {
            List<PriceSerialRef> _list = new List<PriceSerialRef>();
            // sp_getallserialprice ( p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_date in date,p_customer in NVARCHAR2,p_serial in NVARCHAR2,  c_data OUT SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getallserialprice", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblData, PriceSerialRef.ConverterWithPriceType);
            }
            return _list;

        }

        //kapila 15/6/2015
        public DataTable GetAllPriceSerialData(string _book, string _level, string _item, DateTime _date, string _customer, string _serial)
        {

            // sp_getallserialprice ( p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_date in date,p_customer in NVARCHAR2,p_serial in NVARCHAR2,  c_data OUT SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getallserialprice", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public Int16 UpdateQuotationDocNo(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_quono", CommandType.StoredProcedure, param);
            return effects;

        }

        //Written By Prabhath on 01/06/2012
        public List<MasterItemTax> GetItemTax(string _company, string _item, string _status, string _taxCode, string _taxRateCode)
        {
            //sp_getitemtax   (p_com in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2 , p_taxcode in NVARCHAR2,p_taxratecode in NVARCHAR2, c_data  OUT sys_refcursor)
            List<MasterItemTax> _list = new List<MasterItemTax>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_taxcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxCode;
            (param[4] = new OracleParameter("p_taxratecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxRateCode;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitemtax", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemTax>(_tblData, MasterItemTax.ConvertTotal);
            }

            return _list;


        }

        //Written By kapila 26/8/2015
        public List<MasterItemTax> GetItemTax_strucbase(string _company, string _item, string _status, string _taxCode, string _taxRateCode, string _struc)
        {
            //sp_getitemtax   (p_com in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2 , p_taxcode in NVARCHAR2,p_taxratecode in NVARCHAR2, c_data  OUT sys_refcursor)
            List<MasterItemTax> _list = new List<MasterItemTax>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_taxcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxCode;
            (param[4] = new OracleParameter("p_taxratecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxRateCode;
            (param[5] = new OracleParameter("p_struc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _struc;
            //   (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitemtax_struc_base", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemTax>(_tblData, MasterItemTax.ConvertTotal);
            }

            return _list;


        }
        //Written By Prabhath on 04/05/2012
        public List<InventoryBatchRefN> GetConsumerProductPriceList(string _company, string _location, string _item, string _status)
        {
            //CREATE OR REPLACE PROCEDURE sp_getcosumerproductprice
            //(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2, c_data  OUT sys_refcursor)        

            List<InventoryBatchRefN> _list = new List<InventoryBatchRefN>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getcosumerproductprice", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryBatchRefN>(_tblData, InventoryBatchRefN.Converter);
            }

            return _list;

        }

        //written by darshana 20-07-2012
        public Int32 UpdateAccountStatus(string _com, string _pc, string _acc, string _inv, string _status)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_updateaccountstus", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateInvoiceReceipts(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_INVOICE_RECEIPT_NO", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateInvoiceAcc(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_invoice_acc", CommandType.StoredProcedure, param);
            return effects;
        }


        public Int32 UpdateAgreementBalance(string _Agree, Decimal _Amt)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_Agree", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Agree;
            (param[1] = new OracleParameter("p_Amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Amt;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_SerAgreement", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdateAgreementSchedule(string _Agree, Decimal _Amt, Int32 _term)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_Agree", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Agree;
            (param[1] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _term;
            (param[2] = new OracleParameter("p_Amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Amt;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_SerAgreementSch", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateInvoiceWithTaxCommission(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updt_invrececommtax", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateReceipt(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updt_receipt", CommandType.StoredProcedure, param);
            return effects;
        }

        //Add Chamal 11/04/2014
        public Int32 UpdateReceiptHS(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno, string _accNo)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            (param[4] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updt_receiptHS", CommandType.StoredProcedure, param);
            return effects;
        }

        //Code by Chamal 03-08-2012
        public Int32 UpdateHPTTransNo(string _newNo, Int32 _oldNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_oldno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _oldNo;
            (param[1] = new OracleParameter("p_newno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_hpttransno", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateInvRevQty(string _invoicno, string _item, decimal _qty, Int32 _lineNo, decimal _fwsQty)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[3] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            (param[4] = new OracleParameter("p_fwsQty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _fwsQty;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_inv_rev_qty", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<InterCompanySalesParameter> GetInterCompanyParameter(string _admintm, string _fromCompany, string _fromProfit, string _toCompany, string _toProfit)
        {
            //sp_getintercompanyparameter (p_admintm in NVARCHAR2, p_fromcom in VARCHAR2,p_fromprofit in NVARCHAR2,p_tocom in NVARCHAR2,p_toprofit in NVARCHAR2, c_data OUT sys_refcursor)
            List<InterCompanySalesParameter> _list = new List<InterCompanySalesParameter>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_admintm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _admintm;
            (param[1] = new OracleParameter("p_fromcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromCompany;
            (param[2] = new OracleParameter("p_fromprofit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromProfit;
            (param[3] = new OracleParameter("p_tocom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toCompany;
            (param[4] = new OracleParameter("p_toprofit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toProfit;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getintercompanyparameter", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InterCompanySalesParameter>(_tblData, InterCompanySalesParameter.Converter);
            }

            return _list;
        }

        public Int16 SaveCustomerAccount(CustomerAccountRef _customerAccountRef)
        {
            //sp_savecustomeraccount
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_acc_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_acc_bal;
            (param[1] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_com_cd;
            (param[2] = new OracleParameter("p_crdt_lmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_crdt_lmt;
            (param[3] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_cre_by;
            (param[4] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_cre_when;
            (param[5] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_cust_cd;
            (param[6] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_mod_by;
            (param[7] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_mod_when;
            (param[8] = new OracleParameter("p_ord_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_ord_bal;
            (param[9] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerAccountRef.Saca_session_id;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_savecustomeraccount", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 SaveCustomerDetail(MasterBusinessEntity _businessCompany)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[23];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_cd;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_tp;

            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_busentity", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2016-07-25
        public Int16 SaveSunCustomer(MasterBusinessEntity _businessCompany)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[9];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_cd;
            (param[1] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_add1;
            (param[2] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_add2;
            (param[3] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_mob;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_name;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_com;
            (param[6] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.Mbe_tp;
            (param[7] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompany.mbe_ref_no;



            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_busentityFORSUN", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<PaymentTypeRef> GetAllPaymentType(string _company, string _profitCenter, string _code)
        {
            //sp_getpaytype   (p_cd in NVARCHAR2, c_data OUT sys_refcursor)
            List<PaymentTypeRef> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getpaytype", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PaymentTypeRef>(_tblData, PaymentTypeRef.ConvertTotal);
            }
            return _list;
        }

        public List<string> GetAdjType()
        {
            //sp_getpaytype   (p_cd in NVARCHAR2, c_data OUT sys_refcursor)
            List<string> _list = null;
            OracleParameter[] param = new OracleParameter[1]; 
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getadjtype", CommandType.StoredProcedure, false, param);
            _list= new List<string>();
            foreach (DataRow dr in _tblData.Rows)
            {
                _list.Add(dr[0].ToString());
            }
            return _list;
        }

        public DataTable GetAllRepPriceType()
        {
            //Sanjeewa 2013-07-23
            List<PaymentTypeRef> _list = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getpricetype", CommandType.StoredProcedure, false, param);

            //if (_tblData.Rows.Count > 0)
            //{
            //    _list = DataTableExtensions.ToGenericList<PaymentTypeRef>(_tblData, PaymentTypeRef.ConvertTotal);
            //}
            return _tblData;
        }
        //dilshan on 08/11/2018
        public DataTable GetAllinvType()
        {
            //Sanjeewa 2013-07-23
            List<PaymentTypeRef> _list = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvtype", CommandType.StoredProcedure, false, param);

            //if (_tblData.Rows.Count > 0)
            //{
            //    _list = DataTableExtensions.ToGenericList<PaymentTypeRef>(_tblData, PaymentTypeRef.ConvertTotal);
            //}
            return _tblData;
        }

        //kapila 14/6/2012
        public DataTable GetInvDet(string _InvNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblSalesDet", "sp_get_invoice_det", CommandType.StoredProcedure, false, param);

            return _dtResult;

        }
        //Shanuka Perera 21/May/2014
        public DataTable GetOutItemDet(string _invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblOutItm", "SP_GETOUTITEMSDETALS", CommandType.StoredProcedure, false, param);

            return _dtResult;
        }

        //shanuka perera 23/May/2014
        public DataTable GetNewOutItems(string _invoiceNo, string _itemcde, double price, string serial, string scm)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcde;
            (param[2] = new OracleParameter("p_price", OracleDbType.Double, null, ParameterDirection.Input)).Value = price;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scm;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblNewOutItm", "SP_ADD_NEW_OUTITEMS", CommandType.StoredProcedure, false, param);

            return _dtResult;

        }

        //kapila 11/3/2013
        public DataTable GetInvWarrDet(string _InvNo, Int32 _seq, Int32 _itmLine, Int32 _batchLine, Int32 _serLine)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[2] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmLine;
            (param[3] = new OracleParameter("p_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batchLine;
            (param[4] = new OracleParameter("p_serline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serLine;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblSalesDet", "sp_get_inv_war", CommandType.StoredProcedure, false, param);

            return _dtResult;

        }

        //darshana 16/06/2012
        public bool IsValidReceiptType(string _company, string _type)
        {
            OracleParameter[] param = new OracleParameter[3];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblvalidsupplier = QueryDataTable("tblvalidrectype", "sp_checkvalidrectype", CommandType.StoredProcedure, false, param);
            if (_tblvalidsupplier.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }

        //darshana 20/06/2012
        public decimal GetOutInvAmt(string _company, string _pc, string _cus, string _inv)
        {

            InvoiceHeader _InvoiceList = null;

            OracleParameter[] param = new OracleParameter[5];
            decimal _Amt = 0;
            decimal _InvAmt = 0;
            decimal _PayAmt = 0;
            decimal _RevAmt = 0;
            string curre = "";
            decimal rate = 1;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_pc == "All")
            {
                _dtResults = QueryDataTable("tbloutinvamt", "SP_GETOUTSTANDINGINV2", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tbloutinvamt", "sp_getoutstandinginv", CommandType.StoredProcedure, false, param);
            }


            if (_dtResults.Rows.Count > 0)
            {
                //_InvoiceList = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResults, InvoiceHeader.ConvertTotal)[0];
                _InvAmt = (_dtResults.Rows[0]["Sah_anal_7"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["Sah_anal_7"]);
                _PayAmt = (_dtResults.Rows[0]["Sah_anal_8"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["Sah_anal_8"]);
                //  _RevAmt = (_dtResults.Rows[0]["sah_pdi_req"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["sah_pdi_req"]);  //kapila 22/12/2016 instructed by dilanda
                curre = (_dtResults.Rows[0]["sah_currency"].ToString());
                rate = (_dtResults.Rows[0]["sah_ex_rt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["sah_ex_rt"]);
            }
            _Amt = _InvAmt - (_PayAmt + _RevAmt);
            if (curre != "LKR")
            {
                _Amt = _Amt * rate;
            }

            return _Amt;
        }
        public decimal GetOutInvAmtWeb(string _company, string _pc, string _cus, string _inv)
        {

            InvoiceHeader _InvoiceList = null;

            OracleParameter[] param = new OracleParameter[5];
            decimal _Amt = 0;
            decimal _InvAmt = 0;
            decimal _PayAmt = 0;
            decimal _RevAmt = 0;
            string curre = "";
            decimal rate = 1;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbloutinvamt", "sp_getoutdinvweb", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //_InvoiceList = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResults, InvoiceHeader.ConvertTotal)[0];
                _InvAmt = (_dtResults.Rows[0]["Sah_anal_7"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["Sah_anal_7"]);
                _PayAmt = (_dtResults.Rows[0]["Sah_anal_8"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["Sah_anal_8"]);
                //  _RevAmt = (_dtResults.Rows[0]["sah_pdi_req"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["sah_pdi_req"]);  //kapila 22/12/2016 instructed by dilanda
                curre = (_dtResults.Rows[0]["sah_currency"].ToString());
                rate = (_dtResults.Rows[0]["sah_ex_rt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["sah_ex_rt"]);
            }
            _Amt = _InvAmt - (_PayAmt + _RevAmt);
            if (curre != "LKR")
            {
                _Amt = _Amt * rate;
            }

            return _Amt;
        }
        public decimal GetOutInvAmtTBS(string _company, string _pc, string _cus, string _inv)
        {

            InvoiceHeader _InvoiceList = null;

            OracleParameter[] param = new OracleParameter[5];
            decimal _Amt = 0;
            decimal _InvAmt = 0;
            decimal _PayAmt = 0;
            decimal _RevAmt = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbloutinvamt", "sp_getoutstandinginvtbs", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //_InvoiceList = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResults, InvoiceHeader.ConvertTotal)[0];
                _InvAmt = (_dtResults.Rows[0]["Sih_anal_7"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["Sih_anal_7"]);
                _PayAmt = (_dtResults.Rows[0]["Sih_anal_8"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["Sih_anal_8"]);
                _RevAmt = (_dtResults.Rows[0]["sih_pdi_req"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["sih_pdi_req"]);
            }
            _Amt = _InvAmt - (_PayAmt + _RevAmt);
            return _Amt;
        }

        //darshana 20/06/2012
        public bool IsValidDivision(string _company, string _pc, string _cd)
        {
            OracleParameter[] param = new OracleParameter[4];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblvalidsupplier = QueryDataTable("tblvaliddivision", "sp_checkvaliddivision", CommandType.StoredProcedure, false, param);
            if (_tblvalidsupplier.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }

        public Int16 UpdateInvoiceSettleAmt(string _com, string _pc, string _cus, string _inv, decimal _amt)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            if (_pc == "All")
            {
                effects = (Int16)UpdateRecords("sp_updateoutstandingamt2", CommandType.StoredProcedure, param);
            }
            else
            {
                effects = (Int16)UpdateRecords("sp_updateoutstandingamt", CommandType.StoredProcedure, param);
            }


            return effects;
        }

        public Int16 UpdateInvoiceSettleAmtTBS(string _com, string _pc, string _cus, string _inv, decimal _amt)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateoutstandingamttbs", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana get receipt
        public RecieptHeader GetReceiptHeader(string _com, string _pc, string _doc)
        {
            RecieptHeader _ReceiptList = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_getreceiptheader", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal)[0];
            }
            return _ReceiptList;
        }

        //Chamal 15/08/2012
        public RecieptHeader GetReceiptHeaderBaseReceiptType(string _com, string _pc, string _doc, string _type)
        {
            RecieptHeader _ReceiptList = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_getreceiptheaderbytp", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotalNew)[0];
            }
            return _ReceiptList;
        }

        public List<RecieptItem> GetReceiptDetails(string receipt_no)
        {
            List<RecieptItem> _RecItemList = null;
            RecieptItem _RecItems = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receipt_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tblRecItems", "sp_getreceiptdetails", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _RecItemList = new List<RecieptItem>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _RecItems = new RecieptItem();

                    _RecItems.Sard_seq_no = (_dtResults.Rows[i]["Sard_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Sard_seq_no"]);
                    _RecItems.Sard_line_no = (_dtResults.Rows[i]["Sard_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Sard_line_no"]);
                    _RecItems.Sard_receipt_no = (_dtResults.Rows[i]["Sard_receipt_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_receipt_no"].ToString();
                    _RecItems.Sard_inv_no = (_dtResults.Rows[i]["Sard_inv_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_inv_no"].ToString();
                    _RecItems.Sard_pay_tp = (_dtResults.Rows[i]["Sard_pay_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_pay_tp"].ToString();
                    _RecItems.Sard_ref_no = (_dtResults.Rows[i]["Sard_ref_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_ref_no"].ToString();
                    _RecItems.Sard_chq_bank_cd = (_dtResults.Rows[i]["Sard_chq_bank_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_chq_bank_cd"].ToString();
                    _RecItems.Sard_chq_branch = (_dtResults.Rows[i]["Sard_chq_branch"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_chq_branch"].ToString();
                    _RecItems.Sard_deposit_bank_cd = (_dtResults.Rows[i]["Sard_deposit_bank_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_deposit_bank_cd"].ToString();
                    _RecItems.Sard_deposit_branch = (_dtResults.Rows[i]["Sard_deposit_branch"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_deposit_branch"].ToString();
                    _RecItems.Sard_credit_card_bank = (_dtResults.Rows[i]["Sard_credit_card_bank"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_credit_card_bank"].ToString();
                    _RecItems.Sard_cc_tp = (_dtResults.Rows[i]["Sard_cc_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_cc_tp"].ToString();
                    _RecItems.Sard_cc_expiry_dt = (_dtResults.Rows[i]["Sard_cc_expiry_dt"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Sard_cc_expiry_dt"]);
                    _RecItems.Sard_cc_is_promo = (_dtResults.Rows[i]["Sard_cc_is_promo"] == DBNull.Value) ? false : Convert.ToBoolean(_dtResults.Rows[i]["Sard_cc_is_promo"]);
                    _RecItems.Sard_cc_period = (_dtResults.Rows[i]["Sard_cc_period"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Sard_cc_period"]);
                    _RecItems.Sard_gv_issue_loc = (_dtResults.Rows[i]["Sard_gv_issue_loc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_gv_issue_loc"].ToString();
                    _RecItems.Sard_gv_issue_dt = (_dtResults.Rows[i]["Sard_gv_issue_dt"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Sard_gv_issue_dt"]);
                    _RecItems.Sard_settle_amt = (_dtResults.Rows[i]["Sard_settle_amt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Sard_settle_amt"]);
                    _RecItems.Sard_sim_ser = (_dtResults.Rows[i]["Sard_sim_ser"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_sim_ser"].ToString();
                    _RecItems.Sard_anal_1 = (_dtResults.Rows[i]["Sard_anal_1"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_anal_1"].ToString();
                    _RecItems.Sard_anal_2 = (_dtResults.Rows[i]["Sard_anal_2"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sard_anal_2"].ToString();
                    _RecItems.Sard_anal_3 = (_dtResults.Rows[i]["Sard_anal_3"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Sard_anal_3"]);
                    _RecItems.Sard_anal_4 = (_dtResults.Rows[i]["Sard_anal_4"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Sard_anal_4"]);
                    _RecItems.Sard_anal_5 = (_dtResults.Rows[i]["Sard_anal_5"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Sard_anal_5"]);
                    _RecItemList.Add(_RecItems);
                }

            }

            return _RecItemList;

        }

        public List<RecieptItemTBS> GetReceiptDetailsTBS(string receipt_no)
        {
            List<RecieptItemTBS> _RecItemList = null;
            RecieptItemTBS _RecItems = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receipt_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tblRecItems", "sp_getreceiptdetailstbs", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _RecItemList = new List<RecieptItemTBS>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _RecItems = new RecieptItemTBS();

                    _RecItems.Sird_seq_no = (_dtResults.Rows[i]["Sird_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Sird_seq_no"]);
                    _RecItems.Sird_line_no = (_dtResults.Rows[i]["Sird_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Sird_line_no"]);
                    _RecItems.Sird_receipt_no = (_dtResults.Rows[i]["Sird_receipt_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_receipt_no"].ToString();
                    _RecItems.Sird_inv_no = (_dtResults.Rows[i]["Sird_inv_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_inv_no"].ToString();
                    _RecItems.Sird_pay_tp = (_dtResults.Rows[i]["Sird_pay_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_pay_tp"].ToString();
                    _RecItems.Sird_ref_no = (_dtResults.Rows[i]["Sird_ref_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_ref_no"].ToString();
                    _RecItems.Sird_chq_bank_cd = (_dtResults.Rows[i]["Sird_chq_bank_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_chq_bank_cd"].ToString();
                    _RecItems.Sird_chq_branch = (_dtResults.Rows[i]["Sird_chq_branch"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_chq_branch"].ToString();
                    _RecItems.Sird_deposit_bank_cd = (_dtResults.Rows[i]["Sird_deposit_bank_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_deposit_bank_cd"].ToString();
                    _RecItems.Sird_deposit_branch = (_dtResults.Rows[i]["Sird_deposit_branch"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_deposit_branch"].ToString();
                    _RecItems.Sird_credit_card_bank = (_dtResults.Rows[i]["Sird_credit_card_bank"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_credit_card_bank"].ToString();
                    _RecItems.Sird_cc_tp = (_dtResults.Rows[i]["Sird_cc_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_cc_tp"].ToString();
                    _RecItems.Sird_cc_expiry_dt = (_dtResults.Rows[i]["Sird_cc_expiry_dt"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Sird_cc_expiry_dt"]);
                    _RecItems.Sird_cc_is_promo = (_dtResults.Rows[i]["Sird_cc_is_promo"] == DBNull.Value) ? false : Convert.ToBoolean(_dtResults.Rows[i]["Sird_cc_is_promo"]);
                    _RecItems.Sird_cc_period = (_dtResults.Rows[i]["Sird_cc_period"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Sird_cc_period"]);
                    _RecItems.Sird_gv_issue_loc = (_dtResults.Rows[i]["Sird_gv_issue_loc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_gv_issue_loc"].ToString();
                    _RecItems.Sird_gv_issue_dt = (_dtResults.Rows[i]["Sird_gv_issue_dt"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Sird_gv_issue_dt"]);
                    _RecItems.Sird_settle_amt = (_dtResults.Rows[i]["Sird_settle_amt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Sird_settle_amt"]);
                    _RecItems.Sird_sim_ser = (_dtResults.Rows[i]["Sird_sim_ser"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_sim_ser"].ToString();
                    _RecItems.Sird_anal_1 = (_dtResults.Rows[i]["Sird_anal_1"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_anal_1"].ToString();
                    _RecItems.Sird_anal_2 = (_dtResults.Rows[i]["Sird_anal_2"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Sird_anal_2"].ToString();
                    _RecItems.Sird_anal_3 = (_dtResults.Rows[i]["Sird_anal_3"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Sird_anal_3"]);
                    _RecItems.Sird_anal_4 = (_dtResults.Rows[i]["Sird_anal_4"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Sird_anal_4"]);
                    _RecItems.Sird_anal_5 = (_dtResults.Rows[i]["Sird_anal_5"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Sird_anal_5"]);
                    _RecItemList.Add(_RecItems);
                }

            }

            return _RecItemList;

        }

        public Int16 UpdateRecStatus(string _recno, Boolean _status, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[1] = new OracleParameter("p_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_updaterec_hdr_status", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateRecStatusTBS(string _recno, Boolean _status, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[1] = new OracleParameter("p_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterec_hdr_statustbs", CommandType.StoredProcedure, param);
            return effects;
        }

        #region Hire Purchase

        #region Collection
        //Shani 15-06-2012
        public List<MasterProfitCenter> GetAllProfCenters()
        {
            List<MasterProfitCenter> _userList = null;

            OracleParameter[] param = new OracleParameter[1];
            //(param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = UserID;
            //(param[1] = new OracleParameter("p_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Comp;
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_get_all_profcenters", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<MasterProfitCenter>(_dtResults, MasterProfitCenter.ConvertTotal);
            }

            return _userList;
        }
        public List<PaymentType> GetPossiblePaymentTypes(string pc, string txn_tp, DateTime today)
        {
            List<PaymentType> _userList = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_txn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txn_tp;
            (param[2] = new OracleParameter("p_current_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = today;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_get_Possible_paytypes", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<PaymentType>(_dtResults, PaymentType.Converter);
            }

            return _userList;
        }

        public List<PaymentType> GetPossiblePaymentTypes_new(string _com, string _party, string _cd, string txn_tp, DateTime today, Int32 _isBOCN)
        {
            List<PaymentType> _userList = null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[3] = new OracleParameter("p_txn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txn_tp;
            (param[4] = new OracleParameter("p_current_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = today;
            (param[5] = new OracleParameter("p_is_BOCN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isBOCN;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_get_posible_pay_tps_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<PaymentType>(_dtResults, PaymentType.Converter);
            }

            return _userList;
        }

        //darshana get all districts - 28-06-2012
        public List<DistrictProvince> GetDistrict(string _pCode)
        {
            List<DistrictProvince> _userList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblDistrict", "sp_get_all_district", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<DistrictProvince>(_dtResults, DistrictProvince.Converter);
            }

            return _userList;
        }


        public List<HpAccount> GetHP_Accounts(string com, string pc, string seqNo, string status)
        {
            List<HpAccount> _userList = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_seqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNo;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_getHp_Accounts", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            }

            return _userList;
        }

        public List<HpAccount> GetHP_Accounts_Adj(string com, string pc, string seqNo, string status, DateTime _date)
        {
            List<HpAccount> _userList = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_seqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNo;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[4] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_getHp_Accounts_adj", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            }

            return _userList;
        }

        public List<string> GetAll_prifixes(string channel, string docTP, Int32 status)
        {
            List<string> _userList = new List<string>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[1] = new OracleParameter("p_docTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docTP;
            (param[2] = new OracleParameter("p_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblprifix", "sp_getAllPrifix", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow r in _dtResults.Rows)
                {
                    // Get the value of the wanted column and cast it to string
                    string st = Convert.ToString(r["HPF_PFX"]);
                    _userList.Add(st);
                }
            }

            return _userList;
        }
        public List<GntManualDocument> Get_valid_Man_ReceiptNo()
        {
            List<GntManualDocument> _userList = null;

            OracleParameter[] param = new OracleParameter[1];
            //(param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = UserID;
            //(param[1] = new OracleParameter("p_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Comp;
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_get_ReceiptNo_valid", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<GntManualDocument>(_dtResults, GntManualDocument.Converter);
            }

            return _userList;
        }
        //public Decimal Get_AccountBalance(string pc, string accNo)
        //{
        //    Decimal balance = 0; 
        //    OracleParameter[] param = new OracleParameter[3];
        //    (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
        //    (param[1] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
        //   param[2] = new OracleParameter("c_bal", OracleDbType.Decimal, null, ParameterDirection.Output);
        //   balance = (Decimal)UpdateRecords("sp_CalcHP_AccBalance", CommandType.StoredProcedure, param);

        //   return balance;
        //}
        public Decimal Get_AccountBalance(DateTime date, string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[1] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_bal", OracleDbType.Decimal, null, ParameterDirection.Output);
            //Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue("sp_getintserline", CommandType.StoredProcedure, _outParam, param));
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_AccBalance", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public Decimal Get_MonthlyRental(DateTime date, string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[1] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_MON_rent", OracleDbType.Decimal, null, ParameterDirection.Output);
            //Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue("sp_getintserline", CommandType.StoredProcedure, _outParam, param));
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_MonthRental", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        //public Int32 GetSerialID()
        //{
        //    OracleParameter[] param = new OracleParameter[1];
        //    Int16 effects = 0;
        //    param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
        //    effects = (Int16)UpdateRecords("sp_getserialid", CommandType.StoredProcedure, param);
        //    return effects;
        //}

        public Decimal Get_FutureRentals(DateTime date, string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[1] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_Future_rents", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_FutureRental", CommandType.StoredProcedure, _outParam, param));
            }
            catch (Exception ex)
            { return effects; }

            return effects;
        }


        public RecieptHeader Get_ReceiptHeader(string prefix, string seqNo)
        {
            RecieptHeader _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_prifix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prefix;
            (param[1] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_receipt_hdr", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal)[0];
            }
            return _ReceiptList;
        }
        public List<RecieptHeader> Get_ReceiptHeaderList(string prefix, string seqNo)
        {
            List<RecieptHeader> _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_prifix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prefix;
            (param[1] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_receipt_hdr", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal);
            }
            return _ReceiptList;
        }
        //Chamal 12-07-2012
        public List<RecieptHeader> Get_ReceiptHeaderListALL(string _parm, string _type)
        {
            List<RecieptHeader> _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_parm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _parm;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_receipthdrall", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal);
            }
            return _ReceiptList;
        }

        //Chamal 12-07-2012
        public DataTable Get_ReceiptHeaderTableALL(string _parm, string _type)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_parm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _parm;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_receipthdrall", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Receipt_Sett_Det(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_rec_sett_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Receipts_Rem_Det(string _com, string _pc, string _user, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_financial.sp_get_rec_4_rem_dt", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Save_HpTransaction(HpTransaction _transaction)
        {

            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_hpt_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_ref_no;
            (param[1] = new OracleParameter("p_hpt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_pc;
            (param[2] = new OracleParameter("p_hpt_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_acc_no;
            (param[3] = new OracleParameter("p_hpt_txn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _transaction.Hpt_txn_dt;
            (param[4] = new OracleParameter("p_hpt_txn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_txn_tp;
            (param[5] = new OracleParameter("p_hpt_txn_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_txn_ref;
            (param[6] = new OracleParameter("p_hpt_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_desc;
            (param[7] = new OracleParameter("p_hpt_mnl_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_mnl_ref;
            (param[8] = new OracleParameter("p_hpt_dbt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _transaction.Hpt_dbt;
            (param[9] = new OracleParameter("p_hpt_crdt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _transaction.Hpt_crdt;
            (param[10] = new OracleParameter("p_hpt_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _transaction.Hpt_bal;
            (param[11] = new OracleParameter("p_hpt_ars", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _transaction.Hpt_ars;
            (param[12] = new OracleParameter("p_hpt_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_cre_by;
            (param[13] = new OracleParameter("p_hpt_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _transaction.Hpt_cre_dt;
            (param[14] = new OracleParameter("p_hpt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction.Hpt_com;
            (param[15] = new OracleParameter("p_hpt_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _transaction.Hpt_seq;

            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_HP_transaction", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable Get_hpAcc_TransactionDet(string AccountNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_Get_Acc_transaction_Det", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        public Decimal Get_TotFutureRentalValue(DateTime firstDateOfNextMonth, string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_firstDt_ofNextMonth", OracleDbType.Date, null, ParameterDirection.Input)).Value = firstDateOfNextMonth;
            (param[1] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_bal", OracleDbType.Decimal, null, ParameterDirection.Output);
            //Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue("sp_getintserline", CommandType.StoredProcedure, _outParam, param));
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_FutureRentalValue", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public DataTable Get_Manager_Issue_rec(string AccountNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_man_iss_rec", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public DataTable GetReceiptDetByChqNo(string _chqno, Int32 _isAll)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_chqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqno;
            (param[1] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_recbychqno", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public DataTable Get_Manager_receive_rec(string AccountNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_recv_rec", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public DataTable Get_hpHierachy(string pc)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_hp_hierachy", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public DataTable Get_ECD(string ecdTp, DateTime date, string scheme, string partyTP, string partyCD, Decimal futureRentals, string AccNo, Int32 IsReduce)
        { //p_ecdTP in NVARCHAR2,p_date in Date,p_scheme in NVARCHAR2,p_partyTP in NVARCHAR2,p_partyCD in NVARCHAR2,p_futureRents in number,p_accNo in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_ecdTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ecdTp;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[2] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scheme;
            (param[3] = new OracleParameter("p_partyTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyTP;
            (param[4] = new OracleParameter("p_partyCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            (param[5] = new OracleParameter("p_futureRents", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = futureRentals;
            (param[6] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccNo;
            (param[7] = new OracleParameter("p_is_reduce", OracleDbType.Int32, null, ParameterDirection.Input)).Value = IsReduce;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblECD", "sp_get_ECD", CommandType.StoredProcedure, false, param);

            return _dtResults;
            //if (_dtResults.Rows.Count > 0)
            //{ 

            //}
        }
        public HpAccount GetHP_Account_onAccNo(string AccountNo)
        {
            HpAccount _Acc = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_getHp_Account_onAccNo", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _Acc = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter)[0];

            }

            return _Acc;
        }

        public Int32 UpdateHpReceipt(string _receiptNo, Decimal newAmt, string _com, string _pc, RecieptHeader rhd)
        {
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;
            (param[1] = new OracleParameter("p_newAount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = newAmt;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            (param[4] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rhd.Sar_acc_no;
            (param[5] = new OracleParameter("p_is_oth_shop", OracleDbType.Int32, null, ParameterDirection.Input)).Value = rhd.Sar_is_oth_shop;
            (param[6] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rhd.Sar_comm_amt;
            (param[7] = new OracleParameter("p_coll_comm_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rhd.Sar_anal_5;

            (param[8] = new OracleParameter("p_addi_comm_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rhd.Sar_anal_6;
            (param[9] = new OracleParameter("p_addi_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rhd.Sar_anal_7;

            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rhd.Sar_mod_by;
            (param[11] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = rhd.Sar_mod_when;
            (param[12] = new OracleParameter("p_othershopCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rhd.Sar_oth_sr;
            (param[13] = new OracleParameter("p_is_mgr_iss", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rhd.Sar_is_mgr_iss;
            (param[14] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rhd.Sar_remarks;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("SP_update_hp_ReceiptHdr", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Delete_HpReceiptDet(string _receiptNo, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;

            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_Delete_hp_Receipt_Det", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Delete_hpTransactions(string _receiptNo, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;

            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_Delete_hp_Transactions", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Delete_Hp_Receipt(string _receiptNo, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;

            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_Delete_hp_Receipt", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Get_TotReciptsForAccount(string accNo)
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_recipts", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = Convert.ToInt32(ReturnSP_SingleValue("sp_CalcHP_FutureRental", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public Int32 UpdateHp_Transaction(HpTransaction tr)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            // p_receipt_no in NVARCHAR2,p_acc_no in NVARCHAR2,p_pc in NVARCHAR2,p_descript in NVARCHAR2,p_txnDt in Date,o_effect OUT NUMBER)
            (param[0] = new OracleParameter("p_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tr.Hpt_txn_ref;

            (param[1] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tr.Hpt_acc_no;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tr.Hpt_pc;
            (param[3] = new OracleParameter("p_descript", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tr.Hpt_desc;
            (param[4] = new OracleParameter("p_txnDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = tr.Hpt_txn_dt;
            (param[5] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = tr.Hpt_crdt;
            (param[6] = new OracleParameter("p_mnl_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tr.Hpt_mnl_ref;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_Update_hp_Transaction", CommandType.StoredProcedure, param);
            return effects;
        }
        public Decimal Get_hp_additionalCommision(DateTime receipt_date, string scheme, Decimal inst_comRate)
        {   //p_date in DATE,p_scheme in NVARCHAR2,p_InstComRate in NUMBER,c_AddiComRate OUT NUMBER
            OracleParameter[] param = new OracleParameter[3];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = receipt_date;
            (param[1] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scheme;
            (param[2] = new OracleParameter("p_InstComRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inst_comRate;
            OracleParameter _outParam = new OracleParameter("c_AddiComRate", OracleDbType.Decimal, null, ParameterDirection.Output);
            //Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue("sp_getintserline", CommandType.StoredProcedure, _outParam, param));
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_Cal_HP_AdditionalComm", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public DataTable Get_ArrearsInfo(DateTime lastDayOfPrevMonth, string partyTP, string partyCD)
        {
            //p_lastDayOfPrevMonth in Date,p_partyTP in NVARCHAR2,p_partyCD in NVARCHAR2,c_data OUT sys_refc
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_lastDayOfPrevMonth", OracleDbType.Date, null, ParameterDirection.Input)).Value = lastDayOfPrevMonth;
            (param[1] = new OracleParameter("p_partyTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyTP;
            (param[2] = new OracleParameter("p_partyCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_ArrInfo", "sp_getHP_ArrearsInfo", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public Decimal Get_hp_TotalDue(string accNo, DateTime ars_date)
        {  // p_ars_date in DATE,c_totDue OUT NUMBER)
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
            OracleParameter _outParam = new OracleParameter("c_totDue", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_TotDue", CommandType.StoredProcedure, _outParam, param));
                return effects;
            }
            catch (Exception ex) { return 0; }


        }
        public Decimal Get_hp_TotalDue_onType(string accNo, DateTime ars_date, string type, string receiptNo, DateTime receiptDt)
        {
            //-----commented on 03-12-2012---------------------
            //#region


            ////p_accNo in VARCHAR2,p_ars_date in DATE,p_typeofDue in VARCHAR2 ,c_totDue OUT NUMBER
            //OracleParameter[] param = new OracleParameter[3];
            //Decimal effects = 0;
            //(param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            //(param[1] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
            //(param[2] = new OracleParameter("p_typeofDue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            //OracleParameter _outParam = new OracleParameter("c_totDue", OracleDbType.Decimal, null, ParameterDirection.Output);
            //try
            //{
            //    effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_TotDue_onTypes", CommandType.StoredProcedure, _outParam, param));

            //    // Decimal settlement = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_settlement_onTypes", CommandType.StoredProcedure, _outParam, param));
            //    // return effects - settlement;
            //}
            //catch (Exception ex) { return 0; }

            //try
            //{
            //    // (p_accNo in VARCHAR2,p_ars_date in DATE,p_typeofDue in VARCHAR2,p_receiptNo in NVARCHAR2 ,c_totDue OUT NUMBER)
            //    OracleParameter[] param1 = new OracleParameter[4];

            //    (param1[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            //    (param1[1] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
            //    (param1[2] = new OracleParameter("p_typeofDue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            //    (param1[3] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receiptNo;
            //    OracleParameter _outParam1 = new OracleParameter("c_totDue", OracleDbType.Decimal, null, ParameterDirection.Output);
            //    Decimal settlement = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_settlement_onTypes", CommandType.StoredProcedure, _outParam1, param1));

            //    return effects - settlement;
            //}
            //catch (Exception ex) { return effects; }
            //#endregion
            //-----commented on 03-12-2012---------------------
            Decimal effects = 0;
            try
            {

                // (p_accNo in VARCHAR2,p_ars_date in DATE,p_typeofDue in VARCHAR2,p_receiptNo in NVARCHAR2 ,c_totDue OUT NUMBER)
                OracleParameter[] param1 = new OracleParameter[5];

                (param1[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
                (param1[1] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
                (param1[2] = new OracleParameter("p_typeofDue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
                (param1[3] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receiptNo;
                (param1[4] = new OracleParameter("p_receipt_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = receiptDt;
                OracleParameter _outParam1 = new OracleParameter("c_totDue", OracleDbType.Decimal, null, ParameterDirection.Output);
                Decimal settlement = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_finalTotDue_onTypes", CommandType.StoredProcedure, _outParam1, param1));

                return settlement;
            }
            catch (Exception ex) { return effects; }
        }
        public Decimal Get_hp_ArrearsSettlement(string accNo, DateTime sup_date)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = sup_date;
            OracleParameter _outParam = new OracleParameter("c_settle", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_HP_Arrears_Settlement", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public Decimal Get_hp_AllDue(string accNo, DateTime ars_date, DateTime sup_date)
        {
            OracleParameter[] param = new OracleParameter[3];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            (param[1] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
            (param[2] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = sup_date;
            OracleParameter _outParam = new OracleParameter("c_settle", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_CalcHP_AllDue", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public Decimal Get_hp_MinArrears(string partyTP, string partyCD)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_partyTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyTP;
            (param[1] = new OracleParameter("p_partyCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            OracleParameter _outParam = new OracleParameter("c_hsyVal", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_getHP_Min_Arrears", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public Decimal Get_hp_Adjustment(string accNo)
        {
            OracleParameter[] param = new OracleParameter[1];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            OracleParameter _outParam = new OracleParameter("c_adj", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_HP_Arrears_Adjustment", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        public Decimal Get_hp_Tot_Receipts(string accNo, DateTime date)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;

            OracleParameter _outParam = new OracleParameter("c_count", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("SP_Get_tot_Receipts", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public DataTable validate_Voucher(DateTime receiptDt, string AccNo, string voucherNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = receiptDt;
            (param[1] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccNo;
            (param[2] = new OracleParameter("p_vouNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_vouchers", "sp_validateHP_voucher", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public Int32 Cancel_hp_receipt(string com, string prifix, string receiptNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_prifix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prifix;
            (param[2] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receiptNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int32)UpdateRecords("sp_cancelHP_recipt", CommandType.StoredProcedure, param);
            return effects;
        }

        public string GetHpCustomerName(string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "SP_Get_hp_customer", CommandType.StoredProcedure, false, param);
            try
            {
                if (tblDet.Rows.Count > 0)
                {
                    //return tblDet.Rows[0][0].ToString(); 
                    return tblDet.Rows[0]["mbe_name"].ToString(); //edit by shani 04/06/2013
                }
                else
                {
                    return string.Empty;
                }

            }
            catch (Exception ex) { return string.Empty; }

            //return tblDet.Rows[0][0].ToString(); 

        }

        /// <summary>
        /// get quotation email address by quo number DULANGA 2017-2-7
        /// </summary>
        /// <param name="quo"></param>
        /// <returns></returns>
        public string GetQuoCustomerMail(string quo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = quo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "SP_Get_customer_email_quo", CommandType.StoredProcedure, false, param);
            try
            {
                if (tblDet.Rows.Count > 0)
                {
                    return tblDet.Rows[0]["mbe_email"].ToString();
                }
                else
                {
                    return string.Empty;
                }

            }
            catch (Exception ex) { return string.Empty; }
        }

        public DateTime Get_EndingDate(string AccNo)
        {
            DateTime endingDate = DateTime.Today.Date; ;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblendDate", "sp_GetHP_end_Date", CommandType.StoredProcedure, false, param);
            try
            {
                if (_dtResults.Rows.Count > 0)
                {
                    endingDate = Convert.ToDateTime(_dtResults.Rows[0][0]);
                    return endingDate;
                }
                else
                {
                    return endingDate;
                }
            }
            catch (Exception ex) { return endingDate; }


        }
        public Int32 Update_hp_accountStatus(string com, string pc, string accountNo, string new_status, Int32 isECDgiven, string typeofECDgiven, DateTime date_)
        {
            //           (p_com in NVARCHAR2,p_pc in NVARCHAR2,p_acc_no in NVARCHAR2,
            //p_status in NVARCHAR2,p_isECDclose NUMBER,p_ecdType NVARCHAR2 ,p_updationDate in DATE,o_effect OUT NUMBER)

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            // p_receipt_no in NVARCHAR2,p_acc_no in NVARCHAR2,p_pc in NVARCHAR2,p_descript in NVARCHAR2,p_txnDt in Date,o_effect OUT NUMBER)
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = new_status;
            (param[4] = new OracleParameter("p_isECDclose", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isECDgiven;
            (param[5] = new OracleParameter("p_ecdType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = typeofECDgiven;
            (param[6] = new OracleParameter("p_updationDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = date_;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_Update_hp_Account_Status", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Update_hp_Voucher_Status(string com, string pc, string accountNo, string voucherNo, Decimal ECDvalue, Decimal collectAmount, DateTime date_)
        {
            //           (p_com in NVARCHAR2,p_pc in NVARCHAR2,p_acc_no in NVARCHAR2,p_voucherNo in NVARCHAR2,
            //p_useDate in DATE,p_ecdValue in DECIMAL,p_collectedAmt in DECIMAL,o_effect OUT NUMBER)

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            (param[3] = new OracleParameter("p_voucherNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            (param[4] = new OracleParameter("p_useDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = date_;
            (param[5] = new OracleParameter("p_ecdValue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ECDvalue;
            (param[6] = new OracleParameter("p_collectedAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = collectAmount;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_Update_hp_Voucher_Status", CommandType.StoredProcedure, param);
            return effects;
        }
        public Decimal Get_MaxHpReceiptAmount(string hsyCD, string parytyTP, string partyCD)
        {
            // p_hsy_cd in NVARCHAR2, p_pty_tp in NVARCHAR2, p_pty_cd in NVARCHAR2, c_maxAmt OUT NUMBER

            OracleParameter[] param = new OracleParameter[3];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_hsy_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsyCD;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = parytyTP;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            OracleParameter _outParam = new OracleParameter("c_maxAmt", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("get_maxHpReceiptAmt", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public DataTable Get_ESD_EPF_WHT(string com, string pc, DateTime p_reciptDate)
        {
            //   p_com in NVARCHAR2, p_pc in NVARCHAR2,p_reciptDate in DATE, c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_reciptDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_reciptDate;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblReceiptHeader", "get_GET_ESD_EPF_WHT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Decimal Get_ProtectionPayment_RefundValue(string accNo)
        {
            //gets the vehicle protection Payment Refund value
            //p_accNo in VARCHAR2,c_refundVal OUT NUMBER
            OracleParameter[] param = new OracleParameter[1];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            OracleParameter _outParam = new OracleParameter("c_refundVal", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_GetHP_ProtectionRefund", CommandType.StoredProcedure, _outParam, param));
                if (effects == -1)
                {
                    return 0;
                }
                else
                {
                    return effects;
                }
            }
            catch (Exception ex)
            {
                return 0;
            }


        }

        public RecieptHeader Get_last_ReceiptHeaderOfTheDay(DateTime date, string AccNo)
        {
            //(p_date in DATE,p_accountNo in NVARCHAR2, c_data OUT sys_refcursor)
            RecieptHeader _Receipt = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[1] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccNo;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_latest_HPreceipt_hdr", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _Receipt = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal)[0];
            }
            return _Receipt;
        }
        public Decimal Get_Diriya_CommissionRate(string accNo, DateTime ars_date)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_byDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
            //(param[2] = new OracleParameter("p_typeofDue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            OracleParameter _outParam = new OracleParameter("c_commRt", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_Get_Diriya_CommissionRt", CommandType.StoredProcedure, _outParam, param));
                return effects;
            }
            catch (Exception ex) { return 0; }


        }
        #endregion Collection


        #endregion Hire Purchase

        public RecieptHeader GetReceiptHeaderByInvoice(string _invoice)
        {
            //sp_getreceiptbyinvoice (p_invoice in VARCHAR2, c_data OUT sys_refcursor)
            RecieptHeader _header = new RecieptHeader();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblReciept = QueryDataTable("tblReciept", "sp_getreceiptbyinvoice", CommandType.StoredProcedure, false, param);
            if (tblReciept.Rows.Count > 0)
            {
                _header = DataTableExtensions.ToGenericList<RecieptHeader>(tblReciept, RecieptHeader.ConvertTotal)[0];
            }

            return _header;

        }

        //kapila
        public RecieptHeader GetReceiptHdrByManualRef(string _manref)
        {
            RecieptHeader _header = new RecieptHeader();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblReciept = QueryDataTable("tblReciept", "sp_gerreceiptbymanualref", CommandType.StoredProcedure, false, param);
            if (tblReciept.Rows.Count > 0)
            {
                _header = DataTableExtensions.ToGenericList<RecieptHeader>(tblReciept, RecieptHeader.ConvertTotal)[0];
            }
            return _header;

        }

        //written by Prabhath on 25/06/2012
        public List<LoyaltyMemeber> GetCustomerLoyality(string _customer, string _cardno, DateTime _date)
        {
            //SP_getcustomerloyality  (p_customer in NVARCHAR2,p_cardno in NVARCHAR2,p_date in DATE, c_data OUT sys_refcursor)
            List<LoyaltyMemeber> _list = new List<LoyaltyMemeber>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[1] = new OracleParameter("p_cardno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getcustomerloyality", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_tblData, LoyaltyMemeber.Converter);
            }
            return _list;

        }

        //written by Prabhath on 25/06/2012
        public List<LoyaltyType> GetLoyalityType(string _cardtype, string _item, DateTime _date)
        {
            //SP_getloyalitycard  (p_cardtype in NVARCHAR2,p_date in date, c_data OUT sys_refcursor)
            List<LoyaltyType> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cardtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardtype;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getloyalitycard", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LoyaltyType>(_tblData, LoyaltyType.Converter);
            }
            return _list;

        }

        public List<LoyaltyPointDiscount> GetLoyaltyDiscount(string _locyaltyType, string _partyType, string _party, DateTime _date, decimal _point, string _pricebook, string _pricelevel)
        {
            //PROCEDURE sp_getloyaltydiscount  (p_tp in NVARCHAR2,p_prt_tp in NVARCHAR2,p_prt in NVARCHAR2,
            //p_date in date,p_pt in NUMBER,p_pb in NVARCHAR2,p_lvl in NVARCHAR2, c_data OUT sys_refcursor)

            List<LoyaltyPointDiscount> _list = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locyaltyType;
            (param[1] = new OracleParameter("p_prt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partyType;
            (param[2] = new OracleParameter("p_prt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _point;
            (param[5] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricebook;
            (param[6] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricelevel;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbData", "sp_getloyaltydiscount", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LoyaltyPointDiscount>(_tblData, LoyaltyPointDiscount.Converter);
            }
            return _list;
        }

        public List<LoyaltyPriorityCode> GetLoyaltyPriority(string _company)
        {
            //PROCEDURE sp_getloyaltycheckingorder  (p_com in NVARCHAR2, c_data OUT sys_refcursor)
            List<LoyaltyPriorityCode> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getloyalitycard", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LoyaltyPriorityCode>(_tblData, LoyaltyPriorityCode.Converter);
            }
            return _list;
        }

        public List<InvoiceItem> GetInvoiceDetailByInvoice(string _invoice)
        {
            //sp_getinvoiceitembyinvoice  (p_invno IN NVARCHAR2,c_data OUT sys_refcursor)
            List<InvoiceItem> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoiceitembyinvoice", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceItem>(_tblData, InvoiceItem.ConvertTotal);
            }
            return _list;
        }
        public DataTable GetInvoiceDetailByInvoiceTable(string _invoice)
        {
            //sp_getinvoiceitembyinvoice  (p_invno IN NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoiceitembyinvoice", CommandType.StoredProcedure, false, param);


            return _tblData;
        }

        //written by darshana 02-07-2012
        public BlackListCustomers GetBlackListCustomerDetails(string _cusCode, Int32 _active)
        {
            BlackListCustomers _blackListCustomers = null; //Chamal 16-Jun-2016

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusCode;
            (param[1] = new OracleParameter("p_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _active;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBlackListCustomers = QueryDataTable("tblBlackListCustomers", "sp_checkcusblacklist", CommandType.StoredProcedure, false, param);
            if (_tblBlackListCustomers.Rows.Count > 0)
            {
                _blackListCustomers = DataTableExtensions.ToGenericList<BlackListCustomers>(_tblBlackListCustomers, BlackListCustomers.Converter)[0];
            }

            return _blackListCustomers;
        }

        //written by darshana 04/07/2012
        public MasterItem getMasterItemDetails(string _company, string _item, Int16 _active)
        {
            MasterItem _masterItemDetails = new MasterItem();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _active;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblcompanyitem = QueryDataTable("tblvalidcompanyitem", "sp_checkvalidcompanyitem", CommandType.StoredProcedure, false, param);
            if (_tblcompanyitem.Rows.Count > 0)
            {
                _masterItemDetails = DataTableExtensions.ToGenericList<MasterItem>(_tblcompanyitem, MasterItem.ConvertItemSearch)[0];
            }

            return _masterItemDetails;
        }

        //written by darshana 13/07/2012
        public HpSchemeDetails getSchemeDetails(string _type, string _value, Int16 _active, string _cd)
        {
            HpSchemeDetails _SchemeDetails = new HpSchemeDetails();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_active", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _active;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedetails = QueryDataTable("tblschemedetails", "sp_getschemedetails", CommandType.StoredProcedure, false, param);
            if (_tblschemedetails.Rows.Count > 0)
            {
                _SchemeDetails = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tblschemedetails, HpSchemeDetails.Converter)[0];
            }

            return _SchemeDetails;
        }

        //written by darshana 06-07-2012
        public Int32 SaveTempPrice(TempCommonPrice _tempPrice)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_tcp_pb_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_pb_cd;
            (param[1] = new OracleParameter("p_tcp_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_pb_lvl;
            (param[2] = new OracleParameter("p_tcp_pb_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_pb_desc;
            (param[3] = new OracleParameter("p_tcp_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_itm;
            (param[4] = new OracleParameter("p_tcp_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_price;
            (param[5] = new OracleParameter("p_tcp_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_usr;
            (param[6] = new OracleParameter("p_tcp_ip", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_ip;
            (param[7] = new OracleParameter("p_tcp_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tempPrice.tcp_qty;
            (param[8] = new OracleParameter("p_tcp_total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tempPrice.tcp_total;
            (param[9] = new OracleParameter("p_tcp_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempPrice.tcp_itm_desc;
            (param[10] = new OracleParameter("p_tcp_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_pb_seq;
            (param[11] = new OracleParameter("p_tcp_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tempPrice.Tcp_itm_seq;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_com_book_temp", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 DeleteTempPrice(string usr, string IP, string itm)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_tcp_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = usr;
            (param[1] = new OracleParameter("p_tcp_ip", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IP;
            (param[2] = new OracleParameter("p_tcp_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_com_price_temp", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 DeleteMgrIssueReceive(Int32 _seqno, string _com, string _pc, string _recno, Decimal _val)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[4] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_mgr_iss_rcv", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<TempCommonPrice> GetCommonPriceBook(string _user, string _ip, Int32 _count)
        {
            List<TempCommonPrice> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_ip", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ip;
            (param[2] = new OracleParameter("p_count", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _count;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_gettempbookcommon", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<TempCommonPrice>(_tblData, TempCommonPrice.ConverterTemp);
            }
            return _list;
        }

        public List<PriceDefinitionRef> GetPriceBooksForPC(string _com, string _pc, string _type)
        {
            List<PriceDefinitionRef> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getpricedefinition_pc", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceDefinitionRef>(_tblData, PriceDefinitionRef.ConvertSelect);
            }
            return _list;

        }

        public List<TempCommonPrice> GetItemsWithPrice(string _user, string _ip, string _pb, string _lvl)
        {
            List<TempCommonPrice> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_ip", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ip;
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[3] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getselectitemprices", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<TempCommonPrice>(_tblData, TempCommonPrice.ConverterWithItem);
            }
            return _list;
        }

        //darshana 15/07/2012
        public List<HpServiceCharges> getServiceCharges(string _type, string _value, string _cd)
        {
            List<HpServiceCharges> _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getservicechargedetails", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpServiceCharges>(_tblData, HpServiceCharges.Converter);
            }
            return _list;
        }

        public List<HpServiceCharges> getServiceChargesNew(string _type, string _value, string _cd, DateTime _accDt)
        {
            List<HpServiceCharges> _list = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accDt;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getservicechargedetnew", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpServiceCharges>(_tblData, HpServiceCharges.Converter);
            }
            return _list;
        }

        //darshana 17/07/2012
        public List<HpAdditionalServiceCharges> getAddServiceCharges(string _scheme, string _type, string _value, DateTime _date)
        {
            List<HpAdditionalServiceCharges> _list = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaddservicecharges", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpAdditionalServiceCharges>(_tblData, HpAdditionalServiceCharges.Converter);
            }

            return _list;
        }

        //darshana 18/07/2012
        public List<HpInsuranceDefinition> GetInsuDefinition(string _scheme, string _type, string _value, DateTime _date)
        {
            List<HpInsuranceDefinition> _list = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinsudefinition", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpInsuranceDefinition>(_tblData, HpInsuranceDefinition.Converter);
            }

            return _list;
        }

        //darshana 18/07/2012
        public HpSchemeSheduleDefinition GetSchemeSheduleDef(string _scheme, Int16 _rentNo)
        {
            HpSchemeSheduleDefinition _SchemesheduleDef = new HpSchemeSheduleDefinition();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[1] = new OracleParameter("p_rentno", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _rentNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbData", "sp_getschemesheduledef", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _SchemesheduleDef = DataTableExtensions.ToGenericList<HpSchemeSheduleDefinition>(_dtResults, HpSchemeSheduleDefinition.Converter)[0];
            }
            return _SchemesheduleDef;
        }

        //darshana 11/07/2012
        public List<HpSchemeDefinition> GetAllScheme(string _type, string _value, string _book, string _level, DateTime _date, string _item, string _brand, string _maincat, string _cat, string _scheme)
        {
            List<HpSchemeDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("p_maincat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maincat;
            (param[8] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[9] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getschemedefinition", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_tblData, HpSchemeDefinition.Converter);
            }
            return _list;
        }

        //darshana 11/07/2012
        public List<HpSchemeDefinition> GetAllSchemeNew(string _type, string _value, string _book, string _level, DateTime _date, string _item, string _brand, string _maincat, string _cat, string _scheme, string _promo)
        {
            List<HpSchemeDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("p_maincat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maincat;
            (param[8] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[9] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[10] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getschemedefinitionnew", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_tblData, HpSchemeDefinition.Converter);
            }
            return _list;
        }

        public Int32 UpdateAccountAsVouPending(string _acc, string _rmk)
        {
            Int32 _effect = 0;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[1] = new OracleParameter("in_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int32)UpdateRecords("sp_update_acc_has_voucher", CommandType.StoredProcedure, param);
            return _effect;
        }

        public List<InvoiceHeader> GetInvoiceByAccountNo(string _company, string _profitCenter, string _account)
        {
            //sp_getsalesbyaccount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_account in NVARCHAR2 ,c_data OUT sys_refcursor)

            List<InvoiceHeader> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getsalesbyaccount", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblData, InvoiceHeader.ConvertTotal);
            }
            return _list;
        }

        public DataTable GetInvoiceByAccountNoTable(string _company, string _profitCenter, string _account)
        {
            //sp_getsalesbyaccount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_account in NVARCHAR2 ,c_data OUT sys_refcursor)


            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getsalesbyaccount", CommandType.StoredProcedure, false, param);


            return _tblData;
        }
        public List<RecieptHeader> GetReceiptByAccountNo(string _company, string _profitCenter, string _account)
        {
            // sp_getreceiptdetailbyaccountno(p_com in NVARCHAR2 ,p_pcenter in NVARCHAR2,p_accountno in NVARCHAR2,c_data out sys_refcursor)

            List<RecieptHeader> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_accountno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getreceiptdetailbyaccountno", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RecieptHeader>(_tblData, RecieptHeader.ConvertTotal);
            }
            return _list;

        }
        public List<HpAdjustment> GetAccountAdjustment(string _profitCenter, string _account, string _adjtype)
        {
            //sp_getaccountadjustment(p_pcenter in NVARCHAR2,p_accountno in NVARCHAR2,p_adjtype in NVARCHAR2,c_data out sys_refcursor)
            List<HpAdjustment> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[1] = new OracleParameter("p_accountno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[2] = new OracleParameter("p_adjtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adjtype;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccountadjustment", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpAdjustment>(_tblData, HpAdjustment.Converter);
            }
            return _list;
        }
        public List<HpCashConversionDefinition> GetCashConversionDefinition(string _scheme, Int32 _period, string _book, string _level, DateTime _uptoDate, decimal _upvalue, decimal _afvalue, decimal _hpvalue, DateTime _acc_create_Date)
        {
            //sp_getcashconversiondefinition(p_scheme in NVARCHAR2,p_period in NUMBER,p_book in NVARCHAR2,p_level in NVARCHAR2,p_ccupto in DATE,p_upvalue in NUMBER,p_afvalue in NUMBER,p_hpvalue in NUMBER,c_data out sys_refcursor)
            List<HpCashConversionDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[1] = new OracleParameter("p_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _period;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_ccupto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _uptoDate;

            (param[5] = new OracleParameter("p_upvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _upvalue;
            (param[6] = new OracleParameter("p_afvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _afvalue;
            (param[7] = new OracleParameter("p_hpvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpvalue;
            (param[8] = new OracleParameter("p_acc_cre_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc_create_Date;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbData", "sp_getcashconversiondefinition", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpCashConversionDefinition>(_tblData, HpCashConversionDefinition.Converter);
            }
            return _list;
        }

        public List<HpInsurance> GetAccountInsurance(string _account, Int16 _type)
        {
            //sp_getinsuarancedetail(p_account in NVARCHAR2,p_type in NUMBER,c_data out sys_refcursor)

            List<HpInsurance> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinsuarancedetail", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpInsurance>(_tblData, HpInsurance.Converter);
            }
            return _list;
        }
        public List<MasterSalesPriorityHierarchy> GetSalesPriorityHierarchy(string _company, string _profitCenter, string _category, string _type)
        {
            //sp_getsalespriorityhierarchy (  p_com IN  NVARCHAR2,p_profitcenter IN  NVARCHAR2, p_category IN NVARCHAR2, c_data OUT sys_refcursor)

            List<MasterSalesPriorityHierarchy> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category;
            (param[3] = new OracleParameter(" p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getsalespriorityhierarchy", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchy>(_tblData, MasterSalesPriorityHierarchy.Converter);
            }
            return _list;
        }



        //kapila 6/7/2012
        public DataTable GetCustomerDetByGroupCode(string _grpCode)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_grp_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_grp_sale_cust_by_cd", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 6/7/2012
        public int SaveGroupSale(GroupSaleHeader _groupSale)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[22];

                (param[0] = new OracleParameter("p_HGR_GRUP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_grup_cd;
                (param[1] = new OracleParameter("p_hgr_grup_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_Grup_com;
                (param[2] = new OracleParameter("p_HGR_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_com;
                (param[3] = new OracleParameter("p_HGR_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_pc;
                (param[4] = new OracleParameter("p_HGR_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_tp;
                (param[5] = new OracleParameter("p_HGR_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_desc;
                (param[6] = new OracleParameter("p_HGR_NO_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSale.Hgr_no_acc;
                (param[7] = new OracleParameter("p_HGR_NO_CUST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSale.Hgr_no_cust;
                (param[8] = new OracleParameter("p_HGR_NO_ITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSale.Hgr_no_itm;
                (param[9] = new OracleParameter("p_HGR_APP_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSale.Hgr_app_stus;
                (param[10] = new OracleParameter("p_HGR_APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_app_by;
                (param[11] = new OracleParameter("p_HGR_APP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _groupSale.Hgr_app_dt;
                (param[12] = new OracleParameter("p_HGR_TOT_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSale.Hgr_tot_val;
                (param[13] = new OracleParameter("p_HGR_CONT_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_cont_cust;
                (param[14] = new OracleParameter("p_HGR_CONT_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_cont_no;
                (param[15] = new OracleParameter("p_HGR_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _groupSale.Hgr_from_dt;
                (param[16] = new OracleParameter("p_HGR_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _groupSale.Hgr_to_dt;
                (param[17] = new OracleParameter("p_HGR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.Hgr_cre_by;
                (param[18] = new OracleParameter("p_HGR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _groupSale.Hgr_cre_dt;
                (param[19] = new OracleParameter("p_HGR_FOLLOW_UP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSale.HGR_FOLLOW_UP;
                (param[20] = new OracleParameter("p_HGR_VISIT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _groupSale.HGR_VISIT_DT;

                param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                rows_aff = UpdateRecords("sp_save_group_sale", CommandType.StoredProcedure, param);

            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
                //ConnectionClose();
            }

            return rows_aff;
        }

        //kapila 6/7/2012
        public int SaveGroupSaleCustomers(GroupSaleCustomer _groupSaleCustomer)
        {
            int rows_affected = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[8];

                (param[0] = new OracleParameter("p_HGC_GRUP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_grup_cd;
                (param[1] = new OracleParameter("p_HGC_CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_cust_cd;
                (param[2] = new OracleParameter("p_HGC_NO_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_no_acc;
                (param[3] = new OracleParameter("p_HGC_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_val;
                (param[4] = new OracleParameter("p_HGC_NO_ITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_no_itm;
                (param[5] = new OracleParameter("p_HGC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_cre_by;
                (param[6] = new OracleParameter("p_HGC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _groupSaleCustomer.Hgc_cre_dt;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_affected = UpdateRecords("sp_save_group_sale_customer", CommandType.StoredProcedure, param);

            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                //ConnectionClose();
            }
            return rows_affected;

        }

        //kapila 6/7/2012
        public Int32 GetGroupSaleCountByCompany(string _groupCompany)
        {
            Int32 _count = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_comp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupCompany;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _itemTable = QueryDataTable("tbl", "sp_getgroupsalecountbycomp", CommandType.StoredProcedure, false, param);
            _count = _itemTable.Rows.Count;

            return _count;

        }

        //kapila 9/7/2012
        public GroupSaleHeader GetGroupSaleHeaderDetails(string _groupSaleCode)
        {
            GroupSaleHeader _groupsale = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSaleCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_getgroupsaleheader", CommandType.StoredProcedure, false, param);

            if (_tblProfitCenter.Rows.Count > 0)
            {
                _groupsale = DataTableExtensions.ToGenericList<GroupSaleHeader>(_tblProfitCenter, GroupSaleHeader.Converter)[0];
            }

            return _groupsale;
        }

        //kapila 9/7/2012
        public List<GroupSaleCustomer> GetGroupSaleCustomers(string _groupSaleCode)
        {
            List<GroupSaleCustomer> _groupSaleCustomerList = null;
            GroupSaleCustomer _groupSaleCustomerDetails = null;


            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSaleCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_groupsale_cust", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _groupSaleCustomerList = new List<GroupSaleCustomer>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _groupSaleCustomerDetails = new GroupSaleCustomer();
                    _groupSaleCustomerDetails.Hgc_cust_cd = (_dtResults.Rows[i]["Hgc_cust_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Hgc_cust_cd"].ToString();
                    _groupSaleCustomerDetails.MasterBusinessCompany = new MasterBusinessCompany()
                    {
                        Mbe_name = (_dtResults.Rows[i]["Mbe_name"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Mbe_name"].ToString(),
                    };

                    _groupSaleCustomerDetails.Hgc_no_itm = (_dtResults.Rows[i]["Hgc_no_itm"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Hgc_no_itm"]);
                    _groupSaleCustomerDetails.Hgc_no_acc = (_dtResults.Rows[i]["Hgc_no_acc"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Hgc_no_acc"]);
                    _groupSaleCustomerDetails.Hgc_val = (_dtResults.Rows[i]["Hgc_val"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Hgc_val"]);
                    _groupSaleCustomerDetails.Hgc_Cust_Name = (_dtResults.Rows[i]["Mbe_name"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Mbe_name"].ToString();

                    _groupSaleCustomerList.Add(_groupSaleCustomerDetails);
                }

            }

            return _groupSaleCustomerList;

        }

        #region Price Enquiry
        //  Shani 09/07/2012
        public DataTable EnquirePriceDetails(string user, string com, string pc, string piceBookCD, string priceLevel, string itemCD, string customerCD, string Type, DateTime frmDt, DateTime toDt, string circular, string cate1, string cate2, string cate3, Int32 type)
        {
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fromDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt;
            (param[2] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[3] = new OracleParameter("p_userID ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[5] = new OracleParameter("p_priceBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = piceBookCD;
            (param[6] = new OracleParameter("p_priceLevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = priceLevel;
            (param[7] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[8] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customerCD;
            if (type == -1)
            { (param[9] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null; }
            else
            { (param[9] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type.ToString(); }


            (param[10] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            (param[11] = new OracleParameter("p_category_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
            (param[12] = new OracleParameter("p_category_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;
            (param[13] = new OracleParameter("p_category_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate3;

            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            // DataTable _dtResults = QueryDataTable("tblEnqData", "get_EnquiryPrice", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tblEnqData", "SP_GET_ENQUIRYPRICE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Shani 13/07/2012
        public List<MasterPartyHierachy> get_hierarchy(string _cate)
        {
            List<MasterPartyHierachy> _List = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_hierachy", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<MasterPartyHierachy>(tblDet, MasterPartyHierachy.Converter);
            }
            return _List;

        }
        //Shani 13/07/2012
        //public DataTable get_hp_schemes(DateTime as_atDate, string itemCD, string parytTP, string partyCD, string brand,string cate1,string cate2)
        //{
        //    // p_asat_date in date,itemCD in NVARCHAR2,partyTP in NVARCHAR2,partyCD in NVARCHAR2,p_brand in NVARCHAR2,
        //    //p_cate1 in NVARCHAR2,
        //    //p_cate2 in NVARCHAR2,
        //    //c_data OUT sys_refcursor
        //    OracleParameter[] param = new OracleParameter[8];
        //     (param[0] = new OracleParameter("p_asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = as_atDate;
        //     (param[1] = new OracleParameter("itemCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
        //     (param[2] = new OracleParameter("partyTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value =parytTP ;
        //     (param[3] = new OracleParameter("partyCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
        //     (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
        //     (param[5] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
        //     (param[6] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;
        //      param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

        //    DataTable tblDet = QueryDataTable("tbl_det", "sp_hp_schemes", CommandType.StoredProcedure, false, param);
        //    return tblDet;

        //}

        public List<HpSchemeDefinition> get_hp_Schemes(DateTime as_atDate, string itemCD, string parytTP, string partyCD, string brand, string cate1, string cate2)
        {

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = as_atDate;
            (param[1] = new OracleParameter("itemCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[2] = new OracleParameter("partyTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = parytTP;
            (param[3] = new OracleParameter("partyCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[5] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
            (param[6] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_hp_schemes", CommandType.StoredProcedure, false, param);

            //  DataTable _tblData = QueryDataTable("tbData", "sp_getsalespriorityhierarchy", CommandType.StoredProcedure, false, param);

            List<HpSchemeDefinition> Det = new List<HpSchemeDefinition>();
            if (tblDet.Rows.Count > 0)
            {
                Det = DataTableExtensions.ToGenericList<HpSchemeDefinition>(tblDet, HpSchemeDefinition.Converter);
            }

            return Det;
        }

        public DataTable EnquirePriceDetails_forAsAtDate(string user, string com, string pc, string piceBookCD, string priceLevel, string itemCD, string customerCD, string Type, DateTime asAtDate, string circular, string cate1, string cate2, string cate3, Int32 type)
        {
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            //(param[1] = new OracleParameter("p_fromDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt;
            //(param[2] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[1] = new OracleParameter("p_asatDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = asAtDate;
            (param[2] = new OracleParameter("p_userID ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_priceBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = piceBookCD;
            (param[5] = new OracleParameter("p_priceLevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = priceLevel;
            (param[6] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customerCD;
            if (type == -1)
            { (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null; }
            else
            { (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type.ToString(); }


            (param[9] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            (param[10] = new OracleParameter("p_category_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
            (param[11] = new OracleParameter("p_category_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;
            (param[12] = new OracleParameter("p_category_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate3;

            param[13] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            // DataTable _dtResults = QueryDataTable("tblEnqData", "get_EnquiryPrice", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tblEnqData", "SP_GET_ENQUIRYPRICE_asAt", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<HpSchemeDefinition> get_HP_Schemes(DateTime as_atDate, string itemCD, string parytTP, string partyCD, string brand, string cate1, string cate2, string schemeCD, string priceBook, string priceLevel)
        {

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = as_atDate;
            (param[1] = new OracleParameter("itemCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[2] = new OracleParameter("partyTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = parytTP;
            (param[3] = new OracleParameter("partyCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[5] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
            (param[6] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;

            (param[7] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schemeCD;
            (param[8] = new OracleParameter("p_priceBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = priceBook;
            (param[9] = new OracleParameter("p_priceLvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = priceLevel;


            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_hp_get_schemes", CommandType.StoredProcedure, false, param);

            //  DataTable _tblData = QueryDataTable("tbData", "sp_getsalespriorityhierarchy", CommandType.StoredProcedure, false, param);

            List<HpSchemeDefinition> Det = new List<HpSchemeDefinition>();
            if (tblDet.Rows.Count > 0)
            {
                Det = DataTableExtensions.ToGenericList<HpSchemeDefinition>(tblDet, HpSchemeDefinition.Converter);
            }

            return Det;
        }

        public Decimal GET_Item_vat_Rate(string com, string itemCD, string taxCode)
        {
            // p_com in NVARCHAR2,p_itmCD in NVARCHAR2,p_taxCode in NVARCHAR2 ,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[2] = new OracleParameter("p_taxCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = taxCode;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ITEM_VAT_RATE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                return (_dtResults.Rows[0][0] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0][0]);


            }
            else
            {
                return 0;
            }

            //return 1;

        }
        #endregion  Price Enquiry

        //darshana 16/07/20111
        public List<HpOtherCharges> GetOtherCharges(string _scheme, string _book, string _level, DateTime _date, string _item, string _brand, string _maincat, string _cat)
        {
            List<HpOtherCharges> _list = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_maincat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maincat;
            (param[6] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[7] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getothercharges", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpOtherCharges>(_tblData, HpOtherCharges.Converter);
            }
            return _list;
        }

        public Int16 Approve_group_Sale(string _GSCode, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_groupsalecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _GSCode;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int16 effects;
            effects = (Int16)UpdateRecords("sp_approve_group_sale", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public List<MasterSalesPriorityHierarchy> get_pc_info_by_code(string _code)
        {
            List<MasterSalesPriorityHierarchy> _List = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_pc_info_val", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchy>(tblDet, MasterSalesPriorityHierarchy.ConvertVal);
            }
            return _List;

        }

        //kapila
        public Boolean IsGroupSaleCodeFound(string _grpCode)
        {
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCode;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean IsGroupSaleCodeFound = QueryDataTable("tbl", "sp_check_group_sale_cd", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return IsGroupSaleCodeFound;
        }

        //kapila 
        public Int32 GetGroupSaleDet(string _groupSaleCode, out Int32 _noofacc, out Int32 _noofprod, out Int32 _noofcust, out Decimal _val)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupSaleCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_grp_sale_det", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _noofcust = (_dtResults.Rows[0]["cnt"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[0]["cnt"]);
                _noofacc = (_dtResults.Rows[0]["acc"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[0]["acc"]);
                _noofprod = (_dtResults.Rows[0]["prod"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[0]["prod"]);
                _val = (_dtResults.Rows[0]["val"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["val"]);

            }
            else
            {
                _noofcust = 0;
                _noofacc = 0;
                _noofprod = 0;
                _val = 0;
            }

            return 1;

        }

        //darshana 25/07/2012
        public HpSystemParameters GetSystemParameter(string _type, string _value, string _code, DateTime _date)
        {
            HpSystemParameters _SystemPara = new HpSystemParameters();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbData", "sp_getsyspara", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _SystemPara = DataTableExtensions.ToGenericList<HpSystemParameters>(_dtResults, HpSystemParameters.Converter)[0];
            }
            return _SystemPara;
        }

        //darshana 26-07-2012
        public MasterCompanyItem GetAllCompanyItems(string _com, string _item, Int16 _active)
        {
            MasterCompanyItem _CompanyItems = new MasterCompanyItem();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _active;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbData", "sp_getcompanyitems", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _CompanyItems = DataTableExtensions.ToGenericList<MasterCompanyItem>(_dtResults, MasterCompanyItem.Converter)[0];
            }

            return _CompanyItems;
        }

        //kapila
        public Int32 Delete_Group_sale_cust(string _grpSaleCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_HGC_GRUP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpSaleCode;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_grp_cust", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveBusinessEntityDetail(MasterBusinessEntity _businessEntity)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[91];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************
            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0;
            //----------------------------------------------------------------------------------------------------------------------
            (param[64] = new OracleParameter("p_mbe_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_TIT;
            (param[65] = new OracleParameter("p_mbe_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_INI;
            (param[66] = new OracleParameter("p_mbe_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_FNAME;
            (param[67] = new OracleParameter("p_mbe_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_SNAME;
            (param[68] = new OracleParameter("p_mbe_agre_send_email", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_email;
            (param[69] = new OracleParameter("p_mbe_cust_lang", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_lang;

            (param[70] = new OracleParameter("p_mbe_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cur_cd;
            (param[71] = new OracleParameter("p_mbe_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_WEB;
            (param[72] = new OracleParameter("p_mbe_cr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.MBE_CR_PERIOD;

            //Lakshan 2015/12/31
            (param[73] = new OracleParameter("p_mbe_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_by;
            (param[74] = new OracleParameter("p_mbe_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_dt;
            (param[75] = new OracleParameter("p_mbe_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_session;
            (param[76] = new OracleParameter("p_mbe_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_session;
            //kapila 1/5/2016
            (param[77] = new OracleParameter("p_mbe_alw_dcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_alw_dcn;
            (param[78] = new OracleParameter("p_mbe_ins_man", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ins_man;
            (param[79] = new OracleParameter("p_mbe_min_dp_per", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_min_dp_per;

            (param[80] = new OracleParameter("p_mbe_qno_gen_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_qno_gen_seq;
            //Nuwan 2016/04/19
            (param[81] = new OracleParameter("p_Mbe_pp_isu_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_isu_dte;
            (param[82] = new OracleParameter("p_Mbe_pp_exp_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_exp_dte;
            (param[83] = new OracleParameter("p_Mbe_dl_isu_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_isu_dte;
            (param[84] = new OracleParameter("p_Mbe_dl_exp_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_exp_dte;
            (param[85] = new OracleParameter("p_Mbe_proc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_cd;
            (param[86] = new OracleParameter("p_Mbe_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wh_cd;

            // subodana 2016-12-15
            (param[87] = new OracleParameter("p_Mbe_BI_Year", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_BI_Year;
            (param[88] = new OracleParameter("p_Mbe_Credit_Period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_Credit_Period;
            // tharanga 2018/06/07
            (param[89] = new OracleParameter("p_mbe_nationality", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nationality;

            param[90] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_busentity_new", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveBusinessEntityDetailNew(MasterBusinessEntity _businessEntity)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[89];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************
            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0;
            //----------------------------------------------------------------------------------------------------------------------
            (param[64] = new OracleParameter("p_mbe_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_TIT;
            (param[65] = new OracleParameter("p_mbe_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_INI;
            (param[66] = new OracleParameter("p_mbe_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_FNAME;
            (param[67] = new OracleParameter("p_mbe_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_SNAME;
            (param[68] = new OracleParameter("p_mbe_agre_send_email", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_email;
            (param[69] = new OracleParameter("p_mbe_cust_lang", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_lang;

            (param[70] = new OracleParameter("p_mbe_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cur_cd;
            (param[71] = new OracleParameter("p_mbe_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_WEB;
            (param[72] = new OracleParameter("p_mbe_cr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.MBE_CR_PERIOD;

            //Lakshan 2015/12/31
            (param[73] = new OracleParameter("p_mbe_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_by;
            (param[74] = new OracleParameter("p_mbe_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_dt;
            (param[75] = new OracleParameter("p_mbe_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_session;
            (param[76] = new OracleParameter("p_mbe_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_session;
            //kapila 1/5/2016
            (param[77] = new OracleParameter("p_mbe_alw_dcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_alw_dcn;
            (param[78] = new OracleParameter("p_mbe_ins_man", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ins_man;
            (param[79] = new OracleParameter("p_mbe_min_dp_per", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_min_dp_per;

            (param[80] = new OracleParameter("p_mbe_qno_gen_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_qno_gen_seq;
            //Nuwan 2016/04/19
            (param[81] = new OracleParameter("p_Mbe_pp_isu_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_isu_dte;
            (param[82] = new OracleParameter("p_Mbe_pp_exp_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_exp_dte;
            (param[83] = new OracleParameter("p_Mbe_dl_isu_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_isu_dte;
            (param[84] = new OracleParameter("p_Mbe_dl_exp_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_exp_dte;
            (param[85] = new OracleParameter("p_Mbe_proc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_cd;
            (param[86] = new OracleParameter("p_Mbe_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wh_cd;
            (param[87] = new OracleParameter("p_Mbe_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_foc;

            param[88] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_busentity_new2", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveTempBOCProject(string _batch_no, string _com, string _loc, string _cust_cd, string _itm_cd, string _itm_stus, string _ser1, string _ser2, string _ref_no, string _last_modi_by, string _rem, DateTime _date, Int32 _isNIC, Int32 _isPP, Int32 _isPID, Int32 _isDL, Int32 _isBRNo, Int32 _isIID, string _recNo)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch_no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust_cd;
            (param[4] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cd;
            (param[5] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_stus;
            (param[6] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser1;
            (param[7] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser2;
            (param[8] = new OracleParameter("p_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref_no;
            (param[9] = new OracleParameter("p_last_modi_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _last_modi_by;
            (param[10] = new OracleParameter("p_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;
            (param[11] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[12] = new OracleParameter("p_isnic", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isNIC;
            (param[13] = new OracleParameter("p_ispp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isPP;
            (param[14] = new OracleParameter("p_ispid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isPID;
            (param[15] = new OracleParameter("p_isdl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isDL;
            (param[16] = new OracleParameter("p_isbrno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isBRNo;
            (param[17] = new OracleParameter("p_isiid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isIID;
            (param[18] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recNo;


            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_upd_bulk_inv_new", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila 23/11/2012
        public Int32 SaveServiceAgentDetail(MasterBusinessEntity _businessEntity)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[66];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************
            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0;
            (param[64] = new OracleParameter("p_mbe_cust_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_loc;
            //----------------------------------------------------------------------------------------------------------------------
            param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_svc_agent", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 02/08/2012
        public List<HPAdjustmentTypes> GetHPAdjTypes()
        {
            List<HPAdjustmentTypes> _List = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_gethpadjtypes", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<HPAdjustmentTypes>(tblDet, HPAdjustmentTypes.Converter);
            }
            return _List;

        }

        //darshana 02-08-2012
        public HPAdjustmentTypes GetHPAdjByCode(string _code)
        {
            HPAdjustmentTypes _AdjType = new HPAdjustmentTypes(); ;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbData", "sp_gethpadjbycode", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _AdjType = DataTableExtensions.ToGenericList<HPAdjustmentTypes>(_dtResults, HPAdjustmentTypes.Converter)[0];
            }

            return _AdjType;
        }

        //darshana 03-08-2012
        public Int32 Save_HpAdjustment(HpAdjustment _adj)
        {

            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[15];

            (param[0] = new OracleParameter("p_had_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _adj.Had_seq;
            (param[1] = new OracleParameter("p_had_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_ref;
            (param[2] = new OracleParameter("p_had_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_com;
            (param[3] = new OracleParameter("p_had_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_pc;
            (param[4] = new OracleParameter("p_had_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_acc_no;
            (param[5] = new OracleParameter("p_had_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _adj.Had_dt;
            (param[6] = new OracleParameter("p_had_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_tp;
            (param[7] = new OracleParameter("p_had_adj_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_adj_tp;
            (param[8] = new OracleParameter("p_had_mnl_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_mnl_ref;
            (param[9] = new OracleParameter("p_had_dbt_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _adj.Had_dbt_val;
            (param[10] = new OracleParameter("p_had_crdt_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _adj.Had_crdt_val;
            (param[11] = new OracleParameter("p_had_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_rmk;
            (param[12] = new OracleParameter("p_had_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adj.Had_cre_by;
            (param[13] = new OracleParameter("p_had_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _adj.Had_cre_dt;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_hp_adj", CommandType.StoredProcedure, param);
            return effects;

        }

        //darshana 03/08/2012
        public Int32 UpdateHPAdjTxn(string _AdjNo, string _TxnNo, Int32 _AdjSeq, Int32 _TxnSeq, string _manualRef)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_adjNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AdjNo;
            (param[1] = new OracleParameter("p_txnNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TxnNo;
            (param[2] = new OracleParameter("p_adjseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _AdjSeq;
            (param[3] = new OracleParameter("p_txnseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _TxnSeq;
            (param[4] = new OracleParameter("p_manual", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_hp_adj_txn", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetChanelData(string _company, string _code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblchnl", "sp_get_chnl", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //kapila
        public DataTable GetChanelOnPC(string _company, string _pc, string _code)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblchnl", "sp_get_pc_chnl", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public List<CashCommissionDetailRef> GetCashCommissionDetail(string _invoicetype, DateTime _date, string _pricebook, string _pricelevel, string _com, string _pc, int _isCe)
        {
            //sp_getcashcommissiondetail(p_invoicetype in NVARCHAR2,p_date in date,p_pricebook in NVARCHAR2,p_pricelevel in NVARCHAR2,c_data out sys_refcursor)
            List<CashCommissionDetailRef> _list = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_invoicetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicetype;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_pricebook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricebook;
            (param[3] = new OracleParameter("p_pricelevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricelevel;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("p_is_ce", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isCe;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbData", "sp_getcashcommissiondetail_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CashCommissionDetailRef>(_dtResults, CashCommissionDetailRef.Converter);
            }

            return _list;
        }

        public DataTable GetBusinessEntityTypes(string category)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_businessEnt_TypesDet", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetBusinessEntityAllValues(string category, string type_)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type_;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_businessEnt_ValDet", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public MasterBusinessEntity GetCustomerProfile(string CustCD, string nic, string DL, string PPNo, string brNo)
        {// p_CustCD in NVARCHAR2,p_nic in NVARCHAR2,p_dl in NVARCHAR2,p_passport in NVARCHAR2,c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getCustomerProfile", CommandType.StoredProcedure, false, param);

            MasterBusinessEntity bizEnt = new MasterBusinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }
            return bizEnt;
        }

        //Shani 04/08/2012
        public Int32 UpdateBusinessEntityProfile(MasterBusinessEntity _businessEntity, int whichSP)
        {

            OracleParameter[] param = new OracleParameter[91];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd.ToUpper();
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************

            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0; ;
            (param[64] = new OracleParameter("p_mbe_cust_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_loc;

            (param[65] = new OracleParameter("p_mbe_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_TIT;
            (param[66] = new OracleParameter("p_mbe_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_INI;
            (param[67] = new OracleParameter("p_mbe_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_FNAME;
            (param[68] = new OracleParameter("p_mbe_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_SNAME;
            (param[69] = new OracleParameter("p_mbe_chq_iss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.MBE_CHQ_ISS;
            (param[70] = new OracleParameter("p_mbe_agre_send_email", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_email;
            (param[71] = new OracleParameter("p_mbe_cust_lang", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_lang;
            (param[72] = new OracleParameter("p_mbe_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_WEB;
            (param[73] = new OracleParameter("p_MBE_CR_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.MBE_CR_PERIOD;
            (param[74] = new OracleParameter("p_mbe_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cur_cd;
            //-------------------------------------------------------------------------------------------------------------------

            //Lakshan 2015/12/31
            (param[75] = new OracleParameter("p_mbe_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_by;
            (param[76] = new OracleParameter("p_mbe_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_dt;
            (param[77] = new OracleParameter("p_mbe_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_session;
            (param[78] = new OracleParameter("p_mbe_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_session;

            //kapila 1/5/2016
            (param[79] = new OracleParameter("p_mbe_alw_dcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_alw_dcn;
            (param[80] = new OracleParameter("p_mbe_ins_man", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ins_man;
            (param[81] = new OracleParameter("p_mbe_min_dp_per", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_min_dp_per;

            //kapila 21/1/2016
            (param[82] = new OracleParameter("p_mbe_qno_gen_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_qno_gen_seq;
            (param[83] = new OracleParameter("p_Mbe_proc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_cd;
            (param[84] = new OracleParameter("p_Mbe_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wh_cd;

            //Lakshan 10 Aug 2016
            (param[85] = new OracleParameter("p_mbe_proc_val1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_val1;
            (param[86] = new OracleParameter("p_mbe_proc_val2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_val2;

            //subodana 2016-12-15
            (param[87] = new OracleParameter("p_mbe_bi_year", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_BI_Year;
            (param[88] = new OracleParameter("p_mbe_credit_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_Credit_Period;

            //Dulaj 2018-Apr-02
            (param[89] = new OracleParameter("p_mbe_allow_refini", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_allow_refini;

            param[90] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            if (whichSP == 1)
            {
                effects = (Int32)UpdateRecords("sp_update_bisentitypro_new_new", CommandType.StoredProcedure, param);
            }
            else if (whichSP == 2)
            {
                effects = (Int32)UpdateRecords("sp_updatebizentity_perm_new", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        public Int32 UpdateBusinessEntityProfilenew(MasterBusinessEntity _businessEntity, int whichSP)
        {

            OracleParameter[] param = new OracleParameter[90];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd.ToUpper();
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************

            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0; ;
            (param[64] = new OracleParameter("p_mbe_cust_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_loc;

            (param[65] = new OracleParameter("p_mbe_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_TIT;
            (param[66] = new OracleParameter("p_mbe_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_INI;
            (param[67] = new OracleParameter("p_mbe_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_FNAME;
            (param[68] = new OracleParameter("p_mbe_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_SNAME;
            (param[69] = new OracleParameter("p_mbe_chq_iss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.MBE_CHQ_ISS;
            (param[70] = new OracleParameter("p_mbe_agre_send_email", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_email;
            (param[71] = new OracleParameter("p_mbe_cust_lang", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cust_lang;
            (param[72] = new OracleParameter("p_mbe_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.MBE_WEB;
            (param[73] = new OracleParameter("p_MBE_CR_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.MBE_CR_PERIOD;
            (param[74] = new OracleParameter("p_mbe_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cur_cd;
            //-------------------------------------------------------------------------------------------------------------------

            //Lakshan 2015/12/31
            (param[75] = new OracleParameter("p_mbe_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_by;
            (param[76] = new OracleParameter("p_mbe_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_dt;
            (param[77] = new OracleParameter("p_mbe_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mod_session;
            (param[78] = new OracleParameter("p_mbe_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_session;

            //kapila 1/5/2016
            (param[79] = new OracleParameter("p_mbe_alw_dcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_alw_dcn;
            (param[80] = new OracleParameter("p_mbe_ins_man", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ins_man;
            (param[81] = new OracleParameter("p_mbe_min_dp_per", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_min_dp_per;

            //kapila 21/1/2016
            (param[82] = new OracleParameter("p_mbe_qno_gen_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_qno_gen_seq;
            (param[83] = new OracleParameter("p_Mbe_proc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_cd;
            (param[84] = new OracleParameter("p_Mbe_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wh_cd;

            //Lakshan 10 Aug 2016
            (param[85] = new OracleParameter("p_mbe_proc_val1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_val1;
            (param[86] = new OracleParameter("p_mbe_proc_val2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_proc_val2;
            (param[87] = new OracleParameter("p_mbe_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_foc;

            (param[88] = new OracleParameter("p_mbe_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_no;

            //Added By Dulaj 2018/Jun/28
            param[89] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            if (whichSP == 1)
            {
                effects = (Int32)UpdateRecords("sp_update_bisentitypro_new_ne2", CommandType.StoredProcedure, param);
            }
            else if (whichSP == 2)
            {
                effects = (Int32)UpdateRecords("sp_updateBizEntity_Perm_new2", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        //created by Shani 04/08/2012
        public Int32 SaveBusinessEntityInfo(MasterBusinessEntityInfo bisInfo)
        {

            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_mbei_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_com;
            (param[1] = new OracleParameter("p_mbei_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_cd;
            (param[2] = new OracleParameter("p_mbei_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_tp;
            (param[3] = new OracleParameter("p_mbei_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_val;
            (param[4] = new OracleParameter("p_mbei_available", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_available;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_BusinessEntityInfo", CommandType.StoredProcedure, param);
            return effects;

        }
        public Int32 UpdateBusinessEntityInfo(MasterBusinessEntityInfo bisInfo)
        {

            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_mbei_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_com;
            (param[1] = new OracleParameter("p_mbei_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_cd;
            (param[2] = new OracleParameter("p_mbei_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_tp;
            (param[3] = new OracleParameter("p_mbei_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_val;
            (param[4] = new OracleParameter("p_mbei_available", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bisInfo.Mbei_available;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_BusinessEntityInfo", CommandType.StoredProcedure, param);
            return effects;

        }
        //created by Shani 08/08/2012
        public Int32 SaveBusinessEntityDiscount(CashGeneralDicountDef dicDef, string pc)
        {

            OracleParameter[] param = new OracleParameter[23];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_itm;
            (param[1] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_brand;
            (param[2] = new OracleParameter("p_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_cate1;
            (param[3] = new OracleParameter("p_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_cate2;

            (param[4] = new OracleParameter("p_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_cate3;
            (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = dicDef.Sgdd_from_dt;
            (param[6] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = dicDef.Sgdd_to_dt;
            (param[7] = new OracleParameter("p_salesTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_sale_tp;

            (param[8] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[9] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_com;
            (param[10] = new OracleParameter("p_priceBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_pb;
            (param[11] = new OracleParameter("p_pbLevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_pb_lvl;


            (param[12] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_cust_cd;
            (param[13] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dicDef.Sgdd_cre_by;
            (param[14] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = dicDef.Sgdd_cre_dt;
            (param[15] = new OracleParameter("p_alw_ser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dicDef.Sgdd_alw_ser;

            (param[16] = new OracleParameter("p_alw_pro", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dicDef.Sgdd_alw_pro;
            (param[17] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dicDef.Sgdd_disc_rt;
            (param[18] = new OracleParameter("p_disc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dicDef.Sgdd_disc_val;
            (param[19] = new OracleParameter("p_no_of_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dicDef.Sgdd_no_of_times;

            (param[20] = new OracleParameter("p_no_of_used_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dicDef.Sgdd_no_of_used_times;
            (param[21] = new OracleParameter("p_stus", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dicDef.Sgdd_stus;


            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_saveDiscountInfor", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdateCustomerCreditLimit(string _com, string _cusCD, string modBy, DateTime modDate, decimal _newCreditLimit)
        {
            //            p_com in NVARCHAR2,p_custCD in NVARCHAR2,p_modBy  in NVARCHAR2,
            //p_modDate in DATE,p_newCredLimit in DECIMAL,o_effect OUT NUMBER
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_custCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusCD;
            (param[2] = new OracleParameter("p_modBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modBy;
            (param[3] = new OracleParameter("p_modDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = modDate;
            (param[4] = new OracleParameter("p_newCredLimit", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _newCreditLimit;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_UpdateCustomerCreditLimit", CommandType.StoredProcedure, param);
            return effects;
        }
        //written by darshana on 25/07/2012
        //save HP account 
        public Int32 SaveHPAccountLog(HPAccountLog _HpAccountLog)
        {
            OracleParameter[] param = new OracleParameter[55];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hal_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_seq_no;
            (param[1] = new OracleParameter("p_hal_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_acc_no;
            (param[2] = new OracleParameter("p_hal_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_com;
            (param[3] = new OracleParameter("p_hal_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_pc;
            (param[4] = new OracleParameter("p_hal_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_seq;
            (param[5] = new OracleParameter("p_hal_sa_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_sa_sub_tp;
            (param[6] = new OracleParameter("p_hal_log_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_log_dt;
            (param[7] = new OracleParameter("p_hal_rev_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_rev_stus;
            (param[8] = new OracleParameter("p_hpa_acc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hpa_acc_cre_dt;
            (param[9] = new OracleParameter("p_hal_grup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_grup_cd;
            (param[10] = new OracleParameter("p_hal_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_invc_no;
            (param[11] = new OracleParameter("p_hal_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_sch_tp;
            (param[12] = new OracleParameter("p_hal_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_sch_cd;
            (param[13] = new OracleParameter("p_hal_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_term;
            (param[14] = new OracleParameter("p_hal_intr_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_intr_rt;
            (param[15] = new OracleParameter("p_hal_dp_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_dp_comm;
            (param[16] = new OracleParameter("p_hal_inst_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_inst_comm;
            (param[17] = new OracleParameter("p_hal_cash_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_cash_val;
            (param[18] = new OracleParameter("p_hal_tot_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_tot_vat;
            (param[19] = new OracleParameter("p_hal_net_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_net_val;
            (param[20] = new OracleParameter("p_hal_dp_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_dp_val;
            (param[21] = new OracleParameter("p_hal_af_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_af_val;
            (param[22] = new OracleParameter("p_hal_tot_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_tot_intr;
            (param[23] = new OracleParameter("p_hal_ser_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_ser_chg;
            (param[24] = new OracleParameter("p_hal_hp_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_hp_val;
            (param[25] = new OracleParameter("p_hal_tc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_tc_val;
            (param[26] = new OracleParameter("p_hal_init_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_init_ins;
            (param[27] = new OracleParameter("p_hal_init_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_init_vat;
            (param[28] = new OracleParameter("p_hal_init_stm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_init_stm;
            (param[29] = new OracleParameter("p_hal_init_ser_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_init_ser_chg;
            (param[30] = new OracleParameter("p_hal_inst_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_inst_ins;
            (param[31] = new OracleParameter("p_hal_inst_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_inst_vat;
            (param[32] = new OracleParameter("p_hal_inst_stm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_inst_stm;
            (param[33] = new OracleParameter("p_hal_inst_ser_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_inst_ser_chg;
            (param[34] = new OracleParameter("p_hal_buy_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_buy_val;
            (param[35] = new OracleParameter("p_hal_oth_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_oth_chg;
            (param[36] = new OracleParameter("p_hal_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_stus;
            (param[37] = new OracleParameter("p_hal_cls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_cls_dt;
            (param[38] = new OracleParameter("p_hal_rv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_rv_dt;
            (param[39] = new OracleParameter("p_hal_rls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_rls_dt;
            (param[40] = new OracleParameter("p_hal_ecd_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_ecd_stus;
            (param[41] = new OracleParameter("p_hal_ecd_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_ecd_tp;
            (param[42] = new OracleParameter("p_hal_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_mgr_cd;
            (param[43] = new OracleParameter("p_hal_is_rsch", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_is_rsch;
            (param[44] = new OracleParameter("p_hal_rsch_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_rsch_dt;
            (param[45] = new OracleParameter("p_hal_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_bank;
            (param[46] = new OracleParameter("p_hal_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_flag;
            (param[47] = new OracleParameter("p_hal_val_01", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_val_01;
            (param[48] = new OracleParameter("p_hal_val_02", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_val_02;
            (param[49] = new OracleParameter("p_hal_val_03", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_val_03;
            (param[50] = new OracleParameter("p_hal_val_04", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_val_04;
            (param[51] = new OracleParameter("p_hal_val_05", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_val_05;
            (param[52] = new OracleParameter("p_hal_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_cre_by;
            (param[53] = new OracleParameter("p_hal_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountLog.Hal_cre_dt;
            param[54] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_save_hp_account_log", CommandType.StoredProcedure, param);
            return effects;
        }

        //by Darshana 08/08/2012 - update account & account log tables account #, invoice #
        public Int32 UpdateAccAuto(string _Accno, string _Invno, Int32 _Accseqno, Int32 _AccLogseqno, Int32 _SeqNo)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Accno;
            (param[1] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Invno;
            (param[2] = new OracleParameter("p_accseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Accseqno;
            (param[3] = new OracleParameter("p_acclogseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _AccLogseqno;
            (param[4] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SeqNo;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_acc_auto", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public Int32 UpdateDayEnd(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_day_end", CommandType.StoredProcedure, param);
            return effects;
        }

        //written by prabhath n 7/8/2012
        public Int32 SaveHpRevertHeader(HpRevertHeader _hpRevertHeader)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[27];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_seq;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_ref;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_pc;
            (param[4] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_acc_no;
            (param[5] = new OracleParameter("p_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_bal;
            (param[6] = new OracleParameter("p_bal_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_bal_intr;
            (param[7] = new OracleParameter("p_bal_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_bal_cap;
            (param[8] = new OracleParameter("p_rvt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rvt_by;
            (param[9] = new OracleParameter("p_rvt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rvt_dt;
            (param[10] = new OracleParameter("p_is_rls", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_is_rls;
            (param[11] = new OracleParameter("p_rls_setl", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rls_setl;
            (param[12] = new OracleParameter("p_rls_ecd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rls_ecd;
            (param[13] = new OracleParameter("p_rls_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rls_bal;
            (param[14] = new OracleParameter("p_rls_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rls_by;
            (param[15] = new OracleParameter("p_rls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rls_dt;
            (param[16] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_cre_by;
            (param[17] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_cre_dt;
            (param[18] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_mod_by;
            (param[19] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_mod_dt;
            (param[20] = new OracleParameter("p_rvt_comment", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rvt_comment;
            (param[21] = new OracleParameter("p_rls_comment", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_rls_comment;
            (param[22] = new OracleParameter("p_rvt_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_chg;   //kapila 26/6/2015
            (param[23] = new OracleParameter("p_hrt_paid_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_paid_bal;
            (param[24] = new OracleParameter("p_hrt_paid_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_paid_cap;  //Tharindu
            (param[25] = new OracleParameter("p_hrt_paid_int", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertHeader.Hrt_paid_int;
            param[26] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_saverevertheader_new", CommandType.StoredProcedure, param);
            return effects;

        }
        //written by prabhath n 7/8/2012
        public Int32 SaveHpRevertDetail(HpRevertDetail _hpRevertDetail)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_seq;
            (param[1] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_line_no;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm;
            (param[3] = new OracleParameter("p_itm_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm_bal;
            (param[4] = new OracleParameter("p_itm_bal_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm_bal_intr;
            (param[5] = new OracleParameter("p_itm_bal_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm_bal_cap;
            (param[6] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_cre_by;
            (param[7] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_cre_dt;
            (param[8] = new OracleParameter("p_paid_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm_paid_bal;
            (param[9] = new OracleParameter("p_paid_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm_paid_cap;
            (param[10] = new OracleParameter("p_paid_int", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpRevertDetail.Hrd_itm_paid_int;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_saverevertdetail", CommandType.StoredProcedure, param);
            return effects;


        }
        // Nadeeka 09-10-2015
        public Int32 UpdateCahsConversionDet(string _newInv, string _oldInv, string _newdo)
        {

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_newinv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newInv;
            (param[1] = new OracleParameter("p_oldInv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldInv;
            (param[2] = new OracleParameter("p_newdo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newdo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateWarrantyCashConv", CommandType.StoredProcedure, param);
            return effects;
        }




        //written by Prabhath 7-08-2012
        public Int32 UpdateAccountStatusforrevert(string _com, string _pc, string _acc, string _status, DateTime _date)
        {
            //sp_updateaccountstusforrevert (p_com in NVARCHAR2,p_pc in NVARCHAR2,p_acc in NVARCHAR2,p_status in NVARCHAR2,p_date in date,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;

            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateaccountstusforrevert", CommandType.StoredProcedure, param);
            return effects;
        }

        //written by Prabhath 7-08-2012
        public Int32 UpdateRevertNo(Int32 _revertseqno, Int32 _adjseqno, string _revertdoc)
        {
            //sp_updaterevertheader(p_revseqno in NUMBER,p_adjseqno in NUMBER,p_revertno in NVARCHAR2,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_revseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertseqno;
            (param[1] = new OracleParameter("p_adjseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _adjseqno;
            (param[2] = new OracleParameter("p_revertno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertdoc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updaterevertheader", CommandType.StoredProcedure, param);
            return effects;
        }

        //written by darshana 11-08-2012
        public VehicalRegistrationDefnition GetVehRegDef(string _com, string _inv, string _itm, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_reg_amt", CommandType.StoredProcedure, false, param);

            VehicalRegistrationDefnition _VehDef = new VehicalRegistrationDefnition();
            if (_dtResults.Rows.Count > 0)
            {
                _VehDef = DataTableExtensions.ToGenericList<VehicalRegistrationDefnition>(_dtResults, VehicalRegistrationDefnition.Converter)[0];
            }
            return _VehDef;
        }

        //Written by darshana 14-08-2012
        public Int32 SaveVehRegistration(VehicalRegistration _Registration)
        {
            OracleParameter[] param = new OracleParameter[66];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_svrt_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Registration.P_seq;
            (param[1] = new OracleParameter("p_srvt_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_srvt_ref_no;
            (param[2] = new OracleParameter("p_svrt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_com;
            (param[3] = new OracleParameter("p_svrt_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_pc;
            (param[4] = new OracleParameter("p_svrt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_dt;
            (param[5] = new OracleParameter("p_svrt_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_inv_no;
            (param[6] = new OracleParameter("p_svrt_sales_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_sales_tp;
            (param[7] = new OracleParameter("p_svrt_reg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Registration.P_svrt_reg_val;
            (param[8] = new OracleParameter("p_svrt_claim_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Registration.P_svrt_claim_val;
            (param[9] = new OracleParameter("p_svrt_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_id_tp;
            (param[10] = new OracleParameter("p_svrt_id_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_id_ref;
            (param[11] = new OracleParameter("p_svrt_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_cust_cd;
            (param[12] = new OracleParameter("p_svrt_cust_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_cust_title;
            (param[13] = new OracleParameter("p_svrt_last_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_last_name;
            (param[14] = new OracleParameter("p_svrt_full_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_full_name;
            (param[15] = new OracleParameter("p_svrt_initial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_initial;
            (param[16] = new OracleParameter("p_svrt_add01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_add01;
            (param[17] = new OracleParameter("p_svrt_add02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_add02;
            (param[18] = new OracleParameter("p_svrt_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_city;
            (param[19] = new OracleParameter("p_svrt_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_district;
            (param[20] = new OracleParameter("p_svrt_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_province;
            (param[21] = new OracleParameter("p_svrt_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_contact;
            (param[22] = new OracleParameter("p_svrt_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_model;
            (param[23] = new OracleParameter("p_svrt_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_brd;
            (param[24] = new OracleParameter("p_svrt_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_chassis;
            (param[25] = new OracleParameter("p_svrt_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_engine;
            (param[26] = new OracleParameter("p_svrt_color", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_color;
            (param[27] = new OracleParameter("p_svrt_fuel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_fuel;
            (param[28] = new OracleParameter("p_svrt_capacity", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Registration.P_svrt_capacity;
            (param[29] = new OracleParameter("p_svrt_unit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_unit;
            (param[30] = new OracleParameter("p_svrt_horse_power", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Registration.P_svrt_horse_power;
            (param[31] = new OracleParameter("p_svrt_wheel_base", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Registration.P_svrt_wheel_base;
            (param[32] = new OracleParameter("p_svrt_tire_front", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_tire_front;
            (param[33] = new OracleParameter("p_svrt_tire_rear", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_tire_rear;
            (param[34] = new OracleParameter("p_svrt_weight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Registration.P_svrt_weight;
            (param[35] = new OracleParameter("p_svrt_man_year", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Registration.P_svrt_man_year;
            (param[36] = new OracleParameter("p_svrt_import", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_import;
            (param[37] = new OracleParameter("p_svrt_authority", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_authority;
            (param[38] = new OracleParameter("p_svrt_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_country;
            (param[39] = new OracleParameter("p_svrt_custom_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_custom_dt;
            (param[40] = new OracleParameter("p_svrt_clear_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_clear_dt;
            (param[41] = new OracleParameter("p_svrt_declear_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_declear_dt;
            (param[42] = new OracleParameter("p_svrt_importer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_importer;
            (param[43] = new OracleParameter("p_svrt_importer_add01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_importer_add01;
            (param[44] = new OracleParameter("p_svrt_importer_add02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_importer_add02;
            (param[45] = new OracleParameter("p_svrt_cre_bt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_cre_bt;
            (param[46] = new OracleParameter("p_svrt_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_cre_dt;
            (param[47] = new OracleParameter("p_svrt_prnt_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Registration.P_svrt_prnt_stus;
            (param[48] = new OracleParameter("p_svrt_prnt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_prnt_by;
            (param[49] = new OracleParameter("p_svrt_prnt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_prnt_dt;
            (param[50] = new OracleParameter("p_srvt_rmv_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Registration.P_srvt_rmv_stus;
            (param[51] = new OracleParameter("p_srvt_rmv_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_srvt_rmv_by;
            (param[52] = new OracleParameter("p_srvt_rmv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_srvt_rmv_dt;
            (param[53] = new OracleParameter("p_svrt_veh_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_veh_reg_no;
            (param[54] = new OracleParameter("p_svrt_reg_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_reg_by;
            (param[55] = new OracleParameter("p_svrt_reg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_svrt_reg_dt;
            (param[56] = new OracleParameter("p_svrt_image", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_svrt_image;
            (param[57] = new OracleParameter("p_srvt_cust_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Registration.P_srvt_cust_stus;
            (param[58] = new OracleParameter("p_srvt_cust_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_srvt_cust_by;
            (param[59] = new OracleParameter("p_srvt_cust_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_srvt_cust_dt;
            (param[60] = new OracleParameter("p_srvt_cls_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Registration.P_srvt_cls_stus;
            (param[61] = new OracleParameter("p_srvt_cls_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_srvt_cls_by;
            (param[62] = new OracleParameter("p_srvt_cls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Registration.P_srvt_cls_dt;
            (param[63] = new OracleParameter("p_srvt_insu_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_srvt_insu_ref;
            (param[64] = new OracleParameter("p_srvt_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Registration.P_srvt_itm_cd;
            param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_insertvehregistration", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 15-08-2012
        public MasterOutsideParty GetOutSidePartyDetails(string _code, string _type)
        {
            MasterOutsideParty _party = new MasterOutsideParty();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblParty = QueryDataTable("tblParty", "sp_getbuscomdetails", CommandType.StoredProcedure, false, param);
            if (_tblParty.Rows.Count > 0)
            {
                _party = DataTableExtensions.ToGenericList<MasterOutsideParty>(_tblParty, MasterOutsideParty.ConvertTotal)[0];
            }

            return _party;

        }

        public MasterOutsideParty GetChequeReceivedDetails(string _code, string _type)
        {
            //Sanjeewa 21-02-2013
            MasterOutsideParty _cheque = new MasterOutsideParty();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblCheque = QueryDataTable("tblParty", "sp_getbuscomdetails", CommandType.StoredProcedure, false, param);
            if (_tblCheque.Rows.Count > 0)
            {
                _cheque = DataTableExtensions.ToGenericList<MasterOutsideParty>(_tblCheque, MasterOutsideParty.ConvertTotal)[0];
            }

            return _cheque;

        }

        //darshana on 15-08-2012
        public InsuarancePolicy GetInusPolicy(string _code)
        {
            InsuarancePolicy _policy = new InsuarancePolicy();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblpolicy = QueryDataTable("_tblpolicy", "sp_getinsupolicy", CommandType.StoredProcedure, false, param);
            if (_tblpolicy.Rows.Count > 0)
            {

                _policy = DataTableExtensions.ToGenericList<InsuarancePolicy>(_tblpolicy, InsuarancePolicy.Converter)[0];

            }

            return _policy;

        }
        public DataTable Get_buscom_branch_det(string bus_cd)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("bus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bus_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblParty = new DataTable();
            _tblParty = QueryDataTable("tbldet", "sp_get_buscom_branch_det", CommandType.StoredProcedure, false, param);

            return _tblParty;
        }

        /// <summary>
        /// Get the General Entity Discount for customer and for the showroom as well. 
        /// Written By Prabhath
        /// </summary>
        /// <param name="_company">Company Code</param>
        /// <param name="_profitcenter">Profit Center</param>
        /// <param name="_date">Current Date</param>
        /// <param name="_book">Price Book</param>
        /// <param name="_level">Price Level</param>
        /// <returns></returns>
        public List<CashGeneralEntiryDiscountDef> GetGeneralEntityDiscountDefinition(string _company, string _profitcenter, DateTime _date, string _book, string _level)
        {
            List<CashGeneralEntiryDiscountDef> _list = null;
            //sp_getgeneralentitydicount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_getgeneralentitydicount", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CashGeneralEntiryDiscountDef>(tblDet, CashGeneralEntiryDiscountDef.Converter);
            }
            return _list;

        }

        //written by darshana 15-08-2012
        public MasterVehicalInsuranceDefinition GetVehInsDef(string _com, string _inv, string _itm, DateTime _date, string _pc, string _insCom, string _insPol, Int32 _tearm)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insCom;
            (param[4] = new OracleParameter("p_ins_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPol;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[6] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            (param[7] = new OracleParameter("p_tearm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tearm;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_insu_amt", CommandType.StoredProcedure, false, param);

            MasterVehicalInsuranceDefinition _VehInsDef = new MasterVehicalInsuranceDefinition();
            if (_dtResults.Rows.Count > 0)
            {
                _VehInsDef = DataTableExtensions.ToGenericList<MasterVehicalInsuranceDefinition>(_dtResults, MasterVehicalInsuranceDefinition.Converter)[0];
            }
            return _VehInsDef;
        }

        public List<CashPromotionDiscountDetail> GetGeneralPromotionDiscount(string _company, string _partytype, string _partycode, string _invoicetype, Int32 _time, string _day, DateTime _date, string _book, string _level, string _item, Int16 _isserialized, Int16 _ispromotion)
        {
            //PROCEDURE sp_getgeneralpromotiondiscount(p_com in NVARCHAR2,p_partytype in NVARCHAR2,p_partycode in NVARCHAR2,p_invtype in NVARCHAR2,
            //p_time in NUMBER, p_day in NVARCHAR2,
            //p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_isserialized in NUMBER,p_ispromo in NUMBER,c_data out sys_refcursor)
            List<CashPromotionDiscountDetail> _list = null;

            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partytype;
            (param[2] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycode;
            (param[3] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicetype;
            (param[4] = new OracleParameter("p_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _time;
            (param[5] = new OracleParameter("p_day", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _day;
            (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[7] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[8] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[9] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[10] = new OracleParameter("p_isserialized", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isserialized;
            (param[11] = new OracleParameter("p_ispromo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ispromotion;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getgeneralpromotiondisc", CommandType.StoredProcedure, false, param);
            //if (_dtResults.Rows.Count > 0)
            //{
            _list = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(_dtResults, CashPromotionDiscountDetail.Converter);
            //}
            return _list;


        }

        //Written by darshana 14-08-2012
        public Int32 SaveVehInsuarance(VehicleInsuarance _Insuarance)
        {
            OracleParameter[] param = new OracleParameter[66];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_svit_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Insuarance.Svit_seq;
            (param[1] = new OracleParameter("p_svit_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ref_no;
            (param[2] = new OracleParameter("p_svit_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_com;
            (param[3] = new OracleParameter("p_svit_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_pc;
            (param[4] = new OracleParameter("p_svit_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_dt;
            (param[5] = new OracleParameter("p_svit_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_inv_no;
            (param[6] = new OracleParameter("p_svit_sales_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_sales_tp;
            (param[7] = new OracleParameter("p_svit_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ins_com;
            (param[8] = new OracleParameter("p_svit_ins_polc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ins_polc;
            (param[9] = new OracleParameter("p_svit_ins_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ins_val;
            (param[10] = new OracleParameter("p_svit_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cust_cd;
            (param[11] = new OracleParameter("p_svit_cust_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cust_title;
            (param[12] = new OracleParameter("p_svit_last_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_last_name;
            (param[13] = new OracleParameter("p_svit_full_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_full_name;
            (param[14] = new OracleParameter("p_svit_initial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_initial;
            (param[15] = new OracleParameter("p_svit_add01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_add01;
            (param[16] = new OracleParameter("p_svit_add02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_add02;
            (param[17] = new OracleParameter("p_svit_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_city;
            (param[18] = new OracleParameter("p_svit_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_district;
            (param[19] = new OracleParameter("p_svit_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_province;
            (param[20] = new OracleParameter("p_svit_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_contact;
            (param[21] = new OracleParameter("p_svit_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_model;
            (param[22] = new OracleParameter("p_svit_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_brd;
            (param[23] = new OracleParameter("p_svit_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_chassis;
            (param[24] = new OracleParameter("p_svit_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_engine;
            (param[25] = new OracleParameter("p_svit_capacity", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_capacity;
            (param[26] = new OracleParameter("p_svit_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cre_by;
            (param[27] = new OracleParameter("p_svit_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cre_dt;
            (param[28] = new OracleParameter("p_svit_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_mod_by;
            (param[29] = new OracleParameter("p_svit_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_mod_dt;
            (param[30] = new OracleParameter("p_svit_cvnt_issue", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_issue;
            (param[31] = new OracleParameter("p_svit_cvnt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_no;
            (param[32] = new OracleParameter("p_svit_cvnt_days", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_days;
            (param[33] = new OracleParameter("p_svit_cvnt_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_from_dt;
            (param[34] = new OracleParameter("p_svit_cvnt_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_to_dt;
            (param[35] = new OracleParameter("p_svit_cvnt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_by;
            (param[36] = new OracleParameter("p_svit_cvnt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_cvnt_dt;
            (param[37] = new OracleParameter("p_svit_ext_issue", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_issue;
            (param[38] = new OracleParameter("p_svit_ext_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_no;
            (param[39] = new OracleParameter("p_svit_ext_days", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_days;
            (param[40] = new OracleParameter("p_svit_ext_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_from_dt;
            (param[41] = new OracleParameter("p_svit_ext_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_to_dt;
            (param[42] = new OracleParameter("p_svit_ext_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_by;
            (param[43] = new OracleParameter("p_svit_ext_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_ext_dt;
            (param[44] = new OracleParameter("p_svit_veh_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_veh_reg_no;
            (param[45] = new OracleParameter("p_svit_reg_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_reg_by;
            (param[46] = new OracleParameter("p_svit_reg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_reg_dt;
            (param[47] = new OracleParameter("p_svit_polc_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Insuarance.Svit_polc_stus;
            (param[48] = new OracleParameter("p_svit_polc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_polc_no;
            (param[49] = new OracleParameter("p_svit_eff_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_eff_dt;
            (param[50] = new OracleParameter("p_svit_expi_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_expi_dt;
            (param[51] = new OracleParameter("p_svit_net_prem", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Insuarance.Svit_net_prem;
            (param[52] = new OracleParameter("p_svit_srcc_prem", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Insuarance.Svit_srcc_prem;
            (param[53] = new OracleParameter("p_svit_oth_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Insuarance.Svit_oth_val;
            (param[54] = new OracleParameter("p_svit_tot_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Insuarance.Svit_tot_val;
            (param[55] = new OracleParameter("p_svit_polc_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_polc_by;
            (param[56] = new OracleParameter("p_svit_polc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_polc_dt;
            (param[57] = new OracleParameter("p_svit_dbt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_dbt_no;
            (param[58] = new OracleParameter("p_svit_dbt_set_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Insuarance.Svit_dbt_set_stus;
            (param[59] = new OracleParameter("p_svit_dbt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_dbt_by;
            (param[60] = new OracleParameter("p_svit_dbt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Insuarance.Svit_dbt_dt;
            (param[61] = new OracleParameter("p_svit_veg_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_veg_ref;
            (param[62] = new OracleParameter("p_svit_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_itm_cd;
            (param[63] = new OracleParameter("p_svit_rec_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_rec_tp;
            (param[64] = new OracleParameter("p_svit_file_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_file_no;
            param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_insertvehinsuarance", CommandType.StoredProcedure, param);
            return effects;
        }

        #region Vehicle job
        //created by Shani on 17/08/2012
        public InventorySerialMaster GetVehicleDetails(string RegistrationNo, string EngineNo, string ChasseNo)
        {
            InventorySerialMaster _list = new InventorySerialMaster();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_regNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = RegistrationNo;
            (param[1] = new OracleParameter("p_engineNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EngineNo;
            (param[2] = new OracleParameter("p_chasseNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ChasseNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblVehicleDet", "sp_getAll_VehicleDetails", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialMaster>(_dtResults, InventorySerialMaster.ConvertTotal)[0];
            }
            return _list;

        }
        public DataTable GetServiceTypes(string com, string loc)
        {
            // p_com in NVARCHAR2,p_loc in NVARCHAR2
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //  DataTable _dtResults = QueryDataTable("tblSevTp", "sp_get_ServiceTypes", CommandType.StoredProcedure, false, param);// NADEEKA 19-01-2015
            DataTable _dtResults = QueryDataTable("tblSevTp", "sp_get_ServiceCategory", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetMsgColumn()
        {
            OracleParameter[] param = new OracleParameter[1];


            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblSevTp", "sp_getallmsgColumn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable GetNextServiceDet(string RegistrationNo, string EngineNo, string ChasseNo)
        {
            // p_com in NVARCHAR2,p_loc in NVARCHAR2
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_regNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = RegistrationNo;
            (param[1] = new OracleParameter("p_EngineNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EngineNo;
            (param[2] = new OracleParameter("p_ChasseNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ChasseNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSevTp", "sp_get_NextServiceDet", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetLastServiceDet(string RegistrationNo, string EngineNo, string ChasseNo)
        {
            // p_com in NVARCHAR2,p_loc in NVARCHAR2
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_regNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = RegistrationNo;
            (param[1] = new OracleParameter("p_EngineNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EngineNo;
            (param[2] = new OracleParameter("p_ChasseNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ChasseNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSevTp", "sp_get_LastServiceDet", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_DefectTypes(string com, string loc)
        {
            // p_com in NVARCHAR2,p_loc in NVARCHAR2
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblSevTp", "sp_get_DefectTypes", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int32 Save_JobDetail(ServiceJobDetail _revertDet)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[54];
            // (param[62] = new OracleParameter("p_svit_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Insuarance.Svit_itm_cd;

            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_jobno;
            (param[1] = new OracleParameter("p_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_jobline;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_itm_cd;
            (param[3] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_itm_stus;
            (param[4] = new OracleParameter("p_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_itm_desc;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_brand;
            (param[6] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_model;
            (param[7] = new OracleParameter("p_itm_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _revertDet.Jbd_itm_cost;
            (param[8] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_ser1;
            (param[9] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_ser2;
            (param[10] = new OracleParameter("p_ser3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_ser3;
            (param[11] = new OracleParameter("p_ser4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_ser4;
            (param[12] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_warr;
            (param[13] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_regno;
            (param[14] = new OracleParameter("p_milage", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _revertDet.Jbd_milage;
            (param[15] = new OracleParameter("p_warr_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_warr_stus == true ? 1 : 0;
            (param[16] = new OracleParameter("p_onloan", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_onloan == true ? 1 : 0;
            (param[17] = new OracleParameter("p_chg_warrstdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _revertDet.Jbd_chg_warrstdt;
            (param[18] = new OracleParameter("p_chg_warrrmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_chg_warrrmk;
            (param[19] = new OracleParameter("p_sentwcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_sentwcn == true ? 1 : 0;
            (param[20] = new OracleParameter("p_isinsurance", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_isinsurance == true ? 1 : 0;
            (param[21] = new OracleParameter("p_req_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_req_tp;
            (param[22] = new OracleParameter("p_sev_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_sev_term;
            (param[23] = new OracleParameter("p_lastwarrstdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _revertDet.Jbd_lastwarrstdt;
            (param[24] = new OracleParameter("p_issued", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_issued == true ? 1 : 0;
            (param[25] = new OracleParameter("p_mainitmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainitmcd;
            (param[26] = new OracleParameter("p_mainitmser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainitmser;
            (param[27] = new OracleParameter("p_mainitmwarr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainitmwarr;
            (param[28] = new OracleParameter("p_itm_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_itm_mfc;
            (param[29] = new OracleParameter("p_mainitm_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainitm_mfc;
            (param[30] = new OracleParameter("p_availabilty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_availabilty == true ? 1 : 0;
            (param[31] = new OracleParameter("p_usejob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_usejob;
            (param[32] = new OracleParameter("p_msnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_msnno;
            (param[33] = new OracleParameter("p_item_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_item_tp;
            (param[34] = new OracleParameter("p_sevlocachr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_sevlocachr;
            (param[35] = new OracleParameter("p_cust_notes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_cust_notes;
            (param[36] = new OracleParameter("p_mainreqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainreqno;
            (param[37] = new OracleParameter("p_mainreqloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainreqloc;
            (param[38] = new OracleParameter("p_mainjobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_mainjobno;
            (param[39] = new OracleParameter("p_reqitmtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_reqitmtp;
            (param[40] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_reqno;
            (param[41] = new OracleParameter("p_reqline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_reqline;
            (param[42] = new OracleParameter("p_isstockupdate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_isstockupdate == true ? 1 : 0;
            (param[43] = new OracleParameter("p_needgatepass", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_needgatepass == true ? 1 : 0;
            (param[44] = new OracleParameter("p_iswrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDet.Jbd_iswrn == true ? 1 : 0;
            (param[45] = new OracleParameter("p_warrperiod", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _revertDet.Jbd_warrperiod;
            (param[46] = new OracleParameter("p_warrstartdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _revertDet.Jbd_warrstartdt;
            (param[47] = new OracleParameter("p_warrreplace", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_warrreplace == true ? 1 : 0;
            (param[48] = new OracleParameter("p_dt_pur", OracleDbType.Date, null, ParameterDirection.Input)).Value = _revertDet.Jbd_dt_pur;
            (param[49] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_invoiceno;
            (param[50] = new OracleParameter("p_waraamd_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_waraamd_seq;
            (param[51] = new OracleParameter("p_waraamd_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDet.Jbd_waraamd_by;
            (param[52] = new OracleParameter("p_waraamd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _revertDet.Jbd_waraamd_dt;
            param[53] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_sevjobdet", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Save_Job_Defect(ServiceJobDefect _revertDefect)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDefect.Srd_jobno;
            (param[1] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDefect.Srd_job_line;
            (param[2] = new OracleParameter("p_defc_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _revertDefect.Srd_defc_line;
            (param[3] = new OracleParameter("p_job_defc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDefect.Srd_job_defc_tp;
            (param[4] = new OracleParameter("p_job_defc_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertDefect.Srd_job_defc_rmk;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_service_job_Defect", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Save_Job_stagelog(ServiceJobStageLog _stagelog)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjl_seqno;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjl_reqno;
            (param[2] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjl_jobno;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjl_loc;
            (param[4] = new OracleParameter("p_othdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjl_othdocno;
            (param[5] = new OracleParameter("p_jobstage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjl_jobstage;
            (param[6] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjl_cre_by;
            (param[7] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjl_cre_dt;


            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_service_job_stagelog", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Save_Job_Header(ServiceJobHeader _stagelog)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[88];
            (param[0] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_address1;
            (param[1] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_address2;
            (param[2] = new OracleParameter("p_agreementno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_agreementno;
            (param[3] = new OracleParameter("p_aodissuedt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_aodissuedt;
            (param[4] = new OracleParameter("p_aodissueloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_aodissueloc;
            (param[5] = new OracleParameter("p_aodissueno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_aodissueno;
            (param[6] = new OracleParameter("p_aodrecno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_aodrecno;
            (param[7] = new OracleParameter("p_bill_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_address1;
            (param[8] = new OracleParameter("p_bill_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_address2;
            (param[9] = new OracleParameter("p_bill_address3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_address3;
            (param[10] = new OracleParameter("p_bill_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_cust_cd;
            (param[11] = new OracleParameter("p_bill_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_cust_name;
            (param[12] = new OracleParameter("p_bill_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_email;
            (param[13] = new OracleParameter("p_bill_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_fax;
            (param[14] = new OracleParameter("p_bill_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_id;
            (param[15] = new OracleParameter("p_bill_idtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_idtype;
            (param[16] = new OracleParameter("p_bill_mobino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_mobino;
            (param[17] = new OracleParameter("p_bill_phone_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_phone_no;
            (param[18] = new OracleParameter("p_bill_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_title;
            (param[19] = new OracleParameter("p_bill_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_bill_town;
            (param[20] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_chnl;
            (param[21] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_com;
            (param[22] = new OracleParameter("p_cont_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cont_address1;
            (param[23] = new OracleParameter("p_cont_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cont_address2;
            (param[24] = new OracleParameter("p_cont_person", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cont_person;
            (param[25] = new OracleParameter("p_cont_phone_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cont_phone_no;
            (param[26] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cre_by;
            (param[27] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cre_dt;
            (param[28] = new OracleParameter("p_cusagreementno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cusagreementno;
            (param[29] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cust_cd;
            (param[30] = new OracleParameter("p_cust_expectdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cust_expectdt;
            (param[31] = new OracleParameter("p_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_cust_name;
            (param[32] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_dt;
            (param[33] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_email;
            (param[34] = new OracleParameter("p_end_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_end_dt;
            (param[35] = new OracleParameter("p_faxno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_faxno;
            (param[36] = new OracleParameter("p_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_id_tp;
            (param[37] = new OracleParameter("p_idno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_idno;
            (param[38] = new OracleParameter("p_inform_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_inform_contact;
            (param[39] = new OracleParameter("p_inform_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_inform_location;
            (param[40] = new OracleParameter("p_inform_person", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_inform_person;
            (param[41] = new OracleParameter("p_insu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_insu_com;
            (param[42] = new OracleParameter("p_isagreement", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_isagreement;
            (param[43] = new OracleParameter("p_isexternalitem", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjb_isexternalitem;
            (param[44] = new OracleParameter("p_isprejob", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjb_isprejob;
            (param[45] = new OracleParameter("p_issrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjb_issrn;
            (param[46] = new OracleParameter("p_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_itm_tp;
            (param[47] = new OracleParameter("p_job_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_job_cat;
            (param[48] = new OracleParameter("p_job_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_job_rmk;
            (param[49] = new OracleParameter("p_job_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_job_sub_tp;
            (param[50] = new OracleParameter("p_job_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_job_tp;
            (param[51] = new OracleParameter("p_jobclosecd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_jobclosecd;
            (param[52] = new OracleParameter("p_jobclosedesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_jobclosedesc;
            //------------------------------------------------------------------------------------------------------------------------------
            (param[53] = new OracleParameter("p_jobclosermk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_jobclosermk;
            (param[54] = new OracleParameter("p_jobconfdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_jobconfdate;
            (param[55] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_jobno; //_stagelog.Sjb_jobno;
            (param[56] = new OracleParameter("p_jobstage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjb_jobstage;
            (param[57] = new OracleParameter("p_lastprintby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_lastprintby;
            (param[58] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_loc;
            (param[59] = new OracleParameter("p_mainjobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_mainjobno;
            (param[60] = new OracleParameter("p_mainreqloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_mainreqloc;
            (param[61] = new OracleParameter("p_mainreqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_mainreqno;
            (param[62] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_manualref;
            (param[63] = new OracleParameter("p_mobino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_mobino;
            (param[64] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_mod_by;
            (param[65] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_mod_dt;
            (param[66] = new OracleParameter("p_msn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_msn_no;
            (param[67] = new OracleParameter("p_noofprint", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stagelog.Sjb_noofprint;
            (param[68] = new OracleParameter("p_orderno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_orderno;
            (param[69] = new OracleParameter("p_othref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_othref;
            (param[70] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_pc;
            (param[71] = new OracleParameter("p_phoneno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_phoneno;
            (param[72] = new OracleParameter("p_prority", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_prority;
            (param[73] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_quotation;
            (param[74] = new OracleParameter("p_redojob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_redojob;
            (param[75] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_reqno;
            (param[76] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_rmk;
            (param[77] = new OracleParameter("p_start_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_start_dt;
            (param[78] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_stus;
            (param[79] = new OracleParameter("p_substage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_substage;
            (param[80] = new OracleParameter("p_tech_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_tech_rmk;
            (param[81] = new OracleParameter("p_techfinishdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_techfinishdate;
            (param[82] = new OracleParameter("p_techstartdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_techstartdate;
            (param[83] = new OracleParameter("p_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_title;
            (param[84] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_town;
            (param[85] = new OracleParameter("p_transferby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stagelog.Sjb_transferby;
            (param[86] = new OracleParameter("p_transferdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _stagelog.Sjb_transferdt;
            param[87] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_severvice_job_hdr", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Save_Job_Allocation(ServiceJobAlloc _serAlloc)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[43];

            (param[0] = new OracleParameter("p_GNI_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_inv_no;
            (param[1] = new OracleParameter("p_GNI_INV_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_inv_dt;
            (param[2] = new OracleParameter("p_GNI_DO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_do_no;
            (param[3] = new OracleParameter("p_GNI_DO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_do_dt;
            (param[4] = new OracleParameter("p_GNI_DO_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_do_loc;
            (param[5] = new OracleParameter("p_GNI_CUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_cus;
            (param[6] = new OracleParameter("p_GNI_CUS_ADD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_cus_add;
            (param[7] = new OracleParameter("p_GNI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_itm_cd;
            (param[8] = new OracleParameter("p_GNI_ITM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_itm_desc;
            (param[9] = new OracleParameter("p_GNI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_model;
            (param[10] = new OracleParameter("p_GNI_CAT_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_cat_1;
            (param[11] = new OracleParameter("p_GNI_CAT_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_cat_2;
            (param[12] = new OracleParameter("p_GNI_BRND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_brnd;
            (param[13] = new OracleParameter("p_GNI_SERIAL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_serial;
            (param[14] = new OracleParameter("p_GNI_WARA_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_wara_no;
            (param[15] = new OracleParameter("p_GNI_WARA_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_wara_period;
            (param[16] = new OracleParameter("p_GNI_WARA_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_wara_rem;
            (param[17] = new OracleParameter("p_GNI_ALLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_alloc;
            (param[18] = new OracleParameter("p_GNI_JOB_COM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_job_com;
            (param[19] = new OracleParameter("p_GNI_JOB_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_job_dt;
            (param[20] = new OracleParameter("p_GNI_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_job_no;
            (param[21] = new OracleParameter("p_GNI_IS_CANCEL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_is_cancel;
            (param[22] = new OracleParameter("p_GNI_CANCEL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_cancel_dt;
            (param[23] = new OracleParameter("p_GNI_CANCEL_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_cancel_rem;
            (param[24] = new OracleParameter("p_GNI_JOB_ST_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_job_st_dt;
            (param[25] = new OracleParameter("p_GNI_JOB_ED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_job_ed_dt;
            (param[26] = new OracleParameter("p_GNI_JOB_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_job_stus;
            (param[27] = new OracleParameter("p_GNI_HOLD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_hold_by;
            (param[28] = new OracleParameter("p_GNI_HOLD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_hold_dt;
            (param[29] = new OracleParameter("p_GNI_HOLD_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_hold_rem;
            (param[30] = new OracleParameter("p_GNI_RE_ALLOC_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_re_alloc_by;
            (param[31] = new OracleParameter("p_GNI_RE_ALLOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serAlloc.Gni_re_alloc_dt;
            (param[32] = new OracleParameter("p_GNI_RE_ALLOC_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_re_alloc_rem;
            (param[33] = new OracleParameter("p_GNI_OTH_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_oth_rem;
            (param[34] = new OracleParameter("p_GNI_IS_UPDATED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_is_updated;
            (param[35] = new OracleParameter("p_GNI_SERVICE_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.Gni_service_loc;
            (param[36] = new OracleParameter("p_GNI_ALLOC_INDEX", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_alloc_index;
            (param[37] = new OracleParameter("p_GNI_IS_SR_JOB_UPDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serAlloc.Gni_is_sr_job_update;

            (param[38] = new OracleParameter("p_GNI_CONT_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.GNI_CONT_NO;
            (param[39] = new OracleParameter("p_GNI_CONT_PERSON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.GNI_CONT_PERSON;
            (param[40] = new OracleParameter("p_GNI_SERV_ADDR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.GNI_SERV_ADDR;
            (param[41] = new OracleParameter("p_GNI_INSTALL_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serAlloc.GNI_INSTALL_LOC;

            param[42] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_job_base_det", CommandType.StoredProcedure, param);
            return effects;

        }



        public Int32 UpdateOrInsert_ServiceShedule(ServiceJobDetail sevDet, int isUpdate, int serID, DateTime jobDate)
        {
            //INR_SERMST_SEVSHED

            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_regNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sevDet.Jbd_regno;
            (param[1] = new OracleParameter("p_EngineNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sevDet.Jbd_ser1;
            (param[2] = new OracleParameter("p_ChasseNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sevDet.Jbd_ser2;
            (param[3] = new OracleParameter("p_serID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serID;
            (param[4] = new OracleParameter("p_itemCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sevDet.Jbd_itm_cd;
            (param[5] = new OracleParameter("p_itmStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sevDet.Jbd_itm_stus;
            (param[6] = new OracleParameter("p_isUpdate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isUpdate;
            (param[7] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sevDet.Jbd_jobno;
            (param[8] = new OracleParameter("p_jobDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = jobDate;
            (param[9] = new OracleParameter("p_actReading", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = sevDet.Jbd_milage;
            (param[10] = new OracleParameter("p_sevTerm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = sevDet.Jbd_sev_term;
            (param[11] = new OracleParameter("p_warr_pd_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "KM";
            (param[12] = new OracleParameter("p_warr_pdalt_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "DD";

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_Or_insert_ServiceDet", CommandType.StoredProcedure, param);
            return effects;
        }

        #endregion Vehicle job

        public Int32 GetEstimateSeq()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_GETESTIMATESEQ", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveAgreementHeader(SCV_AGR_HDR _agrHdr)
        {
            OracleParameter[] param = new OracleParameter[38];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SAG_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrHdr.Sag_seq_no;
            (param[1] = new OracleParameter("p_SAG_AGR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_agr_no;
            (param[2] = new OracleParameter("p_SAG_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_com;
            (param[3] = new OracleParameter("p_SAG_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_tp;
            (param[4] = new OracleParameter("p_SAG_CLM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_clm_tp;
            (param[5] = new OracleParameter("p_SAG_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_chnl;
            (param[6] = new OracleParameter("p_SAG_SCHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_schnl;
            (param[7] = new OracleParameter("p_SAG_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_pc;
            (param[8] = new OracleParameter("p_SAG_MULTI_PC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrHdr.Sag_multi_pc;
            (param[9] = new OracleParameter("p_SAG_COMMDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agrHdr.Sag_commdt;
            (param[10] = new OracleParameter("p_SAG_EXDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agrHdr.Sag_exdt;
            (param[11] = new OracleParameter("p_SAG_REWLDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agrHdr.Sag_rewldt;
            (param[12] = new OracleParameter("p_SAG_CUSTCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_custcd;
            (param[13] = new OracleParameter("p_SAG_CUST_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_cust_town;
            (param[14] = new OracleParameter("p_SAG_TOWN_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_town_rmk;
            (param[15] = new OracleParameter("p_SAG_CONT_PERSON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_cont_person;
            (param[16] = new OracleParameter("p_SAG_CONT_ADD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_cont_add;
            (param[17] = new OracleParameter("p_SAG_CONT_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_cont_no;
            (param[18] = new OracleParameter("p_SAG_MANUALREF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_manualref;
            (param[19] = new OracleParameter("p_SAG_OTHERREF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_otherref;
            (param[20] = new OracleParameter("p_SAG_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_rmk;
            (param[21] = new OracleParameter("p_SAG_GL_DEBTOR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_gl_debtor_cd;
            (param[22] = new OracleParameter("p_SAG_TOT_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrHdr.Sag_tot_amt;
            (param[23] = new OracleParameter("p_SAG_SET_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrHdr.Sag_set_amt;
            (param[24] = new OracleParameter("p_SAG_PERIOD_BASIS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_period_basis;
            (param[25] = new OracleParameter("p_SAG_SER_ATTEMPT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrHdr.Sag_ser_attempt;
            (param[26] = new OracleParameter("p_SAG_TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_top;
            (param[27] = new OracleParameter("p_SAG_TAC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_tac;
            (param[28] = new OracleParameter("p_SAG_WORK_INC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_work_inc;
            (param[29] = new OracleParameter("p_SAG_SVC_FREQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_svc_freq;
            (param[30] = new OracleParameter("p_SAG_PERIOD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_period;
            (param[31] = new OracleParameter("p_SAG_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_stus;
            (param[32] = new OracleParameter("p_SAG_STUS_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_stus_rmk;
            (param[33] = new OracleParameter("p_SAG_AUTHOBY1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_authoby1;
            (param[34] = new OracleParameter("p_SAG_AUTHOBY2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_authoby2;
            (param[35] = new OracleParameter("p_SAG_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_cre_by;
            (param[36] = new OracleParameter("p_SAG_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrHdr.Sag_mod_by;


            param[37] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_scv_agr_hdr", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveAgreementItem(SCV_AGR_ITM _agrItm)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SAI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrItm.Sai_seq_no;
            (param[1] = new OracleParameter("p_SAI_AGR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Sai_agr_no;
            (param[2] = new OracleParameter("p_SAI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrItm.Sai_line;
            (param[3] = new OracleParameter("p_SHI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_itm_cd;
            (param[4] = new OracleParameter("p_SHI_ITM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_itm_desc;
            (param[5] = new OracleParameter("p_SHI_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_brand;
            (param[6] = new OracleParameter("p_SHI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_model;
            (param[7] = new OracleParameter("p_SHI_SER1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_ser1;
            (param[8] = new OracleParameter("p_SHI_SER2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_ser2;
            (param[9] = new OracleParameter("p_SHI_SER_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_ser_id;
            (param[10] = new OracleParameter("p_SHI_WARRNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_warrno;
            (param[11] = new OracleParameter("p_SHI_WARR_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrItm.Shi_warr_stus;
            (param[12] = new OracleParameter("p_SHI_REGNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_regno;
            (param[13] = new OracleParameter("p_SHI_CATE1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_cate1;
            (param[14] = new OracleParameter("p_SHI_CATE2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_cate2;
            (param[15] = new OracleParameter("p_SHI_CATE3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_cate3;
            (param[16] = new OracleParameter("p_SHI_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrItm.Shi_qty;
            (param[17] = new OracleParameter("p_SHI_SESSIONS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrItm.Shi_sessions;
            (param[18] = new OracleParameter("p_SHI_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrItm.Shi_inv_no;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_scv_agr_itm", CommandType.StoredProcedure, param);
            return effects;
        }


        public Int32 SaveAgreementCharges(scv_agr_cha _agrCha)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_SAC_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_seq;
            (param[1] = new OracleParameter("p_SAC_AGR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrCha.Sac_agr_no;
            (param[2] = new OracleParameter("p_SAC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_line;
            (param[3] = new OracleParameter("p_SAC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrCha.Sac_itm_cd;
            (param[4] = new OracleParameter("p_SAC_ITM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrCha.Sac_itm_desc;
            (param[5] = new OracleParameter("p_SAC_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_qty;
            (param[6] = new OracleParameter("p_SAC_UNIT_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_unit_rt;
            (param[7] = new OracleParameter("p_SAC_UNIT_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_unit_amt;
            (param[8] = new OracleParameter("p_SAC_DIS_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_dis_rt;
            (param[9] = new OracleParameter("p_SAC_DIS_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_dis_amt;
            (param[10] = new OracleParameter("p_SAC_TAX", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_tax;
            (param[11] = new OracleParameter("p_SAC_TOT_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCha.Sac_tot_amt;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_scv_agr_cha", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveAgreementPayShed(scv_agr_payshed _agrPayShed)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_SAP_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrPayShed.Sap_seq;
            (param[1] = new OracleParameter("p_SAP_AGR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrPayShed.Sap_agr_no;
            (param[2] = new OracleParameter("p_SAP_TERM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrPayShed.Sap_term;
            (param[3] = new OracleParameter("p_SAP_DUE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agrPayShed.Sap_due_dt;
            (param[4] = new OracleParameter("p_SAP_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrPayShed.Sap_amt;
            (param[5] = new OracleParameter("p_SAP_BAL_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrPayShed.Sap_bal_amt;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_scv_agr_payshed", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveAgreementSess(SCV_AGR_SES _agrSes)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SAGA_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrSes.Saga_seq_no;
            (param[1] = new OracleParameter("p_SAGA_AGR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrSes.Saga_agr_no;
            (param[2] = new OracleParameter("p_SAGA_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrSes.Saga_itm_line;
            (param[3] = new OracleParameter("p_SAGA_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrSes.Saga_line;
            (param[4] = new OracleParameter("p_SAGA_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agrSes.Saga_from_dt;
            (param[5] = new OracleParameter("p_SAGA_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agrSes.Saga_to_dt;
            (param[6] = new OracleParameter("p_SAGA_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrSes.Saga_stus;


            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_scv_agr_ses", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveAgreementCoverItem(SCV_AGR_COVER_ITM _agrCov)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SAIC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCov.Saic_seq_no;
            (param[1] = new OracleParameter("p_SAIC_AGR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrCov.Saic_agr_no;
            (param[2] = new OracleParameter("p_SAIC_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCov.Saic_itm_line;
            (param[3] = new OracleParameter("p_SAIC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agrCov.Saic_line;
            (param[4] = new OracleParameter("p_SAIC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrCov.Saic_itm_cd;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_scv_agr_covitm", CommandType.StoredProcedure, param);
            return effects;
        }
        //Written By Prabhath on 18/08/2012
        public string GetInvoicePrefix(string _company, string _profitcenter, string _invoicetype)
        {
            // sp_getinvoiceprefix (p_com in NVARCHAR2,p_profit in NVARCHAR2 ,p_invoicetype in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_invoicetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicetype;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            string _prefix = string.Empty;

            DataTable _dtResults = QueryDataTable("tbldata", "sp_getinvoiceprefix", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow _r in _dtResults.Rows)
                {
                    _prefix = _r[0].ToString();
                    break;
                }

            }

            return _prefix;
        }

        //Written By Prabhath on 20/08/2012
        public DataTable GetEmployee(string _company, string _employee)
        {
            //PROCEDURE sp_getemployee(p_com in NVARCHAR2,p_exe in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_exe", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employee;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getemployee", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetESDSrDet(string _com, string _PC, string _epf)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PC;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_esd_sr_dt", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //written by darshana on 21/08/2012
        public Int32 SaveHpShedule(HpSheduleDetails _hpSheduleDetails)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_hts_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_seq;
            (param[1] = new OracleParameter("p_hts_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_acc_no;
            (param[2] = new OracleParameter("p_hts_rnt_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_rnt_no;
            (param[3] = new OracleParameter("p_hts_due_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_due_dt;
            (param[4] = new OracleParameter("p_hts_rnt_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_rnt_val;
            (param[5] = new OracleParameter("p_hts_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_intr;
            (param[6] = new OracleParameter("p_hts_ser", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_ser;
            (param[7] = new OracleParameter("p_hts_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_ins;
            (param[8] = new OracleParameter("p_hts_sdt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_sdt;
            (param[9] = new OracleParameter("p_hts_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_cre_by;
            (param[10] = new OracleParameter("p_hts_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_cre_dt;
            (param[11] = new OracleParameter("p_hts_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_mod_by;
            (param[12] = new OracleParameter("p_hts_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_mod_dt;
            (param[13] = new OracleParameter("p_hts_upload", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_upload;
            (param[14] = new OracleParameter("p_hts_veh_insu", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_veh_insu;
            (param[15] = new OracleParameter("p_hts_tot_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_tot_val;
            (param[16] = new OracleParameter("p_hts_ins_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_ins_vat;
            (param[17] = new OracleParameter("p_hts_ins_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_ins_comm;
            (param[18] = new OracleParameter("p_hts_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_cap;
            (param[19] = new OracleParameter("p_hts_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpSheduleDetails.Hts_vat;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_hp_shedule", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 UpdateInvAcc(Int32 _invoiceseqno, string _accno)
        {

            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[1] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_inv_accno", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateHPShedule(string _accno, Int32 _tearm, decimal _insAmt, decimal _totAmt)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("p_tearm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tearm;
            (param[2] = new OracleParameter("p_insAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insAmt;
            (param[3] = new OracleParameter("p_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _totAmt;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_hp_shedule", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveCashGeneralEntityDiscount(CashGeneralEntiryDiscountDef _cashGenEntityDis)
        {
            OracleParameter[] param = new OracleParameter[24];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_alw_pro", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_alw_pro;
            (param[1] = new OracleParameter("p_alw_ser", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_alw_ser;
            (param[2] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_circular;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_com;
            (param[4] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_cre_by;
            (param[5] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_cre_dt;
            (param[6] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_cust_cd;
            (param[7] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_disc_rt;
            (param[8] = new OracleParameter("p_disc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_disc_val;
            (param[9] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_from_dt;
            (param[10] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_itm;
            (param[11] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_mod_by;
            (param[12] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_mod_dt;
            (param[13] = new OracleParameter("p_no_of_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_no_of_times;
            (param[14] = new OracleParameter("p_no_of_used_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_no_of_used_times;
            (param[15] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_pb;
            (param[16] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_pb_lvl;
            (param[17] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_pc;
            (param[18] = new OracleParameter("p_req_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_req_ref;
            (param[19] = new OracleParameter("p_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_sale_tp;
            (param[20] = new OracleParameter("p_seq", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_seq;
            (param[21] = new OracleParameter("p_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_stus;
            (param[22] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashGenEntityDis.Sgdd_to_dt;
            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_sar_gen_disc_defn", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By Prabhath on 28/08/2012
        public InvoiceHeader GetInvoiceHeader(string _invoiceno)
        {
            InvoiceHeader _hdr = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblSalesDet", "sp_getinvoiceheader", CommandType.StoredProcedure, false, param);

            if (_dtResult.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResult, InvoiceHeader.ConvertTotal)[0];
            }

            return _hdr;

        }

        //Written By Prabhath on 28/08/2012
        public InvoiceHeaderTBS GetInvoiceHeaderTBS(string _invoiceno)
        {
            InvoiceHeaderTBS _hdr = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblSalesDet", "sp_getinvoiceheadertbs", CommandType.StoredProcedure, false, param);

            if (_dtResult.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<InvoiceHeaderTBS>(_dtResult, InvoiceHeaderTBS.ConvertTotal)[0];
            }

            return _hdr;

        }

        //Written By Chamal on 30/01/2015
        public DataTable GetInvoiceHeaderSCM(string _invoiceno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblSalesDet", "sp_getinvoiceheaderscm", CommandType.StoredProcedure, false, param);
        }

        //written by darshana 27/08/2012
        public HpSchemeType getSchemeType(string _type)
        {
            HpSchemeType _SchemeType = new HpSchemeType();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemetype = QueryDataTable("tblschemetype", "sp_getschemetype", CommandType.StoredProcedure, false, param);
            if (_tblschemetype.Rows.Count > 0)
            {
                _SchemeType = DataTableExtensions.ToGenericList<HpSchemeType>(_tblschemetype, HpSchemeType.Converter)[0];
            }

            return _SchemeType;
        }

        //Written by darshana 29/08/2012
        public Int32 UpdateInsTxnByRegNo(string _regRef, string _itm, string _inv, string _chassis, string _engine)
        {

            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_reg_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regRef;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[4] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_reg_rec", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by darshana 29/08/2012
        public Int32 UpdateRegTxnByInsNo(string _insRef, string _itm, string _inv, string _chassis, string _engine)
        {

            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_ins_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insRef;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[4] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_ins_rec", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 29/08/2012
        public string GetInsuRefBySerial(string _inv, string _chassis, string _engine, string _itm)
        {

            OracleParameter[] param = new OracleParameter[5];
            string _RefNo = "";


            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[2] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbldetails", "sp_getinsurefbyserial", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _RefNo = (_dtResults.Rows[0]["svit_ref_no"] == DBNull.Value) ? "" : Convert.ToString(_dtResults.Rows[0]["svit_ref_no"]);
            }

            return _RefNo;
        }

        //darshana 29/08/2012
        public string GetRegRefBySerial(string _inv, string _chassis, string _engine, string _itm)
        {

            OracleParameter[] param = new OracleParameter[5];
            string _RefNo = "";


            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[2] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbldetails", "sp_getregrefbyserial", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _RefNo = (_dtResults.Rows[0]["svrt_ref_no"] == DBNull.Value) ? "" : Convert.ToString(_dtResults.Rows[0]["svrt_ref_no"]);
            }

            return _RefNo;
        }

        public List<HpSheduleDetails> GetHPAccountSchedule(string _account)
        {
            //sp_getaccountschedule(p_account in NVARCHAR2,c_data out sys_refcursor)

            List<HpSheduleDetails> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("_tblData", "sp_getaccountschedule", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSheduleDetails>(_tblData, HpSheduleDetails.Converter);
            }

            return _list;

        }

        public Int32 SaveHPScheduleLog(HpScheduleDetailLog _accSchLog)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_acc_no;
            (param[1] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_cre_by;
            (param[2] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_cre_dt;
            (param[3] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_dt;
            (param[4] = new OracleParameter("p_due_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_due_dt;
            (param[5] = new OracleParameter("p_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_ins;
            (param[6] = new OracleParameter("p_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_intr;
            (param[7] = new OracleParameter("p_rnt_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_rnt_no;
            (param[8] = new OracleParameter("p_rnt_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_rnt_val;
            (param[9] = new OracleParameter("p_sdt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_sdt;
            (param[10] = new OracleParameter("p_seq", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_seq;
            (param[11] = new OracleParameter("p_ser", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_ser;
            (param[12] = new OracleParameter("p_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accSchLog.Hsh_vat;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_saveaccountschedulehistory", CommandType.StoredProcedure, param);
            return effects;

        }

        //written by darshana on 21/08/2012
        public Int32 SaveAccCustomer(HpCustomer _HpAccountCus)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_htc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_seq;
            (param[1] = new OracleParameter("p_htc_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_acc_no;
            (param[2] = new OracleParameter("p_htc_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cust_cd;
            (param[3] = new OracleParameter("p_htc_cust_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cust_tp;
            (param[4] = new OracleParameter("p_htc_adr_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_tp;
            (param[5] = new OracleParameter("p_htc_adr_01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_01;
            (param[6] = new OracleParameter("p_htc_adr_02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_02;
            (param[7] = new OracleParameter("p_htc_adr_03", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_03;
            (param[8] = new OracleParameter("p_htc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cre_by;
            (param[9] = new OracleParameter("p_htc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cre_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_insertacccus", CommandType.StoredProcedure, param);
            return effects;

        }



        //written by Shanuka perera on 26/05/2014

        public Int32 SaveOutItemdetails(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;
            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListReversalItems)
            {
                OracleParameter[] param = new OracleParameter[8];

                (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ItemCode;
                (param[2] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                (param[3] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Flag;
                (param[4] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_Remark;
                (param[5] = new OracleParameter("P_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Itm_status;
                (param[6] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_id;

                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_HIRE_SALES_REV_PROCESS", CommandType.StoredProcedure, param);

            }

            if (objOutItems.ListOut_Rev_Items_Details != null)
            {
                int line = 1;
                foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
                {
                    if (_itemDetails.GRAD_ANAL2 != null)
                    {

                        //string _documentNo = "";
                        OracleParameter[] param = new OracleParameter[8];

                        (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                        (param[1] = new OracleParameter("p_GradLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
                        (param[2] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                        (param[3] = new OracleParameter("p_GRAD_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.GRAD_ANAL2;
                        (param[4] = new OracleParameter("p_GRAD_ANAL5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Drp_value;
                        (param[5] = new OracleParameter("p_GRAD_ANAL7", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.OutItmTax;
                        (param[6] = new OracleParameter("p_GRAD_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.GRAD_ANAL3;

                        param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                        line++;
                        effects = (Int16)UpdateRecords("SP_INSERT_OUTITEMS", CommandType.StoredProcedure, param);

                    }
                }

            }
            return effects;
        }


        //sachith 2012/08/31
        public DataTable GetExternalVehicalJob(string _company, string _loc)
        {
            //PROCEDURE sp_getemployee(p_com in NVARCHAR2,p_exe in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_extvehjobentry", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //sachith 2012/09/08
        public Int32 GetDOPbCount(string _com, string _pb, string _pb_level)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[2] = new OracleParameter("p_pb_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb_level;
            OracleParameter _outparam = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = ReturnSP_SingleValue("sp_dofilterstatus", CommandType.StoredProcedure, _outparam, param);
            return _effect;
        }

        #region Hp Acc Restriction
        //Shani 05/09/2012
        public Int32 SaveAccRestriction(AccountRestriction _accRest)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int64, null, ParameterDirection.Input)).Value = null;//auto generated by a DB Sequence
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accRest.Hrs_pc;
            (param[2] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accRest.Hrs_from_dt;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accRest.Hrs_to_dt;
            (param[4] = new OracleParameter("p_no_ac", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _accRest.Hrs_no_ac;
            (param[5] = new OracleParameter("p_tot_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accRest.Hrs_tot_val;
            (param[6] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accRest.Hrs_cre_by;
            (param[7] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accRest.Hrs_cre_dt;
            (param[8] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accRest.Hrs_tp;


            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_accountRestriction", CommandType.StoredProcedure, param);
            return effects;

        }
        public DataTable GetPC_from_Hierachy(string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {
            //p_com in NVARCHAR2,p_cha in NVARCHAR2,p_subcha in NVARCHAR2,p_area in NVARCHAR2,p_region in NVARCHAR2,p_zone in NVARCHAR2,p_code IN NVARCHAR2,c_data out SYS_REFCURSOR

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pc_onHierachy", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #endregion  Hp Acc Restriction

        public Int32 UpdateInvoiceforNewCustomer(string _company, string _profitcenter, Int64 _invoiceseqno, string _customercode)
        {
            Int32 _effect = 0;
            //sp_updatesalebynewcustomercode(p_com in NVARCHAR2,p_profitcenter in NVARCHAR2,p_invoiceseq in NUMBER,p_customercode in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_invoiceseq", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customercode;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_updatesalebynewcustomercode", CommandType.StoredProcedure, param);
            return _effect;


        }

        public Int32 DeleteInvoiceDetailForHold(Int32 _invoiceseqno)
        {
            //sp_deleteholdinvoicedetail(p_seqno in NUMBER,o_effect out NUMBER)
            Int32 _effect = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceseqno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_deleteholdinvoicedetail", CommandType.StoredProcedure, param);
            return _effect;


        }

        //written by darshana 11-09-2012
        public VehicalRegistration CheckPrvRegDetails(string _engine, string _item, string _com, Int32 _status)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_checkprvregdetails", CommandType.StoredProcedure, false, param);

            VehicalRegistration _VehReg = new VehicalRegistration();
            if (_dtResults.Rows.Count > 0)
            {
                _VehReg = DataTableExtensions.ToGenericList<VehicalRegistration>(_dtResults, VehicalRegistration.Converter)[0];
            }
            return _VehReg;
        }

        //written by darshana 11-09-2012
        public VehicleInsuarance CheckPrvInsDetails(string _engine, string _item, string _com, Int32 _status)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_checkprvinsdetails", CommandType.StoredProcedure, false, param);

            VehicleInsuarance _Vehins = new VehicleInsuarance();
            if (_dtResults.Rows.Count > 0)
            {
                _Vehins = DataTableExtensions.ToGenericList<VehicleInsuarance>(_dtResults, VehicleInsuarance.Converter)[0];
            }
            return _Vehins;
        }
        public bool CheckItemStatus(string _company, string _book, string _level, string _status)
        {
            //sp_checkpricelevelstatus(p_com in NVARCHAR2,p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            bool _isValid = false;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldetails", "sp_checkpricelevelstatus", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _isValid = true;
            else
                _isValid = false;
            return _isValid;

        }

        //written by darshana 13-08-2012
        public MasterVehicalInsuranceDefinition GetVehInsAmtDirect(string _com, string _pc, string _salesTP, string _insCom, string _insPol, string _itm, DateTime _date, Int32 _tearm)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_saleTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesTP;
            (param[3] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insCom;
            (param[4] = new OracleParameter("p_ins_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPol;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[6] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            (param[7] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tearm;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_insu_amt_direct", CommandType.StoredProcedure, false, param);

            MasterVehicalInsuranceDefinition _VehInsDef = new MasterVehicalInsuranceDefinition();
            if (_dtResults.Rows.Count > 0)
            {
                _VehInsDef = DataTableExtensions.ToGenericList<MasterVehicalInsuranceDefinition>(_dtResults, MasterVehicalInsuranceDefinition.Converter)[0];
            }
            return _VehInsDef;
        }

        //written by darshana 13-09-2012
        public VehicalRegistrationDefnition GetVehRegAmtDirect(string _com, string _pc, string _type, string _itm, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_reg_amt_direct", CommandType.StoredProcedure, false, param);

            VehicalRegistrationDefnition _VehDef = new VehicalRegistrationDefnition();
            if (_dtResults.Rows.Count > 0)
            {
                _VehDef = DataTableExtensions.ToGenericList<VehicalRegistrationDefnition>(_dtResults, VehicalRegistrationDefnition.Converter)[0];
            }
            return _VehDef;
        }

        //darshana 15/08/2012
        public List<RecieptHeader> GetReceiptBydaterange(string _com, string _pc, DateTime _from, DateTime _to, string _type)
        {
            List<RecieptHeader> _ReceiptList = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_getrecbydaterange", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal);
            }
            return _ReceiptList;
        }
        // Nadeeka  17-09-2015
        public List<RecieptHeader> GetReceiptBydaterangeExpired(string _com, string _pc, DateTime _from, DateTime _to, string _type, string _recno)
        {
            List<RecieptHeader> _ReceiptList = null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_getrecbydaterangeExpired", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal);
            }
            return _ReceiptList;
        }
        // Nadeeka  17-09-2015
        public List<RecieptHeader> GetReceiptBydaterangeItem(string _com, string _pc, DateTime _from, DateTime _to, string _type, string _recno)
        {
            List<RecieptHeader> _ReceiptList = null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_getrecbydaterangeItem", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal);
            }
            return _ReceiptList;
        }



        public Int32 Update_ReceiptItemExpriryDate(string _com, string _recNo, DateTime _Todate, DateTime _serDate, DateTime _refDate)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_RecNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Todate;
            (param[3] = new OracleParameter("p_set_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serDate;
            (param[4] = new OracleParameter("p_ref_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _refDate;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_ReceiptExpiryDate", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Update_ReceiptItemSerial(string _com, string _recNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_RecNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_ReceiptItemDetails", CommandType.StoredProcedure, param);
            return effects;

        }



        //written by darshana 18/09/2012
        public List<RecieptItem> GetAllReceiptItems(string _Rec)
        {
            List<RecieptItem> _receiptItem = new List<RecieptItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Rec;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getallrecitems", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _receiptItem = DataTableExtensions.ToGenericList<RecieptItem>(_tblInvoiceItem, RecieptItem.ConvertTotal);
            }

            return _receiptItem;
        }

        //written by darshana 20-07-2012
        public Int32 UpdateRefundDetails(decimal _amt, string _refNo, string _recNo, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[1] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[2] = new OracleParameter("p_recNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_updaterefunddet", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateRefundDetails4Inv(decimal _amt, string _refNo, string _recNo, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[1] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[2] = new OracleParameter("p_recNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_updaterefunddet4Inv", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateRefundbyAdj(decimal _amt, string _refNo, string _recNo, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[1] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[2] = new OracleParameter("p_recNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_upd_ref_adj", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<HpSchemeType> GetSchemeTypeByCategory(string _cat)
        {

            List<HpSchemeType> _SchemeType = new List<HpSchemeType>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemetype = QueryDataTable("tblschemetype", "sp_getscheme_type_by_cat", CommandType.StoredProcedure, false, param);
            if (_tblschemetype.Rows.Count > 0)
            {
                _SchemeType = DataTableExtensions.ToGenericList<HpSchemeType>(_tblschemetype, HpSchemeType.Converter);
            }

            return _SchemeType;
        }

        public DataTable GetSAllchemeCategoryies(string _code)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tblschemetype", "sp_getschmecat", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetSchemes(string _type, string _code)
        {

            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tblscheme", "sp_getschemes", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetPendingInvoiceItemsByItemDT(string _inv, string _itemcode)
        {


            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblInvoiceItem", "sp_getsalesitmbyitmcd", CommandType.StoredProcedure, false, param);

        }

        public PriceDetailRef GetPriceDetailByItemLineSeq(string _item, Int32 _itemline, Int32 _pbseq)
        {
            //sp_getpricedetailbyseqno   (p_item in NVARCHAR2,p_itemline in NUMBER, p_pbseq in NUMBER,c_data OUT sys_refcursor)

            PriceDetailRef _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemline;
            (param[2] = new OracleParameter("p_pbseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbseq;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getpricedetailbyseqno", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<PriceDetailRef>(_dtResults, PriceDetailRef.ConvertMain)[0];

            return _list;
        }

        //Shani 26-09-2012
        public Int32 Save_TEMP_PC_LOC(string username, string _com, string pc, string loc)
        {
            //p_tpl_user_name, p_tpl_pc, p_tpl_loc

            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_tpl_user_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = username;
            (param[1] = new OracleParameter("p_tpl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_tpl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[3] = new OracleParameter("p_tpl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_temp_pc_loc", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 SaveCashConv(string scheme, string parttype, string partycode, string pb, string pblvl, CashConversionDefinition _cashdef)
        {

            string[] schemeList = scheme.Split(',');
            string[] partytypeList = parttype.Split(',');
            string[] partycodeList = partycode.Split(',');
            string[] pbList = pb.Split(',');
            string[] pblistList = pblvl.Split(',');

            //OracleParameter[] param = new OracleParameter[25];
            //(param[0] = new OracleParameter("p_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            //(param[1] = new OracleParameter("p_schema", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scheme;
            //(param[2] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = parttype;
            //(param[3] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partycode;
            //(param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value =pb;
            //(param[5] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblvl;
            //(param[6] = new OracleParameter("p_hcc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value =1;
            //(param[7] = new OracleParameter("p_hcc_from_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_from_cre_dt;
            //(param[8] = new OracleParameter("p_hcc_to_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_cre_dt;
            //(param[9] = new OracleParameter("p_hcc_from_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cashdef.Hcc_from_pd;
            //(param[10] = new OracleParameter("p_hcc_to_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_pd;
            //(param[11] = new OracleParameter("p_hcc_chk_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_chk_on;
            //(param[12] = new OracleParameter("p_hcc_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_from_val;
            //(param[13] = new OracleParameter("P_hcc_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_val;
            //(param[14] = new OracleParameter("p_hcc_cal_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cal_on;
            //(param[15] = new OracleParameter("p_hcc_ser_chg_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_ser_chg_rt;
            //(param[16] = new OracleParameter("p_hcc_ser_chg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_ser_chg_val;
            //(param[17] = new OracleParameter("p_hcc_cc_upto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cc_upto;
            //(param[18] = new OracleParameter("p_hcc_add_cal_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_add_cal_on;
            //(param[19] = new OracleParameter("p_hcc_add_chg_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_add_chg_rt;
            //(param[20] = new OracleParameter("p_hcc_add_chg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_add_chg_val;
            //(param[21] = new OracleParameter("p_hcc_pb_conv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_pb_conv;
            //(param[22] = new OracleParameter("p_hcc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cre_by;
            //(param[23] = new OracleParameter("p_hcc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_cre_dt;
            //param[24] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);
            //int ii = (Int16)UpdateRecords("sp_savecashconversion", CommandType.StoredProcedure, param);
            //return ii;

            //COMMENT
            InventoryDAL _inv = new InventoryDAL();
            _inv.ConnectionOpen();
            //scheme list loop
            for (int i = 0; i < schemeList.Length; i++)
            {
                //party loop
                for (int j = 0; j < partytypeList.Length; j++)
                {
                    //pb loop
                    for (int k = 0; k < pbList.Length; k++)
                    {
                        OracleParameter[] param = new OracleParameter[25];
                        (param[0] = new OracleParameter("p_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
                        (param[1] = new OracleParameter("p_schema", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schemeList[i];
                        (param[2] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partycodeList[j];// partytypeList[j]; 
                        (param[3] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partytypeList[j];//partycodeList[j];
                        (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbList[k];
                        (param[5] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblistList[k];
                        (param[6] = new OracleParameter("p_hcc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.GetSerialID();
                        (param[7] = new OracleParameter("p_hcc_from_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_from_cre_dt;
                        (param[8] = new OracleParameter("p_hcc_to_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_cre_dt;
                        (param[9] = new OracleParameter("p_hcc_from_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cashdef.Hcc_from_pd;
                        (param[10] = new OracleParameter("p_hcc_to_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_pd;
                        (param[11] = new OracleParameter("p_hcc_chk_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_chk_on;
                        (param[12] = new OracleParameter("p_hcc_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_from_val;
                        (param[13] = new OracleParameter("P_hcc_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_to_val;
                        (param[14] = new OracleParameter("p_hcc_cal_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cal_on;
                        (param[15] = new OracleParameter("p_hcc_ser_chg_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_ser_chg_rt;
                        (param[16] = new OracleParameter("p_hcc_ser_chg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_ser_chg_val;
                        (param[17] = new OracleParameter("p_hcc_cc_upto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cc_upto;
                        (param[18] = new OracleParameter("p_hcc_add_cal_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_add_cal_on;
                        (param[19] = new OracleParameter("p_hcc_add_chg_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_add_chg_rt;
                        (param[20] = new OracleParameter("p_hcc_add_chg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cashdef.Hcc_add_chg_val;
                        (param[21] = new OracleParameter("p_hcc_pb_conv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_pb_conv;
                        (param[22] = new OracleParameter("p_hcc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cre_by;
                        (param[23] = new OracleParameter("p_hcc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cashdef.Hcc_cre_dt;//_cashdef.Hcc_to_cre_dt;
                        param[24] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);
                        int ii = (Int16)UpdateRecords("sp_cashconversion_temp", CommandType.StoredProcedure, param);

                    }
                }
            }
            return 1;
            //END

            //(param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scheme;
            //(param[1] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = parttype;
            //(param[2] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partycode;
            //(param[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pb;
            //(param[4] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblvl;
            //param[5] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);
            //return (Int16)UpdateRecords("sp_savecashconversion", CommandType.StoredProcedure, param);

        }

        public DataTable GetInvRep(string _inv)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblInvoiceItem", "sp_invrep", CommandType.StoredProcedure, false, param);
        }

        public Int32 Delete_TEMP_PC_LOC(string userid, string _com, string _pc, string loc)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_tpl_user_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("p_tpl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_tpl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[3] = new OracleParameter("p_tpl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_DELETE_temp_pc_loc", CommandType.StoredProcedure, param);
            return effects;
        }

        //written by darshana 04/10/2012
        public MasterReceiptDivision GetDefRecDivision(string _com, string _pc)
        {
            MasterReceiptDivision _RecDivision = new MasterReceiptDivision();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tblrecdiv", "sp_getdefdiv", CommandType.StoredProcedure, false, param);
            if (_tblReceiptDivision.Rows.Count > 0)
            {
                _RecDivision = DataTableExtensions.ToGenericList<MasterReceiptDivision>(_tblReceiptDivision, MasterReceiptDivision.Converter)[0];
            }

            return _RecDivision;
        }

        public DataTable GetChequeDetails(string profitcenter_, string cheqNo_, string bank_, string type_)
        {
            //Sanjeewa 22-02-2013
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profitcenter_;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cheqNo_;
            (param[2] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bank_;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_cheque_details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //written by Nadeeka 02/01/2013
        public DataTable GetRecDivision(string _com, string _pc)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_getdefdiv", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        //written by Nadeeka 02/01/2013
        public DataTable GetWarrantyCommenceDate(string _com, string _pc, string _invNo)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_InvNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _doDate = QueryDataTable("tbl", "sp_getRevInvDate", CommandType.StoredProcedure, false, param);


            return _doDate;
        }





        //written by Nadeeka 02/01/2013
        public DataTable GetDFCusPassport(string _inv)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_getDFCustomerPassport", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }


        //written by Nadeeka 30/09/2013
        public DataTable GetCollectionBonusDetailsRep(string _user, DateTime _asAtDate, Int16 _issum, string _loc)
        {

            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asAtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate;
            (param[2] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("in_sum", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _issum;
            (param[4] = new OracleParameter("in_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            DataTable _tblcoll = QueryDataTable("tbl", "sp_col_bonus_det", CommandType.StoredProcedure, false, param);


            return _tblcoll;
        }


        //written by Nadeeka 23/04/2013
        public DataTable GetManagerDefProfit(string _com, string _epf)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("in_epfno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_getManagerDefaultPt", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        //written by Nadeeka 24/01/2013
        public DataTable GetSalesTax(string _inv)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblRst = QueryDataTable("tbl", "getinvtaxdetAll", CommandType.StoredProcedure, false, param);


            return _tblRst;
        }

        public DataTable GetHP_Account_AccNo(string _acc)
        { //written by Nadeeka 02/01/2013


            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_getHp_Account_onAccNo", CommandType.StoredProcedure, false, param);



            return _dtResults;
        }
        //written by Nadeeka 02/01/2013
        public DataTable GetAccountTrans(string _acc)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_getacctransactiondetails", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        //written by Nadeeka 15/01/2013
        public DataTable GetHPRevertHeader(string _refNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblrvt = QueryDataTable("tbl", "sp_getRevertHeader", CommandType.StoredProcedure, false, param);


            return _tblrvt;
        }

        //written by Nadeeka 15/01/2013
        public DataTable GetHPSaleswithDO(string _acc)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblrvt = QueryDataTable("tbl", "sp_get_hp_account_details", CommandType.StoredProcedure, false, param);


            return _tblrvt;
        }
        //written by Nadeeka 15/01/2013
        public DataTable GetHPSaleswithDOItems(string _acc, string _item)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblrvt = QueryDataTable("tbl", "sp_get_hp_account_item", CommandType.StoredProcedure, false, param);


            return _tblrvt;
        }
        //written by Nadeeka 15/01/2013
        public DataTable GetSevJobHeader(string _job)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblResults = QueryDataTable("tbl", "sp_get_AC_JobHeader", CommandType.StoredProcedure, false, param);


            return _tblResults;
        }
        //written by Nadeeka 28/03/2013
        public DataTable ProcessClosedAccounts(string _user, DateTime _fromDate, DateTime _toDate, string _company, string _pc)
        {

            OracleParameter[] param = new OracleParameter[6];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("in_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            DataTable _tblResults = QueryDataTable("tbl", "sp_ProcessClosedAccountDetails", CommandType.StoredProcedure, false, param);


            return _tblResults;
        }

        //written by Nadeeka 15/01/2013
        public DataTable GetSevJobDet(string _job)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblResults = QueryDataTable("tbl", "sp_get_AC_JobDet", CommandType.StoredProcedure, false, param);


            return _tblResults;
        }
        //written by Nadeeka 15/01/2013
        public DataTable GetSevJobCost(string _job)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblResults = QueryDataTable("tbl", "sp_get_AC_JobCost", CommandType.StoredProcedure, false, param);


            return _tblResults;
        }

        //kapila 3/10/2012
        public List<InvoiceHeader> GetCommissionInvoices(string _com, string _pc, DateTime _date, string _type)
        {
            List<InvoiceHeader> _invList = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_get_comm_inv", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invList = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblInvoice, InvoiceHeader.ConvertTotal);
            }
            return _invList;
        }

        //kapila 3/10/2012
        public List<InvoiceItem> GetCommissionInvoicesItems(string _inv)
        {
            List<InvoiceItem> _invItemList = null;

            OracleParameter[] param1 = new OracleParameter[2];
            (param1[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param1[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblInvoiceDet", "sp_get_comm_inv_det", CommandType.StoredProcedure, false, param1);
            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _invItemList = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceDet, InvoiceItem.ConvertInvoiceItemForReversal);
            }
            return _invItemList;
        }

        //kapila 3/10/2012
        public List<RecieptItem> GetReceiptItemsByInvoice(string _inv)
        {
            List<RecieptItem> _invRecList = null;

            OracleParameter[] param1 = new OracleParameter[2];
            (param1[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param1[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_get_rec_itm_by_inv", CommandType.StoredProcedure, false, param1);
            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _invRecList = DataTableExtensions.ToGenericList<RecieptItem>(_tblInvoiceDet, RecieptItem.ConvertTotal);
            }
            return _invRecList;
        }

        public Int32 DeleteSalesCommission(Int32 _seqno)
        {
            Int32 _effect = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_del_sales_comm", CommandType.StoredProcedure, param);
            return _effect;


        }



        #region Accounts Detail Updates
        public DataTable GetHp_ActiveAccounts(string com, string pc, DateTime currentDate, DateTime fromDt, DateTime toDt, string accountNo, string status, Int32 given_esd)
        {   //p_com in NVARCHAR2, p_pc in NVARCHAR2,p_Currentdate In DATE,p_fromDt  In DATE, p_toDt In DATE, p_accountNo in NVARCHAR2,c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_Currentdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = currentDate;
            (param[3] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt.Date;
            (param[4] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt.Date;
            (param[5] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            (param[6] = new OracleParameter("p_given_esd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = given_esd;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblAcc", "sp_get_hp_ACC", CommandType.StoredProcedure, false, param);
        }
        public DataTable GetHp_flag_bank_onType(string type_)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type_;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblFlgBnk", "get_BNAK_FLAG_on_type", CommandType.StoredProcedure, false, param);
        }
        public Int32 Update_Flag_Bank(string type, string newCode, string accNo)
        {
            //p_type in NVARCHAR2,p_newCode in NVARCHAR2,p_accNo in NVARCHAR2, o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_newCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = newCode;
            (param[2] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_flag_bank", CommandType.StoredProcedure, param);
            return effects;
        }
        public HPAccountLog Get_latest_IN_hpt_acc_log(string accNo)
        {
            HPAccountLog lastLog = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "sp_get_Latest_HPAccountRecord", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                lastLog = DataTableExtensions.ToGenericList<HPAccountLog>(_dtResults, HPAccountLog.Converter)[0];
            }

            return lastLog;
        }

        public Int32 Update_Account_Transfer_Det(string accNo, Int32 latestSeq, DateTime ModDt, string newPC, Int32 IntCommZero, decimal CommAmt)
        {
            //p_accNo in NVARCHAR2,p_lastSeqNo in NUMBER,p_currDate in DATE,p_newPC in NVARCHAR2,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_lastSeqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = latestSeq;
            (param[2] = new OracleParameter("p_currDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = ModDt.Date;
            (param[3] = new OracleParameter("p_newPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = newPC;
            (param[4] = new OracleParameter("p_commzero", OracleDbType.Int32, null, ParameterDirection.Input)).Value = IntCommZero;
            (param[5] = new OracleParameter("p_commamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = CommAmt;
            //p_newPC
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_Transfer_HPAccount", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Update_Account_Ownership(string NewCustCode, string accNo, DateTime curDate)
        {
            //p_accNo in NVARCHAR2,p_newCustCode in NVARCHAR2,p_currDate in DATE,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_newCustCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NewCustCode;
            (param[2] = new OracleParameter("p_currDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = curDate.Date;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_Transfer_HPAccount_OWNER", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_AccCustomer(HpCustomer _HpAccountCus)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_htc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_seq;
            (param[1] = new OracleParameter("p_htc_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_acc_no;
            (param[2] = new OracleParameter("p_htc_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cust_cd;
            (param[3] = new OracleParameter("p_htc_cust_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cust_tp;
            (param[4] = new OracleParameter("p_htc_adr_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_tp;
            (param[5] = new OracleParameter("p_htc_adr_01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_01;
            (param[6] = new OracleParameter("p_htc_adr_02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_02;
            (param[7] = new OracleParameter("p_htc_adr_03", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_03;
            (param[8] = new OracleParameter("p_htc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cre_by;
            (param[9] = new OracleParameter("p_htc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cre_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_UPDATE_ADDRRESS", CommandType.StoredProcedure, param);
            return effects;

        }
        public HpCustomer Get_HpAccCustomer(string custTp, string custID, Int32 addrTp, string accountNo)
        {
            //(p_custTp in NVARCHAR2,p_custID in NVARCHAR2,p_addressTp in NUMBER,p_accNo in NVARCHAR2,c_data OUT sys_refcursor)
            HpCustomer customer = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_custTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custTp;
            (param[1] = new OracleParameter("p_custID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custID;
            (param[2] = new OracleParameter("p_addressTp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = addrTp;
            (param[3] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "SP_Get_AccCustomer", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                customer = DataTableExtensions.ToGenericList<HpCustomer>(_dtResults, HpCustomer.Converter)[0];
            }

            return customer;
        }
        public List<HpCustomer> Get_HpAccCustomerList(string custTp, string custID, Int32 addrTp, string accountNo)
        {
            //(p_custTp in NVARCHAR2,p_custID in NVARCHAR2,p_addressTp in NUMBER,p_accNo in NVARCHAR2,c_data OUT sys_refcursor)
            List<HpCustomer> customer = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_custTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custTp;
            (param[1] = new OracleParameter("p_custID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custID;
            (param[2] = new OracleParameter("p_addressTp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = addrTp;
            (param[3] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "SP_Get_AccCustomer", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                customer = DataTableExtensions.ToGenericList<HpCustomer>(_dtResults, HpCustomer.Converter);
            }

            return customer;
        }
        public Int32 Save_FlagBank(HPR_FlagBank _flagBank)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _flagBank.Hfb_cd;
            (param[1] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _flagBank.Hfb_tp;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _flagBank.Hpf_desc;
            (param[3] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _flagBank.Hpf_cre_by;
            (param[4] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _flagBank.Hpf_cre_dt;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_FlagBank", CommandType.StoredProcedure, param);
            return effects;

        }
        public Int32 Save_cust_transfer_log(HpCustomer _HpAccountCus)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            // (param[0] = new OracleParameter("p_htc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_seq; //this is generated automatically by SP
            (param[0] = new OracleParameter("p_htc_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_acc_no;
            (param[1] = new OracleParameter("p_htc_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cust_cd;
            //(param[3] = new OracleParameter("p_htc_cust_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cust_tp;
            (param[2] = new OracleParameter("p_htc_adr_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_tp;
            (param[3] = new OracleParameter("p_htc_adr_01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_01;
            (param[4] = new OracleParameter("p_htc_adr_02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_02;
            (param[5] = new OracleParameter("p_htc_adr_03", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_adr_03;
            (param[6] = new OracleParameter("p_htc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cre_by;
            (param[7] = new OracleParameter("p_htc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _HpAccountCus.Htc_cre_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_hpt_cust_trns_log", CommandType.StoredProcedure, param);
            return effects;

        }
        #endregion Accounts Detail Updates

        public List<InvoiceSerial> GetInvoiceSerial(string _invoiceno)
        {
            //sp_getinvoiceserial(p_invoice in NVARCHAR2,c_data out SYS_REFCURSOR)
            List<InvoiceSerial> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getinvoiceserial", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<InvoiceSerial>(_dtResults, InvoiceSerial.ConvertTotal);

            return _list;
        }


        #region loyalty definions

        public Int32 SaveLoyaltyType(LoyaltyType _loyal)
        {

            int _effect = 0;

            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("salt_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salt_loty_tp;
            (param[1] = new OracleParameter("salt_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salt_desc;
            (param[2] = new OracleParameter("salt_pt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salt_pt_tp;
            (param[3] = new OracleParameter("salt_prt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salt_prt;
            (param[4] = new OracleParameter("salt_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salt_frm_dt;
            (param[5] = new OracleParameter("salt_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salt_to_dt;
            (param[6] = new OracleParameter("salt_is_comp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salt_is_comp;
            (param[7] = new OracleParameter("salt_chk_onetp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salt_brand;
            (param[8] = new OracleParameter("salt_chk_oncd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salt_cat_1;
            (param[9] = new OracleParameter("salt_alw_multi_cdpnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salt_alw_multi_cdpnt;
            (param[10] = new OracleParameter("salt_memb_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Salt_memb_chg;
            (param[11] = new OracleParameter("salt_valid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salt_valid;
            (param[12] = new OracleParameter("salt_renew_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Salt_renew_chg;



            param[13] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_saveloyaltytypes", CommandType.StoredProcedure, param);

            return _effect;

        }

        public Int32 saveLoyaltyPointDefinition(LoyaltyPointDefinition _loyal)
        {
            int _effect = 0;

            OracleParameter[] param = new OracleParameter[32];

            (param[0] = new OracleParameter("p_saldf_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_loty_tp;
            (param[1] = new OracleParameter("p_saldf_alw_prt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_alw_prt_tp;
            (param[2] = new OracleParameter("p_saldf_alw_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_alw_tp;
            (param[3] = new OracleParameter("p_saldf_val_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Saldf_val_frm;
            (param[4] = new OracleParameter("p_saldf_val_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Saldf_val_to;
            (param[5] = new OracleParameter("p_saldf_value_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_value_frm;
            (param[6] = new OracleParameter("p_saldf_value_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_value_to;
            (param[7] = new OracleParameter("p_saldf_qt_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_qt_frm;
            (param[8] = new OracleParameter("p_saldf_qt_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_qt_to;
            (param[9] = new OracleParameter("p_saldf_is_multi", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_is_multi;
            (param[10] = new OracleParameter("p_saldf_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_brand;
            (param[11] = new OracleParameter("p_saldf_cat_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_cat_1;
            (param[12] = new OracleParameter("p_saldf_cat_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_cat_2;
            (param[13] = new OracleParameter("p_saldf_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_itm;
            (param[14] = new OracleParameter("p_saldf_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_promo;
            (param[15] = new OracleParameter("p_saldf_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_ser;
            (param[16] = new OracleParameter("p_saldf_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_pb;
            (param[17] = new OracleParameter("p_saldf_plvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_plvl;
            (param[18] = new OracleParameter("p_saldf_pmod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_pmod;
            (param[19] = new OracleParameter("p_saldf_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_bank;
            (param[20] = new OracleParameter("p_saldf_cd_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_cd_tp;
            (param[21] = new OracleParameter("p_saldf_pt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_pt;
            (param[22] = new OracleParameter("p_saldf_cus_spec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_cus_spec;
            (param[23] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_cre_by;
            (param[24] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Saldf_cre_dt;
            (param[25] = new OracleParameter("p_saldf_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_seq;
            (param[26] = new OracleParameter("p_saldf_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_line;
            (param[27] = new OracleParameter("p_saldf_alw_dis", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_alw_dis;
            (param[28] = new OracleParameter("p_saldf_alw_ptp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_alw_ptp;
            (param[29] = new OracleParameter("p_saldf_alw_ins", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldf_alw_ins;
            (param[30] = new OracleParameter("p_saldf_minv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldf_minv_tp;

            param[31] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_saveloyaltypointdefinition", CommandType.StoredProcedure, param);

            return _effect;
        }

        public Int32 saveLoyaltyRedeemDefinition(LoyaltyPointRedeemDefinition _loyal)
        {
            int _effect = 0;

            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_salre_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_loty_tp;
            (param[1] = new OracleParameter("p_salre_alw_prt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_alw_prt_tp;
            (param[2] = new OracleParameter("p_salre_alw_prt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_alw_prt;
            (param[3] = new OracleParameter("p_salre_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salre_frm_dt;
            (param[4] = new OracleParameter("p_salre_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salre_to_dt;
            (param[5] = new OracleParameter("p_salre_red_pt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salre_red_pt;
            (param[6] = new OracleParameter("p_salre_pt_value", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salre_pt_value;
            (param[7] = new OracleParameter("p_salre_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_brand;
            (param[8] = new OracleParameter("p_salre_cat_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_cat_1;
            (param[9] = new OracleParameter("p_salre_cat_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_cat_2;
            (param[10] = new OracleParameter("p_salre_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_itm;
            (param[11] = new OracleParameter("p_salre_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_promo;
            (param[12] = new OracleParameter("p_salre_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_ser;
            (param[13] = new OracleParameter("p_salre_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_pb;
            (param[14] = new OracleParameter("p_salre_plvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_plvl;
            (param[15] = new OracleParameter("p_salre_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salre_cre_by;
            (param[16] = new OracleParameter("p_salre_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salre_cre_dt;

            param[17] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_saveloyaltyredeemdefinition", CommandType.StoredProcedure, param);

            return _effect;
        }

        public Int32 saveLoyaltyDiscountDefinition(LoyaltyPointDiscount _loyal)
        {
            int _effect = 0;

            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_saldi_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_loty_tp;
            (param[1] = new OracleParameter("p_saldi_prt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_prt_tp;
            (param[2] = new OracleParameter("p_saldi_prt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_prt;
            (param[3] = new OracleParameter("p_saldi_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Saldi_frm;
            (param[4] = new OracleParameter("p_saldi_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Saldi_to;
            (param[5] = new OracleParameter("p_saldi_pt_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldi_pt_frm;
            (param[6] = new OracleParameter("p_saldi_pt_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldi_pt_to;
            (param[7] = new OracleParameter("p_saldi_dis_rt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Saldi_dis_rt;
            (param[8] = new OracleParameter("p_saldi_cat_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_cat_1;
            (param[9] = new OracleParameter("p_saldi_cat_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_cat_2;
            (param[10] = new OracleParameter("p_saldi_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_itm;
            (param[11] = new OracleParameter("p_saldi_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_promo;
            (param[12] = new OracleParameter("p_saldi_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_ser;
            (param[13] = new OracleParameter("p_saldi_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_pb;
            (param[14] = new OracleParameter("p_saldi_plvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_plvl;
            (param[15] = new OracleParameter("p_saldi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_cre_by;
            (param[16] = new OracleParameter("p_saldi_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Saldi_cre_dt;
            (param[17] = new OracleParameter("p_saldi_circ_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_circ_no;
            (param[18] = new OracleParameter("p_saldi_cat_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_cat_3;
            (param[19] = new OracleParameter("p_saldi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Saldi_brand;
            param[20] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_saveloyaltydiscountdefiniti", CommandType.StoredProcedure, param);

            return _effect;
        }

        public Int32 SaveLoyaltyCustomerSpecification(LoyaltyCustomerSpecification _loyal)
        {
            int _effect = 0;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_salcs_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcs_seq_no;
            (param[1] = new OracleParameter("p_salcs_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcs_loty_tp;
            (param[2] = new OracleParameter("p_salcs_po_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcs_po_from;
            (param[3] = new OracleParameter("p_salcs_po_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcs_po_to;
            (param[4] = new OracleParameter("p_salcs_spec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcs_spec;
            (param[5] = new OracleParameter("p_salcs_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcs_cre_by;
            (param[6] = new OracleParameter("p_salcs_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salcs_cre_dt;
            param[7] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_save_loylty_cust_spec", CommandType.StoredProcedure, param);

            return _effect;
        }

        #endregion

        #region Commission Definition
        public DataTable GetBrandsCatsItems(string selectOn, string brand, string cate1, string cate2, string cate3, string itemCode, string serialNo, string circularNo, string promotionCd)
        {
            //p_selection in NVARCHAR2,p_brand in NVARCHAR2,p_cat1 in NVARCHAR2,p_cat2 in NVARCHAR2,p_itmCd in NVARCHAR2,c_data OUT sys_refcursor 
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_selection", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectOn;
            (param[1] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[2] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
            (param[3] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;
            (param[4] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;

            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialNo;
            (param[6] = new OracleParameter("p_circularNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
            (param[7] = new OracleParameter("p_promCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = promotionCd;
            (param[8] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate3;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblGet", "getBrandsCatsItems", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetBrandsCatsItems_new(string selectOn, string brand, string cate1, string cate2, string cate3, string itemCode, string serialNo, string circularNo, string promotionCd, string model)
        {
            //p_selection in NVARCHAR2,p_brand in NVARCHAR2,p_cat1 in NVARCHAR2,p_cat2 in NVARCHAR2,p_itmCd in NVARCHAR2,c_data OUT sys_refcursor 
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_selection", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectOn;
            (param[1] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[2] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate1;
            (param[3] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate2;
            (param[4] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;

            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialNo;
            (param[6] = new OracleParameter("p_circularNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
            (param[7] = new OracleParameter("p_promCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = promotionCd;
            (param[8] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate3;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblGet", "getBrandsCatsItems_new", CommandType.StoredProcedure, false, param);
        }

        public Int32 save_temp_pbook_level(List<PriceBookLevelRef> PBook_List, string username, string circularNo)
        {
            Int32 effects = 0;
            foreach (PriceBookLevelRef pbl in PBook_List)
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_pbl_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = username;
                (param[1] = new OracleParameter("p_pbl_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbl.Sapl_pb;
                (param[2] = new OracleParameter("p_pbl_pb_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbl.Sapl_pb_lvl_cd;
                (param[3] = new OracleParameter("p_pbl_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int32)UpdateRecords("sp_save_temp_pbook_level", CommandType.StoredProcedure, param);

                //return effects;
            }
            return effects;
        }
        public Int32 save_temp_brand_cat_item(List<CashCommissionDetailRef> BrandCatItmList, string selectType, string username, string circularNo)
        {
            Int32 effects = 0;
            foreach (CashCommissionDetailRef itm in BrandCatItmList)
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_glbi_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = username;
                (param[1] = new OracleParameter("p_glbi_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectType;
                (param[2] = new OracleParameter("p_glbi_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.Sccd_itm;
                (param[3] = new OracleParameter("p_glbi_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
                (param[4] = new OracleParameter("p_glbi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.Sccd_brd;
                (param[5] = new OracleParameter("p_glbi_app", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "COMMIS";
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int32)UpdateRecords("sp_save_temp_brand_cat_item", CommandType.StoredProcedure, param);
                //  return effects;
            }
            return effects;
        }

        public Int32 save_glb_temp_pc(List<string> PC_List, string username, string circularNo, string app)
        {
            Int32 effects = 0;
            foreach (string itm in PC_List)
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_gpc_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = username;
                (param[1] = new OracleParameter("p_gpc_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
                (param[2] = new OracleParameter("p_gpc_app", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = app;
                (param[3] = new OracleParameter("p_gpc_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = effects + (Int32)UpdateRecords("sp_save_glb_temp_pc", CommandType.StoredProcedure, param);
                //return effects;
            }
            return effects;
        }

        public Int32 save_glb_excecutives(List<CashCommissionDetailRef> ExcecutiveList, string username, string circularNo)
        {
            Int32 effects = 0;
            foreach (CashCommissionDetailRef Exec in ExcecutiveList)
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_glb_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = username;
                (param[1] = new OracleParameter("p_glb_exec_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Exec.Sccd_exec_tp;
                (param[2] = new OracleParameter("p_glb_exec_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Exec.Sccd_exec_cd;
                (param[3] = new OracleParameter("p_glb_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int32)UpdateRecords("sp_save_glb_excecutives", CommandType.StoredProcedure, param);
                // return effects;
            }
            return effects;
        }
        public Int32 saveTempTablesForCommision(List<string> Selected_PC_List, List<PriceBookLevelRef> PBook_List, List<CashCommissionDetailRef> ExcecutiveList, List<CashCommissionDetailRef> BrandCatItmList, string selectType, string username, string circularNo, Dictionary<string, Decimal> commissionValues, DateTime fromDt, DateTime toDt, string pcType,
           string _cusType, decimal _from, decimal _to, int _isComb, int _isEpf, decimal _amt)
        {
            Int32 eff1 = 0, eff2 = 0, eff3 = 0, eff4 = 0, eff5 = 0;
            eff1 = save_temp_pbook_level(PBook_List, username, circularNo);
            eff2 = save_glb_temp_pc(Selected_PC_List, username, circularNo, pcType);
            eff3 = save_glb_excecutives(ExcecutiveList, username, circularNo);
            eff4 = save_temp_brand_cat_item(BrandCatItmList, selectType, username, circularNo);
            //TODO: save the commission header.
            ////////////////////////////////////////////////////
            OracleParameter[] param = new OracleParameter[56];
            (param[0] = new OracleParameter("cashRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["cashRt"];
            (param[1] = new OracleParameter("cashAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["cashAmt"];
            (param[2] = new OracleParameter("credCardRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["credCardRt"];
            (param[3] = new OracleParameter("credCardAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["credCardAmt"];
            (param[4] = new OracleParameter("credCardProRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["credCardProRt"];
            (param[5] = new OracleParameter("credCardProAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["credCardProAmt"];
            (param[6] = new OracleParameter("chequeRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["chequeRt"];
            (param[7] = new OracleParameter("chequeAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["chequeAmt"];
            (param[8] = new OracleParameter("gvRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["gvRt"];
            (param[9] = new OracleParameter("gvAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["gvAmt"];
            (param[10] = new OracleParameter("dbcRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["dbcRt"];
            (param[11] = new OracleParameter("dbcAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["dbcAmt"];
            (param[12] = new OracleParameter("otherRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["otherRt"];
            (param[13] = new OracleParameter("otherAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["otherAmt"];
            (param[14] = new OracleParameter("amountRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["amountRt"];
            (param[15] = new OracleParameter("amountAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["amountAmt"];
            (param[16] = new OracleParameter("EXcashRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXcashRt"];
            (param[17] = new OracleParameter("EXcashAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXcashAmt"];
            (param[18] = new OracleParameter("EXcredCardRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXcredCardRt"];
            (param[19] = new OracleParameter("EXcredCardAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXcredCardAmt"];
            (param[20] = new OracleParameter("EXcredCardProRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXcredCardProRt"];
            (param[21] = new OracleParameter("EXcredCardProAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXcredCardProAmt"];
            (param[22] = new OracleParameter("EXchequeRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXchequeRt"];
            (param[23] = new OracleParameter("EXchequeAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXchequeAmt"];

            (param[24] = new OracleParameter("EXgvRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXgvRt"];
            (param[25] = new OracleParameter("EXgvAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXgvAmt"];
            (param[26] = new OracleParameter("EXdbcRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXdbcRt"];
            (param[27] = new OracleParameter("EXdbcAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXdbcAmt"];
            (param[28] = new OracleParameter("EXotherRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXotherRt"];
            (param[29] = new OracleParameter("EXotherAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXotherAmt"];
            (param[30] = new OracleParameter("EXamountRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXamountRt"];
            (param[31] = new OracleParameter("EXamountAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["EXamountAmt"];


            (param[32] = new OracleParameter("AdcashRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AdcashRt"];
            (param[33] = new OracleParameter("AdcashChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AdcashChk"];
            (param[34] = new OracleParameter("AdcredCardRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AdcredCardRt"];
            (param[35] = new OracleParameter("AdcredCardChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AdcredCardChk"];
            (param[36] = new OracleParameter("AdcredCardProRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AdcredCardProRt"];
            (param[37] = new OracleParameter("AdcredCardProChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AdcredCardProChk"];
            (param[38] = new OracleParameter("AdchequeRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AdchequeRt"];
            (param[39] = new OracleParameter("AdchequeChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AdchequeChk"];

            (param[40] = new OracleParameter("AdgvRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AdgvRt"];
            (param[41] = new OracleParameter("AdgvChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AdgvChk"];
            (param[42] = new OracleParameter("AddbcRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AddbcRt"];
            (param[43] = new OracleParameter("AddbcChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AddbcChk"];
            (param[44] = new OracleParameter("AdotherRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commissionValues["AdotherRt"];
            (param[45] = new OracleParameter("AdotherChk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commissionValues["AdotherChk"];
            (param[46] = new OracleParameter("AdCusType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusType;
            (param[47] = new OracleParameter("AdFromQty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _from;
            (param[48] = new OracleParameter("AdToQty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _to;
            (param[49] = new OracleParameter("AdAlwCom", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isComb;

            (param[50] = new OracleParameter("AdAllowEpf", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isEpf;
            (param[51] = new OracleParameter("AdcommAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;


            //p_circularNo in NVARCHAR2,p_fromDt in DATE,p_toDt in DATE,
            (param[52] = new OracleParameter("p_circularNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;
            (param[53] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[54] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;

            param[55] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            eff5 = (Int32)UpdateRecords("sp_save_COMMISSION_DEFINITION", CommandType.StoredProcedure, param);

            //////////////////////////////////////////////////
            return 1;

        }

        public Int32 save_cash_comm_hdr(CashCommissionHeaderRef commHeader)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_scch_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commHeader.Scch_seq;
            (param[1] = new OracleParameter("p_scch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commHeader.Scch_cd;
            (param[2] = new OracleParameter("p_scch_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commHeader.Scch_sale_tp;
            (param[3] = new OracleParameter("p_scch_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commHeader.Scch_circular;
            (param[4] = new OracleParameter("p_scch_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commHeader.Scch_desc;
            (param[5] = new OracleParameter("p_scch_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commHeader.Scch_cre_by;
            (param[6] = new OracleParameter("p_scch_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = commHeader.Scch_cre_dt;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_SAVE_sar_cash_comm_hdr", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<CashCommissionHeaderRef> Get_CommissionHeader(string commissionCode, string circularNo)
        {
            List<CashCommissionHeaderRef> headers = new List<CashCommissionHeaderRef>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_commCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commissionCode;
            (param[1] = new OracleParameter("p_circularNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularNo;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt_headers = QueryDataTable("tblGet", "get_commissionHeader", CommandType.StoredProcedure, false, param);

            if (dt_headers.Rows.Count > 0)
            {
                headers = DataTableExtensions.ToGenericList<CashCommissionHeaderRef>(dt_headers, CashCommissionHeaderRef.Converter);
            }
            return headers;
        }

        public Int32 Save_CloneCommissions(string pc, List<string> cloningPC_list, string user)
        {

            Int32 effects = 0;
            Int32 effects2 = 0;
            //TODO: save the clone pc list.
            effects2 = save_glb_temp_pc(cloningPC_list, user, null, "CLONE");
            foreach (string clonePc in cloningPC_list)
            {
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
                (param[1] = new OracleParameter("p_profCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;

                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int32)UpdateRecords("sp_clone_commissions", CommandType.StoredProcedure, param);
                // return effects;
            }
            return 1;
        }

        #endregion Commission Definition

        //kapila
        public Int32 Save_Temp_PC(string _com, string _pc, string _loc, string _user)
        {
            //p_tpl_user_name, p_tpl_pc, p_tpl_loc

            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_rpt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_rpt_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_rpt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_rpt_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_temp_pc", CommandType.StoredProcedure, param);
            return effects;

        }
        //kapila
        public Int32 Delete_Temp_PC(string userid)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_rpt_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_del_temp_pc", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveLoyaltyMembership(LoyaltyMemeber _loyal)
        {

            int _effect = 0;

            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_salcm_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_loty_tp;
            (param[1] = new OracleParameter("p_salcm_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_no;
            (param[2] = new OracleParameter("p_salcm_cd_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_cd_ser;
            (param[3] = new OracleParameter("p_salcm_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_cus_cd;
            (param[4] = new OracleParameter("p_salcm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_cre_by;
            (param[5] = new OracleParameter("p_salcm_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salcm_cre_dt;
            (param[6] = new OracleParameter("p_salcm_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_app_by;
            (param[7] = new OracleParameter("p_salcm_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salcm_app_dt;
            (param[8] = new OracleParameter("p_salcm_val_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salcm_val_frm;
            (param[9] = new OracleParameter("p_salcm_val_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salcm_val_to;
            (param[10] = new OracleParameter("p_salcm_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_contact;
            (param[11] = new OracleParameter("p_salcm_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_email;
            (param[12] = new OracleParameter("p_salcm_col_pt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcm_col_pt;
            (param[13] = new OracleParameter("p_salcm_red_pt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcm_red_pt;
            (param[14] = new OracleParameter("p_salcm_exp_pt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcm_exp_pt;
            (param[15] = new OracleParameter("p_salcm_bal_pt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcm_bal_pt;
            (param[16] = new OracleParameter("p_salcm_dis_rt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcm_dis_rt;
            (param[17] = new OracleParameter("p_salcm_cus_spec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Salcm_cus_spec;
            (param[18] = new OracleParameter("p_salcm_lst_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Salcm_lst_exp_dt;//Added By Udesh 30-Oct-2018
            (param[19] = new OracleParameter("p_salcm_issue_phy_cd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Salcm_issue_phy_cd;//Added By Udesh 30-Oct-2018
            param[20] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_saveloyaltymembership", CommandType.StoredProcedure, param);

            return _effect;

        }

        public List<LoyaltyMemeber> GetCustomerLoyaltyies(string _cusCode, string _cardno, DateTime _date, string _loyaltp)
        {

            List<LoyaltyMemeber> _loyal = new List<LoyaltyMemeber>();
            OracleParameter[] param1 = new OracleParameter[5];
            (param1[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusCode;
            (param1[1] = new OracleParameter("p_cardno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            (param1[2] = new OracleParameter("p_loyal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltp;
            (param1[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param1[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "SP_getcustomerloyality", CommandType.StoredProcedure, false, param1);

            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _loyal = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_tblInvoiceDet, LoyaltyMemeber.Converter);
            }
            return _loyal;

        }

        public List<LoyaltyMemeber> GetDiscount(string _cusCode, string _loyaltytype, string _item, DateTime _date, string _loc, string _pb, string _pblvl)
        {
            List<LoyaltyMemeber> _loyal = new List<LoyaltyMemeber>();
            OracleParameter[] param1 = new OracleParameter[8];
            (param1[0] = new OracleParameter("p_cus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusCode;
            (param1[1] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltytype;
            (param1[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param1[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param1[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param1[5] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param1[6] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            param1[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_getloyalty_discount", CommandType.StoredProcedure, false, param1);

            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _loyal = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_tblInvoiceDet, LoyaltyMemeber.Converter);
            }
            return _loyal;
        }

        public List<LoyaltyPointDefinition> GetCardPoints(string _item, string _loyaltytype, DateTime _date, string _loc, string _pb, string _pblvl, string _cusspe, string _salesTp, string _bank, string _cdTp)
        {
            List<LoyaltyPointDefinition> _loyal = new List<LoyaltyPointDefinition>();
            _salesTp = (string.IsNullOrEmpty(_salesTp)) ? (_salesTp.ToUpper() + "%") : "%";
            _bank = (string.IsNullOrEmpty(_bank)) ? (_bank.ToUpper() + "%") : "%";
            _cdTp = (string.IsNullOrEmpty(_cdTp)) ? (_cdTp.ToUpper() + "%") : "%";
            OracleParameter[] param1 = new OracleParameter[8];
            (param1[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param1[1] = new OracleParameter("p_loyl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltytype;
            (param1[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param1[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param1[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param1[5] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            (param1[6] = new OracleParameter("p_cus_spec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusspe;
            (param1[6] = new OracleParameter("p_sales_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesTp;
            (param1[6] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param1[6] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cdTp;
            param1[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_calcloyaltypoints", CommandType.StoredProcedure, false, param1);

            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _loyal = DataTableExtensions.ToGenericList<LoyaltyPointDefinition>(_tblInvoiceDet, LoyaltyPointDefinition.Converter);
            }
            return _loyal;
        }

        public Int32 UpdateLoyaltyMember(decimal _disrt, decimal _balpoints, DateTime _validtill, string _cuscode, string _loyaltytype, string _cusSpec, string _serial, decimal _redPt)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_discount_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _disrt;
            (param[1] = new OracleParameter("p_bal_pts", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _balpoints;
            (param[2] = new OracleParameter("p_cus_spe", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusSpec;
            (param[3] = new OracleParameter("p_valid_till", OracleDbType.Date, null, ParameterDirection.Input)).Value = _validtill;
            (param[4] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cuscode;
            (param[5] = new OracleParameter("p_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltytype;//send card number
            (param[7] = new OracleParameter("p_red_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _redPt;
            (param[6] = new OracleParameter("p_card_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[8] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int16)UpdateRecords("sp_updateloyaltymember", CommandType.StoredProcedure, param);

            return _effect;
        }

        public LoyaltyCustomerSpecification GetLoyaltyMemberSpecification(string _cuscode, string _loyaltp)
        {

            LoyaltyCustomerSpecification _cusSpec = new LoyaltyCustomerSpecification();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cuscode;
            (param[1] = new OracleParameter("p_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tblrecdiv", "sp_getlotycusspec", CommandType.StoredProcedure, false, param);
            if (_tblReceiptDivision.Rows.Count > 0)
            {
                _cusSpec = DataTableExtensions.ToGenericList<LoyaltyCustomerSpecification>(_tblReceiptDivision, LoyaltyCustomerSpecification.Converter)[0];
            }
            return _cusSpec;
        }

        public List<LoyaltyPointDiscount> GetDiscountRate(string _loyaltytype, string _item, DateTime _date, string _loc, string _pb, string _pblvl)
        {
            List<LoyaltyPointDiscount> _loyal = new List<LoyaltyPointDiscount>();
            OracleParameter[] param1 = new OracleParameter[7];
            (param1[0] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltytype;
            (param1[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param1[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param1[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param1[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param1[5] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            param1[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_get_discount_rtae", CommandType.StoredProcedure, false, param1);

            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _loyal = DataTableExtensions.ToGenericList<LoyaltyPointDiscount>(_tblInvoiceDet, LoyaltyPointDiscount.Converter);
            }
            return _loyal;

        }

        public LoyaltyPointRedeemDefinition GetRedeemPoints(string _loyaltytype, string _item, DateTime _date, string _loc, string _pb, string _pblvl)
        {
            LoyaltyPointRedeemDefinition _loyal = new LoyaltyPointRedeemDefinition();
            OracleParameter[] param1 = new OracleParameter[7];

            (param1[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param1[1] = new OracleParameter("p_loyl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltytype;
            (param1[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param1[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param1[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param1[5] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            param1[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_loyalty_redeem", CommandType.StoredProcedure, false, param1);

            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _loyal = DataTableExtensions.ToGenericList<LoyaltyPointRedeemDefinition>(_tblInvoiceDet, LoyaltyPointRedeemDefinition.Converter)[0];
            }
            return _loyal;
        }

        public Int32 SaveLoyaltyMemberLog(LoyaltyMemberLog _loyal)
        {
            int _effect = 0;

            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_sacml_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyal.Sacml_seq_no;
            (param[1] = new OracleParameter("p_sacml_loty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Sacml_loty_tp;
            (param[2] = new OracleParameter("p_sacml_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Sacml_no;
            (param[3] = new OracleParameter("p_sacml_cd_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Sacml_cd_ser;
            (param[4] = new OracleParameter("p_sacml_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Sacml_cus_cd;
            (param[5] = new OracleParameter("p_sacml_col_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Sacml_col_pt;
            (param[6] = new OracleParameter("p_sacml_red_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Sacml_red_pt;
            (param[7] = new OracleParameter("p_sacml_exp_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Sacml_exp_pt;
            (param[8] = new OracleParameter("p_sacml_bal_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Sacml_bal_pt;
            (param[9] = new OracleParameter("p_sacml_dis_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyal.Sacml_dis_rt;
            (param[10] = new OracleParameter("p_sacml_cus_spec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Sacml_cus_spec;
            (param[11] = new OracleParameter("p_sacml_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyal.Sacml_cre_by;
            (param[12] = new OracleParameter("p_sacml_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loyal.Sacml_cre_dt;
            param[13] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("save_loty_member_log", CommandType.StoredProcedure, param);

            return _effect;

        }

        public LoyaltyType GetLoyalty(string _item, DateTime _date, string _loc, string _pb, string _pbLvl)
        {
            LoyaltyType _loyal = new LoyaltyType();
            OracleParameter[] param1 = new OracleParameter[6];
            (param1[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param1[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param1[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param1[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param1[4] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbLvl;
            param1[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_loyalty_compulsory", CommandType.StoredProcedure, false, param1);

            if (_tblInvoiceDet.Rows.Count > 0)
            {
                _loyal = DataTableExtensions.ToGenericList<LoyaltyType>(_tblInvoiceDet, LoyaltyType.Converter)[0];
            }
            return _loyal;

        }

        public DataTable GetLoyaltyCustomerSpecifications(string _loyalType)
        {
            List<LoyaltyCustomerSpecification> _loyal = new List<LoyaltyCustomerSpecification>();
            OracleParameter[] param1 = new OracleParameter[2];
            (param1[0] = new OracleParameter("p_loyalty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyalType;
            param1[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_get_loyalty_specification", CommandType.StoredProcedure, false, param1);


            return _tblInvoiceDet;
        }

        public DataTable GetBankCC(string _bank)
        {

            OracleParameter[] param1 = new OracleParameter[2];
            (param1[0] = new OracleParameter("p_bank_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            param1[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_get_bank_cctp", CommandType.StoredProcedure, false, param1);
            return _tblInvoiceDet;
        }

        public DataTable GetLoyaltySpecifications()
        {
            OracleParameter[] param1 = new OracleParameter[1];

            param1[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblRecItm", "sp_get_loyalty_specs", CommandType.StoredProcedure, false, param1);
            return _tblInvoiceDet;
        }


        public Int32 SaveLoyaltySpecifications(Int32 _seqNo, string _spec, string _creBy, DateTime _creDt)
        {
            int _effect = 0;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_sarls_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("p_sarls_spec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _spec;
            (param[2] = new OracleParameter("p_sarls_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creBy;
            (param[3] = new OracleParameter("p_sarls_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _creDt;
            param[4] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_save_loty_spec", CommandType.StoredProcedure, param);

            return _effect;

        }


        //Darshana 16-10-2012
        public Boolean IsCheckLeaseCom(string _inv, string _com, string _pc, string _cate)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (_para[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[3] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean IsCheckLeaseCom = QueryDataTable("tbl", "sp_check_lease_com", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return IsCheckLeaseCom;
        }
        public Boolean IsCheckLeaseCompany(string _inv, string _com, string _pc, string _cate)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_qno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (_para[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[3] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean IsCheckLeaseCom = QueryDataTable("tbl", "sp_check_lease_company", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return IsCheckLeaseCom;
        }

        public List<string> DeliveryOrderNoByInvoice(string _invoice)
        {
            List<string> _str = null;
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tbl", "sp_getdobyinvoice", CommandType.StoredProcedure, false, _para);
            if (_tbl.Rows.Count > 0)
            {
                _str = new List<string>();
                foreach (DataRow _r in _tbl.Rows)
                    _str.Add(Convert.ToString(_r["ith_doc_no"]));
            }
            return _str;
        }

        //darshana 15/07/2012
        public List<HPGurantorParam> getGurParam(string _sch, string _type, string _value, DateTime _date)
        {
            List<HPGurantorParam> _list = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_gur_param", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HPGurantorParam>(_tblData, HPGurantorParam.Converter);
            }
            return _list;
        }

        #region Commission Change
        //Shani 18-10-2012
        public DataTable Get_invoiceItemsForCommis(string inv_no, string item_code)
        {
            //(p_invNo in NVARCHAR2,p_itmCode in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param1 = new OracleParameter[3];
            (param1[0] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv_no;
            (param1[1] = new OracleParameter("p_itmCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item_code;
            param1[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblItm", "sp_getInvoiceItem_CommisDet", CommandType.StoredProcedure, false, param1);
            return _tblInvoiceDet;
        }
        public DataTable Get_Paymodes_ofItemsForCommis(string inv_no, string item_code)
        {
            //(p_invNo in NVARCHAR2,p_itmCode in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param1 = new OracleParameter[3];
            (param1[0] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv_no;
            (param1[1] = new OracleParameter("p_itmCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item_code;
            param1[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceDet = QueryDataTable("tblItmPayMod", "sp_getInvoiceitems_forCommis", CommandType.StoredProcedure, false, param1);
            return _tblInvoiceDet;
        }

        public Int32 UpdateCommissionLine(string invoiceNo, string itemCode, Int32 itmLine, Decimal commLine, Decimal finCommRt, Decimal finCommAmt)
        {
            //(p_invoiceNo IN NVARCHAR2,p_itmCd IN NVARCHAR2,p_commLine in NUMBER,p_finCommRt in NUMBER,p_finCommAmt in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[2] = new OracleParameter("commLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commLine;
            (param[3] = new OracleParameter("p_finCommRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = finCommRt;
            (param[4] = new OracleParameter("p_finCommAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = finCommAmt;
            //p_itmLine
            (param[5] = new OracleParameter("p_itmLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmLine;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_Commissions", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<InvoiceHeader> GetCommissionInvoices_ON_circular(string circularName, string p_circularCode, string pcOfInvoice)
        {
            List<InvoiceHeader> _invList = null;
            //(p_circularName in NVARCHAR2,p_circularCode in NVARCHAR2,p_pcOfInvoice in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_circularName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularName;
            (param[1] = new OracleParameter("p_circularCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_circularCode;
            (param[2] = new OracleParameter("p_pcOfInvoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pcOfInvoice;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_getInvoices_onCircular", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invList = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblInvoice, InvoiceHeader.ConvertTotal);
            }
            return _invList;
        }
        public List<CashCommissionDetailRef> GetCashCommissionDetail_basedCircular(string _invoicetype, DateTime _date, string _pricebook, string _pricelevel, string circularCode)
        {
            //sp_getcashcommissiondetail(p_invoicetype in NVARCHAR2,p_date in date,p_pricebook in NVARCHAR2,p_pricelevel in NVARCHAR2,c_data out sys_refcursor)
            List<CashCommissionDetailRef> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_invoicetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicetype;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_pricebook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricebook;
            (param[3] = new OracleParameter("_pricelevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricelevel;
            (param[4] = new OracleParameter("p_circularNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularCode;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbData", "sp_getcashcomm_det", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CashCommissionDetailRef>(_dtResults, CashCommissionDetailRef.Converter);
            }

            return _list;
        }
        #endregion Commission Change

        public Dictionary<string, string> GetInvoiceWarrantyDetail(string _invoice)
        {
            Dictionary<string, string> _str = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getwarrantyremarks", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _str = new Dictionary<string, string>();
                foreach (DataRow _r in _tblData.Rows)
                {
                    _str.Add(Convert.ToString(_r["sad_itm_cd"]), Convert.ToString(_r["sad_warr_remarks"]));
                }
            }

            return _str;
        }


        //darshana 19/10/2012
        public List<HpAccRestriction> getAccRest(string _pc, DateTime _date, Int32 _type)
        {
            List<HpAccRestriction> _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccrestparam", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpAccRestriction>(_tblData, HpAccRestriction.Converter);
            }
            return _list;
        }

        //darshana 19/10/2012
        public List<HpAccount> getAccDetRest(string _com, string _pc, DateTime _fdate, DateTime _tdate)
        {
            List<HpAccount> _list = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccdetrest", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpAccount>(_tblData, HpAccount.Converter);
            }
            return _list;
        }

        public HPAccountLog GetAccountLog(string _account)
        {
            //sp_getaccountlog(p_acc in NVARCHAR2,c_data out sys_refcursor)
            HPAccountLog _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getaccountlog", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HPAccountLog>(_tblData, HPAccountLog.Converter)[0];
            }
            return _list;
        }

        public Int32 UpdateAccountforCashConversion(string _account, string _status, DateTime _date)
        {
            //sp_updateacccashconvn(p_acc in NVARCHAR2,p_status in NVARCHAR2,p_date in date,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("sp_updateacccashconvn", CommandType.StoredProcedure, param);

            return _effect;

        }

        //darshana 22/10/2012
        public List<RequestApprovalHeader> getReqbyType(string _com, string _pc, string _type, DateTime _fdate, DateTime _tdate)
        {
            List<RequestApprovalHeader> _list = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getreqbytype", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_tblData, RequestApprovalHeader.Converter);
            }
            return _list;
        }


        //darshana 22/10/2012
        public List<HPResheScheme> getAllowSch(string _Sch)
        {
            List<HPResheScheme> _list = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Sch;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getallowsch", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HPResheScheme>(_tblData, HPResheScheme.Converter);
            }
            return _list;
        }

        //darshana 22/10/2012
        public List<PriceBookLevelRef> getWarrExBook(string _com, string _pbook, string _plevel)
        {
            List<PriceBookLevelRef> _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _plevel;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getwarrexpl", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceBookLevelRef>(_tblData, PriceBookLevelRef.ConvertTotal);
            }
            return _list;
        }

        //darshana 23/10/2012
        public Int32 SaveReceiptWarrantyExtend(ReceiptWaraExtend _recWarrantyExtend)
        {
            OracleParameter[] param = new OracleParameter[23];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_srw_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_seq_no;
            (param[1] = new OracleParameter("p_srw_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_line;
            (param[2] = new OracleParameter("p_srw_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_rec_no;
            (param[3] = new OracleParameter("p_srw_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_inv_no;
            (param[4] = new OracleParameter("p_srw_do_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_do_no;
            (param[5] = new OracleParameter("p_srw_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_date;
            (param[6] = new OracleParameter("p_srw_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_itm;
            (param[7] = new OracleParameter("p_srw_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_ser;
            (param[8] = new OracleParameter("p_srw_oth_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_oth_ser;
            (param[9] = new OracleParameter("p_srw_warra", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_warra;
            (param[10] = new OracleParameter("p_srw_ex_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_ex_period;
            (param[11] = new OracleParameter("p_srw_new_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_new_period;
            (param[12] = new OracleParameter("p_srw_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_pb;
            (param[13] = new OracleParameter("p_srw_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_lvl;
            (param[14] = new OracleParameter("p_srw_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_amt;
            (param[15] = new OracleParameter("p_srw_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_cre_by;
            (param[16] = new OracleParameter("p_srw_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_cre_when;
            (param[17] = new OracleParameter("p_srw_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_ser_id;
            (param[18] = new OracleParameter("p_srw_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_comm_amt;
            (param[19] = new OracleParameter("p_srw_promo_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_promo_seq;
            (param[20] = new OracleParameter("p_srw_is_promo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_is_promo;
            (param[21] = new OracleParameter("p_srw_wara_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recWarrantyExtend.Srw_wara_rmk;
            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVESATRECWARAEX", CommandType.StoredProcedure, param);
            return effects;

        }

        //darshana 24-10-2012
        public Int32 UpdateReceiptWaraEx(string _receiptno, Int32 _receiptseqno)
        {

            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[1] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updaterecwaraextend", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 24-10-2012
        public Int32 UpdateExtendWarranty(string _doNo, string _itm, Int32 _serId, Int32 _period, string _user, string _waraNo)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_dono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            (param[3] = new OracleParameter("p_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _period;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_wara", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _waraNo;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateextendwarr", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 10-11-2012
        public Int32 CancelExtendWarranty(string _doNo, string _itm, Int32 _serId, Int32 _period, string _user, string recNo, string _warrNo)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_dono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            (param[3] = new OracleParameter("p_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _period;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_recNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recNo;
            (param[6] = new OracleParameter("p_wara", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrNo;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_cancelextendwarr", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 10-11-2012


        //darshana 24-10-2012
        public List<ReceiptWaraExtend> GetWarrantyExtendReceipt(string _RecNo)
        {
            List<ReceiptWaraExtend> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RecNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getrecwarrextend", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ReceiptWaraExtend>(tblDet, ReceiptWaraExtend.Converter);
            }
            return _list;
        }
        public List<HpSheduleDetails> GetHpAccountSchedule(string _account)
        {
            List<HpSheduleDetails> _list = null;
            //sp_gethpschadule(p_acc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_gethpschadule", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSheduleDetails>(_tblData, HpSheduleDetails.Converter);
            }
            return _list;
        }

        public Int32 UpdateInvoiceAutoNumber(MasterAutoNumber _auto)
        {
            //SP_UPDATEAUTOINVOICE(p_module in NVARCHAR2,p_direct in NUMBER,p_startchar in NVARCHAR2,p_cattp in NVARCHAR2,p_catcd in NVARCHAR2,p_year in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_moduleid;
            (param[1] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _auto.Aut_direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_start_char;
            (param[3] = new OracleParameter("p_cattp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_cate_tp;
            (param[4] = new OracleParameter("p_catcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_cate_cd;
            (param[5] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _auto.Aut_year;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("SP_UPDATEAUTOINVOICE", CommandType.StoredProcedure, param);

            return _effect;

        }

        public DataTable GetCustomerAcknowledgment(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_hp_ack", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public Int32 Savesms_items(string _item)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_SMS_ITEMS", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Deletesms_items()
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_DELETE_SMS_ITEMS", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable GetHPCustomer(string _com, string _pc, DateTime _from, DateTime _to, string _type, string _accNo, DateTime _date, DateTime _ars, DateTime _sup, Int32 _isAll, List<InsuItem> _items, Boolean _isInv, DateTime _fromInv, DateTime _ToInv, Boolean _isReg, DateTime _fromReg, DateTime _ToReg, Boolean _isno, DateTime _fromPlate, DateTime _ToPlate, Boolean _isCR, DateTime _fromCr, DateTime _ToCr)
        {
            OracleParameter[] param = new OracleParameter[12];
            DataTable _tblData = new DataTable();

            DataTable _t = new DataTable();

            if (_items != null)
            {
                if (_items.Count > 0)
                {
                    foreach (InsuItem st in _items)
                    {

                        Savesms_items(st.Item);
                    }
                }
            }




            if (_isInv == true)
            {
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromInv;
                (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToInv;
                (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
                (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                (param[7] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ars;
                (param[8] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sup;
                (param[9] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
                (param[10] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items;
                param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _tblData = QueryDataTable("tbData", "sp_get_hpt_customers_InvDate", CommandType.StoredProcedure, false, param);
            }

            if (_isno == true)
            {
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromPlate;
                (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToPlate;
                (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
                (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                (param[7] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ars;
                (param[8] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sup;
                (param[9] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
                (param[10] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items;
                param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _tblData = QueryDataTable("tbData", "sp_get_hpt_customers_no_plate", CommandType.StoredProcedure, false, param);
            }
            if (_isCR == true)
            {
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromCr;
                (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToCr;
                (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
                (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                (param[7] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ars;
                (param[8] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sup;
                (param[9] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
                (param[10] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items;
                param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _tblData = QueryDataTable("tbData", "sp_get_hpt_customers_cr", CommandType.StoredProcedure, false, param);
            }
            if (_isReg == true)
            {
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromReg;
                (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToReg;
                (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
                (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                (param[7] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ars;
                (param[8] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sup;
                (param[9] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
                (param[10] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items;
                param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _tblData = QueryDataTable("tbData", "sp_get_hpt_customers_RegDate", CommandType.StoredProcedure, false, param);
            }
            if (_isInv == false && _isno == false && _isCR == false && _isReg == false)
            {
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
                (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
                (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
                (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                (param[7] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ars;
                (param[8] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sup;
                (param[9] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
                (param[10] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items;
                param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _tblData = QueryDataTable("tbData", "sp_get_hpt_customers", CommandType.StoredProcedure, false, param);
            }

            return _tblData;
        }


        public string GetMonitorCustomer(string _company, string _profitcenter, string _parameter, string _searchtype)
        {
            string _str = null;

            // sp_getcustomerformonitor(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_parameter in NVARCHAR2,p_searchtype in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_parameter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _parameter;
            (param[3] = new OracleParameter("p_searchtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchtype;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getcustomerformonitor", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
                foreach (DataRow _cus in _tblData.Rows)
                    _str = (Convert.ToString(_cus["Customer"]));

            return _str;

        }

        public DataTable GetMonitorByCustomerDocument(string _company, string _profitcenter, string _customer)
        {
            //sp_getcustomerentries(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getcustomerentries", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //30/10/2012

        public DataTable GetHpGuarantor(string _type, string _account)
        {
            //sp_getaccountguarantor(p_type in NVARCHAR2, p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccountguarantor", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public DataTable GetHpItems(string _account)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_hp_itemdetails", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        //public List<HpSheduleDetails> GetHPAccountSchedule(string _account)

        public DataTable GetAccountSummary(string _account)
        {
            //sp_getaccountsummary (p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccountsummary", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountScheduleHistory(string _account)
        {
            //sp_getaccountschedulehistory(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccountschedulehistory", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetInvoiceWithSerial(string _invoice)
        {
            //sp_getinvoicewithserial(p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoicewithserial", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInvoiceWithSerialCusMonitor(string _com, string _invoice)
        {
            //sp_getinvoicewithserial(p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoicewithserialcusmon", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetRevertAccountDetail(string _account)
        {
            //sp_getrevertaccountdetail(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getrevertaccountdetail", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public DataTable GetRevertReleaseAccountDetail(string _account)
        {
            //sp_getrevertreleasedetail(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getrevertreleasedetail", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public DataTable GetExchangeDetail(string _com, string _account)
        {
            //sp_getexchangedetail(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getexchangedetail_new", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public Int32 SaveHPReminderLetter(ReminderLetter _ltr)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[16];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_hrl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ltr.Hrl_seq;
                (param[1] = new OracleParameter("p_hrl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_com;
                (param[2] = new OracleParameter("p_hrl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_pc;
                (param[3] = new OracleParameter("p_hrl_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_acc_no;
                (param[4] = new OracleParameter("p_hrl_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_tp;
                (param[5] = new OracleParameter("p_hrl_medium", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_medium;
                (param[6] = new OracleParameter("p_hrl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ltr.Hrl_dt;
                (param[7] = new OracleParameter("p_hrl_ars", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ltr.Hrl_ars;
                (param[8] = new OracleParameter("p_hrl_rnt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ltr.Hrl_rnt;
                (param[9] = new OracleParameter("p_hrl_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ltr.Hrl_bal;
                (param[10] = new OracleParameter("p_hrl_due_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ltr.Hrl_due_dt;
                (param[11] = new OracleParameter("p_hrl_no_prt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ltr.Hrl_no_prt;
                (param[12] = new OracleParameter("p_hrl_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_rmk;
                (param[13] = new OracleParameter("p_hrl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ltr.Hrl_cre_by;
                (param[14] = new OracleParameter("p_hrl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ltr.Hrl_cre_dt;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_reminder_letr", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception) { return -1; }
        }

        public Int32 GetReminderLetterCount(string _accNo, string _loc, string _com, string _type, DateTime _date)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
                (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                OracleParameter _outParam = new OracleParameter("result", OracleDbType.Int32, null, ParameterDirection.Output);
                int _effect = 0;

                _effect = ReturnSP_SingleValue("sp_get_rmdltr_cou", CommandType.StoredProcedure, _outParam, param); ;

                return _effect;
            }
            catch (Exception) { return -1; }
        }

        //written by prabath and darshana 01-11-2012 
        public MasterExchangeRate GetLaterstExchangeRate(string _company, string _execode, DateTime _date)
        {
            //sp_getlatestexchagerate(p_com in NVARCHAR2,p_curcode in NVARCHAR2,p_date in date,c_data out sys_refcursor)
            MasterExchangeRate _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_curcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _execode;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getlatestexchagerate", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterExchangeRate>(_tblData, MasterExchangeRate.Converter)[0];
            }
            return _list;

        }


        public Int32 SaveHPReminder(HPReminder _rmd)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[15];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_hra_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rmd.Hra_seq;
                (param[1] = new OracleParameter("p_hra_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_tp;
                (param[2] = new OracleParameter("p_hra_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_ref;
                (param[3] = new OracleParameter("p_hra_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rmd.Hra_dt;
                (param[4] = new OracleParameter("p_hra_rmd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_rmd;
                (param[5] = new OracleParameter("p_hra_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_stus;
                (param[6] = new OracleParameter("p_hra_stus_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rmd.Hra_stus_dt;
                (param[7] = new OracleParameter("p_hra_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_cre_by;
                (param[8] = new OracleParameter("p_hra_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rmd.Hra_cre_dt;
                (param[9] = new OracleParameter("p_hra_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_mod_by;
                (param[10] = new OracleParameter("p_hra_cust_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_cust_mob;
                (param[11] = new OracleParameter("p_hra_mgr_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_mgr_mob;
                (param[12] = new OracleParameter("p_hra_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_pc;
                (param[13] = new OracleParameter("p_hra_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmd.Hra_com;
                param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_hp_rmd", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception) { return -1; }
        }

        public bool IsCheckAllowFunction(string _company, string _pc, string _module, string _func)
        {
            OracleParameter[] param = new OracleParameter[5];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            (param[3] = new OracleParameter("p_func", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _func;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblAllowFunc = QueryDataTable("tblPriceDefinition", "sp_checkallowfunc", CommandType.StoredProcedure, false, param);
            if (_tblAllowFunc.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }
        public DataTable GetReminders(string _ref, string _stus, string _com, string _pc, string _type, DateTime _date)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("P_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_reminders", CommandType.StoredProcedure, false, param);


            return _tblData;
        }

        public Int32 SaveReminderSMS(HPReminderSMS _sms)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[12];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_hsrm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sms.Hsrm_seq;
                (param[1] = new OracleParameter("p_hsrm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_com;
                (param[2] = new OracleParameter("p_hsrm_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_pc;
                (param[3] = new OracleParameter("p_hsrm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_tp;
                (param[4] = new OracleParameter("p_hsrm_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_acc;
                (param[5] = new OracleParameter("p_hsrm_cust_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_cust_tp;
                (param[6] = new OracleParameter("p_hsrm_rmd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sms.Hsrm_rmd_dt;
                (param[7] = new OracleParameter("p_hsrm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _sms.Hsrm_val;
                (param[8] = new OracleParameter("p_hsrm_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_contact;
                (param[9] = new OracleParameter("p_hsrm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sms.Hsrm_cre_by;
                (param[10] = new OracleParameter("p_hsrm_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sms.Hsrm_cre_dt;

                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_hp_sms", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception) { return -1; }
        }

        public List<HPReminderSMS> GetSMSReminder(string _com, string _pc, string _acc, DateTime _date)
        {

            List<HPReminderSMS> _list = null;
            try
            {
                //sp_getrevertreleasedetail(p_account in NVARCHAR2,c_data out sys_refcursor)
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
                (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblData = QueryDataTable("tbData", "sp_get_hp_sms", CommandType.StoredProcedure, false, param);

                if (_tblData.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<HPReminderSMS>(_tblData, HPReminderSMS.Converter);
                }
                return _list;
            }
            catch (Exception) { return _list; }
        }

        //Written By Prabhath on 05/11/2012 as Quotation to Invoice
        private InvoiceItem ConvertQuotation(QoutationDetails _list, string _company)
        {
            InvoiceItem _itm = new InvoiceItem();
            _itm.Sad_disc_amt = _list.Qd_dis_amt;
            _itm.Sad_disc_rt = _list.Qd_dit_rt;
            _itm.Sad_isapp = true;
            _itm.Sad_iscovernote = true;
            _itm.Sad_itm_cd = _list.Qd_itm_cd;
            _itm.Sad_itm_line = _list.Qd_line_no;
            _itm.Sad_itm_seq = _list.Qd_seq_no;
            _itm.Sad_itm_stus = _list.Qd_itm_stus;
            _itm.Sad_itm_tax_amt = _list.Qd_itm_tax;
            _itm.Sad_pb_lvl = _list.Qd_pb_lvl;
            _itm.Sad_pb_price = _list.Qd_pb_price;
            _itm.Sad_pbook = _list.Qd_pbook;
            _itm.Sad_qty = _list.Qd_frm_qty - _list.Qd_issue_qty;
            _itm.Sad_seq = _list.Qd_pb_seq;
            _itm.Sad_seq_no = _list.Qd_seq_no;
            _itm.Sad_tot_amt = _list.Qd_tot_amt;
            _itm.Sad_unit_amt = _list.Qd_unit_price * (_list.Qd_frm_qty - _list.Qd_issue_qty);
            _itm.Sad_unit_rt = _list.Qd_unit_price;
            _itm.Sad_uom = _list.Qd_uom;
            _itm.Sad_warr_period = -1;
            _itm.Sad_warr_remarks = string.Empty;
            MasterItem _item = new InventoryDAL().GetItem(_company, _list.Qd_itm_cd);
            _itm.Mi_longdesc = _item.Mi_longdesc;
            _itm.Mi_model = _item.Mi_model;
            _itm.Mi_brand = _item.Mi_brand;
            _itm.Mi_itm_stus = _list.Qd_itm_stus;
            return _itm;
        }
        public List<InvoiceItem> GetQuotationDetail(string _company, string _profit, string _quotation, DateTime _date)
        {
            //sp_getquotationdetail ( p_com IN NVARCHAR2,p_pc IN NVARCHAR2,p_quotation IN NVARCHAR2,p_date IN DATE,c_data OUT sys_refcursor)
            List<QoutationDetails> _list = null;
            List<InvoiceItem> _invList = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[2] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getquotationdetail", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<QoutationDetails>(_tblData, QoutationDetails.ConvertTotal);
            }

            if (_list != null)
            {
                _invList = new List<InvoiceItem>();
                foreach (QoutationDetails _one in _list)
                    _invList.Add(ConvertQuotation(_one, _company));
            }
            return _invList;

        }

        public List<InvoiceItem> GetQuotationDetailforInvoice(string _company, string _DO)
        {
            //Written By Nadeeka 28-03-2015
            List<QoutationDetails> _list = null;
            List<InvoiceItem> _invList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DO;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getquotationInv", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<QoutationDetails>(_tblData, QoutationDetails.ConvertTotal);
            }

            if (_list != null)
            {
                _invList = new List<InvoiceItem>();
                foreach (QoutationDetails _one in _list)
                    _invList.Add(ConvertQuotation(_one, _company));
            }
            return _invList;
        }




        public List<PriceProfitCenterPromotion> CheckPromotion(string _company, string _profit, string _promo, Int32 _pbseq, string _pty_tp)
        {
            //sp_checkprofitcenterpromotion(p_com in NVARCHAR2, p_pc in NVARCHAR2,p_promo in NVARCHAR2,p_pbseq in NUMBER,c_data out sys_refcursor)
            List<PriceProfitCenterPromotion> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[2] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[3] = new OracleParameter("p_pbseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbseq;
            (param[4] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_tp;   //kapila 20/3/2017
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbData", "sp_checkprofitcenterpromo_new", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceProfitCenterPromotion>(_tblData, PriceProfitCenterPromotion.Converter);
            }

            return _list;

        }

        public int UpdateHPPrintStus(string _com, string _pc, int _stus, string _acc)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;
                (param[3] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;


                param[4] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("sp_update_prt_st", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception) { return -1; }
        }

        public Int32 CheckforInvoiceRegistration(string _company, string _profitcenter, string _invoice)
        {
            //sp_checkinvoiceregistered(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_invoice in NVARCHAR2,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            OracleParameter _outParam = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = ReturnSP_SingleValue("sp_checkinvoiceregistered", CommandType.StoredProcedure, _outParam, param); ;

            return _effect;
        }


        public Int32 CheckforInvoiceInsurance(string _company, string _profitcenter, string _invoice)
        {
            //sp_checkinsuarance(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_invoice in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            OracleParameter _outParam = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = ReturnSP_SingleValue("sp_checkinsuarance", CommandType.StoredProcedure, _outParam, param);

            return _effect;

        }


        #region Paymode Inquiry

        public DataTable GetPaymodeDetail(string com, string payType, string docNo, string selectedCd, string selectedTp)
        {   //p_com in NVARCHAR2, p_payType in NVARCHAR2,p_docNo in NVARCHAR2,p_selectCd in NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_payType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payType;
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            (param[3] = new OracleParameter("p_selectCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedCd;
            (param[4] = new OracleParameter("p_selectTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedTp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "get_GET_PaymodeDet", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable getInvoicesBased_onPayType(string com, string docNo, string payType, string bankCode, string selectedTp)
        {   // p_com in NVARCHAR2,p_docNo in NVARCHAR2, p_payType in NVARCHAR2,p_bankCode in NVARCHAR2,p_cardType in NVARCHAR2,c_data OUT sys_refcursor)
            List<InvoiceItem> _invoiceDET = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            (param[2] = new OracleParameter("p_payType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payType;
            (param[3] = new OracleParameter("p_bankCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bankCode;
            (param[4] = new OracleParameter("p_cardType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedTp;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "get_PaymodeBased_INVOICES", CommandType.StoredProcedure, false, param);
            return _tblInvoice;
            //if (_tblInvoice.Rows.Count > 0)
            //{
            //    _invoiceDET = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoice, InvoiceItem.ConvertTotal);
            //}

        }
        public DataTable get_Receipts_BasedonPayType(string com, string docNo, string payType, string bankCode, string selectedTp)
        {   //p_com in NVARCHAR2,p_docNo in NVARCHAR2, p_payType in NVARCHAR2,p_bankCode in NVARCHAR2,p_cardType in NVARCHAR2,c_data OUT sys_refcursor)
            List<InvoiceItem> _invoiceDET = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            (param[2] = new OracleParameter("p_payType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payType;
            (param[3] = new OracleParameter("p_bankCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bankCode;
            (param[4] = new OracleParameter("p_cardType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedTp;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "get_PaymodeBased_RECIEPTS", CommandType.StoredProcedure, false, param);
            return _tblInvoice;

        }
        public DataTable GetReturnCheque_detWithPayments(string chequeNo, string chequeBank)
        {   //(p_chequeNo in NVARCHAR2,p_chequeBank in NVARCHAR2, c_data out sys_refcursor)
            List<InvoiceItem> _invoiceDET = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_chequeNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chequeNo;
            (param[1] = new OracleParameter("p_chequeBank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chequeBank;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_GetRetCheque_detWithPays", CommandType.StoredProcedure, false, param);
            return _tblInvoice;

        }

        #endregion Paymode Inquiry


        public Int32 SaveCustomerPassportNums(CustomerPassoprt _pass)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_sdcd_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pass.Sdcd_invc_no;
                (param[1] = new OracleParameter("p_sdcd_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pass.Sdcd_line;
                (param[2] = new OracleParameter("p_sdcd_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pass.Sdcd_ref;
                (param[3] = new OracleParameter("p_sdcd_flight", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pass.Sdcd_flight;
                (param[4] = new OracleParameter("p_sdcd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pass.Sdcd_cre_by;
                (param[5] = new OracleParameter("p_sdcd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pass.Sdcd_cre_dt;
                param[6] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("sp_save_df_cus", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception) { return -1; }
        }
        //written by darshana 06/11/2012
        public HpSchemeDetails getSchemeDetByCode(string _cd)
        {
            HpSchemeDetails _SchemeDet = new HpSchemeDetails();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedet = QueryDataTable("tblschemetype", "sp_getSchemebyschcd", CommandType.StoredProcedure, false, param);
            if (_tblschemedet.Rows.Count > 0)
            {
                _SchemeDet = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tblschemedet, HpSchemeDetails.Converter)[0];
            }

            return _SchemeDet;
        }


        public DataTable GetCustomerDocumentWithSettlement(string _company, string _profitcenter, string _customer, Int16 _isOutstand)
        {
            //sp_getcustomerinvpayment(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_customer in NVARCHAR2,p_isoutstand in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[3] = new OracleParameter("p_customer", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isOutstand;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getcustomerinvpayment", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetCustomerPaymentSummary(string _company, string _profitcenter, string _customer)
        {
            //sp_getgrouppaysummary(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getgrouppaysummary", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public List<HpSchemeType> GetAllSchemeTypes()
        {
            OracleParameter[] param = new OracleParameter[1];
            List<HpSchemeType> _SchemeType = new List<HpSchemeType>();
            try
            {
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblData = QueryDataTable("tbData", "sp_get_all_schtp", CommandType.StoredProcedure, false, param);
                if (_tblData.Rows.Count > 0)
                {
                    _SchemeType = DataTableExtensions.ToGenericList<HpSchemeType>(_tblData, HpSchemeType.Converter);
                }
                return _SchemeType;
            }
            catch (Exception) { return _SchemeType; }
        }


        public DataTable GetInvoiceReceipt(string _invoice)
        {
            //sp_getinvoicereceipt(p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoicereceipt", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetHireSaleAccountBalance(string _company, string _profitcenter, string _customer, DateTime _date)
        {
            //sp_getaccclosingbalance(p_com in NVARCHAR2,p_pc in NVARCHAR2, p_customer in NVARCHAR2,p_date in DATE,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccclosingbalance", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        //darshana 03-08-2012
        public Int32 Save_HpInsu(HpInsurance _insu)
        {

            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("p_hti_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _insu.Hti_seq;
            (param[1] = new OracleParameter("p_hti_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insu.Hti_ref;
            (param[2] = new OracleParameter("p_hti_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insu.Hti_com;
            (param[3] = new OracleParameter("p_hti_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insu.Hti_pc;
            (param[4] = new OracleParameter("p_hti_acc_num", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insu.Hti_acc_num;
            (param[5] = new OracleParameter("p_hti_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insu.Hti_dt;
            (param[6] = new OracleParameter("p_hit_is_rvs", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _insu.Hit_is_rvs;
            (param[7] = new OracleParameter("p_hti_mnl_num", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insu.Hti_mnl_num;
            (param[8] = new OracleParameter("p_hti_ins_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_ins_val;
            (param[9] = new OracleParameter("p_hti_vat_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_vat_rt;
            (param[10] = new OracleParameter("p_hti_vat_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_vat_val;
            (param[11] = new OracleParameter("p_hti_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_comm_rt;
            (param[12] = new OracleParameter("p_hti_comm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_comm_val;
            (param[13] = new OracleParameter("p_hti_epf", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_epf;
            (param[14] = new OracleParameter("p_hti_esd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_esd;
            (param[15] = new OracleParameter("p_hti_wht", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insu.Hti_wht;
            (param[16] = new OracleParameter("p_hti_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insu.Hti_cre_by;
            (param[17] = new OracleParameter("p_hti_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insu.Hti_cre_dt;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_saveinsu", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<HpSchemeDetails> GetHPInsuranceSchemeCodes(string _schCd, string _cshTp, string _type, int _term, string _condi)
        {

            OracleParameter[] param = new OracleParameter[6];
            List<HpSchemeDetails> _Scheme = new List<HpSchemeDetails>();
            try
            {
                (param[0] = new OracleParameter("p_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCd;
                (param[1] = new OracleParameter("p_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cshTp;
                (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[3] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _term;
                (param[4] = new OracleParameter("p_condi", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _condi;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblData = QueryDataTable("tbData", "sp_get_diri_sch", CommandType.StoredProcedure, false, param);
                if (_tblData.Rows.Count > 0)
                {
                    _Scheme = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tblData, HpSchemeDetails.Converter);
                }
                return _Scheme;
            }
            catch (Exception) { return _Scheme; }
        }

        public int SaveHPInsurance(HPInsuranceScheme _scheme)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[19];
            try
            {
                (param[0] = new OracleParameter("p_hpi_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0; //_scheme.Hpi_seq;
                (param[1] = new OracleParameter("p_hpi_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme.Hpi_sch_cd;
                (param[2] = new OracleParameter("p_hpi_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme.Hpi_pty_tp;
                (param[3] = new OracleParameter("p_hpi_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme.Hpi_pty_cd;
                (param[4] = new OracleParameter("p_hpi_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scheme.Hpi_from_dt;
                (param[5] = new OracleParameter("p_hpi_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scheme.Hpi_to_dt;
                (param[6] = new OracleParameter("p_hpi_chk_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme.Hpi_chk_on;
                (param[7] = new OracleParameter("p_hpi_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scheme.Hpi_from_val;
                (param[8] = new OracleParameter("p_hpi_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scheme.Hpi_to_val;
                (param[9] = new OracleParameter("p_hpi_ins_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scheme.Hpi_ins_val;
                (param[10] = new OracleParameter("p_hpi_ins_isrt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scheme.Hpi_ins_isrt;
                (param[11] = new OracleParameter("p_hpi_cal_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme.Hpi_cal_on;
                (param[12] = new OracleParameter("p_hpi_vat_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scheme.Hpi_vat_rt;
                (param[13] = new OracleParameter("p_hpi_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scheme.Hpi_comm;
                (param[14] = new OracleParameter("p_hpi_comm_isrt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scheme.Hpi_comm_isrt;
                (param[15] = new OracleParameter("p_hpi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme.Hpi_cre_by;
                (param[16] = new OracleParameter("p_hpi_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scheme.Hpi_cre_dt;
                (param[17] = new OracleParameter("p_hpi_is_comp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scheme.Hpi_is_comp;

                param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int32)UpdateRecords("sp_save_hp_insu_sch", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception) { return -1; }
        }

        public MasterExchangeRate GetExchangeRate(string _com, string _fromCur, DateTime _date, string _toCur, string _pc)
        {
            MasterExchangeRate _list = null;
            try
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_curcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromCur;
                (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
                (param[3] = new OracleParameter("p_tocur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toCur;
                (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblData = QueryDataTable("tbData", "sp_get_excrt", CommandType.StoredProcedure, false, param);

                if (_tblData.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<MasterExchangeRate>(_tblData, MasterExchangeRate.Converter)[0];
                }
                return _list;
            }
            catch (Exception) { return null; }
        }


        public List<PriceCombinedItemRef> GetPriceCombinedItem(Int32 _priceBookSeq, Int32 _priceitemseq, string _mainItem, string _mainSerial)
        {

            //sp_getpricecombineitemline   (p_pb_seq in NUMBER,p_pb_itm_seq in NUMBER,p_mainitem in NVARCHAR2,p_mainserial in NVARCHAR2 ,c_data OUT sys_refcursor)
            List<PriceCombinedItemRef> _priceCombinedItemRef = new List<PriceCombinedItemRef>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceBookSeq;
            (param[1] = new OracleParameter("p_pb_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceitemseq;
            (param[2] = new OracleParameter("p_mainitem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainItem;
            (param[3] = new OracleParameter("p_mainserial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainSerial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceCombineItem = QueryDataTable("tblPriceCombineItem", "sp_getpricecombineitemline", CommandType.StoredProcedure, false, param);
            if (_tblPriceCombineItem.Rows.Count > 0)
            {
                _priceCombinedItemRef = DataTableExtensions.ToGenericList<PriceCombinedItemRef>(_tblPriceCombineItem, PriceCombinedItemRef.ConvertWithDescription);
            }

            return _priceCombinedItemRef;

        }

        //darshana 03-08-2012
        public Int32 Save_ExchangeRate(MasterExchangeRate _Exchange)
        {

            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("p_mer_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Exchange.Mer_id;
            (param[1] = new OracleParameter("p_mer_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_com;
            (param[2] = new OracleParameter("p_mer_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_cur;
            (param[3] = new OracleParameter("p_mer_vad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_vad_from;
            (param[4] = new OracleParameter("p_mer_vad_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_vad_to;
            (param[5] = new OracleParameter("p_mer_bnksel_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Exchange.Mer_bnksel_rt;
            (param[6] = new OracleParameter("p_mer_bnkbuy_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Exchange.Mer_bnkbuy_rt;
            (param[7] = new OracleParameter("p_mer_cussel_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Exchange.Mer_cussel_rt;
            (param[8] = new OracleParameter("p_mer_buyvad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_buyvad_from;
            (param[9] = new OracleParameter("p_mer_buyvad_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_buyvad_to;
            (param[10] = new OracleParameter("p_mer_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Exchange.Mer_act;
            (param[11] = new OracleParameter("p_mer_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_cre_by;
            (param[12] = new OracleParameter("p_mer_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_cre_dt;
            (param[13] = new OracleParameter("p_mer_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_mod_by;
            (param[14] = new OracleParameter("p_mer_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_mod_dt;
            (param[15] = new OracleParameter("p_mer_session_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Exchange.Mer_session_id;
            (param[16] = new OracleParameter("p_mer_to_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_to_cur;
            (param[17] = new OracleParameter("p_mer_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_pc;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_saveexchangerate", CommandType.StoredProcedure, param);
            return effects;

        }

        //darshana on 21-11-2012
        public Int32 Delete_ExRate(string _com, string _fCur, DateTime _fDate, string _tCur)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_mer_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mer_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fCur;
            (param[2] = new OracleParameter("p_mer_vad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate;
            (param[3] = new OracleParameter("p_mer_to_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tCur;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_deleteexrate", CommandType.StoredProcedure, param);

            return effects;
        }

        public DataTable GetInsuranceOnEngine(string _com, string _pc, string _type, string _eng)
        {

            OracleParameter[] param = new OracleParameter[5];
            DataTable _tblData = new DataTable();
            try
            {
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[3] = new OracleParameter("p_engin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eng;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _tblData = QueryDataTable("tbl", "sp_get_reg_ins_engin", CommandType.StoredProcedure, false, param);
                return _tblData;
            }
            catch (Exception) { return _tblData; }
        }

        public List<HPInsuranceScheme> GetSchemeByPCOrSchemeCode(string _ptTp, string _ptCd, string _type, string _sch, DateTime _date)
        {
            List<HPInsuranceScheme> _list = new List<HPInsuranceScheme>();
            try
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_pt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptTp;
                (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[2] = new OracleParameter("p_pt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptCd;
                (param[3] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch;
                (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tbl = QueryDataTable("tbl", "sp_get_hpr_insu", CommandType.StoredProcedure, false, param);
                if (_tbl.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<HPInsuranceScheme>(_tbl, HPInsuranceScheme.Converter);
                }

                return _list;
            }
            catch (Exception) { return _list; }
        }



        public DataTable GetCustomerAccountSchedule(string _account)
        {
            // sp_getaccountcusschedule(p_acc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getaccountcusschedule", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetSalesDetailsByLine(string _invNo, Int32 _line)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_sales_details_by_line", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetSalesDetails(string _invNo, string _acc)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_sales_details", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetInvCreditDetails(string _invNo)
        {
            // Sanjeewa 20-09-2016 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_sales_credit_details", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetSalesHdr(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_hdr", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetSalesDet(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_det", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        public DataTable GetinvTax(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_item_tax", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetinvSubType(string _Type, string _sType)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            (param[1] = new OracleParameter("p_stype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sType;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_SubType", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetinvBatch(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_batch", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetinvSer(double _seq)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Double, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_ser", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetinvEmp(string _com, string _emp)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_empCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _emp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_Emp", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetinvUser(string _user)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_userCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_user", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetReceipt(string _doc)
        {  // Nadeeka 28-12-2012 

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_getreceipt", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        public DataTable GetReceiptTBS(string _doc)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getreceiptTBS", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        public DataTable GetReceiptByAnal3(string _doc, string _pc, string _com)
        {

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_getreceiptby_anal3", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        public DataTable GetReceiptItemDetails(string _doc)
        {  // Nadeeka 30-01-2013

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_getreceiptdetails", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public DataTable GetDeliveredSerialDetails(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_del_serials", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        public DataTable GetReceiptWarranty(string _recNo)
        {
            // Nadeeka 28-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_ReceiptWarranty", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountDetails(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_account_details", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountLogDetails(string _accNo)
        {
            // Sanjeewa 03-01-2013 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_account_log_details", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetArrears_ClosingBalance(string _accNo, DateTime _asAtDate)
        {
            // Sanjeewa 21-05-2013 
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[2] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;

            DataTable _tblData = QueryDataTable("tbl", "sp_getarrears_closingbal", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetTotal_Arrears(DateTime _asAtDate, string _Scheme, string _user)
        {
            // Sanjeewa 05-08-2013 
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Scheme;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_arrears_sum", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetRec_Age_Analysis(int _Year, int _Month, int _NoOfMonth, string _Com, string _Pc, string _reptp, string _user, bool isSupp)
        {
            // Sanjeewa 20-11-2013 
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[3] = new OracleParameter("in_year", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Year;
            (param[4] = new OracleParameter("in_month", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Month;
            (param[5] = new OracleParameter("in_months", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NoOfMonth;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("in_reptp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptp;
            (param[8] = new OracleParameter("in_sup", OracleDbType.Int16, null, ParameterDirection.Input)).Value =( isSupp == true  ? 1  : 0);
            DataTable _tblData = new DataTable();
            SecurityDAL _securityDAL = new SecurityDAL();
            if (_securityDAL.Is_Report_DR("HPRecievableAgeAnalysis_sumtable") == true)
            {
                _tblData = QueryDataTable("tbl", "sp_get_hp_rec_age_new", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _tblData = QueryDataTable("tbl", "sp_get_hp_rec_age", CommandType.StoredProcedure, false, param);
            }

            //DataTable _tblData = QueryDataTable("tbl", "sp_get_hp_rec_age_new", CommandType.StoredProcedure, false, param);
            //DataTable _tblData = QueryDataTable("tbl", "sp_get_hp_rec_age", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetRec_Age_Analysis_New(string _orderBy, string _com, string _user, string _groupintr)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_order", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _orderBy;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_groupintr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupintr;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = new DataTable();
            SecurityDAL _securityDAL = new SecurityDAL();
            if (_securityDAL.Is_Report_DR("HPRecievableAgeAnalysis_sumtable") == true)
            {
                _tbl = QueryDataTable("tblPc", "SP_GETARRESRECEIVABLE_NEW", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _tbl = QueryDataTable("tblPc", "sp_getarresreceivable1", CommandType.StoredProcedure, false, param);
            }
            //DataTable _tbl = QueryDataTable("tblPc", "sp_getarresreceivable1", CommandType.StoredProcedure, false, param);
            //DataTable _tbl = QueryDataTable("tblPc", "SP_GETARRESRECEIVABLE_NEW", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public DataTable GetSaleswithWarranty(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _cat1, string _cat2, string _cat3, string _item, string _brand, string _model, string _InvoiceDate, string _userid)
        {
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[9] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("in_isInvoiceDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvoiceDate;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_sales_with_warr", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable GetSaleswithWarrantySCM(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _cat1, string _cat2, string _cat3, string _item, string _brand, string _model, string _InvoiceDate, string _userid)
        {
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[9] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("in_isInvoiceDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvoiceDate;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_sales_with_warr_scm", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public Int32 DeleteRecAgeAnal(string _user, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_deleteGLB_HP_REC_AGE1", CommandType.StoredProcedure, param);
        }

        public DataTable GetNoofCompletedAgreements(DateTime _fromdate, DateTime _todate, string _com, string _pc, string _user)
        {
            // Sanjeewa 18-11-2014 
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate.Date;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_agree_completed", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetReq_App_Details(DateTime _fDate, DateTime _tDate, string _reqtp, string _appStatus, string _user)
        {
            // Sanjeewa 16-09-2013 
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            (param[3] = new OracleParameter("reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqtp;
            (param[4] = new OracleParameter("appstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appStatus;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_req_app_report", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable Get_Group_Sale_Details(DateTime _fDate, DateTime _tDate, string _user, string _com, string _pc)
        {
            // Sanjeewa 20-01-2014 
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_group_sale_rpt", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetCommDetails(DateTime _fDate, DateTime _tDate, string _circular, string _user, Int16 _isExport)
        {
            // Sanjeewa 12-10-2013 
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            (param[3] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[4] = new OracleParameter("in_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_comm_details", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPhyCashVerifyMDetails(string _jobno)
        {
            // Sanjeewa 16-10-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _tblData = QueryDataTable("tbl", "pkg_physical_cash_verify.PROC_CVR_MAIN", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPhyCashVerifyRemDetails(string _com, string _pc, DateTime _fdate, DateTime _tdate)
        {
            // Sanjeewa 08-11-2015 
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate.Date;
            (param[4] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate.Date;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_rem_det_aud", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPhyCashVerifyDTDetails(string _jobno)
        {
            // Sanjeewa 16-10-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _tblData = QueryDataTable("tbl", "pkg_physical_cash_verify.PROC_CVR_DET", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPhyCashVerifyDNDetails(string _jobno)
        {
            // Sanjeewa 16-10-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _tblData = QueryDataTable("tbl", "pkg_physical_cash_verify.PROC_CVR_DENO", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPhyCashVerifyCSDetails(string _jobno)
        {
            // Sanjeewa 16-10-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _tblData = QueryDataTable("tbl", "pkg_physical_cash_verify.PROC_CVR_CASH", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetReq_App_Headings()
        {
            // Sanjeewa 16-09-2013 
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_req_app_rep_headings", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetReq_App_HeadingsView()
        {
            // Sanjeewa 16-09-2013 
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_req_app_rep_headingview", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetGracePeriod_Arrears(DateTime _asAtDate, string _user, string _com, string _pc)
        {
            // Sanjeewa 13-09-2013 
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_graceperiodarrears", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetVehicalRegDetails(string _accNo)
        {
            // Sanjeewa 21-05-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_vehical_reg_details", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetVehicalInsuranceDetails(string _accNo)
        {
            // Sanjeewa 22-05-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;

            DataTable _tblData = QueryDataTable("tbl", "sp_getvehicalinsudetails", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetHPCustomerDetails(string _custType, string _custId, Int32 _AddType, string _accNo)
        {
            // Sanjeewa 07-01-2013 
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_custTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custType;
            (param[1] = new OracleParameter("p_custID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custId;
            (param[2] = new OracleParameter("p_addressTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AddType;
            (param[3] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_Get_AccCustomer", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetQuotationPrintDetails(string _QuoNo)
        {
            // Sanjeewa 12-06-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_QtNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoNo;

            DataTable _tblData = QueryDataTable("tbl", "sp_getquotationdetails1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetQuotationWarrantyPrintDetails(string _Company)
        {
            // Sanjeewa 10-08-2013 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;

            DataTable _tblData = QueryDataTable("tbl", "sp_getquotationwarranty", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetEliteCommissionDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 19-06-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_elite_commission_detail", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetBalanceWarrantyClaimCRNoteDetails(DateTime _fromDate, DateTime _toDate, string _Dealer, string _User)
        {
            // Sanjeewa 24-06-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("dealer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Dealer;
            (param[4] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_del_war_sett_rep", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable GetSalesPromoAchievementDetails(DateTime _fromDate, DateTime _toDate, string _circularno, string _scheme, string _User)
        {
            // Sanjeewa 01-07-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("circularno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circularno;
            (param[4] = new OracleParameter("schemecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_sales_promo", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetNotRegVehDetails(string _User, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 20-06-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_not_reg_vehicles", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDeliveredSalesInsuDetails(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor, int _freeissue)
        {
            // Sanjeewa 21-01-2015         
            OracleParameter[] param = new OracleParameter[20];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_del_sales_insured", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSalesReconcilationDetails(DateTime _fromDate, DateTime _toDate, string _com, string _loc)
        {
            // kapila 20/3/2017
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "SP_PRINT_SALES_RECONCILATION", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTotalSaleswithInvType(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor, int _freeissue, int currencyType, int revOrSaleOrAll, string _color, string _size)
        {
            // Sanjeewa 23-05-2017         
            OracleParameter[] param = new OracleParameter[26];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[20] = new OracleParameter("IN_CURRENCYTYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = currencyType;
            (param[21] = new OracleParameter("IN_SALETYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = revOrSaleOrAll;
            (param[22] = new OracleParameter("IN_ITEMCAT4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[23] = new OracleParameter("IN_ITEMCAT5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[24] = new OracleParameter("in_color", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color;
            (param[25] = new OracleParameter("in_size", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _size;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_total_sales_by_inv_tp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDeliveredSalesDetails(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor, int _freeissue, int currencyType, int revOrSaleOrAll, string _color, string _size, string _country = null, string _province = null, string _district = null, string _city = null)//updated by akila 2018/03/16
        {
            // Sanjeewa 31-01-2013         
            OracleParameter[] param = new OracleParameter[30];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[20] = new OracleParameter("IN_CURRENCYTYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = currencyType;
            (param[21] = new OracleParameter("IN_SALETYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = revOrSaleOrAll;
            (param[22] = new OracleParameter("IN_ITEMCAT4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[23] = new OracleParameter("IN_ITEMCAT5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[24] = new OracleParameter("in_color", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color;
            (param[25] = new OracleParameter("in_size", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _size;

            //updated by akila 2018/03/16
            (param[26] = new OracleParameter("IN_COUNTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _country;
            (param[27] = new OracleParameter("IN_PROVINCE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _province;
            (param[28] = new OracleParameter("IN_DISTRICT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _district;
            (param[29] = new OracleParameter("IN_CITY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;

            DataTable _dtResults;
            if (_RepType == "DSALE")
            {
                //_dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_DEL_SALES", CommandType.StoredProcedure, false, param);
                _dtResults = QueryDataTable("tbl", "sp_get_deliveredsales", CommandType.StoredProcedure, false, param);
            }
            else if (_RepType == "DSALEEX")
            {
                _dtResults = QueryDataTable("tbl", "sp_get_deliveredsales_excel", CommandType.StoredProcedure, false, param);
            }
            else if (_RepType == "TSALEMONTH")
            {
                _dtResults = QueryDataTable("tbl", "sp_get_deliveredsales_excel", CommandType.StoredProcedure, false, param);
            }
            else if (_RepType == "TSALEEX")
            {
                _dtResults = QueryDataTable("tbl", "sp_get_del_total_sales_excel", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_TOT_SALES", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }

        public DataTable GetStockSalesDetails(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor, int _freeissue, string _Supplier)
        {
            // Sanjeewa 17-12-2015
            OracleParameter[] param = new OracleParameter[23];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_ITEMCAT4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[13] = new OracleParameter("IN_ITEMCAT5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[14] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[15] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[16] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[17] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[18] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[19] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[20] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[21] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[22] = new OracleParameter("IN_SUPPLIER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_sale_stock_dtl", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetComparisonofDeliveredSalesDetails(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor, int _freeissue, string _IsMonth, string _IsDelivered)
        {
            // Sanjeewa 12-12-2014        
            OracleParameter[] param = new OracleParameter[22];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[20] = new OracleParameter("in_IsMonth", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _IsMonth;
            (param[21] = new OracleParameter("in_IsDelivered", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _IsDelivered;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_sales_comparison", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 DeleteCustomerAnalysisRep(string _User)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("proc_tot_sales_cust_anal_del", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetTotalSales8020Summary(int _Margin, string _type, string _User)
        {
            // Sanjeewa 22-08-2014         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_MARGIN", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Margin;
            (param[2] = new OracleParameter("IN_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_TOT_SALES_CUST_ANAL_SUM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTotalSales8020Details(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, int _Margin, string _type)
        {
            // Sanjeewa 22-08-2014         
            OracleParameter[] param = new OracleParameter[20];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[18] = new OracleParameter("IN_MARGIN", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Margin;
            (param[19] = new OracleParameter("IN_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_TOT_SALES_CUST_ANALYSIS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDeliveredSalesDetailsAuditReport(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, int _noDays)
        {
            // Nadeeka 08-05-2014        
            OracleParameter[] param = new OracleParameter[19];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[18] = new OracleParameter("in_day", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _noDays;
            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "sp_get_deliveredsalesAudit", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable GetCustomerInfoDetails(DateTime _fromDate, DateTime _toDate, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _User, string _Pc, string _Com, Int16 _locno)
        {
            // Sanjeewa 10-02-2014
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[4] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[5] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[6] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[7] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[8] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[9] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[10] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[11] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[12] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[13] = new OracleParameter("in_locno", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _locno;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_customerdetails", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDeliveredSalesGRNDetails(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Supplier, string _PONo, string _Com, string _Pc, int _isExport)
        {
            // Sanjeewa 05-09-2013         
            OracleParameter[] param = new OracleParameter[21];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;
            (param[17] = new OracleParameter("IN_PONO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[18] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[19] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[20] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "sp_get_delsales_grn1", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetDeliveredSalesGRNCostDetails(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _PCenter, string _User, string _RepType, string _StockType, string _InvNo, string _Supplier, string _PONo, string _Com, string _Pc, int _isExport)
        {
            // Sanjeewa 05-09-2013         
            OracleParameter[] param = new OracleParameter[21];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[16] = new OracleParameter("IN_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;
            (param[17] = new OracleParameter("IN_PONO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[18] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[19] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[20] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "sp_get_delsales_grn_multi", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCashSalesSummaryDetails(DateTime _fromDate, DateTime _toDate, string _DocSubTp, string _PCenter, string _User, string _RepType)
        {
            // Sanjeewa 08-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_DOCSUBTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocSubTp;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            if (_RepType == "CASHSALE")
            {
                _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_CASH_SALES", CommandType.StoredProcedure, false, param);
            }
            else if (_RepType == "CREDITSALE")
            {
                _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_CREDIT_SALES", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_CREDIT_SALES", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }

        public DataTable GetRevertNReleaseDetails(DateTime _fromDate, DateTime _toDate, string _com, string _PCenter, string _User)
        {
            // Sanjeewa 13-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "pkg_rep_rvt_n_rls.PROC_RVT_N_RLS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCommonExcelDetails(string _SQL)
        {
            // Sanjeewa 23-12-2016         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("insql", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SQL;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_common_sql", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetRevertReleaseOther(DateTime _fromDate, DateTime _toDate, string _com, string _PCenter, string _User, Int16 _Opt)
        {
            // Nadeeka 25-04-2014         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[6] = new OracleParameter("opt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Opt;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "SP_REVERT_REL_OTH_SR", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRevertStatus(DateTime _fromDate, DateTime _toDate, string _com, string _PCenter, string _User)
        {
            // Nadeeka 25-04-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;


            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "SP_REVERT_STATUS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAgreementChecklistDetails(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _User)
        {
            // Sanjeewa 23-01-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "sp_get_agree_checklist", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRevertItemDetails(DateTime _fromDate, DateTime _toDate, string _com, string _PCenter, string _User)
        {
            // kapila     
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "pkg_rep_rvt_n_rls.PROC_RVT_ITM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRevertItemDetailsAudit(DateTime _fromDate, DateTime _toDate, string _com, string _PCenter, string _User, string _jobno)
        {
            // Nadeeka     
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[6] = new OracleParameter("IN_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "pkg_rep_rvt_n_rls.PROC_RVT_ITM_AUDIT", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRevertItemDetailsAuditNew(DateTime _fromDate, DateTime _toDate, string _com, string _PCenter, string _User, string _jobno)
        {
            // Nadeeka     
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[6] = new OracleParameter("IN_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "pkg_rep_rvt_n_rls.PROC_RVT_ITM_AUDIT_NEW", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPOSDetailDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 01-04-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;

            _dtResults = QueryDataTable("tbl", "pkg_posdetail.PROC_POSDETAIL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetHireSalesDetails(DateTime _fromDate, DateTime _toDate, string _DocSubTp, string _PCenter, string _User, string _RepType)
        {
            // Sanjeewa 12-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_DOCSUBTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocSubTp;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_hiresale", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetHireSalesCancelDetails(DateTime _fromDate, DateTime _toDate, string _User, string _pc)
        {
            // Sanjeewa 21-10-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_hiresale_cancel_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDiscountDetails(string _Circular, string _User, int _isExport, string _com, string _Pc)
        {
            // Sanjeewa 08-12-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;
            (param[2] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;
            (param[4] = new OracleParameter("in_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_disc_dtl", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDiscountDetails1(string _Circular, string _User, int _isExport, string _com, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 10-06-2014         
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;
            (param[2] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[8] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[9] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[10] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[11] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[12] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_disc_dtl1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDiscountDetailsLocation(string _Circular, string _User, string _com)
        {
            // Sanjeewa 09-06-2014        
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;
            (param[2] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_disc_dtl_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDeliveredSerDetails(string _InvNo, string _Item, string _User, int _isExport, int _isLastPc)
        {
            // Sanjeewa 09-12-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[2] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;
            (param[5] = new OracleParameter("in_lastpc", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isLastPc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_del_serial", CommandType.StoredProcedure, false, param);
            //   _dtResults = QueryDataTable("tbl", "sp_get_del_serial_test", CommandType.StoredProcedure, false, param);



            return _dtResults;
        }

        public DataTable GetForwardSalesDetails(DateTime _asAtDate, string _User, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _agetp, decimal _age, string _com, string _pc, string _latestcost, string _otherloc, string _customer)
        {
            // Sanjeewa 28-03-2013         
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[7] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[8] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[9] = new OracleParameter("in_agetp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agetp;
            (param[10] = new OracleParameter("in_age", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _age;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[12] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[13] = new OracleParameter("in_latestcost", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _latestcost;
            (param[14] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherloc;
            (param[15] = new OracleParameter("in_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_forward_sales1.PROC_FWD_SALES2", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public DataTable GetForwardSalesDetailAudit(DateTime _asAtDate, string _User, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _agetp, decimal _age, string _com, string _pc, string _latestcost)
        {
            // Sanjeewa 28-03-2013      //Added filter by create date by Nadeeka    
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[7] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[8] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[9] = new OracleParameter("in_agetp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agetp;
            (param[10] = new OracleParameter("in_age", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _age;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[12] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[13] = new OracleParameter("in_latestcost", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _latestcost;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_forward_sales1.PROC_FWD_SALES_AUDIT", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetItemRestrictionDetails(string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _com, string _pc)
        {
            // Sanjeewa 24-06-2014         
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[2] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[3] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[4] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[5] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[6] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[7] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[8] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_item_restriction", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetForwardSalesDetails1(DateTime _asAtDate, string _User, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _agetp, decimal _age, string _com, string _pc)
        {
            // Sanjeewa 28-03-2013         
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[7] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[8] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[9] = new OracleParameter("in_agetp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agetp;
            (param[10] = new OracleParameter("in_age", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _age;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[12] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_forward_sales.PROC_FWD_SALES1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCurrentMonthDueDetails(int _Year, int _Month, string _Scheme, string _User, string _Com, string _Pc)
        {
            // Sanjeewa 17-05-2013         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_year", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Year;
            (param[2] = new OracleParameter("in_month", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Month;
            (param[3] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Scheme;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[5] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[6] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_current_month_due", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAllDueDetails(int _Year, int _Month, string _Scheme, string _User, string _com, string _pc)
        {
            // Sanjeewa 23-05-2013         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_year", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Year;
            (param[2] = new OracleParameter("in_month", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Month;
            (param[3] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Scheme;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_all_due_summary", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetLastNoSeqDetails(DateTime _asAtDate, string _User, string _DocType, string _Com, string _Loc)
        {
            // Sanjeewa 09-04-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_AS_AT_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("DocType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[5] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_lastno_seq_rep.PROC_LASTNO_SEQ_WIND", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCollectionHeaderDetails(string _User, string _JoNo)
        {
            // Sanjeewa 25-10-2013         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_MAIN", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCollectionItemDetails(string _User, string _JoNo)
        {
            // Sanjeewa 25-10-2013         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_ITEM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable getAuditRCCDetails(string _com, string _loc)
        {
            // Sanjeewa 30-03-2017         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_RCC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable getAuditSerialMismatch(string _job)
        {
            // Sanjeewa 30-03-2017         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_SERIAL_MISMATCH", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable UserMonitor(string _Com, string _Dept, string _User)
        {
            // Wimal 012/03/2017         
            OracleParameter[] param = new OracleParameter[4];
            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[0] = new OracleParameter("in_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("in_deptcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Dept;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_user_monitor", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public DataTable PhyStkBalCollectionRemarkDetails(string _User, string _JoNo, Int16 _line)
        {
            // Sanjeewa 29-10-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _line;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_REMARK", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCollectionSerialDetails(string _User, string _JoNo, string _StkCat, string _RepType, string _RepStatus, string _RepFilter)
        {
            // Sanjeewa 25-10-2013         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("in_stkcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StkCat;
            (param[3] = new OracleParameter("in_reptp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RepType;
            (param[4] = new OracleParameter("in_ref_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RepStatus;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[6] = new OracleParameter("in_mismatchonly", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RepFilter;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_SERIAL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCollectionSerialAgeDetails(string _User, string _JoNo)
        {
            // Sanjeewa 29-10-2013         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_SERIALAGE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCollectionSerialAgeDetailsNew(string _User, string _JoNo)
        {
            // Sanjeewa 31-03-2017        
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_SERIALAGE_NEW", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCommStkDetails(string _com, string _itm)
        {
            // Sanjeewa 12-02-2016         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_supp_item", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalFIFODetails(string _User, string _JoNo)
        {
            // Sanjeewa 29-10-2013         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_FIFO_NEW", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalFIFODetailsNew(string _User, string _JoNo)
        {
            // Sanjeewa 30-03-2017         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_FIFO_NEW1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable UnconfirmedAODDetails(string _User, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 30-10-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_UNCONFIRMED_AOD", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable AuditSalesAchievementDetails(DateTime _fromDate, DateTime _toDate, string _com, string _pc)
        {
            // Sanjeewa 14-11-2018         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_aud_sale_achv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable UnconfirmedAODDet_Pro(string _loc)
        {
            // Sanjeewa 30-10-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_UNCONFIRMED_AOD_PRO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetForwardSalesDetailAudit_Pro(string _loc)
        {
            // kapila        
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_FWD_SALES_AUDIT_PRO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetLastNoSeqDetails_Pro(string _loc, string _reptype)
        {
            // kapila        
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("IN_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptype;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_lastno_seq_rep_PRO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetLastNoSeqPageDetails_Pro(string _loc, string _reptype)
        {
            // kapila        
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("IN_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptype;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_manual_doc_details1_pro", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable UnconfirmedAODDetailsNew(string _User, DateTime _fromDate, DateTime _toDate, string _com, string _loc)
        {
            // Sanjeewa 30-10-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_UNCONFIRMED_AOD_NEW", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable DFSalesDetails(string _User, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 30-10-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_DF_SALES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable DFSalesReceiptDetails(string _User, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 30-10-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_DF_RECEIPTS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable DFSalesReceiptCurrDetails(string _User, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 31-10-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_DF_INVRECEIPTS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable RecDeskSummDetails(string _User, DateTime _fromDate, DateTime _toDate, string _com, string _loc)
        {
            // Sanjeewa 31-12-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_rec_desck_sum", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable ReqAppCurrentStatusDetails(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _reqtp, string _status, string _User)
        {
            // Sanjeewa 24-11-2014         
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqtp;
            (param[6] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_app_curr_status", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable DFInvBalwithPriceDetails(string _User, DateTime _asatDate, string _com, string _loc)
        {
            // Sanjeewa 10-10-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_df_invbal_price", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable TrPayTpDefDetails(string _com, string _circular, string _promocode, string _paytp, string _isasatdate, DateTime _fDate, DateTime _tDate, DateTime _asatDate, string _User)
        {
            // Sanjeewa 13-10-2013         
            OracleParameter[] param = new OracleParameter[10];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[3] = new OracleParameter("in_promocode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promocode;
            (param[4] = new OracleParameter("in_paytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paytp;
            (param[5] = new OracleParameter("in_isasatdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _isasatdate;
            (param[6] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[7] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            (param[8] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[9] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_tr_paytp_def", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable TrPayTpDefEnquiry(string _com, string _circular, string _promocode, string _paytp, string _isasatdate, DateTime _fDate, DateTime _tDate, DateTime _asatDate, string _barnd, string _pb, string _pblevel, string _mcate, string _scate, string _value, string _type, string _item)
        {
            // Nadeeka 17-04-2015         
            OracleParameter[] param = new OracleParameter[17];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[3] = new OracleParameter("in_promocode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promocode;
            (param[4] = new OracleParameter("in_paytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paytp;
            (param[5] = new OracleParameter("in_isasatdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _isasatdate;
            (param[6] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[7] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            (param[8] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[9] = new OracleParameter("in_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _barnd;
            (param[10] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[11] = new OracleParameter("in_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblevel;
            (param[12] = new OracleParameter("in_mcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mcate;
            (param[13] = new OracleParameter("in_scat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scate;

            (param[14] = new OracleParameter("in_ptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[15] = new OracleParameter("in_pcpde", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[16] = new OracleParameter("in_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_tr_paytp_enquiry", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable ActivePromotionDetails(string _com, string _circular, string _promocode, string _pricebook, string _pblevel, string _status, string _paytp, string _isasatdate, DateTime _fDate, DateTime _tDate, DateTime _asatDate, string _User, string _isallloc)
        {
            // Sanjeewa 13-10-2013         
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[3] = new OracleParameter("in_promocode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promocode;
            (param[4] = new OracleParameter("in_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricebook;
            (param[5] = new OracleParameter("in_pblevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblevel;
            (param[6] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("in_paytp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paytp;
            (param[8] = new OracleParameter("in_isasatdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _isasatdate;
            (param[9] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[10] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            (param[11] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_allloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _isallloc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_active_promo_dtl", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable ProfitCenterDetails(string _User, int _isExport)
        {
            // Sanjeewa 27-12-2013         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[2] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_pc_master", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable DFSalesReceiptCurrTrDetails(string _User, DateTime _fromDate, DateTime _toDate)
        {
            // Sanjeewa 26-12-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.PROC_DF_FCURR_TR", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PhyStkBalCollectionSerialMatchDetails(string _User, string _JoNo, string _StkCat, string _RepStatus, string _SerMisMatch)
        {
            // Sanjeewa 25-10-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_stkcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StkCat;
            (param[4] = new OracleParameter("in_ref_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RepStatus;
            (param[5] = new OracleParameter("in_mismatchonly", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SerMisMatch;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_SERIAL_MATCHING", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeCategory(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_CATEGORY", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeType(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_TYPE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeDetail(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_DETAIL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeCommission(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_COMMISSION", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeSchedule(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_SCHEDULE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeReSchedule(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_RESCHEDULE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeProofDoc(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_PROOFDOC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeSerCharge(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_SERCHARGE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeOtherCharge(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_OTHERCHARGE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemeGuaranter(string _Circular)
        {
            // Sanjeewa 13-05-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_CIRCULARNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_scheme_dtl.PROC_SCH_GUARANTER", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetNoOfAccountDetails(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            // Sanjeewa 14-02-2013          
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_no_of_accounts_rep", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTransferedAccountDetails(DateTime _fromDate, DateTime _toDate, string _User, string _Com, string _Pc)
        {
            // Sanjeewa 25-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[5] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_transfered_acc1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetJobDetails(DateTime _fromDate, DateTime _toDate, string _User, string _Channel, Int16 _Status)
        {
            // Sanjeewa 27-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("IN_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Channel;
            (param[5] = new OracleParameter("IN_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Status;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_job_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPaymodeDetails(DateTime _fromDate, DateTime _toDate, string _Paymode, string _User, int _Export, string _pc, string _com)
        {
            // Sanjeewa 09-10-2013         
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("paymode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Paymode;
            (param[4] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[5] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Export;
            (param[6] = new OracleParameter("in_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[7] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_PAYMODE_DETAILSnew", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPaymodeAmendDetails(DateTime _fromDate, DateTime _toDate, string _Paymode, string _User, int _Export)
        {
            // Sanjeewa 18-01-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("paymode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Paymode;
            (param[4] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[5] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Export;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_paymode_details_amend", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetJobSummaryDetails(DateTime _fromDate, DateTime _toDate, string _User, string _Pc, string _Com)
        {
            // Sanjeewa 15-08-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_service_job_summ", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetStampDutyDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 07-03-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_stampduty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSVATDetails(DateTime _fromDate, DateTime _toDate, string _User, string _doctype, string _docsubtype)
        {
            // Sanjeewa 08-03-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            (param[5] = new OracleParameter("IN_DOCSUBTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docsubtype;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_svat_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetJobScheduleDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 27-02-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_job_schedule", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAgreementStatementDetails(DateTime _asAtDate, string _Com, string _Pc, string _User)
        {
            // Sanjeewa 19-12-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_agree_statement", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetAgreementStatementDetailsAudit(DateTime _asAtDate, string _Com, string _Pc, string _User)
        {
            // Sanjeewa 19-12-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_agree_statement_audit", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetAgreementCheckDetails(DateTime _asAtDate, string _Com, string _Pc, string _User)
        {
            // Sanjeewa 20-12-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_agree_check", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetAgreementStatementDtlDetails(DateTime _asAtDate, string _Com, string _Pc, string _User)
        {
            // Sanjeewa 21-12-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_agree_statementdtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetAgreementPendingDetails(DateTime _asAtDate, string _Com, string _Pc, string _User)
        {
            // Sanjeewa 22-10-2014         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_agree_pending", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetNoOfActAccountDetails(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            // Sanjeewa 19-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_no_of_act_acc.PROC_NO_OF_ACT_ACC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSalesFiguresDetails(DateTime _fromDate, DateTime _toDate, string _User, string _Pc)
        {
            // Sanjeewa 03-03-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_salesfigures", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSalesTargetAchievementDetails(DateTime _fromDate, DateTime _toDate, string _brand, string _Com, string _Pc, string _User)
        {
            // Sanjeewa 25-05-2015
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[6] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_sales_target_achivement", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetASalesDetails(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _Pc)
        {
            // Sanjeewa 10-03-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_A_SALES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSalesFiguresDetailsWithTax(DateTime _fromDate, DateTime _toDate, string _User, string _Pc, string _Com)
        {
            // Nadeeka 28-02-2014        
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_salesfigureDatails", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        public DataTable GetCrBalanceDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 07-11-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_cr_balance_rep", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetHPGroupCommissionDetails(DateTime _fromDate, DateTime _toDate, string _User, string _DocType)
        {
            // Sanjeewa 03-03-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("inv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_hpgrpsale_comm_rep", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTotalRevenueDetails(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            // Sanjeewa 03-10-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_total_revenue", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetColBonusReconDetails(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _User, string _type)
        {
            // Sanjeewa 22-12-2014         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[6] = new OracleParameter("in_reptp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_col_bonus_claim", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAgreementPrintingHeaderDetails(string _accno)
        {
            // Sanjeewa 08-06-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "get_printhpagree_header", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAgreementPrintingItemDetails(string _accno)
        {
            // Sanjeewa 08-06-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "get_printhpagree_items", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAgreementPrintingCustomerDetails(string _accno)
        {
            // Sanjeewa 08-06-2013         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "get_printhpagree_customer", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDepositBankDefDetails(string _com, string _pc)
        {
            // Sanjeewa 29-08-2014         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_dep_bank_def", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetVehicleRegistrationDetails(string _refno)
        {
            // Sanjeewa 23-09-2014         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refno;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_vehregapp_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetBrandDetails(string _brandcd)
        {
            // Sanjeewa 23-09-2014         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_brandcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brandcd;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_brand_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCountryDetails(string _countrycd)
        {
            // Sanjeewa 23-09-2014         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_countrycd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _countrycd;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_country_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetExecwiseSalesInvDetails(DateTime _fromDate, DateTime _toDate, string _User, decimal _discRate, Int16 _discTp, Int16 _isdel, String _ExType, String _com, String _pc, String _appby)
        {
            // Sanjeewa 31-05-2013         
            OracleParameter[] param = new OracleParameter[10];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_DiscRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _discRate;
            (param[5] = new OracleParameter("in_DiscTp", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _discTp;
            (param[6] = new OracleParameter("in_exeType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ExType;
            (param[7] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[8] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[9] = new OracleParameter("in_appby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appby;

            DataTable _dtResults;
            if (_isdel == 1)
            {
                _dtResults = QueryDataTable("tbl", "sp_get_exec_wise_sales", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "sp_get_exec_wise_sale_All", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }

        public DataTable GetLastDayEndLogDetails(DateTime _asAtDate, string _User, string _Com, string _Pc)
        {
            // Sanjeewa 10-04-2013         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_latest_day_end_log1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCashSalesCommissionDetails(DateTime _fromDate, DateTime _toDate, string _DocSubTp, string _PCenter, string _User, string _RepType)
        {
            // Sanjeewa 11-02-2013         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_DOCSUBTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocSubTp;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[6] = new OracleParameter("IN_REPTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RepType;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_commission_cashsale", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCashSalesDODetails(DateTime _fromDate, DateTime _toDate, string _DocSubTp, string _PCenter, string _User, string _RepType)
        {
            // Sanjeewa 11-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_DOCSUBTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocSubTp;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_do_cashsale", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCashSalesAccountDetails(DateTime _fromDate, DateTime _toDate, string _DocSubTp, string _PCenter, string _User, string _RepType)
        {
            // Sanjeewa 11-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_DOCSUBTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocSubTp;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCenter;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_account_cashsale", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInvoiceReceiptDet(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_invoice_receipt", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetServiceGP(string _com, string _pc, DateTime _fdate, DateTime _tdate)
        {
            // Nadeeka 27-04-2015
            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            DataTable _tblData = QueryDataTable("tbl", "sp_service_gp", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetServiceGPDetail(string _com, string _pc, DateTime _fdate, DateTime _tdate, string _doctp)
        {
            // Sanjeewa 21-09-2015
            OracleParameter[] param = new OracleParameter[6];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[5] = new OracleParameter("in_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            DataTable _tblData = QueryDataTable("tbl", "sp_service_gp_dtl", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetServiceStandBy(string _com, string _loc, DateTime _fdate, DateTime _tdate)
        {
            // Nadeeka 27-04-2015
            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            DataTable _tblData = QueryDataTable("tbl", "sp_Standby_Status", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInsuranceCompanyName(string _recNo)
        {
            // Nadeeka 14-03-2014 
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            DataTable _tblData = QueryDataTable("tbl", "sp_getInsReceiptInsCompany", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInvoice_Serials(string _recNo)
        {
            // Nadeeka 14-01-2015
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            DataTable _tblData = QueryDataTable("tbl", "sp_getInvoiceSerials", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetQuotationDet(string _com, string _type, string _customer, string _item, string _cat1, string _cat2, string _cat3, string _brand, String _model, DateTime _fdate, DateTime _tdate)
        {
            // Nadeeka 27-04-2015
            OracleParameter[] param = new OracleParameter[12];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[3] = new OracleParameter("in_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[5] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[9] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[10] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[11] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            DataTable _tblData = QueryDataTable("tbl", "sp_QuotationdDetails", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetExchangeReceiptHdr(string _ReqNo)
        {
            // Sanjeewa 06-11-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_exchg_rec_hdr", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetExchangeReceiptDet(string _ReqNo)
        {
            // Sanjeewa 06-11-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_exchg_rec_itm", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetPriceDetails(string _circular, string _promocode, string _pricetp, string _pb, string _pblevel, DateTime _dtfrom, DateTime _dtto, DateTime _dtasat,
            string _customer, string _itemcode, string _brand, string _model, string _itemcat1, string _itemcat2, string _itemcat3, string _user, string _reptp)
        {
            // Sanjeewa 20-07-2013 
            OracleParameter[] param = new OracleParameter[18];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("promocode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promocode;
            (param[3] = new OracleParameter("pricetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricetp;
            (param[4] = new OracleParameter("pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[5] = new OracleParameter("pblevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblevel;
            (param[6] = new OracleParameter("dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtfrom.Date;
            (param[7] = new OracleParameter("dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtto.Date;
            (param[8] = new OracleParameter("dtasat", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtasat.Date;
            (param[9] = new OracleParameter("customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[10] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[11] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[13] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[14] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[15] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[16] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[17] = new OracleParameter("reptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptp;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_reppricedetails", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPriceCombineDetails()
        {
            // Sanjeewa 30-07-2013 
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_repprice_com_item", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetPriceLocationDetails()
        {
            // Sanjeewa 30-07-2013 
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_repprice_location", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetPriceDetails1(string _circular, string _promocode, string _pricetp, string _pb, string _pblevel, DateTime _dtfrom, DateTime _dtto, DateTime _dtasat,
           string _customer, string _itemcode, string _brand, string _model, string _itemcat1, string _itemcat2, string _itemcat3, string _user, string _reptp)
        {
            // Sanjeewa 14-11-2014 
            OracleParameter[] param = new OracleParameter[18];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("promocode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promocode;
            (param[3] = new OracleParameter("pricetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricetp;
            (param[4] = new OracleParameter("pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[5] = new OracleParameter("pblevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblevel;
            (param[6] = new OracleParameter("dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtfrom.Date;
            (param[7] = new OracleParameter("dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtto.Date;
            (param[8] = new OracleParameter("dtasat", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtasat.Date;
            (param[9] = new OracleParameter("customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[10] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[11] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[13] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[14] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[15] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[16] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[17] = new OracleParameter("reptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptp;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_reppricedetails1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPriceCombineDetails1(string in_item, int in_seq, int in_line)
        {
            // Sanjeewa 14-11-2014  
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[2] = new OracleParameter("in_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_seq;
            (param[3] = new OracleParameter("in_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_line;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_repprice_com_item1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetPriceLocationDetails1(int in_seq, string in_promo)
        {
            // Sanjeewa 14-11-2014  
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_seq;
            (param[2] = new OracleParameter("in_promocd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_promo;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_repprice_location1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetVehicleRegUnreg_Report(DateTime _fdate, DateTime _tdate, string _regtp, string _user, string _invtp)
        {
            // Sanjeewa 27-10-2014 
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_regtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regtp;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("in_invtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invtp;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_reg_unreg_veh_dtl", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetVehicleRegUnreg1_Report(DateTime _fdate, DateTime _tdate, string _regtp, string _com, string _pc, string _user)
        {
            // Sanjeewa 27-10-2014 
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_regtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regtp;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_reg_unreg_veh_dtl1", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetPriceDiscrepancyReport(DateTime _fdate, DateTime _tdate, string _regtp, string _com, string _pc, string _user)
        {
            // Dilshan 27-10-2017 
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_regtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regtp;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_PriceDiscrepancy", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable getCoverNoteDetailsReport(DateTime _fdate, DateTime _tdate, string _com, string _pc, string _user)
        {
            // Sanjeewa 27-10-2014 
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("in_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_COVER_NOTE_DET", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInvoiceReceiptHdr(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_rec_Hdr", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetVehicleRegistrationReport(DateTime _date, string _com, string _user, string _invType, string _itemCode, DateTime _fromdate, DateTime _todate)
        {
            // Nadeeka 18-07-2013 
            DataTable _tblData = new DataTable();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_invType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invType;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (_invType == "")
            {
                _tblData = QueryDataTable("tbl", "pkg_hp_sales_scm2.sp_get_Vehi_Regstration_new", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _tblData = QueryDataTable("tbl", "pkg_hp_sales_scm2.sp_get_Vehi_Regstration", CommandType.StoredProcedure, false, param);
            }
            return _tblData;

        }

        public DataTable GetInsuranceAgreement(string _accNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("n_cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "pkg_hp_sales_scm2.sp_ins_Agreement", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountSchedule(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_account_schedule", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountSchedule_Acc(string _accNo)
        {
            // Sanjeewa 03-01-2013 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_account_schedule_byAcc", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountTransactionDetails(string _accNo)
        {
            // Sanjeewa 03-01-2013 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_account_Transaction", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetReportInfor(string _repName)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rep", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _repName;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_report_infor", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetCancelledDocuemnt(DateTime _fdate, DateTime _tdate, string _userid, string _Location, string _Company, string docType)
        {
            // Nadeeka 12-08-2013 

            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Location;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;
            (param[6] = new OracleParameter("in_DocType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docType;

            DataTable _tblData = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_CANCEL_DOCUMENT", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetManualDocuemnt(DateTime _fdate, DateTime _tdate, string _userid, string _Location, string _Company, string docType)
        {
            // Nadeeka 12-08-2013 

            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Location;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;
            (param[6] = new OracleParameter("in_DocType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docType;

            DataTable _tblData = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_MANUAL_DOCUMENT", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAddIncentiveDetails(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _Scheme, string _userid)
        {   // Sanjeewa 18-03-2014
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Scheme;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_add_incentive", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetDeliveryCustomerPendingDetails(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _cat1, string _cat2, string _cat3, string _item, string _brand, string _model, string _customer, string _userid, Int16 _cost)
        {   // Sanjeewa 29-09-2015
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[9] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("in_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;
            (param[13] = new OracleParameter("in_cost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _cost;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_del_conf_dtl", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetAddIntroduceCommision(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _Scheme, string _userid, string _promoter)
        {   // Nadeeka 25-Feb-2015
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Scheme;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;
            (param[7] = new OracleParameter("in_promoter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promoter;
            DataTable _tblData = QueryDataTable("tbl", "sp_get_introduce_commission", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetTrimAccountDetails(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _Scheme, string _userid)
        {   // Sanjeewa 19-03-2014
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Scheme;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_trim_acc_detail", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetLoyalityDiscountDetails(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _Loytp, string _custtp, string _userid)
        {   // Sanjeewa 20-03-2014
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_loytp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loytp;
            (param[6] = new OracleParameter("in_custtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custtp;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_loy_dis", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetCustomerAckLogDetails(DateTime _fdate, DateTime _tdate, string _Com, string _Pc, string _userid, string _accno)
        {   // Sanjeewa 21-03-2014
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;
            (param[6] = new OracleParameter("in_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;

            DataTable _tblData = QueryDataTable("tbl", "sp_get_log_cus_ackn", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetMovementSerials(string _docNo)
        {
            // Nadeeka 20-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_movment_serial", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetMovementSerials_wo_Ser(string _docNo)
        {
            // Sanjeewa 22-04-2017
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_movment_serial_wo_ser", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetMovementSerials_WithExpireDates(string _docNo)
        {
            // Wimal 16/04/2017
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_movment_Expiry_Date", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        public DataTable GetCaseQty(string _docNo)
        {
            //Wimal 14/03/2017
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_case_qty", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetVehicleNo(string _docNo)
        {
            //Wimal 14/03/2017
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_vehicle_no", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable Get_CustomerDetails(string _CustCode)
        {
            // Sanjeewa 05-08-2015 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cuscode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CustCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_customer_detail", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetPODetails(string _docNo)
        {
            // Sanjeewa 11-01-2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_podetails", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetLocationCode(string _comCode, string _locCode)
        {
            // Nadeeka 20-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        public DataTable GetItemCode(string _comCode, string _itmCode)
        {
            // Nadeeka 20-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "get_allitemdetails", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInvItemCode(string _invNo)
        {
            // Nadeeka 20-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_items", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetItemStatus(string _itmSts)
        {
            // Nadeeka 20-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_scm2status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSts;
            (param[1] = new OracleParameter("p_scmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getitemstatus", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        public DataTable GetReceiptType(string _recType)
        {
            // Nadeeka 28-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_recType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recType;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getreceipttype", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInsurance(string _accNo)
        {
            // Nadeeka 21-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_Insurance", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetHpAccCustomer(string _accNo)
        {
            // Nadeeka 21-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_customer", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetVehicalRegistrations(string _regNo)
        {
            // Nadeeka 21-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getvehicalregistration", CommandType.StoredProcedure, false, param);

            return tblDet;
        }
        public DataTable GetAdvanRecItems(string _recNo)
        {
            // Nadeeka 21-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getAdvanRecItems", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        public DataTable GetDeliverCustomer(string _invNo)
        {
            // Nadeeka 29-07-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getDeliverCustomer", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        public DataTable GetCustomerAccountBalance(string _account)
        {   // sp_getaccountbalsummery(p_account in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getaccountbalsummery", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetAccountTransfer(string _account)
        {
            //sp_getaccounttransfer(p_account in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getaccounttransfer", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetAccountCustomerTrasnfer(string _account)
        {
            //sp_accountcustomertransfer(p_account in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_accountcustomertransfer", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public List<PriceDetailRef> GetCombinePrice(string _book, string _level, string _item, decimal _qty, DateTime _date, string _customer, string _com, string _pc)
        {
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[5] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[7] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getcombineprices", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertWithPriceType);
            }

            return _priceDetailRef;

        }

        public DataTable GetAccountDiriyaDetail(string _account)
        {             //sp_getinitialdiriya(p_account in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getinitialdiriya", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public Int32 UpdateRecAutoNumber(string _receiptno, Int32 _receiptseqno, string _recTpNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[1] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            (param[2] = new OracleParameter("p_recTPNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recTpNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updaterecautonumber", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateRecAutoNumberTBS(string _receiptno, Int32 _receiptseqno, string _recTpNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[1] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            (param[2] = new OracleParameter("p_recTPNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recTpNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updaterecautonumbertbs", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetDelaerCommissionDetails(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_dealer_comm", CommandType.StoredProcedure, false, param);
            return _tblData;


        }

        public Int32 Save_mgr_rcv(string _com, string _pc, string _accno, string _recno, DateTime _dt, Decimal _amt, string _creby, string _rem)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_rmi_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_rmi_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_rmi_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[3] = new OracleParameter("p_rmi_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[4] = new OracleParameter("p_rmi_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[5] = new OracleParameter("p_rmi_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[6] = new OracleParameter("p_rmi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creby;
            (param[7] = new OracleParameter("p_rmi_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_mgr_rcv", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 UpdateItemCommission(decimal _amo, string _itm, string _inv)
        {

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_amo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amo;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_itm_comm", CommandType.StoredProcedure, param);
            return effects;

        }


        #region Hp Parameters
        public Int32 Save_hpr_sys_para(Hpr_SysParameter _paraheader)
        {

            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paraheader.Hsy_cd;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paraheader.Hsy_desc;
            (param[2] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paraheader.Hsy_pty_tp;
            (param[3] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paraheader.Hsy_pty_cd;
            (param[4] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _paraheader.Hsy_val;
            (param[5] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paraheader.Hsy_from_dt;
            (param[6] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paraheader.Hsy_to_dt;
            (param[7] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paraheader.Hsy_cre_by;
            (param[8] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paraheader.Hsy_cre_dt;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_hpr_sys_para", CommandType.StoredProcedure, param);
            return effects;

        }
        public List<Hpr_SysParameter> GetAll_hpr_Para(string code, string type, string value)
        {
            List<Hpr_SysParameter> _paraList = new List<Hpr_SysParameter>();
            //(p_hsy_cd in NVARCHAR2,p_pty_tp in NVARCHAR2,p_pty_cd in NVARCHAR2,p_date in DATE, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_hsy_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = value;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getAllsyspara", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _paraList = DataTableExtensions.ToGenericList<Hpr_SysParameter>(_tbl, Hpr_SysParameter.Converter);
            }

            return _paraList;

        }
        public DataTable Get_get_hpr_para_types(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "get_hpr_para_types", CommandType.StoredProcedure, false, param);
            return _tblData;


        }

        //kapila 1/8/2014
        public DataTable PrintNotRecManIssues(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "pkg_fin_reports.sp_print_not_rec_man_iss", CommandType.StoredProcedure, false, param);
            return _tblData;


        }

        public Int32 Delete_hpr_para_types(string code, string pc)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[3];
            //p_code in NVARCHAR2,p_pc in NVARCHAR2, o_effect OUT NUMBER
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_DELETE_hpr_para_types", CommandType.StoredProcedure, param);

            return effects;
        }

        //method belongs to Account Restriction
        public List<HpAccRestriction> GetAll_SavedAccountRestrictons(string pc, Int32 type)
        {
            List<HpAccRestriction> _list = null;
            //(p_pc in NVARCHAR2,p_type in NUMBER,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            // DataTable _tblData = QueryDataTable("tbl", "sp_getAllaccrestparam", CommandType.StoredProcedure, false, param); //commented on 16-04-2013

            DataTable _tblData = QueryDataTable("tbl", "sp_getAllValidAccRest", CommandType.StoredProcedure, false, param); //added on 16-04-2013
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpAccRestriction>(_tblData, HpAccRestriction.Converter);
            }
            return _list;

        }

        #endregion Hp Parameters


        public List<CashCommissionDetailRef> GetItemCashCommission(string _saltp, string _pc, DateTime _date, string _brand, string _Mcat, string _cat,
                                                                    string _itm, string _ser, string _pb, string _pblvl)
        {

            List<CashCommissionDetailRef> _Ref = new List<CashCommissionDetailRef>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saltp;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_mcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Mcat;
            (param[5] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[7] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[8] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[9] = new OracleParameter("p_pbLvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_itm_com_def", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _Ref = DataTableExtensions.ToGenericList<CashCommissionDetailRef>(_tbl, CashCommissionDetailRef.Converter);
            }

            return _Ref;


        }

        public List<HpSchemeDetails> GetSchemaByTypeCat(string _schtp, string _schcat)
        {

            List<HpSchemeDetails> _Ref = new List<HpSchemeDetails>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sch_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schcat;
            (param[1] = new OracleParameter("p_sch_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schtp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "get_sch_by_cat_type", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _Ref = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tbl, HpSchemeDetails.Converter);
            }

            return _Ref;

        }

        public Int32 SaveECDDefinition(EarlyClosingDiscount _ecd, string _pcList, string _pbList, string _pblvlList, string _schList)
        {
            OracleParameter[] param = new OracleParameter[29];
            Int16 effects;
            (param[0] = new OracleParameter("p_hed_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_tp;
            (param[1] = new OracleParameter("p_hed_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pty_tp;
            //(param[2] = new OracleParameter("p_hed_pty_cd", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_pty_cd;
            //(param[3] = new OracleParameter("p_hed_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_sch_cd;
            (param[2] = new OracleParameter("p_hed_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_from_dt;
            (param[3] = new OracleParameter("p_hed_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_to_dt;
            (param[4] = new OracleParameter("p_hed_from_pd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_from_pd;
            (param[5] = new OracleParameter("p_hed_to_pd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_to_pd;
            (param[6] = new OracleParameter("p_hed_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_val;
            (param[7] = new OracleParameter("p_hed_ecd_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_is_rt;
            (param[8] = new OracleParameter("p_hed_ecd_base", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_base;
            (param[9] = new OracleParameter("p_hed_eff_acc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_eff_acc_tp;
            (param[10] = new OracleParameter("p_hed_eff_cre_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_eff_cre_dt;
            (param[11] = new OracleParameter("p_hed_eff_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_eff_dt;
            (param[12] = new OracleParameter("p_hed_comit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_comit;
            //(param[15] = new OracleParameter("p_hed_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pb;
            //(param[16] = new OracleParameter("p_hed_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pb_lvl;
            (param[13] = new OracleParameter("p_hed_is_prt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.Hed_is_prt;
            (param[14] = new OracleParameter("p_hed_prt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_prt_dt;
            (param[15] = new OracleParameter("p_hed_prt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_prt_by;
            (param[16] = new OracleParameter("p_hed_is_use", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.Hed_is_use;
            (param[17] = new OracleParameter("p_hed_use_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_use_dt;
            (param[18] = new OracleParameter("p_hed_ecd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_val;
            (param[19] = new OracleParameter("p_hed_ecd_cls_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_cls_val;
            (param[20] = new OracleParameter("p_hed_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_acc_no;
            (param[21] = new OracleParameter("p_hed_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_vou_no;
            (param[22] = new OracleParameter("p_hed_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_cre_by;
            (param[23] = new OracleParameter("p_hed_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_cre_dt;

            (param[24] = new OracleParameter("p_pc_list", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcList;
            (param[25] = new OracleParameter("p_pb_list", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbList;
            (param[26] = new OracleParameter("p_pblvl_list", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvlList;
            (param[27] = new OracleParameter("p_sch_list", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schList;

            param[28] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_ecd_def", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<MasterExchangeRate> GetAll_ExchangeRates(string _com)
        {
            List<MasterExchangeRate> _paraRate = new List<MasterExchangeRate>();
            OracleParameter[] param = new OracleParameter[1];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getexratedetails", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _paraRate = DataTableExtensions.ToGenericList<MasterExchangeRate>(_tbl, MasterExchangeRate.Converter);
            }

            return _paraRate;

        }

        public Int32 SaveECDVoucher(ECDVoucher _vou, string _pcList, string _schList)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int16 effects;
            (param[0] = new OracleParameter("p_pc_list", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcList;
            (param[1] = new OracleParameter("p_sch_list", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schList;
            (param[2] = new OracleParameter("p_hvd_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vou.Hvd_from_dt;
            (param[3] = new OracleParameter("p_hvd_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vou.Hvd_to_dt;
            (param[4] = new OracleParameter("p_hvd_from_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vou.Hvd_from_bal;
            (param[5] = new OracleParameter("p_hvd_to_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vou.Hvd_to_bal;
            (param[6] = new OracleParameter("p_hvd_ecd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vou.Hvd_ecd_val;
            (param[7] = new OracleParameter("p_hvd_is_rt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vou.Hvd_is_rt;
            (param[8] = new OracleParameter("p_hvd_is_prc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vou.Hvd_is_prc;
            (param[9] = new OracleParameter("p_hvd_prc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vou.Hvd_prc_dt;
            (param[10] = new OracleParameter("p_hvd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou.Hvd_cre_by;
            (param[11] = new OracleParameter("p_hvd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vou.Hvd_cre_dt;


            param[12] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_ecd_vou_def", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetECDVoucherGeneratePc(string _com, DateTime _from)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_ecd_vou_pcs", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public DataTable GetECDNotPrintPcs(string _com, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_ecd_not_prt_pc", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public List<ECDVoucher> GetAlowEcdDefs(string _pc, DateTime _from)
        {

            List<ECDVoucher> _ecdList = new List<ECDVoucher>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_ecd_vou_alw_scs", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _ecdList = DataTableExtensions.ToGenericList<ECDVoucher>(_tbl, ECDVoucher.Converter);
            }

            return _ecdList;
        }


        public Int32 UpdateECDDefinition(string _vou, string _accno, decimal _val, int _seq)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[2] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            (param[3] = new OracleParameter("p_seq", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _seq;
            param[4] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);


            int effects = (Int16)UpdateRecords("sp_update_ecd_def", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 SaveECDDefinitionVoucher(EarlyClosingDiscount _ecd)
        {
            OracleParameter[] param = new OracleParameter[32];
            Int16 effects;
            OracleParameter parm = new OracleParameter();
            parm.CollectionType = OracleCollectionType.PLSQLAssociativeArray;

            (param[0] = new OracleParameter("p_hed_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_tp;
            (param[1] = new OracleParameter("p_hed_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pty_tp;
            (param[2] = new OracleParameter("p_hed_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pty_cd;
            (param[3] = new OracleParameter("p_hed_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_sch_cd;
            (param[4] = new OracleParameter("p_hed_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_from_dt;
            (param[5] = new OracleParameter("p_hed_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_to_dt;
            (param[6] = new OracleParameter("p_hed_from_pd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_from_pd;
            (param[7] = new OracleParameter("p_hed_to_pd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_to_pd;
            (param[8] = new OracleParameter("p_hed_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_val;
            (param[9] = new OracleParameter("p_hed_ecd_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_is_rt;
            (param[10] = new OracleParameter("p_hed_ecd_base", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_base;
            (param[11] = new OracleParameter("p_hed_eff_acc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_eff_acc_tp;
            (param[12] = new OracleParameter("p_hed_eff_cre_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_eff_cre_dt;
            (param[13] = new OracleParameter("p_hed_eff_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_eff_dt;
            (param[14] = new OracleParameter("p_hed_comit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_comit;
            (param[15] = new OracleParameter("p_hed_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pb;
            (param[16] = new OracleParameter("p_hed_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_pb_lvl;
            (param[17] = new OracleParameter("p_hed_is_prt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.Hed_is_prt;
            (param[18] = new OracleParameter("p_hed_prt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_prt_dt;
            (param[19] = new OracleParameter("p_hed_prt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_prt_by;
            (param[20] = new OracleParameter("p_hed_is_use", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.Hed_is_use;
            (param[21] = new OracleParameter("p_hed_use_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_use_dt;
            (param[22] = new OracleParameter("p_hed_ecd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_val;
            (param[23] = new OracleParameter("p_hed_ecd_cls_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecd.Hed_ecd_cls_val;
            (param[24] = new OracleParameter("p_hed_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_acc_no;
            (param[25] = new OracleParameter("p_hed_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_vou_no;
            (param[26] = new OracleParameter("p_hed_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ecd.Hed_cre_by;
            (param[27] = new OracleParameter("p_hed_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ecd.Hed_cre_dt;
            (param[28] = new OracleParameter("p_HED_IS_REDUCE_BAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.HED_IS_REDUCE_BAL;
            (param[29] = new OracleParameter("p_hed_noof_ac_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.HED_NOOF_AC_FRM;    //kapila 29/9/2015
            (param[30] = new OracleParameter("p_hed_noof_ac_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ecd.HED_NOOF_AC_TO;

            param[31] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_ecd_def_vou_new", CommandType.StoredProcedure, param);
            return effects;

        }


        //darshana 06-12-2012
        public List<InvoiceItemTax> GetInvItemTax(string _inv, string _itm, Int32 _line)
        {
            //sp_getitemtax   (p_com in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2 , p_taxcode in NVARCHAR2,p_taxratecode in NVARCHAR2, c_data  OUT sys_refcursor)
            List<InvoiceItemTax> _list = new List<InvoiceItemTax>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "getinvtaxdet", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceItemTax>(_tblData, InvoiceItemTax.ConvertTotal);
            }

            return _list;

        }

        public DataTable GetActiveAccountsFromScheme(string _com, string _pc, DateTime _cur, string _sch)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_Currentdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cur;
            (param[3] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_get_act_acc_sch", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetECDDefnSchemesFromPcsAndDates(DateTime _from, DateTime _to, string _pcList)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pcList", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcList;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_ecd_sch_pc", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetECDDefnRateFromPcAndSchmes(DateTime _from, DateTime _to, string _pcList, string _schList)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pcList", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcList;
            (param[3] = new OracleParameter("p_schList", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schList;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_ecd_rat_pc_sch", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetECDDefnVouFromPcAndSchAndRate(DateTime _from, DateTime _to, string _pcList, string _schList, string _rateList)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pcList", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcList;
            (param[3] = new OracleParameter("p_schList", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schList;
            (param[4] = new OracleParameter("p_rateList", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rateList;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_ecd_vou_pc_sch_rate", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public Int32 UpdateECDVoucherPrintStatus(string _vou)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects;
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            param[1] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_ecd_def", CommandType.StoredProcedure, param);
            return effects;

        }



        public MasterItemBrand GetItemBrand(string _cd)
        {

            MasterItemBrand _brand = new MasterItemBrand();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "get_branddetails", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _brand = DataTableExtensions.ToGenericList<MasterItemBrand>(_tblBrand, MasterItemBrand.Converter)[0];
            }
            return _brand;
        }


        public DataTable GetInvoiceDocumentDefinition(string _company, string _profitCenter, string _invType)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invType;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDefinition = QueryDataTable("tblPriceDefinition", "sp_checkValidInvoiceType", CommandType.StoredProcedure, false, param);

            return _tblPriceDefinition;
        }

        public List<RecieptHeader> GetRecieptHeaderByTypeAndAccNo(string _com, string _pc, string _type, string _accno)
        {

            List<RecieptHeader> _recList = new List<RecieptHeader>();
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_reciept_accno_type", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                _recList = DataTableExtensions.ToGenericList<RecieptHeader>(_tbl, RecieptHeader.ConvertTotal);
            }
            return _recList;
        }

        public PriceBookLevelRef GetPriceLevelForHp(string _company, string _book, string _level, string _stus)
        {
            PriceBookLevelRef _priceBookLevelRef = new PriceBookLevelRef();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceLevel = QueryDataTable("tblPl", "sp_getpricelevelforhp", CommandType.StoredProcedure, false, param);
            if (_tblPriceLevel.Rows.Count > 0)
            {
                _priceBookLevelRef = DataTableExtensions.ToGenericList<PriceBookLevelRef>(_tblPriceLevel, PriceBookLevelRef.ConvertTotal)[0];
            }

            return _priceBookLevelRef;
        }

        public List<HpAccount> GetAccByCustType(string _com, string _cust, string _custTP)
        {
            List<HpAccount> _accList = new List<HpAccount>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[2] = new OracleParameter("p_custTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custTP;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getaccbycust", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                _accList = DataTableExtensions.ToGenericList<HpAccount>(_tbl, HpAccount.Converter);
            }
            return _accList;
        }

        //kapila 2/1/2013
        public DataTable GetGlobDebtAgeOuts(string _user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_glob_debt_age", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        //kapila 4/1/2013
        public DataTable GetGlobDebtSettle(string _user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_debt_set", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        //kapila 4/1/2013
        public DataTable GetTempPCLoc(string _user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_temp_pc_loc", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        #region AC Services Job

        public DataTable GetInvoiceServiceItemSerDet(string invoiceNo, string serialID)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_serialID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialID;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "get_invoiceServiceItmDet", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable Get_all_jobTypes(string com, string sev_chanel)
        {
            //(p_com in NVARCHAR2, p_chanel In NVARCHAR2,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sev_chanel;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_all_jobTypes", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable Get_item_servicChargeInfo(string itmeCd, string serviceType)
        {
            //(p_itemCd in NVARCHAR2, p_sevTp in NVARCHAR2,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_itemCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmeCd;
            (param[1] = new OracleParameter("p_sevTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serviceType;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_item_servicChargeInfo", CommandType.StoredProcedure, false, param);

            return _tbl;

        }

        public ServiceJobHeader Get_AC_JobHeaderOnDet(string jobno, string jobStatus)
        {
            //(p_itemCd in NVARCHAR2, p_sevTp in NVARCHAR2,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            (param[1] = new OracleParameter("p_jobStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobStatus;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_AC_JobHeaderOnDet", CommandType.StoredProcedure, false, param);


            //  DataTable _tblPriceLevel = QueryDataTable("tblPl", "sp_getpricelevelforhp", CommandType.StoredProcedure, false, param);
            ServiceJobHeader jh = null;
            if (_tbl.Rows.Count > 0)
            {
                jh = DataTableExtensions.ToGenericList<ServiceJobHeader>(_tbl, ServiceJobHeader.Converter)[0];
            }

            return jh;

        }

        public Int32 sp_save_sev_costsheet(ServiceCostSheet costsheet)
        {
            OracleParameter[] param = new OracleParameter[43];
            Int32 effects;
            //TODO: CHECK PARAMETER TYPES.
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_jobno;
            (param[1] = new OracleParameter("p_joblineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_joblineno;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_line;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_com;
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_loc;
            (param[5] = new OracleParameter("p_jobitmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_jobitmcd;
            (param[6] = new OracleParameter("p_jobitmser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_jobitmser;
            (param[7] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_itmcd;
            (param[8] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_itmstus;
            (param[9] = new OracleParameter("p_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_uom;
            (param[10] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_qty;
            (param[11] = new OracleParameter("p_direc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_direc;
            (param[12] = new OracleParameter("p_unitcost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_unitcost;
            (param[13] = new OracleParameter("p_totunitcost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_totunitcost;
            (param[14] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_doctp;
            (param[15] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_docno;
            (param[16] = new OracleParameter("p_docdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = costsheet.Scs_docdt;
            (param[17] = new OracleParameter("p_outdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_outdocno;
            (param[18] = new OracleParameter("p_outdocline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_outdocline;
            (param[19] = new OracleParameter("p_movelineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_movelineno;
            (param[20] = new OracleParameter("p_itmtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_itmtp;
            (param[21] = new OracleParameter("p_itmdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_itmdesc;
            (param[22] = new OracleParameter("p_cuscd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_cuscd;
            (param[23] = new OracleParameter("p_cusname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_cusname;
            (param[24] = new OracleParameter("p_docqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_docqty;
            (param[25] = new OracleParameter("p_balqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_balqty;
            (param[26] = new OracleParameter("p_isfoc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_isfoc;
            (param[27] = new OracleParameter("p_jobconfno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_jobconfno;
            (param[28] = new OracleParameter("p_isinvoice", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_isinvoice;
            (param[29] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_invoiceno;
            (param[30] = new OracleParameter("p_jobitmwarr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_jobitmwarr;
            (param[31] = new OracleParameter("p_isrevitm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_isrevitm;
            (param[32] = new OracleParameter("p_jobclose", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_jobclose;
            (param[33] = new OracleParameter("p_consumablecd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_consumablecd;
            (param[34] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_act;
            (param[35] = new OracleParameter("p_oldline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = costsheet.Scs_oldline;
            (param[36] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_anal1;
            (param[37] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_anal2;
            (param[38] = new OracleParameter("p_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_anal3;
            (param[39] = new OracleParameter("p_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = costsheet.Scs_anal4;
            (param[40] = new OracleParameter("p_anal5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_anal5;
            (param[41] = new OracleParameter("p_anal6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = costsheet.Scs_anal6;

            param[42] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_sev_costsheet", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<ServiceCostSheet> Get_Sev_CostSheets(string jobno)
        {
            //(p_itemCd in NVARCHAR2, p_sevTp in NVARCHAR2,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_Sev_CostSheets", CommandType.StoredProcedure, false, param);
            List<ServiceCostSheet> _List = null;
            if (_tbl.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<ServiceCostSheet>(_tbl, ServiceCostSheet.Converter);
            }
            return _List;
        }

        public DataTable Get_AC_chargeItem_VAT(string com, string chgItemCd, DateTime date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_chgItemCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chgItemCd;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_vatDetOf_AC_Charges", CommandType.StoredProcedure, false, param);

            return _tbl;

        }
        public Int32 Update_AC_jobStatus(string jobNo, string status, string modifyBy, DateTime modifyDt)
        {
            //(p_jobno in NVARCHAR2,p_status in NVARCHAR2,p_modBy in NVARCHAR2,p_modDt in Date,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[2] = new OracleParameter("p_modBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifyBy;
            (param[3] = new OracleParameter("p_modDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = modifyDt;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            int effects = (Int16)UpdateRecords("SP_Update_AcJobStatus", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_AC_Job_Claimed_Paid(string jobNo, Int32 lineNo, Decimal new_amount)
        {
            //(p_jobNo in NVARCHAR2,p_line in NUMBER,p_amount in NUMBER,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNo;
            (param[2] = new OracleParameter("p_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = new_amount;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            int effects = (Int16)UpdateRecords("SP_Update_Claimed_Paid", CommandType.StoredProcedure, param);
            return effects;
        }


        public List<ServiceJobDetail> Get_Sev_JobDet(string jobno)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            List<ServiceJobDetail> _List = null;

            DataTable _tbl = QueryDataTable("tbl", "sp_get_JobDet", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<ServiceJobDetail>(_tbl, ServiceJobDetail.Converter);

            }

            return _List;
        }
        public Decimal Get_MaxAC_ClaimRate(string hsyCD, string parytyTP, string partyCD, DateTime currentDt)
        {
            OracleParameter[] param = new OracleParameter[3];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_hsy_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsyCD;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = parytyTP;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCD;
            OracleParameter _outParam = new OracleParameter("c_maxAmt", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("get_maxAC_claimRate", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }
        public Int32 SaveJobShedule(ServiceJobShedule shed)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects;
            // (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = shed.Svjs_seq;					
            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = shed.Svjs_inv_no;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = shed.Svjs_itm;
            (param[2] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = shed.Svjs_ser_id;
            (param[3] = new OracleParameter("p_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = shed.Svjs_term;
            (param[4] = new OracleParameter("p_shed_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = shed.Svjs_shed_dt;
            (param[5] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = shed.Svjs_job_no;
            (param[6] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = shed.Svjs_stus;
            (param[7] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = shed.Svjs_cre_by;
            (param[8] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = shed.Svjs_cre_dt;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_jobShedule", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable Get_AC_jobItem_shedule(string serialID)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialID;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "get_AC_jobItem_shedule", CommandType.StoredProcedure, false, param);

            return _tbl;

        }
        public Int32 Update_AC_jobItem_shedule(string itemCd, string serialID, string job_no, Boolean stuts)
        {

            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCd;
            (param[1] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialID;
            (param[2] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = job_no;
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = stuts == true ? 1 : 0;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_ACJobShedule", CommandType.StoredProcedure, param);
            return effects;
        }

        //27-02-2013 darshana
        public Int32 Update_Job_Base_Details(string invNo, string itmCD, string serial, Int32 stuts, string _loc, Int32 _com, DateTime _jobDate, string _jobNo)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _com;
            //Modified by Prabhath on 01/06/2013    (param[1] = new OracleParameter("p_job_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDate.ToShortDateString();
            (param[1] = new OracleParameter("p_job_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDate.Date;
            (param[2] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = stuts;
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCD;
            (param[7] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_job_base_det", CommandType.StoredProcedure, param);
            return effects;
        }


        //22-01-2013
        public DataTable GetInvoiceServiceItemSerDet_POS(string invoiceNo, string serialNo)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_serialNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "get_invoiceServiceItmDet_POS", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        //darshana 26-02-2013
        public DataTable GetInvoiceServiceItemSerDet_Oth(string invoiceNo, string serialNo)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_serialNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "get_invoiceserviceitmdet_oth", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable Get_item_servicChargeInfo_New(string itmeCd, string serviceType, string seviceItemCode)
        {
            //(p_itemCd in NVARCHAR2, p_sevTp in NVARCHAR2,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_itemCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmeCd;
            (param[1] = new OracleParameter("p_sevTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serviceType;
            (param[2] = new OracleParameter("p_sevItmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seviceItemCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_item_servicChargeInfoNew", CommandType.StoredProcedure, false, param);

            return _tbl;

        }
        #endregion  AC Services Job

        //darshana 04-01-2013
        public MasterBusinessEntity GetCustomerProfileByCom(string CustCD, string nic, string DL, string PPNo, string brNo, string com)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getCustomerProfileByCom", CommandType.StoredProcedure, false, param);

            MasterBusinessEntity bizEnt = new MasterBusinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }
            return bizEnt;
        }

        public MasterBusinessEntity GetCustomerProfileByNIC(string nic)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getcustbynic", CommandType.StoredProcedure, false, param);

            MasterBusinessEntity bizEnt = new MasterBusinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }
            return bizEnt;
        }

        //sachith 2013/01/11
        public int UpdateCoverNoteAndIsApp(string acc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            int effects = (Int16)UpdateRecords("sp_updatecovernote_isapp", CommandType.StoredProcedure, param);
            return effects;
        }

        #region ReportSp
        //written by Nadeeka 11/01/2013
        public DataTable ReceivableMovemntReport(DateTime _fromDate, DateTime _toDate, string _user, string _pc, string _company, Int16 _isSum)
        {

            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Profitcenter_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[6] = new OracleParameter("is_Summary", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isSum;


            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.proc_receivable_movements", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 11/01/2013
        public DataTable CollectionSummaryReport(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _pc, string _mgrcd)
        {

            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_mgrcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mgrcd;


            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_COLLECTION_REPORT_NEW", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 11/01/2013
        public DataTable TransactionVarienceReport(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _loc)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;


            DataTable _dtResults = QueryDataTable("tbl", "pkg_inv_reports.PROC_TRANS_VARIANCE", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 18/02/2013
        public DataTable CollectionSummaryReport_other(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _pc)
        {

            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;//Added by Prabhath on 09/11/2013

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_COLLECTION_OTHER", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //written by Nadeeka 11/01/2013
        public DataTable CollectionSummaryReportECD(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _pc)
        {

            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_COLLECTION_ECD", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable CollectionSummaryReport_otherCol(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _pc)
        {

            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;//Added by Prabhath on 09/11/2013

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_COLLECTION_OTHER_COL", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable HPDebitCreditRep(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _PC)
        {

            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("in_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PC;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_CR_DR_REPORT", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 13/02/2013
        public DataTable HPInsuranceReport(DateTime _fromDate, DateTime _toDate, string _user, string _company, string _LOC)
        {

            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[5] = new OracleParameter("in_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LOC;
            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_INSURANCE", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 22/02/2013
        public DataTable HPExcessShortReport(DateTime _fromDate, string _user, string _company, string _PC)
        {

            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PC;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_EXCESS_SHORT_REPORT", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        //written by Nadeeka 11/01/2013
        public DataTable GPInsuranceFundReport(DateTime _fromDate, string _user, string _company, string _LOC, Int16 _isSum)
        {

            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[4] = new OracleParameter("in_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LOC;
            (param[5] = new OracleParameter("in_SUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _isSum;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_INSURANCE_FUND_NEW", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable GetSalesSubTypeTable(string _type, string _stype)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_sType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stype;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getSalesSubType", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetItemByJobRegNo(string _regNo)
        {   // kapila 19/5/2017
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_by_regno", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //written by Nadeeka 06/02/2013
        public DataTable HPCashFlowForecastingReport(DateTime _fromDate, string _user, string _company, string _pc)
        {

            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            //Added by Prabhath on 09/11/2013 (in_pc)
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_hp_sales_scm2.PROC_HS_FORECASTING", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //written by Nadeeka 06/09/2013
        public DataTable getReturnChequeSettlemts(DateTime _AsAtDate, string _user_id, string _company, string _loc)
        {

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _AsAtDate.Date;
            (param[1] = new OracleParameter("p_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tbl", "sp_getReurnChequeSettlements", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 06/09/2013
        public DataTable getReturnChequePayments(DateTime _AsAtDate, string _RetNo)
        {

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _AsAtDate.Date;
            (param[1] = new OracleParameter("p_retno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RetNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tbl", "sp_getReurnChequeSett", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        //written by Nadeeka 17/10/2013
        public DataTable getSalesGiftVouchaer(string _InvNo)
        {

            OracleParameter[] param = new OracleParameter[2];


            (param[0] = new OracleParameter("p_INV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tbl", "sp_getSalesGiftvouchar", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 06/09/2013
        public DataTable getReturnChequeSettlemtsDetails(DateTime _FromDate, DateTime _ToDate, string _user_id, string _company, string _Pc)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_fDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate.Date;
            (param[1] = new OracleParameter("p_tDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate.Date;
            (param[2] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("p_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getReurnChequeSett_Details1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //written by Nadeeka 16/09/2013
        public DataTable getDailyExpences(DateTime _FromDate, DateTime _ToDate, string _user_id, string _company, string _code, string _pc)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_fDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate.Date;
            (param[1] = new OracleParameter("p_tDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate.Date;
            (param[2] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getDialyExpences", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        //written by Nadeeka 06/09/2013
        public DataTable getReturnChequeBank(string _Bank)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bank;



            DataTable _dtResults = QueryDataTable("tbl", "sp_getbankName", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //written by Nadeeka 06/09/2013
        public DataTable getReturnChequeLocHigh(string _Com, string _Type, string _Code)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[2] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            (param[3] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;

            DataTable _dtResults = QueryDataTable("tbl", "sp_gethierarchyDesc", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }


        #endregion

        //darshana on 14-01-2013
        public Int32 SaveReceiptItemDetails(Int32 _seq, Int32 _line, string _rec, string _itm, string _desc, string _model, string _serial, string _serial1, string _user, Decimal _qty, string _pb, string _pblvl, Decimal _unitrate, Decimal _taxAmt, decimal _unitAmt, string _status, string _promo, Decimal _resqty = 0, bool _itemRes = false)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sari_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_sari_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            (param[2] = new OracleParameter("p_sari_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[3] = new OracleParameter("p_sari_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_sari_item_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[5] = new OracleParameter("p_sari_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("p_sari_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[7] = new OracleParameter("p_sari_serial_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[8] = new OracleParameter("p_sari_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[9] = new OracleParameter("p_sari_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[10] = new OracleParameter("p_sari_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[11] = new OracleParameter("p_sari_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            (param[12] = new OracleParameter("p_sari_unit_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _unitrate;
            (param[13] = new OracleParameter("p_sari_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _taxAmt;
            (param[14] = new OracleParameter("p_sari_unit_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _unitAmt;
            (param[15] = new OracleParameter("p_sari_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[16] = new OracleParameter("p_sari_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[17] = new OracleParameter("p_SARI_RES_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _resqty;
            (param[18] = new OracleParameter("p_SARI_IS_RES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (_itemRes == false ? 0 : 1);
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_satreceiptitemdetails", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 16-01-2013
        public Int16 UpdateCancelInvoiceSettleAmt(string _com, string _pc, string _cus, string _inv, decimal _amt)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatecanceloutstandingamt", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 16-01-2013
        public Int16 UpdateCancelInvoiceSettleAmtTBS(string _com, string _pc, string _cus, string _inv, decimal _amt)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatecanceloutstandingamtt", CommandType.StoredProcedure, param);
            return effects;
        }

        //darhsna 17/01/2013
        public DataTable Process_Hp_Closing_Bal(string _com, string _user, string _schTp, string _schCD, DateTime _asAT)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_userName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_schTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schTp;
            (param[3] = new OracleParameter("p_schCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCD;
            (param[4] = new OracleParameter("p_asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAT.Date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_closing_bal_rep", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //darhsna 17/01/2013
        public DataTable Process_Hp_Closing_Bal_New(string _com, string _user, string _schTp, string _schCD, DateTime _asAT, string _pc, string _cat1, string _cat2, string _cat3, string _item, string _brand, string _model)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_userName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_schTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schTp;
            (param[3] = new OracleParameter("p_schCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCD;
            (param[4] = new OracleParameter("p_asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAT.Date;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[7] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;

            _dtResults = QueryDataTable("tbl", "sp_get_closing_bal_rep_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetMonthlyDue(string _account)
        {
            // sp_getmonthlydue (  p_account IN NVARCHAR2,c_data  OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getmonthlydue", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateRevertForRelease(string _account, string _rvtno, decimal _settlment, decimal _ecdamt, decimal _balance, string _user, DateTime _date)
        {
            //sp_updaterevert_torelease(p_account in NVARCHAR2,p_rvtno in NVARCHAR2,p_settlement in NUMBER,p_earlyclsdis in NUMBER,p_balance in NUMBER,p_user in NVARCHAR2,p_date in DATE ,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[1] = new OracleParameter("p_rvtno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rvtno;
            (param[2] = new OracleParameter("p_settlement", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _settlment;
            (param[3] = new OracleParameter("p_earlyclsdis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ecdamt;
            (param[4] = new OracleParameter("p_balance", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _balance;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterevert_torelease", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateAccountLogforRvtNRls(string _account, string _profitcenter, string _company, DateTime _date, string _status, string _updateType)
        {
            //sp_updateaccountlog(p_account in NVARCHAR2,p_pc in NVARCHAR2,p_com in NVARCHAR2,p_date in date,p_status in NVARCHAR2,p_updatetype in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_updatetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateType;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateaccountlog", CommandType.StoredProcedure, param);
            return effects;

        }


        public int SaveBlackListCustomer(BlackListCustomers _customer)
        {
            // sp_saveblacklistcustomer(
            //p_cust_cd in hpr_black_list.hbl_cust_cd%type,
            //p_dt in hpr_black_list.hbl_dt%type,
            //p_rmv_dt  in hpr_black_list.hbl_rmv_dt%type,
            //p_def_val   in hpr_black_list.hbl_def_val%type,
            //p_cls_bal   in hpr_black_list.hbl_cls_bal%type,
            //p_rmk    in hpr_black_list.hbl_rmk%type,
            //p_act in hpr_black_list.hbl_act%type,
            //p_cre_by  in hpr_black_list.hbl_cre_by%type,
            //p_cre_dt  in hpr_black_list.hbl_cre_dt%type,
            //p_com  in hpr_black_list.hbl_com%type,
            //p_pc in hpr_black_list.hbl_pc%type,
            //o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer.Hbl_cust_cd;
            (param[1] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _customer.Hbl_dt;
            (param[2] = new OracleParameter("p_rmv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _customer.Hbl_rmv_dt;
            (param[3] = new OracleParameter("p_def_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _customer.Hbl_def_val;
            (param[4] = new OracleParameter("p_cls_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _customer.Hbl_cls_bal;
            (param[5] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer.Hbl_rmk;
            (param[6] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _customer.Hbl_act;
            (param[7] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer.Hbl_cre_by;
            (param[8] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _customer.Hbl_cre_dt;
            (param[9] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer.Hbl_com;
            (param[10] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer.Hbl_pc;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_saveblacklistcustomer", CommandType.StoredProcedure, param);
            return effects;

        }

        //darshana 22/10/2012
        public List<RequestApprovalHeader> getPendingReqbyType(string _com, string _pc, string _type, string _user, string _selectPC)
        {
            List<RequestApprovalHeader> _list = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_selectPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _selectPC;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getpendingreqbytype", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_tblData, RequestApprovalHeader.Converter);
            }
            return _list;
        }

        //darshana 04-01-2013
        public SystemAppLevelParam CheckApprovePermission(string type, string user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_checkapppermission", CommandType.StoredProcedure, false, param);

            SystemAppLevelParam bizEnt = new SystemAppLevelParam();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<SystemAppLevelParam>(_dtResults, SystemAppLevelParam.Converter)[0];
            }
            return bizEnt;
        }
        public int ReleaseBlackListCustomer(string _customer, string _company, string _profitcenter, string _isheadofficelevel)
        {
            // sp_releaseblacklist(p_customer in NVARCHAR2,p_com in NVARCHAR2,p_pc in NVARCHAR2,p_ishd in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[3] = new OracleParameter("p_ishd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _isheadofficelevel;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_releaseblacklist", CommandType.StoredProcedure, param);
            return effects;

        }

        //kapila 23/01/2013
        public DataTable GetPC_from_Hierachy_Rep(string user, string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[3] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[4] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[5] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[6] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pc_onHierachy_Rep", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 24/01/2013
        public DataTable GetLoc_from_Hierachy_Rep(string user, string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[3] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[4] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[5] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[6] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_loc_onHierachy_Rep", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 07/03/2013
        public DataTable GetLoc_from_Hierachy_Rep_all(string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_loc_onHierachy_Rep_all", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //written by darshana 24/01/2013
        public List<InvoiceItem> GetInvoiceDetailsForReversal(string _inv, string _tp)
        {
            List<InvoiceItem> _invoiceitem = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getinvdetailsforreversal", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItemForReversal);
            }

            return _invoiceitem;
        }

        //written by Chamal 30/04/2014
        public List<InvoiceItem> GetInvoiceDetailsForIntrPRN(string _inv, string _tp, string _baseDoc)
        {
            List<InvoiceItem> _invoiceitem = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[2] = new OracleParameter("p_bsdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseDoc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getinvdetailsforprn", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItemForReversal);
            }

            return _invoiceitem;
        }

        //written by Chamal 29/04/2014
        public List<InvoiceItem> GetInvoiceDetailsForReversalSCM(string _inv, string _tp, string _baseDoc)
        {
            List<InvoiceItem> _invoiceitem = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[2] = new OracleParameter("p_bsdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseDoc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getinvdetailsforreversalscm", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItemForReversal);
            }

            return _invoiceitem;
        }


        //written by darshana on 28-01-2013
        public Int32 UpdateRequestCloseStatus(string _com, string _pc, string _type, string _refNo, string _stus, string _user)
        {
            //sp_updateaccountlog(p_account in NVARCHAR2,p_pc in NVARCHAR2,p_com in NVARCHAR2,p_date in date,p_status in NVARCHAR2,p_updatetype in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_req_close_status", CommandType.StoredProcedure, param);
            return effects;

        }

        //kapila 2/10/2015
        public Int32 UpdateReqDetStus(string _refNo)
        {
            //sp_updateaccountlog(p_account in NVARCHAR2,p_pc in NVARCHAR2,p_com in NVARCHAR2,p_date in date,p_status in NVARCHAR2,p_updatetype in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_upd_req_det_status", CommandType.StoredProcedure, param);
            return effects;

        }

        //written by darshana 29/01/2013
        public List<InvoiceItem> GetRevDetailsFromRequest(string _inv, string _tp, string _com, string _pc, string _reqNo)
        {
            List<InvoiceItem> _invoiceitem = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getrevdetfromreq", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _invoiceitem = DataTableExtensions.ToGenericList<InvoiceItem>(_tblInvoiceItem, InvoiceItem.ConvertInvoiceItemForReversal);
            }
            return _invoiceitem;
        }

        public List<RecieptHeader> GetReceiptHdr(string _doc)
        {

            List<RecieptHeader> _ReceiptHdr = new List<RecieptHeader>();
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_getreceipt", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _ReceiptHdr = DataTableExtensions.ToGenericList<RecieptHeader>(_tblData, RecieptHeader.ConvertTotal);
            }
            return _ReceiptHdr;
        }

        public List<RecieptHeader> GetReceiptHdrByAnal3(string _receiptNo, string _pc, string _com)
        {

            List<RecieptHeader> _ReceiptHdr = new List<RecieptHeader>();
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "SP_GETRECEIPTBY_ANAL3", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _ReceiptHdr = DataTableExtensions.ToGenericList<RecieptHeader>(_tblData, RecieptHeader.ConvertTotal);
            }
            return _ReceiptHdr;
        }

        public Int16 UpdateInvoiceRevStatus(string _invno)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_invchdrrevstus", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateBusDesig(string _code, string _rmk)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_upd_bus_desig", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateInvoiceRevNo(string _invno, string _srnno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_srn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _srnno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inv_rev_no", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateAccountInv(string _invno, string _acc)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_hp_account_inv", CommandType.StoredProcedure, param);
            return effects;
        }



        public CollectionBonusDefinition GetCollectionBonus(decimal _arrFrom, decimal _arrTo, int _locFrom, int _locTo)
        {

            CollectionBonusDefinition _colBonus = null;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_arr_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _arrFrom;
            (param[1] = new OracleParameter("p_arr_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _arrTo;
            (param[2] = new OracleParameter("p_loc_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _locFrom;
            (param[3] = new OracleParameter("p_loc_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _locTo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_col_bon_def", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _colBonus = DataTableExtensions.ToGenericList<CollectionBonusDefinition>(_tblData, CollectionBonusDefinition.Converter)[0];
            }
            return _colBonus;

        }

        public int SaveCollectionBonusDefinition(CollectionBonusDefinition _col)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hcbd_ars_per_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _col.Hcbd_ars_per_from;
            (param[1] = new OracleParameter("p_hcbd_ars_per_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _col.Hcbd_ars_per_to;
            (param[2] = new OracleParameter("p_hcbd_year_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_year_from;
            (param[3] = new OracleParameter("p_hcbd_year_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_year_to;
            (param[4] = new OracleParameter("p_hcbd_bon_per", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_bon_per;
            (param[5] = new OracleParameter("p_hcbd_bon_add_per", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_bon_add_per;
            (param[6] = new OracleParameter("p_hcbd_contu_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_contu_month;
            (param[7] = new OracleParameter("p_hcbd_avg_acc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_avg_acc;
            (param[8] = new OracleParameter("p_hcbd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _col.Hcbd_cre_by;
            (param[9] = new OracleParameter("p_hcbd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _col.Hcbd_cre_dt;
            (param[10] = new OracleParameter("p_hcbd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _col.Hcbd_mod_by;
            (param[11] = new OracleParameter("p_hcbd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _col.Hcbd_mod_dt;
            param[12] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_col_bonus", CommandType.StoredProcedure, param);
            return effects;
        }

        public int UpdateCollectionBonus(CollectionBonusDefinition _col, decimal _arsFrom, decimal _arsTo, int _locFrom, int _locTo)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hcbd_ars_per_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _col.Hcbd_ars_per_from;
            (param[1] = new OracleParameter("p_hcbd_ars_per_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _col.Hcbd_ars_per_to;
            (param[2] = new OracleParameter("p_hcbd_year_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_year_from;
            (param[3] = new OracleParameter("p_hcbd_year_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_year_to;
            (param[4] = new OracleParameter("p_hcbd_bon_per", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_bon_per;
            (param[5] = new OracleParameter("p_hcbd_bon_add_per", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_bon_add_per;
            (param[6] = new OracleParameter("p_hcbd_contu_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_contu_month;
            (param[7] = new OracleParameter("p_hcbd_avg_acc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _col.Hcbd_avg_acc;
            (param[8] = new OracleParameter("p_hcbd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _col.Hcbd_mod_by;
            (param[9] = new OracleParameter("p_hcbd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _col.Hcbd_mod_dt;

            (param[10] = new OracleParameter("p_arr_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _arsFrom;
            (param[11] = new OracleParameter("p_arr_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _arsTo;
            (param[12] = new OracleParameter("p_loc_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _locFrom;
            (param[13] = new OracleParameter("p_loc_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _locTo;

            param[14] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_col_bonus", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<CollectionBonusDefinition> GetAllCollectionBonusDefinition()
        {
            List<CollectionBonusDefinition> _colBonus = null;
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbl", "sp_get_all_col_bon_def", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _colBonus = DataTableExtensions.ToGenericList<CollectionBonusDefinition>(_tblData, CollectionBonusDefinition.Converter);
            }
            return _colBonus;
        }

        public int SaveManagerCreation(ManegerCreation mgr)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_hmfa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_com;
            (param[1] = new OracleParameter("p_hmfa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_pc;
            (param[2] = new OracleParameter("p_hmfa_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_mgr_cd;
            (param[3] = new OracleParameter("p_hmfa_acc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_acc_dt;
            (param[4] = new OracleParameter("p_hmfa_bonus_st_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_bonus_st_dt;
            (param[5] = new OracleParameter("p_hmfa_sr_open_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_sr_open_dt;
            (param[6] = new OracleParameter("p_hmfa_act_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mgr.Hmfa_act_stus;
            (param[7] = new OracleParameter("p_hmfa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_cre_by;
            (param[8] = new OracleParameter("p_hmfa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_cre_dt;
            (param[9] = new OracleParameter("p_hmfa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_mod_by;
            (param[10] = new OracleParameter("p_hmfa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_mod_dt;
            param[11] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_save_mgr_creation", CommandType.StoredProcedure, param);

            return effect;
        }

        public DataTable GetManagerCreation(string _com, string _pc, string _mgr)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mgr;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbl", "sp_get_mgr_cre", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public int UpdateManagerCreation(ManegerCreation mgr)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_hmfa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_com;
            (param[1] = new OracleParameter("p_hmfa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_pc;
            (param[2] = new OracleParameter("p_hmfa_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_mgr_cd;
            (param[3] = new OracleParameter("p_hmfa_acc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_acc_dt;
            (param[4] = new OracleParameter("p_hmfa_bonus_st_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_bonus_st_dt;
            (param[5] = new OracleParameter("p_hmfa_sr_open_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_sr_open_dt;
            (param[6] = new OracleParameter("p_hmfa_act_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mgr.Hmfa_act_stus;
            (param[7] = new OracleParameter("p_hmfa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_cre_by;
            (param[8] = new OracleParameter("p_hmfa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_cre_dt;
            (param[9] = new OracleParameter("p_hmfa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr.Hmfa_mod_by;
            (param[10] = new OracleParameter("p_hmfa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mgr.Hmfa_mod_dt;
            param[11] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_save_mgr_creation", CommandType.StoredProcedure, param);

            return effect;
        }

        //kapila 11/2/2013 
        public DataTable GetPC_from_Hierachy_Rep_all(string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pc_onHierachy_Rep_All", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Nadeeka 19-05-2015
        public DataTable GetPC_from_Hierachy_SubChannel(string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pc_onHierachy_SubChal", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public List<InvoiceItem> GetInterTransferInvoice(string _invoice)
        {
            //sp_getintertransinvoice(p_invoice in NVARCHAR2,c_data out sys_refcursor)
            List<InvoiceItem> _lst = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getintertransinvoice", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _lst = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertTotal);
            }
            return _lst;
        }


        public int DeleteManager(string _com, string _pc, string _mgr)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_hmfa_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mgr;
            (param[1] = new OracleParameter("p_hmfa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_hmfa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            param[3] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_deletemanager", CommandType.StoredProcedure, param);
            return effect;
        }

        public int SaveDisregardValueDefinition(DisregardValueDefinition val)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_hdvr_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val.Hdvr_from_val;
            (param[1] = new OracleParameter("p_hdvr_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val.Hdvr_to_val;
            (param[2] = new OracleParameter("p_hdvr_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val.Hdvr_val;
            (param[3] = new OracleParameter("p_hdvr_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = val.Hdvr_tp;
            (param[4] = new OracleParameter("p_hdvr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = val.Hdvr_cre_by;
            (param[5] = new OracleParameter("p_hdvr_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = val.Hdvr_cre_dt;
            (param[6] = new OracleParameter("p_hdvr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = val.Hdvr_mod_by;
            (param[7] = new OracleParameter("p_hdvr_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = val.Hdvr_mod_dt;
            param[8] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_save_disr_val", CommandType.StoredProcedure, param);

            return effect;
        }


        public int UpdateDisregardValueDefinition(DisregardValueDefinition val, decimal _from, decimal _to, decimal _val, int _type)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_hdvr_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val.Hdvr_from_val;
            (param[1] = new OracleParameter("p_hdvr_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val.Hdvr_to_val;
            (param[2] = new OracleParameter("p_hdvr_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val.Hdvr_val;
            (param[3] = new OracleParameter("p_hdvr_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = val.Hdvr_tp;
            (param[4] = new OracleParameter("p_hdvr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = val.Hdvr_mod_by;
            (param[5] = new OracleParameter("p_hdvr_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = val.Hdvr_mod_dt;

            (param[6] = new OracleParameter("p_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _from;
            (param[7] = new OracleParameter("p_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _to;
            (param[8] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            (param[9] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;

            param[10] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_update_disr_val", CommandType.StoredProcedure, param);

            return effect;
        }

        public List<DisregardValueDefinition> GetDisregardValueDefinitiom(decimal _from, decimal _to, decimal _value, int _type, string _select)
        {

            List<DisregardValueDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _value;
            (param[3] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("p_select_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _select;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_disr_val", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<DisregardValueDefinition>(_tblData, DisregardValueDefinition.Converter);
            }
            return _list;

        }


        public int SaveDisregardPCDefinition(DisregardPCDefinition pc)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_hdpd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_com;
            (param[1] = new OracleParameter("p_hdpd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_pc;
            (param[2] = new OracleParameter("p_hdpd_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_from_dt;
            (param[3] = new OracleParameter("p_hdpd_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_to_dt;
            (param[4] = new OracleParameter("p_hdpd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_cre_by;
            (param[5] = new OracleParameter("p_hdpd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_cre_dt;
            (param[6] = new OracleParameter("p_hdpd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_mod_by;
            (param[7] = new OracleParameter("p_hdpd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_mod_dt;
            param[8] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_save_disr_pc_def", CommandType.StoredProcedure, param);

            return effect;
        }


        public int UpdateDisregardPCDefinition(DisregardPCDefinition pc, string _com, string _pc)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_hdpd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_com;
            (param[1] = new OracleParameter("p_hdpd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_pc;
            (param[2] = new OracleParameter("p_hdpd_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_from_dt;
            (param[3] = new OracleParameter("p_hdpd_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_to_dt;
            (param[4] = new OracleParameter("p_hdpd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Hdpd_mod_by;
            (param[5] = new OracleParameter("p_hdpd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = pc.Hdpd_mod_dt;

            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[7] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;


            param[8] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_update_disr_pc_def", CommandType.StoredProcedure, param);

            return effect;
        }

        public List<DisregardPCDefinition> GetDisregardPCDefinitiom(string _com, string _pc, string _type)
        {

            List<DisregardPCDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_disr_pc_def", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<DisregardPCDefinition>(_tblData, DisregardPCDefinition.Converter);
            }
            return _list;

        }

        public int SaveHandlingOveAccounts(HandlingOverAccount hand)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_hhoa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_com;
            (param[1] = new OracleParameter("p_hhoa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_pc;
            (param[2] = new OracleParameter("p_hhoa_ac", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_ac;
            (param[3] = new OracleParameter("p_hhoa_bonus_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = hand.Hhoa_bonus_month;
            (param[4] = new OracleParameter("p_hhoa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_cre_by;
            (param[5] = new OracleParameter("p_hhoa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hand.Hhoa_cre_dt;

            param[6] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_save_hand_over_ac", CommandType.StoredProcedure, param);

            return effect;

        }

        public int UpdateHandlinOverAccount(HandlingOverAccount hand, string _com, string _pc, string _ac)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_hhoa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_com;
            (param[1] = new OracleParameter("p_hhoa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_pc;
            (param[2] = new OracleParameter("p_hhoa_ac", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hand.Hhoa_ac;
            (param[3] = new OracleParameter("p_hhoa_bonus_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = hand.Hhoa_bonus_month;

            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("p_ac", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ac;

            param[7] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_update_hand_over_ac", CommandType.StoredProcedure, param);

            return effect;
        }

        public List<HandlingOverAccount> GetHandlingOverAccounts(string _com, string _pc, string _ac, DateTime _bonus, string _type)
        {
            List<HandlingOverAccount> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ac", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ac;
            (param[3] = new OracleParameter("p_bonus", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bonus;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_hand_over_ac", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HandlingOverAccount>(_tblData, HandlingOverAccount.Converter);
            }
            return _list;
        }

        public DataTable GetCollectionBonusByDate(string _com, string _pc, DateTime _date)
        {


            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_col_bons", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetArrearsScheme(DateTime _date, string _scheme)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_rls_sch", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        public DataTable GetPriceCombinedItemTable(Int32 _priceBookSeq, Int32 _priceitemseq, string _mainItem, string _mainSerial)
        {

            //sp_getpricecombineitemline   (p_pb_seq in NUMBER,p_pb_itm_seq in NUMBER,p_mainitem in NVARCHAR2,p_mainserial in NVARCHAR2 ,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceBookSeq;
            (param[1] = new OracleParameter("p_pb_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceitemseq;
            (param[2] = new OracleParameter("p_mainitem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainItem;
            (param[3] = new OracleParameter("p_mainserial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainSerial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceCombineItem = QueryDataTable("tblPriceCombineItem", "sp_getpricecombineitemline", CommandType.StoredProcedure, false, param);


            return _tblPriceCombineItem;

        }


        public DataTable GetAllCombineItemDetail()
        {
            //sp_getcombinepromotion(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblPriceCombineItem = QueryDataTable("tblPriceCombineItem", "sp_getcombinepromotion", CommandType.StoredProcedure, false, param);
            return _tblPriceCombineItem;
        }



        public List<CollectionBonusAdjusment> GetCollectionBonusAdjusment(string _com, string _pc, string _acc, string _type)
        {
            List<CollectionBonusAdjusment> _list = null;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_col_adjs", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CollectionBonusAdjusment>(_tblData, CollectionBonusAdjusment.Converter);
            }
            return _list;
        }

        public int SaveCollectionBonusAdjusment(CollectionBonusAdjusment adj)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("p_hcba_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adj.Hcba_com;
            (param[1] = new OracleParameter("p_hcba_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adj.Hcba_pc;
            (param[2] = new OracleParameter("p_hcba_bonus_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adj.Hcba_bonus_dt;
            (param[3] = new OracleParameter("p_hcba_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adj.Hcba_acc;
            (param[4] = new OracleParameter("p_hcba_ars_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_ars_amt;
            (param[5] = new OracleParameter("p_hcba_dispute", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_dispute;
            (param[6] = new OracleParameter("p_hcba_insu", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_insu;
            (param[7] = new OracleParameter("p_hcba_lod", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_lod;
            (param[8] = new OracleParameter("p_hcba_service", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_service;
            (param[9] = new OracleParameter("p_hcba_ar_1mon", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_ar_1mon;
            (param[10] = new OracleParameter("p_hcba_other", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_other;
            (param[11] = new OracleParameter("p_hcba_grce_sett", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_grce_sett;
            (param[12] = new OracleParameter("p_hcba_tot_adj", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_tot_adj;
            (param[13] = new OracleParameter("p_hcba_net_ars", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adj.Hcba_net_ars;
            (param[14] = new OracleParameter("p_hcba_grce_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adj.Hcba_grce_dt;
            (param[15] = new OracleParameter("p_hcba_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adj.Hcba_cre_by;
            (param[16] = new OracleParameter("p_hcba_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adj.Hcba_cre_dt;


            param[17] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_save_col_bonus_adj", CommandType.StoredProcedure, param);

            return effect;
        }

        //kapila 28/2/2013
        public Boolean IsCheckSalesComm(Int32 _seqno)
        {
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean IsCheckSalesComm = QueryDataTable("tbl", "sp_check_sales_com", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return IsCheckSalesComm;
        }

        public DataTable GetVehicleInsurance(string _account)
        {
            //sp_getvehiclinsurance(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceCombineItem = QueryDataTable("tbl", "sp_getvehiclinsurance", CommandType.StoredProcedure, false, _para);


            return _tblPriceCombineItem;
        }
        //kapila
        public DataTable GetSMSManagers(string _com, string _type, string _code)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (_para[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_chnl_sms", CommandType.StoredProcedure, false, _para);


            return _tbl;
        }

        //written by darshana 29/01/2013
        public List<VehicalRegistration> GetVehRegForRev(string _com, string _pc, string _inv, string _itm, Int32 _status)
        {
            List<VehicalRegistration> _regDet = new List<VehicalRegistration>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getregdetforrev", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _regDet = DataTableExtensions.ToGenericList<VehicalRegistration>(_tblInvoiceItem, VehicalRegistration.Converter);
            }
            return _regDet;
        }

        //written by darshana on 05-03-2013
        public Int16 UpdateRegTxn(string _com, string _pc, string _inv, string _ref, string _itm, string _engine, string _chassis, Int32 _stus)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[5] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[6] = new OracleParameter("p_chasis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[7] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_reg_txn", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateVehicleRegTxn(string _com, string _pc, string _ref, string _itm, string _model, string _brand, string _engine, string _chassis, string _lname, string _fname, string _city, string _addr1, string _addr2, string _dist, string _prov, string _tel, string _title)
        {
            OracleParameter[] param = new OracleParameter[18];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[7] = new OracleParameter("p_chasis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[8] = new OracleParameter("p_lname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lname;
            (param[9] = new OracleParameter("p_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fname;
            (param[10] = new OracleParameter("p_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;
            (param[11] = new OracleParameter("p_addr1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addr1;
            (param[12] = new OracleParameter("p_addr2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addr2;
            (param[13] = new OracleParameter("p_dist", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dist;
            (param[14] = new OracleParameter("p_prov", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prov;
            (param[15] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tel;
            (param[16] = new OracleParameter("p_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _title;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_upd_reg_txn", CommandType.StoredProcedure, param);
            return effects;
        }


        //written by darshana on 05-03-2013
        public Int16 UpdateRegResAvailability(string _com, string _item, string _ser1, string _ser2, Int32 _available)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser1;
            (param[3] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser2;
            (param[4] = new OracleParameter("p_is_available", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _available;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_ser_res_available", CommandType.StoredProcedure, param);
            return effects;
        }


        public List<VehicalRegistration> GetVehicalRegByRefNo(string _recNo)
        {
            // darshana 05-03-2013
            List<VehicalRegistration> _regDet = new List<VehicalRegistration>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getvehicalregistration", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _regDet = DataTableExtensions.ToGenericList<VehicalRegistration>(_tblInvoiceItem, VehicalRegistration.Converter);
            }
            return _regDet;
        }

        public List<VehicleInsuarance> GetVehicalInsByRefNo(string _recNo)
        {
            // darshana 05-03-2013
            List<VehicleInsuarance> _regDet = new List<VehicleInsuarance>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_get_vehinsubyref", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _regDet = DataTableExtensions.ToGenericList<VehicleInsuarance>(_tblInvoiceItem, VehicleInsuarance.Converter);
            }
            return _regDet;
        }

        //darshana 20/06/2012
        public decimal GetFinalCreditCommission(string _inv)
        {
            OracleParameter[] param = new OracleParameter[2];
            decimal _commAmt = 0;


            (param[0] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblCrComm", "sp_getcrcomm", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {

                _commAmt = (_dtResults.Rows[0]["COMMISSION"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["COMMISSION"]);

            }

            return _commAmt;
        }

        //kapila 2/3/2017
        public decimal GetFinalCreditCommission_new(string _inv)
        {
            OracleParameter[] param = new OracleParameter[2];
            decimal _commAmt = 0;


            (param[0] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblCrComm", "sp_getcrcomm_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {

                _commAmt = (_dtResults.Rows[0]["COMMISSION"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[0]["COMMISSION"]);

            }

            return _commAmt;
        }

        //DARSHANA ON 06-03-2013
        public int SaveRemSummaryForFinalCreditComm(RemitanceSummaryDetail _remsumdet)
        {
            int rows_aff = 0;

            OracleParameter[] param = new OracleParameter[35];

            (param[0] = new OracleParameter("p_REM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_com;
            (param[1] = new OracleParameter("p_REM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_pc;
            (param[2] = new OracleParameter("p_REM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_dt;
            (param[3] = new OracleParameter("p_REM_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_sec;
            (param[4] = new OracleParameter("p_REM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cd;
            (param[5] = new OracleParameter("p_REM_SH_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_sh_desc;
            (param[6] = new OracleParameter("p_REM_LG_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_lg_desc;
            (param[7] = new OracleParameter("p_REM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val;
            (param[8] = new OracleParameter("p_REM_VAL_FINAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val_final;
            (param[9] = new OracleParameter("p_REM_WEEK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_week;
            (param[10] = new OracleParameter("p_REM_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ref_no;
            (param[11] = new OracleParameter("p_REM_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk;
            (param[12] = new OracleParameter("p_REM_CR_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cr_acc;
            (param[13] = new OracleParameter("p_REM_DB_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_db_acc;
            (param[14] = new OracleParameter("p_REM_DEL_ALW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_del_alw;
            (param[15] = new OracleParameter("p_REM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_by;
            (param[16] = new OracleParameter("p_REM_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_dt;
            (param[17] = new OracleParameter("p_REM_IS_SOS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_sos;
            (param[18] = new OracleParameter("p_REM_IS_DAYEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_dayend;
            (param[19] = new OracleParameter("p_REM_IS_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_sun;
            (param[20] = new OracleParameter("p_REM_CAT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cat;
            (param[21] = new OracleParameter("p_REM_ADD", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_add;
            (param[22] = new OracleParameter("p_REM_DED", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ded;
            (param[23] = new OracleParameter("p_REM_NET", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_net;
            (param[24] = new OracleParameter("p_REM_EPF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_epf;
            (param[25] = new OracleParameter("p_REM_ESD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_esd;
            (param[26] = new OracleParameter("p_REM_WHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_wht;
            (param[27] = new OracleParameter("p_REM_ADD_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_add_fin;
            (param[28] = new OracleParameter("p_REM_DED_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ded_fin;
            (param[29] = new OracleParameter("p_REM_NET_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_net_fin;
            (param[30] = new OracleParameter("p_REM_RMK_FIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk_fin;
            (param[31] = new OracleParameter("p_REM_BNK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_bnk_cd;
            (param[32] = new OracleParameter("p_REM_IS_REM_SUM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_rem_sum;
            (param[33] = new OracleParameter("p_REM_CAN_REC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.REM_CAN_REC;
            param[34] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_aff = UpdateRecords("sp_save_rem_sum_cr_com", CommandType.StoredProcedure, param);


            return rows_aff;
        }

        public Int32 UpdateFinalComRec(string _seqno, string _recno, string _com, string _pc, string _sec, string _remCD)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[5] = new OracleParameter("p_remCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remCD;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_final_com_rec", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<VehicalRegistration> GetRefundReqVehReg(string _com, string _pc, string _ref, string _appTp)
        {
            // darshana 12-03-2013
            List<VehicalRegistration> _regDet = new List<VehicalRegistration>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_appTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appTp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_get_req_reg_refund", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _regDet = DataTableExtensions.ToGenericList<VehicalRegistration>(_tblInvoiceItem, VehicalRegistration.Converter);
            }
            return _regDet;
        }

        public List<RecieptItem> Get_receiptitm_OnPayTp(string seq, string payTp, string receiptNo)
        {
            List<RecieptItem> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            //(p_seq in NVARCHAR2,p_payTp in NVARCHAR2,p_receiptNo in NVARCHAR2,c_data out SYS_REFCURSOR)
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_payTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payTp;
            (param[2] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receiptNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_receiptitm_OnPayTp", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RecieptItem>(_tblData, RecieptItem.ConvertTotal);
            }
            return _list;

        }


        public DataTable LoadWarrantyClaimCreditNote(string _company, string _profitcenter)
        {
            //sp_getsuppliercustomer(p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getsuppliercustomer", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        public DataTable LoadWarrantyClaimCompany(string _company, string _supp)
        {
            //sp_getsuppliercustomer(p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getsuppliercustomerCompany", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable getReceiptByEngNo(string _com, string _pc, string _eng)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eng;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_recby_engno", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public List<VehicleInsuarance> GetVehicalInsuranceByInvoice(string _inv)
        {
            List<VehicleInsuarance> _insurance = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_get_veh_ins_by_invoice", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _insurance = DataTableExtensions.ToGenericList<VehicleInsuarance>(_tblData, VehicleInsuarance.Converter);
            }
            return _insurance;
        }

        public int UpdateHPAccountReschedule(HpAccount _account)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[23];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account.Hpa_acc_no;
            (param[1] = new OracleParameter("p_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account.Hpa_sch_tp;
            (param[2] = new OracleParameter("p_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account.Hpa_sch_cd;
            (param[3] = new OracleParameter("p_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account.Hpa_term;
            (param[4] = new OracleParameter("p_intr_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_intr_rt;
            (param[5] = new OracleParameter("p_intrest", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_tot_intr;
            (param[6] = new OracleParameter("p_ser", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_ser_chg;
            (param[7] = new OracleParameter("p_init_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_init_ins;
            (param[8] = new OracleParameter("p_init_ser", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_init_ser_chg;
            (param[9] = new OracleParameter("p_inst_ins", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_inst_ins;
            (param[10] = new OracleParameter("p_inst_ser", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_inst_ser_chg;
            (param[11] = new OracleParameter("p_cash_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_cash_val;
            (param[12] = new OracleParameter("p_amount_finance", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_af_val;
            (param[13] = new OracleParameter("p_dp", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_dp_val;
            (param[14] = new OracleParameter("p_tc", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_tc_val;
            (param[15] = new OracleParameter("p_init_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_init_vat;
            (param[16] = new OracleParameter("p_inst_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_inst_vat;
            (param[17] = new OracleParameter("p_hire", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_hp_val;
            (param[18] = new OracleParameter("p_tot_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_tot_vat;
            (param[19] = new OracleParameter("p_net_va", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_net_val;
            (param[20] = new OracleParameter("p_init_stamp", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_init_stm;
            (param[21] = new OracleParameter("p_inst_stamp", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _account.Hpa_inst_stm;

            param[22] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_update_hpaccount_reschedule", CommandType.StoredProcedure, param);

            return effect;
        }



        public int DeleteHPSchedule(string _acc)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_delete_hp_shed", CommandType.StoredProcedure, param);

            return effect;
        }

        public DataTable GetSCM2InvoiceDetail(string _company, string _invoice, string _item)
        {
            //sp_getinvoicedetail(p_com in NVARCHAR2,p_invoice in NVARCHAR2,p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getinvoicedetail", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetCashCommissionserach(string circular)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_get_cash_comm_detail", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetServiceAgentbyLoc(string _com, string _cd)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tbl", "sp_check_svc_agent", CommandType.StoredProcedure, false, _para);
            return dt;
        }

        //kapila 11/3/2013
        public Boolean IsCheckServiceAgent(string _com, string _cd)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _agentFound = QueryDataTable("tbl", "sp_check_svc_agent", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _agentFound;
        }

        public int UpdateWarrantyClaimRequest(string _request)
        {
            //sp_updatewararequest(p_request in NVARCHAR2)
            int effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_updatewararequest", CommandType.StoredProcedure, param);

            return effect;
        }


        #region receipt refund -Insurance / Registration

        public DataTable Get_vehinsubyRef(string refNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_get_vehinsubyref", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable Get_vehRegbyref(string refNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_get_vehRegbyref", CommandType.StoredProcedure, false, param);
            return dt;
        }


        public Int32 Update_Refund_sat_veh_ins_txn(string reciptNo, string itemCd, string chassis, string engine, string modby, DateTime modDt)
        {
            //(p_recipt in NVARCHAR2,p_itemCd in NVARCHAR2,p_chassis in NVARCHAR2,p_engine in NVARCHAR2,p_modby in NVARCHAR2,p_modDt in Date, o_effect out NUMBER)
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_recipt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reciptNo;
            (param[1] = new OracleParameter("p_itemCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCd;
            (param[2] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chassis;
            (param[3] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = engine;
            (param[4] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modby;
            (param[5] = new OracleParameter("p_modDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = modDt;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int32)UpdateRecords("Refund_update_sat_veh_ins_txn", CommandType.StoredProcedure, param);

            return effect;
        }
        public Int32 Update_Refund_Registration_sat_veh_ins_txn(string reciptNo, string itemCd, string chassis, string engine, string modby, DateTime modDt)
        {
            //(p_recipt in NVARCHAR2,p_itemCd in NVARCHAR2,p_chassis in NVARCHAR2,p_engine in NVARCHAR2,p_modby in NVARCHAR2,p_modDt in Date, o_effect out NUMBER)
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_recipt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reciptNo;
            (param[1] = new OracleParameter("p_itemCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCd;
            (param[2] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chassis;
            (param[3] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = engine;
            (param[4] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modby;
            (param[5] = new OracleParameter("p_modDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = modDt;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int32)UpdateRecords("Refund_updtREG_sat_veh_ins_txn", CommandType.StoredProcedure, param);

            return effect;
        }
        #endregion


        public int UpdateWarrantyRequestClaimItem(string _request, string _item, int _lineno, string _crno, string _adjno, string _pc, string _loc)
        {
            //sp_updatewararequestdet(p_request in NVARCHAR2,p_item in NVARCHAR2,p_lineno in NUMBER,p_crno in NVARCHAR2,p_adjno in NVARCHAR2,p_pc in NVARCHAR2,p_loc in NVARCHAR2,o_effect out NUMBER)
            int effect = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            (param[3] = new OracleParameter("p_crno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _crno;
            (param[4] = new OracleParameter("p_adjno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adjno;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_updatewararequestdet", CommandType.StoredProcedure, param);

            return effect;

        }


        //written by darshana 14/03/2013
        public List<VehicleInsuarance> GetVehInsForRev(string _com, string _pc, string _inv, string _itm, Int32 _status)
        {
            List<VehicleInsuarance> _regDet = new List<VehicleInsuarance>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_getinsdetforrev", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _regDet = DataTableExtensions.ToGenericList<VehicleInsuarance>(_tblInvoiceItem, VehicleInsuarance.Converter);
            }
            return _regDet;
        }

        public List<VehicleInsuarance> GetRefundReqVehIns(string _com, string _pc, string _ref, string _appTp)
        {
            // darshana 14-03-2013
            List<VehicleInsuarance> _insDet = new List<VehicleInsuarance>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_appTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appTp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "sp_get_req_ins_refund", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _insDet = DataTableExtensions.ToGenericList<VehicleInsuarance>(_tblInvoiceItem, VehicleInsuarance.Converter);
            }
            return _insDet;
        }

        //written by darshana on 15-03-2013
        public Int16 UpdateInsTxnCan(string _com, string _pc, string _inv, string _ref, string _itm, string _engine, string _chassis, Int32 _stus)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[5] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[6] = new OracleParameter("p_chasis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[7] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_ins_txn_can", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetPriorityHierarchyWithDescription(string _category)
        {
            // sp_getpritheirarchydesc(p_cate in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_getpritheirarchydesc", CommandType.StoredProcedure, false, param);
            return tblDet;
        }


        //darshana 15-03-2013

        public Int16 UpdateReversalOutAmt(string _com, string _pc, string _cus, string _inv, decimal _revAmt, decimal _refRecAmt)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_revInvamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _revAmt;
            (param[5] = new OracleParameter("p_revRecamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _refRecAmt;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterevoutamt", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<MasterBusinessEntityInfo> GetCustomerSegmentation(string _cus)
        {

            List<MasterBusinessEntityInfo> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceItem = QueryDataTable("tblInvoiceItem", "get_busentity_info", CommandType.StoredProcedure, false, param);

            if (_tblInvoiceItem.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterBusinessEntityInfo>(_tblInvoiceItem, MasterBusinessEntityInfo.Converter);
            }
            return _list;

        }

        public MasterBusinessEntity Get_HpAccCustomer_NEW(string custTp, string custID, Int32 addrTp, string accountNo)
        {
            //(p_custTp in NVARCHAR2,p_custID in NVARCHAR2,p_addressTp in NUMBER,p_accNo in NVARCHAR2,c_data OUT sys_refcursor)
            MasterBusinessEntity customer = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_custTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custTp;
            (param[1] = new OracleParameter("p_custID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custID;
            (param[2] = new OracleParameter("p_addressTp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = addrTp;
            (param[3] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "SP_Get_AccCustomer", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                customer = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }

            return customer;
        }

        public List<PriceDetailRef> GetEnquiryDetail(int _startFrom, int _endFrom, string _user, string _company, string _book, string _level, string _item, DateTime _fromDate, DateTime _toDate, string _customer, string _category1, string _category2, string _category3, string _type, string _circular, int _isWithHistory, int _isasat, int _isSuperUser, string _profitcenter, string _promo, string _status)
        {
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            //sp_getpriceenquirydetail(p_user in NVARCHAR2, p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,
            //p_customer in NVARCHAR2,p_cat1 in NVARCHAR2,p_cat2 in NVARCHAR2,p_cat3 in NVARCHAR2,p_type in NVARCHAR2,p_circulerno in NVARCHAR2,p_isasathistory in NUMBER,p_iswithhistory in NUMBER,p_issuperuser in NUMBER,p_promo in NVARCHAR2,p_itmstatus in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[20];

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[8] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category1;
            (param[9] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category2;
            (param[10] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category3;
            (param[11] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[12] = new OracleParameter("p_circulerno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[13] = new OracleParameter("p_isasathistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isasat;
            (param[14] = new OracleParameter("p_iswithhistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isWithHistory;
            (param[15] = new OracleParameter("p_issuperuser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSuperUser;
            (param[16] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[17] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[18] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[19] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpriceenquirydetail", CommandType.StoredProcedure, false, _startFrom, _endFrom, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertForPriceEnquiry);
            }

            return _priceDetailRef;
        }
        //add _Taxstructure parameter by rukshan 19/Apr/2016
        public List<PriceDetailRef> GetEnquiryDetailNew(int _startFrom, int _endFrom, string _user, string _company, string _book,
            string _level, string _item, DateTime _fromDate, DateTime _toDate, string _customer, string _category1,
            string _category2, string _category3, string _type, string _circular,
            int _isWithHistory, int _isasat, int _isSuperUser, string _profitcenter,
            string _promo, string _status, string _Taxstructure)
        {
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            //sp_getpriceenquirydetail(p_user in NVARCHAR2, p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,
            //p_customer in NVARCHAR2,p_cat1 in NVARCHAR2,p_cat2 in NVARCHAR2,p_cat3 in NVARCHAR2,p_type in NVARCHAR2,p_circulerno in NVARCHAR2,p_isasathistory in NUMBER,p_iswithhistory in NUMBER,p_issuperuser in NUMBER,p_promo in NVARCHAR2,p_itmstatus in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[8] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category1;
            (param[9] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category2;
            (param[10] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category3;
            (param[11] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[12] = new OracleParameter("p_circulerno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[13] = new OracleParameter("p_isasathistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isasat;
            (param[14] = new OracleParameter("p_iswithhistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isWithHistory;
            (param[15] = new OracleParameter("p_issuperuser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSuperUser;
            (param[16] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[17] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[18] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[19] = new OracleParameter("p_Taxstructure", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Taxstructure;
            param[20] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            // DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpriceenquirydetailnew", CommandType.StoredProcedure, false, _startFrom, _endFrom, param);
            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpriceenquirydetailnew", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertForPriceEnquiryNew);
            }

            return _priceDetailRef;
        }


        public List<PriceSerialRef> GetEnquirySerialDetail(string _profitcenter, int _startFrom, int _endFrom, string _user, string _company, string _book, string _level, string _item, DateTime _fromDate, DateTime _toDate, string _customer, string _category1, string _category2, string _category3, string _type, string _circular, int _isWithHistory, int _isasat, int _isSuperUser)
        {
            List<PriceSerialRef> _priceDetailRef = new List<PriceSerialRef>();
            //sp_getpriceenquiryserialdetail(p_user in NVARCHAR2, p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,
            //p_customer in NVARCHAR2,p_cat1 in NVARCHAR2,p_cat2 in NVARCHAR2,p_cat3 in NVARCHAR2,p_type in NVARCHAR2,p_circulerno in NVARCHAR2,p_isasathistory in NUMBER,p_ishistory in NUMBER,p_issuperuser in NUMBER,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[8] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category1;
            (param[9] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category2;
            (param[10] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category3;
            (param[11] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[12] = new OracleParameter("p_circulerno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[13] = new OracleParameter("p_isasathistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isasat;
            (param[14] = new OracleParameter("p_iswithhistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isWithHistory;
            (param[15] = new OracleParameter("p_issuperuser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSuperUser;
            (param[16] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;

            param[17] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpriceenquiryserialdetail", CommandType.StoredProcedure, false, _startFrom, _endFrom, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblPriceDetail, PriceSerialRef.ConvertForPriceEnquiry);
            }

            return _priceDetailRef;

        }

        //by Chamal 29/03/2013 - update invoice similar item code
        public Int32 UpdateInvoiceSimilarItemCode(string _invoiceNo, int _lineNo, string _itemCode, string _similarItemCode)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            ConnectionOpen();
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            (param[2] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[3] = new OracleParameter("p_similarcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _similarItemCode;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateinvoicesimcode", CommandType.StoredProcedure, param);
            ConnectionClose();
            return effects;
        }

        public List<MasterSalesPriorityHierarchy> GetSalesPriorityHierarchyWithDescription(string _hierarchytype, string _company, string _profitcenter)
        {
            //sp_gethierarchydetail(p_hierarchyType in NVARCHAR2, p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            List<MasterSalesPriorityHierarchy> _lst = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_hierarchyType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hierarchytype;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "sp_gethierarchydetail", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _lst = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchy>(_dtResults, MasterSalesPriorityHierarchy.ConvertWithDescription);
            }

            return _lst;
        }

        public List<MasterSalesPriorityHierarchyLog> GetSalesPriorityHierarchyWithDescription_log(string _hierarchytype, string _company, string _profitcenter, DateTime _date)
        {  //written by Nadeeka 03-jun-2014

            List<MasterSalesPriorityHierarchyLog> _lst = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_hierarchyType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hierarchytype;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "sp_gethierarchydetail_log", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _lst = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchyLog>(_dtResults, MasterSalesPriorityHierarchyLog.ConvertWithDescription);
            }

            return _lst;
        }

        public DataTable get_priceDet_ForAC_sevChgItG(string _company, string chgItemCode, DateTime today)
        {
            //(p_com in NVARCHAR2,p_itmCD in NVARCHAR2,p_today in Date ,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chgItemCode;
            (param[2] = new OracleParameter("p_today", OracleDbType.Date, null, ParameterDirection.Input)).Value = today;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_price_AC_sevChgItm", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        //written by darshana 05/04/2013
        public HpSchemeType getSchemeTypeByTypeAndCate(string _cate, string _type)
        {
            HpSchemeType _SchemeType = new HpSchemeType();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemetype = QueryDataTable("tblschemetype", "sp_getschemetypebytypeandcate", CommandType.StoredProcedure, false, param);
            if (_tblschemetype.Rows.Count > 0)
            {
                _SchemeType = DataTableExtensions.ToGenericList<HpSchemeType>(_tblschemetype, HpSchemeType.Converter)[0];
            }

            return _SchemeType;
        }

        //darshana on 05-04-2013
        public Int16 UpdateSchemeType(HpSchemeType _schemeType)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schemeType.Hst_sch_cat;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schemeType.Hst_cd;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schemeType.Hst_desc;
            (param[3] = new OracleParameter("p_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schemeType.Hst_def_intr;
            (param[4] = new OracleParameter("p_active", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schemeType.Hst_act;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_scheme_type", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable check_Voucher_Creation_Rental(string _acc)
        {// Sanjeewa 2016-06-02            
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_vou_gen_rental", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public Int16 UpdateAccountAsVouGenerated(string _acc)
        {//Sanjeewa 2016-06-02
            Int16 effects = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_acc_as_vou_created", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateReceiptSMS(string _recno, string _msg)
        {//Sanjeewa 2016-11-15
            Int16 effects = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[1] = new OracleParameter("in_msg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msg;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_receipt_SMS", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<InvoiceHeader> getInvoiceHeaderbyAcc(string _acc)
        {//Sanjeewa 2016-06-02           
            List<InvoiceHeader> _list = new List<InvoiceHeader>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_get_invoice_hdr_acc", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblData, InvoiceHeader.ConvertTotal);
            }
            return _list;
        }

        public List<InvoiceItem> getInvoiceItems(string _invoice)
        {//Sanjeewa 2016-06-02           
            List<InvoiceItem> _list = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_get_invoice_items", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceItem>(_tblData, InvoiceItem.ConvertTotal);
            }
            return _list;
        }

        //darshana on 05-04-2013
        public Int16 SaveNewSchemeType(HpSchemeType _schemeType)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schemeType.Hst_sch_cat;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schemeType.Hst_cd;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schemeType.Hst_desc;
            (param[3] = new OracleParameter("p_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schemeType.Hst_def_intr;
            (param[4] = new OracleParameter("p_active", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schemeType.Hst_act;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_scheme_type", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 06-04-2013

        public List<SaleCommission> GetCommForRev(string _inv, string _itm, Int32 _line)
        {
            //sp_getitemtax   (p_com in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2 , p_taxcode in NVARCHAR2,p_taxratecode in NVARCHAR2, c_data  OUT sys_refcursor)
            List<SaleCommission> _list = new List<SaleCommission>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_get_comm_for_rev", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SaleCommission>(_tblData, SaleCommission.ConvertTotal);
            }

            return _list;

        }

        //darshana on 05-04-2013
        public Int16 UpdateSchemeDetIntRate(string p_type, string p_user, decimal p_rate, Int32 p_defTerm)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_user;
            (param[2] = new OracleParameter("p_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_rate;
            (param[3] = new OracleParameter("p_defTerm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_defTerm;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_sch_int_rt", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 08-04-2013
        public Int16 SaveSchemeDetailLog(string p_code)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_code;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sch_det_log", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 09-04-2013
        public Int16 SaveNewSchemeDetails(HpSchemeDetails _schDet)
        {
            OracleParameter[] param = new OracleParameter[38];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_hsd_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_act;
            (param[1] = new OracleParameter("p_hsd_add_calwithvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_add_calwithvat;
            (param[2] = new OracleParameter("p_hsd_add_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_add_is_rt;
            (param[3] = new OracleParameter("p_hsd_add_rnt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schDet.Hsd_add_rnt;
            (param[4] = new OracleParameter("p_hsd_alw_gs", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_alw_gs;
            (param[5] = new OracleParameter("p_hsd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDet.Hsd_cd;
            (param[6] = new OracleParameter("p_hsd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDet.Hsd_cre_by;
            (param[7] = new OracleParameter("p_hsd_def_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schDet.Hsd_def_intr;
            (param[8] = new OracleParameter("p_hsd_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDet.Hsd_desc;
            (param[9] = new OracleParameter("p_hsd_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schDet.Hsd_dis;
            (param[10] = new OracleParameter("p_hsd_dis_isrt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_dis_isrt;
            (param[11] = new OracleParameter("p_hsd_fpay", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schDet.Hsd_fpay;
            (param[12] = new OracleParameter("p_hsd_fpay_calwithvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_fpay_calwithvat;
            (param[13] = new OracleParameter("p_hsd_fpay_withvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_fpay_withvat;
            (param[14] = new OracleParameter("p_hsd_has_insu", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_has_insu;
            (param[15] = new OracleParameter("p_hsd_init_insu", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_init_insu;
            (param[16] = new OracleParameter("p_hsd_init_sduty", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_init_sduty;
            (param[17] = new OracleParameter("p_hsd_init_serchg", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_init_serchg;
            (param[18] = new OracleParameter("p_hsd_intr_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schDet.Hsd_intr_rt;
            (param[19] = new OracleParameter("p_hsd_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_is_rt;
            (param[20] = new OracleParameter("p_hsd_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDet.Hsd_pty_cd;
            (param[21] = new OracleParameter("p_hsd_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDet.Hsd_pty_tp;
            (param[22] = new OracleParameter("p_hsd_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDet.Hsd_sch_tp;
            (param[23] = new OracleParameter("p_hsd_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schDet.Hsd_term;
            (param[24] = new OracleParameter("p_hsd_noof_addrnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schDet.Hsd_noof_addrnt;
            (param[25] = new OracleParameter("p_hsd_insu_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schDet.Hsd_insu_term;
            (param[26] = new OracleParameter("p_hsd_veh_insu_term;", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schDet.Hsd_veh_insu_term;
            (param[27] = new OracleParameter("p_hsd_comm_on_vat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_comm_on_vat;
            (param[28] = new OracleParameter("p_hsd_veh_insu_col_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schDet.Hsd_veh_insu_col_term;
            (param[29] = new OracleParameter("p_hsd_alw_vou", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_alw_vou;
            (param[30] = new OracleParameter("p_hsd_alw_cus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_alw_cus;
            (param[31] = new OracleParameter("p_hsd_vou_man", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_vou_man;
            (param[32] = new OracleParameter("p_hsd_is_red", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_is_red;
            (param[33] = new OracleParameter("p_hsd_is_rvt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_is_rvt;// Added by Nadeeka 13-05-2015
            (param[34] = new OracleParameter("p_hsd_spc_vout", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_spc_vou;// Added by Sanjeewa 2016-06-02
            (param[35] = new OracleParameter("p_hsd_vou_gen", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet.Hsd_vou_gen;// Added by Sanjeewa 2016-06-02
            (param[36] = new OracleParameter("p_hsd_comm_on_serchg", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDet._hsd_is_com_ser_chg; //Tharindu 2018-07-01

            param[37] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sch_det", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 09-04-2013
        public Int16 UpdateExsistSchemeDetails(HpSchemeDetails _updateSchDet)
        {
            OracleParameter[] param = new OracleParameter[38];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_hsd_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_act;
            (param[1] = new OracleParameter("p_hsd_add_calwithvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_add_calwithvat;
            (param[2] = new OracleParameter("p_hsd_add_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_add_is_rt;
            (param[3] = new OracleParameter("p_hsd_add_rnt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_add_rnt;
            (param[4] = new OracleParameter("p_hsd_alw_gs", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_alw_gs;
            (param[5] = new OracleParameter("p_hsd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_cd;
            (param[6] = new OracleParameter("p_hsd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_cre_by;
            (param[7] = new OracleParameter("p_hsd_def_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_def_intr;
            (param[8] = new OracleParameter("p_hsd_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_desc;
            (param[9] = new OracleParameter("p_hsd_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_dis;
            (param[10] = new OracleParameter("p_hsd_dis_isrt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_dis_isrt;
            (param[11] = new OracleParameter("p_hsd_fpay", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_fpay;
            (param[12] = new OracleParameter("p_hsd_fpay_calwithvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_fpay_calwithvat;
            (param[13] = new OracleParameter("p_hsd_fpay_withvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_fpay_withvat;
            (param[14] = new OracleParameter("p_hsd_has_insu", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_has_insu;
            (param[15] = new OracleParameter("p_hsd_init_insu", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_init_insu;
            (param[16] = new OracleParameter("p_hsd_init_sduty", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_init_sduty;
            (param[17] = new OracleParameter("p_hsd_init_serchg", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_init_serchg;
            (param[18] = new OracleParameter("p_hsd_intr_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_intr_rt;
            (param[19] = new OracleParameter("p_hsd_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_is_rt;
            (param[20] = new OracleParameter("p_hsd_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_pty_cd;
            (param[21] = new OracleParameter("p_hsd_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_pty_tp;
            (param[22] = new OracleParameter("p_hsd_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_sch_tp;
            (param[23] = new OracleParameter("p_hsd_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_term;
            (param[24] = new OracleParameter("p_hsd_noof_addrnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_noof_addrnt;
            (param[25] = new OracleParameter("p_hsd_insu_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_insu_term;
            (param[26] = new OracleParameter("p_hsd_veh_insu_term;", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_veh_insu_term;
            (param[27] = new OracleParameter("p_hsd_comm_on_vat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_comm_on_vat;
            (param[28] = new OracleParameter("p_hsd_veh_insu_col_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_veh_insu_col_term;
            (param[29] = new OracleParameter("p_hsd_alw_vou", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_alw_vou;
            (param[30] = new OracleParameter("p_hsd_alw_cus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_alw_cus;
            (param[31] = new OracleParameter("p_hsd_vou_man", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_vou_man;
            (param[32] = new OracleParameter("p_hsd_is_red", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_is_red;
            (param[33] = new OracleParameter("p_hsd_is_rvt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_is_rvt;// Added by Nadeeka 13-05-2015
            (param[34] = new OracleParameter("p_hsd_spc_vou", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_spc_vou;// Added by Sanjeewa 2016-06-02
            (param[35] = new OracleParameter("p_hsd_vou_gen", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet.Hsd_vou_gen;// Added by Sanjeewa 2016-06-02

            (param[36] = new OracleParameter("p_hsd_comm_on_serchg", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _updateSchDet._hsd_is_com_ser_chg; //Tharindu 2018-07-01
            param[37] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_sch_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<MasterLocationPriorityHierarchy> GetLocationPriorityHierarchyWithDescription(string _hierarchytype, string _company, string _location)
        {
            //sp_gethierarchydetail(p_hierarchyType in NVARCHAR2, p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            List<MasterLocationPriorityHierarchy> _lst = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_hierarchyType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hierarchytype;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblLast", "sp_gethierarchydetail", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _lst = DataTableExtensions.ToGenericList<MasterLocationPriorityHierarchy>(_dtResults, MasterLocationPriorityHierarchy.ConvertWithDescription);
            }

            return _lst;
        }


        public List<PaymentTypeRef> Get_enqiry_paytypes(bool isAll)
        {
            //sp_getpaytype   (p_cd in NVARCHAR2, c_data OUT sys_refcursor)
            List<PaymentTypeRef> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (isAll == false ? 0 : 1);

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_enqiry_paytypes", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PaymentTypeRef>(_tblData, PaymentTypeRef.ConvertTotal);
            }
            return _list;
        }

        public List<HpSchemeSheduleDefinition> Get_Define_Scheme_Shedule(string _schCode)
        {
            List<HpSchemeSheduleDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_sch_shedule", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSchemeSheduleDefinition>(_tblData, HpSchemeSheduleDefinition.Converter);
            }

            return _list;
        }

        //darshana on 10-04-2013
        public Int32 Delete_Shedule_Definition(string _code)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_hss_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_delete_shedule_definition", CommandType.StoredProcedure, param);

            return effects;
        }

        //darshana on 10-04-2013
        public Int16 SaveNewSchemeShedule(HpSchemeSheduleDefinition _schDefinition)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_hss_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schDefinition.Hss_seq;
            (param[1] = new OracleParameter("p_hss_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDefinition.Hss_sch_cd;
            (param[2] = new OracleParameter("p_hss_rnt_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDefinition.Hss_rnt_no;
            (param[3] = new OracleParameter("p_hss_rnt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schDefinition.Hss_rnt;
            (param[4] = new OracleParameter("p_hss_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schDefinition.Hss_is_rt;
            (param[5] = new OracleParameter("p_hss_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schDefinition.Hss_cre_by;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_shedule_definition", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 12-04-2013
        public Int16 SaveNewSchemeCommDefinition(HpSchemeDefinition _schSchemeCommDef)
        {
            OracleParameter[] param = new OracleParameter[29];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_hpc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_seq;
            (param[1] = new OracleParameter("p_hpc_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_sch_cd;
            (param[2] = new OracleParameter("p_hpc_cir_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cir_no;
            (param[3] = new OracleParameter("p_hpc_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pty_tp;
            (param[4] = new OracleParameter("p_hpc_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pty_cd;
            (param[5] = new OracleParameter("p_hpc_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_from_dt;
            (param[6] = new OracleParameter("p_hpc_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_to_dt;
            (param[7] = new OracleParameter("p_hpc_comm_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_comm_cat;
            (param[8] = new OracleParameter("p_hpc_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cust_cd;
            (param[9] = new OracleParameter("p_hpc_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pb;
            (param[10] = new OracleParameter("p_hpc_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pb_lvl;
            (param[11] = new OracleParameter("p_hpc_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_brd;
            (param[12] = new OracleParameter("p_hpc_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_main_cat;
            (param[13] = new OracleParameter("p_hpc_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cat;
            (param[14] = new OracleParameter("p_hpc_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_itm;
            (param[15] = new OracleParameter("p_hpc_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_ser;
            (param[16] = new OracleParameter("p_hpc_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pro;
            (param[17] = new OracleParameter("p_hpc_dp_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_dp_comm;
            (param[18] = new OracleParameter("p_hpc_inst_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_inst_comm;
            (param[19] = new OracleParameter("p_hpc_disc", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_disc;
            (param[20] = new OracleParameter("p_hpc_disc_isrt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_disc_isrt;
            (param[21] = new OracleParameter("p_hpc_is_alw", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_is_alw;
            (param[22] = new OracleParameter("p_hpc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cre_by;
            (param[23] = new OracleParameter("p_hpc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_stus;
            (param[24] = new OracleParameter("p_hpc_price_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_price_cir_no;

            (param[25] = new OracleParameter("p_hpc_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_is_rt; //Tharindu 2018-07-01
            (param[26] = new OracleParameter("p_hpc_fpay", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_fpay;
            (param[27] = new OracleParameter("p_hpc_fpay_withvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_fpay_withvat;

            param[28] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sch_comm_new", CommandType.StoredProcedure, param);

            return effects;
        }


        public int UpdateResheduleAccLog(DateTime _date, string _acc)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updat_acc_lo_resh", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SaveAdditionalProductBonus(MasterAdditionalProductBonus _product)
        {

            int _effect = 0;
            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _product.Itc_seq_no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _product.Itc_com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _product.Itc_pc;
            (param[3] = new OracleParameter("p_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _product.Itc_frm_dt;
            (param[4] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _product.Itc_to_dt;
            (param[5] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _product.Itc_brnd;
            (param[6] = new OracleParameter("p_cat_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _product.Itc_cat_1;
            (param[7] = new OracleParameter("p_cat_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _product.Itc_cat_2;
            (param[8] = new OracleParameter("p_app_itms", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _product.Itc_app_itms;
            (param[9] = new OracleParameter("p_app_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _product.Itc_app_val;
            (param[10] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _product.Itc_cre_dt;
            (param[11] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _product.Itc_cre_by;
            (param[12] = new OracleParameter("p_act_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _product.Itc_act_stus ? 1 : 0;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_saveadtproductbonus", CommandType.StoredProcedure, param);

            return _effect;
        }

        public List<MasterAdditionalProductBonus> GetAllProductBonusSetup(string _company)
        {
            //sp_getproductbonussetup(p_com in NVARCHAR2,c_data out sys_refcursor)
            List<MasterAdditionalProductBonus> _bonus = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("_tbl", "sp_getproductbonussetup", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                _bonus = DataTableExtensions.ToGenericList<MasterAdditionalProductBonus>(_tbl, MasterAdditionalProductBonus.Converter);
            }

            return _bonus;

        }

        public MasterItemSubCate GetItemSubCate(string _cd)
        {

            MasterItemSubCate _subCate = new MasterItemSubCate();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cat2", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<MasterItemSubCate>(_tblBrand, MasterItemSubCate.Converter)[0];
            }
            return _subCate;
        }

        public REF_ITM_CATE3 GetItemCate3(string _cd)
        {

            REF_ITM_CATE3 _subCate = new REF_ITM_CATE3();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cate3", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<REF_ITM_CATE3>(_tblBrand, REF_ITM_CATE3.Converter)[0];
            }
            return _subCate;
        }

        public REF_ITM_CATE4 GetItemCate4(string _cd)
        {

            REF_ITM_CATE4 _subCate = new REF_ITM_CATE4();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cate4", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<REF_ITM_CATE4>(_tblBrand, REF_ITM_CATE4.Converter)[0];
            }
            return _subCate;
        }

        public REF_ITM_CATE5 GetItemCate5(string _cd)
        {

            REF_ITM_CATE5 _subCate = new REF_ITM_CATE5();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cate5", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<REF_ITM_CATE5>(_tblBrand, REF_ITM_CATE5.Converter)[0];
            }
            return _subCate;
        }

        public List<MasterItem> GetItemsByCateAndBrand(string _mainCate, string _subCate, string _itmRange, string _brand, string _com)
        {
            List<MasterItem> _itmDet = new List<MasterItem>();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCate;
            (param[1] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subCate;
            (param[2] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmRange;
            (param[3] = new OracleParameter("p_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getitembycatebrd", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _itmDet = DataTableExtensions.ToGenericList<MasterItem>(_tblData, MasterItem.ConvertTotal);
            }

            return _itmDet;
        }

        public List<PriceDetailRef> GetPriceDetailsByCir(string _book, string _level, string _promo, string _cir)
        {
            List<PriceDetailRef> _promoDet = new List<PriceDetailRef>();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[3] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getpricebycir", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _promoDet = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblData, PriceDetailRef.ConvertMain);
            }

            return _promoDet;
        }

        public List<MasterExchangeRate> GetValid_ExchangeRates(string _com, string fromCur, string toCur, DateTime fromDt)
        {
            List<MasterExchangeRate> _paraRate = new List<MasterExchangeRate>();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mer_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fromCur;
            (param[2] = new OracleParameter("p_mer_to_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = toCur;
            (param[3] = new OracleParameter("p_mer_vad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //sp_getValid_exratedetails(p_com in NVARCHAR2,p_mer_cur in NVARCHAR2,p_mer_to_cur in NVARCHAR2 ,p_mer_vad_from in date, c_data OUT sys_refcursor)
            DataTable _tbl = QueryDataTable("tbl", "sp_getValid_exratedetails", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _paraRate = DataTableExtensions.ToGenericList<MasterExchangeRate>(_tbl, MasterExchangeRate.Converter);
            }

            return _paraRate;

        }

        public int SaveHpGurantorsParam(HPGurantorParam _gurParam)
        {

            int _effect = 0;
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_hpg_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _gurParam.Hpg_seq;
            (param[1] = new OracleParameter("p_hpg_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gurParam.Hpg_sch_cd;
            (param[2] = new OracleParameter("p_hpg_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gurParam.Hpg_pty_tp;
            (param[3] = new OracleParameter("p_hpg_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gurParam.Hpg_pty_cd;
            (param[4] = new OracleParameter("p_hpg_chk_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gurParam.Hpg_chk_on;
            (param[5] = new OracleParameter("p_hpg_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gurParam.Hpg_from_val;
            (param[6] = new OracleParameter("p_hpg_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gurParam.Hpg_to_val;
            (param[7] = new OracleParameter("p_hpg_no_of_gua", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _gurParam.Hpg_no_of_gua;
            (param[8] = new OracleParameter("p_hpg_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _gurParam.Hpg_from_dt;
            (param[9] = new OracleParameter("p_hpg_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _gurParam.Hpg_to_dt;
            (param[10] = new OracleParameter("p_hpg_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gurParam.Hpg_cre_by;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_save_gur_param", CommandType.StoredProcedure, param);

            return _effect;
        }

        public int SaveHpOtherChargeDef(HpOtherCharges _hpOthCha)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("p_hoc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_seq;
            (param[1] = new OracleParameter("p_hoc_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_sch_cd;
            (param[2] = new OracleParameter("p_hoc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_tp;
            (param[3] = new OracleParameter("p_hoc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_desc;
            (param[4] = new OracleParameter("p_hoc_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_from_dt;
            (param[5] = new OracleParameter("p_hoc_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_to_dt;
            (param[6] = new OracleParameter("p_hoc_comm_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_comm_cat;
            (param[7] = new OracleParameter("p_hoc_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_cus_cd;
            (param[8] = new OracleParameter("p_hoc_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_pb;
            (param[9] = new OracleParameter("p_hoc_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_pb_lvl;
            (param[10] = new OracleParameter("p_hoc_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_brd;
            (param[11] = new OracleParameter("p_hoc_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_main_cat;
            (param[12] = new OracleParameter("p_hoc_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_cat;
            (param[13] = new OracleParameter("p_hoc_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_itm;
            (param[14] = new OracleParameter("p_hoc_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_ser;
            (param[15] = new OracleParameter("p_hoc_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_pro;
            (param[16] = new OracleParameter("p_hoc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_val;
            (param[17] = new OracleParameter("p_hoc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpOthCha.Hoc_cre_by;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_save_hp_oth_cha", CommandType.StoredProcedure, param);


            return _effect;
        }

        //written by darshana 17/04/2013
        public List<HpSchemeDetails> getAllActiveSchemes(string _cd)
        {
            List<HpSchemeDetails> _SchemeDet = new List<HpSchemeDetails>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedet = QueryDataTable("tblschemetype", "sp_getallactiveschemes", CommandType.StoredProcedure, false, param);
            if (_tblschemedet.Rows.Count > 0)
            {
                _SchemeDet = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tblschemedet, HpSchemeDetails.Converter);
            }

            return _SchemeDet;
        }

        //writtn by darshaan 18-04-2013
        public int SaveHpResheduleSchemes(HPResheScheme _reShe)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_hsr_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reShe.Hsr_sch_cd;
            (param[1] = new OracleParameter("p_hsr_rsch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reShe.Hsr_rsch_cd;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_save_reshe_def", CommandType.StoredProcedure, param);


            return _effect;
        }

        //writtn by darshaan 19-04-2013
        public int SaveServiceChgDef(HpServiceCharges _serChg)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[16];

            (param[0] = new OracleParameter("p_hps_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serChg.Hps_seq;
            (param[1] = new OracleParameter("p_hps_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serChg.Hps_sch_cd;
            (param[2] = new OracleParameter("p_hps_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serChg.Hps_pty_tp;
            (param[3] = new OracleParameter("p_hps_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serChg.Hps_pty_cd;
            (param[4] = new OracleParameter("p_hps_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serChg.Hps_from_val;
            (param[5] = new OracleParameter("p_hps_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serChg.Hps_to_val;
            (param[6] = new OracleParameter("p_hps_chk_on", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serChg.Hps_chk_on;
            (param[7] = new OracleParameter("p_hps_cal_on", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serChg.Hps_cal_on;
            (param[8] = new OracleParameter("p_hps_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serChg.Hps_chg;
            (param[9] = new OracleParameter("p_hps_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serChg.Hps_rt;
            (param[10] = new OracleParameter("p_hps_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serChg.Hps_cre_by;
            (param[11] = new OracleParameter("p_hps_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serChg.Hps_valid_from;
            (param[12] = new OracleParameter("p_hps_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serChg.Hps_valid_to;
            (param[13] = new OracleParameter("p_hps_mgr_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serChg.Hps_mgr_comm_amt;
            (param[14] = new OracleParameter("p_hps_mgr_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serChg.Hps_mgr_comm_rt;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_saveserchgdef", CommandType.StoredProcedure, param);


            return _effect;
        }

        //written by darshana 19/04/2013
        public List<PriceSerialRef> getSerialpriceDetailsForCir(string _itm, string _cir)
        {
            List<PriceSerialRef> _serPriceDet = new List<PriceSerialRef>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[1] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedet = QueryDataTable("tblschemetype", "sp_getserialpriceforcir", CommandType.StoredProcedure, false, param);
            if (_tblschemedet.Rows.Count > 0)
            {
                _serPriceDet = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblschemedet, PriceSerialRef.Converter);
            }

            return _serPriceDet;
        }

        //writtn by darshaan 19-04-2013
        public int SaveProofDoc(HpProofDoc _tmpProofDoc)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_hsp_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tmpProofDoc.Hsp_sch_cd;
            (param[1] = new OracleParameter("p_hsp_prd_cd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tmpProofDoc.Hsp_prd_cd;
            (param[2] = new OracleParameter("p_hsp_is_required", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tmpProofDoc.Hsp_is_required;
            (param[3] = new OracleParameter("p_hsp_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tmpProofDoc.Hsp_cre_by;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_save_proof_doc", CommandType.StoredProcedure, param);


            return _effect;
        }

        //written by darshana
        public MasterProofDocs GetMasterProofDoc(string _cd)
        {

            MasterProofDocs _doc = new MasterProofDocs();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_getproofdoc", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _doc = DataTableExtensions.ToGenericList<MasterProofDocs>(_tblBrand, MasterProofDocs.Converter)[0];
            }
            return _doc;
        }

        public HpInsurance GetLatestInsurance(string _accNo)
        {
            HpInsurance insu = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_latest_insurance", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                insu = DataTableExtensions.ToGenericList<HpInsurance>(_tblBrand, HpInsurance.Converter)[0];
            }
            return insu;

        }

        public Decimal AvailableForRefund(string manualno)
        {
            OracleParameter[] param = new OracleParameter[1];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_manual", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = manualno;

            OracleParameter _outParam = new OracleParameter("c_totDue", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_check_AvailableForRefund", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        public int UpdateProfitCenterChannel(string _company, string _profitcenter, string _channel)
        {
            //sp_updateprofitctn_channel(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_channel in NVARCHAR2,o_effect out NUMBER)
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_updateprofitctn_channel", CommandType.StoredProcedure, param);


            return _effect;
        }


        public DataTable GetTotalRevAmtByInv(string _invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_gettotrevamt", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //written by darshana 30/04/2013
        //public List<HpSchemeDefinition> getSchemeByPC(string _pc, DateTime _dt)
        public DataTable getSchemeByPC(string _pc, DateTime _dt)
        {
            //List<HpSchemeDefinition> _schByPC = new List<HpSchemeDefinition>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedet = QueryDataTable("tblschemetype", "sp_getalldetbypc", CommandType.StoredProcedure, false, param);
            //if (_tblschemedet.Rows.Count > 0)
            //{
            //    _schByPC = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_tblschemedet, HpSchemeDefinition.Converter);
            //}

            return _tblschemedet;
        }

        //written by darshana 30-04-2013
        public Int32 UpdateHPSheduleInsuCancel(string _accno, string _usr)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatehpshedule_cancel", CommandType.StoredProcedure, param);
            return effects;
        }

        //writtn by darshaan 04-05-2013
        public int SavePriceDetails(PriceDetailRef _priceDet)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[48];

            (param[0] = new OracleParameter("p_sapd_pb_tp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_pb_tp_cd;
            (param[1] = new OracleParameter("p_sapd_pbk_lvl_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_pbk_lvl_cd;
            (param[2] = new OracleParameter("p_sapd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_seq_no;
            (param[3] = new OracleParameter("p_sapd_erp_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_erp_ref;
            (param[4] = new OracleParameter("p_sapd_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_itm_cd;
            (param[5] = new OracleParameter("p_sapd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_model;
            (param[6] = new OracleParameter("p_sapd_qty_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_qty_from;
            (param[7] = new OracleParameter("p_sapd_qty_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_qty_to;
            (param[8] = new OracleParameter("p_sapd_itm_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_itm_price;
            (param[9] = new OracleParameter("p_sapd_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_pb_seq;
            (param[10] = new OracleParameter("p_sapd_ser_upload", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDet.Sapd_ser_upload;
            (param[11] = new OracleParameter("p_sapd_upload_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDet.Sapd_upload_dt;
            (param[12] = new OracleParameter("p_sapd_is_cancel", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDet.Sapd_is_cancel;
            (param[13] = new OracleParameter("p_sapd_no_of_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_no_of_times;
            (param[14] = new OracleParameter("p_sapd_no_of_use_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_no_of_use_times;
            (param[15] = new OracleParameter("p_sapd_price_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_price_stus;
            (param[16] = new OracleParameter("p_sapd_warr_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_warr_remarks;
            (param[17] = new OracleParameter("p_sapd_is_allow_individual", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDet.Sapd_is_allow_individual;
            (param[18] = new OracleParameter("p_sapd_cancel_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDet.Sapd_cancel_dt;
            (param[19] = new OracleParameter("p_sapd_dp_ex_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_dp_ex_cost;
            (param[20] = new OracleParameter("p_sapd_lst_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_lst_cost;
            (param[21] = new OracleParameter("p_sapd_avg_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_avg_cost;
            (param[22] = new OracleParameter("p_sapd_margin", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_margin;
            (param[23] = new OracleParameter("p_sapd_apply_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_apply_on;
            (param[24] = new OracleParameter("p_sapd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_mod_by;
            (param[25] = new OracleParameter("p_sapd_update_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDet.Sapd_update_dt;
            (param[26] = new OracleParameter("p_sapd_day_attempt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_day_attempt;
            (param[27] = new OracleParameter("p_sapd_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_session_id;
            (param[28] = new OracleParameter("p_sapd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_cre_by;
            (param[29] = new OracleParameter("p_sapd_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDet.Sapd_from_date;
            (param[30] = new OracleParameter("p_sapd_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDet.Sapd_to_date;
            (param[31] = new OracleParameter("p_sapd_usr_ip", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_usr_ip;
            (param[32] = new OracleParameter("p_sapd_price_type", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDet.Sapd_price_type;
            (param[33] = new OracleParameter("p_sapd_circular_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_circular_no;
            (param[34] = new OracleParameter("p_sapd_customer_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_customer_cd;
            (param[35] = new OracleParameter("p_sapd_is_fix_qty", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDet.Sapd_is_fix_qty;
            (param[36] = new OracleParameter("p_sapd_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_promo_cd;
            (param[37] = new OracleParameter("p_sapd_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_batch_no;
            (param[38] = new OracleParameter("p_sapd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_doc_no;
            (param[39] = new OracleParameter("p_sapd_batch_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_batch_seqno;
            (param[40] = new OracleParameter("p_sapd_itm_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_itm_line_no;
            (param[41] = new OracleParameter("p_sapd_batch_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_batch_line_no;
            (param[42] = new OracleParameter("p_sapd_pb_seq_base", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_pb_seq_base;
            (param[43] = new OracleParameter("p_sapd_seq_no_base", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_seq_no_base;
            (param[44] = new OracleParameter("p_sapd_est_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.SAPD_EST_QTY;
            (param[45] = new OracleParameter("p_sapd_est_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.SAPD_EST_VAL;
            (param[46] = new OracleParameter("p_sapd_info_nw", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDet.Sapd_is_inform_immediatly; // add by Tharindu 
            param[47] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_savepricedet", CommandType.StoredProcedure, param);


            return _effect;
        }

        public int SavePriceDetailsCom(PriceCombinedItemRef _priceDetCom)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_SAPC_MAIN_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_main_itm_cd;
            (param[1] = new OracleParameter("p_SAPC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_itm_cd;
            (param[2] = new OracleParameter("p_SAPC_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_qty;
            (param[3] = new OracleParameter("p_SAPC_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_price;
            (param[4] = new OracleParameter("p_SAPC_PB_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_pb_seq;
            (param[5] = new OracleParameter("p_SAPC_MAIN_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_main_line;
            (param[6] = new OracleParameter("p_SAPC_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_itm_line;
            (param[7] = new OracleParameter("p_SAPC_TOT_COM", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_tot_com;
            (param[8] = new OracleParameter("p_SAPC_INCRESE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_increse;
            (param[9] = new OracleParameter("p_SAPC_SUB_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_sub_ser;
            (param[10] = new OracleParameter("p_SAPC_MAIN_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_main_ser;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_savepricecom", CommandType.StoredProcedure, param);


            return _effect;
        }

        //darshana on 05-05-2013
        public DataTable GetPromoCodesByCir(string _cir, string _promo, string _pb, string pbl)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[3] = new OracleParameter("p_pbl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbl;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_selectpromocdbycir", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //darshana on 06-05-2013
        public List<PriceDetailRef> GetPricebyCirandPromo(string _cir, string _promo)
        {
            List<PriceDetailRef> _det = new List<PriceDetailRef>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getpricebycirandpro", CommandType.StoredProcedure, false, param);
            if (tblPriceDet.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<PriceDetailRef>(tblPriceDet, PriceDetailRef.ConvertMain2);
            }

            return _det;
        }
        //kapila
        public DataTable GetPricebyCircular(string _cir, string _promo)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getpricebycircular", CommandType.StoredProcedure, false, param);

            return tblPriceDet;
        }

        //darshana on 07-05-2013
        public List<PriceProfitCenterPromotion> GetAllocPromoPc(string _com, string _promo, Int32 _pbSeq)
        {
            List<PriceProfitCenterPromotion> _det = new List<PriceProfitCenterPromotion>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[2] = new OracleParameter("p_pbSeq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbSeq;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getpcactpromo", CommandType.StoredProcedure, false, param);
            if (tblPriceDet.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<PriceProfitCenterPromotion>(tblPriceDet, PriceProfitCenterPromotion.Converter);
            }

            return _det;
        }

        //darshana on 07-05-2013
        public int SaveAppPromoPc(PriceProfitCenterPromotion _appPromoPc)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_srpr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_com;
            (param[1] = new OracleParameter("p_srpr_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_pc;
            (param[2] = new OracleParameter("p_srpr_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_promo_cd;
            (param[3] = new OracleParameter("p_srpr_pbseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_pbseq;
            (param[4] = new OracleParameter("p_srpr_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_act;
            (param[5] = new OracleParameter("p_srpr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_cre_by;
            (param[6] = new OracleParameter("p_srpr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_mod_by;
            (param[7] = new OracleParameter("p_srpr_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appPromoPc.Srpr_pty_tp;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_savepcallocpromo_new", CommandType.StoredProcedure, param);
            // _effect = (Int16)UpdateRecords("sp_savepcallocpromo", CommandType.StoredProcedure, param);


            return _effect;
        }

        //darshana on 07-05-2013
        public List<PriceDetailRef> GetPriceByPromoCD(string _promo)
        {
            List<PriceDetailRef> _det = new List<PriceDetailRef>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getpricebypromo", CommandType.StoredProcedure, false, param);
            if (tblPriceDet.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<PriceDetailRef>(tblPriceDet, PriceDetailRef.ConvertMain2);
            }

            return _det;
        }

        // Nadeeka 26-09-2015
        public List<PriceDetailRef> GetPriceByPromoCD_Sub(string _promo)
        {
            List<PriceDetailRef> _det = new List<PriceDetailRef>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getpricebypromo_sub", CommandType.StoredProcedure, false, param);
            if (tblPriceDet.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<PriceDetailRef>(tblPriceDet, PriceDetailRef.ConvertMain);
            }

            return _det;
        }

        //DARSHANA 07-05-2013
        public InvoiceHeader GetInvoiceHdrByCom(string _com, string _inv)
        {
            InvoiceHeader _det = new InvoiceHeader();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getcominvhdr", CommandType.StoredProcedure, false, param);
            if (tblPriceDet.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<InvoiceHeader>(tblPriceDet, InvoiceHeader.ConvertTotal)[0];
            }

            return _det;
        }

        //darshana on 07-05-2013
        public int SaveSimilarItems(MasterItemSimilar _saveList)
        {
            try
            {
                int _effect = 0;
                OracleParameter[] param = new OracleParameter[23];

                (param[0] = new OracleParameter("p_misi_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _saveList.Misi_seq_no;
                (param[1] = new OracleParameter("p_misi_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_tp;
                (param[2] = new OracleParameter("p_misi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_itm_cd;
                (param[3] = new OracleParameter("p_misi_sim_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_sim_itm_cd;
                (param[4] = new OracleParameter("p_misi_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _saveList.Misi_act;
                (param[5] = new OracleParameter("p_misi_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _saveList.Misi_from;
                (param[6] = new OracleParameter("p_misi_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _saveList.Misi_to;
                (param[7] = new OracleParameter("p_misi_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_com;
                (param[8] = new OracleParameter("p_misi_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_pc;
                (param[9] = new OracleParameter("p_misi_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_loc;
                (param[10] = new OracleParameter("p_misi_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_doc_no;
                (param[11] = new OracleParameter("p_misi_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_promo;
                (param[12] = new OracleParameter("p_misi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_cre_by;
                (param[13] = new OracleParameter("p_misi_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_mod_by;
                (param[14] = new OracleParameter("p_misi_py_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_pty_tp;

                //updated by akila 2017/12/29 - add new parameters
                (param[15] = new OracleParameter("p_misi_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_Itm_Tp;
                (param[16] = new OracleParameter("p_misi_vou_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_Vou_Tp;
                (param[17] = new OracleParameter("p_misi_vou_disc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_Vou_Disc_Tp;
                (param[18] = new OracleParameter("p_misi_vou_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _saveList.Misi_Vou_Value;
                (param[19] = new OracleParameter("p_misi_vou_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _saveList.Misi_Vou_Val_Period;
                //add by tharanga 2018/03/19
                (param[20] = new OracleParameter("p_misi_vou_p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_price_book;
                (param[21] = new OracleParameter("p_misi_vou_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveList.Misi_price_leval;

                param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                _effect = (Int16)UpdateRecords("sp_savesimilaritm_new", CommandType.StoredProcedure, param);
                // _effect = (Int16)UpdateRecords("sp_savesimilaritm", CommandType.StoredProcedure, param);


                return _effect;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //darshana on 07-05-2013
        public int UpdateSimilarItems(MasterItemSimilar _UpdateList)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_misi_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _UpdateList.Misi_seq_no;
            (param[1] = new OracleParameter("p_misi_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _UpdateList.Misi_act;
            (param[2] = new OracleParameter("p_misi_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateList.Misi_mod_by;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_updatesimilaritm", CommandType.StoredProcedure, param);

            return _effect;
        }


        //darshana on 07-05-2013
        public List<MasterItemSimilar> GetSimilarSetupDet(string _com, string _itm, string _tp)
        {
            List<MasterItemSimilar> _det = new List<MasterItemSimilar>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblPriceDet = QueryDataTable("tblPriceDet", "sp_getsimilaritmdet", CommandType.StoredProcedure, false, param);
            if (tblPriceDet.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<MasterItemSimilar>(tblPriceDet, MasterItemSimilar.ConverterSimilar);
            }

            return _det;
        }

        //Written By Prabhath on 08/05/2013 (Not expose to Client)
        public Int32 SaveInvoiceVoucher(List<InvoiceVoucher> InvoiceVoucher)
        {
            Int32 _effect = 0;
            //create or replace PROCEDURE sp_saveinvoicevoucher(//p_inv_no in sat_vou_det.stvo_inv_no%type ,//p_prefix in sat_vou_det.stvo_prefix%type ,//p_bookno in sat_vou_det.stvo_bookno%type ,//p_pageno in sat_vou_det.stvo_pageno%type ,//p_gv_itm in sat_vou_det.stvo_gv_itm%type ,//p_price in sat_vou_det.stvo_price%type ,//p_itm_cd in sat_vou_det.stvo_itm_cd%type ,//p_cre_by in sat_vou_det.stvo_cre_by%type ,//p_cre_when  in sat_vou_det.stvo_cre_when%type ,//o_effect out NUMBER//) 
            foreach (InvoiceVoucher _one in InvoiceVoucher)
            {
                OracleParameter[] param = new OracleParameter[10];
                (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _one.Stvo_inv_no;
                (param[1] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _one.Stvo_prefix;
                (param[2] = new OracleParameter("p_bookno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _one.Stvo_bookno;
                (param[3] = new OracleParameter("p_pageno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _one.Stvo_pageno;
                (param[4] = new OracleParameter("p_gv_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _one.Stvo_gv_itm;
                (param[5] = new OracleParameter("p_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _one.Stvo_price;
                (param[6] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _one.Stvo_itm_cd;
                (param[7] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _one.Stvo_cre_by;
                (param[8] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _one.Stvo_cre_when;
                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                _effect = (Int16)UpdateRecords("sp_saveinvoicevoucher", CommandType.StoredProcedure, param);
            }
            return _effect;
        }

        //darshana on 09-05-2013
        public Int32 SavePcPriceDefinition(PriceDefinitionRef _priceDef)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_p_lvl;
            (param[3] = new OracleParameter("p_is_bank_ex_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_is_bank_ex_rt;
            (param[4] = new OracleParameter("p_is_disc", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_is_disc;
            (param[5] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDef.Sadd_disc_rt;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_com;
            (param[7] = new OracleParameter("p_chk_credit_bal", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_chk_credit_bal;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_cre_by;
            (param[9] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDef.Sadd_cre_when;
            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_mod_by;
            (param[11] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDef.Sadd_mod_when;
            (param[12] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_pb;
            (param[13] = new OracleParameter("p_def", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sadd_def;
            (param[14] = new OracleParameter("p_def_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_def_stus;
            (param[15] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_prefix;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_sar_pc_price_defn", CommandType.StoredProcedure, param);
            return effects;
        }

        //Isuru 2017/03/17
        public Int32 SaveBrandMangerDtL(mst_brnd_alloc _managerdetailsList)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_com;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_pty_tp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_pty_cd;
            (param[3] = new OracleParameter("p_emp_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_emp_id;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_brnd;
            (param[5] = new OracleParameter("p_ca1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_ca1;
            (param[6] = new OracleParameter("p_ca2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_ca2;
            (param[7] = new OracleParameter("p_ca3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_ca3;
            (param[8] = new OracleParameter("p_ca4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_ca4;
            (param[9] = new OracleParameter("p_ca5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_ca5;
            (param[10] = new OracleParameter("p_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_frm_dt;
            (param[11] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_to_dt;
            (param[12] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_act;
            (param[13] = new OracleParameter("p_crt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_cre_by;
            (param[14] = new OracleParameter("p_crt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_cre_dt;
            (param[15] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_mod_by;
            (param[16] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_mod_dt;
            (param[17] = new OracleParameter("P_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _managerdetailsList.Mba_seq;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_brnd_manager_get", CommandType.StoredProcedure, param);
            return effects;
        }


        // Nadeeka
        public Int32 SavePcPriceDefinitionsChannel(SAR_DOC_CHANNEL_PRICE_DEFN _priceDef)
        {
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_schannel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_sub_chanl;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_p_lvl;
            (param[3] = new OracleParameter("p_is_bank_ex_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_is_bank_ex_rt;
            (param[4] = new OracleParameter("p_is_disc", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_is_disc;
            (param[5] = new OracleParameter("p_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_disc_rt;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_com;
            (param[7] = new OracleParameter("p_chk_credit_bal", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_chk_credit_bal;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_cre_by;
            (param[9] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_cre_when;
            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_mod_by;
            (param[11] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_mod_when;
            (param[12] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_pb;
            (param[13] = new OracleParameter("p_def", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_def;
            (param[14] = new OracleParameter("p_def_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sdcp_def_stus;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_sar_doc_chnl_price_def", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 10-05-2013
        public Int32 RemovePriceAccess(string p_pc, string p_invTp, string p_lvl, string p_com, string p_pb, string p_usr)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_invTp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_lvl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pb;
            (param[5] = new OracleParameter("p_mod_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_usr;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_remove_price_access", CommandType.StoredProcedure, param);
            return effects;
        }
        // Nadeeka
        public Int32 RemovePriceAccessSubChannel(string p_schannel, string p_invTp, string p_lvl, string p_com, string p_pb, string p_usr)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_schannel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_schannel;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_invTp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_lvl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pb;
            (param[5] = new OracleParameter("p_mod_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_usr;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_remove_price_access_channel", CommandType.StoredProcedure, param);
            return effects;
        }

        // Nadeeka
        public Int32 AssignChannelAccestoPC(string p_schannel, string p_pc, string p_com, string p_usr)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[1] = new OracleParameter("p_schannel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_schannel;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[3] = new OracleParameter("p_mod_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_usr;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_pc_channel_price_book", CommandType.StoredProcedure, param);
            return effects;
        }
        // Nadeeka
        public Int32 CheckAssignChannel(string p_schannel, string p_com)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_schannel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_schannel;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_pc_channel_price_book_check", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 CheckAssignChannelDef(string p_schannel, string p_com)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_schannel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_schannel;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_pc_chal_price_book_chk_def", CommandType.StoredProcedure, param);
            return effects;
        }


        public List<HpSchemeDetails> GetSchemeByType_orCode(string _schtp, string _schcode)
        {
            //p_schType in NVARCHAR2,
            //p_schCode in NVARCHAR2,
            //c_data out sys_refcursor         

            List<HpSchemeDetails> _Ref = new List<HpSchemeDetails>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_schType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schtp;
            (param[1] = new OracleParameter("p_schCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schcode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getschemes_ON_TP_CODE", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _Ref = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tbl, HpSchemeDetails.Converter);
            }

            return _Ref;

        }
        public List<HpSchemeDetails> GetSchmeDet_on_term_tp(string _schtp, string _schcode, string term)
        {
            List<HpSchemeDetails> _Ref = new List<HpSchemeDetails>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_schType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schtp;
            (param[1] = new OracleParameter("p_schCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schcode;
            (param[2] = new OracleParameter("p_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = term;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getSchmeDet_on_term_tp", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _Ref = DataTableExtensions.ToGenericList<HpSchemeDetails>(_tbl, HpSchemeDetails.Converter);
            }

            return _Ref;

        }

        public Int32 Save_hpr_ecd_vou_defn(ECDVoucher evdVouDef)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_pc;
            (param[1] = new OracleParameter("p_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_sch_cd;
            (param[2] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_from_dt;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_to_dt;
            (param[4] = new OracleParameter("p_from_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_from_bal;
            (param[5] = new OracleParameter("p_to_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_to_bal;
            (param[6] = new OracleParameter("p_ecd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_ecd_val;
            (param[7] = new OracleParameter("p_is_rt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_is_rt;
            (param[8] = new OracleParameter("p_is_prc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_is_prc;
            (param[9] = new OracleParameter("p_prc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_prc_dt;

            (param[10] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_cre_by;
            (param[11] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_cre_dt;
            (param[12] = new OracleParameter("p_acc_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_acc_cr_from;
            (param[13] = new OracleParameter("p_acc_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = evdVouDef.Hvd_acc_cr_to;
            //p_seq
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_hpr_ecd_vou_defn", CommandType.StoredProcedure, param);
            return effects;

        }

        //Shani on 11-05-2013
        public DataTable Get_ecd_vou_defn_PClist(DateTime fromDt, DateTime toDt)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[1] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "get_ecd_vou_defn_PClist", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Shani on 11-05-2013
        public DataTable Get_ecd_vou_defn_SchmList(string pc, DateTime fromDt, DateTime toDt)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[1] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "get_ecd_vou_defn_SchmList", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetInvoiceVoucher(string _invoice, string _item)
        {
            //sp_getinvoicevoucher(p_invoice in NVARCHAR2,p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblGv", "sp_getinvoicevoucher", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Shani on 11-05-2013
        public ECDVoucher Get_ecd_vou_defn_onSeq(Int32 _seq)
        {
            //List<ECDVoucher> _Ref = new List<ECDVoucher>();
            ECDVoucher _Ref = new ECDVoucher();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "get_ecd_vou_defn_onSeq", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _Ref = DataTableExtensions.ToGenericList<ECDVoucher>(_tbl, ECDVoucher.Converter)[0];
            }
            return _Ref;
        }
        //Shani on 11-05-2013
        public List<HpAccount> get_acc_forVouchers(string pc, string sheme, DateTime fromDate, DateTime toDate, Decimal fromBal, Decimal toBal)
        {
            //(p_schemeCd in NVARCHAR2, p_createFromDt in Date,p_createToDt in Date, p_pc in NVARCHAR2,p_from_bal in NUMBER,p_to_bal in NUMBER, c_data out sys_refcursor)
            List<HpAccount> _userList = new List<HpAccount>();
            //( p_from_bal in NUMBER,p_to_bal in NUMBER, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_schemeCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sheme;
            (param[1] = new OracleParameter("p_createFromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[2] = new OracleParameter("p_createToDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_from_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = fromBal;
            (param[5] = new OracleParameter("p_to_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = toBal;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "getAccFor_ecd_schems", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            }

            return _userList;
        }
        //Shani on 13-05-2013
        public Int32 Update_voucher_Process_status(Int32 p_seq, DateTime currentDt)
        {
            //(p_seq IN NVARCHAR2,p_prcDate in DATE,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_seq;
            (param[1] = new OracleParameter("p_prcDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = currentDt.Date;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_ecd_vou_defn_prc", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Update_ECD_as_Sent_SMS(string _accno, string _user)
        {//Sanjeewa 2016-06-02
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_ecd_as_sms_sent", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable Get_voucher_details(string voucherNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_voucherNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblvou", "sp_getVoucher", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }

        public DataTable Get_vouchers_to_Print(string pc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblvou", "get_vouchersToPrint", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }

        //Shani on 14-05-2013
        public DataTable Get_ecdDefnVoucher_PClist(DateTime fromDt, DateTime toDt)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[1] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "get_ecdDefn_PClist", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Shani on 14-05-2013
        public DataTable Get_ecd_vou_defn_For_Print_SchmList(string pc, DateTime fromDt, DateTime toDt)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[1] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "get_ecd_vou_defn_PrintSchmList", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_VoucherOnSchemeRate(string pc, string scheme, DateTime fromDt, DateTime toDt, Decimal rateOrAmt)
        {
            //p_rateOrAmt
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_schemeCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scheme;
            (param[2] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[3] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[4] = new OracleParameter("p_rateOrAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rateOrAmt;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getVoucherOnSchemeRate", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ECD_vouchers_Print(string voucherNo)
        { // Nadeeka 14-05-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblvou", "sp_get_ECD_Voucher", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }

        public DataTable SummaryOfWeekly(DateTime _fromDate, DateTime _toDate, string _com, string _pc)
        { // Nadeeka 07-11-2014
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults = QueryDataTable("tbldata", "pkg_summary_of_weekly.SP_SUMMARY_OF_WEEKLY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable UnusedReceiptReport(DateTime _fromDate, DateTime _toDate, string _user, string _com, string _pc)
        { // Nadeeka 16-05-2013
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            //DataTable _tblProfitCenter = QueryDataTable("tblvou", "pkg_hp_sales_scm2.PROC_HS_UNUSED_RECIPTS_REPORT", CommandType.StoredProcedure, false, param);
            //DataTable _tblProfitCenter = QueryDataTable("tblvou", "thara_20180404", CommandType.StoredProcedure, false, param);
           // DataTable _tblProfitCenter = QueryDataTable("tblvou", "PROC_HS_UNUSED_RECI_RPT_NEW", CommandType.StoredProcedure, false, param);
            DataTable _tblProfitCenter = QueryDataTable("tblvou", "PROC_HS_UNUSED_RECIPTS", CommandType.StoredProcedure, false, param);
            return _tblProfitCenter;
        }
        public Int32 Update_ECD_Voucher_printStatus(string voucherNo, string printBy, DateTime printDate)
        {
            //p_voucherNo in NVARCHAR2,p_printDt in Date,p_printBy in NVARCHAR2,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_voucherNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            (param[1] = new OracleParameter("p_printDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = printDate;
            (param[2] = new OracleParameter("p_printBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = printBy;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_Update_ecdVou_PrintStatus", CommandType.StoredProcedure, param);
            return effects;

        }

        public int UpdateCreditNoteBalance(string com, string pc, string invoice, decimal amo)
        {

            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("p_amo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = amo;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_creditnote", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SavePromotionalDiscountHeader(CashPromotionDiscountHeader _hdr)
        {
            OracleParameter[] param = new OracleParameter[25];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_spdh_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_seq;
            (param[1] = new OracleParameter("p_spdh_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_circular;
            (param[2] = new OracleParameter("p_spdh_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_sale_tp;
            (param[3] = new OracleParameter("p_spdh_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_pty_tp;
            (param[4] = new OracleParameter("p_spdh_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_pty_cd;
            (param[5] = new OracleParameter("p_spdh_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Spdh_from_dt;
            (param[6] = new OracleParameter("p_spdh_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Spdh_to_dt;
            (param[7] = new OracleParameter("p_spdh_dis_itm_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Spdh_dis_itm_tp;
            (param[8] = new OracleParameter("p_spdh_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_brd;
            (param[9] = new OracleParameter("p_spdh_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_cat1;
            (param[10] = new OracleParameter("p_spdh_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_cat2;
            (param[11] = new OracleParameter("p_spdh_cat3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hdr.Spdh_cat3;
            (param[12] = new OracleParameter("p_spdh_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_itm;
            (param[13] = new OracleParameter("p_spdh_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_ser;
            (param[14] = new OracleParameter("p_spdh_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_pro;
            (param[15] = new OracleParameter("p_spdh_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Spdh_stus;
            (param[16] = new OracleParameter("p_spdh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_cre_by;
            (param[17] = new OracleParameter("p_spdh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Spdh_cre_dt;
            (param[18] = new OracleParameter("p_spdh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Spdh_mod_by;
            (param[19] = new OracleParameter("p_spdh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Spdh_mod_dt;
            (param[20] = new OracleParameter("p_spdh_no_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Spdh_no_times;
            (param[21] = new OracleParameter("p_spdh_used_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Spdh_used_times;
            (param[22] = new OracleParameter("p_spdh_is_alw_normal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Spdh_is_alw_normal;
            (param[23] = new OracleParameter("p_spdh_apply_for_tot_inv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.ApplyForTotalInvoice;

            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_pro_disc_hdr", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SavePromotionalDiscountDetails(CashPromotionDiscountDetail _det)
        {
            OracleParameter[] param = new OracleParameter[31];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_spdd_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_seq;
            (param[1] = new OracleParameter("p_spdd_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_line;
            (param[2] = new OracleParameter("p_spdd_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_sale_tp;
            (param[3] = new OracleParameter("p_spdd_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Spdd_from_dt;
            (param[4] = new OracleParameter("p_spdd_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Spdd_to_dt;
            (param[5] = new OracleParameter("p_spdd_from_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_from_time;
            (param[6] = new OracleParameter("p_spdd_to_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_to_time;
            (param[7] = new OracleParameter("p_spdd_day", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_day;
            (param[8] = new OracleParameter("p_spdd_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_cust_cd;
            (param[9] = new OracleParameter("p_spdd_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_pb;
            (param[10] = new OracleParameter("p_spdd_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_pb_lvl;
            (param[11] = new OracleParameter("p_spdd_alw_ser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_alw_ser;
            (param[12] = new OracleParameter("p_spdd_alw_pro", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_alw_pro;
            (param[13] = new OracleParameter("p_spdd_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_pay_tp;
            (param[14] = new OracleParameter("p_spdd_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_bank;
            (param[15] = new OracleParameter("p_spdd_cc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_cc_tp;
            (param[16] = new OracleParameter("p_spdd_alw_cc_pro", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_alw_cc_pro;
            (param[17] = new OracleParameter("p_spdd_disc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Spdd_disc_val;
            (param[18] = new OracleParameter("p_spdd_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Spdd_disc_rt;
            (param[19] = new OracleParameter("p_spdd_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_stus;
            (param[20] = new OracleParameter("p_spdd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_cre_by;
            (param[21] = new OracleParameter("p_spdd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Spdd_cre_dt;
            (param[22] = new OracleParameter("p_spdd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Spdd_mod_by;
            (param[23] = new OracleParameter("p_spdd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Spdd_mod_dt;
            (param[24] = new OracleParameter("p_spdd_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Spdd_from_val;
            (param[25] = new OracleParameter("p_spdd_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Spdd_to_val;
            (param[26] = new OracleParameter("p_Spdd_from_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Spdd_from_qty;
            (param[27] = new OracleParameter("p_Spdd_to_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Spdd_to_qty;
            (param[28] = new OracleParameter("p_spdd_alw_mult", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_alw_mult;
            (param[29] = new OracleParameter("p_spdd_cc_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Spdd_cc_pd;

            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_pro_dis_det", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SavePromotionalDiscountItem(CashPromotionDiscountItem _itm)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_spdi_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Spdi_seq;
            (param[1] = new OracleParameter("p_spdi_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Spdi_line;
            (param[2] = new OracleParameter("p_spdi_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Spdi_itm;
            (param[3] = new OracleParameter("p_spdi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Spdi_cre_by;
            (param[4] = new OracleParameter("p_spdi_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Spdi_cre_dt;

            (param[5] = new OracleParameter("p_spdi_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Spdi_act;
            (param[6] = new OracleParameter("p_spdi_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Spdi_mod_by;
            (param[7] = new OracleParameter("p_spdi_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Spdi_mod_dt;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_pro_dis_itm", CommandType.StoredProcedure, param);
            return effects;


        }

        public int SavePromotionalDiscountLocation(CashPromotionDiscountLocation _loc)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_spdl_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Spdl_seq;
            (param[1] = new OracleParameter("p_spdl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Spdl_com;
            (param[2] = new OracleParameter("p_spdl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Spdl_pc;
            (param[3] = new OracleParameter("p_spdl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Spdl_cre_by;
            (param[4] = new OracleParameter("p_spdl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Spdl_cre_dt;

            (param[5] = new OracleParameter("p_spdl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Spdl_act;
            (param[6] = new OracleParameter("p_spdl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Spdl_mod_by;
            (param[7] = new OracleParameter("p_spdl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Spdl_mod_dt;
            (param[8] = new OracleParameter("p_spdl_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Spdl_pty_tp;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_pr_dis_loc_new", CommandType.StoredProcedure, param);
            return effects;


        }

        public int UpdatePromotionlDiscountStatus(string _cir)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_pro_dis_sts", CommandType.StoredProcedure, param);
            return effects;
        }



        public DataTable GetVehicalRegistrationReciept(string _acc)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;

            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tblvou", "sp_getvehreg", CommandType.StoredProcedure, false, param);

            return _tbl;

        }

        //Shani on 11-05-2013
        public InvoiceHeader get_CrNote(string _inv, string _com, string _pc)
        {

            InvoiceHeader _userList = new InvoiceHeader();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_searchcrnote", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResults, InvoiceHeader.ConvertTotal)[0];
            }

            return _userList;
        }

        public DataTable GetPriceTypeByIndent(int _indentseq)
        {
            // sp_getpricetypebyseq(p_indent in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_indent", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _indentseq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("_dtResults", "sp_getpricetypebyseq", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<HpSchemeDefinition> GetSchemeDetailsByCir(string _cir)
        {
            List<HpSchemeDefinition> _schList = new List<HpSchemeDefinition>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_searchschbycir", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _schList = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_dtResults, HpSchemeDefinition.Converter);
            }

            return _schList;
        }

        public Int32 UpdateSchemeStatus(string _cir, string _stus, string _usr)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[2] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_updateschcommaproved", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Save_Serial_Price(PriceSerialRef _serial)
        {
            OracleParameter[] param = new OracleParameter[23];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SARS_PBOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_pbook;
            (param[1] = new OracleParameter("p_SARS_PRICE_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_price_lvl;
            (param[2] = new OracleParameter("p_SARS_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_itm_cd;
            (param[3] = new OracleParameter("p_SARS_SER_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_ser_no;
            (param[4] = new OracleParameter("p_SARS_VAL_FRM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Sars_val_frm;
            (param[5] = new OracleParameter("p_SARS_VAL_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Sars_val_to;
            (param[6] = new OracleParameter("p_SARS_ITM_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.Sars_itm_price;
            (param[7] = new OracleParameter("p_SARS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_cre_by;
            (param[8] = new OracleParameter("p_SARS_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Sars_cre_when;
            (param[9] = new OracleParameter("p_SARS_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_mod_by;
            (param[10] = new OracleParameter("p_SARS_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Sars_mod_when;
            (param[11] = new OracleParameter("p_SARS_PB_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Sars_pb_seq;
            (param[12] = new OracleParameter("p_SARS_IS_CANCEL", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serial.Sars_is_cancel;
            (param[13] = new OracleParameter("p_SARS_WARR_REMARKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_warr_remarks;
            (param[14] = new OracleParameter("p_SARS_HP_ALLOWED", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serial.Sars_hp_allowed;
            (param[15] = new OracleParameter("p_SARS_UPDATE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Sars_update_dt;
            (param[16] = new OracleParameter("p_SARS_DAY_ATTEMPT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Sars_day_attempt;
            (param[17] = new OracleParameter("p_sars_price_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Sars_price_type;
            (param[18] = new OracleParameter("p_sars_circular_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_circular_no;
            (param[19] = new OracleParameter("p_sars_customer_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_customer_cd;
            (param[20] = new OracleParameter("p_sars_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Sars_promo_cd;
            (param[21] = new OracleParameter("p_sars_pb_seq_base", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Sars_pb_seq_base;

            //p_seq
            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_serial_price", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 CreateSchCommLog(HpSchemeDefinitionLog _SchDefLog)
        {
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hscl_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_cir;
            (param[1] = new OracleParameter("p_hscl_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_valid_from;
            (param[2] = new OracleParameter("p_hscl_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_valid_to;
            (param[3] = new OracleParameter("p_hscl_dp_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_dp_comm;
            (param[4] = new OracleParameter("p_hscl_inst_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_inst_comm;
            (param[5] = new OracleParameter("p_hscl_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_dis;
            (param[6] = new OracleParameter("p_hscl_restrict", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_restrict;
            (param[7] = new OracleParameter("p_hscl_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_usr;
            (param[8] = new OracleParameter("p_hscl_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_rmk;
            (param[9] = new OracleParameter("p_hscl_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_anal1;
            (param[10] = new OracleParameter("p_hscl_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_anal2;
            (param[11] = new OracleParameter("p_hscl_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_anal3;
            (param[12] = new OracleParameter("p_hscl_anal4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_anal4;
            (param[13] = new OracleParameter("p_hscl_anal5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_anal5;
            (param[14] = new OracleParameter("p_hscl_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchDefLog.Hscl_session;

            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_saveschcommlog", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateGeneralSchemDef(DateTime _dt, decimal _rate, Int16 _isRate, string _cir, string _usr, string _type, string _stus)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[1] = new OracleParameter("p_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _rate;
            (param[2] = new OracleParameter("p_isRate", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isRate;
            (param[3] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[6] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateschgeneral", CommandType.StoredProcedure, param);
            return effects;
        }


        public Int32 RemoveTmpCirScheme(string _cir)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_removetmpcir", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<HpSchemeDefinition> GetAllSchemeCirculars()
        {
            List<HpSchemeDefinition> _schList = new List<HpSchemeDefinition>();

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_getallschcirculars", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _schList = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_dtResults, HpSchemeDefinition.ConverterSpecial);
            }

            return _schList;
        }


        public Int32 UpdateAddPricingParam(string _user, Boolean _age, string _msg, Boolean _cus, string _lvl, string _book, string _com)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_age", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _age;
            (param[2] = new OracleParameter("p_msg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msg;
            (param[3] = new OracleParameter("p_cus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _cus;
            (param[4] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            (param[5] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateaddpriceparam", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Prabhath on 28/05/2013 - not expose to client
        public List<LoyaltyPointDefinition> GetLoyaltyDefinition(string _loyaltytype, string _membership, string _partytype, string _partycode, string _book, string _level, DateTime _date, Int32 _alwDis, Int32 _pTp, Int32 _alwIns, string inv_tp = null)
        {
            //sp_getloyaltydefinition(p_loltype in NVARCHAR2,p_membership in NVARCHAR2,,p_partytype in NVARCHAR2,p_partycode in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_date in DATE,c_data out sys_refcursor)
            List<LoyaltyPointDefinition> _list = new List<LoyaltyPointDefinition>();
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_loltype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltytype;
            (param[1] = new OracleParameter("p_membership", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _membership;
            (param[2] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partytype;
            (param[3] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycode;
            (param[4] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[5] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[7] = new OracleParameter("p_alw_dis", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _alwDis;
            (param[8] = new OracleParameter("p_alw_ptp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pTp;
            (param[9] = new OracleParameter("p_alw_ins", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _alwIns;
            (param[10] = new OracleParameter("p_minv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv_tp;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbllol", "sp_getloyaltydefinition", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<LoyaltyPointDefinition>(_dtResults, LoyaltyPointDefinition.Converter);

            return _list;
        }

        //Written by Prabhath on 03/06/2013 - not expose to client
        public int UpdateLoyaltyCardPoint(string _customer, string _cardn, decimal _point, string _user)
        {
            //sp_updatecardmember(p_customer in NVARCHAR2,p_cardno in NVARCHAR2,p_point in NUMBER,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[1] = new OracleParameter("p_cardno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardn;
            (param[2] = new OracleParameter("p_point", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _point;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatecardmember", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable GetLoyaltyCardDetail(string _customer, string _cardno)
        {
            //sp_getloyaltycardtype(p_customer in NVARCHAR2,p_cardno in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[1] = new OracleParameter("p_cardno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("_dtResults", "sp_getloyaltycardtype", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //darshana on 12-04-2013
        public Int16 SaveNewSchemeCommProcess(HpSchemeDefinitionProcess _schSchemeCommDef)
        {
            OracleParameter[] param = new OracleParameter[27];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_hpc_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_sch_cd;
            (param[1] = new OracleParameter("p_hpc_cir_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cir_no;
            (param[2] = new OracleParameter("p_hpc_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pty_tp;
            (param[3] = new OracleParameter("p_hpc_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pty_cd;
            (param[4] = new OracleParameter("p_hpc_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_from_dt;
            (param[5] = new OracleParameter("p_hpc_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_to_dt;
            (param[6] = new OracleParameter("p_hpc_comm_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_comm_cat;
            (param[7] = new OracleParameter("p_hpc_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cust_cd;
            (param[8] = new OracleParameter("p_hpc_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pb;
            (param[9] = new OracleParameter("p_hpc_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pb_lvl;
            (param[10] = new OracleParameter("p_hpc_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_brd;
            (param[11] = new OracleParameter("p_hpc_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_main_cat;
            (param[12] = new OracleParameter("p_hpc_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cat;
            (param[13] = new OracleParameter("p_hpc_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_itm;
            (param[14] = new OracleParameter("p_hpc_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_ser;
            (param[15] = new OracleParameter("p_hpc_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_pro;
            (param[16] = new OracleParameter("p_hpc_dp_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_dp_comm;
            (param[17] = new OracleParameter("p_hpc_inst_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_inst_comm;
            (param[18] = new OracleParameter("p_hpc_disc", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_disc;
            (param[19] = new OracleParameter("p_hpc_disc_isrt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_disc_isrt;
            (param[20] = new OracleParameter("p_hpc_is_alw", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_is_alw;
            (param[21] = new OracleParameter("p_hpc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_cre_by;
            (param[22] = new OracleParameter("p_hpc_price_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_price_cir_no;

            (param[23] = new OracleParameter("p_hpc_is_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_is_rt;
            (param[24] = new OracleParameter("p_hpc_fpay", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hpc_fpay;
            (param[25] = new OracleParameter("p_hpc_fpay_withvat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Hsd_add_calwithvat;

            param[26] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sch_comm_process", CommandType.StoredProcedure, param);

            return effects;
        }

        public int DeleteHPSchProcess(string _user)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_deleteschprocess", CommandType.StoredProcedure, param);

            return effect;
        }

        public List<HpSchemeDefinitionProcess> GetSchemeProByUser(string _User)
        {
            List<HpSchemeDefinitionProcess> _schList = new List<HpSchemeDefinitionProcess>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_searchproschbyuser", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _schList = DataTableExtensions.ToGenericList<HpSchemeDefinitionProcess>(_dtResults, HpSchemeDefinitionProcess.Converter);
            }

            return _schList;
        }

        //written by Darshana 04/06/2013
        public DataTable GetSchItembyCir(string _cir)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_searchschitmbycir", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        //written by Darshana 04/06/2013
        public DataTable GetSchPCbyCir(string _cir)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_searchschpcbycir", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        //written by Darshana 04/06/2013
        public DataTable GetSchShedulebyCir(string _cir)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_searchshedulebycir", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }


        public DataTable GetItemsByCateAndBrandNew(string _mainCate, string _subCate, string _itmRange, string _brand, string _com)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCate;
            (param[1] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subCate;
            (param[2] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmRange;
            (param[3] = new OracleParameter("p_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getitembycatebrdfordt", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        //written by Darshana 04/06/2013
        public DataTable GetSchPromobyCir(string _cir)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_searchschprobycir", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        //written by Darshana 04/06/2013
        public DataTable GetSchCusbyCir(string _cir)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblReceiptDivision = QueryDataTable("tbl", "sp_searchcusbycir", CommandType.StoredProcedure, false, param);


            return _tblReceiptDivision;
        }

        public LoyaltyType GetLoyaltyType(string _type)
        {
            LoyaltyType type = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_loty_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_loty_tp", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                type = DataTableExtensions.ToGenericList<LoyaltyType>(_tbl, LoyaltyType.Converter)[0];
            }
            return type;

        }

        public LoyaltyPointRedeemDefinition GetLoyaltyRedeemDefinition(string prtTp, string prt, DateTime date, string loyalty)
        {

            LoyaltyPointRedeemDefinition type = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_loyalty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loyalty;
            (param[1] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prtTp;
            (param[2] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prt;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_loyalty_redeem_def", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                type = DataTableExtensions.ToGenericList<LoyaltyPointRedeemDefinition>(_tbl, LoyaltyPointRedeemDefinition.Converter)[0];
            }
            return type;
        }

        public DataTable GetHPAccountFromDate(DateTime _from, DateTime _to, string _com, string _pc)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_acc_by_date", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable GetPcFromHirarchey(string _val, string _ptype)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _val;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptype;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_pc_from_hir", CommandType.StoredProcedure, false, param);

            return _tbl;

        }

        public DataTable GetCircularNo(string _circular)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;


            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_circular_no", CommandType.StoredProcedure, false, param);


            return _tbl;

        }

        public GroupSaleCustomer GetGroupSaleDetByCus(string _grpCd, string _grpCus)
        {
            GroupSaleCustomer type = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_grpCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCd;
            (param[1] = new OracleParameter("p_cusCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCus;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_grpdetbycusncd", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                type = DataTableExtensions.ToGenericList<GroupSaleCustomer>(_tbl, GroupSaleCustomer.Converter)[0];
            }
            return type;
        }

        public DataTable GetGrpNoOfAccByCus(string _com, string _tp, string _cus, string _pc, string _grpCd)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_grpCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCd;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getnoofaccbycus", CommandType.StoredProcedure, false, param);


            return _tbl;

        }

        public DataTable GetGrpCusCashVal(string _com, string _tp, string _cus, string _pc, string _grpCd)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_grpCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCd;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_gettotcashvalforgscus", CommandType.StoredProcedure, false, param);


            return _tbl;

        }

        public DataTable GetGrpCusNoofItms(string _com, string _tp, string _cus, string _pc, string _grpCd)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_grpCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grpCd;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_getnoofitmforgroupcus", CommandType.StoredProcedure, false, param);


            return _tbl;

        }

        //Shani on 11-05-2013
        public DataTable Get_Processed_ecd_vou_defn_PClist(DateTime fromDt, DateTime toDt)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[1] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "get_processed_ecd_vou_PClist", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public LoyaltyMemeber GetLoyaltyMemberByCard(string _cardNo)
        {
            LoyaltyMemeber _member = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_loyal_member_no", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _member = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_dtResults, LoyaltyMemeber.Converter)[0];
            }
            return _member;
        }


        public DataTable checkAppStatus(string _com, string _loc, string _tp, string _mod)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[3] = new OracleParameter("p_mod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_checkapprovalstatus", CommandType.StoredProcedure, false, param);


            return _tbl;

        }
        public DataTable GetRecievedDocFor_VehReg(string userID)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_Reg_recievedDocForSend", CommandType.StoredProcedure, false, param);

        }
        public DataTable Get_DocDet_For_VehReg(string recieptNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_recieptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recieptNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_RegDocs_ForSend", CommandType.StoredProcedure, false, param);

        }

        //SHANI 2013/06/11
        public int Update_veh_DocReg(Int32 seq, Int32 line, DateTime recDate, string remark, string recBy)
        {
            //(p_seq IN NUMBER,p_line in NUMBER,p_recDt in DATE,p_recRmk in NVARCHAR2,p_recBy in NVARCHAR2, o_effect OUT NUMBER)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            (param[2] = new OracleParameter("p_recDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = recDate;
            (param[3] = new OracleParameter("p_recRmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remark;
            (param[4] = new OracleParameter("p_recBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recBy;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_vehDocREC", CommandType.StoredProcedure, param);
            return effects;
        }

        public int Update_veh_DocReg_Final(Int32 seq, DateTime recDate, string FinRemark, string recBy)
        {
            //sp_update_vehDocREC_final (p_seq IN NUMBER,p_recDt in DATE,p_recRmk in NVARCHAR2,p_recBy in NVARCHAR2, o_effect OUT NUMBER)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_recDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = recDate;
            (param[2] = new OracleParameter("p_recRmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FinRemark;
            (param[3] = new OracleParameter("p_recBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recBy;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_vehDocREC_final", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetVehicalDocumentProcess(string _com, string _loc, string _invoice, string _engine, string _chassis, string _reciept, string _vehNo)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[4] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[5] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[6] = new OracleParameter("p_veh", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_doc_pro_tracking", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetVehicalDocummentDetail(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_doc_pro_det", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetVehicalRMVNotSendDetails(string _com, string _loc, string _invoice, string _engine, string _chassis, string _reciept, string _vehNo)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[4] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[5] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[6] = new OracleParameter("p_veh", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_doc_trk", CommandType.StoredProcedure, false, param);
        }

        //Written by Prabhath on 12/06/2013 (avoid expose to client)
        public int RedeemLoyaltyPoint(string _cardno, string _customer, decimal _points)
        {
            //sp_redeemloyalty(p_cardno in NVARCHAR2,p_customer in NVARCHAR2,p_point in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cardno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[2] = new OracleParameter("p_point", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _points;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_redeemloyalty", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveInvoiceLoyalty(InvoiceLoyalty _loyalty)
        {
            // sp_saveinvoiceloyalty(p_seq_no in sat_loyalty.stlt_seq_no%type, p_inv_no in sat_loyalty.stlt_inv_no%type, p_pt in  sat_loyalty.stlt_pt%type,o_effect out NUMBER) 
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loyalty.Stlt_seq_no;
            (param[1] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyalty.Stlt_inv_no;
            (param[2] = new OracleParameter("p_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loyalty.Stlt_pt;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_saveinvoiceloyalty", CommandType.StoredProcedure, param);
            return effects;

        }

        //Written by Prabhath on 12/06/2013 (avoid expose to client)
        public InvoiceLoyalty GetInvoiceLoyalty(string _invoice)
        {
            //sp_getinvoiceloyalty(p_invoice in NVARCHAR2,c_data out sys_refcursor)
            InvoiceLoyalty _lol = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl_lol", "sp_getinvoiceloyalty", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                _lol = DataTableExtensions.ToGenericList<InvoiceLoyalty>(_tbl, InvoiceLoyalty.Converter)[0];
            }
            return _lol;

        }

        public int Update_veh_DocPay(Int32 seq, DateTime payDate, string payRemark, string payBy)
        {
            //sp_update_vehSendPay (p_seq IN NUMBER,p_payDt in DATE,p_payRmk in NVARCHAR2,p_payBy in NVARCHAR2, o_effect OUT NUMBER)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_payDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = payDate;
            (param[2] = new OracleParameter("p_payRmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payRemark;
            (param[3] = new OracleParameter("p_payBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payBy;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_vehSendPay", CommandType.StoredProcedure, param);
            return effects;
        }

        public int Update_veh_Collect_Cheque(Int32 seq, DateTime collDate, string collRemark, string collBy, string chequeNo, Int32 isCollect)
        {
            //sp_update_vehCollectChq (p_seq IN NUMBER,p_collDt in DATE,p_collRmk in NVARCHAR2,p_collBy in NVARCHAR2, o_effect OUT NUMBER)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_collDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = collDate;
            (param[2] = new OracleParameter("p_collRmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = collRemark;
            (param[3] = new OracleParameter("p_collBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = collBy;
            (param[4] = new OracleParameter("p_chqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chequeNo;
            (param[5] = new OracleParameter("p_isCollect", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isCollect;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_vehCollectChq", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable Get_IssuedDocFor_VehReg(string userID, string receiptNo, string invoiceNo, string engineNo, string chassisNo)
        {
            //sp_get_Reg_IssuedDocs(p_userID in NVARCHAR2,p_receiptNo in NVARCHAR2,p_invoiceNo in NVARCHAR2,p_engine in NVARCHAR2,p_chassis in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userID;
            (param[1] = new OracleParameter("p_receiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = receiptNo;
            (param[2] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;

            (param[3] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = engineNo;
            (param[4] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chassisNo;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_Reg_IssuedDocs", CommandType.StoredProcedure, false, param);
        }

        public int Update_Veh_RMVSend(string _inv, string _rec, string _eng, string _cha, DateTime _dt, string _rmk)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[2] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eng;
            (param[3] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cha;
            (param[4] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[5] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_veh_send_rmv", CommandType.StoredProcedure, param);
            return effects;

        }

        public int Update_Veh_submit_Date(string _reg, DateTime _dt, string _ref)
        { // Nadeeka 05-11-2015
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_reg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg;
            (param[1] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_veh_send_date", CommandType.StoredProcedure, param);
            return effects;

        }


        public int Update_CR_Recieve(string _inv, string _rec, string _eng, string _cha, DateTime _dt, string _rmk, string _no)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[2] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eng;
            (param[3] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cha;
            (param[4] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[5] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk;
            (param[6] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _no;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_veh_crrec", CommandType.StoredProcedure, param);
            return effects;

        }

        //Written by Prabhath on 13/06/2013 (Avoid expose to client)
        public int UpdatePrice(string _item, string _book, string _level, string _customer, string _promotioncode, int _pbseqno, int _lineno)
        {
            // sp_updatepricepicked(  p_item in NVARCHAR2, p_book in NVARCHAR2, p_level in NVARCHAR2, p_customer in NVARCHAR2,  p_promotioncd in NVARCHAR2, p_pbseq in NUMBER, p_pblineno in NUMBER, o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("p_promotioncd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promotioncode;
            (param[5] = new OracleParameter("p_pbseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbseqno;
            (param[6] = new OracleParameter("p_pblineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (Int16)UpdateRecords("sp_updatepricepicked", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 UpdateManagerIssueReceipt(string _com, string _pc, string _recno, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_mgr_iss", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<PriceDetailRef> GetPriceDetailForQuo(string _book, string _level, string _item, decimal _qty, DateTime _date, string _customer, DateTime _ValidDate)
        {
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[5] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[6] = new OracleParameter("p_validDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ValidDate.Date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpricedetailForQuo", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertWithPriceType);
            }

            return _priceDetailRef;

        }

        public DataTable GetPriceLevelMessage(string _company, string _book, string _level)
        {
            //sp_getpricelevelmsg(p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tbllvlmsg", "sp_getpricelevelmsg", CommandType.StoredProcedure, false, param);

        }

        public Int32 SaveQuoItemTax(QuotationItemTax _ItemTax)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_qdt_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_seq_no;
            (param[1] = new OracleParameter("p_qdt_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_line_no;
            (param[2] = new OracleParameter("p_qdt_tline_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_tline_no;
            (param[3] = new OracleParameter("p_qdt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_no;
            (param[4] = new OracleParameter("p_qdt_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_itm_cd;
            (param[5] = new OracleParameter("p_qdt_tax_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_tax_tp;
            (param[6] = new OracleParameter("p_qdt_tax_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_tax_rate;
            (param[7] = new OracleParameter("p_qdt_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_tax_amt;
            (param[8] = new OracleParameter("p_qdt_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemTax.Qdt_itm_tp;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_quoitmtax", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 SaveQuoSerial(QuotationSerial _QuoSer)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_qs_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _QuoSer.Qs_seq_no;
            (param[1] = new OracleParameter("p_qs_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoSer.Qs_no;
            (param[2] = new OracleParameter("p_qs_main_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _QuoSer.Qs_main_line;
            (param[3] = new OracleParameter("p_qs_ser_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _QuoSer.Qs_ser_line;
            (param[4] = new OracleParameter("p_qs_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoSer.Qs_item;
            (param[5] = new OracleParameter("p_qs_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoSer.Qs_ser;
            (param[6] = new OracleParameter("p_qs_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoSer.Qs_chassis;
            (param[7] = new OracleParameter("p_qs_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _QuoSer.Qs_ser_id;
            (param[8] = new OracleParameter("p_qs_ser_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QuoSer.Qs_ser_loc;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_quoser", CommandType.StoredProcedure, param);
            return effects;
        }

        public LoyaltyMemeber ValidateLoyaltyMember(string _card, string _cus, string _loty)
        {
            LoyaltyMemeber _member = null;
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _card;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[2] = new OracleParameter("p_loty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loty;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";//TODO:
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblDetail = QueryDataTable("tblDetail", "sp_validate_loty_card", CommandType.StoredProcedure, false, param);
            if (_tblDetail.Rows.Count > 0)
            {
                _member = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_tblDetail, LoyaltyMemeber.Converter)[0];
            }
            return _member;
        }


        public DataTable GetUpdatableInvoiceforDiscounted(string _company)
        {
            //sp_getinvoiceno(p_com in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tbllvlmsg", "sp_getinvoiceno", CommandType.StoredProcedure, false, param);
        }

        public int UpdateDiscountRef(string _invoice, int _line, int _disseq, int _disline, string _distp)
        {
            //sp_updatediscountref(p_invoice in NVARCHAR2,p_line in NUMBER,p_disseq in NUMBER,p_disline in NUMBER,p_distp in NVARCHAR2,o_effect out NUMBER) is
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            (param[2] = new OracleParameter("p_disseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _disseq;
            (param[3] = new OracleParameter("p_disline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _disline;
            (param[4] = new OracleParameter("p_distp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _distp;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatediscountref", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdatePreSchDueClone(string _user, DateTime _dt, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_clone_sch", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<PriceDetailRef> GetPriceDetailForHp(string _book, string _level, string _item, decimal _qty, DateTime _date, string _customer)
        {
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[5] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpricedetailforhp", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertWithPriceType);
            }

            return _priceDetailRef;

        }


        public int SaveCustomerSalesTypes(MasterBusinessEntitySalesType _sales)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_mbsa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_com;
            (param[1] = new OracleParameter("p_mbsa_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_cd;
            (param[2] = new OracleParameter("p_mbsa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_tp;
            (param[3] = new OracleParameter("p_mbsa_sa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_sa_tp;
            (param[4] = new OracleParameter("p_mbsa_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sales.Mbsa_act;
            (param[5] = new OracleParameter("p_mbsa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_cre_by;
            (param[6] = new OracleParameter("p_mbsa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_cre_dt;
            (param[7] = new OracleParameter("p_mbsa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_mod_by;
            (param[8] = new OracleParameter("p_mbsa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_mod_dt;

            param[9] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_busenty_sal_type", CommandType.StoredProcedure, param);
            return effects;

        }

        public int UpdateCustomerSalesTypes(MasterBusinessEntitySalesType _sales, string _types)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_mbsa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_com;
            (param[1] = new OracleParameter("p_mbsa_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_cd;
            (param[2] = new OracleParameter("p_mbsa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_tp;
            (param[3] = new OracleParameter("p_mbsa_sa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_sa_tp;
            (param[4] = new OracleParameter("p_mbsa_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sales.Mbsa_act;
            (param[5] = new OracleParameter("p_mbsa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_cre_by;
            (param[6] = new OracleParameter("p_mbsa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_cre_dt;
            (param[7] = new OracleParameter("p_mbsa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_mod_by;
            (param[8] = new OracleParameter("p_mbsa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_mod_dt;
            (param[9] = new OracleParameter("p_type", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _types;
            param[10] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_busent_sal_ty", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable GetCustomerAllowInvoiceType(string _company, string _customer)
        {
            //sp_customerinvoicetype(p_com in NVARCHAR2,p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblCustomer", "sp_customerinvoicetype", CommandType.StoredProcedure, false, param);

        }

        public Int16 Save_mst_itm_comtax(MasterItemTax _mstItmTax)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_itm_cd;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_com;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_stus;
            (param[3] = new OracleParameter("p_tax_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_tax_cd;
            (param[4] = new OracleParameter("p_taxrate_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_taxrate_cd;
            (param[5] = new OracleParameter("p_tax_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_tax_rate;
            (param[6] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_act;
            (param[7] = new OracleParameter("p_eff_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mstItmTax.Mict_effct_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_mst_itm_comtax", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_item(MasterItem mstItm, bool needFreeServive)
        {
            OracleParameter[] param = new OracleParameter[70];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cd;
            (param[1] = new OracleParameter("p_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_shortdesc;
            (param[2] = new OracleParameter("p_longdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_longdesc;
            (param[3] = new OracleParameter("p_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cate_1;
            (param[4] = new OracleParameter("p_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cate_2;
            (param[5] = new OracleParameter("p_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cate_3;
            (param[6] = new OracleParameter("p_cate_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cate_4;
            (param[7] = new OracleParameter("p_cate_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cate_5;
            (param[8] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_brand;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_model;
            (param[10] = new OracleParameter("p_part_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_part_no;
            (param[11] = new OracleParameter("p_color_int", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_color_int;
            (param[12] = new OracleParameter("p_is_reqcolorint", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_reqcolorint;
            (param[13] = new OracleParameter("p_color_ext", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_color_ext;
            (param[14] = new OracleParameter("p_is_reqcolorext", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_reqcolorext;
            (param[15] = new OracleParameter("p_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_itm_tp;
            (param[16] = new OracleParameter("p_is_stockmaintain", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_is_stockmaintain;
            (param[17] = new OracleParameter("p_hs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_hs_cd;
            (param[18] = new OracleParameter("p_itm_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_itm_uom;
            (param[19] = new OracleParameter("p_dim_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_dim_uom;
            (param[20] = new OracleParameter("p_dim_length", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_dim_length;
            (param[21] = new OracleParameter("p_dim_width", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_dim_width;
            (param[22] = new OracleParameter("p_dim_height", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_dim_height;
            (param[23] = new OracleParameter("p_weight_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_weight_uom;
            (param[24] = new OracleParameter("p_gross_weight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_gross_weight;
            (param[25] = new OracleParameter("p_net_weight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_net_weight;
            (param[26] = new OracleParameter("p_image_path", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_image_path;
            (param[27] = new OracleParameter("p_is_ser1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_ser1;
            (param[28] = new OracleParameter("p_is_ser2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_ser2;
            (param[29] = new OracleParameter("p_is_ser3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_ser3;
            (param[30] = new OracleParameter("p_warr", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_warr;
            (param[31] = new OracleParameter("p_warr_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_warr_print;
            (param[32] = new OracleParameter("p_hp_allow", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_hp_allow;
            (param[33] = new OracleParameter("p_insu_allow", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_insu_allow;
            (param[34] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_country_cd;
            (param[35] = new OracleParameter("p_purcom_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_purcom_cd;
            (param[36] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_itm_stus;
            (param[37] = new OracleParameter("p_fgitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_fgitm_cd;
            (param[38] = new OracleParameter("p_itmtot_cost", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_itmtot_cost;
            (param[39] = new OracleParameter("p_chg_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_chg_tp;
            (param[40] = new OracleParameter("p_is_scansub", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_scansub;
            (param[41] = new OracleParameter("p_is_barcodetrim", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_barcodetrim;
            (param[42] = new OracleParameter("p_ltrim_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_ltrim_val;
            (param[43] = new OracleParameter("p_rtrim_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_rtrim_val;
            (param[44] = new OracleParameter("p_is_editshortdesc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_editshortdesc;
            (param[45] = new OracleParameter("p_is_editlongdesc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_editlongdesc;
            (param[46] = new OracleParameter("p_ser_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_ser_prefix;
            (param[47] = new OracleParameter("p_refitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_refitm_cd;
            (param[48] = new OracleParameter("p_uom_warrperiodmain", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_uom_warrperiodmain;
            (param[49] = new OracleParameter("p_uom_warrperiodsub1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_uom_warrperiodsub1;
            (param[50] = new OracleParameter("p_uom_warrperiodsub2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_uom_warrperiodsub2;
            (param[51] = new OracleParameter("p_is_editser1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_editser1;
            (param[52] = new OracleParameter("p_is_editser2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_editser2;
            (param[53] = new OracleParameter("p_is_editser3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_editser3;
            (param[54] = new OracleParameter("p_std_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_std_cost;
            (param[55] = new OracleParameter("p_std_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = mstItm.Mi_std_price;
            (param[56] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_act;
            (param[57] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_cre_by;
            (param[58] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mstItm.Mi_cre_dt;
            (param[59] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_mod_by;
            (param[60] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = mstItm.Mi_mod_dt;
            (param[61] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_session_id;
            (param[62] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_anal1;
            (param[63] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mstItm.Mi_anal2;
            (param[64] = new OracleParameter("p_anal3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_anal3;
            (param[65] = new OracleParameter("p_anal4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_anal4;
            (param[66] = new OracleParameter("p_anal5", OracleDbType.Date, null, ParameterDirection.Input)).Value = mstItm.Mi_anal5;
            (param[67] = new OracleParameter("p_anal6", OracleDbType.Date, null, ParameterDirection.Input)).Value = mstItm.Mi_anal6;
            (param[68] = new OracleParameter("p_is_subitm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_is_subitem;
            //  (param[69] = new OracleParameter("p_need_reg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_need_reg;
            //  (param[70] = new OracleParameter("p_need_insu", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mstItm.Mi_need_insu;
            //   (param[71] = new OracleParameter("p_need_freesev", OracleDbType.Int32, null, ParameterDirection.Input)).Value = needFreeServive==true?1:0;
            param[69] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_item", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Save_mst_itm_sev(MasterItemService _itmSev)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSev.Misv_itm_cd;
            (param[1] = new OracleParameter("p_sevitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSev.Misv_sevitm_cd;
            (param[2] = new OracleParameter("p_sevitm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSev.Misv_sevitm_stus;
            (param[3] = new OracleParameter("p_chg_pty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSev.Misv_chg_pty;
            (param[4] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmSev.Misv_act == true ? 1 : 0;
            (param[5] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSev.Misv_cre_by;
            (param[6] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itmSev.Misv_cre_dt;
            (param[7] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSev.Misv_mod_by;
            (param[8] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itmSev.Misv_mod_dt;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_mst_itm_sev", CommandType.StoredProcedure, param);
            return effects;

        }


        public DataTable Get_gurantors(string accountNo)
        {
            //sp_get_AllGurantors  (p_accNo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblCustomer", "sp_get_AllGurantors", CommandType.StoredProcedure, false, param);

        }

        //Written by Prabhath on 04/07/2013 (Avoided expose to client)
        public Int32 UpdateInventoryCustomer(int _doSeqno, string _customercode)
        {
            //sp_updateinvcustomer(p_doseqno in NUMBER,p_customer in NVARCHAR2,o_effect out NUMBER) 
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_doseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doSeqno;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customercode;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateinvcustomer", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetHpCustomer_Details(string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "SP_Get_hp_customer", CommandType.StoredProcedure, false, param);
            return tblDet;

            //return tblDet.Rows[0][0].ToString(); 

        }

        public int SaveEliteCommissionDefinition(EliteCommissionDefinition _def)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _def.Saec_seq;
            (param[1] = new OracleParameter("p_saec_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Saec_circ;
            (param[2] = new OracleParameter("p_saec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _def.Saec_dt;
            (param[3] = new OracleParameter("p_saec_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _def.Saec_valid_from;
            (param[4] = new OracleParameter("p_saec_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _def.Saec_valid_to;
            (param[5] = new OracleParameter("p_saec_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Saec_cre_by;
            (param[6] = new OracleParameter("p_saec_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _def.Saec_cre_dt;
            (param[7] = new OracleParameter("p_saec_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Saec_mod_by;
            (param[8] = new OracleParameter("p_saec_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _def.Saec_mod_dt;
            (param[9] = new OracleParameter("p_saec_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Saec_stus;
            (param[10] = new OracleParameter("p_sace_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Eaec_com;
            (param[11] = new OracleParameter("p_saec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Saec_no;
            (param[12] = new OracleParameter("p_disc", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _def.Saec_alw_discount;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_def", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveEliteCommissionDetail(EliteCommissionDetail _detail)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Saec_seq;
            (param[1] = new OracleParameter("p_saec_circuler", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Saec_circuler;
            (param[2] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Saec_emp_type;
            (param[3] = new OracleParameter("p_saec_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _detail.Saec_from;
            (param[4] = new OracleParameter("p_saec_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _detail.Saec_to;
            (param[5] = new OracleParameter("p_saec_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _detail.Saec_rate;
            (param[6] = new OracleParameter("p_saec_value", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _detail.Saec_value;
            (param[7] = new OracleParameter("p_saec_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Saec_type;
            (param[8] = new OracleParameter("p_saec_extract_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Saec_extract_from;
            (param[9] = new OracleParameter("p_saec_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Saec_line_no;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveEliteCommissionLocation(EliteCommissionPrty _prty)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _prty.Saec_seq;
            (param[1] = new OracleParameter("p_saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prty.Saec_circular;
            (param[2] = new OracleParameter("p_saec_prt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prty.Saec_prt_tp;
            (param[3] = new OracleParameter("p_saec_prt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prty.Saec_prt_cd;


            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_prty", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SaveEliteCommissionAdditional(EliteCommissionAdditional _add)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _add.Saec_seq;
            (param[1] = new OracleParameter("p_saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _add.Saec_circular;
            (param[2] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _add.Saec_emp_type;
            (param[3] = new OracleParameter("p_saec_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _add.Saec_tp;
            (param[4] = new OracleParameter("p_saec_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _add.Saec_val;
            (param[5] = new OracleParameter("p_saec_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _add.Saec_desc;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_addi", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveEliteCommissionIgnore(EliteCommissionIgnore _ignore)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ignore.Saec_seq;
            (param[1] = new OracleParameter("saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ignore.Saec_circular;
            (param[2] = new OracleParameter("saec_emp_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ignore.Saec_emp_cate;
            (param[3] = new OracleParameter("saec_emp_sub_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ignore.Saec_emp_sub_cate;


            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_ign", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveEliteCommissionItem(EliteCommissionItem _itm)
        {

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Saec_seq;
            (param[1] = new OracleParameter("p_saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Saec_circular;
            (param[2] = new OracleParameter("p_saec_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Saec_brand;
            (param[3] = new OracleParameter("p_saec_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Saec_cat1;
            (param[4] = new OracleParameter("p_saec_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Saec_cat2;
            (param[5] = new OracleParameter("p_saec_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Saec_itm;

            (param[6] = new OracleParameter("p_saec_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Saec_direct;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_itm", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<EliteCommissionDefinition> GetEliteCommissionDefinition(string _circular)
        {
            List<EliteCommissionDefinition> _comm = null;
            //p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_get_elite_com_def", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _comm = DataTableExtensions.ToGenericList<EliteCommissionDefinition>(_tbeDetail, EliteCommissionDefinition.Converter);
            }
            return _comm;
        }


        public List<EliteCommissionDetail> GetEliteCommissionDetails(string circular)
        {
            List<EliteCommissionDetail> _det = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_get_elite_comm_det", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _det = DataTableExtensions.ToGenericList<EliteCommissionDetail>(_tbeDetail, EliteCommissionDetail.Converter);
            }
            return _det;
        }

        public List<EliteCommissionPrty> GetEliteCommissionLocation(string circular)
        {
            List<EliteCommissionPrty> _prty = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circulr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_get_elite_comm_prty", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _prty = DataTableExtensions.ToGenericList<EliteCommissionPrty>(_tbeDetail, EliteCommissionPrty.Converter);
            }
            return _prty;
        }

        public List<EliteCommissionAdditional> GetEliteCommissionAdditional(string circular)
        {
            List<EliteCommissionAdditional> _add = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circuler", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_get_elite_comm_addi", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _add = DataTableExtensions.ToGenericList<EliteCommissionAdditional>(_tbeDetail, EliteCommissionAdditional.Converter);
            }
            return _add;
        }

        public List<EliteCommissionIgnore> GetEliteCommissionIgnore(string circular)
        {
            List<EliteCommissionIgnore> _ignore = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_sar_elite_comm_ignore", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _ignore = DataTableExtensions.ToGenericList<EliteCommissionIgnore>(_tbeDetail, EliteCommissionIgnore.Converter);
            }
            return _ignore;

        }

        public List<EliteCommissionItem> GetEliteCommissionItem(string circular)
        {
            List<EliteCommissionItem> _itm = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_get_elte_comm_itm", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _itm = DataTableExtensions.ToGenericList<EliteCommissionItem>(_tbeDetail, EliteCommissionItem.Converter);
            }
            return _itm;

        }
        public Int32 Remove_GuranterOfAccount(string accountNo, string guranterCode)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[3];
            //sp_remove_Guranter(p_accountNo in NVARCHAR2,p_guranterCode in NVARCHAR2,o_effect out number)

            (param[0] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            (param[1] = new OracleParameter("p_guranterCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = guranterCode;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_remove_Guranter", CommandType.StoredProcedure, param);

            return effects;
        }

        public int CancelEliteCommission(string _circular)
        {

            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;


            param[1] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_elite_comm_det", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable GetManagerEPF(string _company, string _profitcenter)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_get_manager_epf", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetProfitCenterAllocatedExecutive(string _company, string _profitcenter)
        {
            // sp_getpcempolyee(p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_getpcempolyee", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetEliteCommissionEliteCommission(string _pc, DateTime _from, DateTime _to, decimal _discount, string _com, int _type, string _salesType, string _item)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _discount;
            (param[5] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            (param[6] = new OracleParameter("p_salesType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesType;
            (param[7] = new OracleParameter("p_item", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_elite_com_do_items", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetPcEmployee(string _com, string _pc, string _cat)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_get_pc_emp_by_cat", CommandType.StoredProcedure, false, param);
            return tblDet;

        }


        public int SaveEliteCommissionSalesType(EliteCommissionSalesTypes _type)
        {

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type.Saec_seq;
            (param[1] = new OracleParameter("p_saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type.Saec_circular;
            (param[2] = new OracleParameter("p_saec_sales_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type.Saec_sales_type;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_sales_types", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<EliteCommissionSalesTypes> GetEliteCommissionSalesType(string circular)
        {
            List<EliteCommissionSalesTypes> _sal = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbeDetail = QueryDataTable("tblPriceDetail", "sp_get_elite_comm_sales", CommandType.StoredProcedure, false, param);
            if (_tbeDetail.Rows.Count > 0)
            {
                _sal = DataTableExtensions.ToGenericList<EliteCommissionSalesTypes>(_tbeDetail, EliteCommissionSalesTypes.Converter);
            }
            return _sal;

        }

        public int SaveEliteCommission(EliteCommission _comm)
        {

            OracleParameter[] param = new OracleParameter[23];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_pc;
            (param[1] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_emp_type;

            (param[2] = new OracleParameter("p_saec_emp_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_emp_code;
            (param[3] = new OracleParameter("p_saec_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_price;
            (param[4] = new OracleParameter("p_saec_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_vat;

            (param[5] = new OracleParameter("p_saec_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_dis;
            (param[6] = new OracleParameter("p_saec_gross", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_gross;
            (param[7] = new OracleParameter("p_saec_rtn", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_rtn;

            (param[8] = new OracleParameter("p_saec_net", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_net;
            (param[9] = new OracleParameter("p_saec_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _comm.Saec_year;
            (param[10] = new OracleParameter("p_saec_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _comm.Saec_month;

            (param[11] = new OracleParameter("p_saec_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_comm;
            (param[12] = new OracleParameter("p_saec_cashier", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_cashier;
            (param[13] = new OracleParameter("p_saec_helper", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_helper;

            (param[14] = new OracleParameter("p_saec_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_cre_by;
            (param[15] = new OracleParameter("p_saec_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _comm.Saec_cre_dt;
            (param[16] = new OracleParameter("p_saec_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_com;
            (param[17] = new OracleParameter("p_saec_additional", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm.Saec_additional;
            (param[18] = new OracleParameter("p_saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_circular;
            (param[19] = new OracleParameter("p_saec_emp_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm.Saec_emp_epf;
            (param[20] = new OracleParameter("p_saec_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _comm.Saec_from;
            (param[21] = new OracleParameter("p_saec_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _comm.Saec_to;
            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("sp_save_elite_commission", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SaveEliteCommissionSlab(EliteCommissionSlab _slab)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_saec_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_com;
            (param[1] = new OracleParameter("p_saec_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_pc;

            (param[2] = new OracleParameter("p_saec_emp_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_emp_code;
            (param[3] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_emp_type;
            (param[4] = new OracleParameter("p_saec_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_type;

            (param[5] = new OracleParameter("p_saec_slab", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _slab.Saec_slab;
            (param[6] = new OracleParameter("p_saec_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _slab.Saec_comm;
            (param[7] = new OracleParameter("p_saec_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_cre_by;
            (param[8] = new OracleParameter("p_saec_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _slab.Saec_cre_dt;
            (param[9] = new OracleParameter("p_saec_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _slab.Saec_circular;
            (param[10] = new OracleParameter("p_saec_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _slab.Saec_year;
            (param[11] = new OracleParameter("p_saec_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _slab.Saec_mon;

            (param[12] = new OracleParameter("p_saec_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _slab.Saec_from;
            (param[13] = new OracleParameter("p_saec_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _slab.Saec_to;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_commission_detai", CommandType.StoredProcedure, param);
            return effects;

        }

        public List<CashPromotionDiscountDetail> GetPromotionalDiscount(DateTime _date, int _time, string _day, string _book, string _level, string _item, string _company, string _partycd, string _partytp, Int32 _isSerialized, Int32 _isPromotion, Int32 _isSuperUser)
        {
            List<CashPromotionDiscountDetail> _returnLst = null;
            //sp_getpromotiondiscount(p_date in date,p_time in NUMBER,p_day in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_com in NVARCHAR2,p_partycode in NVARCHAR2,p_partytype IN NVARCHAR2,p_isserialized in NUMBER,p_ispromo in NUMBER,p_superuser in NUMBER,,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[1] = new OracleParameter("p_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _time;
            (param[2] = new OracleParameter("p_day", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _day;
            (param[3] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[7] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycd;
            (param[8] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partytp;
            (param[9] = new OracleParameter("p_isserialized", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSerialized;
            (param[10] = new OracleParameter("p_ispromo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isPromotion;
            (param[11] = new OracleParameter("p_superuser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSuperUser;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_getpromotiondiscount", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(tblDet, CashPromotionDiscountDetail.ConverterForgrd);
            }

            return _returnLst;
        }

        public int DeleteEliteCommission(string _circular, Int32 _year, Int32 _mon)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[2] = new OracleParameter("p_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mon;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_delet_elite_comm", CommandType.StoredProcedure, param);
            return effects;
        }


        //darshana on 09-07-2013
        public Int16 UpdateReverseInvoiceAmt(string _com, string _pc, string _cus, string _inv, decimal _amt)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterevamt", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<HpAccount> GetHPAccount(string _company, string _profitcenter, int _seqno, string _status)
        {
            //spgethpaccount(p_pc in NVARCHAR2,p_seqNo in NUMBER,p_status in NVARCHAR2,p_com in NVARCHAR2, c_data OUT sys_refcursor)
            List<HpAccount> _userList = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[1] = new OracleParameter("p_seqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "spgethpaccount", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            return _userList;
        }

        public RecieptHeader GetAcJobReciept(string _jobno, string _com, string _pc)
        {
            RecieptHeader _reciept = null;
            //sp_getpromotiondiscount(p_date in date,p_time in NUMBER,p_day in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_com in NVARCHAR2,p_partycode in NVARCHAR2,p_partytype IN NVARCHAR2,p_isserialized in NUMBER,p_ispromo in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_ac_ser_rec", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _reciept = DataTableExtensions.ToGenericList<RecieptHeader>(tblDet, RecieptHeader.ConvertTotal)[0];
            }
            return _reciept;
        }


        //darshana on 10-07-2013
        public int SavePriceingLog(LogPriceDef _logPrice)
        {

            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Promo_cd;
            (param[1] = new OracleParameter("p_cir_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Cir_no;
            (param[2] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _logPrice.From_dt;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _logPrice.To_dt;
            (param[4] = new OracleParameter("p_log_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Log_usr;
            (param[5] = new OracleParameter("p_log_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Log_session;
            (param[6] = new OracleParameter("p_log_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Log_rmk;
            (param[7] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Pb;
            (param[8] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Plevel;


            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_createpricelog", CommandType.StoredProcedure, param);
            return effects;

        }

        //darshana on 11-07-2013
        //updated sachith 2013/09/05
        //add pb plevel update
        public int UpdateExtendPromo(string _promo, DateTime _date, string _user, string _session, string _pb, string _plevel, string _circular)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _session;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[5] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _plevel;
            (param[6] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[7] = new OracleParameter("Sapd_price_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "P";

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatepromoextend", CommandType.StoredProcedure, param);
            return effects;
        }
        // Nadeeka
        public int UpdateExtendPromo_subpb(string _promo, DateTime _date, string _user, string _session, string _pb, string _plevel, string _circular)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _session;
            (param[4] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[5] = new OracleParameter("P_Sapd_price_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "P";

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatepromoextend_subpb", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 11-07-2013
        public List<PriceDetailRef> GetPriceDetailsFromPromo(string _promo)
        {
            List<PriceDetailRef> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_getpromoforamend", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<PriceDetailRef>(tblDet, PriceDetailRef.ConvertMain);
            }

            return _returnLst;
        }

        public InventoryHeader GetWarrDoDate(string _invoice, string _item, string _serial)
        {
            InventoryHeader _hdr = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_warr_do_dt", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<InventoryHeader>(tblDet, InventoryHeader.ConvertTotal)[0];
            }

            return _hdr;
        }

        public DataTable GetCrnoteWithoutSRN(string _loc, DateTime _from, DateTime _to, string _com, string _salesType, string _pc)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            (param[4] = new OracleParameter("p_salType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesType;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_get_crnote_witout_srn", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public int SaveEliteCommissionInvoices(EliteCommissionInvoice _inv)
        {
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_saec_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_pc;
            (param[1] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_emp_type;

            (param[2] = new OracleParameter("p_saec_emp_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_emp_code;
            (param[3] = new OracleParameter("p_saec_emp_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_emp_epf;
            (param[4] = new OracleParameter("p_saec_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_inv_no;

            (param[5] = new OracleParameter("p_saec_is_rev", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.Saec_is_rev;
            (param[6] = new OracleParameter("p_saec_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.Saec_price;
            (param[7] = new OracleParameter("p_saec_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.Saec_vat;
            (param[8] = new OracleParameter("p_saec_discount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.Saec_discount;
            (param[9] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_circular;
            (param[10] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.Saec_year;
            (param[11] = new OracleParameter("p_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.Saec_month;

            (param[12] = new OracleParameter("p_saec_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inv.Saec_from;
            (param[13] = new OracleParameter("p_saec_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inv.Saec_to;
            (param[14] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Saec_itm;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_elite_comm_inv", CommandType.StoredProcedure, param);
            return effects;

        }

        public int DeleteEliteInvoice(string _circ, int _year, int _month)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[1] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[2] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_delete_elite_invoice", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<RecieptHeader> GetAccRecDet(string _company, string _account)
        {
            // sp_getreceiptdetailbyaccountno(p_com in NVARCHAR2 ,p_pcenter in NVARCHAR2,p_accountno in NVARCHAR2,c_data out sys_refcursor)

            List<RecieptHeader> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;

            (param[1] = new OracleParameter("p_accountno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getaccrecdet", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RecieptHeader>(_tblData, RecieptHeader.ConvertTotal);
            }
            return _list;

        }

        public DataTable IsForwardSaleExceed(string _company, string _profitcenter)
        {
            //sp_IsMaxFwdSaleExceed ( p_com IN NVARCHAR2,p_pc IN NVARCHAR2,c_data OUT sys_refcursor) iS
            //OracleParameter[] param = new OracleParameter[3];
            //(param[0] = new OracleParameter("p_com", OracleDbType.Date, null, ParameterDirection.Input)).Value = _company;
            //(param[1] = new OracleParameter("p_pc", OracleDbType.Date, null, ParameterDirection.Input)).Value = _profitcenter;
            //param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable tblIsFwd = QueryDataTable("tblIsFwd", "sp_IsMaxFwdSaleExceed", CommandType.StoredProcedure, false, param);
            //return tblIsFwd;

            //Error correct by Chamal - 18-06-2013
            //sp_IsMaxFwdSaleExceed ( p_com IN NVARCHAR2,p_pc IN NVARCHAR2,c_data OUT sys_refcursor) iS
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblIsFwd = QueryDataTable("tblIsFwd", "sp_IsMaxFwdSaleExceed", CommandType.StoredProcedure, false, param);
            return tblIsFwd;
        }

        public DataTable GetEliteCommissionEliteCommissionPromotion(string _pc, DateTime _from, DateTime _to, decimal _discount, string _com, int _type, string _salesType, string _item)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _discount;
            (param[5] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            (param[6] = new OracleParameter("p_salesType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesType;
            (param[7] = new OracleParameter("p_item", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_elite_com_do_items1", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public List<CashPromotionDiscountHeader> GetPromotionalHeader(string _circular)
        {
            List<CashPromotionDiscountHeader> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_def", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountHeader>(tblDet, CashPromotionDiscountHeader.Converter);
            }

            return _returnLst;
        }


        public List<sar_pb_def> GetPriceDefHeader(string _circular)
        {
            List<sar_pb_def> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_PriceDefHeader", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<sar_pb_def>(tblDet, sar_pb_def.Converter);
            }

            return _returnLst;
        }

        public List<sar_pb_def> GetPriceDefHeaderforPB(string _com, string _pb, string _pbl, DateTime _date, string _item)
        {
            List<sar_pb_def> _returnLst = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[2] = new OracleParameter("p_pbl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbl;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_PriceDefforPB", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<sar_pb_def>(tblDet, sar_pb_def.Converter);
            }

            return _returnLst;
        }

        public List<sar_pb_def_det> GetPriceDefDet(int seq)
        {
            List<sar_pb_def_det> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_PriceDefDet", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<sar_pb_def_det>(tblDet, sar_pb_def_det.Converter);
            }

            return _returnLst;
        }

        public DataTable GetPriceDefDetBasedPB(int seq, string _item)
        {


            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_pbdef_det", CommandType.StoredProcedure, false, param);


            return tblDet;
        }

        public List<CashPromotionDiscountDetail> GetPromotinalDiscountDetail(int seq)
        {
            List<CashPromotionDiscountDetail> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_det", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(tblDet, CashPromotionDiscountDetail.Converter);
            }

            return _returnLst;
        }

        public DataTable GetRegInvDet(string _company, string _pc, string _inv)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblRegInvDet", "sp_getvehreginvdet", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetRegInvItmDet(string _company, string _pc, string _inv, Int32 _invLine, string _itm)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_invLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invLine;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblRegInvItmDet", "sp_getvehreginvitmdet", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        //kapila
        public DataTable GetRegDCNItmDet(string _company, string _pc, string _qno, string _itm)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _qno;

            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblRegInvItmDet", "sp_getvehregdcnitmdet", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        public List<CashPromotionDiscountItem> GetPromotinalDiscountItem(int seq)
        {
            List<CashPromotionDiscountItem> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_itm", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountItem>(tblDet, CashPromotionDiscountItem.Converter);
            }

            return _returnLst;
        }

        public List<CashPromotionDiscountLocation> GetPromotinalDiscountLoc(int seq)
        {
            List<CashPromotionDiscountLocation> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_loc", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountLocation>(tblDet, CashPromotionDiscountLocation.Converter);
            }

            return _returnLst;
        }

        public int UpdateCashPromotionalDiscountItem(int _seq, string _mod, DateTime _modDt, string _itm, int _act)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            (param[1] = new OracleParameter("p_mod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod;
            (param[2] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _modDt;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _act;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("update_pro_item", CommandType.StoredProcedure, param);
            return effects;
        }

        public int UpdateCashPromotionalDiscountLocation(int _seq, string _mod, DateTime _modDt, string _loc, int _act)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            (param[1] = new OracleParameter("p_mod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod;
            (param[2] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _modDt;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _act;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("update_pro_loc", CommandType.StoredProcedure, param);
            return effects;
        }


        public int UpdateCashPromotionalDiscountHdr(int _seq, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            //(param[3] = new OracleParameter("p_dis_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _disval;
            //  (param[4] = new OracleParameter("p_dis_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _disrt;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_pro_hdr", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Prabhath on 22/07/2013 (Not expose to Client)
        public Int32 UpdateGeneralDiscount(string _type, Int32 _seqno, Int32 _lineno)
        {
            //sp_updatediscountdefinition(p_type in NVARCHAR2,p_seqno in NUMBER,p_lineno in NUMBER,o_effect out NUMBER) 
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[2] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatediscountdefinition", CommandType.StoredProcedure, param);
            return effects;
        }

        //written by darshana 13-09-2012
        public VehicalRegistrationDefnition GetVehRegAmtDirectNew(string _com, string _pc, string _type, string _itm, DateTime _date, string _sch, decimal _qty, decimal _val, string _pb, string _plvl, string _ser)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[7] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            (param[8] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[9] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _plvl;//p_serial
            (param[10] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser; //Tharanga
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_gethpregamtnew", CommandType.StoredProcedure, false, param);

            VehicalRegistrationDefnition _VehDef = new VehicalRegistrationDefnition();
            if (_dtResults.Rows.Count > 0)
            {
                _VehDef = DataTableExtensions.ToGenericList<VehicalRegistrationDefnition>(_dtResults, VehicalRegistrationDefnition.Converter)[0];
            }
            return _VehDef;
        }

        public DataTable GetPcEmployeeByCatSub(string _com, string _pc, string _cat, string _sub)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[3] = new OracleParameter("p_sub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sub;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_get_emp_cat_sub", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        public List<PriceDetailRef> GetPromotion(string _company, string _profitcenter, string _item, DateTime _date, string _customer, string _ptyty, string _pc)
        {
            //sp_getpromotion(p_com in NVARCHAR2,p_pc in NVARCHAR2, p_item in NVARCHAR2,p_date in date,p_customer in NVARCHAR2,c_data out sys_refcursor) 
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[5] = new OracleParameter("p_ptytp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyty;
            (param[6] = new OracleParameter("p_profit_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPromotion", "sp_getpromotion_new", CommandType.StoredProcedure, false, param);
            //DataTable _tblPriceDetail = QueryDataTable("tblPromotion", "sp_getpromotion", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertWithPriceType);
            }

            return _priceDetailRef;

        }

        public List<PriceSerialRef> GetPromotionSerial(string _company, string _profitcenter, string _item, DateTime _date, string _customer)
        {
            List<PriceSerialRef> _list = new List<PriceSerialRef>();
            //sp_getserializedpromotion(p_com in NVARCHAR2,p_pc in NVARCHAR2, p_item in NVARCHAR2,p_date in date,p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tblSerialPromotion", "sp_getserializedpromotion", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblData, PriceSerialRef.ConverterWithPriceType);
            }
            return _list;
        }



        public List<ReceiptItemDetails> GetAdvanReceiptItems(string _recNo)
        {
            List<ReceiptItemDetails> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_getreceiptitemdetails", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<ReceiptItemDetails>(tblDet, ReceiptItemDetails.ConverterNew);
            }

            return _returnLst;
        }

        public DataTable GetCusMonitorByDocument(string _company, string _profitcenter, string _doc)
        {
            //sp_getcustomerentries(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getcusmonentry", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public string GetHpCustomerNameForMon(string com, string accNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "sp_get_hp_customer_new", CommandType.StoredProcedure, false, param);
            try
            {
                if (tblDet.Rows.Count > 0)
                {
                    //return tblDet.Rows[0][0].ToString(); 
                    return tblDet.Rows[0]["mbe_name"].ToString(); //edit by shani 04/06/2013
                }
                else
                {
                    return string.Empty;
                }

            }
            catch (Exception ex) { return string.Empty; }

            //return tblDet.Rows[0][0].ToString(); 

        }


        public DataTable GetReprintSevericeJob(string _type, string _no)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _no;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "sp_get_sev_hdr_reprint", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetItemStatusWiseWarrantyPeriods(string itemCd, string status)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCd;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblwarr", "sp_getItemStatusWiseWarrDet", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public int ProcessMonthEnd(DateTime _asAtDate, string _com, string _pc, string _user, string _scheme, int seq)
        {
            OracleParameter[] param = new OracleParameter[7];
            int effects = 0;
            (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[5] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_pro_mon_end", CommandType.StoredProcedure, param);
            return effects;


        }

        public int SaveMonthEndHeader(MonthEndHeadder _hdr)
        {
            OracleParameter[] param = new OracleParameter[10];
            int effects = 0;
            (param[0] = new OracleParameter("p_hmeh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Hmeh_seq;
            (param[1] = new OracleParameter("p_hmeh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Hmeh_com;
            (param[2] = new OracleParameter("p_hmeh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Hmeh_pc;
            (param[3] = new OracleParameter("p_hmeh_mon_end_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Hmeh_mon_end_dt;
            (param[4] = new OracleParameter("p_hmeh_supp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Hmeh_supp_dt;
            (param[5] = new OracleParameter("p_hmeh_ignore_lmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hdr.Hmeh_ignore_lmt;
            (param[6] = new OracleParameter("p_hmeh_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Hmeh_stus;
            (param[7] = new OracleParameter("p_hmeh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Hmeh_cre_by;
            (param[8] = new OracleParameter("p_hmeh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Hmeh_cre_dt;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("save_hp_month_end", CommandType.StoredProcedure, param);
            return effects;
        }

        public MonthEndHeadder GetMonthEndHeader(string _com, string _pc, DateTime _monDt)
        {
            OracleParameter[] param = new OracleParameter[4];
            MonthEndHeadder _hdr = null;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _monDt;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblwarr", "sp_get_month_end", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<MonthEndHeadder>(tblDet, MonthEndHeadder.Converter)[0];
            }

            return _hdr;

        }

        public DataTable GetItemSubCate2(string _cat1, string _cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itmcat2", CommandType.StoredProcedure, false, param);
            return _tblBrand;
        }
        public DataTable GetItemSubCate3(string _cat1, string _cat2, string _cd)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[1] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itmcat3", CommandType.StoredProcedure, false, param);
            return _tblBrand;
        }

        public Boolean IsvalidPC(string _com, string _pc)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_check_loc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }

        //public int UpdatePriceDefinitionMainItem(PriceDetailRef _ref)
        //{
        //    OracleParameter[] param = new OracleParameter[9];
        //    int effects = 0;
        //    (param[0] = new OracleParameter("p_new", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_itm_cd;
        //    (param[1] = new OracleParameter("p_old", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sapd_model;
        //    (param[2] = new OracleParameter("p_qty_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sapd_qty_from;
        //    (param[3] = new OracleParameter("p_qty_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_qty_to;
        //    (param[4] = new OracleParameter("p_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ref.Sapd_itm_price;
        //    (param[5] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sapd_warr_remarks;
        //    (param[6] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_seq_no;
        //    (param[7] = new OracleParameter("p_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_pb_seq;

        //    param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
        //    effects = (Int16)UpdateRecords("update_price_def_main_item", CommandType.StoredProcedure, param);
        //    return effects;

        //}

        //public int UpdatePriceDefinitionSubItem(PriceDetailRef _ref)
        //{
        //    OracleParameter[] param = new OracleParameter[9];
        //    int effects = 0;
        //    (param[0] = new OracleParameter("p_new", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_itm_cd;
        //    (param[1] = new OracleParameter("p_old", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sapd_model;
        //    (param[2] = new OracleParameter("p_qty_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sapd_qty_from;
        //    (param[3] = new OracleParameter("p_qty_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_qty_to;
        //    (param[4] = new OracleParameter("p_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ref.Sapd_itm_price;
        //    (param[5] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sapd_warr_remarks;
        //    (param[6] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_seq_no;
        //    (param[7] = new OracleParameter("p_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sapd_pb_seq;

        //    param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
        //    effects = (Int16)UpdateRecords("update_price_def_main_item", CommandType.StoredProcedure, param);
        //    return effects;

        //}

        public int UpdatePriceDefMainItem(PriceDetailRef _priceDet)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_sapd_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_itm_cd;
            (param[1] = new OracleParameter("p_sapd_qty_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_qty_from;
            (param[2] = new OracleParameter("p_sapd_qty_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_qty_to;
            (param[3] = new OracleParameter("p_sapd_itm_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDet.Sapd_itm_price;
            (param[4] = new OracleParameter("p_sapd_warr_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_warr_remarks;
            (param[5] = new OracleParameter("p_sapd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_model;
            (param[6] = new OracleParameter("p_sapd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_seq_no;
            (param[7] = new OracleParameter("p_sapd_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_pb_seq;
            (param[8] = new OracleParameter("p_no_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDet.Sapd_no_of_times;
            (param[9] = new OracleParameter("P_Sapd_price_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDet.Sapd_price_stus;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("update_price_def_main_item", CommandType.StoredProcedure, param);
            return _effect;
        }

        public int UpdatePriceDefComItem(PriceCombinedItemRef _priceDetCom)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_SAPC_MAIN_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_main_itm_cd;
            (param[1] = new OracleParameter("p_SAPC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_itm_cd;
            (param[2] = new OracleParameter("p_SAPC_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_qty;
            (param[3] = new OracleParameter("p_SAPC_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_price;
            (param[4] = new OracleParameter("p_SAPC_PB_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_pb_seq;
            (param[5] = new OracleParameter("p_SAPC_MAIN_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_main_line;
            (param[6] = new OracleParameter("p_SAPC_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _priceDetCom.Sapc_itm_line;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("update_price_det_com_itm", CommandType.StoredProcedure, param);


            return _effect;
        }



        public int CancelPromotion(int seq, int pbSeq, string promo)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_sapd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_sapd_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pbSeq;
            (param[2] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = promo;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("update_promotion_cancel", CommandType.StoredProcedure, param);


            return _effect;
        }

        public DataTable GetPOSSRN(DateTime _from, DateTime _to, string _com, string _salesType, string _pc, decimal _discount)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _discount;
            (param[5] = new OracleParameter("p_salesType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesType;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_elite_pos_srn", CommandType.StoredProcedure, false, param);
            return tblDet;
        }


        //add by darshana on 22-08-2013
        public DataTable CheckValidAppPage(string _com, string _pc, string _appTp, string _stus, string _preFix, string _page, Int32 _used)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_appTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appTp;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _preFix;
            (param[5] = new OracleParameter("p_page", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _page;
            (param[6] = new OracleParameter("p_used", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _used;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_checkappmanpage", CommandType.StoredProcedure, false, param);
            return _tblBrand;
        }

        //by darshana on 23-08-2013
        public RequestApprovalHeader GetRequestApprovalHdr(string _com, string _pc, string _appTp, string _funcCD)
        {
            RequestApprovalHeader _returnLst = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_appTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appTp;
            (param[3] = new OracleParameter("p_funcCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _funcCD;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_getappreqbyfunccd", CommandType.StoredProcedure, false, param);


            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<RequestApprovalHeader>(tblDet, RequestApprovalHeader.Converter)[0];
            }

            return _returnLst;
        }

        public Int16 UpdateUsedAppManRec(string _com, string _preFix, string _pc, string _page, string _ref, string _usr, string _appTp)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _preFix;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_page", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Convert.ToString(_page);
            (param[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[5] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;
            (param[6] = new OracleParameter("p_appTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appTp;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateappmanrecstus", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateReqAppByFunc(string _com, string _pc, string _tp, string _func, string _usr)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[3] = new OracleParameter("p_func", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _func;
            (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatereqappbyfunc", CommandType.StoredProcedure, param);

            return effects;
        }

        public List<MasterBusinessEntity> GetCustomerByKeys(string _com, string _nic, string _mob, string _br, string _pp, string _dl, int _type)
        {

            List<MasterBusinessEntity> _customer = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dl;
            (param[3] = new OracleParameter("p_br", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _br;
            (param[4] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mob;
            (param[5] = new OracleParameter("p_pp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pp;
            (param[6] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_cut_mul_rcd", CommandType.StoredProcedure, false, param);


            if (tblDet.Rows.Count > 0)
            {
                _customer = DataTableExtensions.ToGenericList<MasterBusinessEntity>(tblDet, MasterBusinessEntity.Converter);
            }

            return _customer;

        }

        //Written by Prabhath on 28/08/2013 to handle fucking data errors.
        public List<MasterBusinessEntity> GetCustomerDetailList(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {
            List<MasterBusinessEntity> _masterBusinessCompany = new List<MasterBusinessEntity>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompany = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter);
            }
            return _masterBusinessCompany;
        }

        //Chamal 10/04/2014
        public List<MasterBusinessEntity> GetActiveCustomerDetailList(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {
            List<MasterBusinessEntity> _masterBusinessCompany = new List<MasterBusinessEntity>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetActiveCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompany = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter);
            }
            return _masterBusinessCompany;
        }

        public DataTable CheckTheDocument(string _company, string _document)
        {
            //CREATE OR REPLACE PROCEDURE sp_checkdocumentusage (p_com in NVARCHAR2,p_document in NVARCHAR2,c_data out sys_refcursor) is

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "sp_checkdocumentusage", CommandType.StoredProcedure, false, param);
            return tbl;


        }

        public DataTable GetCreditCustomerRequest(string _company, string _location, int _status)
        {
            //sp_getcustomerrequest(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_status in NUMBER,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "sp_getcustomerrequest", CommandType.StoredProcedure, false, param);
            return tbl;
        }

        public Int32 SaveCreditCustomerRequest(MasterBusinessEntity _businessEntity, string _reqno, string _reqloc, int _reqstatus)
        {
            //sp_save_creditcustomer
            OracleParameter[] param = new OracleParameter[68];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_acc_cd;
            (param[1] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_act;
            (param[2] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add1;
            (param[3] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_add2;
            (param[4] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cd;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_com;
            (param[6] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_contact;
            (param[7] = new OracleParameter("p_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_country_cd;
            (param[8] = new OracleParameter("p_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_distric_cd;
            (param[9] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_email;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_fax;
            (param[11] = new OracleParameter("p_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_suspend;
            (param[12] = new OracleParameter("p_is_tax", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_tax;
            (param[13] = new OracleParameter("p_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_mob;
            (param[14] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_name;
            (param[15] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_nic;
            (param[16] = new OracleParameter("p_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_province_cd;
            (param[17] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sub_tp;
            (param[18] = new OracleParameter("p_tax_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_no;
            (param[19] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tel;
            (param[20] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_town_cd;
            (param[21] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tp;


            //---------------------------------------------------
            (param[22] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_br_no;
            (param[23] = new OracleParameter("p_mbe_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cate;
            (param[24] = new OracleParameter("p_mbe_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_by;
            (param[25] = new OracleParameter("p_mbe_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_dt;
            (param[26] = new OracleParameter("p_mbe_cre_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cre_pc;
            //---------------------------------------------------

            (param[27] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dl_no;
            (param[28] = new OracleParameter("p_mbe_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_dob;
            (param[29] = new OracleParameter("p_mbe_ho_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_ho_stus;
            (param[30] = new OracleParameter("p_mbe_income_grup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_income_grup;
            (param[31] = new OracleParameter("p_mbe_oth_id_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_no;
            //---------------------------------------------------

            (param[32] = new OracleParameter("p_mbe_oth_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_oth_id_tp;
            (param[33] = new OracleParameter("p_mbe_pc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pc_stus;
            (param[34] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_pp_no;
            (param[35] = new OracleParameter("p_mbe_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_sex;
            (param[36] = new OracleParameter("p_mbe_tax_ex", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_tax_ex;
            //---------------------------------------------------
            //************************************************************************************
            (param[37] = new OracleParameter("p_mbe_is_svat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_is_svat;
            (param[38] = new OracleParameter("p_mbe_svat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_svat_no;
            (param[39] = new OracleParameter("p_mbe_cr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add1;
            (param[40] = new OracleParameter("p_mbe_cr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_add2;

            (param[41] = new OracleParameter("p_mbe_cr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_country_cd;
            (param[42] = new OracleParameter("p_mbe_cr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_province_cd;
            (param[43] = new OracleParameter("p_mbe_cr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_distric_cd;
            (param[44] = new OracleParameter("p_mbe_cr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_town_cd;

            (param[45] = new OracleParameter("p_mbe_cr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_tel;
            (param[46] = new OracleParameter("p_mbe_cr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_fax;
            (param[47] = new OracleParameter("p_mbe_cr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_email;
            (param[48] = new OracleParameter("p_mbe_wr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add1;

            (param[49] = new OracleParameter("p_mbe_wr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_add2;
            (param[50] = new OracleParameter("p_mbe_wr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_country_cd;
            (param[51] = new OracleParameter("p_mbe_wr_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_province_cd;
            (param[52] = new OracleParameter("p_mbe_wr_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_distric_cd;

            (param[53] = new OracleParameter("p_mbe_wr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_town_cd;
            (param[54] = new OracleParameter("p_mbe_wr_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_tel;
            (param[55] = new OracleParameter("p_mbe_wr_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_fax;
            (param[56] = new OracleParameter("p_mbe_wr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_email;

            //*******************************************************************************************************************
            (param[57] = new OracleParameter("p_mbe_wr_com_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_com_name;
            (param[58] = new OracleParameter("p_mbe_wr_proffesion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_proffesion;
            (param[59] = new OracleParameter("p_mbe_wr_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_dept;
            (param[60] = new OracleParameter("p_mbe_wr_designation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_wr_designation;
            (param[61] = new OracleParameter("p_mbe_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_postal_cd;
            (param[62] = new OracleParameter("p_mbe_cr_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_cr_postal_cd;
            (param[63] = new OracleParameter("p_mbe_agre_send_sms", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbe_agre_send_sms == true ? 1 : 0;
            //----------------------------------------------------------------------------------------------------------------------

            (param[64] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[65] = new OracleParameter("p_reqloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqloc;
            (param[66] = new OracleParameter("p_reqstatus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqstatus;
            param[67] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_creditcustomer", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable PrintExtendedWarranty(string _com, DateTime _from, DateTime _to, string _user, string _cat1, string _cat2, string _cat3, string _brand, string _model, string _item, Int32 _stus)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_ca2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[7] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[10] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;

            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_extended_war", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public Int32 UpdateCreditCustomerRequest(string _company, string _reqno, string _customer)
        {
            //sp_updatecustomerrequest(p_com in NVARCHAR2,p_reqno in NVARCHAR2,p_customer in NVARCHAR2,o_effect out NUMBER) is

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_updatecustomerrequest", CommandType.StoredProcedure, param);
            return effects;

        }

        //Chamal 04-Sep-2013
        public Decimal Get_Acc_Arrears(string _acc, DateTime _date, string _issame_date)
        {
            OracleParameter[] param = new OracleParameter[3];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[2] = new OracleParameter("p_in_rtnSamedate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _issame_date;
            OracleParameter _outParam = new OracleParameter("o_arrears", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("SP_GET_ACC_ARREARS", CommandType.StoredProcedure, _outParam, param));
            }
            catch
            {
                return effects;
            }
            return effects;
        }

        public List<InvoiceItem> GetInvoiceItems(string _invoice)
        {
            List<InvoiceItem> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "get_invoice_items", CommandType.StoredProcedure, false, param);
            if (tbl.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceItem>(tbl, InvoiceItem.ConvertInvoiceItemForReversal);
            }
            return _list;
        }

        public int SavePriceDetailRestriction(PriceDetailRestriction _res)
        {

            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_spr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _res.Spr_com;
            (param[1] = new OracleParameter("p_spr_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _res.Spr_promo;
            (param[2] = new OracleParameter("p_spr_msg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _res.Spr_msg;
            (param[3] = new OracleParameter("p_spr_need_cus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _res.Spr_need_cus;
            (param[4] = new OracleParameter("p_spr_need_nic", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _res.Spr_need_nic;
            (param[5] = new OracleParameter("p_spr_need_mob", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _res.Spr_need_mob;
            (param[6] = new OracleParameter("p_spr_need_pp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _res.Spr_need_pp;
            (param[7] = new OracleParameter("p_spr_need_dl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _res.Spr_need_dl;
            (param[8] = new OracleParameter("p_spr_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _res.Spr_usr;
            (param[9] = new OracleParameter("p_spr_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _res.Spr_when;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_pb_restr", CommandType.StoredProcedure, param);
            return effects;

        }

        public PriceDetailRestriction GetPromotionRestriction(string _com, string _promo)
        {

            PriceDetailRestriction _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "sp_get_promo_restriction", CommandType.StoredProcedure, false, param);
            if (tbl.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceDetailRestriction>(tbl, PriceDetailRestriction.Converter)[0];
            }
            return _list;

        }



        //written by darshana on 11/09/2013
        public List<LoyaltyMemeber> GetCurrentLoyalByCus(string _customer, string _type)
        {
            List<LoyaltyMemeber> _list = new List<LoyaltyMemeber>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getcurrentloyalbycus_new", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_tblData, LoyaltyMemeber.Converter);
            }
            return _list;

        }

        //darshana on 11-09-2013
        public DataTable GetCustomerLoyalEarnHis(string _company, string _customer, string _card)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[2] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _card;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getloyalearnhistory", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //darshana on 11-09-2013
        public DataTable GetCustomerLoyalRedeemHis(string _company, string _customer, string _ref, string _payTp)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_payTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _payTp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getredeemhistory", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetInvoiceSerial(string _company, string _invoice)
        {
            //sp_getinvoiceserial(p_com in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)  
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("_tbl", "sp_getinvoiceserial", CommandType.StoredProcedure, false, param);
            return _tbl;
        }
        //added by darshana on 14-09-2013
        public List<MasterBusinessEntity> GetBusinessCompanyDetailList(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {
            List<MasterBusinessEntity> _masterBusinessCompanyList = new List<MasterBusinessEntity>();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompanyList = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter);
            }

            return _masterBusinessCompanyList;

        }
        //darshana on 16-09-2013
        public DataTable GetHpTxnDetailsForCancel(string _com, string _pc, string _accNo, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tbl", "sp_checkforcancel", CommandType.StoredProcedure, false, param);
            return _tbl;
        }
        //darshana on 16-09-2013
        public DataTable GetHpLogDetailsForCancel(string _com, string _pc, string _accNo)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_checkacclogforcancel", CommandType.StoredProcedure, false, param);


            return _tbl;

        }

        public DataTable GetDeliveryOrader(string _invoice)
        {
            //sp_getdeliveryno(p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("_tbl", "sp_getdeliveryno", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public DataTable PrintExcessShort(string _com, string _user, string _doc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_excs_short", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintExcessShortBal(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_excs_bal", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public int SaveSaletTargetHeader(SalesTargetHeadder _hdr)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sast_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sast_seq;
            (param[1] = new OracleParameter("p_sast_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sast_circular;
            (param[2] = new OracleParameter("p_sast_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Sast_type;
            (param[3] = new OracleParameter("p_sast_val_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Sast_val_from;
            (param[4] = new OracleParameter("p_sast_val_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Sast_val_to;
            (param[5] = new OracleParameter("p_sast_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sast_cre_by;
            (param[6] = new OracleParameter("p_sast_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Sast_cre_dt;
            // (param[7] = new OracleParameter("p_sast_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Sast_line;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_sal_trgt_hdr", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SaveSaletTargetDetail(SalesTargetDetail _det)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sast_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Sast_seq;
            (param[1] = new OracleParameter("p_sast_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Sast_main_cat;
            (param[2] = new OracleParameter("p_sast_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Sast_qty;
            (param[3] = new OracleParameter("p_sast_amo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _det.Sast_amo;

            (param[4] = new OracleParameter("p_sast_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Sast_cre_by;
            (param[5] = new OracleParameter("p_sats_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Sats_cre_dt;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_sal_trg_det", CommandType.StoredProcedure, param);
            return effects;

        }

        public int SaveSaletTargetPC(SalesTargetProfitCenter _pc)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sast_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc.Sast_seq;
            (param[1] = new OracleParameter("p_sast_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc.Sast_pc;

            (param[2] = new OracleParameter("p_sast_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc.Sast_cre_by;
            (param[3] = new OracleParameter("p_sast_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pc.Sast_cre_dt;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_sal_trg_pc", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable GetProfitCenterDetail(string _company, int _type, string _book, string _level, string _promotion)
        {
            //sp_getprofitcenter(p_com in NVARCHAR2, p_type in NUMBER,p_promotion in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_promotion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promotion;
            (param[3] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_getprofitcenter_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPriceStatus(string _item, decimal _price, string _company, string _book, string _level)
        {
            //sp_getpricestatus(p_item in NVARCHAR2, p_price in NUMBER, p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_price", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _price;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_getpricestatus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDPExchange(string _company, string _pc, string _loc, string _type, string _doc)
        {
            //sp_getdpexchange(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_loc in NVARCHAR2,p_type in NVARCHAR2,p_doc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getdpexchange", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetDPExchange_new(string _company, string _pc, string _loc, string _type, string _doc)
        {
            //sp_getdpexchange(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_loc in NVARCHAR2,p_type in NVARCHAR2,p_doc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getdpexchange_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetEliteCommissionEliteCommissionPromotionCreditNote(string _pc, DateTime _from, DateTime _to, decimal _discount, string _com, int _type, string _salesType, string _item)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_dis", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _discount;
            (param[5] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            (param[6] = new OracleParameter("p_salesType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesType;
            (param[7] = new OracleParameter("p_item", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_get_cr_elite_comm1", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public List<HpInsurance> GetAccountInsuranceDetails(string _com, string _pc, string _accNo)
        {
            //sp_getinsuarancedetail(p_account in NVARCHAR2,p_type in NUMBER,c_data out sys_refcursor)

            List<HpInsurance> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinsudetails", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpInsurance>(_tblData, HpInsurance.Converter);
            }
            return _list;
        }

        public Int32 UpdateReversalCancel(string revInv, string com, string modBy, DateTime modDt, string originalInv)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_reversal_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = revInv;
            (param[1] = new OracleParameter("p_rev_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modBy;
            (param[3] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = modDt;

            (param[4] = new OracleParameter("p_ori_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = originalInv;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_update_srn_cancel", CommandType.StoredProcedure, param);
            return effects;
        }


        public MasterOutsideParty GetOutSidePartyDetailsById(string _code)
        {
            MasterOutsideParty _party = new MasterOutsideParty();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblParty = QueryDataTable("tblParty", "sp_get_bany_by_id", CommandType.StoredProcedure, false, param);
            if (_tblParty.Rows.Count > 0)
            {
                _party = DataTableExtensions.ToGenericList<MasterOutsideParty>(_tblParty, MasterOutsideParty.ConvertTotal)[0];
            }

            return _party;

        }

        public List<RequestApprovalHeader> getExchangeRequest(string _com, string _loc, string _type, string _status, Int32 _level, string _invLoc, Int32 _isservice)
        {
            List<RequestApprovalHeader> _list = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_level", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _level;
            (param[5] = new OracleParameter("p_invloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invLoc;
            (param[6] = new OracleParameter("p_isservice", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isservice;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getexchangerequest", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_tblData, RequestApprovalHeader.Converter);
            }
            return _list;
        }
        public List<RequestApprovalHeader> getExchangeRequestJob(string _com, string _loc, string _type, string _status, string _job, Int32 _isser)
        { //Nadeeka 25-06-2015
            List<RequestApprovalHeader> _list = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[5] = new OracleParameter("p_isservive", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isser;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getexchangerequestJob_new", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_tblData, RequestApprovalHeader.Converter);
            }
            return _list;
        }

        public Int32 SaveAuditCashVerificationAccountableCash(AuditAccountableCash _cash)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_aucc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cash.Aucc_seq;
            (param[1] = new OracleParameter("p_aucc_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_job;
            (param[2] = new OracleParameter("aucc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_type;
            (param[3] = new OracleParameter("aucc_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cash.Aucc_date;

            (param[4] = new OracleParameter("aucc_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_bank;
            (param[5] = new OracleParameter("aucc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_ref;
            (param[6] = new OracleParameter("aucc_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cash.Aucc_amount;
            (param[7] = new OracleParameter("aucc_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_customer;
            (param[8] = new OracleParameter("aucc_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_rmk;
            (param[9] = new OracleParameter("aucc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cash.Aucc_cre_by;
            (param[10] = new OracleParameter("aucc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cash.Aucc_cre_dt;
            (param[11] = new OracleParameter("p_aucc_is_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cash.Aucc_is_act;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_audit_cash", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveAuditCashVerificationDenomination(AuditCashVeriDenomination _deno)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("aucd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_seq;
            (param[1] = new OracleParameter("aucd_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _deno.Aucd_job;
            (param[2] = new OracleParameter("aucd_5000", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_5000;
            (param[3] = new OracleParameter("aucd_2000", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_2000;

            (param[4] = new OracleParameter("aucd_1000", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_1000;
            (param[5] = new OracleParameter("aucd_500", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_500;
            (param[6] = new OracleParameter("aucd_100", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_100;
            (param[7] = new OracleParameter("aucd_50", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_50;
            (param[8] = new OracleParameter("aucd_20", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_20;
            (param[9] = new OracleParameter("aucd_10", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_10;
            (param[10] = new OracleParameter("aucd_1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _deno.Aucd_1;

            (param[11] = new OracleParameter("aucd_total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _deno.Aucd_total;
            (param[12] = new OracleParameter("aucd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _deno.Aucd_cre_by;
            (param[13] = new OracleParameter("aucd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _deno.Aucd_cre_dt;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_audit_denomo", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveAuditCashVerificationDetail(AuditCashVeriDetail _detail)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("aucd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Aucd_seq;
            (param[1] = new OracleParameter("p_aucd_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Aucd_job;
            (param[2] = new OracleParameter("p_aucd_doc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Aucd_doc_type;
            (param[3] = new OracleParameter("p_aucd_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Aucd_book;

            (param[4] = new OracleParameter("p_aucd_from_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Aucd_from_no;
            (param[5] = new OracleParameter("p_aucd_to_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Aucd_to_no;
            (param[6] = new OracleParameter("p_aucd_total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _detail.Aucd_total;
            (param[7] = new OracleParameter("p_aucd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Aucd_cre_by;
            (param[8] = new OracleParameter("p_aucd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _detail.Aucd_cre_dt;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_audit_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveAuditCashVerificationDocument(AuditCashVeriDocument _doc)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_aucd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Aucd_seq;
            (param[1] = new OracleParameter("p_aucd_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Aucd_job;
            (param[2] = new OracleParameter("p_aucd_doc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Aucd_doc_type;
            (param[3] = new OracleParameter("p_aucd_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Aucd_book;
            (param[4] = new OracleParameter("p_aucd_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Aucd_doc;
            (param[5] = new OracleParameter("p_aucd_value", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Aucd_value;
            (param[6] = new OracleParameter("p_aucd_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Aucd_direct;
            (param[7] = new OracleParameter("p_aucd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Aucd_cre_by;
            (param[8] = new OracleParameter("p_aucd_cre_ct", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Aucd_cre_ct;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_audit_doc", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveAuditCashVerificationMain(AuditCashVeriMain _main)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_aucm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _main.Aucm_seq;
            (param[1] = new OracleParameter("p_aucm_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Aucm_job;
            (param[2] = new OracleParameter("p_aucm_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Aucm_from;
            (param[3] = new OracleParameter("p_aucm_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Aucm_to;
            (param[4] = new OracleParameter("p_aucm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Aucm_cre_by;
            (param[5] = new OracleParameter("p_aucm_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Aucm_cre_dt;
            (param[6] = new OracleParameter("p_aucm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Aucm_com;
            (param[7] = new OracleParameter("p_aucm_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Aucm_pc;
            (param[8] = new OracleParameter("P_aucm_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _main.Aucm_status;


            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_aud_mail", CommandType.StoredProcedure, param);
            return effects;
        }

        public AuditCashVeriMain GetJobFromDate(DateTime _from, DateTime _to, string _com, string _pc)
        {
            AuditCashVeriMain _hdr = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_hdr_from_date", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<AuditCashVeriMain>(_tblData, AuditCashVeriMain.Converter)[0];
            }
            return _hdr;
        }

        public List<RecieptHeader> GetRecieptByTypeByDate(string _pc, string _com, DateTime _from, DateTime _to, string _type)
        {

            List<RecieptHeader> _list = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_reciept_type_date", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RecieptHeader>(_tblData, RecieptHeader.ConvertTotal);
            }
            return _list;

        }

        public List<HpInsurance> GetDiriyaByDateRange(string _pc, string _com, DateTime _from, DateTime _to)
        {

            List<HpInsurance> _list = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_insu_dt_rng", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpInsurance>(_tblData, HpInsurance.Converter);
            }
            return _list;

        }

        public Int32 UpdateCashVeriMain(AuditCashVeriMain _main, int status)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Aucm_job;
            (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _main.Aucm_seq;
            (param[2] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("p_excess", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _main.Aucm_excess;
            (param[4] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_rmk;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_update_aud_stus", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<AuditCashVeriDetail> GetAuditDetailsByJob(string _job, int _seq)
        {

            List<AuditCashVeriDetail> _list = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_audit_det", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditCashVeriDetail>(_tblData, AuditCashVeriDetail.Converter);
            }
            return _list;

        }

        public List<AuditCashVeriDocument> GetAuditDocuments(string _job, int _seq)
        {

            List<AuditCashVeriDocument> _list = null;
            //sp_getexchangerequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_audit_docs", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditCashVeriDocument>(_tblData, AuditCashVeriDocument.Converter);
            }
            return _list;

        }

        public DataTable GetTempUserPc(string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_gettmpuserpc", CommandType.StoredProcedure, false, param);
            return tblDet;
        }


        public string GetTempUserPcSession(string _com, string _user)
        {//Sanjeewa 2015-01-26
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_gettmpuserpcsession", CommandType.StoredProcedure, false, param);
            string _token = "";
            if (tblDet.Rows.Count > 0)
            {
                foreach (DataRow drow in tblDet.Rows)
                {
                    _token = drow["tpl_seq"].ToString();
                }
            }

            return _token;
        }

        //added by Darshana on 26-10-2013
        public Int16 UpdateAccLogByNewAcc(string _com, string _pc, string _oldAcc, string _newAcc)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_oldaccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldAcc;
            (param[3] = new OracleParameter("p_newAccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newAcc;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_acclog_org_acc", CommandType.StoredProcedure, param);

            return effects;
        }

        public List<AuditCashVeriDetail> GetCashVerificationDetails(string _com, string _pc, string _jobNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<AuditCashVeriDetail> _list = null;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_aud_det_from_job", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditCashVeriDetail>(_tblData, AuditCashVeriDetail.Converter);
            }

            return _list;
        }

        public AuditCashVeriMain GetCashVerificationMain(string _com, string _pc, string _jobNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            AuditCashVeriMain _main = null;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_aud_main_job", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _main = DataTableExtensions.ToGenericList<AuditCashVeriMain>(_tblData, AuditCashVeriMain.Converter)[0];
            }

            return _main;
        }

        //DARSHANA ON 30-10-2013
        public DataTable GetHPCustomerDet(string _com, string _accNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "sp_get_hp_cusdet", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //darshana on 01-11-2013
        public DataTable GetPCWara(string _com, string _pc, string _itm, string _itmStatus, DateTime _frmDt)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_itmStus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStatus;
            (param[4] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "sp_get_pcwara", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public int GetVirtualItemTotal(string _invno, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_vtual_val", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["vvalue"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["vvalue"]);
                }

            }
            _value = _val;

            return 1;
        }

        public DataTable GetDPExchangeSerial(string _company, string _pc, string _loc, string _type, string _doc)
        {
            //sp_getdpexchangeserial(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_loc in NVARCHAR2,p_type in NVARCHAR2,p_doc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getdpexchangeserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public CashPromotionDiscountHeader GetPromotionalHeaderBySeq(int _seq)
        {
            CashPromotionDiscountHeader _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_hdr", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountHeader>(tblDet, CashPromotionDiscountHeader.Converter)[0];
            }

            return _returnLst;
        }
        //written by darshana on 11-11-2013
        public DataTable GetServiceJobDet(string _comCode, string _job)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getserappjob_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Darshana 18/11/2013
        public List<InvoiceHeader> GetCommissionInvoicesforUpdate(string _com, string _pc, DateTime _date, string _type)
        {
            List<InvoiceHeader> _invList = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_get_inv_commupdate", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invList = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblInvoice, InvoiceHeader.ConvertTotal);
            }
            return _invList;
        }

        //Darshana 18-11-2013
        public Int32 UpdateCommissionBulk(string invoiceNo, string itemCode, Int32 itmLine, Int32 commLine, Decimal finCommRt, Decimal finCommAmt, Int32 seqNo, string payMode, Decimal calcOn, Decimal commRate, Decimal commAmt)
        {
            //(p_invoiceNo IN NVARCHAR2,p_itmCd IN NVARCHAR2,p_commLine in NUMBER,p_finCommRt in NUMBER,p_finCommAmt in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[2] = new OracleParameter("p_commLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = commLine;
            (param[3] = new OracleParameter("p_finCommRt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = finCommRt;
            (param[4] = new OracleParameter("p_finCommAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = finCommAmt;
            (param[5] = new OracleParameter("p_itmLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmLine;
            (param[6] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNo;
            (param[7] = new OracleParameter("p_pay_mode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = payMode;
            (param[8] = new OracleParameter("p_calc_on", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = calcOn;
            (param[9] = new OracleParameter("p_comm_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commRate;
            (param[10] = new OracleParameter("p_comm_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = commAmt;

            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_comm_bulk", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateDiscountUsedTimes(int _seq, int _times)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _times;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_pro_dis_hdr", CommandType.StoredProcedure, param);

            return effects;

        }

        //Written by Prabhath on 12/06/2013 (avoid expose to client)
        public int RedeemLoyaltyPointCancel(string _cardno, string _customer, decimal _points)
        {
            //sp_redeemloyaltycacncel(p_cardno in NVARCHAR2,p_customer in NVARCHAR2,p_point in NUMBER,o_effect out NUMBER) 
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cardno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[2] = new OracleParameter("p_point", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _points;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_redeemloyaltycacncel", CommandType.StoredProcedure, param);
            return effects;
        }

        //Darshana on 20-11-2013
        public Decimal Get_Diriya_CommissionVatRt(string accNo, DateTime ars_date)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[1] = new OracleParameter("p_byDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = ars_date;
            //(param[2] = new OracleParameter("p_typeofDue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            OracleParameter _outParam = new OracleParameter("c_commVatRt", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_get_diriya_commvatrt", CommandType.StoredProcedure, _outParam, param));
                return effects;
            }
            catch (Exception ex) { return 0; }


        }


        public List<QuotationSerial> GetQuoSerials(string _No)
        {
            List<QuotationSerial> _invList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _No;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoice = QueryDataTable("tblInvoice", "sp_get_quo_ser_byno", CommandType.StoredProcedure, false, param);

            if (_tblInvoice.Rows.Count > 0)
            {
                _invList = DataTableExtensions.ToGenericList<QuotationSerial>(_tblInvoice, QuotationSerial.Converter1);
            }
            return _invList;
        }

        public List<CashPromotionDiscountDetail> GetPromotinalDiscountDetail01(int seq, string _itm, string _pc)
        {
            List<CashPromotionDiscountDetail> _returnLst = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_det_1", CommandType.StoredProcedure, false, param);

            //if (tblDet.Rows.Count > 0)
            //{
            _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(tblDet, CashPromotionDiscountDetail.Converter);
            //}

            return _returnLst;
        }

        //kapila  30/3/2017
        public List<CashPromotionDiscountDetail> GetPromotinalDiscountDetail01_new(int seq, string _itm, string _type, string _pc)
        {
            List<CashPromotionDiscountDetail> _returnLst = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_pro_dis_det_1_new", CommandType.StoredProcedure, false, param);

            //if (tblDet.Rows.Count > 0)
            //{
            _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(tblDet, CashPromotionDiscountDetail.Converter);
            //}

            return _returnLst;
        }

        public int UpdateAuditAccountableCash(string _job, string _type)
        {
            //sp_redeemloyaltycacncel(p_cardno in NVARCHAR2,p_customer in NVARCHAR2,p_point in NUMBER,o_effect out NUMBER) 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_aucc_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[1] = new OracleParameter("p_aucc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_update_cvr_acc", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<AuditAccountableCash> GetAccounableCash(int seq, string _job)
        {
            List<AuditAccountableCash> _returnLst = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_accu_cash", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<AuditAccountableCash>(tblDet, AuditAccountableCash.Converter);
            }

            return _returnLst;
        }

        public Int32 UpdateHPSheduleSpReshdule(string _accno, Int32 _tearm, decimal _rntl, decimal _totAmt, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_rntl", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _rntl;
            (param[1] = new OracleParameter("p_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _totAmt;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[3] = new OracleParameter("p_rnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tearm;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updt_sp_rsdule", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetLimit(string _company, string _partycd, string _partyval, string _code1, string _code2, string _code3, Int16 _valuetp)
        {
            //SP_GETLIMIT(p_com in NVARCHAR2,p_ptcd in NVARCHAR2,p_ptvl in NVARCHAR2,p_cd1 in NVARCHAR2,p_cd2 in NVARCHAR2,p_cd3 in NVARCHAR2,p_vltp in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ptcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycd;
            (param[2] = new OracleParameter("p_ptvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partyval;
            (param[3] = new OracleParameter("p_cd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code1;
            (param[4] = new OracleParameter("p_cd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code2;
            (param[5] = new OracleParameter("p_cd3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code3;
            (param[6] = new OracleParameter("p_vltp", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _valuetp;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblLimit", "SP_GETLIMIT", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }
        public DataTable get_Bank_Name(string _Bank)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bank;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_bnk_name", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable get_Branch_Name(string _BankCode, string _code)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BankCode;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_branch_name", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<HpTransaction> GetHpTransactionByRef(string _ref)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<HpTransaction> _returnLst = null;

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_txn_by_ref", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<HpTransaction>(_dtResults, HpTransaction.Converter);
            }

            return _returnLst;
        }

        public RecieptHeader Check_ManRef_Rec(string com, string pc, string recTp, string refNo)
        {
            RecieptHeader _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_recTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recTp;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_check_man_ref", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal)[0];
            }
            return _ReceiptList;
        }


        public RecieptHeader Check_ManRef_Rec_prefix(string com, string pc, string recTp, string refNo, string _prefix)
        {// Nadeeka
            RecieptHeader _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_recTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recTp;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            (param[4] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_check_man_ref_prefix", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotal)[0];
            }
            return _ReceiptList;
        }

        public RecieptHeaderTBS Check_ManRef_RecTBS(string com, string pc, string recTp, string refNo)
        {
            RecieptHeaderTBS _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_recTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recTp;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_check_man_reftbs", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptHeaderTBS>(_dtResults, RecieptHeaderTBS.ConvertTotal)[0];
            }
            return _ReceiptList;
        }

        public DataTable GetSerialPriceList(string _item, DateTime _date, string _com, string _loc, string _pb, string _lvl)
        {
            //sp_customerinvoicetype(p_com in NVARCHAR2,p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[5] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblSerialPrice", "sp_getserialpricelisthp", CommandType.StoredProcedure, false, param);
            return _dtResults;

            //return QueryDataTable("tblCustomer", "sp_getserialpricelisthp", CommandType.StoredProcedure, false, param);

        }
        public List<RecieptItem> GetRecieptItemByRef(string _refNo)
        {
            List<RecieptItem> _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_recieptitem_by_ref", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ReceiptList = DataTableExtensions.ToGenericList<RecieptItem>(_dtResults, RecieptItem.ConvertTotal);
            }
            return _ReceiptList;
        }
        public DataTable Check_SRN_Stock_Avilability(string _refNo)
        {// Nadeeka 12-05-2015
            List<RecieptItem> _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_srn_stock_availability", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        //darshana 11/07/2012
        public List<HpSchemeDefinition> GetSerialSchemeNew(string _type, string _value, DateTime _date, string _item, string _serial, string _scheme, string _pbBook = null, string _pbLvl = null)
        {
            List<HpSchemeDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[6] = new OracleParameter("p_pbBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbBook;
            (param[7] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbLvl;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getserialschemedefinition", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_tblData, HpSchemeDefinition.Converter);
            }
            return _list;
        }

        public HpAccount GetLatestHPAccount(string _company, string _profitcenter)
        {
            HpAccount _userList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "spgetlatestacc", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter)[0];
            return _userList;
        }

        public List<InvoiceItem> GetRegAllowInvItem(string _company, string _profitcenter, string _invoice)
        {
            List<InvoiceItem> _userList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "spgetregallowitm", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem);
            return _userList;
        }

        public List<VehicalRegistration> CheckVehRegTxn(string _company, string _profitcenter, string _invoice, string _itm)
        {
            List<VehicalRegistration> _userList = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "spcheckregdone", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<VehicalRegistration>(_dtResults, VehicalRegistration.Converter);
            return _userList;
        }

        public Int32 UpdateInvoiceStatus(string _invNo, string _status)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_invoice_stus", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateCreditBalnce(string _ref, Decimal _creBal)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_creBal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _creBal;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_CreditBalance", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable getLocDesc(string _Com, string _Type, string _Code)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[2] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            (param[3] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_loc_desc", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable CheckAdvanForIntr(string _company, string _document)
        {
            //CREATE OR REPLACE PROCEDURE sp_checkdocumentusage (p_com in NVARCHAR2,p_document in NVARCHAR2,c_data out sys_refcursor) is

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "sp_checkadvforintr", CommandType.StoredProcedure, false, param);
            return tbl;

        }

        //sachith 2014/01/13
        public PriceBookLevelRef GetCompanyDefaultPBPlevel(string _com)
        {
            PriceBookLevelRef _price = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_get_com_def_pb_lvl", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _price = DataTableExtensions.ToGenericList<PriceBookLevelRef>(_dtResults, PriceBookLevelRef.ConvertTotal)[0];
            return _price;
        }
        //sachith 2014/01/1
        public List<HpAccount> GetPCAccounts(string _com, string _pc, DateTime _date)
        {
            List<HpAccount> _accountList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "get_pc_act_accounts", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _accountList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            return _accountList;
        }
        // Nadeeka 05-10-2015
        public List<HpAccount> GetActiveAccount(string _com, string _ac, DateTime _date)
        {
            List<HpAccount> _accountList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ac;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "get_ac_act_accounts", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _accountList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            return _accountList;
        }

        //sachith 2014/01/17
        public HpTransaction GetLastTxnDate(string _accNo)
        {

            HpTransaction _transaction = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_get_txn_date_acc", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _transaction = DataTableExtensions.ToGenericList<HpTransaction>(_dtResults, HpTransaction.Converter)[0];
            return _transaction;

        }

        public Int32 UpdateAccountTrimStatus(string _acc, string _stus, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[1] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[2] = new OracleParameter("p_cls_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_account_trim", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveHPAccountChecklistHdr(HPAccountChecklistHdr _hdr)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_agrh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Agrh_seq;
            (param[1] = new OracleParameter("p_agrh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Agrh_com;
            (param[2] = new OracleParameter("p_agrh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Agrh_pc;
            (param[3] = new OracleParameter("p_agrh_pod_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Agrh_pod_no;
            (param[4] = new OracleParameter("p_agrh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Agrh_doc_no;
            (param[5] = new OracleParameter("p_agrh_sw_confirm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Agrh_sw_confirm;
            (param[6] = new OracleParameter("p_agrh_ho_confirm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Agrh_ho_confirm;
            (param[7] = new OracleParameter("p_agrh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Agrh_cre_by;
            (param[8] = new OracleParameter("p_agrh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Agrh_cre_dt;
            (param[9] = new OracleParameter("p_agrh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Agrh_mod_by;
            (param[10] = new OracleParameter("p_agrh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Agrh_mod_dt;
            (param[11] = new OracleParameter("p_argh_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Agrh_dt;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_chk_hdr", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveHPAccountChecklistDet(HpAccountChecklistDet _det)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_agrd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Agrd_seq;
            (param[1] = new OracleParameter("p_agrd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_doc_no;
            (param[2] = new OracleParameter("p_agrd_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_acc_no;
            (param[3] = new OracleParameter("p_agrd_sw_rec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Agrd_sw_rec;
            (param[4] = new OracleParameter("p_agrd_sw_rec_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_sw_rec_by;
            (param[5] = new OracleParameter("p_agrd_sw_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Agrd_sw_rec_dt;
            (param[6] = new OracleParameter("p_agrd_ho_rec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Agrd_ho_rec;
            (param[7] = new OracleParameter("p_agrd_ho_rec_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_ho_rec_by;
            (param[8] = new OracleParameter("p_agrd_ho_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Agrd_ho_rec_dt;
            (param[9] = new OracleParameter("p_agrd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_cre_by;
            (param[10] = new OracleParameter("p_agrd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Agrd_cre_dt;
            (param[11] = new OracleParameter("p_agrd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_mod_by;
            (param[12] = new OracleParameter("p_agrd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Agrd_mod_dt;

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_chk_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public MasterItemTaxClaim GetTaxClaimDet(string _company, string _item, string _claimCd)
        {
            MasterItemTaxClaim _userList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_claimCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _claimCd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getitm_tax_claim", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<MasterItemTaxClaim>(_dtResults, MasterItemTaxClaim.Converter)[0];
            return _userList;
        }

        public Int32 UpdateAccountChecklistDetails(HpAccountChecklistDet _det)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_rec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Agrd_ho_rec;
            (param[1] = new OracleParameter("p_rec_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_ho_rec_by;
            (param[2] = new OracleParameter("p_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Agrd_ho_rec_dt;
            (param[3] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_doc_no;
            (param[4] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Agrd_acc_no;


            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_chk_acc_rec", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateAccountChecklistHeader(string _doc, string _acc, string _pc, DateTime _date, string _com)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;

            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_chk_hdr", CommandType.StoredProcedure, param);
            return effects;
        }
        //sachith
        public HPAccountChecklistHdr GetPODNo(string _podNo)
        {

            HPAccountChecklistHdr _pod = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _podNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_get_pod_no", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _pod = DataTableExtensions.ToGenericList<HPAccountChecklistHdr>(_dtResults, HPAccountChecklistHdr.Converter)[0];
            return _pod;

        }

        //darshana on 25-Jan-2014
        public Int32 UpdateUsedReceiptAmt(string _com, string _pc, decimal _amt, string _recTp, string _recNo)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_usedAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[3] = new OracleParameter("p_recTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recTp;
            (param[4] = new OracleParameter("p_RecNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateused_rec", CommandType.StoredProcedure, param);
            return effects;
        }

        //SACHITH 2014/01/28
        public Int32 UpdateRequestAppStatus(string _appStus, string _req, string _itm)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appStus;
            (param[1] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_request_app_stus", CommandType.StoredProcedure, param);
            return effects;
        }
        //darshana 30/01/2014
        public List<ExtendWaraParam> GetExWaraParam(string _type, string _value, DateTime _date, decimal _invVal, Int32 _invPd, string _searchTp, string _cusCd, string _itm, string _ser, string _brd, string _mCat, string _sCat, string _promo)
        {
            List<ExtendWaraParam> _list = null;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_invVal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invVal;
            (param[4] = new OracleParameter("p_invPeriod", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invPd;
            (param[5] = new OracleParameter("p_searchTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchTp;
            (param[6] = new OracleParameter("p_cusCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusCd;
            (param[7] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[8] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[9] = new OracleParameter("p_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brd;
            (param[10] = new OracleParameter("p_mCat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mCat;
            (param[11] = new OracleParameter("p_sCat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sCat;
            (param[12] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[13] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getexwarradef", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ExtendWaraParam>(_tblData, ExtendWaraParam.Converter);
            }
            return _list;
        }

        //SACHITH 2014/01/28
        public List<PriceDefinitionUserRestriction> GetUserRestriction(string _userId, string _com, DateTime _date, string _pb, string _plevel, int _type)
        {
            OracleParameter[] param = new OracleParameter[7];
            List<PriceDefinitionUserRestriction> _list = null;

            (param[0] = new OracleParameter("p_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[3] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _plevel;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_user_restrict", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceDefinitionUserRestriction>(_tblData, PriceDefinitionUserRestriction.Converter);
            }
            return _list;
        }

        public DataTable GetNBookNLevel(string _pc, string _com, string _item, decimal _qty, string _customer, DateTime _date)
        {
            // sp_getnbooknlevel (p_pc in NVARCHAR2,p_com in NVARCHAR2, p_item in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[5] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getnbooknlevel", "sp_getnbooknlevel", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }

        public DataTable GetAccountCustomer(string _com, string _pc, string _acc)
        {
            //sp_getAccountCustomer(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_acc in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getAccountCustomer", "sp_getAccountCustomer", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetInvItemQty(string _invNo, string _itm)
        {
            // Darshana 20-02-2014 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getinvitm_qty", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetReqItemQty(string _tp, string _subTp, string _invNo, string _itm)
        {
            // Darshana 20-02-2014
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[1] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subTp;
            (param[2] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getreqitm_qty", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        //sachith 2014/02/21
        public List<HpAccount> GetAccountsBySchmeAndDate(string _com, string _pc, DateTime _from, DateTime _to, string _scheme)
        {
            List<HpAccount> _accountList = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;


            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_acc_by_sch_dt", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _accountList = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            return _accountList;
        }

        public Int32 UpdateAccountAckPrintCount(string _accNo)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[2];
            //sp_updateonlinestatus(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2,o_effect out NUMBER) is
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("update_acc_ack_print", CommandType.StoredProcedure, param);
            return (Int32)effected;

        }


        public DataTable CheckBlackListCustomer(string _customer)
        {
            //sp_checkblacklistcustomer(p_customer in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbl", "sp_checkblacklistcustomer", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public CashGeneralEntiryDiscountDef GetGeneralDiscountDefinitionBySequence(int _seq)
        {
            CashGeneralEntiryDiscountDef _list = null;
            //sp_getgeneralentitydicount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;


            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_gen_disc_seq", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CashGeneralEntiryDiscountDef>(tblDet, CashGeneralEntiryDiscountDef.Converter)[0];
            }
            return _list;

        }


        //written by darshana 19/04/2013
        public DataTable getSerialpriceDetailsForCirDT(string _itm, string _cir)
        {
            List<PriceSerialRef> _serPriceDet = new List<PriceSerialRef>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[1] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedet = QueryDataTable("tblschemetype", "sp_getserialpriceforcir", CommandType.StoredProcedure, false, param);
            //if (_tblschemedet.Rows.Count > 0)
            //{
            //    _serPriceDet = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblschemedet, PriceSerialRef.Converter);
            //}

            return _tblschemedet;
        }

        public Int32 UpdateAccLogStatus(string _com, string _account, string _status, DateTime _date, Int32 _isCls)
        {
            //sp_updateacccashconvn(p_acc in NVARCHAR2,p_status in NVARCHAR2,p_date in date,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_cls", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isCls;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("sp_updateacclogstus", CommandType.StoredProcedure, param);

            return _effect;

        }

        public DataTable GetAccountGruntors(string _acc, int _typ, string _com = null)
        {
            List<PriceSerialRef> _serPriceDet = new List<PriceSerialRef>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[1] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _typ;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemedet = QueryDataTable("tblschemetype", "sp_get_cust_grun_test", CommandType.StoredProcedure, false, param);
            //sp_get_cust_grun
            //if (_tblschemedet.Rows.Count > 0)
            //{
            //    _serPriceDet = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblschemedet, PriceSerialRef.Converter);
            //}

            return _tblschemedet;
        }

        //darshana on 06-03-2014
        public DataTable GetPriceTypeByCir(string _cir)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getcirwisepricetp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //darshana on 06-03-2014
        public DataTable GetPromobyCirAndTp(string _cir, Int32 _tp)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getpromocdbycirandtp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetInsuReportDetCirc(string _com, string _pc, string _item, int _term, DateTime _asatdate, string _inscom, string _pol, string _PB, string _level, string _party, string _partycode, string _Circular)
        {
            //sp_getinsurancedef(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_item in NVARCHAR2,p_term in number,p_asatdate in date,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _term;
            (param[4] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate.Date;
            (param[5] = new OracleParameter("p_inscom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inscom;
            (param[6] = new OracleParameter("p_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pol;
            (param[7] = new OracleParameter("p_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PB;
            (param[8] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[9] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[10] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycode;
            (param[11] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Circular;

            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getinsurancedef_circ", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetInsuReportDet(string _com, string _pc, string _item, int _term, DateTime _asatdate, string _inscom, string _pol, string _PB, string _level, string _party, string _partycode)
        {
            //sp_getinsurancedef(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_item in NVARCHAR2,p_term in number,p_asatdate in date,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _term;
            (param[4] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate.Date;
            (param[5] = new OracleParameter("p_inscom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inscom;
            (param[6] = new OracleParameter("p_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pol;
            (param[7] = new OracleParameter("p_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PB;
            (param[8] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[9] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[10] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycode;

            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getinsurancedef", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public Int32 SaveClearInvoicePriceEdit(string _com, string _userId, string _invNo, string _sessrionId, DateTime _logDate)
        {
            //sp_updateacccashconvn(p_acc in NVARCHAR2,p_status in NVARCHAR2,p_date in date,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_lipe_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[1] = new OracleParameter("p_lipe_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_lipe_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[3] = new OracleParameter("p_lipe_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessrionId;
            (param[4] = new OracleParameter("p_lip_log_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _logDate;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("sp_save_clr_inv_price_edit", CommandType.StoredProcedure, param);

            return _effect;

        }

        public DataTable GetInsuEnquiry(string _com, string _pc, string _item, int _term, DateTime _asatdate, string _tp, string _insucom, string _pol, string _PB, string _Level, string _party, string _partycode)
        {
            // sp_getinsurancedefenq(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_item in NVARCHAR2,p_term in number,p_asatdate in date,p_tp in NVARCHAR2,p_insucom in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _term;
            (param[4] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate.Date;
            (param[5] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[6] = new OracleParameter("p_insucom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insucom;
            (param[7] = new OracleParameter("p_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pol;
            (param[8] = new OracleParameter("p_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PB;
            (param[9] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Level;
            (param[10] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[11] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycode;

            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getinsurancedefenq", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<CashPromotionDiscountDetail> GetPromotionalDiscountCancel(DateTime _date, int _time, string _day, string _book, string _level, string _item, string _company, string _partycd, string _partytp, Int32 _isSerialized, Int32 _isPromotion, Int32 _isSuperUser)
        {
            List<CashPromotionDiscountDetail> _returnLst = null;
            //sp_getpromotiondiscount(p_date in date,p_time in NUMBER,p_day in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_com in NVARCHAR2,p_partycode in NVARCHAR2,p_partytype IN NVARCHAR2,p_isserialized in NUMBER,p_ispromo in NUMBER,p_superuser in NUMBER,,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[1] = new OracleParameter("p_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _time;
            (param[2] = new OracleParameter("p_day", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _day;
            (param[3] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[7] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partycd;
            (param[8] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partytp;
            (param[9] = new OracleParameter("p_isserialized", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSerialized;
            (param[10] = new OracleParameter("p_ispromo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isPromotion;
            (param[11] = new OracleParameter("p_superuser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSuperUser;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_getpromotiondiscountcancel", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(tblDet, CashPromotionDiscountDetail.ConverterForEnq);
            }

            return _returnLst;
        }

        public List<ReptPickSerials> GetInvItem(string _dodoc, string _docom, string _user, DateTime _date, string _doloc)
        {
            //sp_getitem(p_doc in NVARCHAR2,c_data out sys_refcursor)
            List<ReptPickSerials> _result = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dodoc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getitem", "sp_getitem", CommandType.StoredProcedure, false, param);
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                foreach (DataRow r in _dtResults.Rows)
                {
                    ReptPickSerials _one = new ReptPickSerials();
                    _one.Tus_base_doc_no = string.Empty;
                    _one.Tus_base_itm_line = r.Field<Int32>("iti_itm_line");
                    _one.Tus_batch_line = 0;
                    _one.Tus_bin = r.Field<string>("iti_bin_cd");
                    _one.Tus_com = _docom;
                    _one.Tus_cre_by = _user;
                    _one.Tus_cre_dt = DateTime.Now.Date;
                    _one.Tus_doc_dt = _date.Date;
                    _one.Tus_doc_no = _dodoc;
                    _one.Tus_itm_cd = r.Field<string>("iti_itm_cd");
                    _one.Tus_itm_line = r.Field<Int32>("iti_itm_line");
                    _one.Tus_itm_stus = r.Field<string>("iti_itm_stus");
                    _one.Tus_loc = _doloc;
                    _one.Tus_qty = r.Field<decimal>("iti_qty");
                    if (_result == null) _result = new List<ReptPickSerials>();
                    _result.Add(_one);

                }

            }
            return _result;
        }

        //Darshana 21-03-2014
        public DataTable GetItemTp(string _tpCd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tpCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tpCd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getitemtype", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Darshana 24-03-2014
        public DataTable GetDefInvPrefix(string _com, string _tp)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_sTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getdefsaleprefix", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<PayTypeRestrict> GetPaymodeRestriction(string _com, string _pc, DateTime _date)
        {
            List<PayTypeRestrict> _list = null;
            //sp_getgeneralentitydicount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_pay_restrict", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PayTypeRestrict>(tblDet, PayTypeRestrict.Converter);
            }
            return _list;
        }
        public DataTable GetPriceForItem(string _book, string _level, string _item, DateTime _date, string _promo, string _circular)
        {
            //sp_getprice(p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_item in NVARCHAR2,p_date in date,p_promo in NVARCHAR2,p_circular in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[5] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getprice", "sp_getprice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //public List<PayTypeRestrict> GetPaymodeRestriction(string _com, string _pc, DateTime _date,int _type, string _code) {
        //    List<PayTypeRestrict> _list = null;
        //    //sp_getgeneralentitydicount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor)
        //    OracleParameter[] param = new OracleParameter[6];
        //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
        //    (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
        //    (param[2] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
        //    (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
        //    (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
        //    param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


        public DataTable GetInsuCriteria(string _com, string _search, string _item, string _brand, string _model, string _main, string _sub, string _serial, string _circular, string _promotion)
        {
            //sp_getinsudefcategorywise(p_com in NVARCHAR2, p_searchtp in NVARCHAR2,p_itm in NVARCHAR2,p_brand in NVARCHAR2,p_model in NVARCHAR2,p_main in NVARCHAR2,p_sub in NVARCHAR2,p_serial in NVARCHAR2,p_circular in NVARCHAR2,p_promotion in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_searchtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _search;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main;
            (param[6] = new OracleParameter("p_sub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sub;
            (param[7] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[8] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[9] = new OracleParameter("p_promotion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promotion;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getinsudefcategorywise", "sp_getinsudefcategorywise_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetInsuCriteriaAdditional(string _com, string _search, string _item, string _brand, string _model, string _main, string _sub, string _serial, string _circular, string _promotion, Int32 _cat)
        { //Nadeeka 
            //sp_getinsudefcategorywise(p_com in NVARCHAR2, p_searchtp in NVARCHAR2,p_itm in NVARCHAR2,p_brand in NVARCHAR2,p_model in NVARCHAR2,p_main in NVARCHAR2,p_sub in NVARCHAR2,p_serial in NVARCHAR2,p_circular in NVARCHAR2,p_promotion in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_searchtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _search;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main;
            (param[6] = new OracleParameter("p_sub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sub;
            (param[7] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[8] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[9] = new OracleParameter("p_promotion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promotion;
            (param[10] = new OracleParameter("p_cat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cat;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getinsudefAdditional", "sp_getinsudefAdditional", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //written by darshana 01-04-2014
        public MasterVehicalInsuranceDefinitionNew GetVehInsAmtNewMethod(string _com, string _ptyTp, string _ptyCd, string _insCom, string _insPol, string _salesTp, string _itm, Int32 _tearm, string _pBook, string _pLvl, DateTime _date, decimal _frmItmVal, decimal _toItmVal, string _prmoCd, string _ser)
        {
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ptyTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyTp;
            (param[2] = new OracleParameter("p_ptyCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyCd;
            (param[3] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insCom;
            (param[4] = new OracleParameter("p_ins_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPol;
            (param[5] = new OracleParameter("p_salesTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesTp;
            (param[6] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[7] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tearm;
            (param[8] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pBook;
            (param[9] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pLvl;
            (param[10] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[11] = new OracleParameter("p_frmitmVal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _frmItmVal;
            (param[12] = new OracleParameter("p_toitmVal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _toItmVal;
            (param[13] = new OracleParameter("p_promoCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prmoCd;
            (param[14] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_insu_amt_new_new", CommandType.StoredProcedure, false, param);

            MasterVehicalInsuranceDefinitionNew _VehInsDef = new MasterVehicalInsuranceDefinitionNew();
            if (_dtResults.Rows.Count > 0)
            {
                _VehInsDef = DataTableExtensions.ToGenericList<MasterVehicalInsuranceDefinitionNew>(_dtResults, MasterVehicalInsuranceDefinitionNew.Converter)[0];
            }
            return _VehInsDef;
        }

        //written by darshana on 01-04-2014
        public InvoiceItem GetInvDetByLine(string _invNo, string _itm, Int32 _line)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "get_invoice_items_byLine", CommandType.StoredProcedure, false, param);

            InvoiceItem _invDet = new InvoiceItem();
            if (_dtResults.Rows.Count > 0)
            {
                _invDet = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem)[0];
            }
            return _invDet;
        }
        //kapila
        public QoutationDetails GetQuotDetByItem(string _qno, string _itm)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_qno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _qno;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "get_quot_items_byItem", CommandType.StoredProcedure, false, param);

            QoutationDetails _invDet = new QoutationDetails();
            if (_dtResults.Rows.Count > 0)
            {
                _invDet = DataTableExtensions.ToGenericList<QoutationDetails>(_dtResults, QoutationDetails.ConvertTotal)[0];
            }
            return _invDet;
        }
        public DataTable CheckAccountClose(string _prifix, string _receiptno)
        {
            //sp_checkaccoutnclose(p_prefix in NVARCHAR2,p_receiptno in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prifix;
            (param[1] = new OracleParameter("p_receiptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_checkaccoutnclose", "sp_checkaccoutnclose", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }
        //darshana on 11-04-2014
        public Int32 UpdateInvoiceAccNew(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno, string _accNo, int _accSeqNo, int _accLogSeqNo, int _accUserSeqNo, decimal _insuVal)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            (param[4] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[5] = new OracleParameter("p_accseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accSeqNo;
            (param[6] = new OracleParameter("p_acclogseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accLogSeqNo;
            (param[7] = new OracleParameter("p_useraccno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accUserSeqNo;
            (param[8] = new OracleParameter("p_insuVal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insuVal;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_invoice_acc_new", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 11-04-2014
        public Int32 UpdateHptTxnNew(string _accNo, string _hptTxnNo, int _hptSeqNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[1] = new OracleParameter("p_hptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hptTxnNo;
            (param[2] = new OracleParameter("p_hptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hptSeqNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updt_HPTTXN", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 25-04-2014
        public MasterBusinessEntity GetAllCustomerProfileByCom(string CustCD, string nic, string DL, string PPNo, string brNo, string com, string ent_type)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[6] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ent_type;//Nadeeka 15-12-2014
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getAllCustomerProfileByCom", CommandType.StoredProcedure, false, param);

            MasterBusinessEntity bizEnt = new MasterBusinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }
            return bizEnt;
        }
        public List<CashSalesRev_History> Load_reversalsItems(string _fuc_cd)
        {
            List<CashSalesRev_History> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_invoice_rev_items", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.Converter);
            }
            return _ListItems;

        }
        public List<CashSalesRev_History> Load_Invoicedetails(string _fuc_cd)
        {
            List<CashSalesRev_History> _ListInvoice = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_invoice_details", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListInvoice = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterInvoiceDetails);
            }
            return _ListInvoice;

        }
        public List<CashSalesRev_History> Load_OutItemDetails(string _fuc_cd)
        {
            List<CashSalesRev_History> _ListOutItm = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GETALLOUTITEMSDETALS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListOutItm = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterOutItemDetails);
            }
            return _ListOutItm;

        }
        public List<CashSalesRev_History> Load_DeptComments(string _fuc_cd)
        {


            List<CashSalesRev_History> _ListOutCmnt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GETDEPT_COMMENTS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListOutCmnt = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterComments);
            }
            return _ListOutCmnt;

        }
        //Written By shanuka
        public List<CashSalesRev_History> Load_AdvanceRecepts(string _fuc_cd)
        {

            List<CashSalesRev_History> _lstAdvance_Recept = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_RECEIPT_HIS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _lstAdvance_Recept = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterAdvanceRecpt);
            }
            return _lstAdvance_Recept;

        }
        //kapila
        public List<InvoiceItem> GetVehInsuAllowInv(string _company, string _profitcenter, DateTime _date)
        {
            List<InvoiceItem> _userList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getinsuallowinv", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem);
            return _userList;
        }
        //kapila
        public List<InvoiceItem> GetVehInsuAllowCredInv(string _company, string _profitcenter, DateTime _date)
        {
            List<InvoiceItem> _userList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getinsuallowcredinv", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem);
            return _userList;
        }
        //kapila
        public DataTable GetVehInsuAllowDCNItems(string _company, string _loc, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getinsuallowdcnitems", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable get_DCN_DP_Cust(string _company, string _loc, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_get_DCN_DP_Cust", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable get_DCN_receipt(string _company, string _loc, string _qno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_qno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _qno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_get_DCN_receipt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<InvoiceItem> GetVehRegAllowInv(string _company, string _profitcenter, DateTime _date)
        {
            List<InvoiceItem> _userList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getregallowinv", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _userList = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem);
            return _userList;
        }

        //darshana on 26-05-2014
        public List<HpSchemeDetails> GetSchForActivation(string _tp, string _cd, Int16 _act)
        {
            List<HpSchemeDetails> _details = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_Tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[1] = new OracleParameter("p_Cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[2] = new OracleParameter("p_Act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _act;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getinactschemes", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _details = DataTableExtensions.ToGenericList<HpSchemeDetails>(_dtResults, HpSchemeDetails.Converter);
            return _details;
        }

        //darshana on 26-05-2014
        public Int32 SaveSchemeActLog(string _schCd, string _user)
        {


            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCd;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("sp_savesch_actlog", CommandType.StoredProcedure, param);

            return _effect;

        }

        //darshana on 26-05-2014
        public Int32 UpdateSchemeActStatus(string _schCd, string _user, Boolean _act)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_schCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCd;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _act;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("sp_updatesch_actstus", CommandType.StoredProcedure, param);

            return _effect;

        }
        //darshana on 29-05-2014
        public int UpdateAccLogClsDt(DateTime _date, string _acc, string _com)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatelogclsdt", CommandType.StoredProcedure, param);
            return effects;

        }

        //Darshana to avoid used additional amounts
        public DataTable IsAdvanAmtExceed(string _company, string _profitcenter, string _recNo, decimal _usedAmt)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_recNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[3] = new OracleParameter("p_usedAmt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usedAmt;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblIsFwd = QueryDataTable("tblIsFwd", "sp_isadvanamtexceed", CommandType.StoredProcedure, false, param);
            return tblIsFwd;
        }
        public List<HireSalesReversal_Det> Load_ExchangeItems(string _fuc_cd)
        {


            List<HireSalesReversal_Det> _ListExchItem = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_invoice_exchange_items", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListExchItem = DataTableExtensions.ToGenericList<HireSalesReversal_Det>(_dtResults, HireSalesReversal_Det.Converter);
            }
            return _ListExchItem;
        }
        public DataTable Get_Itemstatus()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GETLPSTATUSEXC", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public List<HireSalesReversal_Det> Get_Itemdetails(string Itemcode)
        {
            List<HireSalesReversal_Det> _ListOutItem = null;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_inv_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Itemcode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_itemcode_details", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListOutItem = DataTableExtensions.ToGenericList<HireSalesReversal_Det>(_dtResults, HireSalesReversal_Det.ConverterItemDetails);
            }

            return _ListOutItem;
        }
        public Int32 SaveOutItemdetailsHS(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;
            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                int line = 1;
                //string _documentNo = "";
                OracleParameter[] param = new OracleParameter[11];
                objOutItems.Invoice_No = _itemDetails.ObjOutRevItems.Invoice_No;
                objOutItems.Usr_charge = _itemDetails.Usr_charge;
                objOutItems.Usr = _itemDetails.Usr;
                objOutItems.Out_req_param = _itemDetails.Dis_Usrchrge;
                objOutItems.Flag = _itemDetails.Flag;
                objOutItems.In_ItemCode1 = _itemDetails.In_ItemCode1;
                objOutItems.In_Itm_status = _itemDetails.In_Itm_status;
                objOutItems.OutItmTax = _itemDetails.OutItmTax;
                objOutItems.PriceWithOutTax = _itemDetails.PriceWithOutTax;
                (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Item_code;
                (param[2] = new OracleParameter("p_usr_charge", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Usr_charge;
                (param[3] = new OracleParameter("p_Discount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Discount;
                (param[4] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param[5] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param[6] = new OracleParameter("p_dis_usrcharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Dis_Usrchrge;
                (param[7] = new OracleParameter("p_drp_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Drp_value;
                (param[8] = new OracleParameter("p_OutTax", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.OutItmTax;
                (param[9] = new OracleParameter("p_WithoutTax", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.PriceWithOutTax;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                line++;
                effects = (Int16)UpdateRecords("SP_UPDATE_HS_OUT_EXCHANGE", CommandType.StoredProcedure, param);
                //_err = _documentNo;

            }

            return effects;
        }
        public Int32 SaveINItemdetailsHS(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;

            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                OracleParameter[] param_hd = new OracleParameter[9];
                // int linehd = 1;
                (param_hd[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;

                (param_hd[1] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param_hd[2] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param_hd[3] = new OracleParameter("p_dis_usrcharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Dis_Usrchrge;
                (param_hd[4] = new OracleParameter("p_Item_Ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.In_Itm_status;
                (param_hd[5] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_Remark;
                (param_hd[6] = new OracleParameter(" p_In_itmCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.In_ItemCode1;
                (param_hd[7] = new OracleParameter("p_Discount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Usr_charge;
                param_hd[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_HS_EXCHANGE", CommandType.StoredProcedure, param_hd);

            }
            return effects;
        }
        public Int32 SaveApprovals(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;

            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                OracleParameter[] param_hd = new OracleParameter[8];

                (param_hd[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param_hd[1] = new OracleParameter("p_discount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itemDetails.Discount;
                (param_hd[2] = new OracleParameter("p_effectivedate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(_itemDetails.Effective_date).Date;
                (param_hd[3] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Remark;
                (param_hd[4] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param_hd[5] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param_hd[6] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                param_hd[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_HS_REVERT", CommandType.StoredProcedure, param_hd);

            }
            return effects;
        }
        //Written by Shanuka  on 27/05/2014 
        public Int32 SaveCommentDetails(string invNO, string user, string remark, string dept, string rec_tp)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNO;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[2] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remark;
            (param[3] = new OracleParameter("p_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dept;
            (param[4] = new OracleParameter("P_APP_REQ_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rec_tp;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_COMMENTS", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable GetSalesHdrHS(string _invNo)
        {
            // shalika 04/06/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_hdr_hs", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetPromoDetails(string _item)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_PROMOTIONDETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public DataTable GetInvoiceDetailByInvoiceTableHS(string _invoice)
        {
            //sp_getinvoiceitembyinvoice  (p_invno IN NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getinvoiceitembyinvoiceHS", CommandType.StoredProcedure, false, param);


            return _tblData;
        }

        //Shanuka Perera 10/Jun/2014
        public DataTable GET_RECEIPTS(string _invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblRequestDet", "SP_GET_RECEIPTS", CommandType.StoredProcedure, false, param);

            return _dtResult;
        }

        //SHANUKA PERERA 11/Jun/2014
        public Int32 SaveAdvancedRep_Details(CashSales_Out_RevItems _objAdvanced)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objAdvanced.Invoice_No;
            (param[1] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objAdvanced.Sart_cd;
            (param[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objAdvanced.Flag;
            (param[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objAdvanced.Usr_id;
            (param[4] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objAdvanced.Usr_Remark;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_ADVANCE_RECEPT_APP_PRO", CommandType.StoredProcedure, param);

            return effects;
        }
        public DataTable _lstCustomerDetails(string _fuc_cd)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getrevertcustomerdet", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable _lstRevertItemDetails(string _fuc_cd)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getrevertItemdetails", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable Load_RevertReleaseHistory(string _fuc_cd)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getrevertItemHistory", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public List<CashSalesRev_History> Load_OutItemDetailsHS(string _fuc_cd)
        {
            List<CashSalesRev_History> _ListOutItm = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GETALLOUTITEMSDETALSHS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListOutItm = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterOutItemDetails);
            }
            return _ListOutItm;

        }

        //darshana on 13-06-2014
        public Int16 SaveSchemeAddDetailLog(string p_code)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_code;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_schadd_det_log", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana on 13-06-2014
        public Int16 SaveSchemeAddDetails(HPAddSchemePara _schAddPara)
        {
            OracleParameter[] param = new OracleParameter[26];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_hap_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_com;
            (param[1] = new OracleParameter("p_hap_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_sch;
            (param[2] = new OracleParameter("p_hap_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_tp;
            (param[3] = new OracleParameter("p_hap_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_cd;
            (param[4] = new OracleParameter("p_hap_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schAddPara.Hap_frm;
            (param[5] = new OracleParameter("p_hap_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schAddPara.Hap_to;
            (param[6] = new OracleParameter("p_hap_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal1;
            (param[7] = new OracleParameter("p_hap_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal2;
            (param[8] = new OracleParameter("p_hap_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal3;
            (param[9] = new OracleParameter("p_hap_val1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schAddPara.Hap_val1;
            (param[10] = new OracleParameter("p_hap_val2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schAddPara.Hap_val2;
            (param[11] = new OracleParameter("p_hap_val3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schAddPara.Hap_val3;
            (param[12] = new OracleParameter("p_hap_anal4", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal4;
            (param[13] = new OracleParameter("p_hap_anal5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal5;
            (param[14] = new OracleParameter("p_hap_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_cre_by;
            (param[15] = new OracleParameter("p_hap_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schAddPara.Hap_cre_when;
            (param[16] = new OracleParameter("p_hap_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schAddPara.Hap_mod_by;
            (param[17] = new OracleParameter("p_hap_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schAddPara.Hap_mod_when;
            (param[18] = new OracleParameter("p_hap_val4", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schAddPara.Hap_val4;
            (param[19] = new OracleParameter("p_hap_val5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schAddPara.Hap_val5;
            (param[20] = new OracleParameter("p_hap_anal6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal6;
            (param[21] = new OracleParameter("p_hap_anal7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal7;     //kapila 24/9/2015
            (param[22] = new OracleParameter("p_hap_anal8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal8;
            (param[23] = new OracleParameter("p_hap_anal9", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schAddPara.Hap_anal9;
            (param[24] = new OracleParameter("p_hap_val6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _schAddPara.Hap_val6; //Sanjeewa 2016-06-02
            param[25] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sch_adddet", CommandType.StoredProcedure, param);
            return effects;
        }
        //Darshana 16-06-2014
        public List<HPAddSchemePara> GetAddParaDetails(string _type, string _schCd)
        {
            List<HPAddSchemePara> _paraDet = null;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_Tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_schCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getaddpara", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _paraDet = DataTableExtensions.ToGenericList<HPAddSchemePara>(_dtResults, HPAddSchemePara.Converter);
            }

            return _paraDet;
        }
        //convert to data table by Darshana 17-06-2014
        public DataTable GetAllSchemeCircularsToDataTable()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_getallschcirculars", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //by darshana on 17-06-2014
        public DataTable GetCustomerSalesDet(string _com, string _invTp, DateTime _frmDt, DateTime _toDt, string _cus, string _invNo)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invTp;
            (param[2] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[3] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            (param[4] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[5] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblCusSales", "sp_getcusinvdet", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //by darshana on 27-06-2014
        public DataTable CheckPreviousUseInvoice(string _com, string _invNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblCusSales", "sp_checkinvuse", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetItemdetails(string _invNo)
        {
            // shalika 04/06/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_MANGERISSUEITEMDETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetManagerandCustomerIssueAmt(string _invNo)
        {
            // shalika 04/06/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_MANGER_ISSUE_AMT", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetVehicalRegisDetails(string _invoice_no, string _sart_cd)
        {
            // SHANUKA PERERA 18/06/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice_no;
            (param[1] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sart_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_REGIS_DETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;


        }

        //shanuka perera 19/06/2014
        public Int32 SaveVehReDetails(CashSales_Out_RevItems objrev_det)
        {
            Int32 effects = 0;
            if (objrev_det.ListReversalItems != null)
            {
                foreach (CashSales_Out_Rev_Items_Details _itemDetails in objrev_det.ListReversalItems)
                {
                    OracleParameter[] param = new OracleParameter[7];
                    (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                    (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ItemCode;
                    (param[2] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                    (param[3] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Flag;
                    (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_id;
                    (param[5] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_Remark;

                    param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_VEH_REG_APP_PROCESS", CommandType.StoredProcedure, param);
                }
            }
            return effects;
        }
        //shalika 19/06/2014 Portal
        public Int32 SaveApprovalsManagerIsuRev(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;

            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                OracleParameter[] param_hd = new OracleParameter[7];

                (param_hd[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param_hd[1] = new OracleParameter("p_refund_amt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _itemDetails.RefundAmnt;
                (param_hd[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param_hd[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param_hd[4] = new OracleParameter("p_usr_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Remark;
                (param_hd[5] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                param_hd[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_MGR_ISS_REV", CommandType.StoredProcedure, param_hd);

            }
            return effects;
        }

        //Chamal 19-06-2014
        public List<PromoVoucherDefinition> GetProVouhByCir(string _cir)
        {
            List<PromoVoucherDefinition> _schList = new List<PromoVoucherDefinition>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_searchpromvouhbycir", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _schList = DataTableExtensions.ToGenericList<PromoVoucherDefinition>(_dtResults, PromoVoucherDefinition.Converter);
            }

            return _schList;
        }

        //Chamal on 20-06-2014
        public Int16 SaveTempPromoVoucher(PromoVoucherDefinition _schSchemeCommDef)
        {
            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("p_spd_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_seq;
            (param[1] = new OracleParameter("p_spd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_com;
            (param[2] = new OracleParameter("p_spd_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_sale_tp;
            (param[3] = new OracleParameter("p_spd_vou_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_vou_cd;
            (param[4] = new OracleParameter("p_spd_circular_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_circular_no;
            (param[5] = new OracleParameter("p_spd_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_pty_tp;
            (param[6] = new OracleParameter("p_spd_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_pty_cd;
            (param[7] = new OracleParameter("p_spd_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_from_dt.Date;
            (param[8] = new OracleParameter("p_spd_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_to_dt.Date;
            (param[9] = new OracleParameter("p_spd_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_pb;
            (param[10] = new OracleParameter("p_spd_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_pb_lvl;
            (param[11] = new OracleParameter("p_spd_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_brd;
            (param[12] = new OracleParameter("p_spd_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_main_cat;
            (param[13] = new OracleParameter("p_spd_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_cat;
            (param[14] = new OracleParameter("p_spd_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_itm;
            (param[15] = new OracleParameter("p_spd_disc", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_disc;
            (param[16] = new OracleParameter("p_spd_disc_isrt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_disc_isrt;
            (param[17] = new OracleParameter("p_spd_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_stus;
            (param[18] = new OracleParameter("p_spd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_cre_by;
            (param[19] = new OracleParameter("p_spd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_mod_by;
            (param[20] = new OracleParameter("p_spd_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_period;
            (param[21] = new OracleParameter("p_spd_rdm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_rdm_com;
            (param[22] = new OracleParameter("p_spd_rdm_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_rdm_pb;
            (param[23] = new OracleParameter("p_spd_rdm_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schSchemeCommDef.Spd_rdm_pb_lvl;
            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int16)UpdateRecords("sp_temp_sar_provou_det", CommandType.StoredProcedure, param);
        }

        //Chamal on 20-06-2014
        public Int16 SavePromoVoucher(string _com, string _vouCode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_spd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_spd_vou_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouCode;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int16)UpdateRecords("sp_sarprovoudet_bulk", CommandType.StoredProcedure, param);
        }

        // SHANUKA PERERA 21/06/2014
        public DataTable FillVehRegisHisDetails(string _invoice_no, string _sart_cd)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice_no;
            (param[1] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sart_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_VEHICAL_REGIS_HIS", CommandType.StoredProcedure, false, param);
            return _tblData;


        }
        public DataTable Load_ManagerChqRect_Details(string _invNo)
        {
            // shalika 24/06/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_RTN_CHK_RCPT_REV", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable Load_ManagerIssueRevHistory(string _fuc_cd)
        {
            // shalika 24/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getManagerIssueRevHistory", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable Load_CashConversionHistory(string _fuc_cd)
        {
            // shalika 24/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getCashConHistry", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable Load_ReceiptReversalHis(string _fuc_cd)
        {
            // shalika 24/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getManagerIssueRevHistory", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable Load_ManualDoc_TrnsrHis(string _fuc_cd)
        {
            // shalika 24/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getManualDocTrnzrHistory", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable Load_CashConersion_Details(string _fuc_cd)
        {
            // shalika 25/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getCashConersion_Details", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        // shalika 25/06/2014
        public Int32 SaveApprovalsCashConversion(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;

            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                OracleParameter[] param_hd = new OracleParameter[6];

                (param_hd[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param_hd[1] = new OracleParameter("p_refund_amt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _itemDetails.RefundAmnt;
                (param_hd[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param_hd[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param_hd[4] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_Remark;
                param_hd[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_CASH_CONVERSION", CommandType.StoredProcedure, param_hd);

            }
            return effects;
        }
        public DataTable Load_AccountReScheduleHistory(string _fuc_cd)
        {
            // shalika 24/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getAccountReSheHistory", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public List<PromoVoucherDefinition> GetPromoVoucherDefinition(string _company, string _salesType, string _partyType, string _partyCode, DateTime _date, string _pb, string _pbLevel, string _brand, string _cate1, string _cate2, string _item)
        {
            List<PromoVoucherDefinition> _returnLst = null;
            DataTable tblDet = null;
            DataTable tblrtn = new DataTable();


            int _level = 6;

            for (int i = 1; i <= _level; i++)
            {
                OracleParameter[] param = new OracleParameter[13];
                (param[0] = new OracleParameter("p_order", OracleDbType.Int32, null, ParameterDirection.Input)).Value = i;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
                (param[2] = new OracleParameter("p_salestype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesType;
                (param[3] = new OracleParameter("p_partytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partyType;
                (param[4] = new OracleParameter("p_partycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partyCode;
                (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
                (param[6] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
                (param[7] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbLevel;
                (param[8] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
                (param[9] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
                (param[10] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2;
                (param[11] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

                param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                tblDet = QueryDataTable("tblVou", "sp_getpromovouchers", CommandType.StoredProcedure, false, param);


                if (tblDet.Rows.Count > 0)
                {
                    tblrtn.Merge(tblDet);
                }
            }


            if (tblrtn.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<PromoVoucherDefinition>(tblrtn, PromoVoucherDefinition.Converter);
            }

            return _returnLst;
        }
        public DataTable Load_AccountReschedule_Details(string _fuc_cd)
        {
            // shalika 27/06/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getAccountResch_Details", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public Int32 GetPromotionVoucherNo()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            param[0] = new OracleParameter("o_seq", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_seqpromovouno", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable Get_RequstingSchm(string _Grad_aNal2)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("grad_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Grad_aNal2;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GETREQUSTINGSCHEMS", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable CheckPromoVoucherNo(string _company, string _cust, string _nic, string _mobi, DateTime _date, int _vouNo, string gvcode)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[2] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobi", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobi;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[5] = new OracleParameter("p_vouno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vouNo;
            (param[6] = new OracleParameter("p_gvcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = gvcode;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_chk_promo_vou_test", CommandType.StoredProcedure, false, param);


        }

        public DataTable CheckPromoVoucherParaNo(string _company, string _vou, string _tp, string _cd, Int32 _prd)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[4] = new OracleParameter("p_prd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _prd;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "SP_CHK_PROMO_VOU_PARA", CommandType.StoredProcedure, false, param);

        }

        public PromoVoucherDefinition GetPromoVoucherDefinitionBySeq(int _seq, string _pb, string _pbLevel)
        {
            PromoVoucherDefinition _returnLst = null;
            DataTable tblDet = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[2] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbLevel;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tblDet = QueryDataTable("tblVou", "sp_getpromovouchersbyseq", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<PromoVoucherDefinition>(tblDet, PromoVoucherDefinition.Converter)[0];
            }
            return _returnLst;
        }

        public bool CheckPromoVouRedeemItem(int _seq, string _item, string _brnd, string _cat1, string _cat2)
        {
            DataTable tblDet = null;

            int _level = 6;

            for (int i = 1; i <= _level; i++)
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
                (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param[2] = new OracleParameter("p_order", OracleDbType.Int32, null, ParameterDirection.Input)).Value = i;
                (param[3] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brnd;
                (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
                (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
                param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                tblDet = QueryDataTable("tblVou", "sp_chkprovourdeemitem", CommandType.StoredProcedure, false, param);

                if (tblDet.Rows.Count > 0)
                {
                    break;
                }
            }

            if (tblDet.Rows.Count > 0)
            {
                return true;
            }
            else
            {
                return false;
            }

        }

        public List<GiftVoucherPages> GetVoucherPage(int _query, string _com, string _pc, DateTime _date, string _gvCode, string _stus, string _page, string _prefix, string gvp_gv_cd)
        {
            OracleParameter[] param = new OracleParameter[10];
            List<GiftVoucherPages> _gift = null;
            (param[0] = new OracleParameter("p_query", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _query;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_gv_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gvCode;
            (param[5] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[6] = new OracleParameter("p_page", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _page;
            (param[7] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            (param[8] = new OracleParameter("gvp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = gvp_gv_cd;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _dtResults = QueryDataTable("tbl", "sp_getgvpage", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getgvpage_test", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _gift = DataTableExtensions.ToGenericList<GiftVoucherPages>(_dtResults, GiftVoucherPages.Converter);
            }
            return _gift;
        }

        //public DataTable GetProVouAllowCompanies(string _company, string _vouType)
        //{
        //    OracleParameter[] param = new OracleParameter[3];
        //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
        //    (param[1] = new OracleParameter("p_vou_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouType;
        //    param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
        //    return QueryDataTable("tbl", "sp_getpromovoualwcom", CommandType.StoredProcedure, false, param);
        //}

        public DataTable GetProVouAllowCompanies(string _company, int _vouSeq)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_vou_ref", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vouSeq;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_getpromovouredeemcom", CommandType.StoredProcedure, false, param);
        }

        public Int32 Update_GV_Pages(int _queryNo, string _com, string _pc, DateTime _date, string _gvCode, string _status, int _pageNo, string _prefix, string _user, string _fromString)
        {
            //Chamal 6-Jul-2014
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_query", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _queryNo;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_gv_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gvCode;
            (param[5] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("p_page", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pageNo;
            (param[7] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            (param[8] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[9] = new OracleParameter("p_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromString;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_gvpage", CommandType.StoredProcedure, param);
            return effects;

        }
        public DataTable Load_CashRefund_Details(string _invNo)
        {
            // shalika 07/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_CASH_REFUND_DET", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public Int32 SaveApprovalsCashRefund(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;
            // shalika 07/07/2014
            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                OracleParameter[] param_hd = new OracleParameter[6];

                (param_hd[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param_hd[1] = new OracleParameter("p_refund_amt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _itemDetails.RefundAmnt;
                (param_hd[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param_hd[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param_hd[4] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Remark;
                param_hd[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_CASH_REFUND", CommandType.StoredProcedure, param_hd);

            }
            return effects;
        }
        // shalika 07/07/2014
        public List<CashSalesRev_History> Load_CashRefundHis(string _fuc_cd)
        {
            List<CashSalesRev_History> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_CASH_REFUND_HIS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterCashRefund);
            }
            return _ListItems;

        }
        public DataTable Load_Manual_Doc_Tranfr_Details(string _invNo)
        {
            // shalika 08/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_MANUAL_DOC_DETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public Int32 SaveManualDocTrnsr(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;
            // shalika 08/07/2014
            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                objOutItems.Invoice_No = _itemDetails.ObjOutRevItems.Invoice_No;
                objOutItems.Flag = _itemDetails.Flag;
                objOutItems.Usr = _itemDetails.Usr;
                objOutItems.Remark = _itemDetails.Remark;
            }


            OracleParameter[] param_hd = new OracleParameter[5];

            (param_hd[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objOutItems.Invoice_No;
            (param_hd[1] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objOutItems.Flag;
            (param_hd[2] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objOutItems.Usr;
            (param_hd[3] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objOutItems.Remark;
            param_hd[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATE_MANUAL_DOC_TRNSR", CommandType.StoredProcedure, param_hd);

            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                objOutItems.Invoice_No = _itemDetails.ObjOutRevItems.Invoice_No;
                objOutItems.Flag = _itemDetails.Flag;
                objOutItems.Usr = _itemDetails.Usr;
                objOutItems.Remark = _itemDetails.Remark;
                OracleParameter[] param_ser = new OracleParameter[4];
                (param_ser[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param_ser[1] = new OracleParameter("p_bookno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Bookno;
                (param_ser[2] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                param_ser[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("sp_gen_reqapp_ser_log_portal", CommandType.StoredProcedure, param_ser);

            }

            return effects;
        }

        public DataTable Load_Rev_Acc_Holder(string _invNo)
        {
            // shalika 08/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_REV_ACC_HOLDER_DTLS", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        // shanuka 08/07/2014
        public DataTable Get_Special_EarlyDiscount_Details(string _invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_SPECIALCLOSINGDIS_DETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        //shanuka perera 09/07/2014
        public Int32 Insert_Special_Closing_Dis_Details(CashSales_Out_RevItems objrev_det)
        {
            Int32 effects = 0;
            if (objrev_det.ListReversalItems != null)
            {
                foreach (CashSales_Out_Rev_Items_Details _itemDetails in objrev_det.ListReversalItems)
                {
                    OracleParameter[] param = new OracleParameter[8];
                    (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                    (param[1] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                    (param[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Flag;
                    (param[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_id;
                    (param[4] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_Remark;
                    (param[5] = new OracleParameter("P_grad_val1", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Discount;
                    (param[6] = new OracleParameter("P_grad_date_param", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.EffDate;
                    param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_INSERT_SPECILA_CLOSING", CommandType.StoredProcedure, param);
                }
            }
            return effects;
        }

        // shanuka 11/07/2014
        public DataTable Get_Dutyfree_Ex_Det(string _invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_DUTY_FREE_EX_DETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        // Tharaka 11/07/2014
        public Int32 DeleteTempPromoVoucher(string CreateUser)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_spd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CreateUser;
            param[1] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_dlt_tempbyuser", CommandType.StoredProcedure, param);

            return effects;
        }

        //Tharaka 2014-07-14
        public Int16 SaveTempPromoVoucherItems(PromotionVoucherItems _PromotionVoucherItems)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("spi_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_seq;
            (param[1] = new OracleParameter("spi_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_itm_seq;
            (param[2] = new OracleParameter("spi_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_itm;
            (param[3] = new OracleParameter("spi_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_itm_stus;
            (param[4] = new OracleParameter("spi_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_act;
            (param[5] = new OracleParameter("spi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_cre_by;
            (param[6] = new OracleParameter("spi_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_mod_by;
            (param[7] = new OracleParameter("P_spi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_brand;
            (param[8] = new OracleParameter("P_spi_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_cat1;
            (param[9] = new OracleParameter("P_spi_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PromotionVoucherItems.Spi_cat2;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int16)UpdateRecords("sp_temp_save_sar_provou_itm", CommandType.StoredProcedure, param);
        }

        //Tharaka 2014-07-15
        public DataTable GetPromotionItemsByBatchSeq(Int32 BatchSeq)
        {
            // shalika 04/06/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_P_spi_seqinv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = BatchSeq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getprovouitemsbyseq", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //shanuka perera 15/07/2014
        public Int32 SaveDutyFreeDet(CashSales_Out_RevItems objrev_det)
        {
            Int32 effects = 0;
            if (objrev_det.ListReversalItems != null)
            {
                foreach (CashSales_Out_Rev_Items_Details _itemDetails in objrev_det.ListReversalItems)
                {
                    OracleParameter[] param = new OracleParameter[9];
                    (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                    (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ItemCode;
                    (param[2] = new OracleParameter("P_grad_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.GRAD_ANAL3;
                    (param[3] = new OracleParameter("p_out_tot_price", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Discount;
                    (param[4] = new OracleParameter("p_sart_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                    (param[5] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Flag;
                    (param[6] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_id;
                    (param[7] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_Remark;
                    param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_DUTY_FREE_EX_SAVE_PROCESS", CommandType.StoredProcedure, param);
                }
            }
            return effects;
        }

        //Tharaka 2014-07-17
        public Int32 UpdatePromotionVoucherStatus(string CricularNo, int Status, string modUser)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_spd_circular_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CricularNo;
            (param[1] = new OracleParameter("P_spd_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Status;
            (param[2] = new OracleParameter("P_spd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modUser;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_provou_def_updatestatus", CommandType.StoredProcedure, param);

            return effects;

        }
        //shalik on 2014/07/24
        //public DataTable Load_Summery_History(string _fuc_cd)
        //{
        //    OracleParameter[] param = new OracleParameter[2];
        //    (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
        //    param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

        //    DataTable _dtResults = QueryDataTable("tbl", "sp_get_app_chain", CommandType.StoredProcedure, false, param);


        //    return _dtResults;
        //}
        //Temporally chnge this method for testing purpose-Shalika
        public DataTable Load_Summery_History(string _fuc_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            string com = "";
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "get_allitemdetails", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable Get_ReqType()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SEC_APPREQ_TP", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        // shalika 27/07/2014
        public Int32 SaveApprovalsAccountReschedule(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;

            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListOut_Rev_Items_Details)
            {
                OracleParameter[] param_hd = new OracleParameter[6];

                (param_hd[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param_hd[1] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Itm_status;
                (param_hd[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                (param_hd[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Usr;
                (param_hd[4] = new OracleParameter("P_Remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Remark;
                param_hd[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_ACCOUNT_RESCHEDULE", CommandType.StoredProcedure, param_hd);

            }
            return effects;
        }
        public DataTable Get_NewOutItemPrice(string _invNo, string _itm_Code)
        {
            // shalika 07/07/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_itm_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_Code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_outItem_tot_price", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable Load_Period_Over_Details(string _invNo)
        {
            // SHANUKA PERERA 29/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_RECEIPT_HIS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable Load_DutyFree_det(string _invNo)
        {
            // SHANUKA PERERA 30/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_DUTYFREE_HIS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable Load_Specila_Closing_his(string _invNo)
        {
            // SHANUKA PERERA 30/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_SPECIAL_CLOSING_HIS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Tharaka 30/07/2014
        public Int32 UpdateReversalCancelQty(decimal P_SAD_QTY, string P_SAD_INV_NO, string P_SAD_ITM_CD, Int32 P_SAD_ITM_LINE)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_SAD_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = P_SAD_QTY;
            (param[1] = new OracleParameter("P_SAD_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = P_SAD_INV_NO;
            (param[2] = new OracleParameter("P_SAD_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = P_SAD_ITM_CD;
            (param[3] = new OracleParameter("P_SAD_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = P_SAD_ITM_LINE;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("SP_UPDATE_SRN_CANCEL_QTY", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetSerialsForItem(string _com, string _item, string _itemstatus)
        {
            //SHANUKA 2014-07-30
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("in_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;

            DataTable _tblData = QueryDataTable("tbData", "SP_LOAD_SERIALS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable Get_Prf_Cent_Det(string invNo)
        {
            // SHANUKA PERERA 30/07/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_PROF_CENTER", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable Get_Loc_Det(string com, string prf)
        {
            // SHANUKA PERERA 30/07/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_profit_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prf;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_LOC_DETALS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable Get_Pblevel_book(string invNo)
        {
            // SHANUKA PERERA 01/08/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_PBLEVEL_PBBOOK", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable GetPTypeByInvSeq(string _book, string _lvl, Int32 _itmSeq, Int32 _pbSeq)
        {
            //Darshana 01-08-2014
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[1] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            (param[2] = new OracleParameter("p_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmSeq;
            (param[3] = new OracleParameter("p_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pbSeq;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getpricetypebyinvseq", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public int ApprovePromotion(int seq, int pbSeq, string promo, string User)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_sapd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_sapd_pb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pbSeq;
            (param[2] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = promo;
            (param[3] = new OracleParameter("P_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_update_promotion_approve", CommandType.StoredProcedure, param);

            return _effect;
        }

        //Tharaka on 02-08-2014
        public int ApprovePromotionlDiscount(string _cir, Int16 status)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("P_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PRO_DIS_APPROVE", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka on 02-08-2014
        public int SaveDiscountDefinitionLog(LogPriceDef _logPrice)
        {

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Promo_cd;
            (param[1] = new OracleParameter("p_cir_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Cir_no;
            (param[2] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _logPrice.From_dt;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _logPrice.To_dt;
            (param[4] = new OracleParameter("p_log_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Log_usr;
            (param[5] = new OracleParameter("p_log_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Log_session;
            (param[6] = new OracleParameter("p_log_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _logPrice.Log_rmk;


            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_DISCOUNT_LOG", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable GetJobNoServiceApp(string invNo)
        {
            // SHANUKA PERERA 04/08/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_fun_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GETJOBNOAPPR", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Tharaka on 06-08-2014
        public DataTable GetDiscountRequest(string Com, string PC, string Loc, string user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            (param[3] = new OracleParameter("P_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_DISNT_REST_DETAIL", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _tblData.Rows.Count; i++)
            {
                _tblData.Rows[i]["SGDD_CRE_DT"] = Convert.ToDateTime(_tblData.Rows[i]["SGDD_CRE_DT"].ToString()).ToString("dd/MM/yyyy");
            }
            return _tblData;
        }

        //Tharaka on 07-08-2014
        public int UpdateDiscountDefintionStatus(string user, decimal discount, int status, string SeqNo, decimal amount)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sgdd_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status.ToString();
            (param[1] = new OracleParameter("p_sgdd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[2] = new OracleParameter("p_sgdd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SeqNo;
            (param[3] = new OracleParameter("P_SGDD_DISC_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = discount;
            (param[4] = new OracleParameter("P_SGDD_DISC_Value", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = amount;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("Sp_dicnt_def_chng_status", CommandType.StoredProcedure, param);
            return effects;
        }

        // Tharaka on 2014-08-04
        public int InsertIntoSCM_POPUP_COLECTOR(PopupCollect oPopupCollector)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int16 effects = 0; ;
            (param[0] = new OracleParameter("p_doc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Doc_type;
            (param[1] = new OracleParameter("p_cur_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = oPopupCollector.Cur_date;
            (param[2] = new OracleParameter("p_sender", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Sender;
            (param[3] = new OracleParameter("p_receiver", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Receiver;
            (param[4] = new OracleParameter("p_message", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Message;
            (param[5] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Doc_no;
            (param[6] = new OracleParameter("p_other_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Other_doc_no;
            (param[7] = new OracleParameter("p_direction", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Direction;
            (param[8] = new OracleParameter("p_isvisible", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oPopupCollector.Isvisible;
            (param[9] = new OracleParameter("p_create_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Create_user;
            (param[10] = new OracleParameter("p_create_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = oPopupCollector.Create_when;
            (param[11] = new OracleParameter("p_modify_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Modify_by;
            (param[12] = new OracleParameter("p_modify_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = oPopupCollector.Modify_when;
            (param[13] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Remarks;
            (param[14] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Company;
            (param[15] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Location;
            (param[16] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Channel;
            (param[17] = new OracleParameter("p_doc_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oPopupCollector.Doc_status;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatepopupcollecter", CommandType.StoredProcedure, param);
            return effects;
        }

        // Tharaka on 2014-08-09
        public int InsetInto_DicountRqstLog(DiscountReqLog oDiscountReqLog)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_REF_SEQ ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_REQ_REF;
            (param[1] = new OracleParameter("P_REF_ITM ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_ITM;
            (param[2] = new OracleParameter("P_REF_REQ_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_REQ_REF;
            (param[3] = new OracleParameter("P_REF_DISC_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_DISC_RT;
            (param[4] = new OracleParameter("P_REF_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_CRE_BY;
            (param[5] = new OracleParameter("P_REF_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_CRE_DT;
            (param[6] = new OracleParameter("P_REF_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_MOD_BY;
            (param[7] = new OracleParameter("P_REF_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_MOD_DT;
            (param[8] = new OracleParameter("P_REF_STATUS", OracleDbType.Int16, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_STATUS;
            (param[9] = new OracleParameter("P_REF_DISC_VALUE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oDiscountReqLog.REF_DISC_VALUE;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int16, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_LOG_DISCREST_INSERT", CommandType.StoredProcedure, param);
            return effects;
        }
        // Shalika 12/08/2014
        public List<CashSalesRev_History> GetReprintDetails(string _Usrid, string _Com)
        {
            List<CashSalesRev_History> _details = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_UsrId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Usrid;
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "SP_GET_RePrintDetails", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _details = DataTableExtensions.ToGenericList<CashSalesRev_History>(_dtResults, CashSalesRev_History.ConverterReprint);
            return _details;
        }

        //Tharaka on 11-08-2014
        public DataTable GetHPdownPaymentReceipt(string Com, string user, string sart_desc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_se_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[1] = new OracleParameter("p_sart_Desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sart_desc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_load_hp_mnl_dwn_pymnt_recpt", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _tblData.Rows.Count; i++)
            {
                _tblData.Rows[i]["grah_cre_dt"] = Convert.ToDateTime(_tblData.Rows[i]["grah_cre_dt"].ToString()).ToString("dd-MMM-yyyy");

            }
            return _tblData;
        }


        public RequestApprovalHeader GetRequest_Header_ByRef(string _com, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_grah_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_HPRCPTHDR_BY_RQST", CommandType.StoredProcedure, false, param);
            RequestApprovalHeader hdr = null;
            if (_dtResults.Rows.Count > 0)
            {
                hdr = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter)[0];
            }

            return hdr;
        }


        // Tharaka 13/08/2014
        public List<RequestApprovalHeaderLog> GetRequestHeaderLog(string reffNumber, string _Com)
        {
            List<RequestApprovalHeaderLog> _details = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_GRAH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("P_GRAH_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reffNumber;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "SP_GET_REPAPP_LOG_BY_REF", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _details = DataTableExtensions.ToGenericList<RequestApprovalHeaderLog>(_dtResults, RequestApprovalHeaderLog.Converter);
            return _details;
        }

        // Tharaka 13/08/2014
        public List<RequestApprovalSerialsLog> GetRequestSerialLog(string reffNumber)
        {
            List<RequestApprovalSerialsLog> _details = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_GRAS_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reffNumber;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "SP_GETREQPP_SER_LOG_BY_RFF", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _details = DataTableExtensions.ToGenericList<RequestApprovalSerialsLog>(_dtResults, RequestApprovalSerialsLog.Converter);
            return _details;
        }
        public DataTable Load_SaleForRevAccHistory(string _fuc_cd)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fuc_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_REV_ACC_HOLDER_HIS", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }


        //written by Shanuka perera on 13/08/2014

        public Int32 UpdateReprintDets(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;
            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListReversalItems)
            {
                OracleParameter[] param = new OracleParameter[4];

                (param[0] = new OracleParameter("doc_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_id;
                (param[2] = new OracleParameter("p_app_flag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Flag;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_REPRINTAPP", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        public DataTable GetScmDet()
        {
            // SHANUKA PERERA 13/08/2014
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_SCHEMEAPP_DETS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        // SHANUKA PERERA 13/08/2014
        public Int32 UpdateScmCommDets(CashSales_Out_RevItems objOutItems)
        {
            Int32 effects = 0;
            foreach (CashSales_Out_Rev_Items_Details _itemDetails in objOutItems.ListReversalItems)
            {
                OracleParameter[] param = new OracleParameter[4];

                (param[0] = new OracleParameter("Cir_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Invoice_No;
                (param[1] = new OracleParameter("Sch_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Sart_cd;
                (param[2] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.ObjOutRevItems.Usr_id;

                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_UPDATE_SCMAPP", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        public Int32 SaveToDipositBankDet(List<Deposit_Bank_Pc_wise> listBankDetails)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in listBankDetails)
            {
                OracleParameter[] param = new OracleParameter[12];

                (param[0] = new OracleParameter("p_MPB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_MPB_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[2] = new OracleParameter("p_MPB_PAY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Pay_mode_code;
                (param[3] = new OracleParameter("p_MPB_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankCode;
                (param[4] = new OracleParameter("p_MPB_BANK_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankName;
                (param[5] = new OracleParameter("p_MPB_SUN_AC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.SunAccNo;
                (param[6] = new OracleParameter("p_MPB_SUN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankAccNo;
                (param[7] = new OracleParameter("p_MPB_DEF_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Default_val;
                (param[8] = new OracleParameter("p_MPB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Createby;
                (param[9] = new OracleParameter("p_MPB_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.CreateDateTime;
                (param[10] = new OracleParameter("p_MPB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Modifyby;

                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_DIPOSIT_BANK_PC", CommandType.StoredProcedure, param);

            }

            return effects;
        }




        public DataTable GetPayModeDetas()
        {
            // SHANUKA PERERA 15/08/2014
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GETS_PAY_MODE_DET", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetBankDetais(string com)
        {
            // SHANUKA PERERA 15/08/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_BANK_DET", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //Tharaka on 14-08-2014
        public List<RequestApprovalHeader> Get_CustomerCreationRequset(string App_type, string user, string Company)
        {
            List<RequestApprovalHeader> oRequestApprovalHeaders = new List<RequestApprovalHeader>();

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("P_GRAH_APP_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = App_type;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Company;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_CRET_CUS_RQST", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                oRequestApprovalHeaders = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter);

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    oRequestApprovalHeaders[i].Grah_PC_text = _dtResults.Rows[i]["mpc_desc"] == DBNull.Value ? string.Empty : _dtResults.Rows[i]["mpc_desc"].ToString();
                    oRequestApprovalHeaders[i].CustomerName = _dtResults.Rows[i]["mbq_name"] == DBNull.Value ? string.Empty : _dtResults.Rows[i]["mbq_name"].ToString();
                }

            }

            return oRequestApprovalHeaders;
        }

        //Tharaka on 14-08-2014
        public DataTable Get_CustomerRequsetDetails(string ReqNo, string Company)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("P_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqNo;
            (param[1] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Company;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "get_cus_detail_by_rqst", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable LoadBankNewDets()
        {
            // SHANUKA PERERA 15/08/2014
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GETBANKSDETS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        // SHANUKA PERERA 16/08/2014
        public Int32 InsertNewBankDets(Deposit_Bank_Pc_wise _Deposit)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_MPB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.Company;
            (param[1] = new OracleParameter("p_MPB_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.BankCode;
            (param[2] = new OracleParameter("p_MPB_PAY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.BankName;
            (param[3] = new OracleParameter("p_MPB_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.SunAccNo;
            (param[4] = new OracleParameter("p_MPB_BANK_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.BankAccNo;
            (param[5] = new OracleParameter("p_MPB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.Createby;
            (param[6] = new OracleParameter("p_MPB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Deposit.Modifyby;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_NEW_BANK_DETAILS", CommandType.StoredProcedure, param);



            return effects;
        }

        //SHANUKA on 17-08-2014
        public DataTable Get_LoadDipDetais(string profit, DateTime from, DateTime To)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_pro_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profit;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = To;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_RECEPT_SAT_DETS", CommandType.StoredProcedure, false, param);



            return _dtResults;
        }
        //SHANUKA on 17-08-2014
        public Int32 UpdateToDipositBankDet(List<Deposit_Bank_Pc_wise> listBankDetails)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in listBankDetails)
            {
                OracleParameter[] param = new OracleParameter[12];

                (param[0] = new OracleParameter("p_dip_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.SunAccNo;
                (param[1] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mid_no;
                (param[2] = new OracleParameter("p_seq_no", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Seq_no;
                (param[3] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Line_no;
                (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Adj_Type;
                (param[5] = new OracleParameter("p_modBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Modifyby;
                (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[7] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[8] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.Date;
                (param[9] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_chq_no;
                (param[10] = new OracleParameter("p_bankcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankCode;

                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_UPDATE_DIP_BANK_NEW", CommandType.StoredProcedure, param);

            }

            return effects;
        }
        public DataTable Load_Adj_TypesDets()
        {
            // SHANUKA PERERA 21/08/2014
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_LOAD_ADJ_TYPES_DETAILS", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable Load_Sub_Adj_Types(string _AdjType)
        {
            // SHANUKA PERERA 21/08/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_Adj_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AdjType;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_SUBTYPESDET", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable Load_Adj_Acc_Details(string _AdjType, string _subType)
        {
            // SHANUKA PERERA 21/08/2014
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_Adj_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AdjType;
            (param[1] = new OracleParameter("p_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_ACCDETAILS", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        //Darshana on 22-08-2014
        public Decimal Get_OutHPInsValue(string accNo)
        {
            OracleParameter[] param = new OracleParameter[1];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_outIns", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_getouthpins", CommandType.StoredProcedure, _outParam, param));
                return effects;
            }
            catch (Exception ex)
            {
                return 0;
            }
        }

        //shanuka 25/08/2014
        public Int32 InsertTo_sat_Adj(Deposit_Bank_Pc_wise _objadjust)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_STAJ_SEQ", OracleDbType.Double, null, ParameterDirection.Input)).Value = _objadjust.Seq_no;
            (param[1] = new OracleParameter("p_STAJ_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Company;
            (param[2] = new OracleParameter("p_STAJ_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Profit_center;
            (param[3] = new OracleParameter("p_STAJ_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _objadjust.Adj_Date;
            (param[4] = new OracleParameter("p_STAJ_DIRECT", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _objadjust.Adj_direct;
            (param[5] = new OracleParameter("p_STAJ_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Adj_Type;
            (param[6] = new OracleParameter("p_STAJ_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Adj_Sub_Type;
            (param[7] = new OracleParameter("p_STAJ_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objadjust.Adj_amount;
            (param[8] = new OracleParameter("p_STAJ_ACC_DBT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Adj_dbt;
            (param[9] = new OracleParameter("p_STAJ_ACC_CRD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Adj_crd;
            (param[10] = new OracleParameter("p_STAJ_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Remark;
            (param[11] = new OracleParameter("p_STAJ_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Ref_lnk;
            (param[12] = new OracleParameter("p_STAJ_REF_SEQ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objadjust.Ref_seq;
            (param[13] = new OracleParameter("p_STAJ_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.Createby;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_SAT_ADJUSTMENT", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateToReceiptHeader(RecieptHeader _recieptHeader)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_act;
            (param[1] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_direct;
            (param[2] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_mod_by;
            (param[3] = new OracleParameter("p_used_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_used_amt;
            (param[4] = new OracleParameter("p_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_receipt_no;
            (param[5] = new OracleParameter("p_is_dayend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _recieptHeader.Sar_is_dayend;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_SAT_RECEPT_HDR", CommandType.StoredProcedure, param);
            return effects;

        }
        public Int32 UpdateToReturnCheque(ChequeReturn _chequeReturn)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_srcq_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Bank;
            (param[1] = new OracleParameter("p_srcq_chq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Cheque_no;
            (param[2] = new OracleParameter("p_srcq_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Intrest;
            (param[3] = new OracleParameter("p_srcq_is_sett", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _chequeReturn.Is_set;
            (param[4] = new OracleParameter("p_srcq_set_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Settle_val;
            (param[5] = new OracleParameter("p_srcq_cap_set", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Srcq_cap_set;
            (param[6] = new OracleParameter("p_srcq_intr_set", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Srcq_intr_set;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 rows_aff = UpdateRecords("SP_UPDATE_RETURN_CHEQ", CommandType.StoredProcedure, param);

            return rows_aff;
        }

        public int UpdateTo_RemSummaryDetails(RemitanceSummaryDetail _remsumdet)
        {
            int rows_aff = 0;

            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_REM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_com;
            (param[1] = new OracleParameter("p_REM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_pc;
            (param[2] = new OracleParameter("p_REM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_dt;
            (param[3] = new OracleParameter("p_REM_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_sec;
            (param[4] = new OracleParameter("p_REM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cd;

            (param[5] = new OracleParameter("p_REM_LG_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_lg_desc;
            (param[6] = new OracleParameter("p_REM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val;
            (param[7] = new OracleParameter("p_REM_VAL_FINAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val_final;

            (param[8] = new OracleParameter("p_REM_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ref_no;
            (param[9] = new OracleParameter("p_REM_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk;

            (param[10] = new OracleParameter("p_REM_ADD", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_add;
            (param[11] = new OracleParameter("p_REM_DED", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ded;
            (param[12] = new OracleParameter("p_REM_NET", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_net;

            (param[13] = new OracleParameter("p_REM_ADD_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_add_fin;
            (param[14] = new OracleParameter("p_REM_DED_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ded_fin;
            (param[15] = new OracleParameter("p_REM_NET_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_net_fin;
            (param[16] = new OracleParameter("p_REM_RMK_FIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk_fin;

            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            rows_aff = UpdateRecords("SP_UPDATE_REM_SUMMARY_ADJUST", CommandType.StoredProcedure, param);

            return rows_aff;

        }
        public DataTable GetUserAssignComment(string _usrId)
        {
            // Shalika 29/Aug/2014
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_UserID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usrId;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GetUserAssignComment", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Check_Available_Col_Bonus(string _company, string _profitcenter, string _voucher_no, DateTime _month)
        {
            //shanuka on 29/08/2014
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_voucher_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher_no;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblCheck", "SP_CHECK_COL_BONUS", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //SHANUKA on 29-08-2014
        public Int32 Insert_to_Col_bonus(List<Deposit_Bank_Pc_wise> listColl_bonus)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in listColl_bonus)
            {
                OracleParameter[] param = new OracleParameter[11];

                (param[0] = new OracleParameter("p_HPBV_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.Adj_Date;
                (param[1] = new OracleParameter("p_HPBV_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[2] = new OracleParameter("p_HPBV_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[3] = new OracleParameter("p_HPBV_VOU_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Voucher_no;
                (param[4] = new OracleParameter("p_HPBV_GROSS_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Gross_bonus_amt;
                (param[5] = new OracleParameter("p_HPBV_DEDUCT", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Deduction;
                (param[6] = new OracleParameter("p_HPBV_REFUND", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Refund;
                (param[7] = new OracleParameter("p_HPBV_NET_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = _itemDetails.Net_bonus;
                (param[8] = new OracleParameter("p_HPBV_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Createby;
                (param[9] = new OracleParameter("p_HPBV_CLAIM_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Clm_by;

                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_COLL_BONUS", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        public DataTable Load_Recept_details(string _manual_ref_no)
        {
            //shanuka on 01/09/2014
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_manual_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manual_ref_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_LOAD_RECEIPT_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public Int32 UpdateToSat_hdr(decimal _anal8, string inv_no)
        {
            //shanuka on 02/09/2014
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SAH_ANAL_8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _anal8;
            (param[1] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv_no;


            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_NEW_SAT_HDR", CommandType.StoredProcedure, param);
            return effects;

        }

        public DataTable Load_Default_PriceBook(string com, string prof_cen)
        {
            //shanuka on 03/09/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_prof_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_LOAD_DEFAULT_PRICEBOOK", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable Load_Promotion_PriceBook(string com, string prof_cen)
        {
            //shanuka on 03/09/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_prof_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_LOAD_PROMOTION_PRICEBOOK", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        public DataTable Load_PcWise_PriceBook(string com, string prof_cen)
        {
            //shanuka on 03/09/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_prof_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_LOAD_PCWISE_PB", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable Load_PcWise_Price_level(string com, string prof_cen, string _pbook)
        {
            //shanuka on 03/09/2014
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_prof_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_LOAD_PC_WISE_PLEVEL", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        public DataTable Load_Item_dets(string com, string p_lvl, string _pbook)
        {
            //shanuka on 03/09/2014
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_lvl;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_LOAD_ITEM_SEARCH", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable Check_price_bookDetails(string com, string _prof_center, string p_lvl, string _pbook, string stus)
        {
            //shanuka on 03/09/2014
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_profit_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prof_center;
            (param[2] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_lvl;
            (param[3] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            (param[4] = new OracleParameter("p_item_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl", "SP_CHECK_PRICE_BOOK_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public Int32 Update_Default_param(Deposit_Bank_Pc_wise obj_default)
        {
            //shanuka on 02/09/2014
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_SADD_DEF_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_default.Stus;
            (param[1] = new OracleParameter("p_SADD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_default.Profit_center;
            (param[2] = new OracleParameter("p_SADD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_default.Company;
            (param[3] = new OracleParameter("p_sadd_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_default.Price_book;
            (param[4] = new OracleParameter("p_sadd_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_default.Price_lvl;
            (param[5] = new OracleParameter("p_SADD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_default.Modifyby;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_DEFAULT_PARA", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Update_Promo_param(Deposit_Bank_Pc_wise obj_promo)
        {
            //shanuka on 02/09/2014
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_SADD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_promo.Profit_center;
            (param[1] = new OracleParameter("p_SADD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_promo.Company;
            (param[2] = new OracleParameter("p_sadd_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_promo.Promo_p_book;
            (param[3] = new OracleParameter("p_sadd_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_promo.Promo_price_lvl;
            (param[4] = new OracleParameter("p_SADD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_promo.Modifyby;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_PROMOTION_PARAM", CommandType.StoredProcedure, param);
            return effects;

        }
        //SHANUKA 
        public DataTable Get_ava_mids(string bankcode, string _mid, int _pun_tp)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_bankCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bankcode;
            (param[1] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            (param[2] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pun_tp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_CHECK_AVL_MID", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //SHANUKA 
        public DataTable Load_mids(string bankcode, int _pun_tp)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_bankCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bankcode;
            (param[1] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pun_tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_MIDS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Update_to_master_mid(Deposit_Bank_Pc_wise obj_master_mid)
        {
            //shanuka 
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_MSTM_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_master_mid.BankName;
            (param[1] = new OracleParameter("p_MSTM_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_master_mid.Mid_no;
            (param[2] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj_master_mid.Pun_tp;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_MASTER_MID", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Insert_to_master_mid(Deposit_Bank_Pc_wise obj_master_mid)
        {
            //shanuka 
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_MSTM_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_master_mid.BankName;
            (param[1] = new OracleParameter("p_MSTM_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_master_mid.Mid_no;
            (param[2] = new OracleParameter("p_MSTM_SUN_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_master_mid.SunAccNo;
            (param[3] = new OracleParameter("p_MSTM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_master_mid.Create_by;
            (param[4] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj_master_mid.Pun_tp;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_MASTER_MID", CommandType.StoredProcedure, param);
            return effects;

        }
        //darshana on 10-09-2014
        public DataTable GetAllPCWara(string _com, string _pc, string _itm)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_", "sp_get_allpcwara", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        //shalika 10/08/2014
        public DataTable getCusInvoiceDetails(string _CusCode)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CusCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_getCusInvoiceDetails", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shanuka 10/09/2014
        public Int32 SaveToMasterPcWiseMid(List<Deposit_Bank_Pc_wise> lst_master_mid)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in lst_master_mid)
            {
                OracleParameter[] param = new OracleParameter[20];

                (param[0] = new OracleParameter("p_MPM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_MPM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[2] = new OracleParameter("p_MPM_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.From_date;
                (param[3] = new OracleParameter("p_MPM_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.To_date;
                (param[4] = new OracleParameter("p_MPM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Pun_tp;
                (param[5] = new OracleParameter("p_MPM_TERM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Period;
                (param[6] = new OracleParameter("p_MPM_MID_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mid_no;
                (param[7] = new OracleParameter("p_MPM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Create_by;
                (param[8] = new OracleParameter("p_MPM_BNK_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itemDetails.Bankcharge;
                (param[9] = new OracleParameter("p_MPM_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_pb;
                (param[10] = new OracleParameter("p_MPM_PB_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_pblvl;
                (param[11] = new OracleParameter("p_MPM_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_brand;
                (param[12] = new OracleParameter("p_MPM_MAIN_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_maincat;
                (param[13] = new OracleParameter("p_MPM_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_cat;
                (param[14] = new OracleParameter("p_MPM_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_item;
                (param[15] = new OracleParameter("p_MPM_PROMO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_promo;
                (param[16] = new OracleParameter("P_MPM_PRICE_TYPE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.MPM_PRICE_TYPE;
                (param[17] = new OracleParameter("P_MPM_GP_MARGIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itemDetails.MPM_GP_MARGIN;
                (param[18] = new OracleParameter("P_MPM_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.MPM_PTY_TP;
                param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_MST_PC_MID", CommandType.StoredProcedure, param);
                // effects = (Int16)UpdateRecords("SP_INSERT_MST_PC_MID_TEST", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        //shanuka 10/09/2014
        public DataTable getMerchantIdDets(int pun_tp)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pun_tp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_MERCHANTID_DETAILS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shanuka 12/09/2014
        public DataTable getAllMid_Details(string prof_cen)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_profit_cen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SPGET_ALL_MID_DETAILS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        public DataTable SearchAgreementTrackingData(string prof_cen, string Doc_no, string Pod_no, DateTime Fromdate, DateTime Todate, Int32 From, Int32 To, string ischk)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_prof_cen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            (param[1] = new OracleParameter("p_Doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc_no;
            (param[2] = new OracleParameter("p_Pod_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pod_no;
            (param[3] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Fromdate;
            (param[4] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Todate;
            (param[5] = new OracleParameter("p_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = From;
            (param[6] = new OracleParameter("p_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = To;
            (param[7] = new OracleParameter("p_ischk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ischk;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_SEARCHAGREEMENTTRACKINGDATA", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shanuka 16/09/2014
        public Int32 SaveToIssueChqBank(List<Deposit_Bank_Pc_wise> lst_chqBank)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in lst_chqBank)
            {
                OracleParameter[] param = new OracleParameter[13];

                (param[0] = new OracleParameter("p_MDD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Ref_lnk;
                (param[1] = new OracleParameter("p_MDD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Line_no;
                (param[2] = new OracleParameter("p_MDD_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mid_no;
                (param[3] = new OracleParameter("p_MDD_PREFIX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Prifix;
                (param[4] = new OracleParameter("p_MDD_BK_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.SunAccNo;
                (param[5] = new OracleParameter("p_MDD_FIRST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Start_no;
                (param[6] = new OracleParameter("p_MDD_LAST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Ending_no;
                (param[7] = new OracleParameter("p_MDD_CNT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.No_of_pages;

                (param[8] = new OracleParameter("p_MDD_ISSUE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Create_by;
                (param[9] = new OracleParameter("p_MDD_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Stus;
                (param[10] = new OracleParameter("p_MDD_CURRENT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Curnt;
                (param[11] = new OracleParameter("p_MDD_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankCode;

                param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_ISSUE_CHQ_BANK", CommandType.StoredProcedure, param);

            }

            return effects;
        }


        //shanuka 16/09/2014
        public Int32 SaveToDocPages(List<Deposit_Bank_Pc_wise> lst_docpages)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in lst_docpages)
            {
                OracleParameter[] param = new OracleParameter[9];

                (param[0] = new OracleParameter("p_MDP_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_MDP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Pun_tp;
                (param[2] = new OracleParameter("p_MDP_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[3] = new OracleParameter("p_MDP_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Price_book;
                (param[4] = new OracleParameter("p_MDP_PREFIX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Remark;
                (param[5] = new OracleParameter("p_MDP_PAGE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Page_num;
                (param[6] = new OracleParameter("p_MDP_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Promo_p_book;
                (param[7] = new OracleParameter("p_MDP_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Createby;

                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_DOC_PAGES", CommandType.StoredProcedure, param);

            }

            return effects;
        }
        //shalika 17/09/2014
        public Int32 UpdateToAgreementTracker(List<HPAgreementTracker> listAgreementTracker, string usr)
        {
            Int32 effects = 0;
            foreach (HPAgreementTracker _itemDetails in listAgreementTracker)
            {
                OracleParameter[] param = new OracleParameter[10];

                (param[0] = new OracleParameter("p_Acc_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Acc_no;
                (param[1] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.Insert_date;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Insert_user_com;
                (param[3] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Process_type;
                (param[4] = new OracleParameter("p_Oth_Cls", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Oth_close_typ;
                (param[5] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Remark;
                (param[6] = new OracleParameter("p_clsTyp_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.ClsTypeDate;
                (param[7] = new OracleParameter("p_usr", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.Checkdate;
                (param[8] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = usr;
                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_UPDATE_AGREEMENT_TRACKER", CommandType.StoredProcedure, param);

            }

            return effects;
        }
        //shalika 17/09/2014
        public DataTable GetHeadofficeRecdata(string Acc_no)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Acc_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_det", "sp_GetHeadofficeRecdata", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        //shalika 17/09/2014
        public DataTable LoadOtherClosedTypes(string type)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_OTHER_CLS_TYPE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //shanuka 18/09/2014
        public DataTable Load_cheque_printing_details(string vou)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_voucher", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vou;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_CHEQUE_DETS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //shalika 19/09/2014
        public DataTable GetInvoiceItemDetails(string _company, string _profitCenter, string _account)
        {


            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GetInvoiceItemDetails", CommandType.StoredProcedure, false, param);


            return _tblData;
        }

        //Darshana 19-09-2014
        public DataTable GetTotalCRAmtByInv(string _invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_gettotcramt", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //shanuka 20/09/2014
        public DataTable get_Terms(string com, int puntp, string prof)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = puntp;
            (param[2] = new OracleParameter("p_prof", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_TERM", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shanuka 20/09/2014
        public DataTable get_mids_forIn(string com, int puntp, string prof, int term)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_MSTM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = puntp;
            (param[2] = new OracleParameter("p_prof", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof;
            (param[3] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = term;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_MIDS_FOR_IN", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        public Int32 Update_to_mst_pc_mid(string com, string pc, int puntp, int term, string mid, string creatby)
        {
            //shanuka 20/09/2014
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_MPM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_MPM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_MPM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = puntp;
            (param[3] = new OracleParameter("p_MPM_TERM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = term;
            (param[4] = new OracleParameter("p_MPM_MID_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mid;
            (param[5] = new OracleParameter("p_MPM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creatby;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_INACTIVE_MID", CommandType.StoredProcedure, param);
            return effects;

        }

        //shanuka 25/09/2014
        public DataTable get_unused_doc_report(DateTime from, DateTime to, string profitcen)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[1] = new OracleParameter("p_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profitcen;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_UNUSED_DOC_DETAILS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shalika 30/09/2014
        public DataTable get_bank_mid_code(string branch_code, string pc, int mode, int period, DateTime _trdate, string _com)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = branch_code;
            (param[1] = new OracleParameter("p_profit_cen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_mode", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mode;
            (param[3] = new OracleParameter("p_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = period;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _trdate;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_bank_mid", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable check_mid_code_Allowed(string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable tblDet = QueryDataTable("tbl_det", "sp_check_mid_check_alw", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //shalika 01/10/2014
        public DataTable LoadTransactionAccounts()
        {

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TRN_ACCOUNTS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //shalika 02/10/2014
        public DataTable Load_MID_codes_perAcc(string AccNo, string pc)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccNo;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MID_FOR_ACC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //shanuka 04/10/2014
        public Int32 SaveToAllocateItems(List<Deposit_Bank_Pc_wise> lst_all_items)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in lst_all_items)
            {
                OracleParameter[] param = new OracleParameter[8];

                (param[0] = new OracleParameter("p_SAM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_SAM_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[2] = new OracleParameter("p_SAM_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankCode;
                (param[3] = new OracleParameter("p_SAM_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mid_no;
                (param[4] = new OracleParameter("p_SAM_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Pun_tp;
                (param[5] = new OracleParameter("p_SAM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Create_by;
                (param[6] = new OracleParameter("p_SAM_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Modifyby;

                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_ALLOCATEITEMS", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        //shanuka 04/10/2014
        public DataTable getAllAllocateItems_details(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_ALL_ALLOCATEITEMS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shalika 11/10/2014
        public DataTable GetReturnType(string Acc_no)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Acc_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_det", "sp_GetReturnType", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        public InvoiceHeader GetInvoiceHeaderDetails_AGR(string _invoiceNo)
        {
            InvoiceHeader _invoiceHeader = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "sp_get_all_invoice_details", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_invoiceDT, InvoiceHeader.ConvertTotalAGR)[0];
            }
            return _invoiceHeader;
        }


        //darshana 27-10-2014 - Group level customer creation - Top of the company level parameters. 
        public Int32 SaveBusinessEntityDetailGroup(GroupBussinessEntity _businessEntity)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[34];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_mbg_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_cd;
            (param[1] = new OracleParameter("p_mbg_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_name;
            (param[2] = new OracleParameter("p_mbg_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_tit;
            (param[3] = new OracleParameter("p_mbg_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_ini;
            (param[4] = new OracleParameter("p_mbg_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_fname;
            (param[5] = new OracleParameter("p_mbg_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_sname;
            (param[6] = new OracleParameter("p_mbg_nationality", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_nationality;
            (param[7] = new OracleParameter("p_mbg_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_add1;
            (param[8] = new OracleParameter("p_mbg_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_add2;
            (param[9] = new OracleParameter("p_mbg_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_town_cd;
            (param[10] = new OracleParameter("p_mbg_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_distric_cd;
            (param[11] = new OracleParameter("p_mbg_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_province_cd;
            (param[12] = new OracleParameter("p_mbg_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_country_cd;
            (param[13] = new OracleParameter("p_mbg_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_tel;
            (param[14] = new OracleParameter("p_mbg_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_fax;
            (param[15] = new OracleParameter("p_mbg_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_postal_cd;
            (param[16] = new OracleParameter("p_mbg_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_mob;
            (param[17] = new OracleParameter("p_mbg_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_nic;
            (param[18] = new OracleParameter("p_mbg_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_pp_no;
            (param[19] = new OracleParameter("p_mbg_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_dl_no;
            (param[20] = new OracleParameter("p_mbg_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_br_no;
            (param[21] = new OracleParameter("p_mbg_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_email;
            (param[22] = new OracleParameter("p_mbg_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_contact;
            (param[23] = new OracleParameter("p_mbg_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_act;
            (param[24] = new OracleParameter("p_mbg_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_is_suspend;
            (param[25] = new OracleParameter("p_mbg_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_sex;
            (param[26] = new OracleParameter("p_mbg_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_dob;
            (param[27] = new OracleParameter("p_mbg_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_cre_by;
            (param[28] = new OracleParameter("p_mbg_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_mod_by;


            (param[29] = new OracleParameter("p_Mbg_pp_isu_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_pp_isu_dte;
            (param[30] = new OracleParameter("p_Mbg_pp_exp_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_pp_exp_dte;
            (param[31] = new OracleParameter("p_Mbg_dl_isu_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_dl_isu_dte;
            (param[32] = new OracleParameter("p_Mbg_dl_exp_dte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_dl_exp_dte;


            param[33] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_busentity_grup", CommandType.StoredProcedure, param);
            return effects;
        }
        //darshana 27-10-2014
        public GroupBussinessEntity GetCustomerProfileByGrup(string CustCD, string nic, string DL, string PPNo, string brNo, string mobNo)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;
            (param[5] = new OracleParameter("P_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobNo;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getcustomergrup", CommandType.StoredProcedure, false, param);

            GroupBussinessEntity bizEnt = new GroupBussinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<GroupBussinessEntity>(_dtResults, GroupBussinessEntity.Converter)[0];
            }
            return bizEnt;
        }
        //shanuka 23/10/2014
        public DataTable GetAll_Collection_Bonus(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_COLLECTIONBNS", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public Int32 UpdateToCollectionBonus(Deposit_Bank_Pc_wise objColBonus)
        {

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objColBonus.Com;
            (param[1] = new OracleParameter("p_HPBV_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objColBonus.Prof_center;
            (param[2] = new OracleParameter("p_HPBV_VOU_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objColBonus.Voucher_no;
            (param[3] = new OracleParameter("p_HPBV_GROSS_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = objColBonus.Gross_bonus_amt;
            (param[4] = new OracleParameter("p_HPBV_DEDUCT", OracleDbType.Double, null, ParameterDirection.Input)).Value = objColBonus.Deduction;
            (param[5] = new OracleParameter("p_HPBV_REFUND", OracleDbType.Double, null, ParameterDirection.Input)).Value = objColBonus.Refund;

            (param[6] = new OracleParameter("p_HPBV_NET_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = objColBonus.Net_bonus;
            (param[7] = new OracleParameter("p_HPBV_CLAIM_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objColBonus.Pun_tp;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 rows_aff = UpdateRecords("SP_EDIT_COLLECTIONBONUS", CommandType.StoredProcedure, param);

            return rows_aff;
        }
        public DataTable GetNotRealizeTransactionDet(string com, string _acc, DateTime _Date, DateTime _from, DateTime _to, string _user, Int32 _isAsAt)
        {
            //shalika on 24/10/2014        
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Date;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_asat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAsAt;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_sun_upload.sp_GetNotRealizeTransactionDet", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable Realization_Finaliz_sts(string acc, DateTime _fromDate, DateTime _toDate, string _com)
        {
            //shalika on 24/10/2014        
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            (param[1] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_Realization_Finaliz_sts_Det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //shalika 01/10/2014
        public DataTable LoadUsers()
        {

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_USERS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Bank_Reconciliation_Rpt(DateTime _Asatdate, string Acc)
        {
            //shalika on 24/10/2014        
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_as_at_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Asatdate;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Acc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_SUN_UPLOAD.SP_RPT_BANK_RECONCILTION", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //shanuka 29/10/2014
        public DataTable Get_Bank_Deposit_Slip(string pro, DateTime from, DateTime to)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pro_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pro;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_BNK_SLIPS", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        //shanuka 29/10/2014
        public DataTable Get_Receive_Cheque_details(string pro, DateTime from, DateTime to)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pro_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pro;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_RECEIVE_CHEQUE", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        //shanuka 29/10/2014
        public string Get_midno(string pro, string sun)
        {
            string _mid = "";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pro_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pro;
            (param[1] = new OracleParameter("p_sun", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sun;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_MIDNO", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0 && tblDet != null)
            {
                _mid = tblDet.Rows[0][1].ToString();
            }

            return _mid;
        }
        //SHANUKA on 30-10-2014
        public Int32 UpdateToBankSlipDetails(List<Deposit_Bank_Pc_wise> listBankSlips)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in listBankSlips)
            {
                OracleParameter[] param = new OracleParameter[14];

                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[2] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.Date;
                (param[3] = new OracleParameter("p_remsec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_sec;
                (param[4] = new OracleParameter("p_remcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_cd;
                (param[5] = new OracleParameter("p_rmweek", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_wk;
                (param[6] = new OracleParameter("p_rmrmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_rmk;
                (param[7] = new OracleParameter("p_dip_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.SunAccNo;
                (param[8] = new OracleParameter("p_chqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_chq_no;
                (param[9] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Rem_description;
                (param[10] = new OracleParameter("p_modBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Modifyby;
                (param[11] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Line_no;
                (param[12] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_itemDetails.Seq_no);

                param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_UPDATE_BNK_SLIPS", CommandType.StoredProcedure, param);

            }

            return effects;
        }
        public DataTable GetRegistraionDetails(DateTime _from_date, DateTime _to_date, string _rpt_mode, string _usr, string _com, string pc, string _excel, string _firstloc)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from_date;
            (param[1] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to_date;
            (param[2] = new OracleParameter("p_rpt_mode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rpt_mode;
            (param[3] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[7] = new OracleParameter("p_excel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excel;
            (param[8] = new OracleParameter("p_firstloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstloc;

            DataTable _dtResults = QueryDataTable("tbl", "SP_RPT_REGISTRATION", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //shalika 30/10/2014
        public DataTable LoadBankAccounts()
        {

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_BNK_ACCOUNTS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public HPAccountLog GetHpAccLogByTP(string _acc, string _tp)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[1] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbData", "sp_getacclogbytp", CommandType.StoredProcedure, false, param);

            HPAccountLog bizEnt = new HPAccountLog();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<HPAccountLog>(_dtResults, HPAccountLog.Converter)[0];
            }
            return bizEnt;
        }
        //darshana 27-10-2014 - Group level customer creation - Top of the company level parameters. 
        public Int32 UpdateEntityDetailGroupWithPermission(GroupBussinessEntity _businessEntity)
        {
            //sp_save_busentity
            OracleParameter[] param = new OracleParameter[30];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_mbg_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_cd;
            (param[1] = new OracleParameter("p_mbg_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_name;
            (param[2] = new OracleParameter("p_mbg_tit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_tit;
            (param[3] = new OracleParameter("p_mbg_ini", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_ini;
            (param[4] = new OracleParameter("p_mbg_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_fname;
            (param[5] = new OracleParameter("p_mbg_sname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_sname;
            (param[6] = new OracleParameter("p_mbg_nationality", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_nationality;
            (param[7] = new OracleParameter("p_mbg_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_add1;
            (param[8] = new OracleParameter("p_mbg_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_add2;
            (param[9] = new OracleParameter("p_mbg_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_town_cd;
            (param[10] = new OracleParameter("p_mbg_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_distric_cd;
            (param[11] = new OracleParameter("p_mbg_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_province_cd;
            (param[12] = new OracleParameter("p_mbg_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_country_cd;
            (param[13] = new OracleParameter("p_mbg_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_tel;
            (param[14] = new OracleParameter("p_mbg_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_fax;
            (param[15] = new OracleParameter("p_mbg_postal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_postal_cd;
            (param[16] = new OracleParameter("p_mbg_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_mob;
            (param[17] = new OracleParameter("p_mbg_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_nic;
            (param[18] = new OracleParameter("p_mbg_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_pp_no;
            (param[19] = new OracleParameter("p_mbg_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_dl_no;
            (param[20] = new OracleParameter("p_mbg_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_br_no;
            (param[21] = new OracleParameter("p_mbg_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_email;
            (param[22] = new OracleParameter("p_mbg_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_contact;
            (param[23] = new OracleParameter("p_mbg_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_act;
            (param[24] = new OracleParameter("p_mbg_is_suspend", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_is_suspend;
            (param[25] = new OracleParameter("p_mbg_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_sex;
            (param[26] = new OracleParameter("p_mbg_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_dob;
            (param[27] = new OracleParameter("p_mbg_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_cre_by;
            (param[28] = new OracleParameter("p_mbg_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessEntity.Mbg_mod_by;
            param[29] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_busentity_grup", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By darshana on 29/12/2014
        public List<LogMasterItemTax> GetItemTaxLog(string _company, string _item, string _status, string _taxCode, string _taxRateCode, DateTime _effDate)
        {
            List<LogMasterItemTax> _list = new List<LogMasterItemTax>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_taxcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxCode;
            (param[4] = new OracleParameter("p_taxratecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxRateCode;
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _effDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitemtaxlog", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LogMasterItemTax>(_tblData, LogMasterItemTax.ConvertTotal);
            }

            return _list;


        }

        //Written By darshana on 31/12/2014
        public List<MasterItemTax> GetItemTaxEffDt(string _company, string _item, string _status, string _taxCode, string _taxRateCode, DateTime _effDate)
        {
            List<MasterItemTax> _list = new List<MasterItemTax>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_taxcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxCode;
            (param[4] = new OracleParameter("p_taxratecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxRateCode;
            (param[5] = new OracleParameter("p_effDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _effDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitemtaxEffDt", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemTax>(_tblData, MasterItemTax.ConvertTotal);
            }

            return _list;

        }
        //written by darshana 12-01-2015
        public MasterVehicalInsuranceDefinitionNew GetAddInsAmt(string _com, string _ptyTp, string _ptyCd, string _insCom, string _insPol, string _salesTp, DateTime _date, decimal _ItmVal, string _insTp, string _itm, string _cat1, string _cat2, string _brand, string _pb, string _lvl)
        {
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ptyTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyTp;
            (param[2] = new OracleParameter("p_ptyCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyCd;
            (param[3] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insCom;
            (param[4] = new OracleParameter("p_ins_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPol;
            (param[5] = new OracleParameter("p_salesTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesTp;
            (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[7] = new OracleParameter("p_itmVal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ItmVal;
            (param[8] = new OracleParameter("p_insTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insTp;
            (param[9] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[10] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[11] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[12] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[13] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[14] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_addinsu_amt", CommandType.StoredProcedure, false, param);

            MasterVehicalInsuranceDefinitionNew _VehInsDef = new MasterVehicalInsuranceDefinitionNew();
            if (_dtResults.Rows.Count > 0)
            {
                _VehInsDef = DataTableExtensions.ToGenericList<MasterVehicalInsuranceDefinitionNew>(_dtResults, MasterVehicalInsuranceDefinitionNew.Converter)[0];
            }
            return _VehInsDef;
        }
        //Written by darshana 17-01-2015
        public Decimal Get_HpIntAmt(Int32 _term, decimal _rent, decimal _amtF, Int32 _pv, Int32 _payEnd)
        {

            OracleParameter[] param = new OracleParameter[5];
            Decimal effects = 0;
            (param[0] = new OracleParameter("nper", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _term;
            (param[1] = new OracleParameter("pmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _rent;
            (param[2] = new OracleParameter("pv", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtF;
            (param[3] = new OracleParameter("fv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pv;
            (param[4] = new OracleParameter("PaymentEnd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _payEnd;
            OracleParameter _outParam = new OracleParameter("M_rate", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_getred_bal_rate", CommandType.StoredProcedure, _outParam, param));
            return effects;

        }
        //Written by darshana 26-01-2015
        public DataTable GetDeduceBal(DateTime _fDate, DateTime _tDate, string _com, string _pc, Int32 _isSum, string _acc)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("issum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSum;
            (param[5] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_calc_reduce_balance_Account", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Written by darshana 27-01-2015
        public DataTable GetDeduceBalEcd(DateTime _tDate, string _acc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate;
            (param[1] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_calc_reduce_balance_ecd", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Written by darshana 20-02-2015
        public Int32 UpdateAddWarr(string _itm, string _ser, Int32 _warrPD, string _warrRmk, DateTime _warrStDt, string _rec)
        {
            //shanuka 20/09/2014
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[1] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[2] = new OracleParameter("p_warrPd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warrPD;
            (param[3] = new OracleParameter("p_warrRmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrRmk;
            (param[4] = new OracleParameter("p_warrStdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warrStDt;
            (param[5] = new OracleParameter("p_recNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updsmartwarr", CommandType.StoredProcedure, param);
            return effects;

        }
        //Written By darshana on 25/02/2015
        public MasterItemWarrantyPeriod GetItemWarrEffDt(string _item, string _status, Int32 _act, DateTime _effDate)
        {
            MasterItemWarrantyPeriod _list = new MasterItemWarrantyPeriod();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_itmStus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _act;
            (param[3] = new OracleParameter("p_effDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _effDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitmwarreffdt", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemWarrantyPeriod>(_tblData, MasterItemWarrantyPeriod.Converter)[0];
            }

            return _list;

        }
        //Written By darshana on 25/02/2015
        public LogMasterItemWarranty GetItemWarrEffDtLog(string _item, string _status, Int32 _act, DateTime _effDate)
        {
            LogMasterItemWarranty _list = new LogMasterItemWarranty();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_itmStus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _act;
            (param[3] = new OracleParameter("p_effDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _effDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitemwarrlog", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<LogMasterItemWarranty>(_tblData, LogMasterItemWarranty.Converter)[0];
            }

            return _list;

        }


        // Nadeeka 15-06-2015
        public Int32 UpdateRequestCloseStatusSer(string _com, string _pc, string _type, string _refNo, string _stus, string _user)
        {
            //sp_updateaccountlog(p_account in NVARCHAR2,p_pc in NVARCHAR2,p_com in NVARCHAR2,p_date in date,p_status in NVARCHAR2,p_updatetype in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_req_close_status_ser", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetSalesPromoterDetails(DateTime _fDate, DateTime _tDate, string _Com, string _Pc)
        {
            // Wimal 22/06/205
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tDate.Date;
            //(param[3] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            //(param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("in_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_sales_promoter_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        // Nadeeka
        public Int32 GetSysPara(string _locType, string _locValue, String _paraType)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locValue;
            (param[1] = new OracleParameter("in_loctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locType;
            (param[2] = new OracleParameter("in_paratype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paraType;
            Int32 _Value = (Int32)QueryFunction("fn_getSysPara", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _Value;

        }


        public DataTable CheckRequestType(string com, string pc, string doc_tp)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_CHECKREQUESTTYPE", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable getPOAllocation(string _po)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_PO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _po;
            DataTable dt = QueryDataTable("tbldata", "sp_get_po_alloc", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable CheckExecutive(string emp_id)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("EMP_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp_id;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_CHECKEXECUTIVE", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Select_EMP_ID(string usr_name)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("USR_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = usr_name;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_EMP_ID", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public Int32 SaveINT_REQ(INT_REQ int_req)
        {
            OracleParameter[] param = new OracleParameter[46];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_SEQ_NO;
            (param[1] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COM;
            (param[2] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_REQ_NO;
            (param[3] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_TP;
            (param[4] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_SUB_TP;
            (param[5] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_LOC;
            (param[6] = new OracleParameter("REFT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_REF;
            (param[7] = new OracleParameter("DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_DT;
            (param[8] = new OracleParameter("EXP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_EXP_DT;
            (param[9] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_STUS;
            (param[10] = new OracleParameter("JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_JOB_NO;
            (param[11] = new OracleParameter("BUS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_BUS_CODE;
            (param[12] = new OracleParameter("NOTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_NOTE;
            (param[13] = new OracleParameter("ISSUE_FROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ISSUE_FROM;
            (param[14] = new OracleParameter("REC_TO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_REC_TO;
            (param[15] = new OracleParameter("DIRECT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_DIRECT;
            (param[16] = new OracleParameter("COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COUNTRY_CD;
            (param[17] = new OracleParameter("TOWN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_TOWN_CD;
            (param[18] = new OracleParameter("CUR_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_CUR_CODE;
            (param[19] = new OracleParameter("EXG_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req.ITR_EXG_RATE;
            (param[20] = new OracleParameter("COLLECTOR_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COLLECTOR_ID;
            (param[21] = new OracleParameter("COLLECTOR_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COLLECTOR_NAME;
            (param[22] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_ACT;
            (param[23] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_CRE_BY;
            (param[24] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_CRE_DT;
            (param[25] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_MOD_BY;
            (param[26] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_MOD_DT;
            (param[27] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_SESSION_ID;
            (param[28] = new OracleParameter("ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ANAL1;
            (param[29] = new OracleParameter("ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ANAL2;
            (param[30] = new OracleParameter("ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ANAL3;
            (param[31] = new OracleParameter("ISSUE_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ISSUE_COM;
            (param[32] = new OracleParameter("GRAN_OPT1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT1;
            (param[33] = new OracleParameter("GRAN_OPT2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT2;
            (param[34] = new OracleParameter("GRAN_OPT3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT3;
            (param[35] = new OracleParameter("GRAN_OPT4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT4;
            (param[36] = new OracleParameter("GRAN_NSTUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_NSTUS;
            (param[37] = new OracleParameter("GRAN_APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_APP_BY;
            (param[38] = new OracleParameter("GRAN_NARRT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_NARRT;
            (param[39] = new OracleParameter("GRAN_APP_NOTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_APP_NOTE;
            (param[40] = new OracleParameter("GRAN_APP_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_APP_STUS;
            (param[41] = new OracleParameter("JOB_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_JOB_LINE;
            (param[42] = new OracleParameter("APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_APP_BY;
            (param[43] = new OracleParameter("APP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_APP_DT;
            param[44] = new OracleParameter("O_AUTO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[45] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("PKG_SALES.SP_SAVE_INT_REQ", CommandType.StoredProcedure, param);
            if (result != 1)
                return -1;

            return int.Parse(param[44].Value.ToString());

        }
        public Int32 SaveINT_REQ_ITM(INT_REQ_ITM int_req_itm)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_SEQ_NO;
            (param[1] = new OracleParameter("LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_LINE_NO;
            (param[2] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_ITM_CD;
            (param[3] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_ITM_STUS;
            (param[4] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_QTY;
            (param[5] = new OracleParameter("UNIT_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_UNIT_PRICE;
            (param[6] = new OracleParameter("APP_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_APP_QTY;
            (param[7] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_RES_NO;
            (param[8] = new OracleParameter("NOTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_NOTE;
            (param[9] = new OracleParameter("MITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_MITM_CD;
            (param[10] = new OracleParameter("MITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_MITM_STUS;
            (param[11] = new OracleParameter("MQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_MQTY;
            (param[12] = new OracleParameter("BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_BQTY;
            (param[13] = new OracleParameter("ITM_COND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_ITM_COND;
            (param[14] = new OracleParameter("JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_JOB_NO;
            (param[15] = new OracleParameter("JOB_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_JOB_LINE;
            (param[16] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_COM;
            (param[17] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_LOC;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_SAVE_INT_REQ_ITM", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveINT_REQ_SER(INT_REQ_SER int_req_ser)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SEQ_NO;
            (param[1] = new OracleParameter("LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_LINE_NO;
            (param[2] = new OracleParameter("SER_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SER_LINE;
            (param[3] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_ITM_CD;
            (param[4] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_ITM_STUS;
            (param[5] = new OracleParameter("SER_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SER_1;
            (param[6] = new OracleParameter("SER_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SER_2;
            (param[7] = new OracleParameter("SER_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SER_3;
            (param[8] = new OracleParameter("SER_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SER_4;
            (param[9] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_QTY;
            (param[10] = new OracleParameter("IN_SEQNO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_IN_SEQNO;
            (param[11] = new OracleParameter("IN_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_IN_DOCNO;
            (param[12] = new OracleParameter("IN_ITMLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_IN_ITMLINE;
            (param[13] = new OracleParameter("IN_BATCHLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_IN_BATCHLINE;
            (param[14] = new OracleParameter("IN_SERLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_IN_SERLINE;
            (param[15] = new OracleParameter("IN_DOCDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_IN_DOCDT;
            (param[16] = new OracleParameter("TRNS_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_TRNS_TP;
            (param[17] = new OracleParameter("RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_RMK;
            (param[18] = new OracleParameter("SER_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_SER_ID;
            (param[19] = new OracleParameter("NITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_ser.ITRS_NITM_STUS;
            param[20] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_SAVE_INT_REQ_SER", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdateStatus_INT_REQ(string req_no, string stus)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            (param[1] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
            param[2] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_UPDATESTATUS_INT_REQ", CommandType.StoredProcedure, param);
            return effects;
        }
        public INT_REQ GetRequest(string req_no)
        {
            INT_REQ int_req = new INT_REQ();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INT_REQ", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_req = DataTableExtensions.ToGenericList<INT_REQ>(tblData, INT_REQ.Converter)[0];
            }
            return int_req;
        }
        public List<INT_REQ_ITM> GetRequestItem(Int32 seq_no)
        {
            List<INT_REQ_ITM> int_req_itm = new List<INT_REQ_ITM>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INT_REQ_ITM", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_req_itm = DataTableExtensions.ToGenericList<INT_REQ_ITM>(tblData, INT_REQ_ITM.Converter);
            }
            return int_req_itm;
        }
        public DataTable Check_INT_REQ(string req_no, string tp, string excecutive)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            (param[1] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tp;
            (param[2] = new OracleParameter("EXCECUTIVE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = excecutive;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_CHECK_INT_REQ", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Check_INT_REQ_RER(string req_no, string tp)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            (param[1] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tp;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_CHECK_INT_REQ_RER", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public Int32 UpdateINT_REQ(INT_REQ int_req)
        {
            OracleParameter[] param = new OracleParameter[45];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_SEQ_NO;
            (param[1] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COM;
            (param[2] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_REQ_NO;
            (param[3] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_TP;
            (param[4] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_SUB_TP;
            (param[5] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_LOC;
            (param[6] = new OracleParameter("REFT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_REF;
            (param[7] = new OracleParameter("DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_DT;
            (param[8] = new OracleParameter("EXP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_EXP_DT;
            (param[9] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_STUS;
            (param[10] = new OracleParameter("JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_JOB_NO;
            (param[11] = new OracleParameter("BUS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_BUS_CODE;
            (param[12] = new OracleParameter("NOTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_NOTE;
            (param[13] = new OracleParameter("ISSUE_FROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ISSUE_FROM;
            (param[14] = new OracleParameter("REC_TO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_REC_TO;
            (param[15] = new OracleParameter("DIRECT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_DIRECT;
            (param[16] = new OracleParameter("COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COUNTRY_CD;
            (param[17] = new OracleParameter("TOWN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_TOWN_CD;
            (param[18] = new OracleParameter("CUR_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_CUR_CODE;
            (param[19] = new OracleParameter("EXG_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req.ITR_EXG_RATE;
            (param[20] = new OracleParameter("COLLECTOR_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COLLECTOR_ID;
            (param[21] = new OracleParameter("COLLECTOR_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_COLLECTOR_NAME;
            (param[22] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_ACT;
            (param[23] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_CRE_BY;
            (param[24] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_CRE_DT;
            (param[25] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_MOD_BY;
            (param[26] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_MOD_DT;
            (param[27] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_SESSION_ID;
            (param[28] = new OracleParameter("ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ANAL1;
            (param[29] = new OracleParameter("ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ANAL2;
            (param[30] = new OracleParameter("ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ANAL3;
            (param[31] = new OracleParameter("ISSUE_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_ISSUE_COM;
            (param[32] = new OracleParameter("GRAN_OPT1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT1;
            (param[33] = new OracleParameter("GRAN_OPT2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT2;
            (param[34] = new OracleParameter("GRAN_OPT3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT3;
            (param[35] = new OracleParameter("GRAN_OPT4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_OPT4;
            (param[36] = new OracleParameter("GRAN_NSTUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_NSTUS;
            (param[37] = new OracleParameter("GRAN_APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_APP_BY;
            (param[38] = new OracleParameter("GRAN_NARRT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_NARRT;
            (param[39] = new OracleParameter("GRAN_APP_NOTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_APP_NOTE;
            (param[40] = new OracleParameter("GRAN_APP_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_GRAN_APP_STUS;
            (param[41] = new OracleParameter("JOB_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req.ITR_JOB_LINE;
            (param[42] = new OracleParameter("APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req.ITR_APP_BY;
            (param[43] = new OracleParameter("APP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = int_req.ITR_APP_DT;
            param[44] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("PKG_SALES.SP_UPDATE_INT_REQ", CommandType.StoredProcedure, param);
            return result;

        }
        public Int32 UpdateINT_REQ_ITM(INT_REQ_ITM int_req_itm)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_SEQ_NO;
            (param[1] = new OracleParameter("LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_LINE_NO;
            (param[2] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_ITM_CD;
            (param[3] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_ITM_STUS;
            (param[4] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_QTY;
            (param[5] = new OracleParameter("UNIT_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_UNIT_PRICE;
            (param[6] = new OracleParameter("APP_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_APP_QTY;
            (param[7] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_RES_NO;
            (param[8] = new OracleParameter("NOTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_NOTE;
            (param[9] = new OracleParameter("MITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_MITM_CD;
            (param[10] = new OracleParameter("MITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_MITM_STUS;
            (param[11] = new OracleParameter("MQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_MQTY;
            (param[12] = new OracleParameter("BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_BQTY;
            (param[13] = new OracleParameter("ITM_COND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_ITM_COND;
            (param[14] = new OracleParameter("JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_JOB_NO;
            (param[15] = new OracleParameter("JOB_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_JOB_LINE;
            (param[16] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_COM;
            (param[17] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = int_req_itm.ITRI_LOC;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_UPDATE_INT_REQ_ITM", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka 2015-08-04
        public DataTable GETCUST_BY_ACC(string _company, string _profitcenter, string _Acc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("P_ACCOUNT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Acc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GETCUST_BY_ACC", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Sahan
        public DataTable SearchSalesRequest(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string p_itr_req_no = null;
            string p_itr_bus_code = null;
            string p_itr_seq_no = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        p_itr_req_no = _searchText;
                        break;

                    case "CUSTOMER":
                        p_itr_bus_code = _searchText;
                        break;
                    case "SEQ NO":
                        p_itr_seq_no = _searchText;
                        break;
                    default:
                        break;
                }
            }
            p_itr_req_no = (p_itr_req_no != null) ? (p_itr_req_no.ToUpper() + "%") : null;
            p_itr_bus_code = (p_itr_bus_code != null) ? (p_itr_bus_code.ToUpper() + "%") : null;
            p_itr_seq_no = (p_itr_seq_no != null) ? (p_itr_seq_no.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_req_no;
            (param[3] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_bus_code;
            (param[4] = new OracleParameter("p_itr_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_seq_no;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("INT_REQ", "pkg_sales.SearchSalesReq", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 12/Aug/2015
        public DataTable SearchCustomer(string p_mbe_com, string p_mbe_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbe_com;
            (param[1] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbe_cd;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("mst_busentity", "pkg_sales.SearchCustomer", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable SearchCustomer2(string p_mbe_com, string p_mbe_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbe_com;
            (param[1] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbe_cd;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("mst_busentity", "searchcustomeralldata", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //Sahan 12/Aug/2015

        public Tuple<int, int> PlaceSalesOrder(SalesOrderHeader SalesOrder)
        {
            int rows_affected = 0;
            int opderno = 0;
            string value = string.Empty;

            OracleParameter[] param = new OracleParameter[74];
            try
            {
                (param[0] = new OracleParameter("p_soh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_COM;
                (param[1] = new OracleParameter("p_soh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_PC;
                (param[2] = new OracleParameter("p_soh_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_TP;
                (param[3] = new OracleParameter("p_soh_so_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SO_TP;
                (param[4] = new OracleParameter("p_soh_so_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SO_SUB_TP;
                (param[5] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SO_NO;
                (param[6] = new OracleParameter("p_soh_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = SalesOrder.SOH_DT;
                (param[7] = new OracleParameter("p_soh_manual", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_MANUAL;
                (param[8] = new OracleParameter("p_soh_man_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_MAN_REF;
                (param[9] = new OracleParameter("p_soh_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_REF_DOC;
                (param[10] = new OracleParameter("p_soh_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CUS_CD;
                (param[11] = new OracleParameter("p_soh_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CUS_NAME;
                (param[12] = new OracleParameter("p_soh_cus_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CUS_ADD1;
                (param[13] = new OracleParameter("p_soh_cus_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CUS_ADD2;
                (param[14] = new OracleParameter("p_soh_currency", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CURRENCY;
                (param[15] = new OracleParameter("p_soh_ex_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrder.SOH_EX_RT;
                (param[16] = new OracleParameter("p_soh_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_TOWN_CD;
                (param[17] = new OracleParameter("p_soh_d_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_D_CUST_CD;
                (param[18] = new OracleParameter("p_soh_d_cust_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_D_CUST_ADD1;
                (param[19] = new OracleParameter("p_soh_d_cust_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_D_CUST_ADD2;
                (param[20] = new OracleParameter("p_soh_man_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_MAN_CD;
                (param[21] = new OracleParameter("p_soh_sales_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_EX_CD;
                (param[22] = new OracleParameter("p_soh_sales_str_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_STR_CD;
                (param[23] = new OracleParameter("p_soh_sales_sbu_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_SBU_CD;
                (param[24] = new OracleParameter("p_soh_sales_sbu_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_SBU_MAN;
                (param[25] = new OracleParameter("p_soh_sales_chn_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_CHN_CD;
                (param[26] = new OracleParameter("p_soh_sales_chn_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_CHN_MAN;
                (param[27] = new OracleParameter("p_soh_sales_region_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_REGION_CD;
                (param[28] = new OracleParameter("p_soh_sales_region_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_REGION_MAN;
                (param[29] = new OracleParameter("p_soh_sales_zone_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_ZONE_CD;
                (param[30] = new OracleParameter("p_soh_sales_zone_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SALES_ZONE_MAN;
                (param[31] = new OracleParameter("p_soh_structure_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_STRUCTURE_SEQ;
                (param[32] = new OracleParameter("p_soh_esd_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ESD_RT;
                (param[33] = new OracleParameter("p_soh_wht_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrder.SOH_WHT_RT;
                (param[34] = new OracleParameter("p_soh_epf_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrder.SOH_EPF_RT;
                (param[35] = new OracleParameter("p_soh_pdi_req", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_PDI_REQ;
                (param[36] = new OracleParameter("p_soh_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_REMARKS;
                (param[37] = new OracleParameter("p_soh_is_acc_upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_IS_ACC_UPLOAD;
                (param[38] = new OracleParameter("p_soh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_STUS;
                (param[39] = new OracleParameter("p_soh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CRE_BY;
                (param[40] = new OracleParameter("p_soh_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = SalesOrder.SOH_CRE_WHEN;
                (param[41] = new OracleParameter("p_soh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_MOD_BY;
                (param[42] = new OracleParameter("p_soh_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = SalesOrder.SOH_MOD_WHEN;
                (param[43] = new OracleParameter("p_soh_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SESSION_ID;
                (param[44] = new OracleParameter("p_soh_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_1;
                (param[45] = new OracleParameter("p_soh_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_2;
                (param[46] = new OracleParameter("p_soh_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_3;
                (param[47] = new OracleParameter("p_soh_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_4;
                (param[48] = new OracleParameter("p_soh_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_5;
                (param[49] = new OracleParameter("p_soh_anal_6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_6;
                (param[50] = new OracleParameter("p_soh_anal_7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_7;
                (param[51] = new OracleParameter("p_soh_anal_8", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_8;
                (param[52] = new OracleParameter("p_soh_anal_9", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_9;
                (param[53] = new OracleParameter("p_soh_anal_10", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_10;
                (param[54] = new OracleParameter("p_soh_anal_11", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_11;
                (param[55] = new OracleParameter("p_soh_anal_12", OracleDbType.Date, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ANAL_12;
                (param[56] = new OracleParameter("p_soh_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_DIRECT;
                (param[57] = new OracleParameter("p_soh_tax_inv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_TAX_INV;
                (param[58] = new OracleParameter("p_soh_grup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_GRUP_CD;
                (param[59] = new OracleParameter("p_soh_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_ACC_NO;
                (param[60] = new OracleParameter("p_soh_tax_exempted", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_TAX_EXEMPTED;
                (param[61] = new OracleParameter("p_soh_is_svat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_IS_SVAT;
                (param[62] = new OracleParameter("p_soh_fin_chrg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrder.SOH_FIN_CHRG;
                (param[63] = new OracleParameter("p_soh_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_DEL_LOC;
                (param[64] = new OracleParameter("p_soh_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_GRN_COM;
                (param[65] = new OracleParameter("p_soh_grn_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_GRN_LOC;
                (param[66] = new OracleParameter("p_soh_is_grn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_IS_GRN;
                (param[67] = new OracleParameter("p_soh_d_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_D_CUST_NAME;
                (param[68] = new OracleParameter("p_soh_is_dayend", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_IS_DAYEND;
                (param[69] = new OracleParameter("p_soh_scm_upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SCM_UPLOAD;
                (param[70] = new OracleParameter("p_SOH_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrder.SOH_SEQ_NO;
                (param[71] = new OracleParameter("p_SOH_DISP_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrder.SOH_DISP_LOC;

                param[72] = new OracleParameter("o_auto", OracleDbType.Int32, null, ParameterDirection.Output);
                param[73] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_affected = UpdateRecords("pkg_sales.SP_UPDATE_SALES_ORD", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            value = param[72].Value.ToString();

            if (!string.IsNullOrEmpty(value))
            {
                opderno = int.Parse(value);
            }


            return new Tuple<int, int>(rows_affected, opderno);
        }

        //Sahan 12/Aug/2015
        public DataTable SearchSalesOrder(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //if (_initialSearchParams.Contains(":"))
            //{
            //    string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
            //    _initialSearchParams = arr[1];
            //}

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            if (searchParams[0] != "")
            {
                string[] arr = searchParams[0].Split(new string[] { ":" }, StringSplitOptions.None);
                searchParams[0] = arr[1];
            }
            string p_soh_so_no = null;
            string p_soh_man_ref = null;
            string p_soh_seq_no = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ORDER NO":
                        p_soh_so_no = _searchText;
                        break;

                    case "MANUAL REF":
                        p_soh_man_ref = _searchText;
                        break;
                    case "SEQ NO":
                        p_soh_seq_no = _searchText;
                        break;
                    default:
                        break;
                }
            }
            p_soh_so_no = (p_soh_so_no != null) ? (p_soh_so_no.ToUpper() + "%") : null;
            p_soh_man_ref = (p_soh_man_ref != null) ? (p_soh_man_ref.ToUpper() + "%") : null;
            p_soh_seq_no = (p_soh_seq_no != null) ? (p_soh_seq_no.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_soh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_soh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_so_no;
            (param[3] = new OracleParameter("p_soh_man_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_man_ref;
            (param[4] = new OracleParameter("p_soh_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_seq_no;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2]).Date;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]).Date;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("sao_hdr", "pkg_sales.sp_load_so", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 12/Aug/2015

        public Int32 SaveSOItems(SalesOrderItems SalesOrderItems)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[44];
            try
            {
                (param[0] = new OracleParameter("p_soi_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_SEQ_NO;
                (param[1] = new OracleParameter("p_soi_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ITM_LINE;
                (param[2] = new OracleParameter("p_soi_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_SO_NO;
                (param[3] = new OracleParameter("p_soi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ITM_CD;
                (param[4] = new OracleParameter("p_soi_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ITM_STUS;
                (param[5] = new OracleParameter("p_soi_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ITM_TP;
                (param[6] = new OracleParameter("p_soi_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_UOM;
                (param[7] = new OracleParameter("p_soi_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_QTY;
                (param[8] = new OracleParameter("p_soi_inv_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_INV_QTY;
                (param[9] = new OracleParameter("p_soi_unit_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_UNIT_RT;
                (param[10] = new OracleParameter("p_soi_unit_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_UNIT_AMT;
                (param[11] = new OracleParameter("p_soi_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_DISC_RT;
                (param[12] = new OracleParameter("p_soi_disc_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_DISC_AMT;
                (param[13] = new OracleParameter("p_soi_itm_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ITM_TAX_AMT;
                (param[14] = new OracleParameter("p_soi_tot_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_TOT_AMT;
                (param[15] = new OracleParameter("p_soi_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_PBOOK;
                (param[16] = new OracleParameter("p_soi_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_PB_LVL;
                (param[17] = new OracleParameter("p_soi_pb_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_PB_PRICE;
                (param[18] = new OracleParameter("p_soi_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_SEQ;
                (param[19] = new OracleParameter("p_soi_itm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ITM_SEQ;
                (param[20] = new OracleParameter("p_soi_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_WARR_PERIOD;
                (param[21] = new OracleParameter("p_soi_warr_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_WARR_REMARKS;
                (param[22] = new OracleParameter("p_soi_is_promo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_IS_PROMO;
                (param[23] = new OracleParameter("p_soi_promo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_PROMO_CD;
                (param[24] = new OracleParameter("p_soi_alt_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ALT_ITM_CD;
                (param[25] = new OracleParameter("p_soi_alt_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ALT_ITM_DESC;
                (param[26] = new OracleParameter("p_soi_print_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_PRINT_STUS;
                (param[27] = new OracleParameter("p_soi_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_RES_NO;
                (param[28] = new OracleParameter("p_soi_res_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_RES_LINE_NO;
                (param[29] = new OracleParameter("p_soi_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_JOB_NO;
                (param[30] = new OracleParameter("p_soi_warr_based", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_WARR_BASED;
                (param[31] = new OracleParameter("p_soi_merge_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_MERGE_ITM;
                (param[32] = new OracleParameter("p_soi_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_JOB_LINE;
                (param[33] = new OracleParameter("p_soi_outlet_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_OUTLET_DEPT;
                (param[34] = new OracleParameter("p_soi_trd_svc_chrg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_TRD_SVC_CHRG;
                (param[35] = new OracleParameter("p_soi_dis_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_DIS_SEQ;
                (param[36] = new OracleParameter("p_soi_dis_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_DIS_LINE;
                (param[37] = new OracleParameter("p_soi_dis_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_DIS_TYPE;
                (param[38] = new OracleParameter("p_soi_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ANAL1;
                (param[39] = new OracleParameter("p_soi_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ANAL2;
                (param[40] = new OracleParameter("p_soi_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ANAL3;
                (param[41] = new OracleParameter("p_soi_anal4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ANAL4;
                (param[42] = new OracleParameter("p_soi_anal5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItems.SOI_ANAL5;

                param[43] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                // ConnectionOpen();
                rows_affected = UpdateRecords("pkg_sales.sp_update_so_itms", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            return rows_affected;
        }

        //Sahan 12/Aug/2015

        public Int32 SaveSOItemTax(SalesOrderItemTax SalesOrderItemTax)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[10];
            try
            {
                (param[0] = new OracleParameter("p_sotx_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_SO_NO;
                (param[1] = new OracleParameter("p_sotx_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_ITM_CD;
                (param[2] = new OracleParameter("p_sotx_itm_tax_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_ITM_TAX_TP;
                (param[3] = new OracleParameter("p_sotx_itm_tax_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_ITM_TAX_RT;
                (param[4] = new OracleParameter("p_sotx_itm_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_ITM_TAX_AMT;
                (param[5] = new OracleParameter("p_sotx_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_JOB_NO;
                (param[6] = new OracleParameter("p_sotx_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_JOB_LINE;
                (param[7] = new OracleParameter("p_sotx_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_SEQ_NO;
                (param[8] = new OracleParameter("p_sotx_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SalesOrderItemTax.SOTX_ITM_LINE;

                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                rows_affected = UpdateRecords("pkg_sales.Update_Sales_ord_itm_Tax", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            return rows_affected;
        }

        //Sahan 12/Aug/2015

        public Int32 SaveSOSer(SalesOrderSer _SalesOrderSer)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[11];
            try
            {
                (param[0] = new OracleParameter("p_sose_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_SEQ_NO;
                (param[1] = new OracleParameter("p_sose_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_ITM_LINE;
                (param[2] = new OracleParameter("p_sose_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_SO_NO;
                (param[3] = new OracleParameter("p_sose_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_ITM_CD;
                (param[4] = new OracleParameter("p_sose_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_SER_1;
                (param[5] = new OracleParameter("p_sose_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_REMARKS;
                (param[6] = new OracleParameter("p_sose_sev_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_SEV_LOC;
                (param[7] = new OracleParameter("p_sose_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_DEL_LOC;
                (param[8] = new OracleParameter("p_sose_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_SER_LINE;
                (param[9] = new OracleParameter("p_sose_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrderSer.SOSE_SER_2;

                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                rows_affected = UpdateRecords("pkg_sales.Update_Sales_Ord_Ser", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            return rows_affected;
        }

        //Sahan 12/Aug/2015

        public Int32 UpdateSOStatus(SalesOrderHeader _SalesOrder)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[7];
            try
            {
                (param[0] = new OracleParameter("p_soh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrder.SOH_STUS;
                (param[1] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrder.SOH_SO_NO;
                (param[2] = new OracleParameter("p_soh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrder.SOH_COM;
                (param[3] = new OracleParameter("p_soh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrder.SOH_PC;
                (param[4] = new OracleParameter("p_soh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesOrder.SOH_MOD_BY;
                (param[5] = new OracleParameter("p_soh_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _SalesOrder.SOH_MOD_WHEN;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                // ConnectionOpen();

                rows_affected = UpdateRecords("pkg_sales.sp_change_so_status", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }
            finally
            {
                // ConnectionClose();
            }

            return rows_affected;
        }

        public DataTable Select_REF_REQ_SUBTP(string main_tp)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("MAIN_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = main_tp;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_REF_REQ_SUBTP", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Select_REF_LOC_CATE1()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_REF_LOC_CATE1", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public List<INT_REQ_SER> GetINT_REQ_SER(Int32 seq_no)
        {
            List<INT_REQ_SER> int_req_ser = new List<INT_REQ_SER>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INT_REQ_SER", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_req_ser = DataTableExtensions.ToGenericList<INT_REQ_SER>(tblData, INT_REQ_SER.Converter);
            }
            return int_req_ser;
        }

        public List<INR_LOC> GetINR_LOC(string com, string loc, string item_cd)
        {
            List<INR_LOC> int_req_ser = new List<INR_LOC>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item_cd;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INR_LOC", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_req_ser = DataTableExtensions.ToGenericList<INR_LOC>(tblData, INR_LOC.Converter);
            }
            return int_req_ser;
        }

        public DataTable Select_MST_STUS(string cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_MST_STUS", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 14/Aug/2015
        public DataTable SearchLocations(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string p_ml_loc_cd = null;
            string p_ml_loc_desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LOCATION CODE":
                        p_ml_loc_cd = _searchText;
                        break;

                    case "LOCATION":
                        p_ml_loc_desc = _searchText;
                        break;
                    default:
                        break;
                }
            }
            p_ml_loc_cd = (p_ml_loc_cd != null) ? (p_ml_loc_cd.ToUpper() + "%") : null;
            p_ml_loc_desc = (p_ml_loc_desc != null) ? (p_ml_loc_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ml_loc_cd;
            (param[2] = new OracleParameter("p_ml_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ml_loc_desc;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("mst_loc", "pkg_sales.sp_load_locations", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 14/Aug/2015
        public DataTable SearchSalesOrdData(string p_soh_so_no, string p_soh_com, string p_soh_pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_so_no;
            (param[1] = new OracleParameter("p_soh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_com;
            (param[2] = new OracleParameter("p_soh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_pc;

            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("sao_hdr", "pkg_sales.sp_load_all_data_so", CommandType.StoredProcedure, false, param);
            return dt;
        }


        //Sahan 14/Aug/2015
        public List<SalesOrderItems> SearchSalesOrdItems(string p_soi_so_no)
        {
            List<SalesOrderItems> _SalesOrderItems = new List<SalesOrderItems>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_soi_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soi_so_no;

            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("sao_itm", "pkg_sales.sp_load_all_so_itms", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                _SalesOrderItems = DataTableExtensions.ToGenericList<SalesOrderItems>(dt, SalesOrderItems.Converter);
            }
            return _SalesOrderItems;
        }

        //Sahan 14/Aug/2015
        public DataTable SearchSalesOrdItemTax(string p_sotx_so_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sotx_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sotx_so_no;

            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("sao_itm_tax", "pkg_sales.sp_load_all_so_itm_tax", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 14/Aug/2015
        public DataTable SearchSalesOrdSerials(string p_sose_so_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sose_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sose_so_no;

            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("sao_ser", "pkg_sales.sp_load_all_so_ser", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 15/Aug/2015
        public DataTable GetInvReqItems(string p_seq_no, string p_itri_com, string p_itri_loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_seq_no;
            (param[1] = new OracleParameter("p_itri_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itri_com;
            (param[2] = new OracleParameter("p_itri_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itri_loc;

            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("int_req_itm", "pkg_sales.get_inventory_req_Items", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 18/Aug/2015
        public DataTable GetWareHousetemsData(string p_inl_com, string p_inl_loc, string p_inl_itm_cd, string p_inl_itm_stus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_com;
            (param[1] = new OracleParameter("p_inl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_loc;
            (param[2] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_itm_cd;
            (param[3] = new OracleParameter("p_inl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_itm_stus;

            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("inr_loc", "pkg_sales.sp_load_itm_details", CommandType.StoredProcedure, false, param);
            return dt;
        }


        //Sahan 18/Aug/2015
        public DataTable GetItemStatusVal(string p_mis_desc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mis_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mis_desc;

            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("mst_itm_stus", "pkg_sales.sp_get_itm_status_val", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 18/Aug/2015
        public DataTable GetItemStatusTxt(string p_mis_cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mis_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mis_cd;

            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("mst_itm_stus", "pkg_sales.sp_get_itm_status_text", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 18/Aug/2015

        public Int32 BalanceItemStock(INT_REQ_ITM _ReqItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[4];
            try
            {
                (param[0] = new OracleParameter("p_itri_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ReqItem.ITRI_QTY;
                (param[1] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ReqItem.ITRI_SEQ_NO;
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqItem.ITRI_ITM_CD;

                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);



                rows_affected = UpdateRecords("pkg_sales.balance_req_items", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }


            return rows_affected;
        }

        //Pemil 2015-08-20
        public List<INT_REQ> Search_INT_REQ(string com, string code, string chnl, string pc, DateTime fdate, DateTime tdate)
        {
            List<INT_REQ> int_req = new List<INT_REQ>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chnl;
            (param[3] = new OracleParameter("PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[5] = new OracleParameter("TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SEARCH_INT_REQSTATUS", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                int_req = DataTableExtensions.ToGenericList<INT_REQ>(dt, INT_REQ.Converter);
            }
            return int_req;
        }

        //Pemil 2015-08-20
        public DataTable SELECT_INT_REQ_ITMbyREQ_NO(string req_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_INT_REQ_ITMBYREQ_NO", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Pemil 2015-08-20
        public DataTable Select_REF_LOC_TP(string cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_REF_LOC_TP", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Pemil 2015-08-21
        public DataTable Select_InventoryBalance(string cd, string itm_cd, string company = null)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            (param[1] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm_cd;
            (param[2] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;

            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "PKG_SALES.SP_SELECT_INVENTORYBALANCE", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Pemil 2015-08-22
        public Int32 SaveINR_RES(INR_RES inr_res)
        {
            OracleParameter[] param = new OracleParameter[27];
            //Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res.IRS_SEQ;
            (param[1] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_COM;
            (param[2] = new OracleParameter("CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CHNL;
            (param[3] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_NO;
            (param[4] = new OracleParameter("RES_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_DT;
            (param[5] = new OracleParameter("RES_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_TP;
            (param[6] = new OracleParameter("CUST_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CUST_TP;
            (param[7] = new OracleParameter("CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CUST_CD;
            (param[8] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_STUS;
            (param[9] = new OracleParameter("RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RMK;
            (param[10] = new OracleParameter("ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_1;
            (param[11] = new OracleParameter("ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_2;
            (param[12] = new OracleParameter("ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_3;
            (param[13] = new OracleParameter("ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_4;
            (param[14] = new OracleParameter("ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_5;
            (param[15] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CRE_BY;
            (param[16] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_CRE_DT;
            (param[17] = new OracleParameter("CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CRE_SESSION;
            (param[18] = new OracleParameter("CNL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CNL_BY;
            (param[19] = new OracleParameter("CNL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_CNL_DT;
            (param[20] = new OracleParameter("CNL_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CNL_SESSION;
            (param[21] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_BY;
            (param[22] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_DT;
            (param[23] = new OracleParameter("MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_SESSION;
            (param[24] = new OracleParameter("EXPTED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_EXPTED_DT;
            param[25] = new OracleParameter("O_AUTO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[26] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("PKG_SALES.SP_SAVE_INR_RES", CommandType.StoredProcedure, param);
            if (result != 1)
                return -1;

            return int.Parse(param[25].Value.ToString());

        }

        //Pemil 2015-08-22
        public Int32 SaveINR_RES_DET(INR_RES_DET inr_res_det)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_SEQ;
            (param[1] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_LINE;
            (param[3] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_ITM_CD;
            (param[4] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_ITM_STUS;
            (param[5] = new OracleParameter("RES_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_QTY;
            (param[6] = new OracleParameter("RES_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_BQTY;
            (param[7] = new OracleParameter("RES_CQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_CQTY;
            (param[8] = new OracleParameter("REQ_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_BQTY;
            (param[9] = new OracleParameter("REQ_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_BQTY;
            (param[10] = new OracleParameter("REQ_CQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_CQTY;
            (param[11] = new OracleParameter("ACT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_ACT;
            (param[12] = new OracleParameter("RESREQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RESREQ_NO;
            (param[13] = new OracleParameter("RESREQ_LINE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RESREQ_LINE;
            (param[14] = new OracleParameter("res_si_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_SI_LINE;
            (param[15] = new OracleParameter("res_si_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_SI_NO;
            param[16] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_SAVE_INR_RES_DET", CommandType.StoredProcedure, param);
            return effects;
        }

        //Pemil 2015-08-22
        public Int32 UpdateINR_RES(INR_RES inr_res)
        {
            OracleParameter[] param = new OracleParameter[25];

            (param[0] = new OracleParameter("SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res.IRS_SEQ;
            (param[1] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_COM;
            (param[2] = new OracleParameter("CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CHNL;
            (param[3] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_NO;
            (param[4] = new OracleParameter("RES_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_DT;
            (param[5] = new OracleParameter("RES_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_TP;
            (param[6] = new OracleParameter("CUST_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CUST_TP;
            (param[7] = new OracleParameter("CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CUST_CD;
            (param[8] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_STUS;
            (param[9] = new OracleParameter("RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RMK;
            (param[10] = new OracleParameter("ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_1;
            (param[11] = new OracleParameter("ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_2;
            (param[12] = new OracleParameter("ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_3;
            (param[13] = new OracleParameter("ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_4;
            (param[14] = new OracleParameter("ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_ANAL_5;
            (param[15] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CRE_BY;
            (param[16] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_CRE_DT;
            (param[17] = new OracleParameter("CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CRE_SESSION;
            (param[18] = new OracleParameter("CNL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CNL_BY;
            (param[19] = new OracleParameter("CNL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_CNL_DT;
            (param[20] = new OracleParameter("CNL_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_CNL_SESSION;
            (param[21] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_BY;
            (param[22] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_DT;
            (param[23] = new OracleParameter("MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_SESSION;
            param[24] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("PKG_SALES.SP_UPDATE_INR_RES", CommandType.StoredProcedure, param);
            return result;

        }

        //Pemil 2015-08-22
        public Int32 UpdateINR_RES_DET(INR_RES_DET inr_res_det)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_SEQ;
            (param[1] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_LINE;
            (param[3] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_ITM_CD;
            (param[4] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_ITM_STUS;
            (param[5] = new OracleParameter("RES_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_QTY;
            (param[6] = new OracleParameter("RES_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_BQTY;
            (param[7] = new OracleParameter("RES_CQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RES_CQTY;
            (param[8] = new OracleParameter("REQ_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_BQTY;
            (param[9] = new OracleParameter("REQ_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_BQTY;
            (param[10] = new OracleParameter("REQ_CQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_det.IRD_REQ_CQTY;
            (param[11] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_ACT;
            (param[12] = new OracleParameter("RESREQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RESREQ_NO;
            (param[13] = new OracleParameter("RESREQ_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_det.IRD_RESREQ_LINE;
            param[14] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_UPDATE_INR_RES_DET", CommandType.StoredProcedure, param);
            return effects;
        }

        //Pemil 2015-08-22
        public INR_RES GetReservationApproval(string req_no)
        {
            INR_RES inr_res = new INR_RES();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INR_RES", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res = DataTableExtensions.ToGenericList<INR_RES>(tblData, INR_RES.ConverterNew)[0];
            }
            return inr_res;
        }

        //Pemil 2015-08-22
        public List<INR_RES_DET> GetGetReservationApprovalItem(Int32 seq_no)
        {
            List<INR_RES_DET> inr_res_det = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INR_RES_DET", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res_det = DataTableExtensions.ToGenericList<INR_RES_DET>(tblData, INR_RES_DET.Converterwithsi);
            }
            return inr_res_det;
        }

        //Pemil 2015-08-22
        public Int32 SaveINR_RES_LOG(INR_RES_LOG inr_res_log)
        {
            OracleParameter[] param = new OracleParameter[33];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_SEQ;
            (param[1] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_NO;
            (param[2] = new OracleParameter("RES_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_LINE;
            (param[3] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_LINE;
            (param[4] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ITM_CD;
            (param[5] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ITM_STUS;
            (param[6] = new OracleParameter("RES_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_BQTY;
            (param[7] = new OracleParameter("RES_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_BQTY;
            (param[8] = new OracleParameter("RES_IQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_IQTY;
            (param[9] = new OracleParameter("ORIG_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_DOC_TP;
            (param[10] = new OracleParameter("ORIG_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_DOC_NO;
            (param[11] = new OracleParameter("ORIG_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_DOC_DT;
            (param[12] = new OracleParameter("ORIG_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_ITM_LINE;
            (param[13] = new OracleParameter("ORIG_BATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_BATCH_LINE;
            (param[14] = new OracleParameter("ORIG_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_COM;
            (param[15] = new OracleParameter("ORIG_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_LOC;
            (param[16] = new OracleParameter("CURT_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_DOC_TP;
            (param[17] = new OracleParameter("CURT_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_DOC_NO;
            (param[18] = new OracleParameter("CURT_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_DOC_DT;
            (param[19] = new OracleParameter("CURT_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_ITM_LINE;
            (param[20] = new OracleParameter("CURT_BATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_BATCH_LINE;
            (param[21] = new OracleParameter("CURT_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_COM;
            (param[22] = new OracleParameter("CURT_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_LOC;
            (param[23] = new OracleParameter("BASE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_BASE_LINE;
            (param[24] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ACT;
            (param[25] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CRE_BY;
            (param[26] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CRE_DT;
            (param[27] = new OracleParameter("CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CRE_SESSION;
            (param[28] = new OracleParameter("MOD_BY", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_MOD_BY;
            (param[29] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_MOD_DT;
            (param[30] = new OracleParameter("MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_MOD_SESSION;
            (param[31] = new OracleParameter("res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_WP;
            param[32] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("PKG_SALES.SP_SAVE_INR_RES_LOG", CommandType.StoredProcedure, param);
            return effects;
        }

        //Pemil 2015-08-27
        public List<INR_RES_LOG> GetGetReservationlog(Int32 seq_no, string cd)
        {
            List<INR_RES_LOG> inr_res_log = new List<INR_RES_LOG>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            (param[1] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INR_RES_LOG", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res_log = DataTableExtensions.ToGenericList<INR_RES_LOG>(tblData, INR_RES_LOG.ConverterNew);
            }
            return inr_res_log;
        }

        //Pemil 2015-08-28
        public List<INT_REQ> GetINT_REQList(Int32 seq_no)
        {
            List<INT_REQ> int_reqList = new List<INT_REQ>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INR_REQList", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_reqList = DataTableExtensions.ToGenericList<INT_REQ>(tblData, INT_REQ.Converter);
            }
            return int_reqList;
        }

        //Darshana 21-08-2015
        public DataTable GetDetailsforBatchPrice(string p_com, string p_loc, decimal p_margin, string p_cat1, string p_cat2, string p_cat3, string p_docNo, DateTime _frmDt, DateTime _toDt)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
            (param[2] = new OracleParameter("p_margin", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_margin;
            (param[3] = new OracleParameter("cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat1;
            (param[4] = new OracleParameter("cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat2;
            (param[5] = new OracleParameter("cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat3;
            (param[6] = new OracleParameter("docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_docNo;
            (param[7] = new OracleParameter("frmDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[8] = new OracleParameter("toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;

            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("inr_batch", "sp_getbatch_price", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //Rukshan 26-08-2015
        public DataTable GetDetailsforBarcodePrice(string p_BType, string p_lvlcode, string p_Icode)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_BookType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_BType;
            (param[1] = new OracleParameter("p_LvlCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_lvlcode;
            (param[2] = new OracleParameter("p_ICode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_Icode;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblBarcode", "SP_GetBarcodeItemPrice", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Pemil 2015-08-31
        public List<INR_RES> Select_INR_RES(string com, string chnl, string res_no, string tp, string cust_cd, DateTime fromDate, DateTime toDate, string status)
        {
            List<INR_RES> inr_res = new List<INR_RES>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chnl;
            (param[2] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = res_no;
            (param[3] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tp;
            (param[4] = new OracleParameter("CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cust_cd;
            (param[5] = new OracleParameter("FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[6] = new OracleParameter("TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            (param[7] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_RES", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res = DataTableExtensions.ToGenericList<INR_RES>(tblData, INR_RES.Converter);
            }
            return inr_res;
        }

        //Pemil 2015-08-22
        //changed Randima 2016-11-22
        public Int32 CancelINR_RES_LOG(INR_RES_LOG inr_res_log, decimal qty, string mod_by, DateTime mod_dt)
        {
            OracleParameter[] param = new OracleParameter[33];
            Int32 effects = 0;

            (param[0] = new OracleParameter("SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_SEQ;
            (param[1] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_NO;
            (param[2] = new OracleParameter("RES_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_LINE;
            (param[3] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_LINE;
            (param[4] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ITM_CD;
            (param[5] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ITM_STUS;
            (param[6] = new OracleParameter("RES_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_BQTY;
            (param[7] = new OracleParameter("RES_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_BQTY;
            (param[8] = new OracleParameter("RES_IQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_RES_IQTY;
            (param[9] = new OracleParameter("ORIG_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_DOC_TP;
            (param[10] = new OracleParameter("ORIG_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_DOC_NO;
            (param[11] = new OracleParameter("ORIG_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_DOC_DT;
            (param[12] = new OracleParameter("ORIG_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_ITM_LINE;
            (param[13] = new OracleParameter("ORIG_BATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_BATCH_LINE;
            (param[14] = new OracleParameter("ORIG_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_COM;
            (param[15] = new OracleParameter("ORIG_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ORIG_LOC;
            (param[16] = new OracleParameter("CURT_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_DOC_TP;
            (param[17] = new OracleParameter("CURT_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_DOC_NO;
            (param[18] = new OracleParameter("CURT_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_DOC_DT;
            (param[19] = new OracleParameter("CURT_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_ITM_LINE;
            (param[20] = new OracleParameter("CURT_BATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_BATCH_LINE;
            (param[21] = new OracleParameter("CURT_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_COM;
            (param[22] = new OracleParameter("CURT_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CURT_LOC;
            (param[23] = new OracleParameter("BASE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_BASE_LINE;
            (param[24] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inr_res_log.IRL_ACT;
            (param[25] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CRE_BY;
            (param[26] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CRE_DT;
            (param[27] = new OracleParameter("CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CRE_SESSION;
            (param[28] = new OracleParameter("MOD_BY", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_MOD_BY;
            (param[29] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res_log.IRL_MOD_DT;
            (param[30] = new OracleParameter("MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res_log.IRL_MOD_SESSION;
            (param[31] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inr_res_log.IRL_CAN_QTY;
            param[32] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_cancel_inr_res_logNew", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka 2015-09-29
        public List<INR_RES> GET_RESERVATION_HDR(string com, string custCode, String Status, string _loc)
        {
            List<INR_RES> int_reqList = new List<INR_RES>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custCode;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "SP_GET_RESERVATION_HDR", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_reqList = DataTableExtensions.ToGenericList<INR_RES>(tblData, INR_RES.ConverterNew);
            }
            return int_reqList;
        }

        //Tharaka 2015-09-29
        public List<INR_RES_DET> GET_RESERVATION_DET(Int32 seq_no, string _reno)
        {
            List<INR_RES_DET> int_reqList = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            (param[1] = new OracleParameter("P_RESNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reno;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "SP_GET_RESERVATION_DET", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_reqList = DataTableExtensions.ToGenericList<INR_RES_DET>(tblData, INR_RES_DET.ConverterNew);
            }
            return int_reqList;
        }

        //Darshana 2015-10-02
        public DataTable GetPVDet(string p_type, Int32 pageNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_vouNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pageNo;
            (param[1] = new OracleParameter("p_vouTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblBarcode", "sp_getvoudet", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable Get_GroupSaleInvoiceDetails(string _invno)
        {//Sanjeewa 2015-10-17
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;

            DataTable dt = QueryDataTable("tbl", "sp_get_invoice_item", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharaka 2015-10-19
        public List<ReptPickSerials> GET_BUYBACKITMES_FOR_INVOIC(string invoice)
        {
            List<ReptPickSerials> int_reqList = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVOICE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "SP_GET_BUYBACKITMES_FOR_INVOIC", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in tblData.Rows)
            {
                int_reqList.Add(Convert_INT_SerwoBatch(tr));
            }
            return int_reqList;
        }

        private ReptPickSerials Convert_INT_SerwoBatch(DataRow _tr)
        {
            ReptPickSerials _pick = new ReptPickSerials();
            _pick.Tus_batch_line = Convert.ToInt32(_tr["ITS_BATCH_LINE"]);
            _pick.Tus_bin = Convert.ToString(_tr["ITS_BIN"]);
            _pick.Tus_com = Convert.ToString(_tr["ITS_COM"]);
            _pick.Tus_cre_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_no = Convert.ToString(_tr["ITS_DOC_NO"]);
            _pick.Tus_exist_grncom = Convert.ToString(_tr["ITS_EXIST_GRNCOM"]);
            _pick.Tus_exist_grndt = Convert.ToDateTime(_tr["ITS_EXIST_GRNDT"]);
            _pick.Tus_exist_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_exist_supp = Convert.ToString(_tr["ITS_EXIST_SUPP"]);
            _pick.Tus_itm_cd = Convert.ToString(_tr["ITS_ITM_CD"]);
            _pick.Tus_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);
            _pick.Tus_itm_stus = Convert.ToString(_tr["ITS_ITM_STUS"]);
            _pick.Tus_loc = Convert.ToString(_tr["ITS_LOC"]);//not sure
            _pick.Tus_orig_grncom = Convert.ToString(_tr["ITS_ORIG_GRNCOM"]);
            _pick.Tus_orig_grndt = Convert.ToDateTime(_tr["ITS_ORIG_GRNDT"]);
            _pick.Tus_orig_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_orig_supp = Convert.ToString(_tr["ITS_ORIG_SUPP"]);
            _pick.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure
            _pick.Tus_seq_no = Convert.ToInt32(_tr["ITS_SEQ_NO"]);
            _pick.Tus_ser_1 = Convert.ToString(_tr["ITS_SER_1"]);
            _pick.Tus_ser_2 = Convert.ToString(_tr["ITS_SER_2"]);
            _pick.Tus_ser_3 = Convert.ToString(_tr["ITS_SER_3"]);
            _pick.Tus_ser_4 = Convert.ToString(_tr["ITS_SER_4"]);
            _pick.Tus_ser_id = Convert.ToInt32(_tr["ITS_SER_ID"]);
            _pick.Tus_ser_line = Convert.ToInt32(_tr["ITS_SER_LINE"]);
            // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
            _pick.Tus_unit_cost = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            _pick.Tus_unit_price = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
            _pick.Tus_warr_no = Convert.ToString(_tr["ITS_WARR_NO"]);
            _pick.Tus_warr_period = Convert.ToInt32(_tr["ITS_WARR_PERIOD"]);
            _pick.Tus_new_status = string.Empty;
            _pick.Tus_base_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);

            if (string.IsNullOrEmpty(_tr["ITS_AGELOC"].ToString()))
            { _pick.Tus_ageloc = _pick.Tus_loc; }
            else
            { _pick.Tus_ageloc = _tr["ITS_AGELOC"].ToString(); }
            if (string.IsNullOrEmpty(_tr["ITS_AGELOC_DT"].ToString()))
            { _pick.Tus_ageloc_dt = _pick.Tus_doc_dt; }
            else
            { _pick.Tus_ageloc_dt = Convert.ToDateTime(_tr["ITS_AGELOC_DT"].ToString()).Date; }

            if (string.IsNullOrEmpty(_tr["ITS_ISOWNMRN"].ToString()))
            { _pick.Tus_isownmrn = 0; }
            else
            { _pick.Tus_isownmrn = Convert.ToInt32(_tr["ITS_ISOWNMRN"].ToString()); }

            //Added Prabhath on 11/08/2012
            MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);
            _pick.Tus_itm_desc = _item.Mi_longdesc;
            _pick.Tus_itm_model = _item.Mi_model;
            _pick.Tus_itm_brand = _item.Mi_brand;

            return _pick;
        }

        //Tharaka 2015-09-29
        public List<InvoiceItem> GET_INV_ITM_BY_RESNO_LINE(String Res, Int32 ResLine)
        {
            List<InvoiceItem> int_reqList = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_RES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Res;
            (param[1] = new OracleParameter("P_RESLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ResLine;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "SP_GET_INV_ITM_BY_RESNO_LINE", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                int_reqList = DataTableExtensions.ToGenericList<InvoiceItem>(tblData, InvoiceItem.ConvertInvoiceItem);
            }
            return int_reqList;
        }


        //Sahan 02/Nov/2015
        public Int32 UpdatePriceBook(PriceBookRef book)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_sapb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = book.Sapb_com;
            (param[1] = new OracleParameter("p_sapb_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = book.Sapb_pb;
            (param[2] = new OracleParameter("p_sapb_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = book.Sapb_desc;
            (param[3] = new OracleParameter("p_sapb_hierachy_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = book.Sapb_hierachy_lvl;
            (param[4] = new OracleParameter("p_sapb_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = book.Sapb_act;
            (param[5] = new OracleParameter("p_sapb_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = book.Sapb_cre_by;
            (param[6] = new OracleParameter("p_sapb_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = book.Sapb_cre_when;
            (param[7] = new OracleParameter("p_sapb_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = book.Sapb_mod_by;
            (param[8] = new OracleParameter("p_sapb_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = book.Sapb_mod_when;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_price_web.sp_update_price_book", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 02/Nov/2015
        public DataTable SearchPriceBooks(string company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sapb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("sar_pb", "pkg_price_web.sp_search_price_books", CommandType.StoredProcedure, false, param);
        }

        //Tharaka 2015-11-02
        public List<CashGeneralEntiryDiscountDef> GET_DIS_REQ_BY_CUSTOMER(string saleType, string com, string pc, DateTime date, string customer)
        {
            List<CashGeneralEntiryDiscountDef> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_SALESTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = saleType;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[3] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[4] = new OracleParameter("P_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_DIS_REQ_BY_CUSTOMER", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CashGeneralEntiryDiscountDef>(tblDet, CashGeneralEntiryDiscountDef.Converter);
            }
            return _list;
        }

        //Sahan 03/Nov/2015
        public Int32 UpdatePriceBookLevel(PriceBookLevelRef booklevel)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[31];

            (param[0] = new OracleParameter("p_sapl_pb_lvl_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_pb_lvl_cd;
            (param[1] = new OracleParameter("p_sapl_erp_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_erp_ref;
            (param[2] = new OracleParameter("p_sapl_pb_lvl_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_pb_lvl_desc;
            (param[3] = new OracleParameter("p_sapl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_act;
            (param[4] = new OracleParameter("p_sapl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_cre_by;
            (param[5] = new OracleParameter("p_sapl_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = booklevel.Sapl_cre_when;
            (param[6] = new OracleParameter("p_sapl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_mod_by;
            (param[7] = new OracleParameter("p_sapl_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = booklevel.Sapl_mod_when;
            (param[8] = new OracleParameter("p_sapl_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_com_cd;
            (param[9] = new OracleParameter("p_sapl_is_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_def;
            (param[10] = new OracleParameter("p_sapl_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_pb;
            (param[11] = new OracleParameter("p_sapl_itm_stuts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_itm_stuts;
            (param[12] = new OracleParameter("p_sapl_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_warr_period;
            (param[13] = new OracleParameter("p_sapl_is_serialized", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_serialized;
            (param[14] = new OracleParameter("p_sapl_currency_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_currency_cd;
            (param[15] = new OracleParameter("p_sapl_is_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_print;
            (param[16] = new OracleParameter("p_sapl_set_warr", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_set_warr;
            (param[17] = new OracleParameter("p_sapl_vat_calc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_vat_calc;
            (param[18] = new OracleParameter("p_sapl_chk_st_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_chk_st_tp;
            (param[19] = new OracleParameter("p_sapl_credit_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_credit_period;
            (param[20] = new OracleParameter("p_sapl_is_valid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_valid;
            (param[21] = new OracleParameter("p_sapl_is_transfer", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_transfer;
            (param[22] = new OracleParameter("p_sapl_is_sales", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_sales;
            (param[23] = new OracleParameter("p_sapl_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = booklevel.Sapl_grn_com;
            (param[24] = new OracleParameter("p_sapl_is_without_p", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_without_p;
            (param[25] = new OracleParameter("p_sapl_base_on_tot_inv_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_base_on_tot_inv_qty;
            (param[26] = new OracleParameter("p_sapl_is_for_po", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_is_for_po;
            (param[27] = new OracleParameter("p_sapl_isage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_isage;
            (param[28] = new OracleParameter("p_sapl_isbatch_wise", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_isbatch_wise;
            (param[29] = new OracleParameter("p_sapl_model_base", OracleDbType.Int32, null, ParameterDirection.Input)).Value = booklevel.Sapl_model_base;

            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_price_web.sp_update_price_book_level", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 04/Nov/2015
        public DataTable SearchPriceBookLevels(string company, string code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sapl_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_sapl_pb_lvl_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("sar_pb_lvl", "pkg_price_web.sp_search_price_book_lvl", CommandType.StoredProcedure, false, param);
        }

        //Tharaka 2015-11-27
        public Int32 UpdateDisposalReceiptNumber(String DisposalJobNum, String com, String Status, string ReceiptNumber)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_RECEIPT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReceiptNumber;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            (param[3] = new OracleParameter("P_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DisposalJobNum;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_DISP_RECEIPTNO", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-11-27
        public Int32 UPDATE_RES_BQTY(String resNum, Int32 lineNum, decimal Qty)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_RES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = resNum;
            (param[1] = new OracleParameter("P_LINENUM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNum;
            (param[2] = new OracleParameter("P_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Qty;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_RES_BQTY", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-12-03
        public List<InterCompanySalesParameter> GET_INTERCOM_PAR_BY_CUST(string Com, String Cust)
        {
            List<InterCompanySalesParameter> _list = new List<InterCompanySalesParameter>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cust;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_INTERCOM_PAR_BY_CUST", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InterCompanySalesParameter>(_tblData, InterCompanySalesParameter.Converter);
            }
            return _list;
        }

        //Darshana 04-Dec-2015
        public List<PaymentType> GetPossiblePaymentTypes_Default(string _com, string _party, string _cd, string txn_tp, DateTime today, Int32 _isBOCN)
        {
            List<PaymentType> _userList = null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[3] = new OracleParameter("p_txn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txn_tp;
            (param[4] = new OracleParameter("p_current_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = today;
            (param[5] = new OracleParameter("p_is_BOCN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isBOCN;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_get_posible_pay_tps_def_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<PaymentType>(_dtResults, PaymentType.Converter);
            }

            return _userList;
        }

        public DataTable GetPossiblePayTypes(string _com, string _party, string _cd, string txn_tp, DateTime today)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[3] = new OracleParameter("p_txn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txn_tp;
            (param[4] = new OracleParameter("p_current_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = today;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUserProf", "sp_get_posible_pay_tps_defult", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //Tharaka 2015-12-22
        public Int32 UPDATEP_RECP_ITM_SETL_AMNT(Decimal amount, Int32 SeqNo, Int32 lineNo, string recNo)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_AMOUNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = amount;
            (param[1] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SeqNo;
            (param[2] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNo;
            (param[3] = new OracleParameter("P_RECNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recNo;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATEP_RECP_ITM_SETL_AMNT", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-12-28
        public DataTable GET_SAO_ITEMS_BY_SO_NO(string code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("sar_pb_lvl", "PKG_SALES.SP_GET_SAO_ITEMS_BY_SO_NO", CommandType.StoredProcedure, false, param);
        }

        //Tharaka 2015-12-28
        public DataTable GET_SAO_SER_BY_SO_NO(string code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("sar_pb_lvl", "PKG_SALES.SP_GET_SAO_SER_BY_SO_NO", CommandType.StoredProcedure, false, param);
        }
        //Written By Darshana 30-12-2015
        public List<MasterPCTax> GetPcTax(string _company, string _pc, Int16 _stus, DateTime _dt)
        {
            List<MasterPCTax> _list = new List<MasterPCTax>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _stus;
            (param[3] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getpctax", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterPCTax>(_tblData, MasterPCTax.Converter);
            }
            return _list;
        }

        //    fdate, tdate, in_cust,in_exec,in_doctype,in_itemcode,in_brand,
        //in_model,in_itemcat1,in_itemcat2,in_itemcat3,in_user,in_stktype,
        //in_invno,in_com, in_pc,IN_PROMOTOR,in_freeIss,in_itemcat4,in_itemcat5
        public DataTable Get_Gp_Data(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor,
            int _freeissue, string _itemclasif, string _brndmgr, bool withReversal, int _rplitm, DateTime _fromDate2, DateTime _toDate2, Int16 _intercom)
        {  // Lakshan 2016/01/04 - Sanjeewa 2016-05-27 - Lakshika 2016/10/18(inv direction)
            OracleParameter[] param = new OracleParameter[29];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[14] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[15] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[16] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[17] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[18] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[19] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[20] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[21] = new OracleParameter("in_itm_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemclasif;
            (param[22] = new OracleParameter("in_btnd_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndmgr;
            (param[23] = new OracleParameter("in_consider_invdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N";
            //(param[24] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[24] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (withReversal == true ? 0 : 1);
            (param[25] = new OracleParameter("in_replitem", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rplitm;
            (param[26] = new OracleParameter("fdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate2.Date;
            (param[27] = new OracleParameter("tdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate2.Date;
            (param[28] = new OracleParameter("in_intercom", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intercom;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_gp_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetPLDetails(DateTime _fromDate, DateTime _toDate, string _Pc, string _Com)
        {  // Sanjeewa 2018-04-24
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_pl_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Gp_Rpl_Data(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor,
                    int _freeissue, string _itemclasif, string _brndmgr, bool withReversal, int _rplitm, DateTime _fromDate2, DateTime _toDate2, Int16 _intercom)
        {  // Sanjeewa 2016-12-05
            OracleParameter[] param = new OracleParameter[29];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[14] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[15] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[16] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[17] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[18] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[19] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[20] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[21] = new OracleParameter("in_itm_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemclasif;
            (param[22] = new OracleParameter("in_btnd_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndmgr;
            (param[23] = new OracleParameter("in_consider_invdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N";
            (param[24] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[25] = new OracleParameter("in_replitem", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rplitm;
            (param[26] = new OracleParameter("fdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate2.Date;
            (param[27] = new OracleParameter("tdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate2.Date;
            (param[28] = new OracleParameter("in_intercom", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intercom;

            DataTable _dtResults = QueryDataTable("tblRcc", "SP_GET_SALES_REP_BMI_GP2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Gp_Recon_Data(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor,
            int _freeissue, string _itemclasif, string _brndmgr, bool withReversal, int _rplitm, DateTime _fromDate2, DateTime _toDate2, Int16 _intercom, string _fromadmin, string _toadmin)
        {  // Sanjeewa 2016-11-03
            OracleParameter[] param = new OracleParameter[31];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[14] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[15] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[16] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[17] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[18] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[19] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[20] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[21] = new OracleParameter("in_itm_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemclasif;
            (param[22] = new OracleParameter("in_btnd_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndmgr;
            (param[23] = new OracleParameter("in_consider_invdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N";
            (param[24] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withReversal;
            (param[25] = new OracleParameter("in_replitem", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rplitm;
            (param[26] = new OracleParameter("fdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate2.Date;
            (param[27] = new OracleParameter("tdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate2.Date;
            (param[28] = new OracleParameter("in_intercom", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intercom;
            (param[29] = new OracleParameter("in_fromadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromadmin;
            (param[30] = new OracleParameter("in_toadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toadmin;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_gp_reconciliation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetItemwiseWarehouseMovement(DateTime _fromDate, DateTime _toDate, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _StockType, string _loc, string _Com, int _direction)
        {  // Sanjeewa 2016-06-05
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[6] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[7] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[8] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[9] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[10] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[11] = new OracleParameter("in_stktype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[12] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[13] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[14] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[15] = new OracleParameter("in_direction", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _direction;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_inbuond_outbound", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCanibaliseStockReport(DateTime _fromDate, DateTime _toDate, string _itemclassif, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _StockType, string _loc, string _Com, string _pb, string _pblvl)
        {  // Sanjeewa 2016-06-22
            OracleParameter[] param = new OracleParameter[18];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemclassif;
            (param[4] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[5] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[6] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[7] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[8] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[9] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[10] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[11] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[12] = new OracleParameter("in_stktype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[13] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[14] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[15] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[16] = new OracleParameter("in_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            (param[17] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_canibalise_cost_report", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Sales_Valuation(DateTime in_fdate, DateTime in_tdate, string in_clasif, string in_itemcode, string in_brand, string in_model,
           string in_itemcat1, string in_itemcat2, string in_itemcat3, string in_itemcat4, string in_itemcat5, string in_stktype, string in_com, string in_pc, string in_user)
        {  // Lakshan 2016/01/04
            DataTable dt = new DataTable();
            DataRow row;//= new DataRow();
            DataColumn col = new DataColumn();
            col = new DataColumn(); col.DataType = System.Type.GetType("System.String"); col.ColumnName = "PROFIT / COST CENTER"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.String"); col.ColumnName = "REF CODE"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "COST OF SALES"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "SALES"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "DISCOUNT"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "NET SALES VALUE"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "GROSS PROFIT"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "GPM"; dt.Columns.Add(col);
            col = new DataColumn(); col.DataType = System.Type.GetType("System.Decimal"); col.ColumnName = "DO VALUE"; dt.Columns.Add(col);
            return dt;
        }
        public DataTable GetCreditnoteDetails(DateTime _fromdate, DateTime _todate, string _com, string _pc)
        {
            // hasith 25/01/2015         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate.Date;
            (param[2] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate.Date;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_getcreditnote_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetGVDetails(DateTime _fromdate, DateTime _todate, string _com, string _pc)
        {
            // hasith 25/01/2015         
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate.Date;
            (param[2] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate.Date;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_getgvdetails", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDetailsOfCollectionDetails(string _Jobno, Int16 _Export)
        {
            // Sanjeewa 2016-02-02      
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Jobno;
            (param[2] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Export;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_dtl_of_col", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Save_Exchange_Rate(MasterExchangeRate _Exchange, string p_type)
        {
            //Lakshan 2016/01/30
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[20];

            (param[0] = new OracleParameter("p_mer_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Exchange.Mer_id;
            (param[1] = new OracleParameter("p_mer_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_com;
            (param[2] = new OracleParameter("p_mer_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_cur;
            (param[3] = new OracleParameter("p_mer_vad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_vad_from;
            (param[4] = new OracleParameter("p_mer_vad_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_vad_to;
            (param[5] = new OracleParameter("p_mer_bnksel_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Exchange.Mer_bnksel_rt;
            (param[6] = new OracleParameter("p_mer_bnkbuy_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Exchange.Mer_bnkbuy_rt;
            (param[7] = new OracleParameter("p_mer_cussel_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Exchange.Mer_cussel_rt;
            (param[8] = new OracleParameter("p_mer_buyvad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_buyvad_from;
            (param[9] = new OracleParameter("p_mer_buyvad_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_buyvad_to;
            (param[10] = new OracleParameter("p_mer_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Exchange.Mer_act;
            (param[11] = new OracleParameter("p_mer_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_cre_by;
            (param[12] = new OracleParameter("p_mer_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_cre_dt;
            (param[13] = new OracleParameter("p_mer_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_mod_by;
            (param[14] = new OracleParameter("p_mer_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Exchange.Mer_mod_dt;
            (param[15] = new OracleParameter("p_mer_session_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Exchange.Mer_session_id;
            (param[16] = new OracleParameter("p_mer_to_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_to_cur;
            (param[17] = new OracleParameter("p_mer_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exchange.Mer_pc;
            (param[18] = new OracleParameter("p_m_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("pkg_imports_Enquiry.SP_SAVE_EXCHANGE_RATE", CommandType.StoredProcedure, param);
            return effects;

        }
        //Rukshan 2016-02-06
        public DataTable GETRES_PO_DETAILS(string _com, string _sbu, string _supp, string _blno, DateTime _fdate, DateTime _todate, string _item)
        {
            //Rukshan 2016-02-06
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sbu;
            (param[2] = new OracleParameter("P_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supp;
            (param[3] = new OracleParameter("P_BLNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            (param[4] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[5] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[6] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _dtResults = QueryDataTable("tbl", "pkg_sales.SP_GET_RES_PO", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_RES_PO", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable CheckBalanceInvoiceQty(string _invoice, string _item)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            DataTable tblDet = QueryDataTable("tblItem", "sp_get_bal_invoice_qty", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckIsAccountClosed(string _invoice, DateTime _asatdate)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("in_item", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            DataTable tblDet = QueryDataTable("tblItem", "sp_check_is_acc_close", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable getExchangeCreditNoteDetails(string _com, string _pc, DateTime _fromdate, DateTime _todate, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[4] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            DataTable tblDet = QueryDataTable("tblItem", "sp_get_exchg_cr_note_dtl", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public LoyaltyMemeber getLoyaltyDetails(string customer, string loyalNu)
        {

            OracleParameter[] param = new OracleParameter[3];
            LoyaltyMemeber loyCus = new LoyaltyMemeber();
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            (param[1] = new OracleParameter("p_loyaltnum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loyalNu;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_LOYALTYDETAILS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                loyCus = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_dtResults, LoyaltyMemeber.Converter)[0];
            }
            return loyCus;

        }

        public List<PriceDefinitionRef> GetPriceDefinitionRefs(PriceDefinitionRef _priceDef)
        {
            List<PriceDefinitionRef> _list = new List<PriceDefinitionRef>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_p_lvl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_com;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceDef.Sadd_pb;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tblItem", "pkg_general.sp_get_doc_price_def", CommandType.StoredProcedure, false, param);
            if (_dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PriceDefinitionRef>(_dt, PriceDefinitionRef.ConverterDiscount);
            }
            return _list;
        }

        //Lakshan 27-Feb-27
        public Int32 UpdatePriceDefinitionRef(PriceDefinitionRef _ref)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[22];

            (param[0] = new OracleParameter("p_sadd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_pc;
            (param[1] = new OracleParameter("p_sadd_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_sadd_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_p_lvl;
            //(param[3] = new OracleParameter("p_sadd_is_bank_ex_rt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ref.Sadd_is_bank_ex_rt;
            (param[3] = new OracleParameter("p_sadd_is_bank_ex_rt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_is_bank_ex_rt;
            (param[4] = new OracleParameter("p_sadd_is_disc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_is_disc;
            (param[5] = new OracleParameter("p_sadd_disc_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ref.Sadd_disc_rt;
            (param[6] = new OracleParameter("p_sadd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_com;
            //(param[7] = new OracleParameter("p_sadd_chk_credit_bal", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ref.Sadd_chk_credit_bal;
            (param[7] = new OracleParameter("p_sadd_chk_credit_bal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_chk_credit_bal;
            (param[8] = new OracleParameter("p_sadd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_cre_by;
            (param[9] = new OracleParameter("p_sadd_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ref.Sadd_cre_when;
            (param[10] = new OracleParameter("p_sadd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_mod_by;
            (param[11] = new OracleParameter("p_sadd_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ref.Sadd_mod_when;
            (param[12] = new OracleParameter("p_sadd_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_pb;
            (param[13] = new OracleParameter("p_sadd_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_prefix;
            //(param[14] = new OracleParameter("p_sadd_def", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ref.Sadd_def;
            (param[14] = new OracleParameter("p_sadd_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_def;
            (param[15] = new OracleParameter("p_sadd_def_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref.Sadd_def_stus;
            //(param[16] = new OracleParameter("p_sadd_def_pb", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _ref.Sadd_def_pb;
            (param[16] = new OracleParameter("p_sadd_def_pb", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_def_pb;
            (param[17] = new OracleParameter("p_sadd_is_rep", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_is_rep;
            (param[18] = new OracleParameter("p_sadd_rep_order", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_rep_order;
            (param[19] = new OracleParameter("p_sadd_is_edit", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ref.Sadd_is_edit;
            (param[20] = new OracleParameter("p_sadd_edit_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ref.Sadd_edit_rt;
            param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_sales.sp_update_sar_doc_price_defn", CommandType.StoredProcedure, param);
            return effects;
        }

        //Sahan 29/Feb/2016

        public Int32 UpdateSerialAvailability(string company, string location, string serial)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[4];
            try
            {
                (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;

                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                rows_affected = UpdateRecords("pkg_sales.update_serial_availability", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }
            finally
            {
                ConnectionClose();
            }
            return rows_affected;
        }

        //Sahan 07/Feb/2016
        public DataTable Check_PC_SO_REST_STK(string company, string pc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_profit_center", "pkg_sales.chk_disp_so_rest_stk", CommandType.StoredProcedure, false, param);
        }

        //Sahan 07/Feb/2016

        public Int32 UpdateINRLoc(string company, string location, string Item, string status, Decimal _qty)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];
            try
            {
                (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
                (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
                (param[4] = new OracleParameter("pqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;

                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                rows_affected = UpdateRecords("pkg_sales.update_inr_loc", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            return rows_affected;
        }

        //Sahan 17/MAr/2016
        public DataTable CheckLocationBaBalance(string company, string loc, string item, string itemstus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemstus;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_loc", "pkg_sales.chk_free_qty_loc", CommandType.StoredProcedure, false, param);
        }

        //Sahan 18/MAr/2016
        public DataTable LoadPoData(string company, string pc, string doc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("pur_det", "pkg_sales.load_po_data", CommandType.StoredProcedure, false, param);
        }
        public List<QUO_COST_DET> GetInvoiceDetailsForEnq(string cuscode, string enqid)
        {
            List<QUO_COST_DET> _invoiceHeader = new List<QUO_COST_DET>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cuscode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cuscode;
            (param[1] = new OracleParameter("p_enqid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = enqid;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "sp_get_inv_by_enq", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<QUO_COST_DET>(_invoiceDT, QUO_COST_DET.Converter);
            }
            return _invoiceHeader;
        }

        public List<PriceDetailRef> GetPromotionNew(string _company, string _profitcenter, string _item, DateTime _date, string _customer, decimal _qty, string _ptytp, string _pc)
        {
            //sp_getpromotion(p_com in NVARCHAR2,p_pc in NVARCHAR2, p_item in NVARCHAR2,p_date in date,p_customer in NVARCHAR2,c_data out sys_refcursor) 
            List<PriceDetailRef> _priceDetailRef = new List<PriceDetailRef>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptytp;
            (param[7] = new OracleParameter("p_profit_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPromotion", "sp_getpromotionNewnew_1", CommandType.StoredProcedure, false, param);
            //DataTable _tblPriceDetail = QueryDataTable("tblPromotion", "sp_getpromotionNew", CommandType.StoredProcedure, false, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceDetailRef>(_tblPriceDetail, PriceDetailRef.ConvertWithPriceType);
            }

            return _priceDetailRef;

        }

        public DataTable GetReceiptPayDetails(string recno)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_RECNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recno;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_RECEIPTITEMDTL", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public List<RequestApprovalHeader> getcompleded_ReqbyType(string _com, string _pc, string _type, string _user, string _selectPC)
        {
            List<RequestApprovalHeader> _list = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_selectPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _selectPC;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "pkg_sales.sp_getFinreqbytype", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_tblData, RequestApprovalHeader.ConverterFINSRN);
            }
            return _list;
        }

        //Written By Rukshan on 2016/Apr/27
        public SarDocumentPriceDefn GetDocPriceDetails(string _company, string _profitcenter, string _book, string _level, string _doctype)
        {
            SarDocumentPriceDefn _list = null;
            //sp_getgeneralentitydicount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "pkg_search_imp.sp_getPRdetail", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SarDocumentPriceDefn>(tblDet, SarDocumentPriceDefn.Converter)[0];
            }
            return _list;
        }
        public DataTable GetItemCodeDes(string ORNO)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ORCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ORNO;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblBarcode", "SP_GET_ITMDESCR", CommandType.StoredProcedure, false, param);
            return dt;
        }


        public List<InventorySearchItemsAll> GETALLITEMS(string docno, string code)
        {
            List<InventorySearchItemsAll> _list = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getitemall", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySearchItemsAll>(_tblData, InventorySearchItemsAll.Converter);
            }
            return _list;
        }
        public Int32 UpdateReceiptTbs(string _invoicno, string _receiptno, Int32 _invoiceseqno, Int32 _receiptseqno)
        {
            //CREATE OR REPLACE PROCEDURE sp_update_invoice_receipt_no (p_invoiceno in NVARCHAR2,p_recieptno in NVARCHAR2,p_invoiceseqno in NUMBER,p_recieptseqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoicno;
            (param[1] = new OracleParameter("p_recieptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptno;
            (param[2] = new OracleParameter("p_invoiceseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invoiceseqno;
            (param[3] = new OracleParameter("p_recieptseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _receiptseqno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updt_tbsreceipt", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveBOQHDD(SatProjectHeader _BOQ)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[41];

            (param[0] = new OracleParameter("p_sph_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_SEQ;
            (param[1] = new OracleParameter("p_sph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM;
            (param[2] = new OracleParameter("p_sph_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PC;
            (param[3] = new OracleParameter("p_sph_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_NO;
            (param[4] = new OracleParameter("p_sph_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_DT;
            (param[5] = new OracleParameter("p_sph_oth_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_OTH_DT;
            (param[6] = new OracleParameter("p_sph_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_REF;
            (param[7] = new OracleParameter("p_sph_ex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_EX;
            (param[8] = new OracleParameter("p_sph_oth_ex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_OTH_EX;
            (param[9] = new OracleParameter("p_sph_est_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_EST_COST;
            (param[10] = new OracleParameter("p_sph_act_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_ACT_COST;
            (param[11] = new OracleParameter("p_sph_est_rev", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_EST_REV;
            (param[12] = new OracleParameter("p_sph_act_rev", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_ACT_REV;
            (param[13] = new OracleParameter("p_sph_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_CD;
            (param[14] = new OracleParameter("p_sph_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_NAME;
            (param[15] = new OracleParameter("p_sph_cus_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_ADD1;
            (param[16] = new OracleParameter("p_sph_cus_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_ADD2;
            (param[17] = new OracleParameter("p_sph_cus_add3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_ADD3;
            (param[18] = new OracleParameter("p_sph_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_RMK;
            (param[19] = new OracleParameter("p_sph_pro_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PRO_LOC;
            (param[20] = new OracleParameter("p_sph_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_LOC_DESC;
            (param[21] = new OracleParameter("p_sph_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PB;
            (param[22] = new OracleParameter("p_sph_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PB_LVL;
            (param[23] = new OracleParameter("p_sph_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CRE_BY;
            (param[24] = new OracleParameter("p_sph_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_CRE_DT;
            (param[25] = new OracleParameter("p_sph_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_MOD_BY;
            (param[26] = new OracleParameter("p_sph_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_MOD_DT;
            (param[27] = new OracleParameter("p_sph_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_APP_BY;
            (param[28] = new OracleParameter("p_sph_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_APP_DT;
            (param[29] = new OracleParameter("p_sph_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL1;
            (param[30] = new OracleParameter("p_sph_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL2;
            (param[31] = new OracleParameter("p_sph_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL3;
            (param[32] = new OracleParameter("p_sph_anal4", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL4;
            (param[33] = new OracleParameter("p_sph_anal5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL5;
            (param[34] = new OracleParameter("p_sph_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL6;
            (param[35] = new OracleParameter("p_sph_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL7;
            (param[36] = new OracleParameter("p_sph_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL8;
            (param[37] = new OracleParameter("p_sph_com_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM_BY;
            (param[38] = new OracleParameter("p_sph_com_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM_DT;
            (param[39] = new OracleParameter("p_sph_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_STATUS;
            param[40] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_sales.sp_save_satpro", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveBOQDetails(SatProjectDetails _Item)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_spd_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_SEQ;
            (param[1] = new OracleParameter("p_spd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPD_LINE;
            (param[2] = new OracleParameter("p_spd_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_NO;
            (param[3] = new OracleParameter("p_spd_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_ITM;
            (param[4] = new OracleParameter("p_spd_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_ITM_DESC;
            (param[5] = new OracleParameter("p_spd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_MODEL;
            (param[6] = new OracleParameter("p_spd_est_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_EST_QTY;
            (param[7] = new OracleParameter("p_spd_est_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_EST_COST;
            (param[8] = new OracleParameter("p_spd_act_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_ACT_QTY;
            (param[9] = new OracleParameter("p_spd_act_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_ACT_COST;
            (param[10] = new OracleParameter("p_spd_est_rev", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_EST_REV;
            (param[11] = new OracleParameter("p_spd_act_rev", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_ACT_REV;
            (param[12] = new OracleParameter("p_spd_inv_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_INV_QTY;
            (param[13] = new OracleParameter("p_spd_inv_prt_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_INV_PRT_DESC;
            (param[14] = new OracleParameter("p_spd_actve", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPD_ACTVE;
            (param[15] = new OracleParameter("p_SPD_KIT_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPD_KIT_ITM;
            (param[16] = new OracleParameter("p_SPD_MRN_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPD_MRN_BAL;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_sales.sp_save_satprodetals", CommandType.StoredProcedure, param);
            return effects;
        }

        public SatProjectHeader GETBOQHDR(string com, string code)
        {
            SatProjectHeader _list = new SatProjectHeader();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "pkg_sales.sp_search_satproHdr", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SatProjectHeader>(_tblData, SatProjectHeader.Converter)[0];
            }
            return _list;
        }
        public List<SatProjectDetails> GETBOQDETAILS(string code)
        {
            List<SatProjectDetails> _list = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "pkg_sales.sp_search_satproDetails", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SatProjectDetails>(_tblData, SatProjectDetails.Converter2);
            }
            return _list;
        }

        public Int32 ApproveBOQHDR(SatProjectHeader _BOQ)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_spd_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM;
            (param[1] = new OracleParameter("p_sph_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_NO;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_APP_BY;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_sales.sp_Approve_satpro", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetLASTMONTHSALE(string _com, string _pc, DateTime _from, DateTime _to, string _item)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblBarcode", "pkg_sales.sp_lastmothsales", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Rukshan 11-06-2015
        public String GetDescription(string p_Icode)
        {
            string Des = string.Empty;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_Icode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblBarcode", "pkg_sales.sp_searchrefsubtype", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                Des = dt.Rows[0][0].ToString();
            }
            return Des;
        }
        //Kelum : Get Bus Entity Profile: 2016-May:13
        public MasterBusinessEntity GetBusEntityProfile(string CustCD, string nic, string DL, string PPNo, string brNo, string com, string mobile, string type, int activestatus)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[6] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobile;
            (param[7] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[8] = new OracleParameter("p_activestatus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = activestatus;

            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getbusentityprofile", CommandType.StoredProcedure, false, param);

            MasterBusinessEntity bizEnt = new MasterBusinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }
            return bizEnt;
        }

        //SUBODANA 2016-05-19

        public DataTable GetProfitCenterDetails(string _com, string _pclist)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pclist", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pclist;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblBarcode", "SP_FILTER_PC_DET", CommandType.StoredProcedure, false, param);
            return dt;
        }

        /* Creat by Rukshan on 20/May/2016 2:32:50 PM */
        public List<ImpCusdecHdr> GECUSBOND_CUS(string _com, string _loc, string _cus, string _code, DateTime _form, DateTime _To)
        {
            List<ImpCusdecHdr> _list = new List<ImpCusdecHdr>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _form;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblBarcode", "pkg_sales.SP_GECUSBOND_CUS", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ImpCusdecHdr>(_tblData, ImpCusdecHdr.Converter_DO);
            }
            return _list;
        }
        //Add by Lakshan 02 Jun 2017
        public Int32 UpdateBlReqQtyForPendingOrders(string _doc, string _ItemCode, int _ItemLine, decimal _qty, int _type)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_bl_item_new", CommandType.StoredProcedure, param);
            return effects;
        }
        //Written by Rukshan 09/Nov/2015
        public Int32 Update_BI_Rqty(string _doc, string _ItemCode, int _ItemLine, decimal _qty, int _type)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_sales.sp_updatebl_item", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 22 Jun 2016 copy from Update_BI_Rqty
        public Int32 Update_BI_RqtyNew(string _doc, string _ItemCode, int _ItemLine, decimal _qty, int _type)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_sales.sp_updatebl_item", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_BI_RqtyNew2(string _doc, string _ItemCode, int _ItemLine, decimal _qty, int _type)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatebl_item", CommandType.StoredProcedure, param);
            return effects;
        }

        // subodana 2016-06-08
        public DataTable GetPC_from_Hierachy_with_Opteam(string com, string channel, string subChannel, string area, string region, string zone, string pc_code, string opteam)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            (param[7] = new OracleParameter("p_operteam", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opteam;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pc_onHierachy_opteam", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetLoc_from_Hierachy_withOpteam(string com, string channel, string subChannel, string area, string region, string zone, string pc_code, string opteam)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            (param[7] = new OracleParameter("p_operteam", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opteam;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_loc_onHierachy_inOpteam", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 08 Jun 2016
        public DataTable GetSalesTrackerInvoices(InvoiceHeader hdr, InvoiceItem itm)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_sah_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Sah_com;
            (param[1] = new OracleParameter("p_sah_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Sah_pc;
            (param[2] = new OracleParameter("p_fr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.Sah_anal_12;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.Sah_dt;
            (param[4] = new OracleParameter("p_sad_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.Sad_itm_cd;
            (param[5] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.Sad_itm_tp;
            (param[6] = new OracleParameter("p_sah_sales_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Sah_sales_ex_cd;
            (param[7] = new OracleParameter("p_sah_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Sah_cus_cd;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("sat_hdr", "pkg_sales.sp_get_sat_hdr_st", CommandType.StoredProcedure, false, param);
            DataView dv = _result.DefaultView;
            dv.Sort = "sah_inv_no ASC";
            _result = dv.ToTable();
            return _result;
        }

        // Lakshan 09 Jun 2016
        public DataTable GetIntHdrData(InventoryHeader hdr)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ith_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Ith_doc_tp;
            (param[1] = new OracleParameter("p_ith_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Ith_oth_docno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("int_itm", "pkg_sales.sp_sal_tra_delivery", CommandType.StoredProcedure, false, param);
            return _result;
        }

        // Lakshan 09 Jun 2016
        public DataTable GetIntHdrDataByInv(InventoryHeader hdr)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ser_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Ith_doc_tp;
            (param[1] = new OracleParameter("p_sah_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Ith_doc_no;
            (param[2] = new OracleParameter("p_ith_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.Ith_oth_docno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("int_itm", "pkg_sales.sp_sal_tra_ser_invoice", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written by Rukshan 09/Jun/2016
        public Int32 Update_So_status(string _com, string __doc)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_so", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = __doc;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_sales.SP_UPDATESO", CommandType.StoredProcedure, param);
            return effects;
        }
        //Written by Rukshan 09/Jun/2016
        public int UpdateSOinvoiceQty(string _doc, int _line_no, string _status, string _item_cd, decimal _qty)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line_no;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item_cd;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("pkg_sales.SP_UPDATESOINVQTY", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        // subodana 2016-06-13
        public DataTable GetReversalInvoiceData(string _com, string _invNo)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_REVERSEINVDATA", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        //Written By Rukshan on 2016/JUN/23
        public CashPromotionDiscountDetail GetitemDiscount(string _pctype, string _pc, string _item, string _stype, DateTime _date, string _book,
                                                     string _lvl, decimal _qty)
        {
            CashPromotionDiscountDetail _list = null;
            //sp_getgeneralentitydicount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_date in date,p_book in NVARCHAR2,p_level in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pctype;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stype;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[6] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lvl;
            (param[7] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "pkg_sales.sp_gecusby_cus", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<CashPromotionDiscountDetail>(tblDet, CashPromotionDiscountDetail.Converter_dis)[0];
            }
            return _list;
        }
        // subodana 2016-06-25
        public DataTable GetTotalApproveQty(string req_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "SP_GET_TOTAPPQTY", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Lakshan 06 Jul 2016
        public List<INR_RES_DET> GetInrResDet(INR_RES_DET _obj)
        {
            List<INR_RES_DET> inr_res_det = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_RES_NO;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable tblData = QueryDataTable("tbl", "sp_get_inr_res_det", CommandType.StoredProcedure, false, param);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.sp_get_inr_res_det", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res_det = DataTableExtensions.ToGenericList<INR_RES_DET>(tblData, INR_RES_DET.ConverterNew);
            }
            return inr_res_det;
        }
        // subodana 2016-07-05
        public DataTable GetUnitPriceNew(string itemcode, string loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "SP_GET_LEATESTUNITPRICE", CommandType.StoredProcedure, false, param);
            return dt;
        }
        // subodana 2016-07-06
        public int Update_filenoforCostsheet(string com, string docno, string fileno)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[2] = new OracleParameter("p_fileno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fileno;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("sp_updatefilenocost", CommandType.StoredProcedure, param);
            return effects;
        }

        //subodana 2016-07-07
        public DataTable GetSOSeqno(string com, string sono)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_sono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sono;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "sp_getSOdetseq", CommandType.StoredProcedure, false, param);
            return dt;
        }

        // subodana 2016-07-07
        public int Update_SOItems(Int32 seq, string sono)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_sono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sono;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (Int16)UpdateRecords("sp_deleteSOdetitems", CommandType.StoredProcedure, param);
            return effects;
        }



        // subodana 2016-07-07
        public int Update_ReqItems(Int32 seq, string sono)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_sono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sono;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (Int16)UpdateRecords("sp_deleteReqdetitems", CommandType.StoredProcedure, param);
            return effects;
        }

        //subodana 2016-07-07
        public DataTable GetREQITMSeqno(string com, string sono)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_sono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sono;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "sp_getReqITMseq", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Written by Rukshan 14/Jul/2016
        public Int32 Update_SoA_status(string _com, string _so)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_Soa", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _so;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_sales.SP_UPDATESOA", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 27 Jul 2016
        public Int32 SaveSalesForecastingCalendar(SalesForecastingCalendar _obj)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_seq;
            (param[1] = new OracleParameter("p_sfc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_cd;
            (param[2] = new OracleParameter("p_sfc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_com;
            (param[3] = new OracleParameter("p_sfc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_desc;
            (param[4] = new OracleParameter("p_sfc_ye_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_ye_frm;
            (param[5] = new OracleParameter("p_sfc_ye_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_ye_to;
            (param[6] = new OracleParameter("p_sfc_st_mnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_st_mnt;
            (param[7] = new OracleParameter("p_sfc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_act;
            (param[8] = new OracleParameter("p_sfc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_cre_by;
            (param[9] = new OracleParameter("p_sfc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfc_cre_dt;
            (param[10] = new OracleParameter("p_sfc_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_mod_by;
            (param[11] = new OracleParameter("p_sfc_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfc_mod_dt;
            (param[12] = new OracleParameter("p_sfc_ed_mnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sfc_ed_mnt;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_for_cal", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 27 Jul 2016
        public DataTable SearchSalesForecastingCalendar(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            code = (code != null) ? (code + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sfc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_sfc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sar_for_cal", "sp_ser_sar_for_cale", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 27 Jul 2016
        public List<SalesForecastingCalendar> GetSarForCal(SalesForecastingCalendar _obj)
        {
            List<SalesForecastingCalendar> _objList = new List<SalesForecastingCalendar>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_sfc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_cd;
            (param[1] = new OracleParameter("p_sfc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfc_com;
            (param[2] = new OracleParameter("p_sfc_ye_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_ye_to;
            (param[3] = new OracleParameter("p_sfc_ye_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_ye_frm;
            (param[4] = new OracleParameter("p_sfc_st_mnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_st_mnt;
            (param[5] = new OracleParameter("p_sfc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfc_act;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("sar_for_cal", "sp_get_sar_for_cal", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                _objList = DataTableExtensions.ToGenericList<SalesForecastingCalendar>(tblData, SalesForecastingCalendar.Converter);
            }
            return _objList;
        }
        //Lakshan 29 Jul 2016
        public Int32 SaveSalesForecastingCompany(SalesForecastingCalendarCom _obj)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfm_seq;
            (param[1] = new OracleParameter("p_sfm_cale_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfm_cale_cd;
            (param[2] = new OracleParameter("p_sfm_alw_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfm_alw_com;
            (param[3] = new OracleParameter("p_sfm_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfm_act;
            (param[4] = new OracleParameter("p_sfm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfm_cre_by;
            (param[5] = new OracleParameter("p_sfm_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfm_cre_dt;
            (param[6] = new OracleParameter("p_sfm_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfm_mod_by;
            (param[7] = new OracleParameter("p_sfm_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfm_mod_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_for_com", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 29 Jul 2016
        public List<SalesForecastingCalendarCom> GetSarForCom(SalesForecastingCalendarCom _obj)
        {
            List<SalesForecastingCalendarCom> _objList = new List<SalesForecastingCalendarCom>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_sfm_cale_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfm_cale_cd;
            (param[1] = new OracleParameter("p_sfm_alw_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfm_alw_com;
            (param[2] = new OracleParameter("p_sfm_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfm_act;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("sar_for_com", "sp_get_sar_for_com", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                _objList = DataTableExtensions.ToGenericList<SalesForecastingCalendarCom>(tblData, SalesForecastingCalendarCom.Converter);
            }
            return _objList;
        }
        //Lakshan 2016 Aug 01
        public List<SalesForecastingMasterPeriod> Get_MST_FOR_PD_TP(SalesForecastingMasterPeriod _obj)
        {
            List<SalesForecastingMasterPeriod> _objList = new List<SalesForecastingMasterPeriod>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mfp_tp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mfp_tp_cd;
            (param[1] = new OracleParameter("p_mfp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mfp_desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("sar_for_com", "sp_get_mst_for_pd_tp", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                _objList = DataTableExtensions.ToGenericList<SalesForecastingMasterPeriod>(tblData, SalesForecastingMasterPeriod.Converter);
            }
            return _objList;
        }
        //Lakshan 2016 Aug 01
        public List<SalesForecastingPeriod> Get_SAR_FOR_PD(SalesForecastingPeriod _obj)
        {
            List<SalesForecastingPeriod> _objList = new List<SalesForecastingPeriod>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_sfp_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_com;
            (param[1] = new OracleParameter("p_sfp_pd_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfp_pd_tp;
            (param[2] = new OracleParameter("p_sfp_par_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_par_cd;
            (param[3] = new OracleParameter("p_sfp_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_pd_cd;
            (param[4] = new OracleParameter("p_sfp_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_cal_cd;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("sar_for_com", "sp_get_sar_for_pd", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                _objList = DataTableExtensions.ToGenericList<SalesForecastingPeriod>(tblData, SalesForecastingPeriod.Converter);
            }
            return _objList;
        }
        public Int32 SaveSalesForecastingPeriod(SalesForecastingPeriod _obj)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfp_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfp_seq;
            (param[1] = new OracleParameter("p_sfp_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_com;
            (param[2] = new OracleParameter("p_sfp_pd_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfp_pd_tp;
            (param[3] = new OracleParameter("p_sfp_par_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_par_cd;
            (param[4] = new OracleParameter("p_sfp_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_pd_cd;
            (param[5] = new OracleParameter("p_sfp_frm_pd", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfp_frm_pd;
            (param[6] = new OracleParameter("p_sfp_to_pd", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfp_to_pd;
            (param[7] = new OracleParameter("p_sfp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_desc;
            (param[8] = new OracleParameter("p_sfp_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfp_act;
            (param[9] = new OracleParameter("p_sfp_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_cre_by;
            (param[10] = new OracleParameter("p_sfp_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfp_cre_dt;
            (param[11] = new OracleParameter("p_sfp_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_mod_by;
            (param[12] = new OracleParameter("p_sfp_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfp_mod_dt;
            (param[13] = new OracleParameter("p_sfp_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfp_cal_cd;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_for_pd", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 2016 Aug 02
        public DataTable SearchSalesForecastingPeriod(string _initialSearchParams, string _searchCatergory, string _searchText, string frmDt, string toDt)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;
            string _parCd = null;
            string _calCd = null;
            Int32 _parTp = 0;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            code = (code != null) ? (code + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;
            _parCd = string.IsNullOrEmpty(searchParams[1]) ? null : searchParams[1].ToString();
            _parTp = string.IsNullOrEmpty(searchParams[2]) ? 0 : Int32.TryParse(searchParams[2].ToString(), out _parTp) ? Convert.ToInt32(searchParams[2].ToString()) : 0;
            _calCd = string.IsNullOrEmpty(searchParams[3]) ? null : searchParams[3].ToString();

            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfp_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sfp_par_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _parCd;
            (param[2] = new OracleParameter("p_sfp_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[3] = new OracleParameter("p_sfp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            (param[4] = new OracleParameter("p_sfp_pd_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _parTp;
            (param[5] = new OracleParameter("p_sfp_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _calCd;
            (param[6] = new OracleParameter("p_sfp_frm_pd", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt;
            (param[7] = new OracleParameter("p_sfp_to_pd", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sar_for_cal", "sp_ser_sar_for_pd", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 2016 Aug 02
        public DataTable SearchSalesForecastingPeriodByCal(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            code = (code != null) ? (code + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfp_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sfp_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_sfp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            (param[3] = new OracleParameter("p_sfp_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sar_for_cal", "sp_ser_sar_for_pd_by_cal", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 2016 Aug 08
        public Int32 SaveSalesForecastingHeader(SalesForecastingHeader _obj, out Int32 Seq)
        {
            Seq = -1;
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfh_seq;
            (param[1] = new OracleParameter("p_sfh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_com;
            (param[2] = new OracleParameter("p_sfh_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_cal_cd;
            (param[3] = new OracleParameter("p_sfh_calfrm_ye", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfh_calfrm_ye;
            (param[4] = new OracleParameter("p_sfh_calto_ye", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfh_calto_ye;
            (param[5] = new OracleParameter("p_sfh_calfrm_mnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfh_calfrm_mnt;
            (param[6] = new OracleParameter("p_sfh_calto_mnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfh_calto_mnt;
            (param[7] = new OracleParameter("p_sfh_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_pd_cd;
            (param[8] = new OracleParameter("p_sfh_pd_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfh_pd_frm;
            (param[9] = new OracleParameter("p_sfh_pd_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfh_pd_to;
            (param[10] = new OracleParameter("p_sfh_def_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_def_by;
            (param[11] = new OracleParameter("p_sfh_def_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_def_cd;
            (param[12] = new OracleParameter("p_sfh_def_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_def_on;
            (param[13] = new OracleParameter("p_sfh_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfh_act;
            (param[14] = new OracleParameter("p_sfh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_cre_by;
            (param[15] = new OracleParameter("p_sfh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfh_cre_dt;
            (param[16] = new OracleParameter("p_sfh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfh_mod_by;
            (param[17] = new OracleParameter("p_sfh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Sfh_mod_dt;
            (param[18] = new OracleParameter("p_sfh_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sfh_type;
            param[19] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_for_hdr", CommandType.StoredProcedure, param);
            if (effects > 0) { Seq = Convert.ToInt32(param[19].Value.ToString()); }
            return effects;
        }
        //Lakshan 2016 Aug 08
        public Int32 SaveSalesForecastingDetail(SalesForecastingDetail _obj)
        {
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfd_seq;
            (param[1] = new OracleParameter("p_sfd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfd_line;
            (param[2] = new OracleParameter("p_sfd_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_itm;
            (param[3] = new OracleParameter("p_sfd_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_cat1;
            (param[4] = new OracleParameter("p_sfd_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_cat2;
            (param[5] = new OracleParameter("p_sfd_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_cat3;
            (param[6] = new OracleParameter("p_sfd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_model;
            (param[7] = new OracleParameter("p_sfd_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_brnd;
            (param[8] = new OracleParameter("p_sfd_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Sfd_qty;
            (param[9] = new OracleParameter("p_sfd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Sfd_val;
            (param[10] = new OracleParameter("p_sfd_gp", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Sfd_gp;
            (param[11] = new OracleParameter("p_sfd_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfd_act;
            (param[12] = new OracleParameter("p_sfd_exc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sfd_exc;
            (param[13] = new OracleParameter("p_sfd_inv_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sfd_inv_type;
            (param[14] = new OracleParameter("p_sfd_manager", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sfd_manager;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_sar_for_det", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 2016 Aug 08
        public List<SalesForecastingDetail> GET_SAR_FOR_DET_BY_HDR(SalesForecastingHeader _hdr)
        {
            List<SalesForecastingDetail> _objList = new List<SalesForecastingDetail>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_sfh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sfh_com;
            (param[1] = new OracleParameter("p_sfh_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sfh_cal_cd;
            (param[2] = new OracleParameter("p_sfh_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sfh_pd_cd;
            (param[3] = new OracleParameter("p_sfh_def_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sfh_def_by;
            (param[4] = new OracleParameter("p_sfh_def_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sfh_def_cd;
            (param[5] = new OracleParameter("p_sfh_def_on", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Sfh_def_on;
            (param[6] = new OracleParameter("p_sfh_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Sfh_act;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("sar_for_com", "sp_get_sar_for_det_by_hdr", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                _objList = DataTableExtensions.ToGenericList<SalesForecastingDetail>(tblData, SalesForecastingDetail.Converter);
            }
            return _objList;
        }



        //Lakshan 2016 Aug 10
        public Int32 SaveSalesForecastingDetail(CustomsProcedureCodes _obj)
        {
            OracleParameter[] param = new OracleParameter[22];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_mph_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_cnty;
            (param[1] = new OracleParameter("p_mph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_com;
            (param[2] = new OracleParameter("p_mph_cogn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_cogn_tp;
            (param[3] = new OracleParameter("p_mph_cogn_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_cogn_cd;
            (param[4] = new OracleParameter("p_mph_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_doc_tp;
            (param[5] = new OracleParameter("p_mph_proc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_proc_cd;
            (param[6] = new OracleParameter("p_mph_proc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_proc_desc;
            (param[7] = new OracleParameter("p_mph_decl_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_decl_1;
            (param[8] = new OracleParameter("p_mph_decl_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_decl_2;
            (param[9] = new OracleParameter("p_mph_decl_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_decl_3;
            (param[10] = new OracleParameter("p_mph_print_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_print_1;
            (param[11] = new OracleParameter("p_mph_print_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_print_2;
            (param[12] = new OracleParameter("p_mph_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Mph_act;
            (param[13] = new OracleParameter("p_mph_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_cre_by;
            (param[14] = new OracleParameter("p_mph_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Mph_cre_dt;
            (param[15] = new OracleParameter("p_mph_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_cre_session;
            (param[16] = new OracleParameter("p_mph_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_mod_by;
            (param[17] = new OracleParameter("p_mph_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Mph_mod_dt;
            (param[18] = new OracleParameter("p_mph_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mph_mod_session;
            (param[19] = new OracleParameter("p_mph_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Mph_def;
            (param[20] = new OracleParameter("p_mph_ignore_duty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Mph_ignore_duty;
            param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_mst_proc", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 2016 Aug 16
        public List<MasterBusinessEntity> GetCustomerProfileNew(MasterBusinessEntity _obj)
        {// p_CustCD in NVARCHAR2,p_nic in NVARCHAR2,p_dl in NVARCHAR2,p_passport in NVARCHAR2,c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_com;
            (param[1] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_cd;
            (param[2] = new OracleParameter("p_mbe_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_tp;
            (param[3] = new OracleParameter("p_mbe_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_nic;
            (param[4] = new OracleParameter("p_mbe_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_dl_no;
            (param[5] = new OracleParameter("p_mbe_pp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_pp_no;
            (param[6] = new OracleParameter("p_mbe_br_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_br_no;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getcustomerprofilenew", CommandType.StoredProcedure, false, param);

            List<MasterBusinessEntity> bizEnt = new List<MasterBusinessEntity>();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter);
            }
            return bizEnt;
        }
        // subodana 2016-08-22
        public DataTable GET_CST_DATA_BYDOC(string DOCNO)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOCNO;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "GET_CST_DATA_BYDOC", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public Int32 UpdatePickData(string _com, int _seq, string _soa, string _invoiceno, int _newseq)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[2] = new OracleParameter("p_soa", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _soa;
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            (param[4] = new OracleParameter("p_newseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _newseq;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_updatepickdata", CommandType.StoredProcedure, param);
            return effects;
        }
        // RUKSHAN 2016-SEP-10
        public DataTable Check_resno(string _COM, string DOCNO, string _cus, string _LOC)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOCNO;
            (param[2] = new OracleParameter("P_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LOC;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "SP_CHECKRESAPPNO", CommandType.StoredProcedure, false, param);
            return dt;
        }

        // subodana 2016-09-19
        public DataTable GET_HSLIMIT_DATA(string loc, DateTime firstdate, DateTime lastdate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[1] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = firstdate;
            (param[2] = new OracleParameter("P_LDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = lastdate;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "GET_HSLIMITDATA", CommandType.StoredProcedure, false, param);
            return dt;
        }
        // subodana 2016-09-19
        public DataTable GET_HSINVDATA(string loc, DateTime firstdate, DateTime lastdate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[1] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = firstdate;
            (param[2] = new OracleParameter("P_LDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = lastdate;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "GET_HSINVDATA", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable Get_Gp_Data_Reconcilation(DateTime _fromDate, DateTime _toDate, string _Cust, string _Exec, string _DocTp, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _User, string _RepType, string _StockType, string _InvNo, string _Pc, string _Com, string _Promotor, int _freeissue, string _itemclasif, string _brndmgr, string AdminTMList, string delAdminTMList)
        {  // Lakshika 2016-09-23
            OracleParameter[] param = new OracleParameter[30];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocTp;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[12] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _StockType;
            (param[14] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[15] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[16] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[17] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Promotor;
            (param[18] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _freeissue;
            (param[19] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[20] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[21] = new OracleParameter("in_itm_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemclasif;
            (param[22] = new OracleParameter("in_btnd_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndmgr;
            (param[23] = new OracleParameter("in_adm_team", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AdminTMList;
            (param[24] = new OracleParameter("in_del_team", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = delAdminTMList;
            (param[25] = new OracleParameter("in_consider_invdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N";
            (param[26] = new OracleParameter("in_withReversal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[27] = new OracleParameter("in_replitem", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[28] = new OracleParameter("fdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[29] = new OracleParameter("tdate2", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;

            DataTable _dtResults = QueryDataTable("tblRcc", "SP_GET_GP_DTL_RECONCILATION", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Lakshika 2016-09-23
        public DataTable GetGP_ReconciliationDtls(string com, string ope_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("in_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ope_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "SP_GET_GP_RECONCILATION", CommandType.StoredProcedure, false, param);
            return dt;
        }

        // RUKSHAN 2016-09-25
        public DataTable GET_SALESREVERSALDETAILS_REP(string com, DateTime _from, DateTime _to, string _sbu, string _pc, string _cus, string _itm,
            string _brand, string _model)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sbu;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[7] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "SP_GETSRNDETAILS", CommandType.StoredProcedure, false, param);
            return dt;
        }
        // subodana 2016-09-28
        public DataTable GET_PCFROMLOC(string loc, string com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "sp_getpctoloc", CommandType.StoredProcedure, false, param);
            return dt;
        }
        // subodana 2016-09-28
        public DataTable GET_ADVRECFORMRN(string itemcode, string com, string pc, DateTime fdate, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[3] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[4] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "sp_getAdvaceRecieptMRN", CommandType.StoredProcedure, false, param);
            return dt;
        }

        // subodana 2016-09-28
        public DataTable SP_GETERRLINEDOC(string com, DateTime fdate, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[2] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "SP_GETERRLINEDOC", CommandType.StoredProcedure, false, param);
            return dt;
        }
        // subodana 2016-09-28
        public DataTable SP_GETERRLINEDOC2(string doc, string itm, Int32 line, Int32 batchline, string status)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            (param[3] = new OracleParameter("p_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = batchline;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldata", "SP_GETERRLINEDOC2", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetTempUserLocations(string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblPCEmp", "SP_GET_TEMP_USER_LOC", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //Rukshan 2016-oct -07
        public List<ImportsBLItems> GetBLItemByRef(ImportsBLHeader _obj)
        {// p_CustCD in NVARCHAR2,p_nic in NVARCHAR2,p_dl in NVARCHAR2,p_passport in NVARCHAR2,c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_bl_ref_no;
            (param[1] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "SP_BLITEMDETAILSBYREF", CommandType.StoredProcedure, false, param);

            List<ImportsBLItems> bizEnt = new List<ImportsBLItems>();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<ImportsBLItems>(_dtResults, ImportsBLItems.ConverterCusdec);
            }
            return bizEnt;
        }

        //Lakshika 2016-10-14
        public DataTable GetDiscountReportDetails(string _com, string _pc, string _itemCode, string _cat1, string _cat2, string _cat3,
            string _brand, string _model, string _customer, string _executive, DateTime _fromDate, DateTime _toDate, int _fromDisc, int _toDisc, string _user)
        {
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[3] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[4] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[5] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[9] = new OracleParameter("p_executive", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _executive;
            (param[10] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[11] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[12] = new OracleParameter("p_fromDisc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _fromDisc;
            (param[13] = new OracleParameter("p_toDisc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _toDisc;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tblDisc", "SP_GET_DISCOUNT_RPT_DETAILS", CommandType.StoredProcedure, false, param);
            return dt;

        }

        public DataTable GetStockSummaryReportDetails(string _User, string _JoNo)
        {
            // Lakshika 2016/10/20       
            //OracleParameter[] param = new OracleParameter[3];
            //param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //(param[1] = new OracleParameter("in_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JoNo;
            //(param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            //DataTable _dtResults;
            //_dtResults = QueryDataTable("tbl", "pkg_audit_rep.SP_GET_AUDIT_MAIN", CommandType.StoredProcedure, false, param);

            DataTable _dtResults = new DataTable();
            _dtResults.TableName = "tblStockVal";

            _dtResults.Columns.Add("STOCK_VAL1", typeof(Decimal));
            _dtResults.Columns.Add("STOCK_VAL2", typeof(Decimal));
            _dtResults.Columns.Add("STOCK_VAL3", typeof(Decimal));

            var row = _dtResults.NewRow();
            _dtResults.Rows.Add(row);
            _dtResults.Rows[0]["STOCK_VAL1"] = 12;
            _dtResults.Rows[0]["STOCK_VAL2"] = 45;
            _dtResults.Rows[0]["STOCK_VAL3"] = 33;

            return _dtResults;
        }


        public List<MasterItemTax> GetCustomerTax(string _cus, string _company)
        {
            //sp_getitemtax   (p_com in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2 , p_taxcode in NVARCHAR2,p_taxratecode in NVARCHAR2, c_data  OUT sys_refcursor)
            List<MasterItemTax> _list = new List<MasterItemTax>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_searchbusentity_tax", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemTax>(_tblData, MasterItemTax.ConvertTotalBusTax);
            }

            return _list;


        }
        //Subodana 2016-10-25
        public List<DELI_SALE_NEW> GetDeliversaleList()
        {
            List<DELI_SALE_NEW> list = new List<DELI_SALE_NEW>();
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "GetDeliverSaleData", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                list = DataTableExtensions.ToGenericList<DELI_SALE_NEW>(_tblData, DELI_SALE_NEW.Converter);
            }

            return list;
        }


        //Rukshan 2016-NOV-04
        public Master_Employee GetMasterEmployee(String Com, String emp)
        {
            Master_Employee _ListItems = new Master_Employee();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("p_empCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_inv_Emp", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<Master_Employee>(_dtResults, Master_Employee.Converter)[0];
            }
            return _ListItems;
        }
        //RUKSHAN 04-NOV-2016
        public Int32 SaveSMSOut(OutSMS _smsout)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_createtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Createtime;
            (param[1] = new OracleParameter("p_deletedtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Deletedtime;
            (param[2] = new OracleParameter("p_deliveredtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Deliveredtime;
            (param[3] = new OracleParameter("p_downloadtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Downloadtime;
            (param[4] = new OracleParameter("p_msg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msg;
            (param[5] = new OracleParameter("p_msgid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msgid;
            (param[6] = new OracleParameter("p_msgstatus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _smsout.Msgstatus;
            (param[7] = new OracleParameter("p_msgtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msgtype;
            (param[8] = new OracleParameter("p_receivedtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Receivedtime;
            (param[9] = new OracleParameter("p_receiver", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Receiver;
            (param[10] = new OracleParameter("p_receiverphno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Receiverphno;
            (param[11] = new OracleParameter("p_refdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Refdocno;
            (param[12] = new OracleParameter("p_sender", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Sender;
            (param[13] = new OracleParameter("p_senderphno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Senderphno;
            (param[14] = new OracleParameter("p_seqno", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _smsout.Seqno;
            (param[15] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.comcode;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_savesmsout", CommandType.StoredProcedure, param);

            return _effect;
        }

        public List<InventoryAllocateDetails> GET_INR_STOCK_ALOC_DATA(InventoryAllocateDetails _obj)
        {
            List<InventoryAllocateDetails> _list = new List<InventoryAllocateDetails>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_isa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_com;
            (param[1] = new OracleParameter("p_isa_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_chnl;
            (param[2] = new OracleParameter("p_isa_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_loc;
            (param[3] = new OracleParameter("p_isa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_tp;
            (param[4] = new OracleParameter("p_isa_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_doc_tp;
            (param[5] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_cd;
            (param[6] = new OracleParameter("p_isa_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_stus;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Isa_itm_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_stock_aloc_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryAllocateDetails>(_dtResults, InventoryAllocateDetails.ConverterNew);
                }
            }
            return _list;
        }
        //Rukshan 04 Nov 2016
        public Int32 UpdateItemAllocationData(InventoryAllocateDetails _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_isa_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Isa_seq;
            (param[1] = new OracleParameter("p_isa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_com;
            (param[2] = new OracleParameter("p_isa_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_chnl;
            (param[3] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_cd;
            (param[4] = new OracleParameter("p_isa_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_stus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Isa_aloc_bqty;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_update_inr_stock_aloc", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Rukshan 17/02/2016
        public List<MasterLocationNew> GetMasterLocations(MasterLocationNew _loc)
        {
            List<MasterLocationNew> _list = new List<MasterLocationNew>();
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_Ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_com_cd;
            (param[1] = new OracleParameter("p_Ml_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_ope_cd;
            (param[2] = new OracleParameter("p_Ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_cd;
            (param[3] = new OracleParameter("p_Ml_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_act;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (string.IsNullOrEmpty(_loc.Ml_com_cd) && string.IsNullOrEmpty(_loc.Ml_loc_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("mst_loc", "pkg_general.sp_get_mst_loc_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<MasterLocationNew>(_dtResults, MasterLocationNew.Converter);
                }
            }
            return _list;
        }


        //Randima 17 Nov 2016
        public List<RecieptHeader> GetRecieptByRefDoc(string _com, string _refDocNo)
        {
            List<RecieptHeader> _list = new List<RecieptHeader>();
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refDocNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "SP_GET_REC_BY_REFDOC", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RecieptHeader>(_dtResults, RecieptHeader.ConvertTotalNew);
            }
            return _list;
        }

        //rUKSHAN 06 Jul 2016
        public List<SalesOrderItems> GETSOITEM(SalesOrderItems _obj)
        {
            List<SalesOrderItems> inr_res_det = new List<SalesOrderItems>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.SOI_SO_NO;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable tblData = QueryDataTable("tbl", "sp_get_inr_res_det", CommandType.StoredProcedure, false, param);
            DataTable tblData = QueryDataTable("tbl", "SP_GETSOITEM", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res_det = DataTableExtensions.ToGenericList<SalesOrderItems>(tblData, SalesOrderItems.Converter);
            }
            return inr_res_det;
        }

        public Int32 SaveProjectFGOD(ProductionFinGood _Item)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_spl_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_SEQ;
            (param[1] = new OracleParameter("p_spl_pro_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_PRO_NO;
            (param[2] = new OracleParameter("p_spl_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPF_LINE;
            (param[3] = new OracleParameter("p_spl_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_ITM;
            (param[4] = new OracleParameter("p_spl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPF_QTY;
            (param[5] = new OracleParameter("p_spl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPF_ACT;
            (param[6] = new OracleParameter("p_spl_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_ANAL_1;
            (param[7] = new OracleParameter("p_spl_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_ANAL_2;
            (param[8] = new OracleParameter("p_spl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Item.SPF_CRE_DT;
            (param[9] = new OracleParameter("p_spl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_CRE_BY;
            (param[10] = new OracleParameter("p_spl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Item.SPF_MOD_DT;
            (param[11] = new OracleParameter("p_spl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPF_MOD_BY;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.sp_save_satproFinGod", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveProjectLine(ProductionPlaneDetails _Item)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_spl_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPL_SEQ;
            (param[1] = new OracleParameter("p_spl_pro_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPL_PRO_NO;
            (param[2] = new OracleParameter("p_spl_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPL_LINE;
            (param[3] = new OracleParameter("p_spl_pro_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPL_PRO_LINE;
            (param[4] = new OracleParameter("p_spl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Item.SPL_QTY;
            (param[5] = new OracleParameter("p_spl_st_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Item.SPL_ST_DT;
            (param[6] = new OracleParameter("p_spl_en_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Item.SPL_EN_DT;
            (param[7] = new OracleParameter("p_spl_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPL_RMK;
            (param[8] = new OracleParameter("p_spl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Item.SPL_ACT;
            (param[9] = new OracleParameter("p_spl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Item.SPL_CRE_DT;
            (param[10] = new OracleParameter("p_spl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPL_CRE_BY;
            (param[11] = new OracleParameter("p_spl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Item.SPL_MOD_DT;
            (param[12] = new OracleParameter("p_spl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item.SPL_MOD_BY;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.sp_save_satproLine", CommandType.StoredProcedure, param);
            return effects;
        }


        //Rukshan 2016.11.26
        public List<InterCompanySalesParameter> GET_INTERCOM_PAR_BY_SUP(string Com, String sup)
        {
            List<InterCompanySalesParameter> _list = new List<InterCompanySalesParameter>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_SUP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sup;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_INTERCOM_PAR_BY_SUP", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InterCompanySalesParameter>(_tblData, InterCompanySalesParameter.Converter2);
            }
            return _list;
        }

        //Add by Akila 2016/11/23
        public DataTable GetLoyaltyPointSummaryForHPRevert(string accountNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("account_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            param[1] = new OracleParameter("pnt_summary", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_pntsummary_for_hprevert", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Add by Akila 2016/11/24 update sar_loty_crdmember
        public int UpdateLmMembers(string accountNo, string tranType, double pointAmt)
        {
            int _effectedCount = 0;

            OracleParameter[] _parameters = new OracleParameter[4];
            (_parameters[0] = new OracleParameter("account_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            (_parameters[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tranType;
            (_parameters[2] = new OracleParameter("point_amt", OracleDbType.Double, null, ParameterDirection.Input)).Value = pointAmt;

            _parameters[3] = new OracleParameter("o_effect ", OracleDbType.Int32, null, ParameterDirection.Output);

            _effectedCount = (Int32)UpdateRecords("sp_update_lm_members", CommandType.StoredProcedure, _parameters);

            return _effectedCount;
        }
        //Rukshan 08-DEC-2016
        public List<ProductionFinGood> GETFINGOD(string code)
        {
            List<ProductionFinGood> _list = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "pkg_search_inv.SP_SATFINGOD_DETAILS", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ProductionFinGood>(_tblData, ProductionFinGood.Converter);
            }
            return _list;
        }
        //Rukshan 08-DEC-2016
        public List<ProductionPlaneDetails> GETSATPROJ_LINE(string code)
        {
            List<ProductionPlaneDetails> _list = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "pkg_search_inv.SP_SATPROLINE_DETAILS", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ProductionPlaneDetails>(_tblData, ProductionPlaneDetails.Converter);
            }
            return _list;
        }
        //Rukshan 08-DEC-2016
        public decimal CHECK_CREDIT(string com, string _cus, int _period, DateTime _date, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            decimal _balnce = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[2] = new OracleParameter("p_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _period;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("pnt_summary", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_CHECK_CREDT", CommandType.StoredProcedure, false, param);
            if (_tblData != null)
            {
                if (_tblData.Rows.Count > 0)
                {
                    _balnce = Convert.ToDecimal(_tblData.Rows[0][0].ToString());
                }
            }
            return _balnce;
        }

        //Rukshan 08-DEC-2016
        public decimal CHECKPENDING_SOAPP(string com, string _cus, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            decimal _balnce = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("pnt_summary", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_CHECKPENDING_INV", CommandType.StoredProcedure, false, param);
            if (_tblData != null)
            {
                if (_tblData.Rows.Count > 0)
                {
                    _balnce = Convert.ToDecimal(_tblData.Rows[0][0].ToString());
                }
            }
            return _balnce;

        }

        public List<InventoryRequestItem> GETSOA_ITM(string _com, string _doc, string _itm)
        {
            List<InventoryRequestItem> _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GETSOAITEM", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_tblData, InventoryRequestItem.Converter);
            }
            return _list;
        }


        //Rukshan
        public DataTable SearchSalesOrderRequest(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string p_itr_req_no = null;
            string p_itr_bus_code = null;
            string p_itr_seq_no = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        p_itr_req_no = _searchText;
                        break;

                    case "CUSTOMER":
                        p_itr_bus_code = _searchText;
                        break;
                    case "SEQ NO":
                        p_itr_seq_no = _searchText;
                        break;
                    default:
                        break;
                }
            }
            p_itr_req_no = (p_itr_req_no != null) ? (p_itr_req_no.ToUpper() + "%") : null;
            p_itr_bus_code = (p_itr_bus_code != null) ? (p_itr_bus_code.ToUpper() + "%") : null;
            p_itr_seq_no = (p_itr_seq_no != null) ? (p_itr_seq_no.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_req_no;
            (param[3] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_bus_code;
            // (param[4] = new OracleParameter("p_itr_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_seq_no;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("INT_REQ", "pkg_search_inv.sp_getsorequest", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Randima 16 Dec 2016
        public List<SalesForecastingHeader> GET_SAR_FOR_HDR(string _com, string _calCd, string _pdCd)
        {
            List<SalesForecastingHeader> _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_sfh_cal_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _calCd;
            (param[1] = new OracleParameter("p_sfh_pd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pdCd;
            (param[2] = new OracleParameter("p_sfh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GET_SAR_FOR_HDR", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SalesForecastingHeader>(_tblData, SalesForecastingHeader.Converter);
            }
            return _list;
        }



        //Lakshan 2016 Aug 08
        public Int32 DeleteSalesForecastingDetail(SalesForecastingDetail _obj)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfd_seq;
            (param[1] = new OracleParameter("p_sfd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfd_line;
            (param[2] = new OracleParameter("p_sfd_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_itm;
            (param[3] = new OracleParameter("p_sfd_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_cat1;
            (param[4] = new OracleParameter("p_sfd_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_cat2;
            (param[5] = new OracleParameter("p_sfd_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_cat3;
            (param[6] = new OracleParameter("p_sfd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_model;
            (param[7] = new OracleParameter("p_sfd_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Sfd_brnd;
            (param[8] = new OracleParameter("p_sfd_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Sfd_qty;
            (param[9] = new OracleParameter("p_sfd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Sfd_val;
            (param[10] = new OracleParameter("p_sfd_gp", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Sfd_gp;
            (param[11] = new OracleParameter("p_sfd_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Sfd_act;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_delete_sar_for_det", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 27 Jul 2016
        public DataTable SearchSalesForecastingCalendarWithDate(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            code = (code != null) ? (code + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sfc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sfc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_sfc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sar_for_cal", "sp_ser_sar_for_cale_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }



        //Add by Akila 2016/12/20
        public DataTable GetAdvanReceiptSettings(string _CompanyCode, string _profitCenter, string _receiptType, string _subReceiptType, string _itemCategory = null)
        {
            DataTable _settings = new DataTable();
            try
            {
                OracleParameter[] _parametere = new OracleParameter[6];
                (_parametere[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompanyCode;
                (_parametere[1] = new OracleParameter("p_profCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
                (_parametere[2] = new OracleParameter("p_recTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptType;
                (_parametere[3] = new OracleParameter("p_subRecTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subReceiptType;
                (_parametere[4] = new OracleParameter("p_itemCategory", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCategory;

                _parametere[5] = new OracleParameter("sys_refcursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _settings = QueryDataTable("tbl_AdvanReceiptSettings", "sp_get_AdvanReciptSettings", CommandType.StoredProcedure, false, _parametere);
            }
            catch (Exception)
            {
                throw;
            }
            return _settings;
        }

        //Add by akila 2017/01/18
        public DataTable LoadHPSchemasNew(DateTime _date, string _comCode, string _location, string _item, string _priceBook, string _priceBookLevel)
        {
            DataTable _tblData = new DataTable();

            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("in_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
                (param[1] = new OracleParameter("in_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
                (param[2] = new OracleParameter("in_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
                (param[3] = new OracleParameter("in_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param[4] = new OracleParameter("in_Pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceBook;
                (param[5] = new OracleParameter("in_Pblevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceBookLevel;
                param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _tblData = QueryDataTable("HP_SCEMAS", "SP_GET_ACT_SCH_WEB_NEW", CommandType.StoredProcedure, false, param);

            }
            catch (Exception)
            {
                throw;
            }

            return _tblData;
        }

        // Add by ISURU 2017/03/06
        public DataTable GetCollectionDetails(string company, DateTime fromdate, DateTime todate, string saletype, string customer, string invoiceno, string userid)
        {
            DataTable _coldata = new DataTable();

            try
            {
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("P_FROM_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
                (param[2] = new OracleParameter("P_TO_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;

                (param[3] = new OracleParameter("P_SALESTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = saletype;
                (param[4] = new OracleParameter("P_CUSTOMER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
                (param[5] = new OracleParameter("P_INVOICENO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceno;
                (param[6] = new OracleParameter("P_USERID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _coldata = QueryDataTable("COLL_DATA", "SP_GET_COLLECTION_DETAILS", CommandType.StoredProcedure, false, param);

            }
            catch (Exception)
            {
                throw;
            }

            return _coldata;
        }
        public List<MasterAutoNumber> GetAutoNumberFor74(string _cateCode, string _startChar)
        {
            OracleParameter[] param = new OracleParameter[3];
            List<MasterAutoNumber> _list = new List<MasterAutoNumber>();

            (param[0] = new OracleParameter("p_aut_cate_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cateCode;
            (param[1] = new OracleParameter("p_aut_start_char", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startChar;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAuto", "sp_get_auto_num_for_74", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterAutoNumber>(_dtResults, MasterAutoNumber.ConvertTotal);
            }
            return _list;
        }

        //  Isuru 2017/03/17
        public List<mst_brnd_alloc> GetBrandManagerDet(string com, DateTime fdate, DateTime todate)
        {
            try
            {
                List<mst_brnd_alloc> brndmandet = new List<mst_brnd_alloc>();
                OracleParameter[] param = new OracleParameter[4];
                DataTable _dtResults = new DataTable();
                (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[1] = new OracleParameter("P_FRMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
                (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
                param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "SP_GET_BRANDMAN_DET", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    brndmandet = DataTableExtensions.ToGenericList<mst_brnd_alloc>(_dtResults, mst_brnd_alloc.Converter);
                }
                return brndmandet;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Isuru 2017/03/23

        public Int32 SavePrefixMasterDetails(sar_tp _PrefixList)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_srtp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList.srtp_cd;
            (param[1] = new OracleParameter("p_srtp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList.srtp_desc;
            (param[2] = new OracleParameter("p_srtp_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList.srtp_cate;
            (param[3] = new OracleParameter("p_is_main", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PrefixList.srtp_is_main;
            (param[4] = new OracleParameter("p_main_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList.srtp_main_tp;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_prefix_master_details", CommandType.StoredProcedure, param);
            return effects;
        }

        //Isuru 2017/03/24
        public Int32 SaveSunLedgerDetails(gnr_acc_sun_ledger _sunledgerlist1)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_comp;
            (param[1] = new OracleParameter("p_ledg_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_pc;
            (param[2] = new OracleParameter("p_ledg_sales_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_sales_tp;
            (param[3] = new OracleParameter("p_ledg_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_sub_tp;
            (param[4] = new OracleParameter("p_ledg_acc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_acc_tp;
            (param[5] = new OracleParameter("p_ledg_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_acc_cd;
            (param[6] = new OracleParameter("p_ledg_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunledgerlist1.ledg_desc;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_Sun_Ledger_details", CommandType.StoredProcedure, param);
            return effects;
        }

        //Isuru 2017/03/27
        public Int32 UpdatePrefixMasterDetails(sar_doc_price_defn _PrefixList1)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sadd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_com;
            (param[1] = new OracleParameter("p_sadd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_pc;
            (param[2] = new OracleParameter("p_sadd_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_doc_tp;
            (param[3] = new OracleParameter("p_sadd_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_prefix;
            (param[4] = new OracleParameter("p_sadd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_mod_by;
            (param[5] = new OracleParameter("p_sadd_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_mod_when;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_prefix_master", CommandType.StoredProcedure, param);
            return effects;
        }

        //Isuru 2017/03/27
        public DataTable CheckPrefixMasterDetails(sar_doc_price_defn _PrefixList1)
        {
            OracleParameter[] param = new OracleParameter[5];
            DataTable effects = new DataTable();

            (param[0] = new OracleParameter("p_sadd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_com;
            (param[1] = new OracleParameter("p_sadd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_pc;
            (param[2] = new OracleParameter("p_sadd_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_doc_tp;
            (param[3] = new OracleParameter("p_sadd_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PrefixList1.sadd_prefix;
            param[4] = new OracleParameter("o_effect", OracleDbType.RefCursor, null, ParameterDirection.Output);
            effects = QueryDataTable("tbl", "sp_check_prefix_master", CommandType.StoredProcedure, false, param);
            return effects;
        }
        //subodana 2017/04/08
        public List<sat_settl_discount> GetSettleDiscountDetails(string com, string pc, string invtype)
        {
            List<sat_settl_discount> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_INV_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invtype;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_SETTL_DISCOUNT", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<sat_settl_discount>(dtTemp, sat_settl_discount.Converter);
            }
            return oResult;
        }
        // subodana 2017-04-18
        public int UpdateCreditNoteADJ(string com, string pc, string invoice, decimal amo)
        {

            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("p_amo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = amo;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_creditnoteadj", CommandType.StoredProcedure, param);
            return effects;

        }
        //subodana 2017/04/21
        public List<sat_settl_discount> GetPanaltyDisDetails(string com, string pc, string invtype)
        {
            List<sat_settl_discount> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_INV_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invtype;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_SETTL_PANALTY", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<sat_settl_discount>(dtTemp, sat_settl_discount.Converter);
            }
            return oResult;
        }
        //Udaya 26/04/2017
        public Int32 BOQCanclation(string com, string loc, string boqNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("P_boqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = boqNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_BOQCanclation", CommandType.StoredProcedure, param);
            return effects;
        }
        //Udaya 27/04/2017
        public Int32 UpdateBOQsatProHdr(SatProjectHeader _BOQ)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[42];

            (param[0] = new OracleParameter("p_sph_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_SEQ;
            (param[1] = new OracleParameter("p_sph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM;
            (param[2] = new OracleParameter("p_sph_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PC;
            (param[3] = new OracleParameter("p_sph_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_NO;
            (param[4] = new OracleParameter("p_sph_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_DT;
            (param[5] = new OracleParameter("p_sph_oth_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_OTH_DT;
            (param[6] = new OracleParameter("p_sph_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_REF;
            (param[7] = new OracleParameter("p_sph_ex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_EX;
            (param[8] = new OracleParameter("p_sph_oth_ex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_OTH_EX;
            (param[9] = new OracleParameter("p_sph_est_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_EST_COST;
            (param[10] = new OracleParameter("p_sph_act_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_ACT_COST;
            (param[11] = new OracleParameter("p_sph_est_rev", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_EST_REV;
            (param[12] = new OracleParameter("p_sph_act_rev", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _BOQ.SPH_ACT_REV;
            (param[13] = new OracleParameter("p_sph_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_CD;
            (param[14] = new OracleParameter("p_sph_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_NAME;
            (param[15] = new OracleParameter("p_sph_cus_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_ADD1;
            (param[16] = new OracleParameter("p_sph_cus_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_ADD2;
            (param[17] = new OracleParameter("p_sph_cus_add3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CUS_ADD3;
            (param[18] = new OracleParameter("p_sph_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_RMK;
            (param[19] = new OracleParameter("p_sph_pro_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PRO_LOC;
            (param[20] = new OracleParameter("p_sph_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_LOC_DESC;
            (param[21] = new OracleParameter("p_sph_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PB;
            (param[22] = new OracleParameter("p_sph_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_PB_LVL;
            (param[23] = new OracleParameter("p_sph_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_CRE_BY;
            (param[24] = new OracleParameter("p_sph_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_CRE_DT;
            (param[25] = new OracleParameter("p_sph_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_MOD_BY;
            (param[26] = new OracleParameter("p_sph_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_MOD_DT;
            (param[27] = new OracleParameter("p_sph_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_APP_BY;
            (param[28] = new OracleParameter("p_sph_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_APP_DT;
            (param[29] = new OracleParameter("p_sph_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL1;
            (param[30] = new OracleParameter("p_sph_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL2;
            (param[31] = new OracleParameter("p_sph_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL3;
            (param[32] = new OracleParameter("p_sph_anal4", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL4;
            (param[33] = new OracleParameter("p_sph_anal5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL5;
            (param[34] = new OracleParameter("p_sph_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL6;
            (param[35] = new OracleParameter("p_sph_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL7;
            (param[36] = new OracleParameter("p_sph_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_ANAL8;
            (param[37] = new OracleParameter("p_sph_com_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM_BY;
            (param[38] = new OracleParameter("p_sph_com_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BOQ.SPH_COM_DT;
            (param[39] = new OracleParameter("p_sph_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOQ.SPH_STATUS;
            param[40] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            param[41] = new OracleParameter("o_seqNo", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_BOQsatpro", CommandType.StoredProcedure, param);
            return effects;
        }
        //Udaya 27/04/2017
        public DataTable SOACancleCheck(string itr_ref)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldataitr_ref", "sp_get_int_req", CommandType.StoredProcedure, false, param);
            //  DataTable dt = QueryDataTable("tbldataitr_ref", "sp_get_int_req_test", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //Dilshan 08/03/2018
        public DataTable SOACancleChecknew(string itr_ref, string invoiceno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_ref;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbldataitr_ref", "sp_get_int_req_new", CommandType.StoredProcedure, false, param);
            return dt;
        }


        //Isuru 2017/04/28
        public Int32 SavePluCreationDetails(mst_busentity_itm _pludetailslist)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_com;
            (param[1] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_cd;
            (param[2] = new OracleParameter("p_cus_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_tp;
            (param[3] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_itm_cd;
            (param[4] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_act;
            (param[5] = new OracleParameter("p_crt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_cre_by;
            (param[6] = new OracleParameter("p_crt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_cre_dt;
            (param[7] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_mod_by;
            (param[8] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_mod_dt;
            (param[9] = new OracleParameter("p_plu_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_plu_cd;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_plu_creation_details", CommandType.StoredProcedure, param);
            return effects;
        }
        //Udaya 29/04/2017
        public Int32 BOQCostDelete(string boqNo, int seqNo, int lineNo, string itemNo)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_boqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = boqNo;
            (param[1] = new OracleParameter("p_seqNo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = seqNo;
            (param[2] = new OracleParameter("p_lineNo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = lineNo;
            (param[3] = new OracleParameter("p_itemNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemNo;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_BOQCostDelete", CommandType.StoredProcedure, param);
            return effects;
        }
        //Add by Lakshan 29Apr2017
        public RecieptItem GET_SAT_RECIEPT_FOR_RETURN_CHK(string _refNo)
        {
            RecieptItem _list = new RecieptItem();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sard_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("RecieptItem", "sp_get_ret_chq_data_to_return", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RecieptItem>(dt, RecieptItem.ConvertTotal)[0];
            }
            return _list;
        }
        //Add by Lakshan 29Apr2017
        public Int32 Update_sat_hdr_for_chk_return(string _recNo, decimal _amunt)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_sah_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[1] = new OracleParameter("p_sah_anal_8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amunt;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_up_sat_hdr_by_rtn_chk", CommandType.StoredProcedure, param);
            return effects;
        }

        //  Isuru 2017/05/02
        public List<mst_busentity_itm> Getcustomerpluupdate(string com, string cuscode, string itmcode)
        {
            try
            {
                List<mst_busentity_itm> pluupdatedet = new List<mst_busentity_itm>();
                OracleParameter[] param = new OracleParameter[4];
                DataTable _dtResults = new DataTable();
                (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[1] = new OracleParameter("P_CUSCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cuscode;
                (param[2] = new OracleParameter("P_ITMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcode;
                param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "SP_GET_PLUVIEW_DET", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    pluupdatedet = DataTableExtensions.ToGenericList<mst_busentity_itm>(_dtResults, mst_busentity_itm.Converter);
                }
                return pluupdatedet;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Isuru 2017/05/02
        public Int32 UpdatePluCreationDetails(mst_busentity_itm _pludetailslist)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_com;
            (param[1] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_cd;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_itm_cd;
            (param[3] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_act;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_mod_by;
            (param[5] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_mod_dt;
            (param[6] = new OracleParameter("p_plu_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pludetailslist.mbii_plu_cd;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_plu_creation_details", CommandType.StoredProcedure, param);
            return effects;
        }
        //Subodana 2017-05-08
        public List<SALE_BAL_DETAILS> GetDOBalanceDetails(string com, DateTime fromdate, DateTime todate)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_BAL_DETAILS", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter);
            }
            return list;
        }
        public List<SALE_BAL_DETAILS> GetDOPCBalanceDetails(string com, DateTime fromdate, DateTime todate, string User)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_PC_BAL_DETAILS", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter);
            }
            return list;
        }
        public List<SALE_BAL_DETAILS> GetDOLocWiseData(string com, DateTime fromdate, DateTime todate, string Loccode, string Loctype, string PC)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loccode;
            (param[4] = new OracleParameter("P_PCINFOTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loctype;
            (param[5] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            param[6] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_DOLOC_DETAILS", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {

                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter);
            }
            return list;
        }
        public List<SALE_BAL_DETAILS> GetDOLocWiseDataInvDt(string com, DateTime fromdate, DateTime todate, string Loccode, string Loctype, string PC, DateTime Salefromdate, DateTime SalesTodate)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loccode;
            (param[4] = new OracleParameter("P_PCINFOTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loctype;
            (param[5] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            (param[6] = new OracleParameter("P_SFROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Salefromdate;
            (param[7] = new OracleParameter("P_STODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = SalesTodate;
            param[8] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_DOLOC_DETAILSINV", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {

                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter);
            }
            return list;
        }
        public List<SALE_BAL_DETAILS> GetDOLocWiseInvData(string com, DateTime fromdate, DateTime todate, string Loccode, string Loctype, string PC, string InvNo)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loccode;
            (param[4] = new OracleParameter("P_PCINFOTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loctype;
            (param[5] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            (param[6] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[7] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_DOINVDATA", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {

                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter2);
            }
            return list;
        }
        public List<SALE_BAL_DETAILS> GetDOLocWiseInvDataWithoutPC(string com, DateTime fromdate, DateTime todate, string Loccode, string Loctype, string PC, string InvNo)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loccode;
            (param[4] = new OracleParameter("P_PCINFOTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loctype;
            (param[5] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            (param[6] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[7] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_DOINVDATAWITHOUTPC", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {

                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter2);
            }
            return list;
        }
        public List<SALE_BAL_DETAILS> GetDODetailsFormonth(string com, DateTime fromdate, DateTime todate, string Loccode, string Loctype, string PC, string InvNo)
        {
            List<SALE_BAL_DETAILS> list = new List<SALE_BAL_DETAILS>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loccode;
            (param[4] = new OracleParameter("P_PCINFOTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loctype;
            (param[5] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            (param[6] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[7] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_DOINVFORMONTH", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {

                list = DataTableExtensions.ToGenericList<SALE_BAL_DETAILS>(_tblData, SALE_BAL_DETAILS.Converter2);
            }
            return list;
        }
        public List<DELI_SALE_NEW> GetTotInvForAllCom(string selectedcompany, string Channel, string BrandMngr, string Brand, string txtModel, string txtItem, DateTime frmDt, DateTime toDt, string filterby, string Category)
        {
            try
            {
                List<DELI_SALE_NEW> sales = new List<DELI_SALE_NEW>();
                OracleParameter[] param = new OracleParameter[23];
                param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt.Date;
                (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt.Date;
                (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtItem;
                (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
                (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtModel;
                (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Category;
                (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedcompany;
                (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 0;
                (param[20] = new OracleParameter("IN_CURRENCYTYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 0;
                (param[21] = new OracleParameter("IN_SALETYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 2;
                (param[22] = new OracleParameter("IN_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Channel;
                DataTable _dtResults = new DataTable(); ;

                _dtResults = QueryDataTable("tbl", "GET_FULL_COM_INV_DATA", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    sales = DataTableExtensions.ToGenericList<DELI_SALE_NEW>(_dtResults, DELI_SALE_NEW.Converter);
                }
                return sales;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public List<DELI_SALE_NEW> GetTotInvForPC(string selectedcompany, string Channel, string BrandMngr, string Brand, string txtModel, string txtItem, DateTime frmDt, DateTime toDt, string filterby, string Category, string User)
        {
            try
            {
                List<DELI_SALE_NEW> sales = new List<DELI_SALE_NEW>();
                OracleParameter[] param = new OracleParameter[23];
                param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt.Date;
                (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt.Date;
                (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtItem;
                (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
                (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtModel;
                (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Category;
                (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
                (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedcompany;
                (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 0;
                (param[20] = new OracleParameter("IN_CURRENCYTYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 0;
                (param[21] = new OracleParameter("IN_SALETYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 2;
                (param[22] = new OracleParameter("IN_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Channel;
                DataTable _dtResults = new DataTable(); ;

                _dtResults = QueryDataTable("tbl", "GET_PCWISE_INV_DATA", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    sales = DataTableExtensions.ToGenericList<DELI_SALE_NEW>(_dtResults, DELI_SALE_NEW.Converter);
                }
                return sales;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public List<DELI_SALE_NEW> GetTotInvForLocwise(string selectedcompany, string Channel, string BrandMngr, string Brand, string txtModel, string txtItem, DateTime frmDt, DateTime toDt, string filterby, string Category, string User, string loc, string loctype, string PC)
        {
            try
            {
                List<DELI_SALE_NEW> sales = new List<DELI_SALE_NEW>();
                OracleParameter[] param = new OracleParameter[24];
                param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt.Date;
                (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt.Date;
                (param[3] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[4] = new OracleParameter("IN_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[5] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtItem;
                (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
                (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtModel;
                (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Category;
                (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[12] = new OracleParameter("IN_PCENTER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[13] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
                (param[14] = new OracleParameter("IN_STKTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[15] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[16] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedcompany;
                (param[17] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
                (param[18] = new OracleParameter("IN_PROMOTOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
                (param[19] = new OracleParameter("in_freeIss", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 0;
                (param[20] = new OracleParameter("IN_CURRENCYTYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 0;
                (param[21] = new OracleParameter("IN_SALETYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = 2;
                (param[22] = new OracleParameter("IN_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
                (param[23] = new OracleParameter("PCINFOTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loctype;
                DataTable _dtResults = new DataTable(); ;

                _dtResults = QueryDataTable("tbl", "GET_INV_LOCWISE_DATA", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    sales = DataTableExtensions.ToGenericList<DELI_SALE_NEW>(_dtResults, DELI_SALE_NEW.Converter);
                }
                return sales;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Udaya 08/05/2017
        public SupplierWiseNBT GetSupplierNBT(string _company, string _suppCode)
        {
            SupplierWiseNBT _suppList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_suppCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _suppCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblsuppNBT", "sp_getSupplierNBT", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _suppList = DataTableExtensions.ToGenericList<SupplierWiseNBT>(_dtResults, SupplierWiseNBT.Converter)[0];
            return _suppList;
        }

        //Tharanga 2017/05/08
        public DataTable Get_SVID_VAL(string _p_svid_com, string _p_svid_pty_cd, string _p_svid_ins_tp, DateTime _fromDate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_svid_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _p_svid_com;
            (param[1] = new OracleParameter("p_svid_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _p_svid_pty_cd;
            (param[2] = new OracleParameter("p_svid_ins_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _p_svid_ins_tp;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable oDataTable = QueryDataTable("tbltransportcharge", "sp_get_SVID_VAL", CommandType.StoredProcedure, false, param);
            return oDataTable;

        }

        // Isuru 2017/05/16

        public DataTable getjobdetailsforjobinvoiceall(string jobnum)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_jobnum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobnum;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_jobdetails_forinvoice", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        //Isuru 2017
        public DataTable getmeasuredetails(string _itm)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_measure_det", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        //Isuru 2017/05/19
        public DataTable typedetails(string _invNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_type_details", CommandType.StoredProcedure, false, param);
            return _tblData;
        }



        //tharanga 2017/05/20
        public DataTable GetmaxCount_SCH_ALW_COM(string sch_tp)
        {
            DataTable _coldata = new DataTable();

            try
            {
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sch_tp;

                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _coldata = QueryDataTable("COLL_DATA", "sp_get_max_count", CommandType.StoredProcedure, false, param);

            }
            catch (Exception)
            {
                throw;
            }

            return _coldata;
        }


        //Tharanga 2017/05/20
        public Int32 Save_SCH_ALW_COM(SchemetypeCom _SchemetypeCom)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hsac_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_SCH_TP;
            (param[1] = new OracleParameter("p_hsac_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_LINE;
            (param[2] = new OracleParameter("p_hsac_sch_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_SCH_COM;
            (param[3] = new OracleParameter("p_hsac_act_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_ACT_STUS;
            (param[4] = new OracleParameter("p_hsac_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_CRE_BY;
            (param[5] = new OracleParameter("p_hsac_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_MOD_BY;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_sch_alw_compny", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharanga 2017/05/22
        public DataTable Get_SCH_ALW_COM(string sch_tp)
        {
            DataTable _coldata = new DataTable();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sch_tp;
            param[1] = new OracleParameter("p_code", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _coldata = QueryDataTable("COLL_DATA", "sp_getalwcmpny", CommandType.StoredProcedure, false, param);

            return _coldata;
        }

        public Int32 update_SCH_ALW_COM(SchemetypeCom _SchemetypeCom)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_hsac_sch_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_SCH_TP;
            (param[1] = new OracleParameter("p_hsac_sch_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_SCH_COM;
            (param[2] = new OracleParameter("p_hsac_act_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_ACT_STUS;
            (param[3] = new OracleParameter("p_hsac_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SchemetypeCom.HSAC_MOD_BY;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_update_sch_alw_compny", CommandType.StoredProcedure, param);
            return effects;
        }




        // ISURU 2017/05/22
        public DataTable getreturnchequedet(string company, DateTime fromdate, DateTime todate, string customer, string cheque, string accountcode, string grntxt, string userID)
        {
            DataTable _coldata = new DataTable();
            string sard_chq_bank_cd = string.Empty;
            try
            {
                OracleParameter[] param = new OracleParameter[9];
                (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("P_FROM_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
                (param[2] = new OracleParameter("P_TO_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
                (param[3] = new OracleParameter("P_CUSTOMER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
                (param[4] = new OracleParameter("P_CHEQUE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cheque;
                (param[5] = new OracleParameter("P_ACCCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountcode;
                (param[6] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = grntxt;
                (param[7] = new OracleParameter("P_USERID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userID;
                param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _coldata = QueryDataTable("COLL_DATA", "SP_GET_ACCOUNT_CODE_DETAILS", CommandType.StoredProcedure, false, param);
            }
            catch (Exception)
            {
                throw;
            }

            return _coldata;
        }
        //Tharanga 2017/May/25
        public DataTable GetSchemes_alw_com(string _type, string _code, string _com)
        {

            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tblscheme", "sp_getsch_alw_com", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Tharanga 2017/May/25
        public List<HpSchemeType> GetSchemeTypeByCat_com(string _cat, string _com)
        {

            List<HpSchemeType> _SchemeType = new List<HpSchemeType>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblschemetype = QueryDataTable("tblschemetype", "sp_getscheme_type_by_cat_com", CommandType.StoredProcedure, false, param);
            if (_tblschemetype.Rows.Count > 0)
            {
                _SchemeType = DataTableExtensions.ToGenericList<HpSchemeType>(_tblschemetype, HpSchemeType.Converter);
            }

            return _SchemeType;
        }


        //Isuru 2017/05/30
        public DataTable getcompanyforpanalty(string com)
        {
            DataTable _com = new DataTable();
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _com = QueryDataTable("tbl", "sp_get_company_panalty", CommandType.StoredProcedure, false, param);
            return _com;
        }
        public DataTable getsaleswithserial(string selectedcompany, string Channel, string Brand, string txtModel, string txtItem, DateTime fromdate, DateTime todate, string Category, string type, string pc, string itemcode, string txtCircular, string txtSchemeType, string txtSchemeCode, string txtPriceBook, string txtPriceLevel, string txtInvoiceType, string txtCustomer, string txtExecutive, string allreversal, string allfissue, string allicom)
        {
            DataTable _com = new DataTable();
            OracleParameter[] param = new OracleParameter[21];

            //(param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_selectedcompany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedcompany;
            (param[2] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Channel;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
            (param[4] = new OracleParameter("p_txtModel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtModel;
            (param[5] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate.Date;
            (param[6] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate.Date;
            (param[7] = new OracleParameter("p_category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Category;
            (param[8] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[9] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[10] = new OracleParameter("p_txtCircular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtCircular;
            (param[11] = new OracleParameter("p_txtSchemeType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtSchemeType;
            (param[12] = new OracleParameter("p_txtSchemeCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtSchemeCode;
            (param[13] = new OracleParameter("p_txtPriceBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtPriceBook;
            (param[14] = new OracleParameter("p_txtPriceLevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtPriceLevel;
            (param[15] = new OracleParameter("p_txtInvoiceType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtInvoiceType;
            (param[16] = new OracleParameter("p_txtCustomer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtCustomer;
            (param[17] = new OracleParameter("p_txtExecutive", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtExecutive;
            (param[18] = new OracleParameter("p_allreversal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allreversal;
            (param[19] = new OracleParameter("p_allfissue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allfissue;
            (param[20] = new OracleParameter("p_allicom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allicom;

            _com = QueryDataTable("tbl", "sp_get_salewithserial", CommandType.StoredProcedure, false, param);
            return _com;
        }

        public DataTable getsaleswithpayment(string selectedcompany, string Channel, string Brand, string txtModel, string txtItem, DateTime fromdate, DateTime todate, string Category, string type, string pc, string itemcode, string txtCircular, string txtSchemeType, string txtSchemeCode, string txtPriceBook, string txtPriceLevel, string txtInvoiceType, string txtCustomer, string txtExecutive, string allreversal, string allfissue, string allicom)
        {
            DataTable _com = new DataTable();
            OracleParameter[] param = new OracleParameter[21];

            //(param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_selectedcompany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = selectedcompany;
            (param[2] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Channel;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
            (param[4] = new OracleParameter("p_txtModel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtModel;
            (param[5] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate.Date;
            (param[6] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate.Date;
            (param[7] = new OracleParameter("p_category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Category;
            (param[8] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[9] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[10] = new OracleParameter("p_txtCircular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtCircular;
            (param[11] = new OracleParameter("p_txtSchemeType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtSchemeType;
            (param[12] = new OracleParameter("p_txtSchemeCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtSchemeCode;
            (param[13] = new OracleParameter("p_txtPriceBook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtPriceBook;
            (param[14] = new OracleParameter("p_txtPriceLevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtPriceLevel;
            (param[15] = new OracleParameter("p_txtInvoiceType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtInvoiceType;
            (param[16] = new OracleParameter("p_txtCustomer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtCustomer;
            (param[17] = new OracleParameter("p_txtExecutive", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txtExecutive;
            (param[18] = new OracleParameter("p_allreversal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allreversal;
            (param[19] = new OracleParameter("p_allfissue", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allfissue;
            (param[20] = new OracleParameter("p_allicom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allicom;


            _com = QueryDataTable("tbl", "sp_get_saleswithpayment_det", CommandType.StoredProcedure, false, param);
            return _com;
        }

        //Lakshan 01 Jun 2017
        public List<ImportsBLItems> GetBLItemByBlNo(ImportsBLHeader _obj)
        {// p_CustCD in NVARCHAR2,p_nic in NVARCHAR2,p_dl in NVARCHAR2,p_passport in NVARCHAR2,c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_bl_ref_no;
            (param[1] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "SP_BLITEM_DETAILS_BY_BL", CommandType.StoredProcedure, false, param);

            List<ImportsBLItems> bizEnt = new List<ImportsBLItems>();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<ImportsBLItems>(_dtResults, ImportsBLItems.ConverterCusdec);
            }
            return bizEnt;
        }

        //Tharanga 2017/06/07
        public DataTable get_sar_provou_tp(string com, string invNo)
        {
            DataTable _com = new DataTable();
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _com = QueryDataTable("tbl", "sp_get_sar_provou_tp", CommandType.StoredProcedure, false, param);
            return _com;
        }
        public DataTable executive_Sales_Target(string ProfitCenter, DateTime FromDate, DateTime ToDate, string circularCode, string EPF)
        {
            DataTable _ExTargetSales = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_FROM_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDate;
            (param[1] = new OracleParameter("P_TO_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[2] = new OracleParameter("P_CIRCULARCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularCode;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            (param[4] = new OracleParameter("P_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EPF;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _ExTargetSales = QueryDataTable("tblExSalesTarget", "SP_GET_SALES_TARGET_DETAILS", CommandType.StoredProcedure, false, param);
            return _ExTargetSales;
        }

        //Written By Tharanga on 2018/08/09
        public List<PriceSerialRef> GetEnquirySerialDetailwithLoc(string _profitcenter, int _startFrom, int _endFrom, string _user, string _company, string _book, string _level, string _item, DateTime _fromDate, DateTime _toDate, string _customer, string _category1, string _category2, string _category3, string _type, string _circular, int _isWithHistory, int _isasat, int _isSuperUser, string _loc)
        {
            List<PriceSerialRef> _priceDetailRef = new List<PriceSerialRef>();
            //sp_getpriceenquiryserialdetail(p_user in NVARCHAR2, p_com in NVARCHAR2,p_book in NVARCHAR2,p_level in NVARCHAR2,p_item in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,
            //p_customer in NVARCHAR2,p_cat1 in NVARCHAR2,p_cat2 in NVARCHAR2,p_cat3 in NVARCHAR2,p_type in NVARCHAR2,p_circulerno in NVARCHAR2,p_isasathistory in NUMBER,p_ishistory in NUMBER,p_issuperuser in NUMBER,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[3] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[8] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category1;
            (param[9] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category2;
            (param[10] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category3;
            (param[11] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[12] = new OracleParameter("p_circulerno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[13] = new OracleParameter("p_isasathistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isasat;
            (param[14] = new OracleParameter("p_iswithhistory", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isWithHistory;
            (param[15] = new OracleParameter("p_issuperuser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSuperUser;
            (param[16] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[17] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[18] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceDetail = QueryDataTable("tblPriceDetail", "sp_getpriceenquiryserialdetail", CommandType.StoredProcedure, false, _startFrom, _endFrom, param);
            if (_tblPriceDetail.Rows.Count > 0)
            {
                _priceDetailRef = DataTableExtensions.ToGenericList<PriceSerialRef>(_tblPriceDetail, PriceSerialRef.ConvertForPriceEnquirynew);
            }

            return _priceDetailRef;

        }
        // add by tharanga 2017/08/29
        public DataTable getrootDesc(string _Com, string _route)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("P_RROTCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ROOT_DET", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        // add by tharanga 2017/08/30

        public List<InvoiceItem> Getref_doc_items(string _invoice)
        {
            List<InvoiceItem> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "sp_getref_doc_items", CommandType.StoredProcedure, false, param);
            if (tbl.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceItem>(tbl, InvoiceItem.ConvertInvoiceItemForReversal);
            }
            return _list;
        }
        //Added By Udaya 07.09.2017
        public Int32 SupplierNBT(SupplierWiseNBT _NBTDetails)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            decimal _act = 0;
            if (_NBTDetails.MBIT_ACT == true)
            {
                _act = 1;
            }
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_COM;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_CD;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_TP;
            (param[3] = new OracleParameter("p_tax_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_TAX_CD;
            (param[4] = new OracleParameter("p_tax_rt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_TAX_RT_CD;
            (param[5] = new OracleParameter("p_tax_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_TAX_RT;
            (param[6] = new OracleParameter("p_act", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _act;
            (param[7] = new OracleParameter("p_effect_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_EFFCT_DT;
            (param[8] = new OracleParameter("p_div_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_DIV_RT;
            (param[9] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_CRE_BY;
            (param[10] = new OracleParameter("p_cre_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_CRE_DT;
            (param[11] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_MOD_BY;
            (param[12] = new OracleParameter("p_mod_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _NBTDetails.MBIT_MOD_DT;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_supplier_NBT", CommandType.StoredProcedure, param);
            return effects;
        }
        //add by tharanga 2017/09/04
        public DataTable getinvshed_item(string _Com, string _loc, string _inv)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tbl", "sp_getinvsheduleeitem", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //Akila 2017/10/11
        public Int16 SaveCctTransLog(CctTransLog _transLog)
        {
            OracleParameter[] param = new OracleParameter[22];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_ictl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_com_code;
            (param[1] = new OracleParameter("p_sctl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_pc;
            (param[2] = new OracleParameter("p_ictl_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_cus_name;
            (param[3] = new OracleParameter("p_ictl_crd_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_crd_no;
            (param[4] = new OracleParameter("p_ictl_crd_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_crd_tp;
            (param[5] = new OracleParameter("p_ictl_app_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _transLog.Sctl_app_amt;
            (param[6] = new OracleParameter("p_ictl_bnk_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_bnk_cd;
            (param[7] = new OracleParameter("p_ictl_app_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_app_cd;
            (param[8] = new OracleParameter("p_ictl_rrn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_rrn;
            (param[9] = new OracleParameter("p_ictl_tran_trace", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_trans_trace;
            (param[10] = new OracleParameter("p_ictl_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_batch_no;
            (param[11] = new OracleParameter("p_ictl_host_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_host_no;
            (param[12] = new OracleParameter("p_ictl_ter_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_termianl_id;
            (param[13] = new OracleParameter("p_ictl_merch_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_mer_id;
            (param[14] = new OracleParameter("p_ictl_aid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_aid;
            (param[15] = new OracleParameter("p_ictl_tc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_trans_crypto;
            (param[16] = new OracleParameter("p_ictl_trn_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_trans_seq;
            (param[17] = new OracleParameter("p_sctl_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_Inv_no;
            (param[18] = new OracleParameter("p_ictl_is_processed", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _transLog.Sctl_is_processed;
            (param[19] = new OracleParameter("p_ictl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_cre_by;
            (param[20] = new OracleParameter("p_ictl_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_session_id;
            param[21] = new OracleParameter("O_Effects", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_SAT_CCT_TRANS_LOG", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateCctTransLog(CctTransLog _transLog)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_com_code;
            (param[1] = new OracleParameter("p_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_pc;
            (param[2] = new OracleParameter("p_CardNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_crd_no;
            (param[3] = new OracleParameter("p_TranNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_trans_trace;
            (param[4] = new OracleParameter("p_TranSeqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_trans_seq;
            (param[5] = new OracleParameter("p_InvNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transLog.Sctl_Inv_no;
            (param[6] = new OracleParameter("p_IsProcessed", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _transLog.Sctl_is_processed;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_SAT_CCT_TRANS_LOG", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetInv_SOA_SO(string _inv, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblSOA", "sp_GetInv_SOA_SO", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Bank_Reconciliation_Summery_Rpt(DateTime _Asatdate, string _accountNo) // Added by Chathura on 20-oct-2017
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_as_at_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Asatdate;
            (param[1] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_RPT_BANK_RECON_SUMMERY", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable RealizationStatusReport(string _reportType, string _accountNo, DateTime _fromDate, DateTime _toDate, string _profitCenter) // Added by Chathura on 20-oct-2017
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_reptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reportType;
            (param[1] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountNo;
            (param[2] = new OracleParameter("p_frmdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_realization_status_report", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable RemitanceControlReconReport(string _pc, string _com, DateTime _asatdate, int _isasat, DateTime _fromdate, DateTime _todate, string _user) // Added by Chathura on 24-oct-2017
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[3] = new OracleParameter("p_isasat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isasat;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_remittance_recon_report", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //by akila 2017/10/26
        public int SaveCustomerSalesTypesNew(MasterBusinessEntitySalesType _sales)
        {
            OracleParameter[] param = new OracleParameter[12];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_mbsa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_com;
            (param[1] = new OracleParameter("p_mbsa_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_cd;
            (param[2] = new OracleParameter("p_mbsa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_tp;
            (param[3] = new OracleParameter("p_mbsa_sa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_sa_tp;
            (param[4] = new OracleParameter("p_mbsa_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sales.Mbsa_act;
            (param[5] = new OracleParameter("p_mbsa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_cre_by;
            (param[6] = new OracleParameter("p_mbsa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_cre_dt;
            (param[7] = new OracleParameter("p_mbsa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales.Mbsa_mod_by;
            (param[8] = new OracleParameter("p_mbsa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_mod_dt;
            (param[9] = new OracleParameter("p_mbsa_valid_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_valid_frm_dt;
            (param[10] = new OracleParameter("p_mbsa_valid_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _sales.Mbsa_valid_to_dt;

            param[11] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_busenty_sal_type_new", CommandType.StoredProcedure, param);
            return effects;

        }

        //Akila 2017/10/26
        public DataTable GetCustomerAllowInvoiceTypeNew(string _company, string _customer)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblCustomer", "sp_customerinvoicetype_New", CommandType.StoredProcedure, false, param);

        }

        //akila 2017/10/26
        public DataTable GetCustomerInvoiceBalance(string _comCode, string _custCode, string _invType)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            (param[2] = new OracleParameter("p_invType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invType;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("BalanceAmt", "SP_GET_CUST_INV_BALANCE", CommandType.StoredProcedure, false, param);
        }


        public List<ReceiptItemDetails> ReceiptItemDetailsNew(string _invNo)
        {
            List<ReceiptItemDetails> _list = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getreceiptiteDet_new", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ReceiptItemDetails>(_tblData, ReceiptItemDetails.ConverterNewT);
            }
            return _list;
        }
        public int updatereceiptDetnew(Int32 p_sari_seq_no, string p_sari_rec_no, string p_sari_item, Decimal p_sari_qty)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_sari_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_sari_seq_no;
            (param[1] = new OracleParameter("p_sari_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sari_rec_no;
            (param[2] = new OracleParameter("p_sari_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sari_item;
            (param[3] = new OracleParameter("p_sari_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_sari_qty;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updatereceiptDetnew", CommandType.StoredProcedure, param);
            return effects;

        }
        public DataTable processMovementSubtypeReport(string compString, int hasMultiComp, string docType, string docSubType, DateTime fromDate, DateTime toDate, string userName) // Added by Chathura on 09-nov-2017
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_companystring", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = compString;
            (param[1] = new OracleParameter("p_hasmulticompany", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hasMultiComp;
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docType;
            (param[3] = new OracleParameter("p_docsubtypestring", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docSubType;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_movement_sub_summary_report", CommandType.StoredProcedure, false, param);

            return _dtResults;

        }


        public DataTable getExpireNumberofDateConf(string location, string com)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "CURSREQ";
                return QueryDataTable("tbl", "SP_GET_CUSRESERVEXPLIMIT", CommandType.StoredProcedure, false, param);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Pemil 2015-08-22
        public INR_RES GetReservationApprovalNew(string req_no)
        {
            INR_RES inr_res = new INR_RES();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblData = QueryDataTable("tbl", "PKG_SALES.SP_SELECT_INR_RES", CommandType.StoredProcedure, false, param);
            if (tblData.Rows.Count > 0)
            {
                inr_res = DataTableExtensions.ToGenericList<INR_RES>(tblData, INR_RES.ConverterNewN)[0];
            }
            return inr_res;
        }

        //by akial 2017/11/13
        public DataTable GetExchangeRequestBySerail(string _ser, Int32 _isinv)
        {
            DataTable _requests = new DataTable();

            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (_para[1] = new OracleParameter("p_is_inv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isinv;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _requests = QueryDataTable("tblItem", "sp_is_exchange_req_new", CommandType.StoredProcedure, false, _para);

            return _requests;
        }
        //subodana
        public decimal GetResQty(String sino, Int32 siline)
        {
            decimal qty = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_si_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            (param[1] = new OracleParameter("p_si_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = siline;
            param[2] = new OracleParameter("o_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("dt", "sp_validrestobondqty", CommandType.StoredProcedure, false, param);
            if (dtTemp != null && dtTemp.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(dtTemp.Rows[0][0].ToString()))
                {
                    qty = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                }
            }
            return qty;
        }
        public DataTable GetBrandManager(string _com)
        {
            DataTable _requests = new DataTable();

            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            //(_para[1] = new OracleParameter("p_is_inv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isinv;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _requests = QueryDataTable("tblItem", "get_allemployee", CommandType.StoredProcedure, false, _para);

            return _requests;
        }
        public Int32 SAVE_SAR_PB_CIREFFECT(SAR_PB_CIREFFECT _SAR_PB_CIREFFECT)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_spc_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_circular;
            (param[1] = new OracleParameter("p_spc_est_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_est_qty;
            (param[2] = new OracleParameter("p_spc_est_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_est_val;
            (param[3] = new OracleParameter("p_spc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_cre_by;
            (param[4] = new OracleParameter("p_spc_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_mod_by;
            (param[5] = new OracleParameter("p_spc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_act;
            (param[6] = new OracleParameter("p_spc_brand_mngr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.SPC_BRAND_MNGR;
            (param[7] = new OracleParameter("p_spc_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SAR_PB_CIREFFECT.spc_session;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_SAR_PB_CIREFFECT", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<SAR_PB_CIREFFECT> get_SAR_PB_CIREFFECT(string spc_circular, Int32 spc_act)
        {
            DataTable _tblData = new DataTable();
            List<SAR_PB_CIREFFECT> _list = null;
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_spc_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = spc_circular;
            (_para[1] = new OracleParameter("p_spc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = spc_act;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _tblData = QueryDataTable("tblItem", "get_SAR_PB_CIREFFECT", CommandType.StoredProcedure, false, _para);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SAR_PB_CIREFFECT>(_tblData, SAR_PB_CIREFFECT.Converter);
            }
            return _list;

        }

        //Tharindu 2017-11-21
        public bool GetLoyalityExistsStatus(string _cardtype, string _cardref)
        {
            bool result = false;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("card_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardtype;
            (param[1] = new OracleParameter("card_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_check_loyalitycard_exists", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                result = false;
            }
            else
            {
                result = true;
            }
            return result;

        }

        //Tharindu 2017-12-18
        //public Int32 UpdateLoyalityStatus(string _cardtype, string _cardref, string createuser)
        //{
        //    Int32 effects = 0;

        //    OracleParameter[] param = new OracleParameter[4];
        //    (param[0] = new OracleParameter("card_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardtype;
        //    (param[1] = new OracleParameter("card_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardref;
        //    (param[2] = new OracleParameter("create_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createuser;
        //    param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

        //    effects = (Int32)UpdateRecords("sp_update_loyality_status", CommandType.StoredProcedure, param);
        //    return effects;

        //}
        public int UpdateINR_RESExpDate(INR_RES inr_res)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                Int16 effects = 0;
                (param[0] = new OracleParameter("p_resno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_RES_NO;
                (param[1] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_COM;
                (param[2] = new OracleParameter("p_EXPDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_EXPTED_DT;
                (param[3] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_BY;
                (param[4] = new OracleParameter("p_sessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_SESSION;
                (param[5] = new OracleParameter("p_moddt", OracleDbType.Date, null, ParameterDirection.Input)).Value = inr_res.IRS_MOD_DT;
                param[6] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_RESERVATIONEXPDT", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public Int32 Update_price_def_EST(PriceDetailRef _PriceDetailRef)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sapd_pb_tp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_pb_tp_cd;
            (param[1] = new OracleParameter("p_sapd_pbk_lvl_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_pbk_lvl_cd;
            (param[2] = new OracleParameter("p_sapd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_seq_no;
            (param[3] = new OracleParameter("p_sapd_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_itm_cd;
            (param[4] = new OracleParameter("p_sapd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_model;
            (param[5] = new OracleParameter("p_sapd_est_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PriceDetailRef.SAPD_EST_QTY;
            (param[6] = new OracleParameter("p_sapd_est_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PriceDetailRef.SAPD_EST_VAL;
            (param[7] = new OracleParameter("p_sapd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_mod_by;
            (param[8] = new OracleParameter("p_sapd_circular_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PriceDetailRef.Sapd_circular_no;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("update_price_def_EST", CommandType.StoredProcedure, param);
            return effects;
        }

        //subodana 2017-12-11
        public Int32 SaveAddttionalCustomers(mst_busentity_add_cus _addcus)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_mbac_master_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addcus.mbac_master_cd;
            (param[1] = new OracleParameter("p_mbac_add_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addcus.mbac_add_cd;
            (param[2] = new OracleParameter("p_mbac_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addcus.mbac_com;
            (param[3] = new OracleParameter("p_mbac_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _addcus.mbac_act;
            (param[4] = new OracleParameter("p_mbac_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addcus.mbac_anal2;
            (param[5] = new OracleParameter("p_mbac_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addcus.mbac_anal2;
            (param[6] = new OracleParameter("p_mbac_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _addcus.mbac_cre_dt;
            (param[7] = new OracleParameter("p_mbac_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _addcus.mbac_cre_by;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_add_customer", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana
        public Int32 deleteCustAddicodes(string _mastercode, string _subcode)
        {
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mastercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mastercode;
            (param[1] = new OracleParameter("p_subcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subcode;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_del_add_customer", CommandType.StoredProcedure, param);
            return _effect;
        }
        public List<mst_busentity_add_cus> GetAddtinalCusCodes(string Mastercode)
        {
            DataTable _tblData = new DataTable();
            List<mst_busentity_add_cus> _list = null;
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_mastercd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mastercode;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _tblData = QueryDataTable("tblItem", "Sp_Get_addi_customers", CommandType.StoredProcedure, false, _para);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<mst_busentity_add_cus>(_tblData, mst_busentity_add_cus.Converter);
            }
            return _list;

        }
        public DataTable get_quo_to_inv(string _company, DateTime _fromDate, DateTime _toDate, string _doNo, string _sts, string _pc)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_do_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[4] = new OracleParameter("p_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sts;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _invoiceDT = QueryDataTable("tblPendInvoices", "sp_get_quo", CommandType.StoredProcedure, false, param);
            return _invoiceDT;
        }

        //Add by lakshan 20Dec2017
        public List<InvoiceHeader> ChkInvoiceAvailableForSalesOredr(string _soNo)
        {
            DataTable _dt = new DataTable();
            List<InvoiceHeader> _list = new List<InvoiceHeader>();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_sah_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _soNo;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dt = QueryDataTable("sat_hdr", "sp_chk_sat_hdr_doc_ava_for_so", CommandType.StoredProcedure, false, _para);
            if (_dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceHeader>(_dt, InvoiceHeader.ConvertTotal);
            }
            return _list;
        }
        public Int32 SaveCustomerPriorityLevel_jonentry(MST_BUSPRIT_LVL _busPritLvl)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0; ;

            (param[0] = new OracleParameter("p_MBL_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_cd;
            (param[1] = new OracleParameter("p_MBL_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_com;
            (param[2] = new OracleParameter("p_MBL_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_pty_tp;
            (param[3] = new OracleParameter("p_MBL_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_pty_cd;
            (param[4] = new OracleParameter("p_MBL_PRIT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_prit_cd;
            (param[5] = new OracleParameter("p_MBL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_act;
            (param[6] = new OracleParameter("p_MBL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_cre_by;
            (param[7] = new OracleParameter("p_MBL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_cre_dt;
            (param[8] = new OracleParameter("p_MBL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_mod_by;
            (param[9] = new OracleParameter("p_MBL_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _busPritLvl.Mbl_mod_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_upd_custprlvl_jobentry", CommandType.StoredProcedure, param);
            return effects;
        }

        //Akila 2018/01/08
        public DataTable GetSalesDetailsWithDo(string _doNumber, string _refNumber, string _acc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNumber;
            (param[1] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNumber;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_sales_details_new", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Akila 2018/01/09
        public Int32 GetSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getserialid", CommandType.StoredProcedure, param);
            return effects;
        }
        public bool check_sat_qty_inv_balance(string p_job_no, string p_com, string p_loc, string p_pc)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_job_no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_check_sat_qty_inv_balance", CommandType.StoredProcedure, false, param);
            bool ser = false;
            decimal sad_qty = 0;
            decimal inb_qty = 0;

            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                if (_dtResults.Rows[0][0] != DBNull.Value && _dtResults.Rows[0][1] != DBNull.Value)
                {
                    sad_qty = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
                    inb_qty = Convert.ToDecimal(_dtResults.Rows[0][1].ToString());
                }

                if (sad_qty == inb_qty)
                {
                    ser = true;
                }
            }
            return ser;
        }


        public DataTable sat_qty_inv_balance(string p_job_no, string p_com, string p_loc, string p_pc)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_job_no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_check_sat_qty_inv_balance", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetRever_balance(string _doc)
        {
            //sp_getrevertreleasedetail(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getrevert_balans", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public DataTable get_val_cust_excahge(string _invNo, Decimal _amount)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amount;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_val_cust_excahge", CommandType.StoredProcedure, false, param);
            return _tblData;

        }


        //Akila 2018/01/31
        public List<EventRegistry> GetEventDetById(string _eventId)
        {
            DataTable _dt = new DataTable();
            List<EventRegistry> _list = new List<EventRegistry>();

            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_EventId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventId;
            _para[1] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dt = QueryDataTable("Event_Details", "SP_GET_EVENT_DET_BY_ID", CommandType.StoredProcedure, false, _para);
            if (_dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<EventRegistry>(_dt, EventRegistry.Converter);
            }
            return _list;
        }

        //Akila 2018/01/31
        public List<EventItems> GetEventItemsByEventId(string _eventId)
        {
            DataTable _dt = new DataTable();
            List<EventItems> _list = new List<EventItems>();

            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_eventCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventId;
            _para[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dt = QueryDataTable("Active_Event_Items", "SP_GET_ACTIVE_EVE_ITEM", CommandType.StoredProcedure, false, _para);
            if (_dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<EventItems>(_dt, EventItems.Converter);
            }
            return _list;
        }

        //Akila 2018/02/23
        public DataTable GetInvoiceDetailsInSCM2(string _invNo, string _item, Int32 _lineNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tbl", "SP_GET_INV_DET_IN_SCM2", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable GetInvoicecom_item_details(string _invNo, string _prom_cd, string _com)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("P_PROM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prom_cd;
            (param[2] = new OracleParameter("P_COM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _com;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tbl", "GET_INV_DET_COMITEM", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharindu 2018-03-02
        public DataTable GetRequestdetails(string _basedoc)
        {
            //sp_getrevertreleasedetail(p_account in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_basedoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _basedoc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_reqdetails", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        public DataTable get_inv_type(string _P_MAIN_TP, string _P_MAIN_CD)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_MAIN_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _P_MAIN_TP;
            (param[1] = new OracleParameter("P_MAIN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _P_MAIN_CD;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "SP_GET_INV_TYPE_BY_CODE", CommandType.StoredProcedure, false, param);
            return _tblData;

        }

        public List<RequestApprovalDetail> GET_EXCHANGE_REC_DET(string _ref)
        {
            List<RequestApprovalDetail> req = new List<RequestApprovalDetail>();
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_GRAD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_EXCHANGE_REC_DET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                req = DataTableExtensions.ToGenericList<RequestApprovalDetail>(_dtResults, RequestApprovalDetail.Converter);
            }

            return req;
        }
        //Akila 2018/02/06
        public Int16 UpdateEventHdrStatus(EventRegistry _event)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_sere_eve_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _event.SERE_EVE_CD;
            (param[1] = new OracleParameter("p_sere_update", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _event.SERE_UPDATE;
            (param[2] = new OracleParameter("p_sere_update_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _event.SERE_UPDATE_BY;
            (param[3] = new OracleParameter("p_sere_update_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _event.SERE_UPDATE_SESSION;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_EVENT_REG_STUS", CommandType.StoredProcedure, param);
            return effects;
        }

        //Akila 2018/02/06
        public Int16 UpdateEventItemQty(EventItems _eventItem)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_sere_eve_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventItem.SERE_EVE_CD;
            (param[1] = new OracleParameter("p_sere_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventItem.SERE_ITM_CD;
            (param[2] = new OracleParameter("p_sere_itm_sold", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _eventItem.SelectedQty;
            (param[3] = new OracleParameter("p_sere_update", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _eventItem.SERE_UPDATE;
            (param[4] = new OracleParameter("p_sere_update_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventItem.SERE_UPDATE_BY;
            (param[5] = new OracleParameter("p_sere_update_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventItem.SERE_UPDATE_SESSION;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_EVENT_ITM_QTY", CommandType.StoredProcedure, param);
            return effects;
        }

        //Akila 2018/02/14
        public Int16 SaveInvoicedEventItems(InvoicedEventItems _invItems)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_sere_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invItems.SERE_ID;
            (param[1] = new OracleParameter("p_sere_eve_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_EVE_CD;
            (param[2] = new OracleParameter("p_sere_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invItems.SERE_LINE;
            (param[3] = new OracleParameter("p_sere_eveinvc_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invItems.SERE_EVEINVC_LINE;
            (param[4] = new OracleParameter("p_sere_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_ITM_CD;
            (param[5] = new OracleParameter("p_sere_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_COM;
            (param[6] = new OracleParameter("p_sere_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_PC;
            (param[7] = new OracleParameter("p_sere_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_INVC_NO;
            (param[8] = new OracleParameter("p_sere_invc_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_INVC_LINE;
            (param[9] = new OracleParameter("p_sere_invc_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invItems.SERE_INVC_QTY;
            (param[10] = new OracleParameter("p_sere_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_CRE_BY;
            (param[11] = new OracleParameter("p_sere_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invItems.SERE_CRE_SESSION;
            (param[12] = new OracleParameter("p_sere_is_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invItems.SERE_IS_ACT;

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_SAT_INVEVE_ITM", CommandType.StoredProcedure, param);
            return effects;
        }

        //Akila 2018/02/14
        public List<InvoicedEventItems> GetInvoiceEventItems(string _invNo)
        {
            DataTable _dt = new DataTable();

            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_InvNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            _para[1] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dt = QueryDataTable("Invoice_Event_Items", "SP_GET_INVEVE_ITM", CommandType.StoredProcedure, false, _para);

            List<InvoicedEventItems> _list = new List<InvoicedEventItems>();
            if (_dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoicedEventItems>(_dt, InvoicedEventItems.Converter);
            }
            return _list;
        }

        public Int16 UpdateInvoiceEventItems(string _invNo, string _eventId)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_InvNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_EventId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eventId;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_INVOICE_EVEDET", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharindu 2018-03-12
        public DataTable GetSCMInvoice2(string _company, string _customer, string _item)
        {
            //sp_getcustomerinvoice(p_com in NVARCHAR2,p_customer in NVARCHAR2,p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable dt = QueryDataTable("tbl", "sp_getcustomerinvoice", CommandType.StoredProcedure, false, param);

            DataTable dt = QueryDataTable("tbl", "sp_getcustomerinvoice_scm2", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharindu 2018-03-16
        public DataTable Getsupplierinvoicedetails(string _company, string _docNo)
        {
            // Sanjeewa 22-04-2017
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "Getsupplierinvoicedetails", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public Int32 updateToMasterPcWiseMid(List<Deposit_Bank_Pc_wise> lst_master_mid)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in lst_master_mid)
            {
                OracleParameter[] param = new OracleParameter[19];

                (param[0] = new OracleParameter("p_MPM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_MPM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[2] = new OracleParameter("p_MPM_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.From_date;
                (param[3] = new OracleParameter("p_MPM_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.To_date;
                (param[4] = new OracleParameter("p_MPM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Pun_tp;
                (param[5] = new OracleParameter("p_MPM_TERM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Period;
                (param[6] = new OracleParameter("p_MPM_MID_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mid_no;
                (param[7] = new OracleParameter("p_MPM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Create_by;
                (param[8] = new OracleParameter("p_MPM_BNK_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itemDetails.Bankcharge;
                (param[9] = new OracleParameter("p_MPM_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_pb;
                (param[10] = new OracleParameter("p_MPM_PB_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_pblvl;
                (param[11] = new OracleParameter("p_MPM_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_brand;
                (param[12] = new OracleParameter("p_MPM_MAIN_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_maincat;
                (param[13] = new OracleParameter("p_MPM_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_cat;
                (param[14] = new OracleParameter("p_MPM_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_item;
                (param[15] = new OracleParameter("p_MPM_PROMO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Mpm_promo;
                (param[16] = new OracleParameter("p_from_date_update", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails._from_date_update;
                (param[17] = new OracleParameter("p_to_date_update", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails._to_date_update;

                param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_UPDATE_MST_PC_MID", CommandType.StoredProcedure, param);

            }

            return effects;
        }
        public List<ReceiptItemDetails> GetAdvanReceiptdet_frominvoice(string _recNo)
        {
            List<ReceiptItemDetails> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_receiptitemdetails_frminv", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<ReceiptItemDetails>(tblDet, ReceiptItemDetails.ConverterNew);
            }

            return _returnLst;
        }

        //Tharindu
        public DataTable getcustomermobno(string p_com, string p_mobile, string p_type)
        {
            //CREATE OR REPLACE PROCEDURE sp_checkdocumentusage (p_com in NVARCHAR2,p_document in NVARCHAR2,c_data out sys_refcursor) is

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mobile;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tbl = QueryDataTable("tbl", "sp_get_cusmobileno", CommandType.StoredProcedure, false, param);
            return tbl;


        }

        //Wimal 03/05/2018
        public List<InterCompanySalesParameter> GET_INTERCOM_PAR_BY_SUP_PO(string Com, String sup)
        {
            List<InterCompanySalesParameter> _list = new List<InterCompanySalesParameter>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_SUP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sup;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "SP_GET_INTERCOM_PAR_BY_SUP_PO", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InterCompanySalesParameter>(_tblData, InterCompanySalesParameter.Converter2);
            }
            return _list;
        }

        // Tharindu 2018-05-09
        public Int32 GetCusCreationDummyNo()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            param[0] = new OracleParameter("n_cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_cus_dummy_seq", CommandType.StoredProcedure, false, param);
            //   return _tblData;

            try
            {
                if (_tblData.Rows.Count > 0)
                {
                    effects = Convert.ToInt32(_tblData.Rows[0]["NEXTVAL"]);
                }
                else
                {
                    return effects;
                }

            }
            catch (Exception ex) { return effects; }

            return effects;
        }

        // Tharindu 2018-05-09

        public Int32 UpdateCusCode(string dummycode, string newcode)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("dummyseqcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dummycode;
            (param[1] = new OracleParameter("newcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = newcode;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_cus_code_dummy", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<sar_pb_def_det> GetPriceDef_details_new(string _com, string _pb, string _pbl, DateTime _date, string _item, Int32 _serch_type, string _base_pb, string _base_pbl, Int32 _pricetytpe)
        {
            List<sar_pb_def_det> _returnLst = null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[2] = new OracleParameter("p_pbl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbl;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            (param[6] = new OracleParameter("p_serch_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serch_type;
            (param[7] = new OracleParameter("p_base_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _base_pb;
            (param[8] = new OracleParameter("p_base_pbl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _base_pbl;
            (param[9] = new OracleParameter("p_pricetytpe", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pricetytpe;
            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_PriceDefforPB_new", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<sar_pb_def_det>(tblDet, sar_pb_def_det.Converternew);
            }

            return _returnLst;
        }
        public List<sar_pb_def> GetPriceDefHeaderforPB_all(string _com, string _pb, string _pbl, DateTime _date, Int32 _pr_type)
        {
            List<sar_pb_def> _returnLst = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[2] = new OracleParameter("p_pbl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbl;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_pr_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pr_type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblpromoDis", "GET_sar_pb_def", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<sar_pb_def>(tblDet, sar_pb_def.Convertermew);
            }

            return _returnLst;
        }
        public List<TradingInterest> get_trd_int_det(string _com, string _itm, DateTime _date, string _sch_cd)
        {
            List<TradingInterest> _returnLst = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch_cd;
            //(param[4] = new OracleParameter("p_pr_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pr_type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblpromoDis", "sp_get_trd_int_det", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<TradingInterest>(tblDet, TradingInterest.Convertnew);
            }

            return _returnLst;
        }

        //Tharindu 2018-05-21
        public DataTable GetCatWiseTradingGPReport(string com, DateTime stdt, DateTime endDt, string chnl, string cate, string pc, string userid, string itmcd)
        {
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = stdt;
            (param[1] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = endDt;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;
            (param[4] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chnl;
            (param[5] = new OracleParameter("pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[6] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[7] = new OracleParameter("itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _tbl = QueryDataTable("tbl", "SP_GET_ALERTGPDATA_GP_RPT", CommandType.StoredProcedure, false, param);
            DataTable _tbl = QueryDataTable("tbl", "SP_GET_ALERTGPDATA_GP_RPT", CommandType.StoredProcedure, false, param);

            return _tbl;
        }


        public DataTable GetSchemes_term(string _type, int _term, string _sch_cd)
        {

            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _term;
            (param[2] = new OracleParameter("p_sch_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch_cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tblscheme", "sp_getschemes_type", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetPromoCodesByCirnew(string _cir, string _promo, string _pb, string pbl)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cir;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[3] = new OracleParameter("p_pbl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbl;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_selectpromocdbycirnew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable getTrialCalDetails()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_trial_cal_sum", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getTradingInterest(string _scheme, string _item)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[2] = new OracleParameter("in_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_trading_intr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getLatestCost(string _com, string _item, string _itemstatus)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("in_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_latest_cost", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int16 DeleteTrialCalSum()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int16 effects = 0;

            param[0] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_delete_trial_cal_sum", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int16 SaveTrialCalSum(string p_com_cd, string p_pc_cd, string p_pc_desc, string p_pc_chnl, string p_cat1, string p_cat2, string p_cat3,
            string p_item_cd, string p_item_desc, string p_brnd, string p_pbook, string p_pblvl, string p_scheme, string p_scheme_name,
            decimal p_gross_amt, decimal p_vat_amt, decimal p_d_net_amt, decimal p_d_cost, decimal p_d_gp, decimal p_init_vat, decimal p_inst_vat,
            decimal p_trd_intr_rt, decimal p_trd_intr_amt, decimal p_ser_charge, decimal p_intr_charge, decimal p_diriya, decimal
            p_dp_amt, decimal p_hp_amt, decimal p_init_ser_charge, decimal p_inst_ser_charge, decimal p_init_diriya, decimal p_inst_diriya, decimal
            p_coll_comm, decimal p_coll_comm_rt, decimal p_dp_comm, decimal p_dp_comm_rt, decimal p_diriya_comm, decimal p_diriya_comm_rt, decimal p_monthly_inst)
        {
            //Sanjeewa 2018-06-20
            OracleParameter[] param = new OracleParameter[40];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com_cd;
            (param[1] = new OracleParameter("p_pc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc_cd;
            (param[2] = new OracleParameter("p_pc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc_desc;
            (param[3] = new OracleParameter("p_pc_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc_chnl;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat3;
            (param[7] = new OracleParameter("p_item_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_item_cd;
            (param[8] = new OracleParameter("p_item_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_item_desc;
            (param[9] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_brnd;
            (param[10] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pbook;
            (param[11] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pblvl;
            (param[12] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_scheme;
            (param[13] = new OracleParameter("p_scheme_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_scheme_name;
            (param[14] = new OracleParameter("p_gross_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_gross_amt;
            (param[15] = new OracleParameter("p_vat_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_vat_amt;
            (param[16] = new OracleParameter("p_d_net_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_d_net_amt;
            (param[17] = new OracleParameter("p_d_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_d_cost;
            (param[18] = new OracleParameter("p_d_gp", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_d_gp;
            (param[19] = new OracleParameter("p_init_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_init_vat;
            (param[20] = new OracleParameter("p_inst_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_inst_vat;
            (param[21] = new OracleParameter("p_trd_intr_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_trd_intr_rt;
            (param[22] = new OracleParameter("p_trd_intr_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_trd_intr_amt;
            (param[23] = new OracleParameter("p_ser_charge", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_ser_charge;
            (param[24] = new OracleParameter("p_intr_charge", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_intr_charge;
            (param[25] = new OracleParameter("p_diriya", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_diriya;
            (param[26] = new OracleParameter("p_dp_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_dp_amt;
            (param[27] = new OracleParameter("p_hp_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_hp_amt;
            (param[28] = new OracleParameter("p_init_ser_charge", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_init_ser_charge;
            (param[29] = new OracleParameter("p_inst_ser_charge", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_inst_ser_charge;
            (param[30] = new OracleParameter("p_init_diriya", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_init_diriya;
            (param[31] = new OracleParameter("p_inst_diriya", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_inst_diriya;
            (param[32] = new OracleParameter("p_coll_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_coll_comm;
            (param[33] = new OracleParameter("p_coll_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_coll_comm_rt;
            (param[34] = new OracleParameter("p_dp_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_dp_comm;
            (param[35] = new OracleParameter("p_dp_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_dp_comm_rt;
            (param[36] = new OracleParameter("p_diriya_comm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_diriya_comm;
            (param[37] = new OracleParameter("p_diriya_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_diriya_comm_rt;
            (param[38] = new OracleParameter("p_monthly_inst", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_monthly_inst;

            param[39] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_trial_cal_sum", CommandType.StoredProcedure, param);
            return effects;

        }
        //Dulaj 2018-Apr-10
        public DataTable GetUserDefineTemplate(string template, string user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_upd_tmp_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = template;
            (param[1] = new OracleParameter("p_upd_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblTemp", "get_template_by_usr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Dulaj 2018-Apr-11
        public Int32 SaveUserProfileTemplate(string _templateName, string _codes, string _values, string _userId, string _dectription, string _key, string _sessionId)
        {

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_upd_tmp_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _templateName;
            (param[1] = new OracleParameter("p_upd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _codes;
            (param[2] = new OracleParameter("p_upd_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _values;
            (param[3] = new OracleParameter("p_upd_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[4] = new OracleParameter("p_upd_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dectription;
            (param[5] = new OracleParameter("p_upd_key", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _key;
            (param[6] = new OracleParameter("p_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessionId;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("save_usr_pro_def", CommandType.StoredProcedure, param);

            return effects;

        }
        //Dulaj 12-Apr-2018
        public Int32 CheckTemplateName(string _tempName)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[1];
                (param[0] = new OracleParameter("p_tem_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempName;

                OracleParameter orP = new OracleParameter("c_result", OracleDbType.Int32, null, ParameterDirection.Output);

                return ReturnSP_SingleValue("check_usr_template", CommandType.StoredProcedure, orP, param);
            }
            catch (Exception) { return 0; }
        }
        //subodana 2018-06-22
        public DataTable GetDuplicateRecieptData(string InvNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblTemp", "get_duplirecdata", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Pasindu 2018/05/06
        public List<RBH_FRMDT_TODT> get_hdr_dates(string p_cir_code)
        {
            List<RBH_FRMDT_TODT> _returnLst = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cir_code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("ttbldate", "SP_GET_DATERANGE_CIRCODE", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _returnLst = DataTableExtensions.ToGenericList<RBH_FRMDT_TODT>(tblDet, RBH_FRMDT_TODT.Converter);
            }
            return _returnLst;
        }

        //Pasindu 2018/05/06
        public DataTable GetProductBonusDet(string p_circular_code, string p_scehema_code, string p_fromdata, string p_todate)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_circular_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_circular_code;
            (param[1] = new OracleParameter("p_scehema_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_scehema_code;
            (param[2] = new OracleParameter("p_fromdata", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(p_fromdata).Date;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(p_todate).Date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tblscheme", "SP_GET_PRODUCT_BONUS_DETAILS", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetSCM2InvoiceDetail_by_itm(string _company, string _invoice, string _item)
        {
            //sp_getinvoicedetail(p_com in NVARCHAR2,p_invoice in NVARCHAR2,p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getinv_det_by_itm", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Dulaj 2018/jun/29
        public string GetAccountNo(string customerCode, string companyCode)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_customerCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customerCode;
            (param[1] = new OracleParameter("p_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = companyCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "sp_get_Customer_accountNo", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                return _result.Rows[0]["Account No"].ToString();
            }
            else
            {
                return string.Empty;
            }
        }

        public List<RequestApprovalDetail> GET_EXCHANGE_REC_DET_WEB(string _ref)
        {
            List<RequestApprovalDetail> req = new List<RequestApprovalDetail>();
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_GRAD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_EXCHANGE_REC_DET_WEB", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                req = DataTableExtensions.ToGenericList<RequestApprovalDetail>(_dtResults, RequestApprovalDetail.Converter);
            }

            return req;
        }

        //Tharindu 2018-05-21
        public DataTable GetInvoiceSerial_SCM2(string _company, string _invoice, string _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getinvoiceserial_scm2", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //Dulaj 2018/Jul/19

        //Dulaj 2018/jun/29
        public DataTable GetProductBonusInvoiceDetails(string circular_code, string scehema_code, string FromDate, string ToDate, string com)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("circular_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular_code;
            (param[1] = new OracleParameter("scehema_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = scehema_code;
            (param[2] = new OracleParameter("fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FromDate.ToString();
            (param[3] = new OracleParameter("toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ToDate.ToString();
            (param[4] = new OracleParameter("pcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com.ToString();
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "sp_get_prd_bonus", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public Int32 SaveToMasterPcWiseMidnew(Deposit_Bank_Pc_wise lst_master_mid)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_MPM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Company;
            (param[1] = new OracleParameter("p_MPM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Profit_center;
            (param[2] = new OracleParameter("p_MPM_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = lst_master_mid.From_date;
            (param[3] = new OracleParameter("p_MPM_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = lst_master_mid.To_date;
            (param[4] = new OracleParameter("p_MPM_CRC_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lst_master_mid.Pun_tp;
            (param[5] = new OracleParameter("p_MPM_TERM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lst_master_mid.Period;
            (param[6] = new OracleParameter("p_MPM_MID_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mid_no;
            (param[7] = new OracleParameter("p_MPM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Create_by;
            (param[8] = new OracleParameter("p_MPM_BNK_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = lst_master_mid.Bankcharge;
            (param[9] = new OracleParameter("p_MPM_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_pb;
            (param[10] = new OracleParameter("p_MPM_PB_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_pblvl;
            (param[11] = new OracleParameter("p_MPM_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_brand;
            (param[12] = new OracleParameter("p_MPM_MAIN_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_maincat;
            (param[13] = new OracleParameter("p_MPM_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_cat;
            (param[14] = new OracleParameter("p_MPM_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_item;
            (param[15] = new OracleParameter("p_MPM_PROMO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lst_master_mid.Mpm_promo;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_MST_PC_MID", CommandType.StoredProcedure, param);



            return effects;
        }
        public DataTable Get_hp_balance_bycust(DateTime _date, string _cust_cd, string _loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_custcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust_cd;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_hp_balance_bycust", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //SUBODANA 2018-08-07
        public List<HpSchemeDefinition> GetDPCommission(string _book, string _level, DateTime _date, string _item, string _brand, string _maincat, string _cat, string _scheme)
        {
            List<HpSchemeDefinition> _list = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_CURRNTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[1] = new OracleParameter("P_PRICEBOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("P_PRICELEVEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("P_MCAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maincat;
            (param[6] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[7] = new OracleParameter("P_SCHEME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "SP_GET_DPCOMMRT_BYITEM", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<HpSchemeDefinition>(_tblData, HpSchemeDefinition.Converter);
            }
            return _list;
        }
      
        public decimal GetCashCommissionRate(string _book, string _level, DateTime _date, string _item, string _brand, string _maincat, string _cat, string Tp)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_CURRNTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[1] = new OracleParameter("P_PRICEBOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("P_PRICELEVEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("P_MCAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maincat;
            (param[6] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[7] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tp;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            decimal maxrt = 0;
            DataTable _dtResults = QueryDataTable("tbData", "SP_GET_CASHCOMMRT_BYITEM", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                maxrt = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return maxrt;
        }

        public DataTable Get_warr_det_by_ser(string _itm, string _ser)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itmcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[1] = new OracleParameter("p_serid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getwaradetbyserial", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public int DeleteHPSchProcessnew(string _user, string p_hpc_pty_tp, string p_hpc_pty_cd)
        {
            int effect = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_hpc_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_hpc_pty_tp;
            (param[2] = new OracleParameter("p_hpc_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_hpc_pty_cd;
            param[3] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_deleteschprocess_temp", CommandType.StoredProcedure, param);

            return effect;
        }
        public List<InvoiceHeader> GetInvoiceByAccountNo_HS(string _company, string _profitCenter, string _account)
        {
            //sp_getsalesbyaccount(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_account in NVARCHAR2 ,c_data OUT sys_refcursor)

            List<InvoiceHeader> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "SP_GETSALESBYACCOUNT_HS", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceHeader>(_tblData, InvoiceHeader.ConvertTotal);
            }
            return _list;
        }

        public DataTable Get_ReducingBalance(string _accNo, DateTime _asAtDate)
        {
            //Wimal 27/Sep/2018
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[2] = new OracleParameter("in_type", OracleDbType.Int64, null, ParameterDirection.Input)).Value = 1;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbl", "sp_reduce_bal", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public Int32 update_loty_crdmember(string account_no, string type, Int32 _status)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_account_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = account_no;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[2] = new OracleParameter("p_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_loty_crdmember", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable GetReceiptItemTablenew(string _invoice)
        {
            RecieptItem _recieptItem = new RecieptItem();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblRecieptItem = QueryDataTable("tblRecieptItem", "SP_GETRECEIPTITM_NEW", CommandType.StoredProcedure, false, param);

            return _tblRecieptItem;

        }
        //add by tharanga 2018/2018/10/15
        public LoyaltyMemeber getLoyaltyDetails_by_ser(string _cd_ser)
        {

            OracleParameter[] param = new OracleParameter[2];
            LoyaltyMemeber loyCus = new LoyaltyMemeber();
            (param[0] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd_ser;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_LOYAL_BY_CARD", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                loyCus = DataTableExtensions.ToGenericList<LoyaltyMemeber>(_dtResults, LoyaltyMemeber.Converter)[0];
            }
            return loyCus;

        }
       

        public DataTable CALC_REDUCE_BAL_RPT_NEW(DateTime in_FromDate, DateTime in_ToDate, string _com, string _pc, Int16 _issum, Int16 _isSch)
        {
            // Nadeeka 29-aug-2014
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("ISSUM", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _issum;
            (param[6] = new OracleParameter("IN_TYPE", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isSch;
            DataTable _dtResults = QueryDataTable("tblRcc", "SP_CALC_REDUCE_BAL_RPT_NEW", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetRCV_AGE_CURRRNT(string userid, DateTime _TODATE)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("USERID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TODATE;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = new DataTable();
            SecurityDAL _securityDAL = new SecurityDAL();
            if (_securityDAL.Is_Report_DR("HPRecievableAgeAnalysis_sumtable") == true)
            {
                _tbl = QueryDataTable("tblPc", "SP_RCV_AGE_CURRRNT_NEW", CommandType.StoredProcedure, false, param); 
            }

            else
            {
                _tbl = QueryDataTable("tblPc", "SP_RCV_AGE_CURRRNT", CommandType.StoredProcedure, false, param);
            }
            //DataTable _tbl = QueryDataTable("tblPc", "SP_RCV_AGE_CURRRNT", CommandType.StoredProcedure, false, param);
           // DataTable _tbl = QueryDataTable("tblPc", "SP_RCV_AGE_CURRRNT_NEW", CommandType.StoredProcedure, false, param);
            

            return _tbl;
        }
        public Int32 UpdateSatProjectKitDetails(int lineNo, string Boqno, string kitCd, string kitDesc, string kitModel, decimal qty, int active, string modBy, string session, decimal unitprice, decimal unitCost, decimal totalCost, decimal totalPrice, Int32 SeqNo, string rmk)
        {            
            int _effect = -1;
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_SPK_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SeqNo;
            (param[1] = new OracleParameter("p_SPK_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNo;
            (param[2] = new OracleParameter("p_SPK_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Boqno;
            (param[3] = new OracleParameter("p_SPK_KIT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = kitCd;
            (param[4] = new OracleParameter("p_SPK_KIT_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = kitDesc;
            (param[5] = new OracleParameter("p_SPK_KIT_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = kitModel;
            (param[6] = new OracleParameter("p_SPK_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = qty;
            (param[7] = new OracleParameter("p_SPK_ACTIVE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = active;
            (param[8] = new OracleParameter("p_SPK_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modBy;
            (param[9] = new OracleParameter("p_SPK_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = session;
            (param[10] = new OracleParameter("p_SPK_UNIT_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = unitprice;
            (param[11] = new OracleParameter("p_SPK_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = unitCost;
            (param[12] = new OracleParameter("p_SPK_TOTAL_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = totalCost;
            (param[13] = new OracleParameter("p_SPK_TOTAL_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = totalPrice;
            (param[14] = new OracleParameter("p_SPK_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rmk;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_update_sat_kit_pro", CommandType.StoredProcedure, param);
            return _effect;
        }

        public DataTable CC_Reconciliation_Rpt(string com, DateTime _fromdate, DateTime _todate, string Acc)
        {
            

            //Wimal @ 01/Nov/2018 
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Acc;
            (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_cc_recon_Detl", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Wimal @ 02/Nov/2018
        public DataTable LoadCCAccounts()
        {

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_CC_ACCOUNTS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getAllMid_Detailsnew(string prof_cen)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_profit_cen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prof_cen;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SPGET_ALL_MID_DETAILS_new", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //Darshana @ 07-11-2018
        public DataTable GetAlwItm(string _itm)
        {
            
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("_dtResults", "sp_chkalwitm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Darshana 07/11/2018
        public DataTable GetCurInv()
        {

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("_dtResults", "sp_GetCurrInv", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<SER_HIS> get_ser_details(string serial)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                List<SER_HIS> loyCus = new List<SER_HIS>();
                (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SERIALDETAILSHIS", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    loyCus = DataTableExtensions.ToGenericList<SER_HIS>(_dtResults, SER_HIS.Converter);
                }
                return loyCus;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Wimal 2018/Nov/29
        public Int32 UpdateDipositBankDet(List<Deposit_Bank_Pc_wise> listBankDetails)
        {
            Int32 effects = 0;
            foreach (Deposit_Bank_Pc_wise _itemDetails in listBankDetails)
            {
                OracleParameter[] param = new OracleParameter[13];

                (param[0] = new OracleParameter("p_MPB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_MPB_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Profit_center;
                (param[2] = new OracleParameter("p_MPB_PAY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Pay_mode_code;
                (param[3] = new OracleParameter("p_MPB_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankCode;
                (param[4] = new OracleParameter("p_MPB_BANK_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankName;
                (param[5] = new OracleParameter("p_MPB_SUN_AC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.SunAccNo;
                (param[6] = new OracleParameter("p_MPB_SUN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.BankAccNo;               
                (param[7] = new OracleParameter("p_MPB_DEF_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.Default_val;
                (param[8] = new OracleParameter("p_MPB_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemDetails.IsActive;
                (param[9] = new OracleParameter("p_MPB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Createby;
                (param[10] = new OracleParameter("p_MPB_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemDetails.CreateDateTime;
                (param[11] = new OracleParameter("p_MPB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Modifyby;

                param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_UPDATE_DIPOSIT_BANK_PC", CommandType.StoredProcedure, param);

            }

            return effects;
        }
        public int Update_veh_AccRec(Int32 seq, DateTime recDate, string recBy)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_recDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = recDate.Date;
            (param[2] = new OracleParameter("p_recBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recBy;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int effects = (Int16)UpdateRecords("SP_UPDATE_ACCRECEIVE", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Delete_inv_type(string com,string customerCd, string invType)
        {
            
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("pcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("pcusCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customerCd;
            (param[2] = new OracleParameter("p_sa_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invType;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_Delete_cus_inv_tp", CommandType.StoredProcedure, param);
            return effects;
        }

        //Udesh 03-Nov-2018
        public Int32 Update_GV_Page_Status(string _status, int _pageNo, string _cusCode, string _cusName, string _cusAddres, string _cardNo)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_gvp_page", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pageNo;
            (param[1] = new OracleParameter("p_gvp_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_gvp_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusCode;
            (param[3] = new OracleParameter("p_gvp_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusName;
            (param[4] = new OracleParameter("p_gvp_cus_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusAddres;
            (param[5] = new OracleParameter("p_gvp_oth_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardNo;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_loyalty_card.sp_update_loyalty_card", CommandType.StoredProcedure, param);
            return effects;

        }

        //Udesh 03-Nov-2018
        public DataTable Get_GV_Page_Availability(string _loyaltyType, string _pc, int _pageNo)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_gvp_gv_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyaltyType;
            (param[1] = new OracleParameter("p_gvp_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_gvp_page", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pageNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl_loyalty", "pkg_loyalty_card.sp_loyalty_card_availability", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }

        public DataTable loyaltyPointEarning(string _com, string _pc, string _itemCode, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5,
            string _brand, string _model, string _customer, DateTime _fromDate, DateTime _toDate, string _rptType, string _userID)
        {
            //Wimal @ 16/Jan/2018 
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[7] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[8] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[9] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[12] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            (param[13] = new OracleParameter("p_rptType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rptType;
             param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);       

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_getloyaltyDetl", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetHP_CheckedAccounts(string com, string pc, DataTable _dt)
        {
            //--------Crete by sandaruwan 2019/02/14
            DataTable _dt_CheckedReturn = new DataTable("AA");
            List<HpAccount> _CheckedReturn = new List<HpAccount>();
            _dt_CheckedReturn.Columns.Add("Hpa_ChkAccountNo");
            _dt_CheckedReturn.Columns.Add("Hpa_ChkAccountstus");
            HpAccount _hpa = new HpAccount();
            foreach (DataRow _dr in _dt.Rows)
            {

                DataTable _dtRes = new DataTable();
                
                string res =  _dr["Account Number"] == DBNull.Value ? string.Empty : _dr["Account Number"].ToString().Trim();
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_res", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = res;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                 _dtRes = QueryDataTable("_dtRes", "sp_GetHP_CheckedAccounts", CommandType.StoredProcedure, false, param);

                //_CheckedReturn = DataTableExtensions.ToGenericList<HpAccount>(_dtRes, HpAccount.Converter2);
                 if (_dtRes.Rows.Count > 0)
                 {
                     if (_dtRes.Rows[0][0].ToString() != "Active")
                     {
                         //_hpa.Hpa_ChkAccountNo = res;
                         //_hpa.Hpa_ChkAccountstus = _dtRes.Rows[0][0].ToString();
                         //_CheckedReturn.Add(_hpa);
                         _dt_CheckedReturn.Rows.Add();
                         _dt_CheckedReturn.Rows[_dt_CheckedReturn.Rows.Count-1][0] = res;
                         _dt_CheckedReturn.Rows[_dt_CheckedReturn.Rows.Count-1][1] = _dtRes.Rows[0][0].ToString();
                     }
                 }
               
            }

            return _dt_CheckedReturn;
        }
    }
}
