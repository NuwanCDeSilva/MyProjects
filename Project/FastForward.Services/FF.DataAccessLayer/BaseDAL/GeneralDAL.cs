using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using System.IO;
using Oracle.DataAccess.Client;
using FF.BusinessObjects;
using Oracle.DataAccess.Types;
using FF.BusinessObjects.General;
using System.Net.Mail;
using System.Net;
using FF.BusinessObjects.InventoryNew;
using FF.BusinessObjects.Sales;
using FF.BusinessObjects.Commission;

namespace FF.DataAccessLayer
{
    public class GeneralDAL : BaseDAL
    {
        //kapila
        public DataTable GetExpenseLimitAloc(string _com, string _ptytp, string _ptycd, string _expcd, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptytp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptycd;
            (param[3] = new OracleParameter("p_exp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expcd;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_gnr_exp_limi_aloc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int32 GetSerialID_1()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getserialid_1", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public Int32 SaveExpenseLimitAloc(Expense_Limit_Alloc _ExpLim)
        {

            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ExpLim.Exla_seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ExpLim.Exla_com;
            (param[2] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ExpLim.Exla_pty_tp;
            (param[3] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ExpLim.Exla_pty_cd;
            (param[4] = new OracleParameter("p_exp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ExpLim.Exla_exp_cd;
            (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ExpLim.Exla_from;
            (param[6] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ExpLim.Exla_to;
            (param[7] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ExpLim.Exla_val;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ExpLim.Exla_cre_by;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_expense_limit_aloc", CommandType.StoredProcedure, param);

            return effects;

        }

        //kapila
        public DataTable GetMstItmUOM(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_mst_itm_uom", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public Int32 Save_Item_Master(MasterItem _item)
        {
            OracleParameter[] param = new OracleParameter[95];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_MI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cd;
            (param[1] = new OracleParameter("P_MI_SHORTDESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_shortdesc;
            (param[2] = new OracleParameter("P_MI_LONGDESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_longdesc;
            (param[3] = new OracleParameter("P_MI_CATE_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_1;
            (param[4] = new OracleParameter("P_MI_CATE_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_2;
            (param[5] = new OracleParameter("P_MI_CATE_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_3;
            (param[6] = new OracleParameter("P_MI_CATE_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_4;
            (param[7] = new OracleParameter("P_MI_CATE_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_5;
            (param[8] = new OracleParameter("P_MI_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_brand;
            (param[9] = new OracleParameter("P_MI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_model;
            (param[10] = new OracleParameter("P_MI_PART_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_part_no;
            (param[11] = new OracleParameter("P_MI_COLOR_INT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_color_int;
            (param[12] = new OracleParameter("P_MI_IS_REQCOLORINT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_reqcolorint);
            (param[13] = new OracleParameter("P_MI_COLOR_EXT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_color_ext;
            (param[14] = new OracleParameter("P_MI_IS_REQCOLOREXT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_reqcolorext);
            (param[15] = new OracleParameter("P_MI_ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_itm_tp;
            (param[16] = new OracleParameter("P_MI_IS_STOCKMAINTAIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_is_stockmaintain;
            (param[17] = new OracleParameter("P_MI_HS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_hs_cd;
            (param[18] = new OracleParameter("P_MI_ITM_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_itm_uom;
            (param[19] = new OracleParameter("P_MI_DIM_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_dim_uom;
            (param[20] = new OracleParameter("P_MI_DIM_LENGTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_dim_length;
            (param[21] = new OracleParameter("P_MI_DIM_WIDTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_dim_width;
            (param[22] = new OracleParameter("P_MI_DIM_HEIGHT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_dim_height;
            (param[23] = new OracleParameter("P_MI_WEIGHT_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_weight_uom;
            (param[24] = new OracleParameter("P_MI_GROSS_WEIGHT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_gross_weight;
            (param[25] = new OracleParameter("P_MI_NET_WEIGHT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_net_weight;
            (param[26] = new OracleParameter("P_MI_IMAGE_PATH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_image_path;
            (param[27] = new OracleParameter("P_MI_IS_SER1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_ser1;
            (param[28] = new OracleParameter("P_MI_IS_SER2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_ser2);
            (param[29] = new OracleParameter("P_MI_IS_SER3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_ser3);
            (param[30] = new OracleParameter("P_MI_WARR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_warr);
            (param[31] = new OracleParameter("P_MI_WARR_PRINT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_warr_print);
            (param[32] = new OracleParameter("P_MI_HP_ALLOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_hp_allow);
            (param[33] = new OracleParameter("P_MI_INSU_ALLOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_insu_allow);
            (param[34] = new OracleParameter("P_MI_COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_country_cd;
            (param[35] = new OracleParameter("P_MI_PURCOM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_purcom_cd;
            (param[36] = new OracleParameter("P_MI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_itm_stus;
            (param[37] = new OracleParameter("P_MI_FGITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_fgitm_cd;
            (param[38] = new OracleParameter("P_MI_ITMTOT_COST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_itmtot_cost;
            (param[39] = new OracleParameter("P_MI_CHG_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_chg_tp;
            (param[40] = new OracleParameter("P_MI_IS_SCANSUB", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_scansub);
            (param[41] = new OracleParameter("P_MI_IS_BARCODETRIM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_barcodetrim);
            (param[42] = new OracleParameter("P_MI_LTRIM_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_ltrim_val;
            (param[43] = new OracleParameter("P_MI_RTRIM_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_rtrim_val;
            (param[44] = new OracleParameter("P_MI_IS_EDITSHORTDESC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editshortdesc);
            (param[45] = new OracleParameter("P_MI_IS_EDITLONGDESC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editlongdesc);
            (param[46] = new OracleParameter("P_MI_SER_PREFIX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_ser_prefix;
            (param[47] = new OracleParameter("P_MI_REFITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_refitm_cd;
            (param[48] = new OracleParameter("P_MI_UOM_WARRPERIODMAIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_uom_warrperiodmain;
            (param[49] = new OracleParameter("P_MI_UOM_WARRPERIODSUB1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_uom_warrperiodsub1;
            (param[50] = new OracleParameter("P_MI_UOM_WARRPERIODSUB2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_uom_warrperiodsub2;
            (param[51] = new OracleParameter("P_MI_IS_EDITSER1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editser1);
            (param[52] = new OracleParameter("P_MI_IS_EDITSER2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editser2);
            (param[53] = new OracleParameter("P_MI_IS_EDITSER3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editser3);
            (param[54] = new OracleParameter("P_MI_STD_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_std_cost;
            (param[55] = new OracleParameter("P_MI_STD_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_std_price;
            (param[56] = new OracleParameter("P_MI_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_act);
            (param[57] = new OracleParameter("P_MI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cre_by;
            (param[58] = new OracleParameter("P_MI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_cre_dt;
            (param[59] = new OracleParameter("P_MI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_mod_by;
            (param[60] = new OracleParameter("P_MI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_mod_dt;
            (param[61] = new OracleParameter("P_MI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_session_id;
            (param[62] = new OracleParameter("P_MI_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_anal1;
            (param[63] = new OracleParameter("P_MI_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_anal2;
            (param[64] = new OracleParameter("P_MI_ANAL3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_anal3);
            (param[65] = new OracleParameter("P_MI_ANAL4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_anal4);
            (param[66] = new OracleParameter("P_MI_ANAL5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_mod_dt;// _item.Mi_anal5;
            (param[67] = new OracleParameter("P_MI_ANAL6", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_mod_dt; //_item.Mi_anal6;
            (param[68] = new OracleParameter("P_MI_IS_SUBITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_subitem);
            (param[69] = new OracleParameter("P_MI_NEED_REG", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_need_reg);
            (param[70] = new OracleParameter("P_MI_NEED_INSU", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_need_insu);
            (param[71] = new OracleParameter("P_MI_NEED_FREESEV", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_need_freesev;
            (param[72] = new OracleParameter("P_MI_COMM_ISRATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_comm_israte;
            (param[73] = new OracleParameter("P_MI_COMM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_comm_val;
            (param[74] = new OracleParameter("P_MI_FAC_BASE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_fac_base);
            (param[75] = new OracleParameter("P_MI_FAC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_fac_val;
            (param[76] = new OracleParameter("P_MI_IS_COND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_cond;
            (param[77] = new OracleParameter("P_MI_PACKING_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_packing_cd;
            (param[78] = new OracleParameter("P_MI_PART_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_part_cd;
            (param[79] = new OracleParameter("P_MI_IS_DISCONT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_discont;
            (param[80] = new OracleParameter("P_MI_IS_SUP_WARA", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_sup_wara;
            (param[81] = new OracleParameter("P_MI_CHK_CUST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.MI_CHK_CUST;
            (param[82] = new OracleParameter("P_MI_IS_EXP_DT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_exp_dt;
            (param[83] = new OracleParameter("P_MI_CAPACITY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_capacity;
            (param[84] = new OracleParameter("P_MI_SIZE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_size;
            (param[85] = new OracleParameter("P_MI_ADD_ITM_DES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_add_itm_des);
            (param[86] = new OracleParameter("P_MI_EDIT_ALT_SER", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_edit_alt_ser);
            (param[87] = new OracleParameter("P_MI_SER_RQ_CUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_ser_rq_cus);
            (param[88] = new OracleParameter("P_MI_MAIN_SUPP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_main_supp);
            (param[89] = new OracleParameter("P_MI_APP_ITM_COND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_app_itm_cond);
            (param[90] = new OracleParameter("P_MI_IS_PGS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_pgs);
            (param[91] = new OracleParameter("P_MI_IS_MULT_PREFIX", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_mult_prefix);
            (param[92] = new OracleParameter("P_MI_PGS_COUNT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_pgd_count;
            (param[93] = new OracleParameter("P_MI_COUNTER_FOIL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.MI_COUNTER_FOIL);
            param[94] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("SP_SAVE_MST_ITM", CommandType.StoredProcedure, param);

            return effects;

        }
        //kapila
        public MasterLocation GetAllLocationByLocCode(string _CompCode, string _LocCode, Int32 _isAll)
        {
            MasterLocation _locList = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[3] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //_locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.converter)[0];
                //Edit by Chamal 29/06/2012
                _locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal)[0];
            }
            return _locList;
        }
        //kapila
        public DataTable GetPBSchemeRem(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_sar_pb_sch_rem", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable GetPBScheme(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_sar_pb_sch", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable GetTaxRateCode(string _type, string _code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_tax_rate_cd", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable getreqSerByReqno(string _req_no, string _item, string _ser)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req_no;
            (param[1] = new OracleParameter("p_req_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_req_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_getreqSerByReqno", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //kapila
        public DataTable Get_gen_reqapp_ser_byitem(string com, string reqNo, string _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_gen_reqapp_ser_byItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetPendingMyAbansDocs()
        {

            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_myabans_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable getPSITransLocs(DateTime _from, DateTime _to)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("in_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterLoc", "sp_psi_trans_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        
        public DataTable getMyAbansSMSContacts(Int32 _opt, string _lan, String _town)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_OPT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _opt;
            (param[2] = new OracleParameter("IN_LAN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lan;
            (param[3] = new OracleParameter("IN_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _town;//Added by Udesh 28-Nov-2018



            DataTable tblDet = QueryDataTable("tbl_det", "sp_myabans_sms", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //kapila
        public Int32 UpdateMarkAsPrint(string _com, DateTime _fromDate, DateTime _toDate, Int32 _isAll, string _user)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("p_isall", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_upd_markasprint", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila
        public DataTable getMyAbansBySerial(string _ser, Int32 _isNIC)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[1] = new OracleParameter("p_isnic", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isNIC;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_myabans", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //kapila
        public DataTable getFavouriteByCat(string _cat)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_get_favourite_bycat", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //kapila
        public Int32 CancelTempWaraWaranty(string _item, string _serial, string _war)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[2] = new OracleParameter("p_war", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _war;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_cancel_wara", CommandType.StoredProcedure, param);
            return result;
        }

        //kapila
        public Int32 SaveExpenseLimitAloc(string sch_cd, string pty_tp, string pty_cd)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sch_cd;
            (param[1] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pty_tp;
            (param[2] = new OracleParameter("p_war", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pty_cd;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_cancel_wara", CommandType.StoredProcedure, param);
            return result;
        }

        //kapila
        public Int32 sp_updateexchangeissuenew(string _request, Int32 _line, string _anal1, string _anal10, string _anal11, Decimal _amount, Int32 isdutyfree, Decimal _tax, Decimal unit_amount)
        {
            //sp_updateexchangeissue(p_reqno in NVARCHAR2,o_effect out NUMBER) is
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            (param[2] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _anal1;
            (param[3] = new OracleParameter("p_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _anal10;
            (param[4] = new OracleParameter("p_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _anal11;
            (param[5] = new OracleParameter("p_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amount;
            (param[6] = new OracleParameter("p_isdutyfree", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isdutyfree;
            (param[7] = new OracleParameter("p_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tax;
            (param[8] = new OracleParameter("p_unit_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = unit_amount;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_updateexchangeissuenew", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public Int32 SaveSubLocations(MasterSubLocation _subLoc)
        {

            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_MSL_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_com;
            (param[1] = new OracleParameter("p_MSL_MLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_mloc;
            (param[2] = new OracleParameter("p_MSL_SLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_sloc;
            (param[3] = new OracleParameter("p_MSL_SLOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_sloc_desc;
            (param[4] = new OracleParameter("p_MSL_SADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_sadd1;
            (param[5] = new OracleParameter("p_MSL_SADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_sadd2;
            (param[6] = new OracleParameter("p_MSL_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_rmk;
            (param[7] = new OracleParameter("p_MSL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _subLoc.Msl_act;
            (param[8] = new OracleParameter("p_MSL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_cre_by;
            (param[9] = new OracleParameter("p_MSL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _subLoc.Msl_cre_dt;
            (param[10] = new OracleParameter("p_MSL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_mod_by;
            (param[11] = new OracleParameter("p_MSL_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _subLoc.Msl_mod_dt;
            (param[12] = new OracleParameter("p_MSL_CONT_PER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_cont_per;
            (param[13] = new OracleParameter("p_MSL_CONT_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subLoc.Msl_cont_no;
            (param[14] = new OracleParameter("p_MSL_START_FRM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _subLoc.Msl_start_frm;
            (param[15] = new OracleParameter("p_MSL_OPERATE_TILL", OracleDbType.Date, null, ParameterDirection.Input)).Value = _subLoc.Msl_operate_till;


            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_sub_loc", CommandType.StoredProcedure, param);

            return effects;

        }

        //kapila
        public DataTable getInvBySerial(string _com, string _loc, string _type, string _ser)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getinvoicebyserial", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public List<VehicalRegistration> GetVehRegNoByInvoiceNo(string com, string pc, string invNo)
        {
            List<VehicalRegistration> _list = null;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getvehregbyinv", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<VehicalRegistration>(_dtResults, VehicalRegistration.Converter);
            }
            return _list;
        }

        //kapila
        public DataTable get_job_defects(string _jobNo, string _tp)
        {
            OracleParameter[] param = new OracleParameter[3];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;

            DataTable _dtResults = QueryDataTable("tblRcc", "get_job_def", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable ManualDocumentsReport(DateTime _fromDate, DateTime _toDate, Int32 _isasat, DateTime _asatdate, string _user, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_isasat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isasat;
            (param[4] = new OracleParameter("in_asatDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[5] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[7] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            DataTable _tblProfitCenter = QueryDataTable("tblvou", "pkg_hp_sales_scm2.PROC_MANUAL_DOCS_REPORT", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }
        //kapila
        public DataTable getBatchItems(string _com, string _grn)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_grn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grn;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_batch_itms", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable sp_get_pc_prit_hierarchy(string _com, string _type)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_pc_prit_hierarchy", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public DataTable getPOPrice(string _pono, Int32 _line)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pono;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_po_price", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public DataTable getAvgCost(string _com, string _loctp, string _item, string _itmstus, DateTime _grndate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loctp;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmstus;
            (param[4] = new OracleParameter("p_grndate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _grndate;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_avg_cost", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public Boolean IsVehRegNoExist(string _com, string _recno, string _regno)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (_para[2] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regno;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _agentFound = QueryDataTable("tbl", "sp_chk_reg_no_exist", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _agentFound;
        }

        public DataTable GetLocationSubChannel(string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getlocsubchannel", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getSubChannelDet(string _company, string _code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = new DataTable();
            _itemTable = QueryDataTable("tblserial", "sp_get_schnl", CommandType.StoredProcedure, false, param);

            return _itemTable;
        }

        public DataTable getDetail_on_serial2(string _company, string _location, string _serial1)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = new DataTable();
            _itemTable = QueryDataTable("tblserial", "sp_get_det_on_serno", CommandType.StoredProcedure, false, param);

            return _itemTable;
        }

        //kapila
        public DataTable GetPayCircByCode(string _com, string _circ)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pay_circ_dt", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //kapila
        public DataTable GetTownByCode(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_town", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable GetDistrictByCode(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_dist", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable GetProvinceByCode(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_province", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        //kapila
        public DataTable GetBusDeptByCode(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_busdeptbycode", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        //kapila
        public DataTable GetBusDesigByCode(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_busdesigbycode", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        #region master locations

        //Randima 2016-07-06
        public DataTable GetLocationSearch(string _compCode, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _compCode;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_searchlocation", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public List<MasterLocation> GetAllLocationData()
        {
            List<MasterLocation> _masterLocation = null;

            DataTable _dtResults = QueryDataTable("tblMasterLoc", "SP_GETALLLOCATIONS", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));
            if (_dtResults.Rows.Count > 0)
            {
                _masterLocation = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.converter);
            }
            return _masterLocation;
        }

        public List<MasterLocation> GetLocationByCompany(string _Comp)
        {
            List<MasterLocation> _masterLocation = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_comp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Comp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterLoc", "sp_get_loc_by_comp", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterLocation = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.converter);
            }
            return _masterLocation;
        }

        //kapila
        public DataTable GetSCM2LocationByCompany(string _Comp)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_comp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Comp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterLoc", "sp_get_scm2loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public MasterLocation GetLocationByLocCode(string _CompCode, string _LocCode)
        {
            MasterLocation _locList = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //_locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.converter)[0];
                //Edit by Chamal 29/06/2012
                _locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal)[0];
            }
            return _locList;
        }

        //Chamal 30-05-2012
        public MasterLocation GetLocationInfor(string _CompCode, string _LocCode)
        {
            MasterLocation _locList = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal)[0];
            }
            return _locList;
        }

        //Lakshan 10/12/2015
        //Get all location by companys
        public DataTable GetLocationByComs(string _CompCode)
        {
            MasterLocation _locList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COM_CDS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "pkg_search_imp.SP_GET_LOCATION_BY_COMS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Randima 2016/07/07 (Edit by Chamal 16-Apr-2017)
        public Int32 UpdateLocationIP(MasterLocation _loc)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ML_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_com_cd;
            (param[1] = new OracleParameter("p_ML_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_cd;
            (param[2] = new OracleParameter("p_ML_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_email;
            (param[3] = new OracleParameter("p_ML_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_tel;
            (param[4] = new OracleParameter("p_ML_IP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_ip;
            (param[5] = new OracleParameter("p_ML_VNC_PW", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_vnc_pw;
            (param[6] = new OracleParameter("p_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_mod_by;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int32)UpdateRecords("sp_update_location_ip", CommandType.StoredProcedure, param);
        }

        #endregion

        #region Master Companies

        /// <summary>
        /// Get all master companies data.
        /// </summary>
        /// <returns></returns>
        public List<MasterCompany> GetALLMasterCompaniesData()
        {
            List<MasterCompany> _masterCompanyList = null;

            //Query Data base.         
            DataTable _dtResults = QueryDataTable("tblMasterCompanies", "sp_getallcompanies", CommandType.StoredProcedure, false,
                                                   new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            if (_dtResults.Rows.Count > 0)
            {
                //Convert datatable to relavant generic List.
                _masterCompanyList = DataTableExtensions.ToGenericList<MasterCompany>(_dtResults, MasterCompany.Converter);
            }

            return _masterCompanyList;
        }

        //Randima 2016-07-06
        public DataTable GetCompanySearch(string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_searchcompany", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public Boolean checkESDStatus(string _com, string _pc, string _epf, DateTime _month)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (_para[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _esdStus = QueryDataTable("tbl", "sp_chk_esd_stus", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _esdStus;
        }

        //kapila
        public Boolean checkESDBalFound(string _com, string _pc, string _epf)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _esdStus = QueryDataTable("tbl", "sp_chk_esd_bal", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _esdStus;
        }

        //kapila 21/3/2012
        public MasterCompany GetCompByCode(string _CompCode)
        {
            MasterCompany _userList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblcomp", "SP_GET_COMP_BY_CODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<MasterCompany>(_dtResults, MasterCompany.Converter)[0];
            }
            return _userList;
        }

        //kapila
        public Int16 SaveBankBranch(MasterBankBranch _bankBranch)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_MBB_COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_country_cd;
            (param[1] = new OracleParameter("p_MBB_BUS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_bus_cd;
            (param[2] = new OracleParameter("p_MBB_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_cd;
            (param[3] = new OracleParameter("p_MBB_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_desc;
            (param[4] = new OracleParameter("p_MBB_BUS_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_bus_tp;
            (param[5] = new OracleParameter("p_MBB_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_add1;
            (param[6] = new OracleParameter("p_MBB_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_add2;
            (param[7] = new OracleParameter("p_MBB_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_tel;
            (param[8] = new OracleParameter("p_MBB_FAX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_fax;
            (param[9] = new OracleParameter("p_MBB_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_email;
            (param[10] = new OracleParameter("p_MBB_WEB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_web;
            (param[11] = new OracleParameter("p_MBB_TOWN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_town_cd;
            (param[12] = new OracleParameter("p_MBB_ACTIVE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_active;
            (param[13] = new OracleParameter("p_MBB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_cre_by;
            (param[14] = new OracleParameter("p_MBB_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_cre_when;
            (param[15] = new OracleParameter("p_MBB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_mod_by;
            (param[16] = new OracleParameter("p_MBB_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_mod_when;
            (param[17] = new OracleParameter("p_MBB_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankBranch.Mbb_session_id;

            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_bank_branch", CommandType.StoredProcedure, param);
            return effects;
        }
        //Nadeeka 28-12-12
        public DataTable GetCompanyByCode(string _CompCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_comp_by_code", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable GetAuth_Transactions(string _Trn_Type, string _user_id, string com)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_TrnType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Trn_Type;
            (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_AUTH_TRANSACTIONS", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        public DataTable GetHireSales_Transaction(string _sart_desc, string _user_id, string _com)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_se_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[1] = new OracleParameter("p_sart_Desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sart_desc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_HIRESALES_TRANS", CommandType.StoredProcedure, false, param);


            return _dtResults;

        }

        #endregion


        #region Pending Approve *** Shanuka Perera 10/05/2014
        /// <summary>
        /// Get User Wise Pending Approval RequestType Codes(SART_MAIN_TP)
        /// </summary>
        /// <param name="_userid"></param>
        /// <returns>_lstAllSartMainTp</returns>
        public List<PendingApproval> GetPendingApproveDetails(string _userid, string _com)
        {
            List<PendingApproval> _lstAllSartMainTp = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userid;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPending", "SP_GET_PENDING_REQUESTCODE", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _lstAllSartMainTp = DataTableExtensions.ToGenericList<PendingApproval>(_dtResults, PendingApproval.Converter);
            }
            return _lstAllSartMainTp;

        }


        public List<PendingApproval> GetPendingReqTypes(string _user_id, string _srtmaintp, string _com)
        {
            List<PendingApproval> _lstSartDesc = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_se_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[1] = new OracleParameter("p_sart_main_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _srtmaintp;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPen", "SP_GET_USER_PENDING_REQTYPE", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _lstSartDesc = DataTableExtensions.ToGenericList<PendingApproval>(_dtResults, PendingApproval.SartDescConverters);
            }
            return _lstSartDesc;


        }


        #endregion

        #region master user category
        public List<MasterUserCategory> GetUserCategory()
        {
            List<MasterUserCategory> _userCategory = null;

            DataTable _dtResults = QueryDataTable("tblUserCategory", "SP_GETUSERCATEGORY", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            if (_dtResults.Rows.Count > 0)
            {
                _userCategory = DataTableExtensions.ToGenericList<MasterUserCategory>(_dtResults, MasterUserCategory.CategoryConverter);
            }
            return _userCategory;
        }

        //kapila 26/3/2012
        public MasterUserCategory GetUserCatByCode(string _CatCode)
        {
            MasterUserCategory _userCatList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CatCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_usr_cat_by_cd", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userCatList = DataTableExtensions.ToGenericList<MasterUserCategory>(_dtResults, MasterUserCategory.BaseConverter)[0];
            }
            return _userCatList;
        }

        #endregion

        #region master department
        public List<MasterDepartment> GetDepartment()
        {
            List<MasterDepartment> _userDepartment = null;

            DataTable _dtResults = QueryDataTable("tblUserDepartment", "sp_getdept", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            if (_dtResults.Rows.Count > 0)
            {
                _userDepartment = DataTableExtensions.ToGenericList<MasterDepartment>(_dtResults, MasterDepartment.DeptConverter);
            }
            return _userDepartment;
        }

        //kapila 26/3/2012
        public MasterDepartment GetDeptByCode(string _DeptCode)
        {
            MasterDepartment _deptList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DeptCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_dept_by_cd", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _deptList = DataTableExtensions.ToGenericList<MasterDepartment>(_dtResults, MasterDepartment.BaseConverter)[0];
            }
            return _deptList;
        }
        #endregion

        #region Master Types
        public List<MasterType> GetAllTypes(string _cateCode)
        {
            List<MasterType> _masterType = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cateCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterType", "SP_GET_ALL_TYPES", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterType = DataTableExtensions.ToGenericList<MasterType>(_dtResults, MasterType.Converter);
            }
            return _masterType;
        }

        /// <summary>
        /// Created By : Miginda Geeganage On 26-03-2012
        /// </summary>
        /// <param name="_mainCode"></param>
        /// <returns></returns>
        public List<MasterSubType> GetAllSubTypes(string _mainCode)
        {
            List<MasterSubType> _masterSubType = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_main_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterSubType", "sp_get_all_subtypes", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterSubType = DataTableExtensions.ToGenericList<MasterSubType>(_dtResults, MasterSubType.Converter);
            }
            return _masterSubType;
        }

        /// <summary>
        /// Created By : Chamal De Silva On 23-05-2012
        /// </summary>
        /// <param name="_mainCode"></param>
        /// <returns></returns>
        public List<MasterType> GetOutwardTypes()
        {
            List<MasterType> _masterType = null;

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterType", "sp_get_outward_types", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterType = DataTableExtensions.ToGenericList<MasterType>(_dtResults, MasterType.Converter);
            }
            return _masterType;
        }
        #endregion

        #region Master Currency
        //Written By Prabhath on 21/05/2012
        public List<MasterCurrency> GetAllCurrency(string _currencyCode)
        {
            List<MasterCurrency> _masterType = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _currencyCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterCurrency", "sp_getcurrency", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterType = DataTableExtensions.ToGenericList<MasterCurrency>(_dtResults, MasterCurrency.Converter);
            }
            return _masterType;
        }
        #endregion

        #region Request Approval

        public List<RequestApprovalDetail> GetRequestApprovalDetails(RequestApprovalDetail _paramRequestApprovalDetails)
        {
            List<RequestApprovalDetail> _RequestApprovalDetailsList = null;
            RequestApprovalDetail _RequestApprovalDetails = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramRequestApprovalDetails.Grad_ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblPendingRequestApprovalDetails", "sp_get_pending_req_det", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _RequestApprovalDetailsList = new List<RequestApprovalDetail>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _RequestApprovalDetails = new RequestApprovalDetail();
                    _RequestApprovalDetails.Grad_ref = (_dtResults.Rows[i]["Grad_ref"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grad_ref"].ToString();
                    _RequestApprovalDetails.Grad_line = (_dtResults.Rows[i]["Grad_line"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Grad_line"]);
                    _RequestApprovalDetails.Grad_val1 = (_dtResults.Rows[i]["Grad_val1"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Grad_val1"]);
                    _RequestApprovalDetails.Grad_anal1 = (_dtResults.Rows[i]["Grad_anal1"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grad_anal1"].ToString();
                    _RequestApprovalDetails.Grad_anal2 = (_dtResults.Rows[i]["Grad_anal2"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grad_anal2"].ToString();
                    _RequestApprovalDetails.Grad_anal3 = (_dtResults.Rows[i]["Grad_anal3"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grad_anal3"].ToString();
                    _RequestApprovalDetails.Grad_date_param = (_dtResults.Rows[i]["Grad_date_param"] == DBNull.Value) ? DateTime.MinValue : Convert.ToDateTime(_dtResults.Rows[i]["Grad_date_param"]);
                    _RequestApprovalDetailsList.Add(_RequestApprovalDetails);
                }

            }

            return _RequestApprovalDetailsList;

        }

        //Darshana - 06/06/2012
        public List<RequestApprovalHeader> GetAllPendingRequest(RequestApprovalHeader _paramRequestApproval)
        {
            List<RequestApprovalHeader> _RequestApprovalList = null;
            RequestApprovalHeader _RequestApproval = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramRequestApproval.Grah_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramRequestApproval.Grah_loc;
            (param[2] = new OracleParameter("p_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramRequestApproval.Grah_app_stus;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tblPendingRequestApproval", "sp_get_pending_req_app", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _RequestApprovalList = new List<RequestApprovalHeader>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _RequestApproval = new RequestApprovalHeader();
                    //(_dtResults.Rows[i]["POH_SEQ_NO"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["POH_SEQ_NO"]);
                    //(_dtResults.Rows[i]["grah_app_tp"] == DBNull.Value) ? DateTime.MinValue : Convert.ToDateTime(_dtResults.Rows[i]["POH_DT"]);
                    _RequestApproval.Grah_com = (_dtResults.Rows[i]["Grah_com"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_com"].ToString();
                    _RequestApproval.Grah_loc = (_dtResults.Rows[i]["grah_loc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["grah_loc"].ToString();
                    _RequestApproval.Grah_app_tp = (_dtResults.Rows[i]["grah_app_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["grah_app_tp"].ToString();
                    _RequestApproval.Grah_fuc_cd = (_dtResults.Rows[i]["Grah_fuc_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_fuc_cd"].ToString();
                    _RequestApproval.Grah_ref = (_dtResults.Rows[i]["Grah_ref"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_ref"].ToString();
                    _RequestApproval.Grah_oth_loc = (_dtResults.Rows[i]["Grah_oth_loc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_oth_loc"].ToString();
                    _RequestApproval.Grah_cre_by = (_dtResults.Rows[i]["Grah_cre_by"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_cre_by"].ToString();
                    _RequestApproval.Grah_cre_dt = (_dtResults.Rows[i]["Grah_cre_dt"] == DBNull.Value) ? DateTime.MinValue : Convert.ToDateTime(_dtResults.Rows[i]["Grah_cre_dt"]);
                    _RequestApproval.Grah_mod_by = (_dtResults.Rows[i]["Grah_mod_by"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_mod_by"].ToString();
                    _RequestApproval.Grah_mod_dt = (_dtResults.Rows[i]["Grah_mod_dt"] == DBNull.Value) ? DateTime.MinValue : Convert.ToDateTime(_dtResults.Rows[i]["Grah_mod_dt"]);
                    _RequestApproval.Grah_app_stus = (_dtResults.Rows[i]["Grah_app_stus"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_app_stus"].ToString();
                    _RequestApproval.Grah_app_lvl = (_dtResults.Rows[i]["Grah_app_lvl"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["Grah_app_lvl"]);
                    _RequestApproval.Grah_app_by = (_dtResults.Rows[i]["Grah_app_by"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_app_by"].ToString();
                    _RequestApproval.Grah_app_dt = (_dtResults.Rows[i]["Grah_app_dt"] == DBNull.Value) ? DateTime.MinValue : Convert.ToDateTime(_dtResults.Rows[i]["Grah_app_dt"]);
                    _RequestApproval.Grah_remaks = (_dtResults.Rows[i]["Grah_remaks"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Grah_remaks"].ToString();
                    _RequestApprovalList.Add(_RequestApproval);
                }

            }

            return _RequestApprovalList;
        }

        public Int16 UpdateCreditNoteExchange(string _ref, string _cnote)
        {
            Int16 rows_affected = 0;
            try
            {// Nadeeka
                //Create parameters and assign values.
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
                (param[1] = new OracleParameter("p_cnote", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cnote;


                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                //Open the connection and call the stored procedure.
                //ConnectionOpen();
                rows_affected = (Int16)this.UpdateRecords("sp_update_exchange_cnote", CommandType.StoredProcedure, param);

            }
            catch (Exception e)
            {
                rows_affected = -1;
                throw new Exception(e.Message);
            }
            finally
            {
                //ConnectionClose();
            }

            return rows_affected;
        }

        public Int16 UpdateApprovalStatus(RequestApprovalHeader _UpdateApproval)
        {
            Int16 rows_affected = 0;
            try
            {
                //Create parameters and assign values.
                OracleParameter[] param = new OracleParameter[12];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_com;
                (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_loc;
                (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_fuc_cd;
                (param[3] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_ref;
                (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_app_stus;
                (param[5] = new OracleParameter("p_app_lvl", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_app_lvl;
                (param[6] = new OracleParameter("p_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_app_by;
                (param[7] = new OracleParameter("p_grah_remaks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_remaks;
                (param[8] = new OracleParameter("p_grah_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_sub_type;
                (param[9] = new OracleParameter("p_grah_anal1", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_anal1;
                (param[10] = new OracleParameter("p_grah_anal2", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_anal2;

                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                //Open the connection and call the stored procedure.
                //ConnectionOpen();
                rows_affected = (Int16)this.UpdateRecords("sp_update_approve_status", CommandType.StoredProcedure, param);

            }
            catch (Exception e)
            {
                rows_affected = -1;
                throw new Exception(e.Message);
            }
            finally
            {
                //ConnectionClose();
            }

            return rows_affected;
        }

        //Code by Chamal De Silva 03-08-2012
        public Int16 UpdateMidApprovalStatus(RequestApprovalHeader _UpdateApproval)
        {
            Int16 rows_affected = 0;
            try
            {
                //Create parameters and assign values.
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_com;
                (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_loc;
                (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_fuc_cd;
                (param[3] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_ref;
                (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_app_stus;
                (param[5] = new OracleParameter("p_app_lvl", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_app_lvl;
                (param[6] = new OracleParameter("p_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UpdateApproval.Grah_app_by;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                //Open the connection and call the stored procedure.
                //ConnectionOpen();
                rows_affected = (Int16)this.UpdateRecords("sp_update_mid_app_status", CommandType.StoredProcedure, param);

            }
            catch (Exception e)
            {
                rows_affected = -1;
                throw new Exception(e.Message);
            }
            finally
            {
                //ConnectionClose();
            }

            return rows_affected;
        }

        public RequestApprovalHeader GetRequestApprovalHeaderByRequestNo(string _company, string _location, string _request)
        {
            //getrequestheaderfromrequestno(p_com in NVARCHAR2,p_loc in NVARCHAR2,  p_reqno in NVARCHAR2,c_data out sys_refcursor)
            RequestApprovalHeader _RequestApproval = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblTbl", "getrequestheaderfromrequestno", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _RequestApproval = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter)[0];
            }

            return _RequestApproval;
        }

        #endregion

        #region Check back date *** Chamal De Silva 29/06/2012
        public BackDates IsAllowBackDate(string _com, string _ope, string _channel, string _loc, string _pc, string _backdate)
        {
            BackDates _backdates = null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ope;
            (param[2] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblBackDate", "sp_checkbackdate", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _backdates = DataTableExtensions.ToGenericList<BackDates>(_dtResults, BackDates.Converter)[0];
                if (!((_backdates.Gad_from_dt <= DateTime.Now) && (_backdates.Gad_to_dt >= DateTime.Now))) _backdates = null;
            }
            return _backdates;
        }

        public BackDates IsAllowBackDateForModule(string _com, string _ope, string _channel, string _loc, string _pc, string _module, string _backdate)
        {
            BackDates _backdates = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ope;
            (param[2] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            (param[6] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblBackDate", "sp_checkbackdatemodule", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                //Edit by Chamal 26-Sep-2013 ***** Asanka Mohan Method
                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _backdates = DataTableExtensions.ToGenericList<BackDates>(_dtResults, BackDates.Converter)[i];
                    if (((_backdates.Gad_from_dt <= DateTime.Now) && (_backdates.Gad_to_dt >= DateTime.Now)))
                    {
                        return _backdates;
                    }
                    else
                    {
                        _backdates = null;
                    }
                }
                //********
            }
            return _backdates;
        }
        #endregion

        //kapila 2/7/2012
        #region master outside party
        public int SaveOutsideParty(MasterOutsideParty _outsideParty)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[24];

                (param[0] = new OracleParameter("p_MBI_COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_country_cd;
                (param[1] = new OracleParameter("p_MBI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_cd;
                (param[2] = new OracleParameter("p_MBI_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_desc;
                (param[3] = new OracleParameter("p_MBI_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_tp;
                (param[4] = new OracleParameter("p_MBI_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_id;
                (param[5] = new OracleParameter("p_MBI_ISSUB", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_issub;
                (param[6] = new OracleParameter("p_MBI_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_add1;
                (param[7] = new OracleParameter("p_MBI_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_add2;
                (param[8] = new OracleParameter("p_MBI_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_tel;
                (param[9] = new OracleParameter("p_MBI_FAX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_fax;
                (param[10] = new OracleParameter("p_MBI_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_email;
                (param[11] = new OracleParameter("p_MBI_WEB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_web;
                (param[12] = new OracleParameter("p_MBI_TOWN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_town_cd;
                (param[13] = new OracleParameter("p_MBI_TAX1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_tax1;
                (param[14] = new OracleParameter("p_MBI_TAX2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_tax2;
                (param[15] = new OracleParameter("p_MBI_TAX3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_tax3;
                (param[16] = new OracleParameter("p_MBI_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_act;
                (param[17] = new OracleParameter("p_MBI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_cre_by;
                (param[18] = new OracleParameter("p_MBI_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_cre_when;
                (param[19] = new OracleParameter("p_MBI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_mod_by;
                (param[20] = new OracleParameter("p_MBI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_mod_dt;
                (param[21] = new OracleParameter("p_MBI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_session_id;
                (param[22] = new OracleParameter("P_MBI_SUN_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outsideParty.Mbi_sun_bank;
                param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_save_outside_party", CommandType.StoredProcedure, param);


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        public MasterOutsideParty GetOutsideParty(string _code)
        {

            MasterOutsideParty _outsidePartyList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _DT = QueryDataTable("tblItem", "sp_get_alloutside_parties", CommandType.StoredProcedure, false, param);
            if (_DT.Rows.Count > 0)
            {
                _outsidePartyList = DataTableExtensions.ToGenericList<MasterOutsideParty>(_DT, MasterOutsideParty.ConvertTotal)[0];
            }
            return _outsidePartyList;

        }
        #endregion

        public Int32 GetSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getserialid", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By P.Wijetunge on 9/4/2012
        public Int16 UpdateAutoNumber(MasterAutoNumber _masterAutoNumber)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_moduleid;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_start_char;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_tp;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_cd;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_modify_dt;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_year;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_updateautonumber", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        public MasterAutoNumber GetAutoNumber(string _module, Int32? _direction, string _startChar, string _catType, string _catCode, DateTime? _modifyDate, Int32? _year)
        {
            OracleParameter[] param = new OracleParameter[8];
            MasterAutoNumber _masterAutoNumber = new MasterAutoNumber();

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startChar;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catType;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catCode;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _modifyDate;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAuto", "sp_autonumber", CommandType.StoredProcedure, false, param);
            //   p_module IN NVARCHAR2,p_direction IN NUMBER,p_startchar IN NVARCHAR2,p_cattype in NVARCHAR2,p_catcode in NVARCHAR2,p_modifydate in DATE,p_year in NUMBER ,c_data out SYS_REFCURSOR
            if (_dtResults.Rows.Count > 0)
            {
                _masterAutoNumber = DataTableExtensions.ToGenericList<MasterAutoNumber>(_dtResults, MasterAutoNumber.ConvertTotal)[0];
            }
            else if (_dtResults.Rows.Count == 0)
            {

                _masterAutoNumber.Aut_cate_cd = _catCode;
                _masterAutoNumber.Aut_cate_tp = _catType;
                _masterAutoNumber.Aut_direction = _direction;
                _masterAutoNumber.Aut_modify_dt = _modifyDate;
                _masterAutoNumber.Aut_moduleid = _module;
                _masterAutoNumber.Aut_number = 1;
                _masterAutoNumber.Aut_start_char = _startChar;
                _masterAutoNumber.Aut_year = _year;
            }

            return _masterAutoNumber;
        }

        public Int32 SaveRequestApproveHear(RequestApprovalHeader ReqApp_hdr)
        {
            OracleParameter[] param = new OracleParameter[24];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grah_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_com;
            (param[1] = new OracleParameter("p_grah_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_loc;
            (param[2] = new OracleParameter("p_grah_app_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_app_tp;
            (param[3] = new OracleParameter("p_grah_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_fuc_cd;
            (param[4] = new OracleParameter("p_grah_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_ref;
            (param[5] = new OracleParameter("p_grah_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_oth_loc;
            (param[6] = new OracleParameter("p_grah_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_cre_by;
            (param[7] = new OracleParameter("p_grah_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_cre_dt;
            (param[8] = new OracleParameter("p_grah_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_mod_by;

            (param[9] = new OracleParameter("p_grah_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_mod_dt;
            (param[10] = new OracleParameter("p_grah_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_app_stus;
            (param[11] = new OracleParameter("p_grah_app_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_app_lvl;
            (param[12] = new OracleParameter("p_grah_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_app_by;
            (param[13] = new OracleParameter("p_grah_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_app_dt;
            (param[14] = new OracleParameter("p_grah_remaks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_remaks;
            (param[15] = new OracleParameter("p_grah_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_sub_type;
            (param[16] = new OracleParameter("p_grah_oth_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_oth_pc;
            (param[17] = new OracleParameter("p_grah_anal1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_anal1;
            (param[18] = new OracleParameter("p_grah_anal2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_anal2;
            (param[19] = new OracleParameter("p_grah_req_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_req_rem;
            (param[20] = new OracleParameter("p_grah_is_alw_freeitmisu", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_is_alw_freitmisu;
            (param[21] = new OracleParameter("p_grah_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_anal3; // add by akila 2017/09/06
            (param[22] = new OracleParameter("p_grah_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdr.Grah_anal4;// add by akila 2017/09/06
            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_RequestApprove_hdr_new", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveRequestApproveHear_Log(RequestApprovalHeaderLog ReqApp_hdrLog)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grah_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_com;
            (param[1] = new OracleParameter("p_grah_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_loc;
            (param[2] = new OracleParameter("p_grah_app_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_app_tp;
            (param[3] = new OracleParameter("p_grah_fuc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_fuc_cd;
            (param[4] = new OracleParameter("p_grah_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_ref;
            (param[5] = new OracleParameter("p_grah_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_oth_loc;
            (param[6] = new OracleParameter("p_grah_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_cre_by;
            (param[7] = new OracleParameter("p_grah_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_cre_dt;
            (param[8] = new OracleParameter("p_grah_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_mod_by;

            (param[9] = new OracleParameter("p_grah_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_mod_dt;
            (param[10] = new OracleParameter("p_grah_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_app_stus;
            (param[11] = new OracleParameter("p_grah_app_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_app_lvl;
            (param[12] = new OracleParameter("p_grah_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_app_by;
            (param[13] = new OracleParameter("p_grah_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_app_dt;
            (param[14] = new OracleParameter("p_grah_remaks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_remaks;
            (param[15] = new OracleParameter("p_grah_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_sub_type;
            (param[16] = new OracleParameter("p_grah_oth_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_oth_pc;
            (param[17] = new OracleParameter("p_grah_anal1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_anal1;
            (param[18] = new OracleParameter("p_grah_anal2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_anal2;
            (param[19] = new OracleParameter("p_grah_req_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_hdrLog.Grah_req_rem;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int32)UpdateRecords("sp_save_RequestApprove_hdrLog", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_RequestApprove_Det(RequestApprovalDetail ReqApp_det)
        {// Nadeeka 23-12-2014
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grad_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_ref;
            (param[1] = new OracleParameter("p_grad_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_line;
            (param[2] = new OracleParameter("p_grad_req_param", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_req_param;
            (param[3] = new OracleParameter("p_grad_anal15", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal15;
            (param[4] = new OracleParameter("p_grad_val2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val2;
            (param[5] = new OracleParameter("p_grad_val5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val5;
            (param[6] = new OracleParameter("p_grad_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal1;
            (param[7] = new OracleParameter("p_grad_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal2;
            (param[8] = new OracleParameter("p_grad_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal3;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_RequestApprove_Det", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Save_RequestApprove_Det(RequestApprovalDetail ReqApp_det)
        {
            OracleParameter[] param = new OracleParameter[32];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grad_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_ref;
            (param[1] = new OracleParameter("p_grad_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_line;
            (param[2] = new OracleParameter("p_grad_req_param", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_req_param;
            (param[3] = new OracleParameter("p_grad_val1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val1;
            (param[4] = new OracleParameter("p_grad_val2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val2;
            (param[5] = new OracleParameter("p_grad_val3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val3;
            (param[6] = new OracleParameter("p_grad_val4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val4;
            (param[7] = new OracleParameter("p_grad_val5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_val5;
            (param[8] = new OracleParameter("p_grad_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal1;

            (param[9] = new OracleParameter("p_grad_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal2;
            (param[10] = new OracleParameter("p_grad_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal3;
            (param[11] = new OracleParameter("p_grad_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal4;
            (param[12] = new OracleParameter("p_grad_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal5;
            (param[13] = new OracleParameter("p_grad_date_param", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_date_param;
            (param[14] = new OracleParameter("p_grad_is_rt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_is_rt1 == false ? 0 : 1;
            (param[15] = new OracleParameter("p_grad_is_rt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_is_rt2;

            (param[16] = new OracleParameter("p_grad_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal6;
            (param[17] = new OracleParameter("p_grad_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal7;
            (param[18] = new OracleParameter("p_grad_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal8;
            (param[19] = new OracleParameter("p_grad_anal9", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal9;
            (param[20] = new OracleParameter("p_grad_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal10;
            (param[21] = new OracleParameter("p_grad_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal11;
            (param[22] = new OracleParameter("p_grad_anal12", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal12;
            (param[23] = new OracleParameter("p_grad_anal13", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal13;
            (param[24] = new OracleParameter("p_grad_anal14", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal14;
            (param[25] = new OracleParameter("p_grad_anal15", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal15;
            (param[26] = new OracleParameter("p_grad_anal16", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal16;
            (param[27] = new OracleParameter("p_grad_anal17", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal17;
            (param[28] = new OracleParameter("p_grad_anal18", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_anal18;
            (param[29] = new OracleParameter("p_grad_cred_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_cred_val;
            (param[30] = new OracleParameter("p_grad_inv_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_det.Grad_inv_line;

            param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_RequestApprove_Det", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Save_RequestApprove_Det_Log(RequestApprovalDetailLog ReqApp_detLog)
        {

            OracleParameter[] param = new OracleParameter[31];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grad_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_ref;
            (param[1] = new OracleParameter("p_grad_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_line;
            (param[2] = new OracleParameter("p_grad_req_param", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_req_param;
            (param[3] = new OracleParameter("p_grad_val1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_val1;
            (param[4] = new OracleParameter("p_grad_val2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_val2;
            (param[5] = new OracleParameter("p_grad_val3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_val3;
            (param[6] = new OracleParameter("p_grad_val4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_val4;
            (param[7] = new OracleParameter("p_grad_val5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_val5;
            (param[8] = new OracleParameter("p_grad_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal1;

            (param[9] = new OracleParameter("p_grad_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal2;
            (param[10] = new OracleParameter("p_grad_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal3;
            (param[11] = new OracleParameter("p_grad_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal4;
            (param[12] = new OracleParameter("p_grad_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal5;
            (param[13] = new OracleParameter("p_grad_date_param", OracleDbType.Date, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_date_param;
            (param[14] = new OracleParameter("p_grad_is_rt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_is_rt1;
            (param[15] = new OracleParameter("p_grad_is_rt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_is_rt2;

            (param[16] = new OracleParameter("p_grad_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_lvl;


            (param[17] = new OracleParameter("p_grad_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal6;
            (param[18] = new OracleParameter("p_grad_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal7;
            (param[19] = new OracleParameter("p_grad_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal8;
            (param[20] = new OracleParameter("p_grad_anal9", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal9;
            (param[21] = new OracleParameter("p_grad_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal10;
            (param[22] = new OracleParameter("p_grad_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal11;
            (param[23] = new OracleParameter("p_grad_anal12", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal12;
            (param[24] = new OracleParameter("p_grad_anal13", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal13;
            (param[25] = new OracleParameter("p_grad_anal14", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal14;
            (param[26] = new OracleParameter("p_grad_anal15", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal15;
            (param[27] = new OracleParameter("p_grad_anal16", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal16;
            (param[28] = new OracleParameter("p_grad_anal17", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal17;
            (param[29] = new OracleParameter("p_grad_anal18", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_detLog.Grad_anal18;

            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_RequestApprove_DetLog", CommandType.StoredProcedure, param);
            return effects;
        }

        public int DeleteAppReq(string _request)
        { // NADEEKA 04-06-2015 Move From Inventroy DAL to Genera DAL
            // sp_deletegenapptable(p_requestno in NVARCHAR2,o_effect out NUMBER)
            int effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_requestno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_deletegenapptable", CommandType.StoredProcedure, param);

            return effect;
        }

        public DataTable GetApprovedRequestDetails(string com, string pc, string fucCD, string appType, Int32 isInApprovedStatus, Int32 userApprovalLevel)
        {   //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_fucCD in NVARCHAR2, p_appType in NVARCHAR2,p_isapproval in NUMBER,p_approvallevel in NUMBER

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_fucCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fucCD;
            (param[3] = new OracleParameter("p_appType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appType;
            (param[4] = new OracleParameter("p_isapproval", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isInApprovedStatus;
            (param[5] = new OracleParameter("p_approvallevel", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userApprovalLevel;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_getApprovalRequests", CommandType.StoredProcedure, false, param);//this sp can be used to query pending requests also
            return tblDet;
        }

        public List<RequestApprovalHeader> GetApprovedRequestDetailsList(string com, string pc, string fucCD, string appType, Int32 isInApprovedStatus, Int32 userApprovalLevel)
        {   //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_fucCD in NVARCHAR2, p_appType in NVARCHAR2,p_isapproval in NUMBER,p_approvallevel in NUMBER

            List<RequestApprovalHeader> _list = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_fucCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fucCD;
            (param[3] = new OracleParameter("p_appType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appType;
            (param[4] = new OracleParameter("p_isapproval", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isInApprovedStatus;
            (param[5] = new OracleParameter("p_approvallevel", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userApprovalLevel;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_getApprovalRequests", CommandType.StoredProcedure, false, param);//this sp can be used to query pending requests also

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(tblDet, RequestApprovalHeader.ConvertWithDetail);
            }
            return _list;
        }

        //Writtebn By Chamal 02/08/2012
        public List<RequestApprovalDetailLog> GetRequestApprovalDetailLog(string seqNo)
        {
            List<RequestApprovalDetailLog> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_GRAD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GETREQAPPDETLOG", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalDetailLog>(tblDet, RequestApprovalDetailLog.Converter);
            }
            return _list;
        }

        //Writtebn By Prabhath 19/07/2012
        public Int32 DeleteRequestHeaderDetail(string _id)
        {
            //sp_deleterequestheaderdetail
            int effected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _id;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_deleterequestheaderdetail", CommandType.StoredProcedure, param);
            return effected;
        }

        //kapila
        //Udesh Add string _company parameter - 08-Oct-2018
        public DataTable GetReprintDocs(string _docType, string _loc, string _pc, string _company, DateTime _fromDate, DateTime _toDate)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;//Udesh - 08-Oct-2018
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_reprint_docs", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila

        public int SaveReprintDocRequest(Reprint_Docs _reprintDoc)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[16];

                (param[0] = new OracleParameter("p_DRP_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_seq_no;
                (param[1] = new OracleParameter("p_DRP_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_tp;
                (param[2] = new OracleParameter("p_DRP_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_doc_no;
                (param[3] = new OracleParameter("p_DRP_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_doc_dt;
                (param[4] = new OracleParameter("p_DRP_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_loc;
                (param[5] = new OracleParameter("p_DRP_REQ_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_req_dt;
                (param[6] = new OracleParameter("p_DRP_IS_ADD_PENDING", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_is_add_pending;
                (param[7] = new OracleParameter("p_DRP_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_stus;
                (param[8] = new OracleParameter("p_DRP_APP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_app_dt;
                (param[9] = new OracleParameter("p_DRP_CAN_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_can_dt;
                (param[10] = new OracleParameter("p_DRP_REJ_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_rej_dt;
                (param[11] = new OracleParameter("p_DRP_STUS_CHANGE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_stus_change_by;
                (param[12] = new OracleParameter("p_DRP_PRINTED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_printed;
                (param[13] = new OracleParameter("p_DRP_PRINT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_print_dt;
                (param[14] = new OracleParameter("p_DRP_REASON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reprintDoc.Drp_reason;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_save_reprint_doc", CommandType.StoredProcedure, param);


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        //kapila
        public DataTable GetRequestedReprintDocs(string _loc, string _status, DateTime _fromDate, DateTime _toDate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_req_reprint_doc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public int UpdatePrintStatus(string _docno)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
                param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_update_reprint", CommandType.StoredProcedure, param);
            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        //kapila
        public Boolean IsReprintDocFound(string _docno)
        {
            //ConnectionOpen();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsReprintDocFound = QueryDataTable("tbl", "sp_check_reprint_doc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return _IsReprintDocFound;
        }

        //kapila
        public Boolean IsBackDateFound(string _pc, DateTime _date, string _module)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (_para[2] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsBackDateFound = QueryDataTable("tbl", "sp_check_backdate", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsBackDateFound;
        }

        public int UpdateReprintApproval(string _docno, string _status, string _statusChg)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
                (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param[2] = new OracleParameter("p_stus_chg_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _statusChg;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_update_reprint_approve", CommandType.StoredProcedure, param);
            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }


        //sachith
        public DataTable GetVehicalRegistrationBrand(string _mainCt, string _SubCt, string _Range, string _code, string _brand, string _type)
        {

            _mainCt = (!string.IsNullOrEmpty(_mainCt)) ? (_mainCt.ToUpper() + "%") : "%";
            _SubCt = (!string.IsNullOrEmpty(_SubCt)) ? (_SubCt.ToUpper() + "%") : "%";
            _Range = (!string.IsNullOrEmpty(_Range)) ? (_Range.ToUpper() + "%") : "%";
            _code = (!string.IsNullOrEmpty(_code)) ? (_code.ToUpper() + "%") : "%";
            _brand = (!string.IsNullOrEmpty(_brand)) ? (_brand.ToUpper() + "%") : "%";


            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCt;
            (param[1] = new OracleParameter("p_sub_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SubCt;
            (param[2] = new OracleParameter("p_range", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Range;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_getvehicalregbrand", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //sachith
        public DataTable GetPartyTypes()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getpartytypes", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateCashComEndDate(string _comm, DateTime _toDate, string _user)
        {

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_comm_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comm;
            (param[1] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_upd_com_def", CommandType.StoredProcedure, param);

            return result;
        }

        //sachith
        public DataTable GetPartyCodes(string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            _loc = (!string.IsNullOrEmpty(_loc)) ? (_loc.ToUpper() + "%") : "%";
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getpartycodes", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //sachith
        public DataTable GetSalesTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            OracleParameter[] param = new OracleParameter[3];
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _salesCode = null;
            string _salesDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SRTP_CD":
                        _salesCode = _searchText;
                        break;

                    case "SRTP_DESC":
                        _salesDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _salesCode = (_salesCode != null) ? (_salesCode.ToUpper() + "%") : "%";
            _salesDesc = (_salesDesc != null) ? (_salesDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesCode;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesDesc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getsalestype", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //sachith
        public Int32 SaveVehicalRegistrationDefinition(List<MasterProfitCenter> pcs, List<string> items, DateTime from, DateTime to, string satlesType, decimal regVal, decimal calVal, string cre, int isMan)
        {
            try
            {
                int rows_aff = 0;
                InventoryDAL inv = new InventoryDAL();
                foreach (MasterProfitCenter pc in pcs)
                {
                    foreach (string st in items)
                    {

                        OracleParameter[] param = new OracleParameter[13];

                        // ConnectionOpen();
                        inv.ConnectionOpen();
                        (param[0] = new OracleParameter("p_svrd_seq", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inv.GetSerialID();
                        (param[1] = new OracleParameter("p_svrd_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_com;
                        (param[2] = new OracleParameter("p_svrd_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_cd;
                        (param[3] = new OracleParameter("p_svrd_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
                        (param[4] = new OracleParameter("p_svrd_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
                        (param[5] = new OracleParameter("p_svrd_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satlesType;
                        (param[6] = new OracleParameter("p_svrd_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st;
                        (param[7] = new OracleParameter("p_svrd_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = regVal;
                        (param[8] = new OracleParameter("p_svrd_claim_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = calVal;
                        (param[9] = new OracleParameter("p_svrd_is_req", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isMan;
                        (param[10] = new OracleParameter("p_svrd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cre;
                        (param[11] = new OracleParameter("p_svrd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                        param[12] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);
                        rows_aff = UpdateRecords("sp_savevehicalregdifinition", CommandType.StoredProcedure, param);
                        rows_aff = rows_aff + rows_aff;

                    }
                }
                // ConnectionClose();
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public DataTable GetRequestApprovalDetailFromLog(string seqNo)
        {
            List<RequestApprovalDetailLog> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_GRAD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = new DataTable();
            tblDet = QueryDataTable("tbl_det", "SP_GETREQAPPDETLOG", CommandType.StoredProcedure, false, param);


            return tblDet;
        }


        //sachith
        public DataTable GetVehicalreciept(string _com, string _loc, string _type)
        {
            OracleParameter[] param = new OracleParameter[4];
            _com = (!string.IsNullOrEmpty(_com)) ? (_com.ToUpper()) : "%";
            _loc = (!string.IsNullOrEmpty(_loc)) ? (_loc.ToUpper()) : "%";

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getvehicalregistrationnumbe", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //sachith
        public Int32 SaveVehicalRegistration(VehicalRegistration vehical)
        {
            try
            {
                int rows_aff = 0;
                OracleParameter[] param = new OracleParameter[92];
                (param[0] = new OracleParameter("p_srvt_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_srvt_ref_no;
                (param[1] = new OracleParameter("p_svrt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_com;
                (param[2] = new OracleParameter("p_svrt_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_pc;
                (param[3] = new OracleParameter("p_svrt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_dt;
                (param[4] = new OracleParameter("p_svrt_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_inv_no;
                (param[5] = new OracleParameter("p_svrt_sales_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_sales_tp;
                (param[6] = new OracleParameter("p_svrt_reg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_reg_val;
                (param[7] = new OracleParameter("p_svrt_claim_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_claim_val;
                (param[8] = new OracleParameter("p_svrt_id_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_id_tp;
                (param[9] = new OracleParameter("p_svrt_id_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_id_ref;
                (param[10] = new OracleParameter("p_svrt_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_cust_cd;
                (param[11] = new OracleParameter("p_svrt_cust_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_cust_title;
                (param[12] = new OracleParameter("p_svrt_last_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_last_name;
                (param[13] = new OracleParameter("p_svrt_full_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_full_name;
                (param[14] = new OracleParameter("p_svrt_initial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_initial;
                (param[15] = new OracleParameter("p_svrt_add01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_add01;
                (param[16] = new OracleParameter("p_svrt_add02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_add02;
                (param[17] = new OracleParameter("p_svrt_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_city;
                (param[18] = new OracleParameter("p_svrt_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_district;
                (param[19] = new OracleParameter("p_svrt_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_province;
                (param[20] = new OracleParameter("p_svrt_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_contact;
                (param[21] = new OracleParameter("p_svrt_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_model;
                (param[22] = new OracleParameter("p_svrt_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_brd;
                (param[23] = new OracleParameter("p_svrt_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_chassis;
                (param[24] = new OracleParameter("p_svrt_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_engine;
                (param[25] = new OracleParameter("p_svrt_color", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_color;
                (param[26] = new OracleParameter("p_svrt_fuel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_fuel;
                (param[27] = new OracleParameter("p_svrt_capacity", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_capacity;
                (param[28] = new OracleParameter("p_svrt_unit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_unit;
                (param[29] = new OracleParameter("p_svrt_horse_power", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_horse_power;
                (param[30] = new OracleParameter("p_svrt_wheel_base", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_wheel_base;
                (param[31] = new OracleParameter("p_svrt_tire_front", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_tire_front;
                (param[32] = new OracleParameter("p_svrt_tire_rear", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_tire_rear;
                (param[33] = new OracleParameter("p_svrt_weight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_weight;
                (param[34] = new OracleParameter("p_svrt_man_year", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_man_year;
                (param[35] = new OracleParameter("p_svrt_import", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_import;
                (param[36] = new OracleParameter("p_svrt_authority", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_authority;
                (param[37] = new OracleParameter("p_svrt_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_country;
                (param[38] = new OracleParameter("p_svrt_custom_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_custom_dt;
                (param[39] = new OracleParameter("p_svrt_clear_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_clear_dt;
                (param[40] = new OracleParameter("p_svrt_declear_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_declear_dt;
                (param[41] = new OracleParameter("p_svrt_importer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_importer;
                (param[42] = new OracleParameter("p_svrt_importer_add01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_importer_add01;
                (param[43] = new OracleParameter("p_svrt_importer_add02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_importer_add02;
                (param[44] = new OracleParameter("p_svrt_cre_bt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_cre_bt;
                (param[45] = new OracleParameter("p_svrt_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_cre_dt;
                (param[46] = new OracleParameter("p_svrt_prnt_stus", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_svrt_prnt_stus;
                (param[47] = new OracleParameter("p_svrt_prnt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_prnt_by;
                (param[48] = new OracleParameter("p_svrt_prnt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_prnt_dt;
                (param[49] = new OracleParameter("p_srvt_rmv_stus", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_srvt_rmv_stus;
                (param[50] = new OracleParameter("p_srvt_rmv_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_srvt_rmv_by;
                (param[51] = new OracleParameter("p_srvt_rmv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_srvt_rmv_dt;
                (param[52] = new OracleParameter("p_svrt_veh_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_veh_reg_no;
                (param[53] = new OracleParameter("p_svrt_reg_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_reg_by;
                (param[54] = new OracleParameter("p_svrt_reg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_svrt_reg_dt;
                (param[55] = new OracleParameter("p_svrt_image", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_svrt_image;
                (param[56] = new OracleParameter("p_srvt_cust_stus", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_srvt_cust_stus;
                (param[57] = new OracleParameter("p_srvt_cust_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_srvt_cust_by;
                (param[58] = new OracleParameter("p_srvt_cust_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_srvt_cust_dt;
                (param[59] = new OracleParameter("p_srvt_cls_stus", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = vehical.P_srvt_cls_stus;
                (param[60] = new OracleParameter("p_srvt_cls_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_srvt_cls_by;
                (param[61] = new OracleParameter("p_srvt_cls_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.P_srvt_cls_dt;
                (param[62] = new OracleParameter("p_srvt_insu_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.P_srvt_insu_ref;
                (param[63] = new OracleParameter("p_srvt_cr_pod_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.Srvt_cr_pod_ref;
                (param[64] = new OracleParameter("p_srvt_no_plt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.Srvt_no_plt_dt;
                (param[65] = new OracleParameter("p_srvt_no_plt_pod_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.Srvt_no_plt_pod_ref;

                (param[66] = new OracleParameter("p_srvt_rmv_time", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_RMV_TIME;
                (param[67] = new OracleParameter("p_SVRT_REG_TIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SVRT_REG_TIME;
                (param[68] = new OracleParameter("p_srvt_cust_time", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_CUST_TIME;
                (param[69] = new OracleParameter("p_srvt_cls_time", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_CLS_TIME;
                (param[70] = new OracleParameter("p_srvt_no_plt_time", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_NO_PLT_TIME;
                (param[71] = new OracleParameter("p_srvt_plt_rec_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.SRVT_PLT_REC_BY;
                (param[72] = new OracleParameter("p_srvt_plt_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_PLT_REC_DT;
                (param[73] = new OracleParameter("p_srvt_plt_rec_time", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_PLT_REC_TIME;
                (param[74] = new OracleParameter("p_srvt_plt_rec_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.SRVT_PLT_REC_REM;

                (param[75] = new OracleParameter("p_srvt_is_resend", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_RESEND;
                (param[76] = new OracleParameter("p_srvt_resend_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_RESEND_DT;
                (param[77] = new OracleParameter("p_srvt_resend_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.SRVT_RESEND_REM;
                (param[78] = new OracleParameter("p_srvt_is_rerec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_REREC;
                (param[79] = new OracleParameter("p_srvt_rerec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_REREC_DT;

                (param[80] = new OracleParameter("p_srvt_cour_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.srvt_cour_to;
                (param[81] = new OracleParameter("p_srvt_is_ret_ho", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_RET_HO;
                (param[82] = new OracleParameter("p_srvt_ret_ho_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_RET_HO_DT;
                (param[83] = new OracleParameter("p_srvt_ret_ho_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.SRVT_RET_HO_REM;
                (param[84] = new OracleParameter("p_SRVT_CR_COUR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_CR_COUR_DT;

                (param[85] = new OracleParameter("P_SRVT_IS_TX_RP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_TX_RP;
                (param[86] = new OracleParameter("P_SRVT_IS_TX_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_TX_DT;
                (param[87] = new OracleParameter("P_SRVT_IS_TX_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_TX_REM;

                (param[88] = new OracleParameter("P_SRVT_IS_REC_RP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_REC_RP;
                (param[89] = new OracleParameter("P_SRVT_IS_REC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_REC_DT;
                (param[90] = new OracleParameter("P_SRVT_IS_REC_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vehical.SRVT_IS_REC_REM;
                param[91] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_updatevehiregistration", CommandType.StoredProcedure, param);
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        //sachith
        public List<VehicalRegistration> GetVehicalRegistrations(string _regNo)
        {
            List<VehicalRegistration> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getvehicalregistration", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<VehicalRegistration>(tblDet, VehicalRegistration.Converter);
            }
            return _list;
        }

        //sachith
        public int UpdateInsuranceFromReg(string _regNo, string _regBy, DateTime _regDate, string _ref)
        {
            try
            {
                int rows_aff = 0;
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_reg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
                (param[1] = new OracleParameter("p_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regBy;
                (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _regDate;
                (param[3] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
                param[4] = new OracleParameter("p_affect", OracleDbType.Int32, null, ParameterDirection.Output);
                rows_aff = UpdateRecords("update_insregistration", CommandType.StoredProcedure, param);
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public MasterProfitCenter GetPCByPCCode(string _CompCode, string _PCCode)
        {
            MasterProfitCenter _PCList = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_getprofitcenterdetail", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                // _PCList = DataTableExtensions.ToGenericList<MasterProfitCenter>(_dtResults, MasterProfitCenter.ConvertTotal)[0];
                _PCList = DataTableExtensions.ToGenericList<MasterProfitCenter>(_dtResults, MasterProfitCenter.ConvertTotalNEW)[0];
            }
            return _PCList;
        }

        //sachith
        public DataTable GetInsuranceCompanies()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_insurencecompanies", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //sachith
        public DataTable GetInsurancePolicies()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_insurancepolicies", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //kapila
        public DataTable GetESDTransactions(string _com, string _pc, string _epf, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_esd_txns", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //kapila
        public DataTable GetESDBalance(string _com, string _pc, string _epf, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_esd_bal", CommandType.StoredProcedure, false, param);
            return tblDet;
        }
        //sachith
        public Int32 SaveVehicalInsuranceDefinition(List<MasterProfitCenter> pcs, List<string> items, DateTime from, DateTime to, string satlesType, decimal regVal, string cre, string insCom, string insPol, int term, bool isReq)
        {
            try
            {
                int rows_aff = 0;
                InventoryDAL inv = new InventoryDAL();
                foreach (MasterProfitCenter pc in pcs)
                {
                    foreach (string st in items)
                    {
                        OracleParameter[] param = new OracleParameter[15];
                        // ConnectionOpen();
                        inv.ConnectionOpen();
                        (param[0] = new OracleParameter("p_seq", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inv.GetSerialID();
                        (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_com;
                        (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_cd;
                        (param[3] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insCom;
                        (param[4] = new OracleParameter("p_ins_pol", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insPol;
                        (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
                        (param[6] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
                        (param[7] = new OracleParameter("p_sales", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satlesType;
                        (param[8] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st;
                        (param[9] = new OracleParameter("p_value", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = regVal;
                        (param[10] = new OracleParameter("p_req", OracleDbType.Byte, null, ParameterDirection.Input)).Value = isReq;
                        (param[11] = new OracleParameter("p_cre", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cre;
                        (param[12] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                        (param[13] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = term;
                        param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                        rows_aff = UpdateRecords("sp_savevehicalinsurancedefinit", CommandType.StoredProcedure, param);
                        rows_aff = rows_aff + rows_aff;
                    }
                }
                //  ConnectionClose();
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        //sachith
        public int SaveInsurancePolicy(string _desc, string _cre)
        {
            try
            {
                int rows_aff = 0;
                //ConnectionOpen();
                InventoryDAL inv = new InventoryDAL();
                inv.ConnectionOpen();
                OracleParameter[] tparam = new OracleParameter[1];
                (tparam[0] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
                OracleParameter outPara = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                int count = ReturnSP_SingleValue("sp_getinspolicy", CommandType.StoredProcedure, outPara, tparam);
                if (count <= 0)
                {
                    OracleParameter[] param = new OracleParameter[5];
                    (param[0] = new OracleParameter("p_seq", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inv.GetSerialID();
                    (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
                    (param[2] = new OracleParameter("p_cre", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cre;
                    (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                    param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                    rows_aff = UpdateRecords("sp_savevehicalinsurancepolicy", CommandType.StoredProcedure, param);
                    return rows_aff;
                }
                else
                {
                    return -999;
                }
            }
            catch (Exception) { return -1; }
        }

        //sachith
        public DataTable GetInsuranceInvoice(string _com, string _pc, DateTime _from, DateTime _to, string _type, string _veh_no, string _acc, string _invNo, string _enginNo, string _chassisNo)
        {
            OracleParameter[] param = new OracleParameter[11];
            _com = (!string.IsNullOrEmpty(_com)) ? (_com.ToUpper()) : "%";
            _pc = (!string.IsNullOrEmpty(_pc)) ? (_pc.ToUpper()) : "%";
            _veh_no = (!string.IsNullOrEmpty(_veh_no)) ? (_veh_no.ToUpper()) : "%";
            _acc = (!string.IsNullOrEmpty(_acc)) ? (_acc.ToUpper()) : "%";
            _to = ((_to == DateTime.MaxValue)) ? (_to) : _to = _to.AddDays(1);
            _invNo = (!string.IsNullOrEmpty(_invNo)) ? _invNo.ToUpper() : "%";
            _enginNo = (!string.IsNullOrEmpty(_enginNo)) ? _enginNo.ToUpper() : "%";
            _chassisNo = (!string.IsNullOrEmpty(_chassisNo)) ? _chassisNo.ToUpper() : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_veh_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _veh_no;
            (param[6] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;

            (param[7] = new OracleParameter("_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[8] = new OracleParameter("_enginNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _enginNo;
            (param[9] = new OracleParameter("_chassisNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassisNo;

            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblloc", "sp_getrecentinsurance", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<VehicleInsuarance> GetVehicalInsurance(string _recNo, string _debNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            List<VehicleInsuarance> _insurance = null;
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recNo;
            (param[1] = new OracleParameter("p_deb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _debNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_getvehicalinsurance", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _insurance = DataTableExtensions.ToGenericList<VehicleInsuarance>(_dtResults, VehicleInsuarance.Converter);
            }
            return _insurance;
        }

        //kapila
        public int GetWeek(DateTime _Date, out Decimal _week, string _com)
        {
            Decimal _wk = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_week", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count == 0)
            {
                _wk = 0;
            }
            else
            {
                for (int i = 0; i < _result.Rows.Count; i++)
                {
                    _wk = Convert.ToDecimal(_result.Rows[i]["gw_week"]);

                }
            }
            _week = _wk;
            return 1;
        }

        public Int32 SaveVehicalInsurance(VehicleInsuarance insurance)
        {
            try
            {
                int rows_aff = 0;
                OracleParameter[] param = new OracleParameter[66];
                (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_ref_no;
                (param[1] = new OracleParameter("p_svit_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_com;
                (param[2] = new OracleParameter("p_svit_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_pc;
                (param[3] = new OracleParameter("p_svit_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_dt;
                (param[4] = new OracleParameter("p_svit_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_inv_no;
                (param[5] = new OracleParameter("p_svit_sales_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_sales_tp;
                (param[6] = new OracleParameter("p_svit_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_ins_com;
                (param[7] = new OracleParameter("p_svit_ins_polc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_ins_polc;
                (param[8] = new OracleParameter("p_svit_ins_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = insurance.Svit_ins_val;
                (param[9] = new OracleParameter("p_svit_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_cust_cd;
                (param[10] = new OracleParameter("p_svit_cust_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_cust_title;
                (param[11] = new OracleParameter("p_svit_last_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_last_name;
                (param[12] = new OracleParameter("p_svit_full_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_full_name;
                (param[13] = new OracleParameter("p_svit_initial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_initial;
                (param[14] = new OracleParameter("p_svit_add01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_add01;
                (param[15] = new OracleParameter("p_svit_add02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_add02;
                (param[16] = new OracleParameter("p_svit_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_city;
                (param[17] = new OracleParameter("p_svit_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_district;
                (param[18] = new OracleParameter("p_svit_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_province;
                (param[19] = new OracleParameter("p_svit_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_contact;
                (param[20] = new OracleParameter("p_svit_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_model;
                (param[21] = new OracleParameter("p_svit_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_brd;
                (param[22] = new OracleParameter("p_svit_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_chassis;
                (param[23] = new OracleParameter("p_svit_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_engine;
                (param[24] = new OracleParameter("p_svit_capacity", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_sales_tp;
                (param[25] = new OracleParameter("p_svit_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_cre_by;
                (param[26] = new OracleParameter("p_svit_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_cre_dt;
                (param[27] = new OracleParameter("p_svit_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_mod_by;
                (param[28] = new OracleParameter("p_svit_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_mod_dt;
                (param[29] = new OracleParameter("p_svit_cvnt_issue", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_issue;
                (param[30] = new OracleParameter("p_svit_cvnt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_no;
                (param[31] = new OracleParameter("p_svit_cvnt_days", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_days;
                (param[32] = new OracleParameter("p_svit_cvnt_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_from_dt;
                (param[33] = new OracleParameter("p_svit_cvnt_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_to_dt;
                (param[34] = new OracleParameter("p_svit_cvnt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_by;
                (param[35] = new OracleParameter("p_svit_cvnt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_cvnt_dt;
                (param[36] = new OracleParameter("p_svit_ext_issue", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_ext_issue;
                (param[37] = new OracleParameter("p_svit_ext_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_ext_no;
                (param[38] = new OracleParameter("p_svit_ext_days", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_ext_days;
                (param[39] = new OracleParameter("p_svit_ext_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_ext_from_dt;
                (param[40] = new OracleParameter("p_svit_ext_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_ext_to_dt;
                (param[41] = new OracleParameter("p_svit_ext_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_ext_by;
                (param[42] = new OracleParameter("p_svit_ext_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_ext_dt;
                (param[43] = new OracleParameter("p_svit_veh_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_veh_reg_no;
                (param[44] = new OracleParameter("p_svit_reg_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_reg_by;
                (param[45] = new OracleParameter("p_svit_reg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_reg_dt;
                (param[46] = new OracleParameter("p_svit_polc_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_polc_stus;
                (param[47] = new OracleParameter("p_svit_polc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_polc_no;
                (param[48] = new OracleParameter("p_svit_eff_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_eff_dt;
                (param[49] = new OracleParameter("p_svit_expi_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_expi_dt;
                (param[50] = new OracleParameter("p_svit_net_prem", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = insurance.Svit_net_prem;
                (param[51] = new OracleParameter("p_svit_srcc_prem", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = insurance.Svit_srcc_prem;
                (param[52] = new OracleParameter("p_svit_oth_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = insurance.Svit_oth_val;
                (param[53] = new OracleParameter("p_svit_tot_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = insurance.Svit_tot_val;
                (param[54] = new OracleParameter("p_svit_polc_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_polc_by;
                (param[55] = new OracleParameter("p_svit_polc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_polc_dt;
                (param[56] = new OracleParameter("p_svit_dbt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_dbt_no;
                (param[57] = new OracleParameter("p_svit_dbt_set_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_dbt_set_stus;
                (param[58] = new OracleParameter("p_svit_dbt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_dbt_by;
                (param[59] = new OracleParameter("p_svit_dbt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = insurance.Svit_dbt_dt;
                (param[60] = new OracleParameter("p_svit_veg_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_veg_ref;
                (param[61] = new OracleParameter("p_svit_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_itm_cd;
                (param[62] = new OracleParameter("p_svit_pay_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Pay_ref_no;
                (param[63] = new OracleParameter("p_svit_file_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insurance.Svit_file_no;
                (param[64] = new OracleParameter("p_svit_no_of_prnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = insurance.Svit_no_of_prnt;
                param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                rows_aff = UpdateRecords("sp_updatevehicalinsurace", CommandType.StoredProcedure, param);
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public Int32 SaveInsurancePay(VehicalInsurancePay _insPay)
        {
            try
            {
                int rows_aff = 0;
                InventoryDAL inv = new InventoryDAL();
                inv.ConnectionOpen();
                //ConnectionOpen();
                OracleParameter[] param = new OracleParameter[12];
                (param[0] = new OracleParameter("p_svipy_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inv.GetSerialID();
                (param[1] = new OracleParameter("p_svipy_Pay_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Pay_ref_no;
                (param[2] = new OracleParameter("p_svipy_ref_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Ref_line;
                (param[3] = new OracleParameter("p_svipy_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Pay_tp;
                (param[4] = new OracleParameter("p_svipy_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Ref_no;
                (param[5] = new OracleParameter("p_svipy_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Bank;
                (param[6] = new OracleParameter("p_svipy_bank_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Bank_branch;
                (param[7] = new OracleParameter("p_svipy_chq_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insPay.Cheque_date;
                (param[8] = new OracleParameter("p_svipy_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insPay.Value;
                (param[9] = new OracleParameter("p_svipy_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insPay.Cre_by;
                (param[10] = new OracleParameter("p_svipy_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                rows_aff = UpdateRecords("sp_updateinsurancepay", CommandType.StoredProcedure, param);
                inv.ConnectionClose();
                //ConnectionClose();
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public Int32 SaveInsuranceClaim(VehicalInsuranceClaim _insClaim)
        {
            try
            {
                int rows_aff = 0;
                OracleParameter[] param = new OracleParameter[32];
                (param[0] = new OracleParameter("p_svicl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _insClaim.Seq_no;
                (param[1] = new OracleParameter("p_svicl_veh_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Reg_no;
                (param[2] = new OracleParameter("p_svicl_acdt_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Acc_date;
                (param[3] = new OracleParameter("p_svicl_police_rpt_stus", OracleDbType.Byte, null, ParameterDirection.Input)).Value = _insClaim.Polic_rep_sts;
                (param[4] = new OracleParameter("p_svicl_drv_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Dri_name;
                (param[5] = new OracleParameter("p_svicl_dl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Dl_lic;
                (param[6] = new OracleParameter("p_svicl_doc_stus", OracleDbType.Byte, null, ParameterDirection.Input)).Value = _insClaim.Doc_stus;
                (param[7] = new OracleParameter("p_svicl_init_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Init_by;
                (param[8] = new OracleParameter("p_svicl_init_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Init_date;
                (param[9] = new OracleParameter("p_svicl_claim_form_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Clamin_form_rec;
                (param[10] = new OracleParameter("p_svicl_dl_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Dl_rec;
                (param[11] = new OracleParameter("p_svicl_repair_estm_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Repi_esti_rec;
                (param[12] = new OracleParameter("p_svicl_repair_estm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insClaim.Repi_esti_val;
                (param[13] = new OracleParameter("p_svicl_police_rpt_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Police_rep_rec;
                (param[14] = new OracleParameter("p_svicl_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.App_forw;
                (param[15] = new OracleParameter("p_svicl_inv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Final_invo;
                (param[16] = new OracleParameter("p_svicl_rec_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Rec_by;
                (param[17] = new OracleParameter("p_svicl_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Rec_dt;
                (param[18] = new OracleParameter("p_svicl_claim_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insClaim.Claim_val;
                (param[19] = new OracleParameter("p_svicl_polc_excess", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insClaim.Policy_excess;
                (param[20] = new OracleParameter("p_svicl_oth_deduction", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insClaim.Other_dedection;
                (param[21] = new OracleParameter("p_svicl_bal_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insClaim.Bal_val;
                (param[22] = new OracleParameter("p_svicl_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Acc_no;
                (param[23] = new OracleParameter("p_svicl_chq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Cheq_no;
                (param[24] = new OracleParameter("p_svicl_chq_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Cheq_bank;
                (param[25] = new OracleParameter("p_svicl_chq_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Cheq_branch;
                (param[26] = new OracleParameter("p_svicl_chq_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Cheq_dt;
                (param[27] = new OracleParameter("p_svicl_chq_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _insClaim.Cheq_val;
                (param[28] = new OracleParameter("p_svicl_sett_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Sett_dt;
                (param[29] = new OracleParameter("p_svicl_set_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insClaim.Set_by;
                (param[30] = new OracleParameter("p_svicl_set_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _insClaim.Set_dt;
                param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                rows_aff = UpdateRecords("sp_saveinsuranceclaim", CommandType.StoredProcedure, param);
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public List<VehicleInsuarance> GetClaimCusDetails(string _regNo)
        {
            List<VehicleInsuarance> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "Customer";
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getinscustomerdata", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<VehicleInsuarance>(tblDet, VehicleInsuarance.Converter);
            }
            return _list;
        }

        public List<VehicalInsuranceClaim> GetClaimDetails(string type, string _regNo, DateTime date)
        {
            List<VehicalInsuranceClaim> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[3] = new OracleParameter("p_def_min", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.MinValue;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getinsuranceclaim", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<VehicalInsuranceClaim>(tblDet, VehicalInsuranceClaim.Converter);
            }
            return _list;
        }


        public Int32 UpdateItemCoverNote(string _invNo, string _itmCd)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCd;
            (param[2] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return _effect = UpdateRecords("sp_updatecovenotstatus", CommandType.StoredProcedure, param);
        }

        public Int32 SaveSMSOut(OutSMS _smsout)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_createtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Createtime;
            (param[1] = new OracleParameter("p_deletedtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Deletedtime;
            (param[2] = new OracleParameter("p_deliveredtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Deliveredtime;
            (param[3] = new OracleParameter("p_downloadtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Downloadtime;
            (param[4] = new OracleParameter("p_msg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msg;
            (param[5] = new OracleParameter("p_msgid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msgid;
            (param[6] = new OracleParameter("p_msgstatus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _smsout.Msgstatus;
            (param[7] = new OracleParameter("p_msgtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msgtype;
            (param[8] = new OracleParameter("p_receivedtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Receivedtime;
            (param[9] = new OracleParameter("p_receiver", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Receiver;
            (param[10] = new OracleParameter("p_receiverphno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Receiverphno;
            (param[11] = new OracleParameter("p_refdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Refdocno;
            (param[12] = new OracleParameter("p_sender", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Sender;
            (param[13] = new OracleParameter("p_senderphno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Senderphno;
            (param[14] = new OracleParameter("p_seqno", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _smsout.Seqno;
            (param[15] = new OracleParameter("p_comcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.comcode;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_savesmsout", CommandType.StoredProcedure, param);

            return _effect;
        }

        //Added by Udesh 29-Nov-2018
        public DataTable SP_Get_Sys_Para_Detail_By_Name(string name)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rspd_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable table = QueryDataTable("tbl", "SP_GET_SYS_PARA_DETAIL", CommandType.StoredProcedure, false, param);

            return table;
        }

        public List<MsgInformation> GetMsgInformation(string _company, string _location, string _documenttype)
        {
            // sp_getmsginformation(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doctype in NVARCHAR2,c_data out sys_refcursor)
            List<MsgInformation> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documenttype;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getmsginformation", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MsgInformation>(tblDet, MsgInformation.Converter);
            }
            return _list;
        }

        #region Vehicle Approval
        //Shani
        public List<VehicalRegistration> GetVehiclesByInvoiceNo(string com, string pc, string invNo)
        {
            List<VehicalRegistration> _list = null;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getvehiclesByInvoiceNum", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<VehicalRegistration>(_dtResults, VehicalRegistration.Converter);
            }
            return _list;
        }

        public Int32 Update_VehicleApproveStatus(string p_com, string p_invoiceNo, string p_invoiceRefNo, string p_itmCD, Int32 isapp)
        {
            // p_com in NVARCHAR2,p_invoiceNo in NVARCHAR2,p_invoiceRefNo in NVARCHAR2,p_itmCD in NVARCHAR2,p_isapp in NUMBER,
            Int32 rows_affected = 0;
            try
            {
                //Create parameters and assign values.
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
                (param[1] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_invoiceNo;
                (param[2] = new OracleParameter("p_invoiceRefNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_invoiceRefNo;
                (param[3] = new OracleParameter("p_itmCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itmCD;
                (param[4] = new OracleParameter("p_isapp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isapp;

                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                //Open the connection and call the stored procedure.
                //ConnectionOpen();
                rows_affected = (Int32)this.UpdateRecords("SP_Update_VehicleApproveStatus", CommandType.StoredProcedure, param);

            }
            catch (Exception e)
            {
                rows_affected = -1;
                //throw new Exception(e.Message);
            }
            finally
            {
                //ConnectionClose();
            }

            return rows_affected;
        }


        public Int32 Save_sat_rls_itm(ReptPickSerials rps, string regRef, DateTime transactionDT, string approvedBy)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_srls_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = rps.Tus_seq_no;
            (param[1] = new OracleParameter("p_srls_scm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = rps.Tus_usrseq_no;
            (param[2] = new OracleParameter("p_srls_veg_reg_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = regRef;
            (param[3] = new OracleParameter("p_srls_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rps.Tus_itm_cd;
            (param[4] = new OracleParameter("p_srls_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = rps.Tus_ser_id;
            (param[5] = new OracleParameter("p_srls_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rps.Tus_ser_1;
            (param[6] = new OracleParameter("p_srls_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rps.Tus_ser_2;
            (param[7] = new OracleParameter("p_srls_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = approvedBy;
            (param[8] = new OracleParameter("p_srls_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = transactionDT.Date;


            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_save_sat_rls_itm", CommandType.StoredProcedure, param);

            return _effect;
        }
        public DataTable SearchInvoiceNo_forVehicle(string com, string pc, string AccountNo, string _regNo, string InvoiceFromDate, string InvoiceToDate)
        {
            //( p_accNo in NVARCHAR2, p_RegNo in NVARCHAR2,p_com in NVARCHAR2,p_pc in NVARCHAR2, p_InvoiceFromDate in DATE,p_InvoiceToDate in DATE, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountNo;
            (param[1] = new OracleParameter("p_RegNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_InvoiceFromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = InvoiceFromDate;
            (param[5] = new OracleParameter("p_InvoiceToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = InvoiceToDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tbDet = new DataTable();
            DataTable tblDet = QueryDataTable("tbl", "sp_search_InvoiceNoForVehicle", CommandType.StoredProcedure, false, param);

            return tblDet;
        }
        public DataTable Get_RequiredDocuments(string schemeCD)
        {
            // sp_get_RequiredDocuments(p_schCD in NVARCHAR2,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_schCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schemeCD;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tbDet = new DataTable();
            DataTable tblDet = QueryDataTable("tbl", "sp_get_RequiredDocuments", CommandType.StoredProcedure, false, param);

            return tblDet;
        }
        #endregion
        public DataTable Get_DetBy_town(string town)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tbDet = new DataTable();
            DataTable tblDet = QueryDataTable("tbl", "SP_GET_DetBy_town", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        //sachith  2012/09/04
        //backdate insert
        public Int32 SaveBackDate(BackDates _backdate)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_gad_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_com;
            (param[1] = new OracleParameter("p_gad_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_ope;
            (param[2] = new OracleParameter("p_gad_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_chnl;
            (param[3] = new OracleParameter("p_gad_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_loc;
            (param[4] = new OracleParameter("p_gad_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _backdate.Gad_from_dt;
            (param[5] = new OracleParameter("p_gad_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _backdate.Gad_to_dt;
            (param[6] = new OracleParameter("p_gad_act_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _backdate.Gad_act_from_dt;
            (param[7] = new OracleParameter("p_gad_act_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _backdate.Gad_act_to_dt;
            (param[8] = new OracleParameter("p_gad_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_app_by;
            (param[9] = new OracleParameter("p_gad_app_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_app_ref;
            (param[10] = new OracleParameter("p_gad_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_rmk;
            (param[11] = new OracleParameter("p_gad_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _backdate.Gad_act;
            (param[12] = new OracleParameter("p_gad_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_cre_by;
            (param[13] = new OracleParameter("p_gad_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _backdate.Gad_cre_dt;
            (param[14] = new OracleParameter("p_gad_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_session_id;
            (param[15] = new OracleParameter("p_gad_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _backdate.Gad_module;
            (param[16] = new OracleParameter("p_gad_alw_curr_trans", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _backdate.Gad_alw_curr_trans;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_savebackdate", CommandType.StoredProcedure, param);

            return _effect;
        }


        public Int32 CheckBackDate(string _com, string _ope)
        {
            try
            {
                int _effect = 0;
                OracleParameter[] param = new OracleParameter[2];

                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ope;
                OracleParameter orP = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                _effect = ReturnSP_SingleValue("sp_backdatecheckconstraints", CommandType.StoredProcedure, orP, param);
                return _effect;
            }
            catch (Exception) { return -1; }
        }

        public Int32 SaveDayEndLog(Day_End_Log _log)
        {
            try
            {
                Int32 effect = 0;
                OracleParameter[] param = new OracleParameter[10];

                (param[0] = new OracleParameter("p_upd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _log.Upd_seq;
                (param[1] = new OracleParameter("p_upd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log.Upd_com;
                (param[2] = new OracleParameter("p_upd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log.Upd_pc;
                (param[3] = new OracleParameter("p_upd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log.Upd_dt;
                (param[4] = new OracleParameter("p_upd_ov_wrt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _log.Upd_ov_wrt;
                (param[5] = new OracleParameter("p_upd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log.Upd_cre_by;
                (param[6] = new OracleParameter("p_upd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log.Upd_cre_dt;
                (param[7] = new OracleParameter("p_upd_log_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log.Upd_log_by;
                (param[8] = new OracleParameter("p_upd_log_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log.Upd_log_dt;
                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effect = UpdateRecords("sp_savedayendlog", CommandType.StoredProcedure, param);

                return effect;
            }
            catch (Exception) { return -1; }

        }

        //sachith
        public DataTable GetVehicalSearch(string _com, string _loc, string _type, string _reg, string _chassis, string _engine, string _inv, string _rec, string _acc, DateTime _fromdate, DateTime _todate, string _cust)
        {
            OracleParameter[] param = new OracleParameter[13];
            _com = (!string.IsNullOrEmpty(_com)) ? (_com.ToUpper()) : "%";
            _loc = (!string.IsNullOrEmpty(_loc)) ? (_loc.ToUpper()) : "%";
            _reg = (!string.IsNullOrEmpty(_reg)) ? (_reg.ToUpper()) : "%";
            _chassis = (!string.IsNullOrEmpty(_chassis)) ? (_chassis.ToUpper()) : null;     //edited by kapila
            _engine = (!string.IsNullOrEmpty(_engine)) ? (_engine.ToUpper()) : null;        //edited by kapila 5/5/2016
            _inv = (!string.IsNullOrEmpty(_inv)) ? (_inv.ToUpper()) : "%";
            _rec = (!string.IsNullOrEmpty(_rec)) ? (_rec.ToUpper()) : "%";
            _acc = (!string.IsNullOrEmpty(_acc)) ? (_acc.ToUpper()) : "%";
            _cust = (!string.IsNullOrEmpty(_cust)) ? (_cust.ToUpper()) : "%";
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[4] = new OracleParameter("p_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg;
            (param[5] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[6] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[7] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[8] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[9] = new OracleParameter("P_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[10] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[11] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_vehicalregsearch", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable GetRegAndInsSearch(string _item, string _model, string _sales, string _term, string _pc, string _com)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[2] = new OracleParameter("p_salesType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sales;
            (param[3] = new OracleParameter("p_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _term;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_veh_ins_reg_search", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetHpSch(string _inv)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getschbyinv", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateVehReg(VehicalRegistration _vehReg)
        {
            try
            {
                Int32 effect = 0;
                OracleParameter[] param = new OracleParameter[10];

                (param[0] = new OracleParameter("p_pre", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_cust_title;
                (param[1] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_full_name;
                (param[2] = new OracleParameter("p_add", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_add01 + _vehReg.P_svrt_add02;
                (param[3] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_city;
                (param[4] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_contact;
                (param[5] = new OracleParameter("p_reg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_veh_reg_no;
                (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_srvt_itm_cd;
                (param[7] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_engine;
                (param[8] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehReg.P_svrt_chassis;
                param[9] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
                effect = UpdateRecords("sp_update_veh_reg", CommandType.StoredProcedure, param);

                return effect;
            }
            catch (Exception) { return -1; }
        }

        //Shani 26-11-2012
        public DataTable Get_All_User_paramTypes(string type)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_permTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getAllUser_permTp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #region PC Definition
        public Int32 Save_profit_center(MasterProfitCenter _pcheader, string _user)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[56];

            (param[0] = new OracleParameter("p_MPC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_com;
            (param[1] = new OracleParameter("p_MPC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_cd;
            (param[2] = new OracleParameter("p_MPC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_desc;
            (param[3] = new OracleParameter("p_MPC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_tp;
            (param[4] = new OracleParameter("p_MPC_OTH_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_oth_ref;
            (param[5] = new OracleParameter("p_MPC_ADD_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_1;
            (param[6] = new OracleParameter("p_MPC_ADD_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_2;
            (param[7] = new OracleParameter("p_MPC_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_tel;
            (param[8] = new OracleParameter("p_MPC_FAX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_fax;
            (param[9] = new OracleParameter("p_MPC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_act;
            (param[10] = new OracleParameter("p_MPC_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_chnl;
            (param[11] = new OracleParameter("p_MPC_OPE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_ope_cd;
            (param[12] = new OracleParameter("p_MPC_DEF_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_pb;
            (param[13] = new OracleParameter("p_MPC_EDIT_PRICE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_edit_price;
            (param[14] = new OracleParameter("p_MPC_CHK_CREDIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_chk_credit;
            (param[15] = new OracleParameter("p_MPC_EDIT_RATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_edit_rate;
            (param[16] = new OracleParameter("p_MPC_DEF_DIS_RATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_dis_rate;
            (param[17] = new OracleParameter("p_MPC_PRINT_WARA_REMARKS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_wara_remarks;
            (param[18] = new OracleParameter("p_MPC_INTER_COM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_inter_com;
            (param[19] = new OracleParameter("p_MPC_PRINT_DIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_dis;
            (param[20] = new OracleParameter("p_MPC_PRINT_PAYMENT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_payment;
            (param[21] = new OracleParameter("p_MPC_CHECK_PAY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_check_pay;
            (param[22] = new OracleParameter("p_MPC_CHECK_CM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_check_cm;
            (param[23] = new OracleParameter("p_MPC_WITHOUT_PRICE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_without_price;
            (param[24] = new OracleParameter("p_MPC_ORDER_VALID_PD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_order_valid_pd;
            (param[25] = new OracleParameter("p_MPC_ORDER_RESTRIC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_order_restric;
            (param[26] = new OracleParameter("p_MPC_WARA_EXTEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_wara_extend;
            (param[27] = new OracleParameter("p_MPC_SO_SMS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_so_sms;
            (param[28] = new OracleParameter("p_MPC_MULTI_DEPT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_multi_dept;
            (param[29] = new OracleParameter("p_MPC_DEF_DEPT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_dept;
            (param[30] = new OracleParameter("p_MPC_DEF_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_loc;
            (param[31] = new OracleParameter("p_MPC_MAN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_man;
            (param[32] = new OracleParameter("p_MPC_DEF_EXRATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_exrate;
            (param[33] = new OracleParameter("p_MPC_DEF_CUSTOMER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_customer;
            (param[34] = new OracleParameter("p_MPC_ADD_HOURS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_hours;
            (param[35] = new OracleParameter("p_MPC_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_email;
            (param[36] = new OracleParameter("p_MPC_FWD_SALE_ST", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.Mpc_fwd_sale_st;
            (param[37] = new OracleParameter("p_MPC_MAX_FWDSALE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_max_fwdsale;
            (param[38] = new OracleParameter("p_MPC_HP_SYS_REC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_hp_sys_rec;
            (param[39] = new OracleParameter("p_MPC_IS_CHK_MAN_DOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_is_chk_man_doc;
            (param[40] = new OracleParameter("p_MPC_IS_DO_NOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_is_do_now;
            (param[41] = new OracleParameter("p_MPC_DIST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_DIST;
            (param[42] = new OracleParameter("p_MPC_PROV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_PROV;
            (param[43] = new OracleParameter("p_MPC_OPN_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.MPC_OPN_DT;
            (param[44] = new OracleParameter("p_MPC_SQ_FT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.MPC_SQ_FT;
            (param[45] = new OracleParameter("p_MPC_MAN_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_MAN_NAME;
            (param[46] = new OracleParameter("p_MPC_JOINED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.MPC_JOINED_DT;
            (param[47] = new OracleParameter("p_MPC_HOVR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.MPC_HOVR_DT;
            (param[48] = new OracleParameter("p_MPC_NO_OF_STAFF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.MPC_NO_OF_STAFF;
            (param[49] = new OracleParameter("p_MPC_GRADE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_GRADE;
            (param[50] = new OracleParameter("p_mpc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[51] = new OracleParameter("p_mpc_main_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_main_pc;
            (param[52] = new OracleParameter("p_mpc_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_town;
            (param[53] = new OracleParameter("p_mpc_cash_ins", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.mpc_cash_ins;
            (param[54] = new OracleParameter("p_mpc_main_pccom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_main_pccom;

            param[55] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_mst_profit_center", CommandType.StoredProcedure, param);

            return effect;

        }

        public Int32 Update_profit_center(MasterProfitCenter _pcheader)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[38];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_com;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_cd;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_desc;
            (param[3] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_tp;
            (param[4] = new OracleParameter("p_oth_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_oth_ref;
            (param[5] = new OracleParameter("p_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_1;
            (param[6] = new OracleParameter("p_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_2;
            (param[7] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_tel;
            (param[8] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_fax;
            (param[9] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_act;
            (param[10] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_chnl;
            (param[11] = new OracleParameter("p_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_ope_cd;
            (param[12] = new OracleParameter("p_def_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_pb;
            (param[13] = new OracleParameter("p_edit_price", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_edit_price;
            (param[14] = new OracleParameter("p_chk_credit", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_chk_credit;
            (param[15] = new OracleParameter("p_edit_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pcheader.Mpc_edit_rate;
            (param[16] = new OracleParameter("p_def_dis_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_dis_rate;
            (param[17] = new OracleParameter("p_print_wara_remarks", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_wara_remarks;
            (param[18] = new OracleParameter("p_inter_com", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_inter_com;
            (param[19] = new OracleParameter("p_print_dis", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_dis;
            (param[20] = new OracleParameter("p_print_payment", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_payment;
            (param[21] = new OracleParameter("p_check_pay", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_check_pay;
            (param[22] = new OracleParameter("p_check_cm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_check_cm;
            (param[23] = new OracleParameter("p_without_price", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_without_price;
            (param[24] = new OracleParameter("p_order_valid_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_order_valid_pd;
            (param[25] = new OracleParameter("p_order_restric", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_order_restric;
            (param[26] = new OracleParameter("p_wara_extend", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_wara_extend;
            (param[27] = new OracleParameter("p_so_sms", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_so_sms;
            (param[28] = new OracleParameter("p_multi_dept", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_multi_dept;
            (param[29] = new OracleParameter("p_def_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_dept;
            (param[30] = new OracleParameter("p_def_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_loc;
            (param[31] = new OracleParameter("p_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_man;
            (param[32] = new OracleParameter("p_def_exrate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_exrate;
            (param[33] = new OracleParameter("p_def_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_customer;
            (param[34] = new OracleParameter("p_add_hours", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_hours;
            (param[35] = new OracleParameter("p_mpc_hp_sys_rec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_hp_sys_rec;
            (param[36] = new OracleParameter("p_mpc_is_chk_man_doc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_is_chk_man_doc;

            param[37] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_update_profit_center", CommandType.StoredProcedure, param);

            return effect;
        }

        public List<MasterSalesPriorityHierarchy> GetPCHeirachy(string _loc, string com)
        {
            List<MasterSalesPriorityHierarchy> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pc_hrchy", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchy>(_dtResults, MasterSalesPriorityHierarchy.Converter);
            }
            return _list;


        }

        public Int32 Save_MST_PC_INFO(MasterSalesPriorityHierarchy _infohdr)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_com_cd;
            (param[1] = new OracleParameter("p_pc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_pc_cd;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_tp;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_cd;
            (param[4] = new OracleParameter("p_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_val;
            (param[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mpi_act;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_MST_PC_INFO", CommandType.StoredProcedure, param);

            return effect;

        }

        public List<MasterSalesPriorityHierarchy> Get_AllPc_info(string com, string pc, string code, string type)
        {
            List<MasterSalesPriorityHierarchy> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            //(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_cd in NVARCHAR2,p_tp in NVARCHAR2,c_data OUT sys_refcursor)
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[3] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_AllPc_info", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchy>(_dtResults, MasterSalesPriorityHierarchy.Converter);
            }
            return _list;
        }

        public Int32 Update_MST_PC_INFO(MasterSalesPriorityHierarchy _infohdr)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_com_cd;
            (param[1] = new OracleParameter("p_pc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_pc_cd;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_tp;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_cd;
            (param[4] = new OracleParameter("p_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpi_val;
            (param[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mpi_act;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_UPDATE_MST_PC_INFO", CommandType.StoredProcedure, param);

            return effect;

        }
        public Int32 Save_MST_REC_DIV(MasterReceiptDivision recHeader)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_cd;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_desc;
            (param[4] = new OracleParameter("p_div_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_div_tp;
            (param[5] = new OracleParameter("p_inv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_inv_tp;
            (param[6] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = recHeader.Msrd_stus;
            (param[7] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = recHeader.Msrd_cre_dt;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_cre_by;
            (param[9] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = recHeader.Msrd_mod_dt;
            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = recHeader.Msrd_mod_by;
            (param[11] = new OracleParameter("p_is_sales", OracleDbType.Int32, null, ParameterDirection.Input)).Value = recHeader.Msrd_is_sales;
            (param[12] = new OracleParameter("p_is_ser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = recHeader.Msrd_is_ser;
            (param[13] = new OracleParameter("p_is_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = recHeader.Msrd_is_def;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_mst_rec_div", CommandType.StoredProcedure, param);

            return effect;

        }

        public Int32 Save_MST_PC_CHG(MasterProfitCenterCharges _pcChg)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[10];
            //(param[0] = new OracleParameter(p_seq, OracleDbType, null, ParameterDirection.Input)).Value = _pcChg.Mpch_seq;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcChg.Mpch_com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcChg.Mpch_pc;
            (param[2] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcChg.Mpch_from_dt;
            (param[3] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcChg.Mpch_to_dt;
            (param[4] = new OracleParameter("p_esd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pcChg.Mpch_esd;
            (param[5] = new OracleParameter("p_epf", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pcChg.Mpch_epf;
            (param[6] = new OracleParameter("p_wht", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pcChg.Mpch_wht;
            (param[7] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcChg.Mpch_cre_by;
            (param[8] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcChg.Mpch_cre_dt;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_mst_pc_chg", CommandType.StoredProcedure, param);

            return effect;

        }

        public Int32 Save_SAR_TXN_PAY_TP(PaymentType _txnPT)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[28];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _txnPT.Stp_seq;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_pty_tp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_pty_cd;
            (param[3] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_circ;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_com;
            (param[5] = new OracleParameter("p_txn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_txn_tp;
            (param[6] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _txnPT.Stp_from_dt;
            (param[7] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _txnPT.Stp_to_dt;
            (param[8] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_pay_tp;
            (param[9] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_pb;
            (param[10] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_pb_lvl;
            (param[11] = new OracleParameter("p_brd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_brd;
            (param[12] = new OracleParameter("p_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_main_cat;
            (param[13] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_cat;
            (param[14] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_itm;
            (param[15] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_ser;
            (param[16] = new OracleParameter("p_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_pro;
            (param[17] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_bank;
            (param[18] = new OracleParameter("p_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _txnPT.Stp_pd;
            (param[19] = new OracleParameter("p_bank_chg_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _txnPT.Stp_bank_chg_rt;
            (param[20] = new OracleParameter("p_bank_chg_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _txnPT.Stp_bank_chg_val;
            (param[21] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _txnPT.Stp_act;
            (param[22] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_cre_by;
            (param[23] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _txnPT.Stp_cre_dt;
            (param[24] = new OracleParameter("p_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _txnPT.Stp_def;
            (param[25] = new OracleParameter("p_vou_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_vou_cd;
            (param[26] = new OracleParameter("p_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txnPT.Stp_sch_cd;

            param[27] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //            effect = UpdateRecords("sp_save_sar_txn_pay_tp", CommandType.StoredProcedure, param);
            effect = UpdateRecords("sp_save_txn_pay_tp_new", CommandType.StoredProcedure, param);

            return effect;

        }

        public Int32 Update_SAR_TXN_PAY_TP(string _Stp_circ, DateTime _Stp_to_dt)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Stp_circ;
            (param[1] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Stp_to_dt;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effect = UpdateRecords("sp_upd_txn_pay_tp", CommandType.StoredProcedure, param);

            return effect;

        }

        public List<MasterProfitCenterCharges> Get_latest_PcCharges(string com, string pc)
        {
            List<MasterProfitCenterCharges> _list = null;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_latest_PcCharges", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterProfitCenterCharges>(_dtResults, MasterProfitCenterCharges.Converter);
            }
            return _list;
        }
        #endregion PC Definition

        public List<RequestApprovalDetail> GetRequestByRef(string _com, string _pc, string _ref)
        {
            List<RequestApprovalDetail> req = new List<RequestApprovalDetail>();
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_appreq_reqno", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                req = DataTableExtensions.ToGenericList<RequestApprovalDetail>(_dtResults, RequestApprovalDetail.Converter);
            }

            return req;
        }

        public RequestApprovalHeader GetRequest_HeaderByRef(string _com, string _pc, string _ref)
        {
            // List<RequestApprovalHeader> req = new List<RequestApprovalHeader>();
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_appreq_reqno", CommandType.StoredProcedure, false, param);
            RequestApprovalHeader hdr = null;
            if (_dtResults.Rows.Count > 0)
            {
                hdr = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter)[0];
            }

            return hdr;
        }

        public int GetReprintDocCount(string docNo)
        {
            OracleParameter[] param = new OracleParameter[1];
            int _effect = 0;
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            OracleParameter orP = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = ReturnSP_SingleValue("sp_get_reprint_doc_count", CommandType.StoredProcedure, orP, param);

            return _effect;
        }
        public int GetPrintDocCopies(string _com, string _docName)
        {        //written by Nadeeka 17/03/2014
            OracleParameter[] param = new OracleParameter[2];
            int _effect = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docName;
            OracleParameter orP = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = ReturnSP_SingleValue("sp_get_doc_copies", CommandType.StoredProcedure, orP, param);

            return _effect;
        }


        //darshana on 07-02-2013
        public Int32 Save_RequestApprove_Ser(RequestApprovalSerials ReqApp_ser)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_gras_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_ref;
            (param[1] = new OracleParameter("p_gras_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_line;
            (param[2] = new OracleParameter("p_gras_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal1;
            (param[3] = new OracleParameter("p_gras_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal2;
            (param[4] = new OracleParameter("p_gras_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal3;
            (param[5] = new OracleParameter("p_gras_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal4;
            (param[6] = new OracleParameter("p_gras_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal5;
            (param[7] = new OracleParameter("p_gras_anal6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal6;
            (param[8] = new OracleParameter("p_gras_anal7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal7;

            (param[9] = new OracleParameter("p_gras_anal8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal8;
            (param[10] = new OracleParameter("p_gras_anal9", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal9;
            (param[11] = new OracleParameter("p_gras_anal10", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal10;
            (param[12] = new OracleParameter("p_gras_inv_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_inv_line;
            (param[13] = new OracleParameter("p_gras_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_itm_line;
            (param[14] = new OracleParameter("p_gras_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_batch_line;
            (param[15] = new OracleParameter("p_gras_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_ser_line;

            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_gen_reqapp_ser", CommandType.StoredProcedure, param);
            return effects;
        }


        public Int32 IsUser_InRole(string userCompany, string userId, string roleId)
        {
            try
            {
                int _effect = 0;
                OracleParameter[] param = new OracleParameter[3];

                //p_userCom in NVARCHAR2, p_userid in NVARCHAR2,p_roleId in NVARCHAR2,c_result OUT NUMBER)
                (param[0] = new OracleParameter("p_userCom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userCompany;
                (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                (param[2] = new OracleParameter("p_roleId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = roleId;

                OracleParameter orP = new OracleParameter("c_result", OracleDbType.Int32, null, ParameterDirection.Output);
                _effect = ReturnSP_SingleValue("sp_isUser_In_Role", CommandType.StoredProcedure, orP, param);
                return _effect;
            }
            catch (Exception) { return -1; }
        }
        public DataTable Get_backdates(string com, string pc_or_loc_Code, string p_pc_or_loc, out List<BackDates> backDatesList)
        {
            //(p_com in NVARCHAR2,p_pc_or_loc in NVARCHAR2,c_data Out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_or_loc_Code;
            (param[2] = new OracleParameter("p_pc_or_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc_or_loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_backdates", CommandType.StoredProcedure, false, param);

            backDatesList = new List<BackDates>();
            if (_dtResults.Rows.Count > 0)
            {
                backDatesList = DataTableExtensions.ToGenericList<BackDates>(_dtResults, BackDates.Converter);
            }

            return _dtResults;
        }

        //darshana on 12-03-2013
        public RequestApprovalHeader GetRelatedRequestByRef(string _com, string _pc, string _ref, string _appTP)
        {
            RequestApprovalHeader req = new RequestApprovalHeader();
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_appTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appTP;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_relate_req", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                req = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter)[0];
            }

            return req;
        }

        //darshana on 07-02-2013
        public Int32 Save_RequestApprove_Serial_Log(RequestApprovalSerialsLog ReqApp_ser_Log)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_gras_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_ref;
            (param[1] = new OracleParameter("p_gras_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_line;
            (param[2] = new OracleParameter("p_gras_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal1;
            (param[3] = new OracleParameter("p_gras_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal2;
            (param[4] = new OracleParameter("p_gras_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal3;
            (param[5] = new OracleParameter("p_gras_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal4;
            (param[6] = new OracleParameter("p_gras_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal5;
            (param[7] = new OracleParameter("p_gras_anal6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal6;
            (param[8] = new OracleParameter("p_gras_anal7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal7;

            (param[9] = new OracleParameter("p_gras_anal8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal8;
            (param[10] = new OracleParameter("p_gras_anal9", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal9;
            (param[11] = new OracleParameter("p_gras_anal10", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_anal10;
            (param[12] = new OracleParameter("p_gras_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser_Log.Gras_lvl;

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_gen_reqapp_ser_log", CommandType.StoredProcedure, param);
            return effects;
        }


        //shani on 13-02-2013
        public Int32 Save_RequestApprove_Ser_Log(RequestApprovalSerials ReqApp_ser, Int32 approval_level)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_gras_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_ref;
            (param[1] = new OracleParameter("p_gras_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_line;
            (param[2] = new OracleParameter("p_gras_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal1;
            (param[3] = new OracleParameter("p_gras_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal2;
            (param[4] = new OracleParameter("p_gras_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal3;
            (param[5] = new OracleParameter("p_gras_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal4;
            (param[6] = new OracleParameter("p_gras_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal5;
            (param[7] = new OracleParameter("p_gras_anal6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal6;
            (param[8] = new OracleParameter("p_gras_anal7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal7;

            (param[9] = new OracleParameter("p_gras_anal8", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal8;
            (param[10] = new OracleParameter("p_gras_anal9", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal9;
            (param[11] = new OracleParameter("p_gras_anal10", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqApp_ser.Gras_anal10;
            (param[12] = new OracleParameter("p_gras_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = approval_level;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_gen_reqapp_ser_log", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable Get_gen_reqapp_ser(string com, string reqNo, out List<RequestApprovalSerials> List)
        {
            //(p_com in NVARCHAR2, p_reqno in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_gen_reqapp_ser", CommandType.StoredProcedure, false, param);

            List = new List<RequestApprovalSerials>();
            if (_dtResults.Rows.Count > 0)
            {
                List = DataTableExtensions.ToGenericList<RequestApprovalSerials>(_dtResults, RequestApprovalSerials.Converter);
            }

            return _dtResults;
        }

        //kapila 18/3/2013
        public DataTable GetWeekDefinition(Int32 _month, Int32 _year, Int32 _week, string _com, string _tp)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[2] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_week_Def", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //Chamal 19/03/2013 || SP - sp_get_pc_heirachy created by Kapila
        public DataTable Get_PC_Hierarchy(string _company, string _profitCenter)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pc_heirachy", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int Delete_gen_reqapp_ser(string _reqNo)
        {
            try
            {
                int rows_aff = 0;
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_requestno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
                param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                rows_aff = UpdateRecords("sp_delete_gen_reqapp_ser", CommandType.StoredProcedure, param);
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public Int32 save_mst_loc_info(MasterLocationPriorityHierarchy _infohdr)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            //sp_save_mst_loc_info(p_com_cd IN ems.mst_loc_info.mli_com_cd%TYPE ,p_pc_cd IN ems.mst_loc_info.mli_loc_cd%TYPE ,p_tp IN ems.mst_loc_info.mli_tp%TYPE ,p_cd IN ems.mst_loc_info.mli_cd%TYPE ,p_val IN ems.mst_loc_info.mli_val%TYPE ,p_act IN ems.mst_loc_info.mli_act%TYPE ,o_effect OUT NUMBER)

            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mli_com_cd;
            (param[1] = new OracleParameter("p_pc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mli_loc_cd;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mli_tp;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mli_cd;
            (param[4] = new OracleParameter("p_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mli_val;
            (param[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mli_act;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_mst_loc_info", CommandType.StoredProcedure, param);

            return effect;

        }


        public DataTable GetAllReceiptDivision(string _company, string _profitcenter)
        {
            //sp_getallreceiptdiv(p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getallreceiptdiv", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 11/4/2013
        public Int32 Delete_Doc_Check_List(string _com, string _pc, DateTime monthYear, Int32 week)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_monthYear", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int32)UpdateRecords("SP_del_doc_chk_lst", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila 11/4/2013
        public Int32 Save_Doc_Check_List(string createBy, DateTime createDt, string com, string pc, Int32 month, Int32 year, Int32 week, DateTime monthYear)
        {

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_creBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createBy;
            (param[1] = new OracleParameter("p_creDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = createDt;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = month;
            (param[5] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = year;
            (param[6] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            (param[7] = new OracleParameter("p_month_yr", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;

            param[8] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_process_chk_lst", CommandType.StoredProcedure, param);

            return result;
        }

        public DataTable Get_Doc_Check_List(string com, string pc, DateTime monthYear, Int32 week)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_monthyr", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = null;
            _result = QueryDataTable("tbl", "sp_get_doc_chk_lst", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Int32 Update_Doc_Check_List(DocCheckList _docLst)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_DCL_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docLst.Dcl_com;
            (param[1] = new OracleParameter("p_DCL_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docLst.Dcl_pc;
            (param[2] = new OracleParameter("p_DCL_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docLst.Dcl_month;
            (param[3] = new OracleParameter("p_DCL_WEEK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _docLst.Dcl_week;
            (param[4] = new OracleParameter("p_DCL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _docLst.Dcl_line;
            (param[5] = new OracleParameter("p_DCL_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docLst.Dcl_desc;
            (param[6] = new OracleParameter("p_DCL_SR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _docLst.Dcl_sr;
            (param[7] = new OracleParameter("p_DCL_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _docLst.Dcl_rt;
            (param[8] = new OracleParameter("p_DCL_SE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _docLst.Dcl_se;
            (param[9] = new OracleParameter("p_DCL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docLst.Dcl_cre_by;
            (param[10] = new OracleParameter("p_DCL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docLst.Dcl_cre_dt;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_doc_chk_lst", CommandType.StoredProcedure, param);

            return effects;
        }

        //kapila
        public DataTable Get_Party_Types(string _cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_party_tp", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public DataTable Get_Partycodes(string _pType, string _cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_party_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pType;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_party_cd", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetOperationAdminTeam(string _company)
        {
            //sp_getoperationadminteam(p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getoperationadminteam", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetLocationType()
        {
            // sp_getlocationtype(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getlocationtype", CommandType.StoredProcedure, false, param);
            return _result;

        }
        public DataTable GetLocationGrade(string _company, string _loctype)
        {
            //sp_getlocationgrade(p_com in NVARCHAR2,p_loctype in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loctype;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getlocationgrade", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetLocationCategory1()
        {
            //sp_getloccategory1(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getloccategory1", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetLocationCategory2(string _company)
        {
            //sp_getloccategory2(p_com in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getloccategory2", CommandType.StoredProcedure, false, param);
            return _result;

        }
        public DataTable GetLocationCategory3()
        {
            //sp_getloccategory3(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getloccategory3", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetCountry()
        {
            //sp_getcountry(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getcountry", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetProvince()
        {
            //sp_getprovince(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getprovince", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetDistrict(string _province)
        {
            //sp_getdistict(p_province in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _province;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getdistict", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetTown(string _province, string _district)
        {
            //sp_gettown(p_province in NVARCHAR2,p_district in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _province;
            (param[1] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _district;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_gettown", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetOutletDepartment(string _company)
        {
            //sp_getoutletdept(p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getoutletdept", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetEmployeeCategory()
        {
            // sp_getemployeecategory(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getemployeecategory", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public List<RequestApprovalHeader> GetAllRequests(string _com, string _pc, string _type, string _status)
        {
            List<RequestApprovalHeader> req = new List<RequestApprovalHeader>();
            OracleParameter[] param = new OracleParameter[5];
            //p_com in NVARCHAR2,
            //p_pc in NVARCHAR2,
            //p_type in NVARCHAR2,
            //p_status in NVARCHAR2,

            //c_data OUT sys_refcursor
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_All_appreq_reqno", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                req = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter);
            }

            return req;
        }

        public Int32 Confirm_Check_List(string _com, string _pc, DateTime _month, Int32 _week, Int32 _SR, Int32 _RT, Int32 _SE, DateTime _cour_date, string _POD, string _user, DateTime _ho_dt)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[4] = new OracleParameter("p_dcl_stus_sr", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SR;
            (param[5] = new OracleParameter("p_dcl_stus_rt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RT;
            (param[6] = new OracleParameter("p_dcl_stus_se", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SE;
            (param[7] = new OracleParameter("p_cr_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cour_date;
            (param[8] = new OracleParameter("p_pod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _POD;
            (param[9] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[10] = new OracleParameter("p_ho_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ho_dt;

            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_chk_list_new", CommandType.StoredProcedure, param);

            return effects;
        }

        public Boolean IsConfirmCheckList(string _com, string _pc, DateTime _month, Int32 _week, string _type)
        {
            OracleParameter[] _para = new OracleParameter[6];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (_para[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (_para[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            _para[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _agentFound = QueryDataTable("tbl", "sp_check_chk_list", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _agentFound;
        }

        public Boolean IsDayEndDone4ScanDocs(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _agentFound = QueryDataTable("tbl", "sp_chk_dayend4_scandocs", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _agentFound;
        }

        public DataTable Get_GET_GPC(string gpc, string desc)
        {
            //(  p_GPC in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_GPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = gpc;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_GPC", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable Get_Dept_Cont_Dt(string _com, string _chnl, string _cd, Int32 _tp)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[3] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_dept_cont_det", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetReqAppStatusLog(string _ref)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_appstus_log", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetReqAppStatusLogInItems(string _ref, Int32 _level)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_level", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _level;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_appstus_in_itms", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetReqAppStatusLogOutItems(string _ref, Int32 _level)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_level", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _level;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_appstus_out_itms", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable Get_hpr_insu(string sch_cd, string pty_tp, string pty_cd)
        {
            //get_hpr_insu(p_sch_cd in NVARCHAR2,p_pty_tp in NVARCHAR2,p_pty_cd in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_sch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sch_cd;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pty_tp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pty_cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "get_hpr_insu", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetArea(string _comapny, string _area)
        {
            //sp_getarea(p_com in NVARCHAR2,p_area in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comapny;
            (param[1] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_getarea", CommandType.StoredProcedure, false, param);
            return _result;

        }
        public DataTable GetProfitCenterCharge(string _company, string _profitcenter)
        {
            //sp_getprofitcentercharge(p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_getprofitcentercharge", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetMainCategoryDetail(string _mainCat)
        {
            //sp_getcategorydetail(p_cat in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCat;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblCat", "sp_getcategorydetail", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Added by Udesh 22-Oct-2018
        public DataTable GetModelDetail(string _modelCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modelCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblModel", "sp_get_model_detail", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public REF_ITM_CATE3 GetItemCategory3(string _cd)
        {
            //Nadeeka 27-08-2015
            REF_ITM_CATE3 _subCate = new REF_ITM_CATE3();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cate3", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<REF_ITM_CATE3>(_tblBrand, REF_ITM_CATE3.Converter)[0];
            }
            return _subCate;
        }

        public REF_ITM_CATE4 GetItemCategory4(string _cd)
        {
            //Nadeeka 27-08-2015
            REF_ITM_CATE4 _subCate = new REF_ITM_CATE4();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cate4", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<REF_ITM_CATE4>(_tblBrand, REF_ITM_CATE4.Converter)[0];
            }
            return _subCate;
        }

        public REF_ITM_CATE5 GetItemCategory5(string _cd)
        {
            //Nadeeka 27-08-2015
            REF_ITM_CATE5 _subCate = new REF_ITM_CATE5();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_cate5", CommandType.StoredProcedure, false, param);
            if (_tblBrand.Rows.Count > 0)
            {
                _subCate = DataTableExtensions.ToGenericList<REF_ITM_CATE5>(_tblBrand, REF_ITM_CATE5.Converter)[0];
            }
            return _subCate;
        }



        //kapila 
        public Int32 SaveSignOnOff(Sign_On _signon)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_SIG_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_com;
            (param[1] = new OracleParameter("p_SIG_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_pc;
            (param[2] = new OracleParameter("p_SIG_TERMINAL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_terminal;
            (param[3] = new OracleParameter("p_SIG_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_session;
            (param[4] = new OracleParameter("p_SIG_CASHIER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_cashier;
            (param[5] = new OracleParameter("p_SIG_SIGN_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_sign_by;
            (param[6] = new OracleParameter("p_SIG_ON_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _signon.Sig_on_dt;
            (param[7] = new OracleParameter("p_SIG_OP_BAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _signon.Sig_op_bal;
            (param[8] = new OracleParameter("p_SIG_SIGN_OFF_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_sign_off_by;
            (param[9] = new OracleParameter("p_SIG_OFF_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _signon.Sig_off_dt;
            (param[10] = new OracleParameter("p_SIG_CLOSE_BAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _signon.Sig_close_bal;
            (param[11] = new OracleParameter("p_SIG_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_stus;
            (param[12] = new OracleParameter("p_SIG_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_rem;
            (param[13] = new OracleParameter("p_SIG_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_create_by;
            (param[14] = new OracleParameter("p_SIG_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _signon.Sig_mod_by;
            (param[15] = new OracleParameter("p_SIG_SYS_OPBAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _signon.Sig_sys_opbal;
            (param[16] = new OracleParameter("p_SIG_SYS_CLSBAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _signon.Sig_sys_clsbal;
            (param[17] = new OracleParameter("p_issignon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _signon.Is_Sign_On;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = UpdateRecords("sp_upd_signon_off", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetCrdSaleDocsData(string _saleTp)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_saletp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saleTp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_crd_docs", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetCrdSaleDocsSavedData(Int32 _seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_saved_crd_docs", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable IsSaleFigureRoundUp(string _company)
        {
            //sp_getcompanyroundup(p_com in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblCat", "sp_getcompanyroundup", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Boolean checkCredSaleDocs(string _eng, out Int32 _seq_no)
        {
            Boolean _recordFound = false;
            Int32 _seqno = 0;
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eng;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_check_crd_docs", CommandType.StoredProcedure, false, _para);
            for (int i = 0; i < _result.Rows.Count; i++)
            {
                _recordFound = true;
                _seqno = Convert.ToInt32(_result.Rows[i]["gdh_seq"]);

            }
            _seq_no = _seqno;
            return _recordFound;
        }

        public Int32 SaveCredSaleDocHeader(CreditSaleDocsHeader _credSaleDocHdr)
        {
            OracleParameter[] param = new OracleParameter[31];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_GDH_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_seq;
            (param[1] = new OracleParameter("p_GDH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_com;
            (param[2] = new OracleParameter("p_GDH_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_pc;
            (param[3] = new OracleParameter("p_GDH_INV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_inv;
            (param[4] = new OracleParameter("p_GDH_INV_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_inv_dt;
            (param[5] = new OracleParameter("p_GDH_REC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_rec;
            (param[6] = new OracleParameter("p_GDH_RECIPT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_recipt_dt;
            (param[7] = new OracleParameter("p_GDH_ENGINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_engine;
            (param[8] = new OracleParameter("p_GDH_CHASSIS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_chassis;
            (param[9] = new OracleParameter("p_GDH_ISSE_DOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_isse_doc;
            (param[10] = new OracleParameter("p_GDH_ISS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_iss_dt;
            (param[11] = new OracleParameter("p_GDH_ISSUE_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_issue_rmks;
            (param[12] = new OracleParameter("p_GDH_REC_DOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_rec_doc;
            (param[13] = new OracleParameter("p_GDH_REC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_rec_dt;
            (param[14] = new OracleParameter("p_GDH_REC_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_rec_rmks;
            (param[15] = new OracleParameter("p_GDH_SEND_REG", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_send_reg;
            (param[16] = new OracleParameter("p_GDH_REG_SEND_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_reg_send_dt;
            (param[17] = new OracleParameter("p_GDH_REG_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_reg_rmks;
            (param[18] = new OracleParameter("p_GDH_CR_REC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_cr_rec;
            (param[19] = new OracleParameter("p_GDH_CR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_cr_dt;
            (param[20] = new OracleParameter("p_GDH_CR_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_cr_rmks;
            (param[21] = new OracleParameter("p_GDH_SEND_PAY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_send_pay;
            (param[22] = new OracleParameter("p_GDH_PAY_SEND_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_pay_send_dt;
            (param[23] = new OracleParameter("p_GDH_PAY_REMARKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_pay_remarks;
            (param[24] = new OracleParameter("p_GDH_COLL_CHEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_coll_cheq;
            (param[25] = new OracleParameter("p_GDH_COLL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_coll_dt;
            (param[26] = new OracleParameter("p_GDH_CHQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_chq_no;
            (param[27] = new OracleParameter("p_GDH_FINAL_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_final_rmks;
            (param[28] = new OracleParameter("p_GDH_CR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_cr_no;
            (param[29] = new OracleParameter("p_GDH_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocHdr.Gdh_amt;
            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = UpdateRecords("sp_save_crd_sale_doch", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveCredSaleDocDetail(CreditSaleDocsDetail _credSaleDocdet)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_GDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_seq;
            (param[1] = new OracleParameter("p_GDD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_line;
            (param[2] = new OracleParameter("p_GDD_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_doc;
            (param[3] = new OracleParameter("p_GDD_IS_ISSU", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_is_issu;
            (param[4] = new OracleParameter("p_GDD_ISS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_iss_dt;
            (param[5] = new OracleParameter("p_GDD_ISS_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_iss_rmks;
            (param[6] = new OracleParameter("p_GDD_ISS_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_iss_by;
            (param[7] = new OracleParameter("p_GDD_IS_REC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_is_rec;
            (param[8] = new OracleParameter("p_GDD_REC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_rec_dt;
            (param[9] = new OracleParameter("p_GDD_REC_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_rec_rmks;
            (param[10] = new OracleParameter("p_GDD_REC_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_rec_by;
            (param[11] = new OracleParameter("p_GDD_IS_RET", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_is_ret;
            (param[12] = new OracleParameter("p_GDD_RET_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_ret_dt;
            (param[13] = new OracleParameter("p_GDD_RET_RMKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_ret_rmks;
            (param[14] = new OracleParameter("p_GDD_IS_REREC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_is_rerec;
            (param[15] = new OracleParameter("p_GDD_REREC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _credSaleDocdet.Gdd_rerec_dt;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = UpdateRecords("sp_save_crd_sale_docd", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateCredSaleDocAllIssue(DateTime _gdh_iss_dt, Int32 _gdh_seq)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_gdh_iss_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _gdh_iss_dt;
            (param[1] = new OracleParameter("p_gdh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _gdh_seq;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_upd_crd_sale_doc", CommandType.StoredProcedure, param);

            return effect;

        }


        public DataTable Get_ITEMS_ONSelect(string _mainCt, string _SubCt, string _Range, string _code, string _brand, string _type)
        {

            _mainCt = (!string.IsNullOrEmpty(_mainCt)) ? (_mainCt.ToUpper() + "%") : "%";
            _SubCt = (!string.IsNullOrEmpty(_SubCt)) ? (_SubCt.ToUpper() + "%") : "%";
            _Range = (!string.IsNullOrEmpty(_Range)) ? (_Range.ToUpper() + "%") : "%";
            _code = (!string.IsNullOrEmpty(_code)) ? (_code.ToUpper() + "%") : "%";
            _brand = (!string.IsNullOrEmpty(_brand)) ? (_brand.ToUpper() + "%") : "%";


            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_main_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCt;
            (param[1] = new OracleParameter("p_sub_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SubCt;
            (param[2] = new OracleParameter("p_range", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Range;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ITEMS_ONSelect", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAC_SevCharge_itmes(string _company, string itemCode)
        {
            //spGetAC_SevCharge_itmes(p_com in NVARCHAR2,p_itemCode in NVARCHAR2 ,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblCat", "spGetAC_SevCharge_itmes", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetIncentiveSaleTypes()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_inc_stype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetIncentiveSTypeByCode(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_inc_stp_by_cd", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 Save_MST_ITM_BLOCK(MasterItemBlock _itmBlock)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_com;
            (param[1] = new OracleParameter("p_category_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mbi_category_tp;
            (param[2] = new OracleParameter("p_category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_category;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_itm;
            (param[4] = new OracleParameter("p_pr_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmBlock.Mib_pr_tp;
            (param[5] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmBlock.Mib_stus == true ? 1 : 0;
            (param[6] = new OracleParameter("p_cr_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_cr_by;
            (param[7] = new OracleParameter("p_cr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itmBlock.Mib_cr_dt;
            (param[8] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_mod_by;
            (param[9] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itmBlock.Mib_mod_dt;
            (param[10] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_brnd;
            (param[11] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_cat1;
            (param[12] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmBlock.Mib_cat2;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = UpdateRecords("sp_save_MST_ITM_BLOCK_new", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable Get_sar_price_type(string _tpCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tpCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tpCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "get_sar_price_type", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public int SaveIncentiveSchPC(IncentiveSchPC _detail)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_INCL_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_ref;
            (param[1] = new OracleParameter("p_INCL_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_circ;
            (param[2] = new OracleParameter("p_INCL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Incl_line;
            (param[3] = new OracleParameter("p_INCL_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_chnl;
            (param[4] = new OracleParameter("p_INCL_SCHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_schnl;
            (param[5] = new OracleParameter("p_INCL_AREA", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_area;
            (param[6] = new OracleParameter("p_INCL_REG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_reg;
            (param[7] = new OracleParameter("p_INCL_ZONE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_zone;
            (param[8] = new OracleParameter("p_INCL_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Incl_pc;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_pc", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveIncentiveSchPB(IncentiveSchPB _detail)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_INPBL_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpbl_ref;
            (param[1] = new OracleParameter("p_INPBL_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpbl_circ;
            (param[2] = new OracleParameter("p_INPBL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Inpbl_line;
            (param[3] = new OracleParameter("p_INPBL_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Inpbl_dt_line;
            (param[4] = new OracleParameter("p_INPBL_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpbl_pb;
            (param[5] = new OracleParameter("p_INPBL_PB_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpbl_pb_lvl;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_pb", CommandType.StoredProcedure, param);
            return effects;
        }
        public int SaveIncentiveSchMode(IncentiveSchMode _detail)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_INPYM_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpym_ref;
            (param[1] = new OracleParameter("p_INPYM_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpym_circ;
            (param[2] = new OracleParameter("p_INPYM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Inpym_line;
            (param[3] = new OracleParameter("p_INPYM_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Inpym_dt_line;
            (param[4] = new OracleParameter("p_INPYM_MODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Inpym_mode;
            (param[5] = new OracleParameter("p_INPYM_IS_PROMO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Inpym_is_promo;
            (param[6] = new OracleParameter("p_INPYM_PROMO_MNTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Inpym_promo_mnth;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_mode", CommandType.StoredProcedure, param);
            return effects;
        }
        public int SaveIncentiveSchStockTp(IncentiveSchStkTp _detStkTp)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_INCS_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detStkTp.Incs_ref;
            (param[1] = new OracleParameter("p_INCS_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detStkTp.Incs_circ;
            (param[2] = new OracleParameter("p_INCS_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detStkTp.Incs_line;
            (param[3] = new OracleParameter("p_INCS_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detStkTp.Incs_dt_line;
            (param[4] = new OracleParameter("p_INCS_STK_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detStkTp.Incs_stk_tp;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_stktp", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveIncentiveSchDet(IncentiveSchDet _incDet)
        {
            OracleParameter[] param = new OracleParameter[23];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_INCD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_ref;
            (param[1] = new OracleParameter("p_INCD_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_circ;
            (param[2] = new OracleParameter("p_INCD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_line;
            (param[3] = new OracleParameter("p_INCD_SALE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_sale_tp;
            (param[4] = new OracleParameter("p_INCD_ALT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_alt;
            (param[5] = new OracleParameter("p_INCD_IS_ALT_ITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_is_alt_itm;
            (param[6] = new OracleParameter("p_INCD_ALLOW_SER", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_allow_ser;
            (param[7] = new OracleParameter("p_INCD_IS_VAL_RANGE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_is_val_range;
            (param[8] = new OracleParameter("p_INCD_ALL_STK_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_all_stk_tp;
            (param[9] = new OracleParameter("p_INCD_IS_COMB_ITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_is_comb_itm;
            (param[10] = new OracleParameter("p_INCD_MAIN_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_main_cat;
            (param[11] = new OracleParameter("p_INCD_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_cat;
            (param[12] = new OracleParameter("p_INCD_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_brand;
            (param[13] = new OracleParameter("p_INCD_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_model;
            (param[14] = new OracleParameter("p_INCD_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _incDet.Incd_itm;
            (param[15] = new OracleParameter("p_INCD_VAL_FROM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_val_from;
            (param[16] = new OracleParameter("p_INCD_VAL_TO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_val_to;
            (param[17] = new OracleParameter("p_INCD_COMEN_DT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_comen_dt;
            (param[18] = new OracleParameter("p_INCD_COMEN_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_comen_line;
            (param[19] = new OracleParameter("p_INCD_IS_OTH_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_is_oth_qty;
            (param[20] = new OracleParameter("p_INCD_ACTUAL_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_actual_qty;
            (param[21] = new OracleParameter("p_INCD_OTH_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _incDet.Incd_oth_qty;
            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_dt", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveIncentiveSchPerson(IncentiveSchPersn _detPerson)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_INCP_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detPerson.Incp_ref;
            (param[1] = new OracleParameter("p_INCP_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detPerson.Incp_circ;
            (param[2] = new OracleParameter("p_INCP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detPerson.Incp_line;
            (param[3] = new OracleParameter("p_INCP_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detPerson.Incp_dt_line;
            (param[4] = new OracleParameter("p_INCP_PERSON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detPerson.Incp_person;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_peson", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveIncentiveSchSerial(IncentiveSchSerial _detSer)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_INCR_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detSer.Incr_ref;
            (param[1] = new OracleParameter("p_INCR_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detSer.Incr_circ;
            (param[2] = new OracleParameter("p_INCR_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detSer.Incr_line;
            (param[3] = new OracleParameter("p_INCR_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detSer.Incr_dt_line;
            (param[4] = new OracleParameter("p_INCR_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detSer.Incr_ser;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_ser", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<MasterItemStatus> GetAllStockTypes(string _comp)
        {
            List<MasterItemStatus> _List = null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_all_stk_tps", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<MasterItemStatus>(_dtResults, MasterItemStatus.ConvertTotal);
            }

            return _List;
        }

        //Shani
        public Int32 SaveVehicalRegistrationDefinition_NEW(VehicalRegistrationDefnition _vehRegDef)
        {
            OracleParameter[] param = new OracleParameter[29];
            Int32 rows_aff = 0;

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = GetSerialID();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_pc;
            (param[3] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_from_dt;
            (param[4] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_to_dt;
            (param[5] = new OracleParameter("p_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_sale_tp;
            (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_itm;
            (param[7] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_val;
            (param[8] = new OracleParameter("p_claim_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_claim_val;
            (param[9] = new OracleParameter("p_is_req", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_is_req == true ? 1 : 0;
            (param[10] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_cre_by;
            (param[11] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_cre_dt;
            (param[12] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_scheme;
            (param[13] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_pay_tp;
            (param[14] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_term;
            (param[15] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_circular;
            (param[16] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_pb;
            (param[17] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_pb_lvl;
            (param[18] = new OracleParameter("p_cust_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_cust_tp;
            (param[19] = new OracleParameter("p_from_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_from_qty;
            (param[20] = new OracleParameter("p_to_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_to_qty;
            (param[21] = new OracleParameter("p_from_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_from_val;
            (param[22] = new OracleParameter("p_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_to_val;
            (param[23] = new OracleParameter("p_check_on", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_check_on == true ? 1 : 0;
            (param[24] = new OracleParameter("p_alw_mult_pay", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_alw_mult_pay == true ? 1 : 0; ;
            (param[25] = new OracleParameter("p_svrd_no_of_times", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.SVRD_NO_OF_TIMES;
            (param[26] = new OracleParameter("p_svrd_no_of_used", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vehRegDef.SVRD_NO_OF_USED;
            (param[27] = new OracleParameter("p_ser_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehRegDef.Svrd_ser_1;  //Tharanga 2017/06/01

            param[28] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_aff = UpdateRecords("sp_saveVehReg_Difinition", CommandType.StoredProcedure, param);

            rows_aff = rows_aff + rows_aff;
            return rows_aff;

        }

        public List<IncentiveSch> GetIncentiveSchemes(string _circ)
        {
            List<IncentiveSch> _masterType = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterType", "sp_get_inc_sch", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterType = DataTableExtensions.ToGenericList<IncentiveSch>(_dtResults, IncentiveSch.Converter);
            }
            return _masterType;
        }




        public List<IncentiveSchDet> GetIncSchDet(string _ref)
        {
            List<IncentiveSchDet> _masterType = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblMasterType", "sp_get_inc_sch_dt", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _masterType = DataTableExtensions.ToGenericList<IncentiveSchDet>(_dtResults, IncentiveSchDet.Converter);
            }
            return _masterType;
        }

        public int SaveIncentiveScheme(IncentiveSch _det)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_INC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_ref;
            (param[1] = new OracleParameter("p_INC_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_circ;
            (param[2] = new OracleParameter("p_INC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Inc_dt;
            (param[3] = new OracleParameter("p_INC_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Inc_from;
            (param[4] = new OracleParameter("p_INC_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Inc_to;
            (param[5] = new OracleParameter("p_INC_ALLOW_DISC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Inc_allow_disc;
            (param[6] = new OracleParameter("p_INC_ALLOW_FWSALES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Inc_allow_fwsales;
            (param[7] = new OracleParameter("p_INC_FWD_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Inc_fwd_period;
            (param[8] = new OracleParameter("p_INC_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_stus;
            (param[9] = new OracleParameter("p_INC_PROCESED", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_procesed;
            (param[10] = new OracleParameter("p_INC_ALL_ITMS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Inc_all_itms;
            (param[11] = new OracleParameter("p_INC_XNO_OF_TIMES_UPD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det.Inc_xno_of_times_upd;
            (param[12] = new OracleParameter("p_INC_XREF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_xref;
            (param[13] = new OracleParameter("p_INC_XMOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_xmod_by;
            (param[14] = new OracleParameter("p_INC_XMOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Inc_xmod_dt;
            (param[15] = new OracleParameter("p_INC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_cre_by;
            (param[16] = new OracleParameter("p_INC_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Inc_cre_when;
            (param[17] = new OracleParameter("p_INC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_mod_by;
            (param[18] = new OracleParameter("p_INC_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _det.Inc_mod_when;
            (param[19] = new OracleParameter("p_INC_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _det.Inc_session_id;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveIncentiveSchInc(IncentiveSchInc _detInc)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_INCI_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detInc.Inci_ref;
            (param[1] = new OracleParameter("p_INCI_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detInc.Inci_circ;
            (param[2] = new OracleParameter("p_INCI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detInc.Inci_line;
            (param[3] = new OracleParameter("p_INCI_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detInc.Inci_dt_line;
            (param[4] = new OracleParameter("p_INCI_IS_ALT_INC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detInc.Inci_is_alt_inc;
            (param[5] = new OracleParameter("p_INCI_ALT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detInc.Inci_alt;
            (param[6] = new OracleParameter("p_INCI_INC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detInc.Inci_inc_tp;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_inc", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveIncentiveSchIncDet(IncentiveSchIncDet _detIncDet)
        {
            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_INCID_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detIncDet.Incid_ref;
            (param[1] = new OracleParameter("p_INCID_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detIncDet.Incid_circ;
            (param[2] = new OracleParameter("p_INCID_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_line;
            (param[3] = new OracleParameter("p_INCID_INC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_inc_line;
            (param[4] = new OracleParameter("p_INCID_ALT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_alt;
            (param[5] = new OracleParameter("p_INCID_IS_ALT_ITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_is_alt_itm;
            (param[6] = new OracleParameter("p_INCID_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detIncDet.Incid_itm;
            (param[7] = new OracleParameter("p_INCID_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_qty;
            (param[8] = new OracleParameter("p_INCID_AMOUNT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_amount;
            (param[9] = new OracleParameter("p_INCID_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detIncDet.Incid_desc;
            (param[10] = new OracleParameter("p_INCID_DT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detIncDet.Incid_dt_line;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_inc_sch_inc_dt", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<VehicalRegistrationDefnition> Get_vehRegDefnByCircular(string _circular)
        {
            List<VehicalRegistrationDefnition> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "get_veh_regDefnByCircular", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<VehicalRegistrationDefnition>(_dtResults, VehicalRegistrationDefnition.Converter);
            }
            return _list;
            //return _dtResults;
        }
        public Int32 Update_Veh_reg_defn(string _circular, DateTime fromNew, DateTime ToNew)
        {
            // sp_update_Veh_reg_defn (p_circular in NVARCHAR2, p_DateFrom in DATE,p_DateTo in DATE,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_DateFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromNew;
            (param[2] = new OracleParameter("p_DateTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToNew;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_Veh_reg_defn", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetReceiptDivision(string _company, List<string> _profitcenter)
        {
            //sp_getreceiptdivision(p_com in NVARCHAR2,p_pc in mst_pc,c_data out sys_refcursor) is
            ODPStringVarray _arr = new ODPStringVarray();
            _arr.Array = _profitcenter.ToArray<string>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.Array, null, ParameterDirection.Input)).Value = _arr; param[1].UdtTypeName = "EMS.MST_PC";
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getreceiptdivision", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int Save_AccountAgreement_Doc(AccountAgreementDoc _agreement)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agrd_accno;
            (param[1] = new OracleParameter("p_prd_cd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agreement.Agrd_prd_cd;
            (param[2] = new OracleParameter("p_doc_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agrd_doc_name;
            (param[3] = new OracleParameter("p_is_reciev", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agreement.Agrd_is_recieve == true ? 1 : 0;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_acc_agreement_doc", CommandType.StoredProcedure, param);
            return effects;
        }

        public int Save_AccountAgreement(AccountAgreement _agreement)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_account;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_location;
            (param[2] = new OracleParameter("p_date_received", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_date_received;
            (param[3] = new OracleParameter("p_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_sessionid;
            (param[4] = new OracleParameter("p_timestamp", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_timestamp;
            (param[5] = new OracleParameter("p_modifieddate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_modifieddate;
            (param[6] = new OracleParameter("p_datereturned", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_datereturned;
            (param[7] = new OracleParameter("p_handover", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_handover;
            (param[8] = new OracleParameter("p_handovername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_handovername;
            (param[9] = new OracleParameter("p_handoverid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_handoverid;
            (param[10] = new OracleParameter("p_timereturned", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _agreement.Agr_timereturned;
            (param[11] = new OracleParameter("p_closure", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agreement.Agr_closure == true ? 1 : 0;
            (param[12] = new OracleParameter("p_closuretype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_closuretype;
            (param[13] = new OracleParameter("p_closuredate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_closuredate;
            (param[14] = new OracleParameter("p_writtenoff", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_writtenoff;
            (param[15] = new OracleParameter("p_slipno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_slipno;
            (param[16] = new OracleParameter("p_agr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_stus;
            (param[17] = new OracleParameter("p_agr_comcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreement.Agr_comcd;
            (param[18] = new OracleParameter("p_agr_closedt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreement.Agr_closedt;

            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_acc_agreement", CommandType.StoredProcedure, param);
            return effects;
        }

        public Decimal GetNotReciveCount(string accNo)
        {
            OracleParameter[] param = new OracleParameter[1];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            OracleParameter _outParam = new OracleParameter("c_notRec", OracleDbType.Decimal, null, ParameterDirection.Output);

            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_GetAccAgreeDocReceiveDet", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        public DataTable Get_AccountAgreementHdr(string accountNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "get_HPT_AccountAgreement", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        public DataTable Get_PromotorType()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_promo_type", CommandType.StoredProcedure, false, param);

            return tblDet;
        }
        public List<MST_PROMOTOR> Get_PROMOTOR(string _CODE, string _MOB, string _NIC)
        {
            List<MST_PROMOTOR> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CODE;
            (param[1] = new OracleParameter("p_MOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MOB;
            (param[2] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NIC;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_GET_PROMOTOR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MST_PROMOTOR>(_dtResults, MST_PROMOTOR.Converter);
            }
            return _list;

        }

        public List<AccountAgreementDoc> Get_HPT_AccountAgreementDocs(string accountNo, string isRecieved)
        {
            List<AccountAgreementDoc> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            (param[1] = new OracleParameter("p_isReceived", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isRecieved;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "get_HPT_AccountAgreementDocs", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AccountAgreementDoc>(_dtResults, AccountAgreementDoc.Converter);
            }
            return _list;

        }

        public int Save_AccountAgreementContact(AccountAgreementContact _agreeCont)
        {
            OracleParameter[] param = new OracleParameter[24];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_account;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_code;
            (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_location;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_type;
            (param[4] = new OracleParameter("p_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_title;
            (param[5] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_nic;
            (param[6] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_dl;
            (param[7] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_passport;
            (param[8] = new OracleParameter("p_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_fname;
            (param[9] = new OracleParameter("p_mname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_mname;
            (param[10] = new OracleParameter("p_lname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_lname;
            (param[11] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_add1;
            (param[12] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_add2;
            (param[13] = new OracleParameter("p_add3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_add3;
            (param[14] = new OracleParameter("p_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_city;
            (param[15] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_district;
            (param[16] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_province;
            (param[17] = new OracleParameter("p_postalcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_postalcode;
            (param[18] = new OracleParameter("p_telhome", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_telhome;
            (param[19] = new OracleParameter("p_telresident", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_telresident;
            (param[20] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_mobile;
            (param[21] = new OracleParameter("p_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_sex;
            (param[22] = new OracleParameter("p_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_dob;

            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_AccAgreementContact", CommandType.StoredProcedure, param);
            return effects;
        }

        public int Save_AccountAgreementProduct(AccountAgreementProduct _agrProduct)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrProduct.Itm_account;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrProduct.Itm_code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agrProduct.Itm_desc;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _agrProduct.Itm_qty;
            (param[4] = new OracleParameter("p_unitprice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _agrProduct.Itm_unitprice;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_AccAgreement_Product", CommandType.StoredProcedure, param);
            return effects;
        }

        public int Save_AccountAgreementScheme(AccountAgreementScheme _agreeSch)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeSch.Sch_account;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeSch.Sch_code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeSch.Sch_desc;
            (param[3] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _agreeSch.Sch_term;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_AccAgreement_Scheme", CommandType.StoredProcedure, param);
            return effects;
        }


        public Int32 Delete_AccountAgreementProduct(string _accountNo, string itemCode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountNo;
            (param[1] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_AccAgreementProduct", CommandType.StoredProcedure, param);
            return effects;
        }

        public AccountAgreementContact Get_Accounts_Agreement_Contact(string _accountNo)
        {
            //List<AccountAgreementContact> _list = null;
            AccountAgreementContact _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "get_Accounts_Agreement_Contact", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AccountAgreementContact>(_tblData, AccountAgreementContact.Converter)[0];
            }
            return _list;
        }

        public AccountAgreementScheme Get_Accounts_Agreement_Scheme(string _accountNo)
        {

            AccountAgreementScheme _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_acc_agr_sch", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AccountAgreementScheme>(_tblData, AccountAgreementScheme.Converter)[0];
            }
            return _list;
        }

        public DataTable Get_Account_Agreement_StartDt(string pc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "get_Acc_Agreement_StartDt", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        public int Save_accountAgreement_startdate(AccountAgreementStartDate _startDt)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startDt.Agrs_location;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _startDt.Agrs_date;
            (param[2] = new OracleParameter("p_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startDt.Agrs_sessionid;
            (param[3] = new OracleParameter("p_createuser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startDt.Agrs_createuser;
            (param[4] = new OracleParameter("p_createddate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _startDt.Agrs_createddate;
            (param[5] = new OracleParameter("p_modifieduser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startDt.Args_modifieduser;
            (param[6] = new OracleParameter("p_modifieddate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _startDt.Agrs_modifieddate;
            (param[7] = new OracleParameter("p_timestamp", OracleDbType.Date, null, ParameterDirection.Input)).Value = _startDt.Agrs_timestamp;
            (param[8] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startDt.Args_com;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_accAgreement_startdate", CommandType.StoredProcedure, param);
            return effects;
        }

        public int Save_AccountAgreementContact_new(AccountAgreementContact _agreeCont)
        {
            OracleParameter[] param = new OracleParameter[51];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_account;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_code;
            (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_location;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_type;
            (param[4] = new OracleParameter("p_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_title;
            (param[5] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_nic;
            (param[6] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_dl;
            (param[7] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_passport;
            (param[8] = new OracleParameter("p_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_fname;
            (param[9] = new OracleParameter("p_mname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_mname;
            (param[10] = new OracleParameter("p_lname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_lname;
            (param[11] = new OracleParameter("p_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_add1;
            (param[12] = new OracleParameter("p_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_add2;
            (param[13] = new OracleParameter("p_add3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_add3;
            (param[14] = new OracleParameter("p_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_city;
            (param[15] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_district;
            (param[16] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_province;
            (param[17] = new OracleParameter("p_postalcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_postalcode;
            (param[18] = new OracleParameter("p_telhome", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_telhome;
            (param[19] = new OracleParameter("p_telresident", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_telresident;
            (param[20] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_mobile;
            (param[21] = new OracleParameter("p_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_sex;
            (param[22] = new OracleParameter("p_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_dob;

            (param[23] = new OracleParameter("p_guarantor1_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_code;
            (param[24] = new OracleParameter("p_guarantor1_addr1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_addr1;
            (param[25] = new OracleParameter("p_guarantor1_addr2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_addr2;
            (param[26] = new OracleParameter("p_guarantor1_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_name;
            (param[27] = new OracleParameter("p_guarantor1_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_nic;
            (param[28] = new OracleParameter("p_guarantor2_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_code;
            (param[29] = new OracleParameter("p_guarantor2_addr1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_addr1;
            (param[30] = new OracleParameter("p_guarantor2_addr2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_addr2;
            (param[31] = new OracleParameter("p_guarantor2_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_name;
            (param[32] = new OracleParameter("p_guarantor2_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_nic;
            (param[33] = new OracleParameter("p_guarantor3_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_code;
            (param[34] = new OracleParameter("p_guarantor3_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_name;
            (param[35] = new OracleParameter("p_guarantor3_addr1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_addr1;
            (param[36] = new OracleParameter("p_guarantor3_addr2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_addr2;
            (param[37] = new OracleParameter("p_guarantor3_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_nic;
            (param[38] = new OracleParameter("p_guarantor1_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_mobile;
            (param[39] = new OracleParameter("p_guarantor2_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_mobile;
            (param[40] = new OracleParameter("p_guarantor3_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_mobile;
            (param[41] = new OracleParameter("p_guarantor1_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_tel;
            (param[42] = new OracleParameter("p_guarantor2_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_tel;
            (param[43] = new OracleParameter("p_guarantor3_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_tel;
            (param[44] = new OracleParameter("p_guarantor1_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_DL;
            (param[45] = new OracleParameter("p_guarantor2_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_DL;
            (param[46] = new OracleParameter("p_guarantor3_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_DL;
            (param[47] = new OracleParameter("p_guarantor1_pp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor1_PP;
            (param[48] = new OracleParameter("p_guarantor2_pp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor2_PP;
            (param[49] = new OracleParameter("p_guarantor3_pp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agreeCont.Cnt_guarantor3_PP;



            param[50] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_AccAgreementCont", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public Int32 SaveESDTransaction(ESDTxn _esdTxn)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_ESD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_com;
            (param[1] = new OracleParameter("p_ESD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_pc;
            (param[2] = new OracleParameter("p_ESD_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_epf;
            (param[3] = new OracleParameter("p_ESD_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _esdTxn.Esd_month;
            (param[4] = new OracleParameter("p_ESD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _esdTxn.Esd_dt;
            (param[5] = new OracleParameter("p_ESD_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_tp;
            (param[6] = new OracleParameter("p_ESD_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_desc;
            (param[7] = new OracleParameter("p_ESD_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_ref;
            (param[8] = new OracleParameter("p_ESD_CR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdTxn.Esd_cr;
            (param[9] = new OracleParameter("p_ESD_DR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdTxn.Esd_dr;
            (param[10] = new OracleParameter("p_ESD_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_rem;
            (param[11] = new OracleParameter("p_ESD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_cre_by;
            (param[12] = new OracleParameter("p_ESD_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _esdTxn.Esd_cre_when;
            (param[13] = new OracleParameter("p_ESD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdTxn.Esd_mod_by;
            (param[14] = new OracleParameter("p_ESD_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _esdTxn.Esd_mod_when;
            (param[15] = new OracleParameter("p_ESD_ANAL_1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _esdTxn.Esd_anal_1;

            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_save_esd_txn", CommandType.StoredProcedure, param);

            return _effect;
        }

        //kapila
        public int GetESDPrvBal(string _com, string _pc, string _epf, DateTime _month, out Decimal _prvESDBal, out Decimal _prvIntBal)
        {
            Decimal _valESD = 0;
            Decimal _valInt = 0;
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_esd_prv_bal", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count != 0)
            {
                //for (int i = 0; i < _result.Rows.Count; i++)
                //{
                if (!string.IsNullOrEmpty(_result.Rows[0]["ESDBAL"].ToString()))
                    _valESD = Convert.ToDecimal(_result.Rows[0]["ESDBAL"]);

                if (!string.IsNullOrEmpty(_result.Rows[0]["INTBAL"].ToString()))
                    _valInt = Convert.ToDecimal(_result.Rows[0]["INTBAL"]);

                _eff = 1;
                //}
            }

            _prvESDBal = _valESD;
            _prvIntBal = _valInt;

            return _eff;
        }

        //kapila
        public int GetESDCurRecTotal(string _com, string _pc, string _epf, DateTime _month, out Decimal _curRecTot)
        {
            Decimal _valRecTot = 0;
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_esd_cur_rec_tot", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count != 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                    _valRecTot = Convert.ToDecimal(_result.Rows[0]["totamt"]);

                _eff = 1;
            }

            _curRecTot = _valRecTot;

            return _eff;
        }

        //kapila
        public int GetESDContribution(string _com, string _pc, DateTime _from, DateTime _to, out Decimal _ESDContr, string _epf)
        {
            Decimal _valContr = 0;
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_esd_contrbtion_new", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count != 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                    _valContr = Convert.ToDecimal(_result.Rows[0]["totamt"]);

                _eff = 1;
            }

            _ESDContr = _valContr;

            return _eff;
        }

        //kapila
        public int GetESDAdj(string _com, string _pc, string _epf, DateTime _month, out Decimal _ESDAdj)
        {
            Decimal _val = 0;
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_esd_adj", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count != 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);

                _eff = 1;
            }

            _ESDAdj = _val;

            return _eff;
        }

        //kapila
        public int GetIntAdj(string _com, string _pc, string _epf, DateTime _month, out Decimal _IntAdj)
        {
            Decimal _val = 0;
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_int_adj", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count != 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);

                _eff = 1;
            }

            _IntAdj = _val;

            return _eff;
        }

        //kapila
        public Int32 SaveESDBalance(ESDBal _esdBal)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[16];

            (param[0] = new OracleParameter("p_ESDB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdBal.Esdb_com;
            (param[1] = new OracleParameter("p_ESDB_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdBal.Esdb_pc;
            (param[2] = new OracleParameter("p_ESDB_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdBal.Esdb_epf;
            (param[3] = new OracleParameter("p_ESDB_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _esdBal.Esdb_month;
            (param[4] = new OracleParameter("p_ESDB_ESD_OPBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_esd_opbal;
            (param[5] = new OracleParameter("p_ESDB_ESD_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_esd_adj;
            (param[6] = new OracleParameter("p_ESDB_ESD_CONT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_esd_cont;
            (param[7] = new OracleParameter("p_ESDB_ESD_CLBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_esd_clbal;
            (param[8] = new OracleParameter("p_ESDB_INT_OPBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_int_opbal;
            (param[9] = new OracleParameter("p_ESDB_INT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_int_adj;
            (param[10] = new OracleParameter("p_ESDB_INT_CONT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_int_cont;
            (param[11] = new OracleParameter("p_ESDB_INT_CLBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _esdBal.Esdb_int_clbal;
            (param[12] = new OracleParameter("p_ESDB_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdBal.Esdb_stus;
            (param[13] = new OracleParameter("p_ESDB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _esdBal.Esdb_mod_by;
            (param[14] = new OracleParameter("p_ESDB_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _esdBal.Esdb_mod_when;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_save_esd_bal", CommandType.StoredProcedure, param);

            return _effect;
        }

        //kapila
        public Int32 SaveBrandAlloc(string _mba_com, string _mba_pty_tp, string _mba_pty_cd, string _mba_emp_id, string _mba_brnd, string _mba_ca1, string _mba_ca2, string _mba_ca3, string _mba_ca4, string _mba_ca5, DateTime _mba_frm_dt, DateTime _mba_to_dt, Int32 _mba_act, string _mba_cre_by, string _mba_mod_by)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[16];

            (param[0] = new OracleParameter("p_mba_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_com;
            (param[1] = new OracleParameter("p_mba_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_pty_tp;
            (param[2] = new OracleParameter("p_mba_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_pty_cd;
            (param[3] = new OracleParameter("p_mba_emp_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_emp_id;
            (param[4] = new OracleParameter("p_mba_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_brnd;
            (param[5] = new OracleParameter("p_mba_ca1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_ca1;
            (param[6] = new OracleParameter("p_mba_ca2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_ca2;
            (param[7] = new OracleParameter("p_mba_ca3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_ca3;
            (param[8] = new OracleParameter("p_mba_ca4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_ca4;
            (param[9] = new OracleParameter("p_mba_ca5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_ca5;
            (param[10] = new OracleParameter("p_mba_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mba_frm_dt;
            (param[11] = new OracleParameter("p_mba_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mba_to_dt;
            (param[12] = new OracleParameter("p_mba_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mba_act;
            (param[13] = new OracleParameter("p_mba_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_cre_by;
            (param[14] = new OracleParameter("p_mba_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mba_mod_by;

            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_save_brdmgr_cat", CommandType.StoredProcedure, param);

            return _effect;
        }
        public List<AccountAgreementProduct> Get_Acc_Agreement_products(string accountNo)
        {
            List<AccountAgreementProduct> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "get_Acc_Agreement_products", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AccountAgreementProduct>(_dtResults, AccountAgreementProduct.Converter);
            }
            return _list;

        }

        public int UpdateCashPromotionalDiscountHdr(int _seq, DateTime _from, DateTime _to, decimal _disval, decimal _disrt)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            (param[3] = new OracleParameter("p_dis_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _disval;
            (param[4] = new OracleParameter("p_dis_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _disrt;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_pro_hdr", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Prabhath on 20/09/2013
        public Int32 Save_MST_PC_INFO_log(MasterSalesPriorityHierarchyLog _infohdr)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_com_cd;
            (param[1] = new OracleParameter("p_pc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_pc_cd;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_tp;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_cd;
            (param[4] = new OracleParameter("p_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_val;
            (param[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mpil_act;
            (param[6] = new OracleParameter("p_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mpil_frm_dt;
            (param[7] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mpil_to_dt;
            (param[8] = new OracleParameter("p_cr_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_cr_by;
            (param[9] = new OracleParameter("p_cr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mpil_cr_dt;
            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mpil_mod_by;
            (param[11] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mpil_mod_dt;
            (param[12] = new OracleParameter("p_isupdt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mpil_isupdt;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_savepcinfolog", CommandType.StoredProcedure, param);
            return effect;

        }

        //Written by Prabhath on 20/09/2013
        public Int32 save_mst_loc_info_log(MasterLocationPriorityHierarchyLog _infohdr)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_com_cd;
            (param[1] = new OracleParameter("p_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_loc_cd;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_tp;
            (param[3] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_cd;
            (param[4] = new OracleParameter("p_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_val;
            (param[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mlil_act;
            (param[6] = new OracleParameter("p_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mlil_frm_dt;
            (param[7] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mlil_to_dt;
            (param[8] = new OracleParameter("p_cr_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_cr_by;
            (param[9] = new OracleParameter("p_cr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mlil_cr_dt;
            (param[10] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _infohdr.Mlil_mod_by;
            (param[11] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _infohdr.Mlil_mod_dt;
            (param[12] = new OracleParameter("p_isupdt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _infohdr.Mlil_isupdt;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_savelocinfolog", CommandType.StoredProcedure, param);

            return effect;

        }

        public DataTable GetInforBackDate(string _company, string _module)
        {
            //sp_getinfobackdate(p_com in NVARCHAR2,p_module in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_getinfobackdate", "sp_getinfobackdate", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public Int32 UpdateInvoiceStructure(string _company, string _profitceter, DateTime _fromdate, DateTime _todate, string _code, string _value)
        {
            //sp_updateinvstr(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_fromdt in date,p_todt in date, p_code in NVARCHAR2,p_value in NVARCHAR2,o_effect out number)
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitceter;
            (param[2] = new OracleParameter("p_fromdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate.Date;
            (param[3] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate.Date;
            (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_updateinvstr", CommandType.StoredProcedure, param);
            return effect;
        }

        //DARSHANA 28-09-2013
        public DataTable SearchRequestApprovalDetails(string _com, string _usr, string _type, DateTime _frmDt, DateTime _toDt, string _stus, string _baseTp)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usr;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt.Date;
            (param[4] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt.Date;
            (param[5] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[6] = new OracleParameter("p_baseTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseTp;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getreqappdet", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        //darshana 30-09-2013
        public DataTable SearchrequestAppDetByRef(string _ref)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getreqappdetbyref", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        public List<RequestApprovalHeader> GetPendingSRNRequest(string _com, string _pc, string _inv, string _app)
        {
            List<RequestApprovalHeader> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_app", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _app;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pending_revl_request", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter);
            }
            return _list;

        }

        public List<RequestApprovalHeader> GetPendingExchangeRequest(string _com, string _pc, string _itm, string _app)
        {
            List<RequestApprovalHeader> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_app", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _app;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pending_exc_req", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_dtResults, RequestApprovalHeader.Converter);
            }
            return _list;

        }

        public Int32 GetExchangeNextLineNo(string _requestno)
        {
            //sp_getmaxlineno(p_reqno in  NVARCHAR2, o_effect out NVARCHAR2)
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getmaxlineno", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 InactiveOldIssueItem(string _request)
        {
            //sp_updateexchangeissue(p_reqno in NVARCHAR2,o_effect out NUMBER) is
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_updateexchangeissue", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateExchangeRemark(string _request, string _remark)
        {
            //sp_updateexapprem(p_reqno in NVARCHAR2,p_remark in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remark;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateexapprem", CommandType.StoredProcedure, param);
            return effects;

        }

        //written by darshana on 12-11-2013
        public Int16 UpdateSerAppStus(string _com, string _Job, string _stus)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Job;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateserstus", CommandType.StoredProcedure, param);

            return effects;
        }

        public DataTable GetGvCategory(string _company, string _category)
        {
            //sp_getgvcatsetup(p_com in NVARCHAR2,p_code in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tblgv", "sp_getgvcatsetup", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        //kapila
        public int updateESDStatus(string _com, string _pc, string _epf, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_up_esd_stus", CommandType.StoredProcedure, param);
            return effects;
        }

        public int UpdateGvCategoryDetail(int _seqno)
        {
            //sp_updatestatus(p_seqno in NUMBER,o_effect out NUMBER )
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatestatus", CommandType.StoredProcedure, param);
            return effects;


        }

        public int SaveGvCategoryDetail(MasterGiftVoucherCategoryDetail _detail)
        {
            //sp_savegvcatesetupdetail(p_seqno in NUMBER,p_tp in NUMBER,p_itm in NVARCHAR2,p_stus in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Gvctd_seq;
            (param[1] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Gvctd_tp;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _detail.Gvctd_itm;
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _detail.Gvctd_stus;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_savegvcatesetupdetail", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SaveGvCategoryHeader(MasterGiftVoucherCategory _hdr)
        {
            //sp_savegvcathdr(p_seq in NUMBER,p_com in NVARCHAR2,p_cat in NVARCHAR2,p_stus in NUMBER,p_cr_by in NVARCHAR2,p_session in NVARCHAR2,p_desc in NVARCHAR2,p_verb in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[9];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Gvct_seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Gvct_com;
            (param[2] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Gvct_cat;
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Gvct_stus;
            (param[4] = new OracleParameter("p_cr_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Gvct_cr_by;
            (param[5] = new OracleParameter("p_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Gvct_session;
            (param[6] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Gvct_desc;
            (param[7] = new OracleParameter("p_verb", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Gvct_verb;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_savegvcathdr", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetRentalValue(string _account)
        {
            //sp_getrental(p_acc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_getrental", "sp_getrental", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public CashPromotionDiscountHeader GetPromotionalDiscountBySeq(int _seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            CashPromotionDiscountHeader _hdr = null;
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_getrental", "sp_get_pro_dis_by_seq", CommandType.StoredProcedure, false, param);
            //return tblDet;
            if (tblDet.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<CashPromotionDiscountHeader>(tblDet, CashPromotionDiscountHeader.Converter)[0];
            }
            return _hdr;
        }

        public DataTable GetItemLPStatus()
        {
            //sp_getlpstatus(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_getlpstatus", "sp_getlpstatus", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckCompany(string _company)
        {
            //sp_checkcompany(p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkcompany", "sp_checkcompany", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckChannel(string _company, string _channel)
        {
            //sp_checkchannel(p_com in NVARCHAR2,p_channel in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkchannel", "sp_checkchannel", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckSubChannel(string _company, string _subchannel)
        {
            //sp_checksubchannel (p_com in NVARCHAR2,p_subchannel in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subchannel;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checksubchannel", "sp_checksubchannel", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckArea(string _company, string _area)
        {
            //sp_checkarea(p_com in NVARCHAR2,p_area in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkarea", "sp_checkarea", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckRegion(string _company, string _region)
        {
            //sp_checkregion(p_com in NVARCHAR2,p_region in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _region;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkregion", "sp_checkregion", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckZone(string _company, string _zone)
        {
            //sp_checkzone(p_com in NVARCHAR2,p_zone in NVARCHAR2,c_data out sys_refcursor) 
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkzone", "sp_checkzone", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckProfitCenter(string _company, string _profitcenter)
        {
            //sp_checkprofitctn(p_com in NVARCHAR2,p_pc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkprofitctn", "sp_checkprofitctn", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //kapila
        public DataTable Get_All_PC(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getallpc", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetDeductionDet(Int32 _cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_get_ded_dt", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //By darshana on 19-02-2014
        public Int32 Save_RequestApprove_AddDet(RequestAppAddDet ReqAppAdd_det)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grad_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_ref;
            (param[1] = new OracleParameter("p_grad_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_line;
            (param[2] = new OracleParameter("p_grad_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal1;
            (param[3] = new OracleParameter("p_grad_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal2;
            (param[4] = new OracleParameter("p_grad_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal3;
            (param[5] = new OracleParameter("p_grad_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal4;
            (param[6] = new OracleParameter("p_grad_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal5;

            (param[7] = new OracleParameter("p_grad_anal6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal6;
            (param[8] = new OracleParameter("p_grad_anal7", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal7;
            (param[9] = new OracleParameter("p_grad_anal8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal8;
            (param[10] = new OracleParameter("p_grad_anal9", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal9;
            (param[11] = new OracleParameter("p_grad_anal10", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal10;

            (param[12] = new OracleParameter("p_grad_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_det.Grad_anal11;

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_reqadd_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Save_RequestApprove_AddDetLog(RequestAppAddDetLog ReqAppAdd_detLog)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_grad_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_ref;
            (param[1] = new OracleParameter("p_grad_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_line;
            (param[2] = new OracleParameter("p_grad_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal1;
            (param[3] = new OracleParameter("p_grad_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal2;
            (param[4] = new OracleParameter("p_grad_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal3;
            (param[5] = new OracleParameter("p_grad_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal4;
            (param[6] = new OracleParameter("p_grad_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal5;

            (param[7] = new OracleParameter("p_grad_anal6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal6;
            (param[8] = new OracleParameter("p_grad_anal7", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal7;
            (param[9] = new OracleParameter("p_grad_anal8", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal8;
            (param[10] = new OracleParameter("p_grad_anal9", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal9;
            (param[11] = new OracleParameter("p_grad_anal10", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal10;
            (param[12] = new OracleParameter("p_grad_lvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_lvl;
            (param[13] = new OracleParameter("p_grad_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqAppAdd_detLog.Grad_anal11;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_reqadd_det_log", CommandType.StoredProcedure, param);
            return effects;
        }

        //darshana 21-02-2014
        public DataTable SearchrequestAppAddDetByRef(string _ref)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl", "sp_getreqappadddet", CommandType.StoredProcedure, false, param);

            return tblDet;
        }

        public DataTable GetAgentCategory()
        {
            //sp_getagentcategory(c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_getagentcategory", "sp_getagentcategory", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable SearchServiceAgent(string _company, string _code)
        {
            //sp_searchserviceagent (p_com in NVARCHAR2,p_code in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            DataTable _dtResults = QueryDataTable("sp_searchserviceagent", "sp_searchserviceagent", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable CheckGroupSaleInvoiceStatus(string _com, string _pc, string _code)
        {
            //sp_checkgroupsaleinvolvement(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_code in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            DataTable _dtResults = QueryDataTable("sp_checkgroupsaleinvolvement", "sp_checkgroupsaleinvolvement", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }

        public DataTable CheckReportName(string _com, string _chnl, string _doctp)
        {   //sanjeewa 2014-03-24
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[3] = new OracleParameter("in_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_report_name", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public Int32 update_area(MasterArea _area)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_MSAR_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_com;
            (param[1] = new OracleParameter("p_MSAR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_cd;
            (param[2] = new OracleParameter("p_MSAR_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_desc;
            (param[3] = new OracleParameter("p_MSAR_MGR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_mgr_cd;
            (param[4] = new OracleParameter("p_MSAR_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _area.Msar_act;
            (param[5] = new OracleParameter("p_MSAR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_cre_by;
            (param[6] = new OracleParameter("p_MSAR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _area.Msar_cre_dt;
            (param[7] = new OracleParameter("p_MSAR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_mod_by;
            (param[8] = new OracleParameter("p_MSAR_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _area.Msar_mod_dt;
            (param[9] = new OracleParameter("p_MSAR_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _area.Msar_session_id;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_upd_area", CommandType.StoredProcedure, param);

            return effects;
        }
        //kapila
        public Int32 update_region(MasterRegion _reg)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_MSRG_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_com;
            (param[1] = new OracleParameter("p_MSRG_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_cd;
            (param[2] = new OracleParameter("p_MSRG_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_desc;
            (param[3] = new OracleParameter("p_MSRG_MGR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_mgr_cd;
            (param[4] = new OracleParameter("p_MSRG_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reg.Msrg_act;
            (param[5] = new OracleParameter("p_MSRG_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_cre_by;
            (param[6] = new OracleParameter("p_MSRG_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reg.Msrg_cre_dt;
            (param[7] = new OracleParameter("p_MSRG_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_mod_by;
            (param[8] = new OracleParameter("p_MSRG_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _reg.Msrg_mod_dt;
            (param[9] = new OracleParameter("p_MSRG_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg.Msrg_session_id;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_upd_region", CommandType.StoredProcedure, param);

            return effects;
        }

        //kapila
        public Int32 Update_ESD_SR_Details(string _com, string _pc, string _epf, DateTime _join, DateTime _ho, DateTime _AD, string _sunacc, string _user)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[9];


            (param[0] = new OracleParameter("p_ESDM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ESDM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ESDM_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_ESDM_DT_JOIN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _join;
            (param[4] = new OracleParameter("p_ESDM_DT_HO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ho;
            (param[5] = new OracleParameter("p_ESDM_DT_AD", OracleDbType.Date, null, ParameterDirection.Input)).Value = _AD;
            (param[6] = new OracleParameter("p_ESDM_SUN_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunacc;
            (param[7] = new OracleParameter("p_ESDM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_esd_sr_dt", CommandType.StoredProcedure, param);

            return effect;
        }

        //kapila
        public Int32 update_zone(MasterZone _zone)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_MSZN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_com;
            (param[1] = new OracleParameter("p_MSZN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_cd;
            (param[2] = new OracleParameter("p_MSZN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_desc;
            (param[3] = new OracleParameter("p_MSZN_MGR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_mgr_cd;
            (param[4] = new OracleParameter("p_MSZN_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _zone.Mszn_act;
            (param[5] = new OracleParameter("p_MSZN_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_cre_by;
            (param[6] = new OracleParameter("p_MSZN_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _zone.Mszn_cre_dt;
            (param[7] = new OracleParameter("p_MSZN_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_mod_by;
            (param[8] = new OracleParameter("p_MSZN_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _zone.Mszn_mod_dt;
            (param[9] = new OracleParameter("p_MSZN_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _zone.Mszn_session_id;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_upd_zone", CommandType.StoredProcedure, param);

            return effects;
        }

        //sachith
        public Int32 SaveVehicalInsuranceDefinitionNew(List<MasterProfitCenter> pcs, List<InsuItem> items, DateTime from, DateTime to, string satlesType, decimal regVal, string cre, string insCom, string insPol, int term, bool isReq, string _tp, string _book, string _level, string _serial, string _promotion, string _circuler, decimal _isRate, decimal _fromValue, decimal _toValue, string _type, string _circular)
        {
            try
            {
                int rows_aff = 0;
                InventoryDAL inv = new InventoryDAL();
                foreach (MasterProfitCenter pc in pcs)
                {
                    foreach (InsuItem st in items)
                    {
                        OracleParameter[] param = new OracleParameter[28];
                        /*
                            sp_savevehicalinsurancedefnew(
                            p_seq in sar_veh_ins_defn_new.svid_seq%TYPE,
                            p_com in sar_veh_ins_defn_new.svid_com%TYPE,
                            p_pty_tp in sar_veh_ins_defn_new.svid_pty_tp%TYPE,
                            p_pty_cd in sar_veh_ins_defn_new.svid_pty_cd%TYPE,
                            p_ins_com_cd in sar_veh_ins_defn_new.svid_ins_com_cd%TYPE,
                            p_polc_cd in sar_veh_ins_defn_new.svid_polc_cd%TYPE,
                            p_from_dt in sar_veh_ins_defn_new.svid_from_dt%TYPE,
                            p_to_dt in sar_veh_ins_defn_new.svid_to_dt%TYPE,
                            p_sale_tp in sar_veh_ins_defn_new.svid_sale_tp%TYPE,
                            p_pb in sar_veh_ins_defn_new.svid_pb%TYPE,
                            p_pb_lvl in sar_veh_ins_defn_new.svid_pb_lvl%TYPE,
                            p_itm in sar_veh_ins_defn_new.svid_itm%TYPE,
                            p_promo in sar_veh_ins_defn_new.svid_promo%TYPE,
                            p_itm_val in sar_veh_ins_defn_new.svid_itm_val%TYPE,
                            p_val in sar_veh_ins_defn_new.svid_val%TYPE,
                            p_is_req in sar_veh_ins_defn_new.svid_is_req%TYPE,
                            p_cre_by in sar_veh_ins_defn_new.svid_cre_by%TYPE,
                            p_term  in sar_veh_ins_defn_new.svid_term%TYPE,
                            o_effect out NUMBER
                         */
                        inv.ConnectionOpen();
                        (param[0] = new OracleParameter("p_seq", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inv.GetSerialID();
                        (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_com;
                        (param[2] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
                        (param[3] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_cd;
                        (param[4] = new OracleParameter("p_ins_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insCom;
                        (param[5] = new OracleParameter("p_polc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insPol;
                        (param[6] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
                        (param[7] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
                        (param[8] = new OracleParameter("p_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satlesType;
                        (param[9] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
                        (param[10] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
                        (param[11] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st.Item;
                        (param[12] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st.Promotion;
                        (param[13] = new OracleParameter("p_itm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = st.Value;
                        (param[14] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = regVal;
                        (param[15] = new OracleParameter("p_is_req", OracleDbType.Byte, null, ParameterDirection.Input)).Value = isReq;
                        (param[16] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cre;
                        (param[17] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = term;
                        (param[18] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st.Cat1;// Nadeeka 02-04-2015
                        (param[19] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st.Cat2;
                        (param[20] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st.Brand;
                        (param[21] = new OracleParameter("p_svid_is_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _isRate;
                        (param[22] = new OracleParameter("p_svid_frm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _fromValue;
                        (param[23] = new OracleParameter("p_svid_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _toValue;
                        (param[24] = new OracleParameter("p_svid_ins_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                        (param[25] = new OracleParameter("p_svid_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
                        (param[26] = new OracleParameter("p_svid_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = st.Serial;
                        param[27] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                        rows_aff = UpdateRecords("sp_savevehicalinsurancedef", CommandType.StoredProcedure, param);
                        rows_aff = rows_aff + rows_aff;
                    }
                }
                //  ConnectionClose();
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }

        public DataTable CheckInsCircular(string _company, string _circular)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_checkcompany", "sp_checkInsuranceCirlular", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetDept_Comment()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GETALL_COMMENTS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka
        public DataTable GetProVoutype(string _company, string _Code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_getvoutp", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Sanjeewa 2016-06-01
        public DataTable GetAdditionalProVoutype(string _company, string _scheme)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_add_vou_dtl", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public Int32 deletePromoVouPara(string _Code)
        {
            Int32 _effect = 0;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_del_pro_vou_para", CommandType.StoredProcedure, param);
            return _effect;


        }

        //kapila
        public Int32 UpdateVoucherPromo(PromotionVoucherPara _vouPara)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_SPDP_VOU_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_vou_cd;
            (param[1] = new OracleParameter("p_SPDP_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_tp;
            (param[2] = new OracleParameter("p_SPDP_SALE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_sale_tp;
            (param[3] = new OracleParameter("p_SPDP_PRICE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_price_tp;
            (param[4] = new OracleParameter("p_SPDP_PAY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_pay_tp;
            (param[5] = new OracleParameter("p_SPDP_PAY_PRD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vouPara.Spdp_pay_prd;
            (param[6] = new OracleParameter("p_SPDP_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_anal1;
            (param[7] = new OracleParameter("p_SPDP_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouPara.Spdp_anal2;
            (param[8] = new OracleParameter("p_SPDP_ANAL3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vouPara.Spdp_anal3;
            (param[9] = new OracleParameter("p_SPDP_ANAL4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _vouPara.Spdp_anal4;
            (param[10] = new OracleParameter("p_SPDP_ANAL5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vouPara.Spdp_anal5;
            (param[11] = new OracleParameter("p_SPDP_ANAL6", OracleDbType.Date, null, ParameterDirection.Input)).Value = _vouPara.Spdp_anal6;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("sp_save_vou_para", CommandType.StoredProcedure, param);
            return _eff;
        }

        //Tharaka
        public Int32 UpdateProVouTypes(string p_com, string vou_cd, string vou_desc, Int32 vou_act, string p_mod_by, DateTime p_mod_when, Int32 _QtyWise, Int32 _isSMS, string _purSMS, string _redSMS, decimal _minVal, string _cond, Int32 _opt, Int32 _separetPrint)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("vou_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vou_cd;
            (param[2] = new OracleParameter("vou_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vou_desc;
            (param[3] = new OracleParameter("vou_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vou_act;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mod_by;
            (param[5] = new OracleParameter("p_qty_wise", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _QtyWise;
            (param[6] = new OracleParameter("p_sms", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSMS;
            (param[7] = new OracleParameter("p_pur_sms", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _purSMS;
            (param[8] = new OracleParameter("p_red_sms", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _redSMS;
            (param[9] = new OracleParameter("p_min_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _minVal;
            (param[10] = new OracleParameter("p_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cond;
            (param[11] = new OracleParameter("p_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _separetPrint;
            (param[12] = new OracleParameter("p_spt_sp_prnt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _separetPrint; //Tharanga 2017/06/09
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_updateprovou", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka
        public Int32 SavePromoVouType(string p_com, string vou_cd, string vou_desc, Int32 vou_act, string p_Cre_by, Int32 vou_qty_wise, Int32 _SMS, string _purSMS, string _redSMS, decimal _minVal, String _cond, Int32 _opt, Int32 _sp_print, Int32 _dule_auth)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[15];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_vou_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vou_cd;
            (param[2] = new OracleParameter("p_vou_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = vou_desc;
            (param[3] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vou_act;
            (param[4] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_Cre_by;
            (param[5] = new OracleParameter("p_qty_wise", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vou_qty_wise;
            (param[6] = new OracleParameter("p_sms", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SMS;
            (param[7] = new OracleParameter("p_pur_sms", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _purSMS;
            (param[8] = new OracleParameter("p_red_sms", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _redSMS;
            (param[9] = new OracleParameter("p_min_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _minVal;
            (param[10] = new OracleParameter("p_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cond;
            (param[11] = new OracleParameter("p_spt_opt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _opt;
            (param[12] = new OracleParameter("p_spt_sp_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sp_print;//Tharanga 2017/06/09
            (param[13] = new OracleParameter("p_dule_auth", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _dule_auth;//Tharanga 2017/06/09
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_savepromovoutype", CommandType.StoredProcedure, param);

            return effects;
        }

        //Tharaka
        public Int32 SavePromoVouDefinition(string p_Cre_by)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_Cre_by;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_provou_det", CommandType.StoredProcedure, param);

            return effects;
        }

        //Tharaka
        public DataTable GetCompanyItemsByCompany(string _company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_getcompanyitembycom", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written By Tharaka
        public DataTable GetNotification(string _company, string Location, string ProfitCenter, string User)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_rdic_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Location;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getusernotification", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written By Tharaka
        public DataTable Notification_Get_GIT(string _company, string Location)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.sp_GetGoodsIntransitive", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written By Tharaka
        public DataTable Notification_Get_AccountReminders(string _company, string ProfitCenter, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            (param[2] = new OracleParameter("P_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.sp_GetAccountReminders_new", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written By Tharaka
        public List<HPReminder> Notification_Get_AccountRemindersDetails(string _company, string ProfitCenter, DateTime _date)
        {
            List<HPReminder> oHPReminder = new List<HPReminder>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            (param[2] = new OracleParameter("P_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.SP_GetAccountReminderDet_new", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                oHPReminder = DataTableExtensions.ToGenericList<HPReminder>(_result, HPReminder.Converter);
            }

            return oHPReminder;
        }

        //Written By Tharaka
        public DataTable Notification_Get_Sales_Figure(string _company, string ProfitCenter, DateTime FromDate, DateTime Todate)
        {
            DateTime now = DateTime.Now;
            DateTime FromDateTemp = new DateTime(now.Year, now.Month, 1);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            (param[2] = new OracleParameter("P_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDateTemp;
            (param[3] = new OracleParameter("P_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Today;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.SP_GetSalesFigures", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written By Tharaka
        public DataTable Notification_Get_LastDayendProcessedDate(string _company, string ProfitCenter)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.sp_GetLastDayendProcessedDate", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written By Tharaka
        public List<Thoughts> Notification_GetThoughts()
        {
            List<Thoughts> oThoughts = new List<Thoughts>();

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.sp_GetThoughts", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                oThoughts = DataTableExtensions.ToGenericList<Thoughts>(_result, Thoughts.Converter);
            }

            return oThoughts;
        }

        //Written by Tharaka
        public Int32 Notification_UpdateThoughts(Thoughts oThoughts)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_IsRead", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oThoughts.RDT_IS_READ;
            (param[1] = new OracleParameter("P_ModDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = oThoughts.RDT_UPDATE_DT;
            (param[2] = new OracleParameter("P_RDT_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oThoughts.RDT_SEQ;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("pkg_notifications.SP_Update_Thoughts", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By tharaka 
        public List<AccountRestriction> NOtification_Get_AccountSatatus(string _company, string ProfitCenter, DateTime FromDate, DateTime Todate)
        {
            DateTime now = DateTime.Now;
            DateTime FromDateTemp = new DateTime(now.Year, now.Month, 1);

            List<AccountRestriction> result = new List<AccountRestriction>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDateTemp;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Todate;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_notifications.SP_GetSalesStatus", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                result = DataTableExtensions.ToGenericList<AccountRestriction>(_result, AccountRestriction.Converter);
            }

            return result;
        }

        //Written By tharaka
        public DataTable Notification_Get_AccountDetails(string _company, string ProfitCenter, DateTime FromDate, DateTime Todate)
        {
            DateTime now = DateTime.Now;
            DateTime FromDateTemp = new DateTime(now.Year, now.Month, 1);

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDateTemp;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Todate;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = QueryDataTable("tbl", "pkg_notifications.SP_GetSalesStatusCashValue", CommandType.StoredProcedure, false, param);

            return result;
        }

        //Witten By Tharaka 28-07-2014
        public DataTable Notification_Get_LastDayendDates(string _company, string ProfitCenter)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ProfitCenter;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable resultDT = QueryDataTable("tbl", "pkg_notifications.SP_LastDayendDates", CommandType.StoredProcedure, false, param);

            return resultDT;
        }

        public DataTable GetRequestDetails_For_history(string _sart_desc, DateTime FromDate, DateTime ToDate, decimal Level, string status, string Location)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_sart_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sart_desc;
            (param[1] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDate;
            (param[2] = new OracleParameter("p_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[3] = new OracleParameter("p_Level", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Level;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[5] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Location;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_LOAD_FOR_HISTORY", CommandType.StoredProcedure, false, param);


            return _dtResults;

        }

        //darshana 30-07-2014
        public DataTable GetProfitCenterAllocatedPromotors(string _type, string _value)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "sp_getpcpromotors_pc", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //tharaka on 12-08-2014
        public DataTable GetFunctionApplevel_UserAppLevel(string user, string sart_desc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sart_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sart_desc;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "Sp_get_fctn_ap_level", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //Tharaka on 01-09-2014
        public List<ItemConditionCategori> Get_ItemConditionCategories(string Com)
        {
            List<ItemConditionCategori> oThoughts = new List<ItemConditionCategori>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_ITEMCONDITIONCATEGORI", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                oThoughts = DataTableExtensions.ToGenericList<ItemConditionCategori>(_result, ItemConditionCategori.Converter);
            }

            return oThoughts;
        }

        //Tharaka on 01-09-2014
        public List<ItemConditionSetup> Get_ItemConditionBySerial(string Com, string serialNo, string Loc, string itemCode)
        {
            List<ItemConditionSetup> oItemConditionSetups = new List<ItemConditionSetup>();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_SERIAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialNo;
            (param[2] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[3] = new OracleParameter("P_ItemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[4] = new OracleParameter("C_DATE", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_SERIAL_CON_HIS", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                oItemConditionSetups = DataTableExtensions.ToGenericList<ItemConditionSetup>(_result, ItemConditionSetup.Converter);
            }

            return oItemConditionSetups;
        }

        //Tharaka on 02-09-2014
        public int Save_itemConditions(ItemConditionSetup oItemConditionSetup)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_com;
            (param[1] = new OracleParameter("P_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_loc;
            (param[2] = new OracleParameter("P_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_ser_id;
            (param[3] = new OracleParameter("P_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_cat;
            (param[4] = new OracleParameter("P_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_tp;
            (param[5] = new OracleParameter("P_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_rmk;
            (param[6] = new OracleParameter("P_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_cre_by;
            (param[7] = new OracleParameter("P_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_stus;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_itemcondtionsetup", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka on 02-09-2014
        public int Update_itemConditions(ItemConditionSetup oItemConditionSetup)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_com;
            (param[1] = new OracleParameter("P_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_loc;
            (param[2] = new OracleParameter("P_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_ser_id;
            (param[3] = new OracleParameter("P_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_cat;
            (param[4] = new OracleParameter("P_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_tp;
            (param[5] = new OracleParameter("P_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_rmk;
            (param[6] = new OracleParameter("P_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_cre_by;
            (param[7] = new OracleParameter("P_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItemConditionSetup.irsc_stus;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_ITEMCONDITIO_UPDATE", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka on 03-09-2014
        public DataTable Get_ItemCondition_Inquiary(string comnapy, string MainCategori, string SubCategori, string Brand, string ItemCode, string Model, string Condition, string User)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)comnapy ?? DBNull.Value;
            (param[1] = new OracleParameter("P_MainCategori", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)MainCategori ?? DBNull.Value;
            (param[2] = new OracleParameter("P_SubCategori", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)SubCategori ?? DBNull.Value;
            (param[3] = new OracleParameter("P_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)Brand ?? DBNull.Value;
            (param[4] = new OracleParameter("P_ItemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)ItemCode ?? DBNull.Value;
            (param[5] = new OracleParameter("P_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)Model ?? DBNull.Value;
            (param[6] = new OracleParameter("P_Condition", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)Condition ?? DBNull.Value;
            (param[7] = new OracleParameter("P_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (object)User ?? DBNull.Value;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblDetails", "sp_get_itemcondtion_inquirie", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //Tharaka on 03-09-2014
        public Int32 Delete_TEMP_PC_LOC_SCMREPP(string userid, string _com, string _pc, string loc)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_tpl_user_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("p_tpl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_tpl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[3] = new OracleParameter("p_tpl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_DELETE_TEMP_PC_LOC_SCMREPP", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka on 03-09-2014
        public Int32 Save_TEMP_PC_LOC_SCMREPP(string username, string _com, string pc, string loc)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_tpl_user_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = username;
            (param[1] = new OracleParameter("p_tpl_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_tpl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[3] = new OracleParameter("p_tpl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_temp_pc_loc_scmrepp", CommandType.StoredProcedure, param);
            return effects;

        }
        //SHANUKA on 30-09-2014
        public DataTable check_avl_chn(string com, string code)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_AVAILABLE_CHNL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Insert_to_chanelDets(Deposit_Bank_Pc_wise objChanel)
        {
            //shanuka on 30-09-2014
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_MSC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Company;
            (param[1] = new OracleParameter("p_MSC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.BankCode;
            (param[2] = new OracleParameter("p_MSC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Desc;
            (param[3] = new OracleParameter("p_MSC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Create_by;
            (param[4] = new OracleParameter("p_MSC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Modifyby;
            (param[5] = new OracleParameter("p_msc_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.ManagerCode;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_CHANEL_DETS_NEW", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Update_to_chanelDets(Deposit_Bank_Pc_wise obj_chanel)
        {
            //shanuka 30-09-2014
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.Company;
            (param[1] = new OracleParameter("p_msc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.BankCode;
            (param[2] = new OracleParameter("p_msc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.Desc;
            (param[3] = new OracleParameter("p_MSC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.Modifyby;
            (param[4] = new OracleParameter("p_msc_mgr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.ManagerCode;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_CHANEL_DETAILS_NEW", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Insert_to_subchanelDets(Deposit_Bank_Pc_wise objChanel)
        {
            //shanuka on 30-09-2014
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_MSC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Company;
            (param[1] = new OracleParameter("p_MSC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.BankCode;
            (param[2] = new OracleParameter("p_MSC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Desc;
            (param[3] = new OracleParameter("p_MSC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Create_by;
            (param[4] = new OracleParameter("p_MSC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objChanel.Modifyby;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_SUB_CHANNEL_DETAILS", CommandType.StoredProcedure, param);
            return effects;

        }

        public Int32 Update_to_subchanelDets(Deposit_Bank_Pc_wise obj_chanel)
        {
            //shanuka 30-09-2014
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.Company;
            (param[1] = new OracleParameter("p_msc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.BankCode;
            (param[2] = new OracleParameter("p_msc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.Desc;
            (param[3] = new OracleParameter("p_MSC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_chanel.Modifyby;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_SUB_CHAN_DETS", CommandType.StoredProcedure, param);
            return effects;

        }

        //shanuka 30/09/2014
        public DataTable getAllChannel_details(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_CHANEL_DETSREPORT", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //shanuka 30/09/2014
        public DataTable getAllSubChannel_details(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_SUB_CHAN_DETAILS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //shanuka 01/10/2014
        public DataTable getAllarea_details(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_AREA_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //shanuka 01/10/2014
        public DataTable getAllregion_details(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_REGION_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shanuka 01/10/2014
        public DataTable getAllzone_details(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_ZONE_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //Tharaka 2014-10-07
        public Service_Chanal_parameter GetChannelParamers(string com, string Location)
        {
            OracleParameter[] param = new OracleParameter[3];
            Service_Chanal_parameter _hdr = null;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Location;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("sp_getrental", "SP_GET_CHANNE_PARA", CommandType.StoredProcedure, false, param);

            if (tblDet.Rows.Count > 0)
            {
                _hdr = DataTableExtensions.ToGenericList<Service_Chanal_parameter>(tblDet, Service_Chanal_parameter.Converter)[0];
            }
            return _hdr;
        }

        public Int32 Insert_to_serviceChnl_para(ServiceChnlDetails objservice_chnl)
        {
            //shanuka on 09-10-2014
            OracleParameter[] param = new OracleParameter[26];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_SP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Company;
            (param[1] = new OracleParameter("p_SP_SERCHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Channel;
            (param[2] = new OracleParameter("p_SP_EXTERNALCUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.CusCode;
            (param[3] = new OracleParameter("p_SP_DEFINVC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.InvType;
            (param[4] = new OracleParameter("p_SP_DEFPB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Pricebook;

            (param[5] = new OracleParameter("p_SP_DEFPBLVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Pricelevel;
            (param[6] = new OracleParameter("p_SP_DEFCURRENCY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Currancy;
            (param[7] = new OracleParameter("p_SP_RESETJOBMONTHLY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsReset_job;
            (param[8] = new OracleParameter("p_SP_CONSUMABLE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Itemcode;

            (param[9] = new OracleParameter("p_SP_ISNEEDWIP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsWrkpro;
            (param[10] = new OracleParameter("p_SP_ISNEEDGATEPASS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsAllow_gate_pass;
            (param[11] = new OracleParameter("p_SP_WARPBK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Warrnty_pb;
            (param[12] = new OracleParameter("p_SP_WARPBLVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Warrnty_pl;

            (param[13] = new OracleParameter("p_SP_WARRPBITEMTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Item_stus;
            (param[14] = new OracleParameter("p_SP_DB_SERIAL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser1;
            (param[15] = new OracleParameter("p_SP_DB_CHASSIS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser2;
            (param[16] = new OracleParameter("p_SP_DB_VEHI_REG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser3;

            (param[17] = new OracleParameter("p_SP_DB_MSN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser4;
            (param[18] = new OracleParameter("p_SP_ALOC_SUPERVISOR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsAllowSuper;
            (param[19] = new OracleParameter("p_SP_INSPECTION_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.ItemCode_inspection;
            (param[20] = new OracleParameter("p_SP_JOB_SCREEN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.JobScreen;

            (param[21] = new OracleParameter("p_SP_CHECK_OLDPART", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.Chk_recved;
            (param[22] = new OracleParameter("p_SP_DB_SLOT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Slot;
            (param[23] = new OracleParameter("p_sp_crt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Cre_user;
            (param[24] = new OracleParameter("p_sp_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Cre_user;
            param[25] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INSERT_CHNL_PARA", CommandType.StoredProcedure, param);
            return effects;

        }

        //shanuka 09-10-2014
        public DataTable getAllserviceChannels(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_ALL_CHNLPARA_DETAILS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //Chamal 09-10-2014
        public DataTable GetLocTypes(string _type)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = new DataTable();
            _dt = QueryDataTable("tbl1", "sp_get_loc_type", CommandType.StoredProcedure, false, param);
            return _dt;

        }
        #region Item Master
        public List<REF_ITM_CATE1> GetItemCate1()
        {
            List<REF_ITM_CATE1> _ListItems = null;
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEMCATE1", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<REF_ITM_CATE1>(_dtResults, REF_ITM_CATE1.Converter2);
            }
            return _ListItems;
        }


        public List<MasterItemBrand> GetItemBrand()
        {
            List<MasterItemBrand> _ListItems = null;
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_BRAND", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemBrand>(_dtResults, MasterItemBrand.Converter2);
            }
            return _ListItems;
        }


        public List<MasterItemModel> GetItemModel(string _code = null)
        {
            List<MasterItemModel> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_MODEL", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemModel>(_dtResults, MasterItemModel.Converter);
            }
            return _ListItems;
        }

        public List<MasterUOM> GetItemUOM()
        {
            List<MasterUOM> _ListItems = null;
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_UOM", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterUOM>(_dtResults, MasterUOM.Converter);
            }
            return _ListItems;
        }
        public List<MasterColor> GetItemColor()
        {
            List<MasterColor> _ListItems = null;
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_COLOR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterColor>(_dtResults, MasterColor.Converter);
            }
            return _ListItems;
        }

        public List<MasterColor> GetItemColorByCode(string _code)
        {
            List<MasterColor> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_COLOR_BY_CODE", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterColor>(_dtResults, MasterColor.Converter);
            }
            return _ListItems;
        }

        public List<MasterItemSubCate> GetItemCate2(string _cate1)
        {
            List<MasterItemSubCate> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEMCATE2", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemSubCate>(_dtResults, MasterItemSubCate.Converter);
            }
            return _ListItems;
        }
        public List<REF_ITM_CATE3> GetItemCate3(string _cate1, string _cate2)
        {
            List<REF_ITM_CATE3> _ListItems = null;
            OracleParameter[] param = new OracleParameter[3];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
            (param[2] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEMCATE3", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<REF_ITM_CATE3>(_dtResults, REF_ITM_CATE3.Converter);
            }
            return _ListItems;
        }

        public List<REF_ITM_CATE4> GetItemCate4(string _cate1, string _cate2, string _cate3)
        {
            List<REF_ITM_CATE4> _ListItems = null;
            OracleParameter[] param = new OracleParameter[4];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
            (param[2] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2;
            (param[3] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3;
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEMCATE4", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<REF_ITM_CATE4>(_dtResults, REF_ITM_CATE4.Converter);
            }
            return _ListItems;
        }

        public List<REF_ITM_CATE5> GetItemCate5(string _cate1, string _cate2, string _cate3, string _cate4)
        {
            List<REF_ITM_CATE5> _ListItems = null;
            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
            (param[2] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2;
            (param[3] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3;
            (param[4] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4;
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEMCATE5", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<REF_ITM_CATE5>(_dtResults, REF_ITM_CATE5.Converter);
            }
            return _ListItems;
        }
        public Int32 DeleteItemBrand(List<MasterItemBrand> _lstbrand)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            foreach (MasterItemBrand _cate1 in _lstbrand)
            {

                (param[0] = new OracleParameter("p_MB_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_cd;
                (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_mod_by;
                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_BRAND", CommandType.StoredProcedure, param);
            }
            return effects;

        }

        public Int32 SaveItemBrand(List<MasterItemBrand> _lstbrand)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            Int32 effectsITMupdate = 0;
            foreach (MasterItemBrand _cate1 in _lstbrand)
            {
                (param[0] = new OracleParameter("p_MB_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_cd;
                (param[1] = new OracleParameter("p_MB_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_desc;
                (param[2] = new OracleParameter("p_MB_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_cate1.Mb_act);
                (param[3] = new OracleParameter("p_MB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_cre_by;
                (param[4] = new OracleParameter("p_MB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_mod_by;
                (param[5] = new OracleParameter("p_MB_CONTRIBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Mb_contribu;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
              
                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_BRAND", CommandType.StoredProcedure, param);
                    if (_cate1.Mb_isupdate == true)
                    {
                        effectsITMupdate = UpdateItemBrndContribution(_cate1.Mb_contribu.Trim(), _cate1.Mb_cd.Trim());
                    }
                   
            }
            return effects;

        }
        public Int32 DeleteItemModel(List<MasterItemModel> _lstmodel)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            foreach (MasterItemModel _model in _lstmodel)
            {

                (param[0] = new OracleParameter("p_MM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cd;
                (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_mod_by;
                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_MODEL", CommandType.StoredProcedure, param);
            }
            return effects;

        }


        public Int32 SaveItemModel(List<MasterItemModel> _lstmodel, List<mst_model_replace> _lstRplModel, List<mst_commodel> _lstComModel, List<BusinessEntityVal> _lstBusEntity, List<UnitConvert> _uomlist)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[15];
            OracleParameter[] param1 = new OracleParameter[8];
            OracleParameter[] param2 = new OracleParameter[7];
            OracleParameter[] param3 = new OracleParameter[6];
            OracleParameter[] param4 = new OracleParameter[9];
            Int32 effects = 0;

            foreach (MasterItemModel _model in _lstmodel)
            {

                (param[0] = new OracleParameter("p_MM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cd;
                (param[1] = new OracleParameter("p_MM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_desc;
                (param[2] = new OracleParameter("p_MM_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mm_act);
                (param[3] = new OracleParameter("p_MM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cre_by;
                (param[4] = new OracleParameter("p_MM_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_mod_by;
                (param[5] = new OracleParameter("p_mm_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat1;
                (param[6] = new OracleParameter("p_mm_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat2;
                (param[7] = new OracleParameter("p_mm_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat3;
                (param[8] = new OracleParameter("p_mm_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat4;
                (param[9] = new OracleParameter("p_mm_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat5;

                (param[10] = new OracleParameter("p_MM_IS_DIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mm_is_dis);
                (param[11] = new OracleParameter("p_MM_DIS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mm_dis_dt;
                (param[12] = new OracleParameter("p_Mm_taxstruc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_taxstruc_cd;
                (param[13] = new OracleParameter("p_Mm_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_uom;

                param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_item_model", CommandType.StoredProcedure, param);
            }


            //Lakshika 2016-07-15
            if (_lstRplModel != null)
            {
                foreach (mst_model_replace _model in _lstRplModel)
                {
                    (param1[0] = new OracleParameter("p_Mrpl_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_model;
                    (param1[1] = new OracleParameter("p_Mrpl_replacedmodel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_replacedmodel;
                    (param1[2] = new OracleParameter("p_Mrpl_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mrpl_active);
                    (param1[3] = new OracleParameter("p_Mrpl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_cre_by;
                    (param1[4] = new OracleParameter("p_Mrpl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_mod_by;
                    (param1[5] = new OracleParameter("p_Mrpl_repl_reson", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_repl_reson;
                    (param1[6] = new OracleParameter("p_Mrpl_effect_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mrpl_effect_dt;

                    param1[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MODEL_REPLACE", CommandType.StoredProcedure, param1);
                }
            }
            //Lakshika 2016-07-18 (Save Models to company)
            if (_lstComModel != null)
            {
                foreach (mst_commodel _commodel in _lstComModel)
                {
                    (param2[0] = new OracleParameter("p_MCM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commodel.Mcm_com;
                    (param2[1] = new OracleParameter("p_MCM_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commodel.Mcm_model;
                    (param2[2] = new OracleParameter("p_MCM_ISFOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_commodel.Mcm_isfoc);
                    (param2[3] = new OracleParameter("p_MCM_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_commodel.Mcm_act);
                    (param2[4] = new OracleParameter("p_MCM_HPQTY_CHK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_commodel.Mcm_hpqty_chk);
                    (param2[5] = new OracleParameter("p_MCM_RESTRIC_INV_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commodel.Mcm_restric_inv_tp;

                    param2[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MODEL_COMPANY", CommandType.StoredProcedure, param2);
                }
            }

            //Lakshika 2016-07-22 (Save Models Classifications to mst_model_clss table)
            if (_lstBusEntity != null)
            {
                foreach (BusinessEntityVal _busEntity in _lstBusEntity)
                {
                    (param3[0] = new OracleParameter("p_mmcl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.rbv_com;
                    (param3[1] = new OracleParameter("p_mmcl_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.model;
                    (param3[2] = new OracleParameter("p_mmcl_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.rbv_tp;
                    (param3[3] = new OracleParameter("p_mmcl_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.rbv_val;
                    (param3[4] = new OracleParameter("p_mbei_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_busEntity.active);

                    param3[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_MODEL_CLASSIFICATIONS", CommandType.StoredProcedure, param3);
                }
            }
            //subodana 2016-11-29

            if (_uomlist != null)
            {
                //SAVE UNIT CONVERT
                foreach (var uom in _uomlist)
                {
                    (param4[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_com;
                    (param4[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_model;
                    (param4[2] = new OracleParameter("p_model_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_model_uom;
                    (param4[3] = new OracleParameter("p_con_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_con_uom;
                    (param4[4] = new OracleParameter("p_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(uom.mmu_qty);
                    (param4[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = uom.mmu_act;
                    (param4[6] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_cre_by;
                    (param4[7] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = uom.mmu_cre_dt;
                    param4[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MODEL_UOM", CommandType.StoredProcedure, param4);
                }

            }

            return effects;
        }
        public Int32 SaveItemModelWeb(List<MasterItemModel> _lstmodel, List<mst_model_replace> _lstRplModel, List<mst_commodel> _lstComModel, List<BusinessEntityVal> _lstBusEntity, List<UnitConvert> _uomlist)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[20];
            OracleParameter[] param1 = new OracleParameter[8];
            OracleParameter[] param2 = new OracleParameter[7];
            OracleParameter[] param3 = new OracleParameter[6];
            OracleParameter[] param4 = new OracleParameter[9];
            Int32 effects = 0;

            foreach (MasterItemModel _model in _lstmodel)
            {

                (param[0] = new OracleParameter("p_MM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cd;
                (param[1] = new OracleParameter("p_MM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_desc;
                (param[2] = new OracleParameter("p_MM_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mm_act);
                (param[3] = new OracleParameter("p_MM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cre_by;
                (param[4] = new OracleParameter("p_MM_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_mod_by;
                (param[5] = new OracleParameter("p_mm_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat1;
                (param[6] = new OracleParameter("p_mm_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat2;
                (param[7] = new OracleParameter("p_mm_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat3;
                (param[8] = new OracleParameter("p_mm_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat4;
                (param[9] = new OracleParameter("p_mm_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat5;

                (param[10] = new OracleParameter("p_MM_IS_DIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mm_is_dis);
                (param[11] = new OracleParameter("p_MM_DIS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mm_dis_dt;
                (param[12] = new OracleParameter("p_Mm_taxstruc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_taxstruc_cd;
                (param[13] = new OracleParameter("p_Mm_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_uom;
                (param[14] = new OracleParameter("p_mm_intro_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mm_intro_dt;
                (param[15] = new OracleParameter("p_mm_lifes", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _model.Mm_lifes;
                (param[16] = new OracleParameter("p_mm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_brand;
                (param[17] = new OracleParameter("p_mm_cntry_of_orgn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cntry_of_orgn;
                (param[18] = new OracleParameter("p_mm_hs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_hs_cd;

                param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_item_model_new", CommandType.StoredProcedure, param);
            }


            //Lakshika 2016-07-15
            if (_lstRplModel != null)
            {
                foreach (mst_model_replace _model in _lstRplModel)
                {
                    (param1[0] = new OracleParameter("p_Mrpl_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_model;
                    (param1[1] = new OracleParameter("p_Mrpl_replacedmodel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_replacedmodel;
                    (param1[2] = new OracleParameter("p_Mrpl_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mrpl_active);
                    (param1[3] = new OracleParameter("p_Mrpl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_cre_by;
                    (param1[4] = new OracleParameter("p_Mrpl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_mod_by;
                    (param1[5] = new OracleParameter("p_Mrpl_repl_reson", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mrpl_repl_reson;
                    (param1[6] = new OracleParameter("p_Mrpl_effect_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mrpl_effect_dt;

                    param1[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MODEL_REPLACE", CommandType.StoredProcedure, param1);
                }
            }
            //Lakshika 2016-07-18 (Save Models to company)
            if (_lstComModel != null)
            {
                foreach (mst_commodel _commodel in _lstComModel)
                {
                    (param2[0] = new OracleParameter("p_MCM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commodel.Mcm_com;
                    (param2[1] = new OracleParameter("p_MCM_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commodel.Mcm_model;
                    (param2[2] = new OracleParameter("p_MCM_ISFOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_commodel.Mcm_isfoc);
                    (param2[3] = new OracleParameter("p_MCM_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_commodel.Mcm_act);
                    (param2[4] = new OracleParameter("p_MCM_HPQTY_CHK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_commodel.Mcm_hpqty_chk);
                    (param2[5] = new OracleParameter("p_MCM_RESTRIC_INV_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commodel.Mcm_restric_inv_tp;

                    param2[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MODEL_COMPANY", CommandType.StoredProcedure, param2);
                }
            }

            //Lakshika 2016-07-22 (Save Models Classifications to mst_model_clss table)
            if (_lstBusEntity != null)
            {
                foreach (BusinessEntityVal _busEntity in _lstBusEntity)
                {
                    (param3[0] = new OracleParameter("p_mmcl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.rbv_com;
                    (param3[1] = new OracleParameter("p_mmcl_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.model;
                    (param3[2] = new OracleParameter("p_mmcl_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.rbv_tp;
                    (param3[3] = new OracleParameter("p_mmcl_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busEntity.rbv_val;
                    (param3[4] = new OracleParameter("p_mbei_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_busEntity.active);

                    param3[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_MODEL_CLASSIFICATIONS", CommandType.StoredProcedure, param3);
                }
            }
            //subodana 2016-11-29

            if (_uomlist != null)
            {
                //SAVE UNIT CONVERT
                foreach (var uom in _uomlist)
                {
                    (param4[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_com;
                    (param4[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_model;
                    (param4[2] = new OracleParameter("p_model_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_model_uom;
                    (param4[3] = new OracleParameter("p_con_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_con_uom;
                    (param4[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Convert.ToDecimal(uom.mmu_qty);
                    (param4[5] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = uom.mmu_act;
                    (param4[6] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uom.mmu_cre_by;
                    (param4[7] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = uom.mmu_cre_dt;
                    param4[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MODEL_UOM", CommandType.StoredProcedure, param4);
                }

            }

            return effects;
        }

        public Int32 DeleteItemUOM(List<MasterUOM> _lstUOM)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            foreach (MasterUOM _uom in _lstUOM)
            {

                (param[0] = new OracleParameter("p_MSU_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uom.Msu_cd;
                (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uom.Msu_mod_by;
                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_UOM", CommandType.StoredProcedure, param);
            }
            return effects;

        }
        public Int32 SaveItemUOM(List<MasterUOM> _lstUOM)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            foreach (MasterUOM _uom in _lstUOM)
            {
                (param[0] = new OracleParameter("p_MSU_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uom.Msu_cd;
                (param[1] = new OracleParameter("p_MSU_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uom.Msu_desc;
                (param[2] = new OracleParameter("p_MSU_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_uom.Msu_act);
                (param[3] = new OracleParameter("p_MSU_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uom.Msu_cre_by;
                (param[4] = new OracleParameter("p_MSU_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uom.Msu_mod_by;
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_UOM", CommandType.StoredProcedure, param);
            }
            return effects;

        }

        public Int32 DeleteItemcolor(List<MasterColor> _lstColor)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            foreach (MasterColor _color in _lstColor)
            {

                (param[0] = new OracleParameter("p_CLR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color.Clr_cd;
                (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color.Clr_mod_by;
                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_COLOR", CommandType.StoredProcedure, param);
            }
            return effects;

        }
        public Int32 SaveItemColor(List<MasterColor> _lstColor)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            foreach (MasterColor _color in _lstColor)
            {
                (param[0] = new OracleParameter("p_CLR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color.Clr_cd;
                (param[1] = new OracleParameter("p_CLR_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color.Clr_desc;

                (param[2] = new OracleParameter("p_CLR_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Convert.ToString(_color.Clr_stus == true ? "E" : "D");
                (param[3] = new OracleParameter("p_CLR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color.Clr_cre_by;
                (param[4] = new OracleParameter("p_CLR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color.Clr_mod_by;
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_COLOR", CommandType.StoredProcedure, param);
            }
            return effects;

        }


        //Nadeeka 2015-08-28
        public Int32 GetCutomerValidationCode()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getCustomerValidationCode", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdateCutomerMobile(string _mobile, string _type)
        {// Nadeeka 
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getUpdateCustomerMobile", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveItemMaster(MasterItem _item)
        {
            //Nadeeka 25-05-2015
            //modify rukshan 14/Dec/2015
            OracleParameter[] param = new OracleParameter[96];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_MI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cd;
            (param[1] = new OracleParameter("P_MI_SHORTDESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_shortdesc;
            (param[2] = new OracleParameter("P_MI_LONGDESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_longdesc;
            (param[3] = new OracleParameter("P_MI_CATE_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_1;
            (param[4] = new OracleParameter("P_MI_CATE_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_2;
            (param[5] = new OracleParameter("P_MI_CATE_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_3;
            (param[6] = new OracleParameter("P_MI_CATE_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_4;
            (param[7] = new OracleParameter("P_MI_CATE_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_5;
            (param[8] = new OracleParameter("P_MI_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_brand;
            (param[9] = new OracleParameter("P_MI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_model;
            (param[10] = new OracleParameter("P_MI_PART_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_part_no;
            (param[11] = new OracleParameter("P_MI_COLOR_INT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_color_int;
            (param[12] = new OracleParameter("P_MI_IS_REQCOLORINT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_reqcolorint);
            (param[13] = new OracleParameter("P_MI_COLOR_EXT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_color_ext;
            (param[14] = new OracleParameter("P_MI_IS_REQCOLOREXT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_reqcolorext);
            (param[15] = new OracleParameter("P_MI_ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_itm_tp;
            (param[16] = new OracleParameter("P_MI_IS_STOCKMAINTAIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_is_stockmaintain;
            (param[17] = new OracleParameter("P_MI_HS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_hs_cd;
            (param[18] = new OracleParameter("P_MI_ITM_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_itm_uom;
            (param[19] = new OracleParameter("P_MI_DIM_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_dim_uom;
            (param[20] = new OracleParameter("P_MI_DIM_LENGTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_dim_length;
            (param[21] = new OracleParameter("P_MI_DIM_WIDTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_dim_width;
            (param[22] = new OracleParameter("P_MI_DIM_HEIGHT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_dim_height;
            (param[23] = new OracleParameter("P_MI_WEIGHT_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_weight_uom;
            (param[24] = new OracleParameter("P_MI_GROSS_WEIGHT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_gross_weight;
            (param[25] = new OracleParameter("P_MI_NET_WEIGHT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_net_weight;
            (param[26] = new OracleParameter("P_MI_IMAGE_PATH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_image_path;
            (param[27] = new OracleParameter("P_MI_IS_SER1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_ser1;
            (param[28] = new OracleParameter("P_MI_IS_SER2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_ser2);
            (param[29] = new OracleParameter("P_MI_IS_SER3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_ser3);
            (param[30] = new OracleParameter("P_MI_WARR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_warr);
            (param[31] = new OracleParameter("P_MI_WARR_PRINT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_warr_print);
            (param[32] = new OracleParameter("P_MI_HP_ALLOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_hp_allow);
            (param[33] = new OracleParameter("P_MI_INSU_ALLOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_insu_allow);
            (param[34] = new OracleParameter("P_MI_COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_country_cd;
            (param[35] = new OracleParameter("P_MI_PURCOM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_purcom_cd;
            (param[36] = new OracleParameter("P_MI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_itm_stus;
            (param[37] = new OracleParameter("P_MI_FGITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_fgitm_cd;
            (param[38] = new OracleParameter("P_MI_ITMTOT_COST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_itmtot_cost;
            (param[39] = new OracleParameter("P_MI_CHG_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_chg_tp;
            (param[40] = new OracleParameter("P_MI_IS_SCANSUB", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_scansub);
            (param[41] = new OracleParameter("P_MI_IS_BARCODETRIM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_barcodetrim);
            (param[42] = new OracleParameter("P_MI_LTRIM_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_ltrim_val;
            (param[43] = new OracleParameter("P_MI_RTRIM_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_rtrim_val;
            (param[44] = new OracleParameter("P_MI_IS_EDITSHORTDESC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editshortdesc);
            (param[45] = new OracleParameter("P_MI_IS_EDITLONGDESC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editlongdesc);
            (param[46] = new OracleParameter("P_MI_SER_PREFIX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_ser_prefix;
            (param[47] = new OracleParameter("P_MI_REFITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_refitm_cd;
            (param[48] = new OracleParameter("P_MI_UOM_WARRPERIODMAIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_uom_warrperiodmain;
            (param[49] = new OracleParameter("P_MI_UOM_WARRPERIODSUB1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_uom_warrperiodsub1;
            (param[50] = new OracleParameter("P_MI_UOM_WARRPERIODSUB2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_uom_warrperiodsub2;
            (param[51] = new OracleParameter("P_MI_IS_EDITSER1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editser1);
            (param[52] = new OracleParameter("P_MI_IS_EDITSER2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editser2);
            (param[53] = new OracleParameter("P_MI_IS_EDITSER3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_editser3);
            (param[54] = new OracleParameter("P_MI_STD_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_std_cost;
            (param[55] = new OracleParameter("P_MI_STD_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_std_price;
            (param[56] = new OracleParameter("P_MI_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_act);
            (param[57] = new OracleParameter("P_MI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cre_by;
            (param[58] = new OracleParameter("P_MI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_cre_dt;
            (param[59] = new OracleParameter("P_MI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_mod_by;
            (param[60] = new OracleParameter("P_MI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_mod_dt;
            (param[61] = new OracleParameter("P_MI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_session_id;
            (param[62] = new OracleParameter("P_MI_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_anal1;
            (param[63] = new OracleParameter("P_MI_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_anal2;
            (param[64] = new OracleParameter("P_MI_ANAL3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_anal3);
            (param[65] = new OracleParameter("P_MI_ANAL4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_anal4);
            (param[66] = new OracleParameter("P_MI_ANAL5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_mod_dt;// _item.Mi_anal5;
            (param[67] = new OracleParameter("P_MI_ANAL6", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Mi_mod_dt; //_item.Mi_anal6;
            (param[68] = new OracleParameter("P_MI_IS_SUBITM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_subitem);
            (param[69] = new OracleParameter("P_MI_NEED_REG", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_need_reg);
            (param[70] = new OracleParameter("P_MI_NEED_INSU", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_need_insu);
            (param[71] = new OracleParameter("P_MI_NEED_FREESEV", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_need_freesev;
            (param[72] = new OracleParameter("P_MI_COMM_ISRATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_comm_israte;
            (param[73] = new OracleParameter("P_MI_COMM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_comm_val;
            (param[74] = new OracleParameter("P_MI_FAC_BASE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_fac_base);
            (param[75] = new OracleParameter("P_MI_FAC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_fac_val;
            (param[76] = new OracleParameter("P_MI_IS_COND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_cond;
            (param[77] = new OracleParameter("P_MI_PACKING_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_packing_cd;
            (param[78] = new OracleParameter("P_MI_PART_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_part_cd;
            (param[79] = new OracleParameter("P_MI_IS_DISCONT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_discont;
            (param[80] = new OracleParameter("P_MI_IS_SUP_WARA", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_is_sup_wara;
            (param[81] = new OracleParameter("P_MI_CHK_CUST", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.MI_CHK_CUST;
            (param[82] = new OracleParameter("P_MI_IS_EXP_DT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.MI_IS_EXP_DT;
            (param[83] = new OracleParameter("P_MI_CAPACITY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Mi_capacity;
            (param[84] = new OracleParameter("P_MI_SIZE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_size;
            (param[85] = new OracleParameter("P_MI_ADD_ITM_DES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_add_itm_des);
            (param[86] = new OracleParameter("P_MI_EDIT_ALT_SER", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_edit_alt_ser);
            (param[87] = new OracleParameter("P_MI_SER_RQ_CUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_ser_rq_cus);
            (param[88] = new OracleParameter("P_MI_MAIN_SUPP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_main_supp);
            (param[89] = new OracleParameter("P_MI_APP_ITM_COND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_app_itm_cond);
            (param[90] = new OracleParameter("P_MI_IS_PGS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_pgs);
            (param[91] = new OracleParameter("P_MI_IS_MULT_PREFIX", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.Mi_is_mult_prefix);
            (param[92] = new OracleParameter("P_MI_PGS_COUNT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Mi_pgd_count;
            (param[93] = new OracleParameter("P_MI_COUNTER_FOIL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_item.MI_COUNTER_FOIL);
            (param[94] = new OracleParameter("P_MI_RESI_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Convert.ToDecimal(_item.MI_RESIDUAL_VAL);
            param[95] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MASTER", CommandType.StoredProcedure, param);

            return effects;

        }
        public Int32 SaveFinishGood_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_FG_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveFinishGood(List<mst_itm_fg_cost> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;

            foreach (mst_itm_fg_cost _itm in _lst)
            {
                (param[0] = new OracleParameter("p_IFC_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ifc_item_code;
                (param[1] = new OracleParameter("p_IFC_FG_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ifc_fg_item_code;
                (param[2] = new OracleParameter("p_IFC_COST_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ifc_item_code;
                (param[3] = new OracleParameter("p_IFC_COST_AMOUNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Ifc_cost_amount;
                (param[4] = new OracleParameter("p_IFC_CURRENCY_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ifc_currency_code;
                (param[5] = new OracleParameter("p_IFC_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ifc_create_by;
                (param[6] = new OracleParameter("p_IFC_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ifc_last_modify_by;
                (param[7] = new OracleParameter("p_ifc_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Ifc_stus;
                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_FG", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<mst_itm_fg_cost> GetFinishGood(string _item)
        {
            List<mst_itm_fg_cost> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_fg", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_fg_cost>(_dtResults, mst_itm_fg_cost.Converter);
            }
            return _ListItems;
        }
        public Int32 SaveReOrder_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_REORDER_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveReOrder(List<mst_itm_com_reorder> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;

            foreach (mst_itm_com_reorder _itm in _lst)
            {
                (param[0] = new OracleParameter("p_ICR_COM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_com_code;
                (param[1] = new OracleParameter("p_ICR_ITM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_itm_code;
                (param[2] = new OracleParameter("p_ICR_ITM_STS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_itm_sts;
                (param[3] = new OracleParameter("p_ICR_QIH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_qih;
                (param[4] = new OracleParameter("p_ICR_FQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_fqty;
                (param[5] = new OracleParameter("p_ICR_REQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_reqty;
                (param[6] = new OracleParameter("p_ICR_ISS_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_iss_qty;
                (param[7] = new OracleParameter("p_ICR_RE_ORDER_LVL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_re_order_lvl;
                (param[8] = new OracleParameter("p_ICR_RE_ORDER_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_re_order_qty;
                (param[9] = new OracleParameter("p_ICR_CREATED_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_created_by;
                (param[10] = new OracleParameter("p_ICR_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_last_modify_by;
                (param[11] = new OracleParameter("p_ICR_AVG_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Icr_avg_cost;
                (param[12] = new OracleParameter("p_ICR_CLASS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_class;
                (param[13] = new OracleParameter("p_ICR_SAFETY_QTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Icr_safety_qty;//add Rukshan 05/jan/2016
                param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_REORDER", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<mst_itm_com_reorder> GetReOrder(string _item)
        {
            List<mst_itm_com_reorder> _ListItems = new List<mst_itm_com_reorder>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_reorder", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_com_reorder>(_dtResults, mst_itm_com_reorder.Converter);
            }
            return _ListItems;
        }

        public Int32 SaveComItem_log(string _item)
        {
            //Nadeeka 25-05-2015

            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_COM_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveComItem(List<MasterCompanyItem> _lst)
        {
            //Nadeeka 25-05-2015
            //Modify by rukshan 08/jan/2016
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            foreach (MasterCompanyItem _itm in _lst)
            {
                (param[0] = new OracleParameter("P_MCI_ITM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mci_itm_cd;
                (param[1] = new OracleParameter("P_MCI_ITM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mci_com;
                (param[2] = new OracleParameter("P_MCI_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mci_act;
                (param[3] = new OracleParameter("P_MCI_FOC_ALLOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mci_isfoc;
                (param[4] = new OracleParameter("P_MCI_AGE_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mci_age_type;
                (param[5] = new OracleParameter("P_MCI_RESTRIC_INV_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_restric_inv_tp;//rukshan 08/jan/2016
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_COM", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<MasterCompanyItem> GetComItem(string _item)
        {
            List<MasterCompanyItem> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_company", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterCompanyItem>(_dtResults, MasterCompanyItem.Converter);
            }
            return _ListItems;
        }
        public Int32 SaveBusinessEntityItem_log(string _item, string _type)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CUST_log", CommandType.StoredProcedure, param);

            return effects;
        }

        public Int32 SaveBusniessEntityItem(List<BusEntityItem> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0;

            foreach (BusEntityItem _itm in _lst)
            {
                (param[0] = new OracleParameter("P_MBII_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_COM;
                (param[1] = new OracleParameter("P_MBII_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_CD;
                (param[2] = new OracleParameter("P_MBII_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_TP;

                (param[3] = new OracleParameter("P_MBII_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_ITM_CD;
                (param[4] = new OracleParameter("P_MBII_ACT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_ACT;
                (param[5] = new OracleParameter("P_MBII_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_CRE_BY;
                (param[6] = new OracleParameter("P_MBII_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_MOD_BY;
                (param[7] = new OracleParameter("P_MBII_WARR_PERI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_WARR_PERI;
                (param[8] = new OracleParameter("P_MBII_WARR_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MBII_WARR_RMK;
                (param[9] = new OracleParameter("P_MBII_MOD_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.MBII_MOD_DT;
                (param[10] = new OracleParameter("P_MBII_CRE_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.MBII_CRE_DT;
                //if (_itm.MBII_MOD_DT = DateTime.Parse("01/Jan/0001 12:00:00 AM"))
                //{
                //    (param[9] = new OracleParameter("P_MBII_MOD_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                //}
                //else
                //{
                //    (param[9] = new OracleParameter("P_MBII_MOD_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.MBII_MOD_DT;
                //}
                //if (_itm.MBII_CRE_DT = "01/Jan/0001 12:00:00 AM")
                //{
                //    (param[10] = new OracleParameter("P_MBII_CRE_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                //}
                //else
                //{
                //    (param[10] = new OracleParameter("P_MBII_CRE_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.MBII_CRE_DT;
                //}
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CUST", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<BusEntityItem> GetBuninessEntityItem(string _item, string _type)
        {
            List<BusEntityItem> _ListItems = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_customer", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<BusEntityItem>(_dtResults, BusEntityItem.Converter);
            }
            return _ListItems;
        }
        //public Int32 SaveSupplierItem_log(string _item)
        //{
        //    //Nadeeka 25-05-2015
        //    OracleParameter[] param = new OracleParameter[2];
        //    Int32 effects = 0;


        //    (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

        //    param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

        //    effects = (Int16)UpdateRecords("SP_SAVE_ITEM_SUPP_log", CommandType.StoredProcedure, param);

        //    return effects;
        //}
        //public Int32 SaveSupplierItem(List<mst_sup_itm> _lst)
        //{
        //    //Nadeeka 25-05-2015
        //    OracleParameter[] param = new OracleParameter[10];
        //    Int32 effects = 0;

        //    foreach (mst_sup_itm _itm in _lst)
        //    {
        //        (param[0] = new OracleParameter("P_MSI_SUPP_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_supp_code;
        //        (param[1] = new OracleParameter("P_MSI_ITM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_itm_code;
        //        (param[2] = new OracleParameter("P_MSI_PRICE_QUOTED", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Msi_price_quoted;
        //        (param[3] = new OracleParameter("P_MSI_CURR_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_curr_code;
        //        (param[4] = new OracleParameter("P_MSI_ACTIVE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Msi_active;
        //        (param[5] = new OracleParameter("P_MSI_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_create_by;
        //        (param[6] = new OracleParameter("P_MSI_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_last_modify_by;
        //        (param[7] = new OracleParameter("P_MSI_SUP_ITM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_sup_itm_code;
        //        (param[8] = new OracleParameter("P_MSI_IS_SPE_TAX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_is_spe_tax;
        //        param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

        //        effects = (Int16)UpdateRecords("SP_SAVE_ITEM_SUPP", CommandType.StoredProcedure, param);
        //    }
        //    return effects;
        //}

        //public List<mst_sup_itm> GetSupplierItem(string _item)
        //{
        //    List<mst_sup_itm> _ListItems = null;
        //    OracleParameter[] param = new OracleParameter[2];
        //    (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
        //    param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

        //    DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_supplier", CommandType.StoredProcedure, false, param);
        //    if (_dtResults.Rows.Count > 0)
        //    {
        //        _ListItems = DataTableExtensions.ToGenericList<mst_sup_itm>(_dtResults, mst_sup_itm.Converter);
        //    }
        //    return _ListItems;
        //}

        public Int32 SaveRedeem_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_REDEEM_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveRedeem(List<mst_itm_redeem_com> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            foreach (mst_itm_redeem_com _itm in _lst)
            {
                (param[0] = new OracleParameter("P_RED_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Red_item_code;
                (param[1] = new OracleParameter("P_RED_COM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Red_com_code;
                (param[2] = new OracleParameter("P_RED_ACTIVE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Red_active;
                (param[3] = new OracleParameter("P_RED_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Red_create_by;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_REDEEM", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<mst_itm_redeem_com> GetRedeem(string _item)
        {
            List<mst_itm_redeem_com> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_redeem", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_redeem_com>(_dtResults, mst_itm_redeem_com.Converter);
            }
            return _ListItems;
        }
        public Int32 SaveMRNItem_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MRN_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveMRNItem(List<mst_itm_mrn_com> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            foreach (mst_itm_mrn_com _itm in _lst)
            {
                (param[0] = new OracleParameter("P_IMC_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Imc_itemcode;
                (param[1] = new OracleParameter("P_IMC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Imc_com;
                (param[2] = new OracleParameter("P_IMC_ACTIVE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Imc_active;
                (param[3] = new OracleParameter("P_IMC_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Imc_create_by;
                (param[4] = new OracleParameter("P_IMC_MODIFIED_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Imc_modified_by;
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_MRN", CommandType.StoredProcedure, param);
            }
            return effects;
        }


        public List<mst_itm_mrn_com> getItemMRN(string _item)
        {
            List<mst_itm_mrn_com> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_mrn", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_mrn_com>(_dtResults, mst_itm_mrn_com.Converter);
            }
            return _ListItems;
        }
        public Int32 SaveReplaceItem_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_REPLACE_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveReplaceItem(List<mst_itm_replace> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            foreach (mst_itm_replace _itm in _lst)
            {
                (param[0] = new OracleParameter("P_RPL_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Rpl_item;
                (param[1] = new OracleParameter("P_RPL_REPLACEDITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Rpl_replaceditem;
                (param[2] = new OracleParameter("P_RPL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Rpl_cre_by;
                (param[3] = new OracleParameter("P_RPL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Rpl_mod_by;
                (param[4] = new OracleParameter("P_Rpl_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Rpl_active;
                (param[5] = new OracleParameter("P_RPL_REPL_RESON", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Rpl_repl_reson;//add rukshan 08/jan/2016
                (param[6] = new OracleParameter("P_RPL_EFFECT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Rpl_effect_dt;//add rukshan 08/jan/2016
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_REPLACE", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<mst_itm_replace> getReplaceItem(string _item)
        {
            List<mst_itm_replace> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_replaced", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_replace>(_dtResults, mst_itm_replace.Converter);
            }
            return _ListItems;
        }

        public Int32 SaveComponentItem_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_itm_component_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveComponentItem(List<MasterItemComponent> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            foreach (MasterItemComponent _itm in _lst)
            {
                (param[0] = new OracleParameter("p_MICP_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Micp_itm_cd;
                (param[1] = new OracleParameter("p_MICP_COMP_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Micp_comp_itm_cd;
                (param[2] = new OracleParameter("p_MICP_ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Micp_itm_tp;
                (param[3] = new OracleParameter("p_MICP_ISPRICE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Micp_isprice;
                (param[4] = new OracleParameter("p_MICP_COST_PERCENTAGE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Micp_cost_percentage;
                (param[5] = new OracleParameter("p_MICP_MUST_SCAN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Micp_must_scan;
                (param[6] = new OracleParameter("p_MICP_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Micp_qty;
                (param[7] = new OracleParameter("p_MICP_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Micp_act;
                (param[8] = new OracleParameter("p_MICP_CATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Micp_cate;
                (param[9] = new OracleParameter("p_micp_is_percentage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.MICP_IS_PERCENTAGE;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("sp_save_itm_component", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public Int32 SaveContainerItem_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CONTAINER_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveContainerItem(List<mst_itm_container> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            foreach (mst_itm_container _itm in _lst)
            {
                (param[0] = new OracleParameter("p_IC_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_item_code;
                (param[1] = new OracleParameter("p_IC_CONTAINER_TYPE_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_container_type_code;
                (param[2] = new OracleParameter("p_IC_NO_OF_UNIT_PER_ONE_ITEM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Ic_no_of_unit_per_one_item;
                (param[3] = new OracleParameter("p_IC_DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_description;
                (param[4] = new OracleParameter("p_IC_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_create_by;
                (param[5] = new OracleParameter("p_IC_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_last_modify_by;

                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CONTAINER", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        public Int32 SaveContainerItemNEW(List<mst_itm_container> _lst)
        {
            //Nadeeka 25-05-2015
            //add act by lakshan 17 Jan 2017
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            foreach (mst_itm_container _itm in _lst)
            {
                (param[0] = new OracleParameter("p_IC_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_item_code;
                (param[1] = new OracleParameter("p_IC_CONTAINER_TYPE_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_container_type_code;
                (param[2] = new OracleParameter("p_IC_NO_OF_UNIT_PER_ONE_ITEM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Ic_no_of_unit_per_one_item;
                (param[3] = new OracleParameter("p_IC_DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_description;
                (param[4] = new OracleParameter("p_IC_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_create_by;
                (param[5] = new OracleParameter("p_IC_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ic_last_modify_by;
                (param[6] = new OracleParameter("p_Ic_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Ic_act;

                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CONTAINER_NEW", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        public List<mst_itm_container> getRContainerItem(string _item)
        {
            List<mst_itm_container> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_container", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_container>(_dtResults, mst_itm_container.Converter2);
            }
            return _ListItems;
        }
        public Int32 SaveTaxClaimItem_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_TAX_CLAIM_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveTaxClaimItem(List<MasterItemTaxClaim> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            foreach (MasterItemTaxClaim _itm in _lst)
            {
                (param[0] = new OracleParameter("p_MIC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mic_com;
                (param[1] = new OracleParameter("p_MIC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mic_itm_cd;
                (param[2] = new OracleParameter("p_MIC_TAX_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mic_tax_cd;
                (param[3] = new OracleParameter("p_MIC_TAX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Mic_tax_rt;
                (param[4] = new OracleParameter("p_MIC_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Mic_claim;
                (param[5] = new OracleParameter("p_MIC_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mic_stus;
                (param[6] = new OracleParameter("p_MIC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mic_cre_by;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_TAX_CLAIM", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        public Int32 SaveServiceSchedule_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_SERVICE_PRD_log", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SaveServiceSchedule(List<mst_itm_sevpd> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            foreach (mst_itm_sevpd _itm in _lst)
            {
                (param[0] = new OracleParameter("p_MSP_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msp_itm_cd;
                (param[1] = new OracleParameter("p_MSP_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msp_itm_stus;
                (param[2] = new OracleParameter("p_MSP_TERM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Msp_term;
                (param[3] = new OracleParameter("p_MSP_PD_FROM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Msp_pd_from;
                (param[4] = new OracleParameter("p_MSP_PD_TO", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Msp_pd_to;
                (param[5] = new OracleParameter("p_MSP_PD_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msp_pd_uom;
                (param[6] = new OracleParameter("p_MSP_PDALT_FROM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Msp_pdalt_from;
                (param[7] = new OracleParameter("p_MSP_PDALT_TO", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Msp_pdalt_to;
                (param[8] = new OracleParameter("p_MSP_PDALT_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msp_pdalt_uom;
                (param[9] = new OracleParameter("p_MSP_ISFREE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Msp_isfree;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_SERVICE_PRD", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<mst_itm_sevpd> getServiceSchedule(string _item)
        {
            List<mst_itm_sevpd> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_service_prd", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_sevpd>(_dtResults, mst_itm_sevpd.Converter);
            }
            return _ListItems;
        }
        public Int32 SaveStatusWarranty_log(string _item)
        {
            //Nadeeka 25-05-2015

            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_itm_war_log", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveStatusWarranty(List<MasterItemWarrantyPeriod> _lst)
        {
            //Nadeeka 25-05-2015
            //modify rukshan 14/Dec/2015 add p_MWP_RMK,p_MWP_SUP_WARA_REM,p_MWP_SUP_WARA_PRD,p_MWP_EFFECT_DT
            OracleParameter[] param = new OracleParameter[16];
            Int32 effects = 0;

            foreach (MasterItemWarrantyPeriod _itm in _lst)
            {
                (param[0] = new OracleParameter("p_MWP_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_itm_cd;
                (param[1] = new OracleParameter("p_MWP_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_itm_stus;
                (param[2] = new OracleParameter("p_MWP_WARR_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_warr_tp;
                (param[3] = new OracleParameter("p_MWP_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mwp_val;
                (param[4] = new OracleParameter("p_MWP_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mwp_act;
                (param[5] = new OracleParameter("p_MWP_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_cre_by;
                (param[6] = new OracleParameter("p_MWP_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Mwp_cre_dt;
                (param[7] = new OracleParameter("p_MWP_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_mod_by;
                (param[8] = new OracleParameter("p_MWP_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Mwp_mod_dt;
                (param[9] = new OracleParameter("p_MWP_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_session_id;
                (param[10] = new OracleParameter("p_MWP_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_rmk;
                (param[11] = new OracleParameter("p_MWP_SUP_WARA_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mwp_sup_wara_rem;
                (param[12] = new OracleParameter("p_MWP_SUP_WARA_PRD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mwp_sup_warranty_prd;
                (param[13] = new OracleParameter("p_MWP_EFFECT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Mwp_effect_dt;
                (param[14] = new OracleParameter("p_mwp_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mwp_def ? 1 : 0;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_update_itm_war", CommandType.StoredProcedure, param);
            }
            return effects;
        }


        public Int32 SavePcWarranty_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_PC_WARA_LOG", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 SavePcWarranty(List<mst_itm_pc_warr> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0;

            foreach (mst_itm_pc_warr _itm in _lst)
            {



                (param[0] = new OracleParameter("p_PC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_com;
                (param[1] = new OracleParameter("p_PC_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_code;
                (param[2] = new OracleParameter("p_PC_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_item_code;
                (param[3] = new OracleParameter("p_PC_ITEM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_item_stus;
                (param[4] = new OracleParameter("p_PC_WARA_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Pc_wara_period;
                (param[5] = new OracleParameter("p_PC_WARA_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_wara_rmk;
                (param[6] = new OracleParameter("p_PC_VALID_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Pc_valid_from;
                (param[7] = new OracleParameter("p_PC_VALID_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Pc_valid_to;

                (param[8] = new OracleParameter("p_PC_CREATE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Pc_create_when;
                (param[9] = new OracleParameter("p_PC_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_create_by;
                (param[10] = new OracleParameter("p_PC_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_type;
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_PC_WARA", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public List<mst_itm_pc_warr> getPcWarrant(string _item)
        {
            List<mst_itm_pc_warr> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_item_pc_wara", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_pc_warr>(_dtResults, mst_itm_pc_warr.Converter);
            }
            return _ListItems;
        }

        public Int32 SaveChannelWarranty(List<mst_itm_channlwara> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;

            foreach (mst_itm_channlwara _itm in _lst)
            {
                (param[0] = new OracleParameter("p_CW_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Cw_item_code;
                (param[1] = new OracleParameter("p_CW_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Cw_channel;
                (param[2] = new OracleParameter("p_CW_ITEM_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Cw_item_status;
                (param[3] = new OracleParameter("p_CW_WARRANTY_PRD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Cw_warranty_prd;
                (param[4] = new OracleParameter("p_CW_ACTIVE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Cw_active;
                (param[5] = new OracleParameter("p_CW_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Cw_create_by;
                (param[6] = new OracleParameter("p_CW_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Cw_modify_by;
                (param[7] = new OracleParameter("p_cw_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Cw_com;
                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CHANNEL_WARA", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        public Int32 SaveChannelWarranty_log(string _item)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;


            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CHANNEL_WARA_LOG", CommandType.StoredProcedure, param);

            return effects;
        }


        public List<mst_itm_channlwara> getChannelWarranty(string _item)
        {
            List<mst_itm_channlwara> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ChannelWara", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_channlwara>(_dtResults, mst_itm_channlwara.Converter);
            }
            return _ListItems;
        }

        public List<MasterItemWarrantyPeriod> getitemWarranty(string _item)
        {
            List<MasterItemWarrantyPeriod> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ItemWara", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemWarrantyPeriod>(_dtResults, MasterItemWarrantyPeriod.Converter);
            }
            return _ListItems;
        }


        public List<MasterItemTaxClaim> getitemTaxClaim(string _item)
        {
            List<MasterItemTaxClaim> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ItemTaxClaim", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemTaxClaim>(_dtResults, MasterItemTaxClaim.Converter);
            }
            return _ListItems;
        }
        //kapila
        public Int16 SaveStockRequest(string p_MRQ_COM, DateTime p_MRQ_VALID_FRM, DateTime p_MRQ_VALID_TO, string p_MRQ_RES_TP, string p_MRQ_PTY_TP, string p_MRQ_PTY_CD, string p_MRQ_ITM_CD, string p_MRQ_BRD, string p_MRQ_CAT1, string p_MRQ_CAT2, string p_MRQ_CAT3, string p_MRQ_CAT4, string p_MRQ_CAT5, decimal p_MRQ_QTY, Int32 p_MRQ_STUS, string p_MRQ_CRE_BY, string p_MRQ_MOD_BY, decimal p_MRQ_DAYS, decimal p_MRQ_WSDAYS, decimal p_MRQ_SSDAYS)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_MRQ_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_COM;
            (param[1] = new OracleParameter("p_MRQ_VALID_FRM", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_MRQ_VALID_FRM;
            (param[2] = new OracleParameter("p_MRQ_VALID_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_MRQ_VALID_TO;
            (param[3] = new OracleParameter("p_MRQ_RES_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_RES_TP;
            (param[4] = new OracleParameter("p_MRQ_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_PTY_TP;
            (param[5] = new OracleParameter("p_MRQ_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_PTY_CD;
            (param[6] = new OracleParameter("p_MRQ_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_ITM_CD;
            (param[7] = new OracleParameter("p_MRQ_BRD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_BRD;
            (param[8] = new OracleParameter("p_MRQ_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT1;
            (param[9] = new OracleParameter("p_MRQ_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT2;
            (param[10] = new OracleParameter("p_MRQ_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT3;
            (param[11] = new OracleParameter("p_MRQ_CAT4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT4;
            (param[12] = new OracleParameter("p_MRQ_CAT5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT5;
            (param[13] = new OracleParameter("p_MRQ_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_QTY;
            (param[14] = new OracleParameter("p_MRQ_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_STUS;
            (param[15] = new OracleParameter("p_MRQ_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CRE_BY;
            (param[16] = new OracleParameter("p_MRQ_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_MOD_BY;
            (param[17] = new OracleParameter("p_MRQ_DAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_DAYS;
            (param[18] = new OracleParameter("p_MRQ_WSDAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_WSDAYS;
            (param[19] = new OracleParameter("p_MRQ_SSDAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_SSDAYS;

            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_stk_req", CommandType.StoredProcedure, param);
            return effects;
        }
        //public Int16 SaveStockRequest(string p_MRQ_COM, DateTime p_MRQ_VALID_FRM, DateTime p_MRQ_VALID_TO, string p_MRQ_RES_TP, string p_MRQ_PTY_TP, string p_MRQ_PTY_CD, string p_MRQ_ITM_CD, string p_MRQ_BRD, string p_MRQ_CAT1, string p_MRQ_CAT2, string p_MRQ_CAT3, string p_MRQ_CAT4, string p_MRQ_CAT5, decimal p_MRQ_QTY, Int32 p_MRQ_STUS, string p_MRQ_CRE_BY, string p_MRQ_MOD_BY, decimal p_MRQ_DAYS)//, decimal p_MRQ_WSDAYS, decimal p_MRQ_SSDAYS)
        //{
        //    OracleParameter[] param = new OracleParameter[19];
        //    Int16 effects = 0;

        //    (param[0] = new OracleParameter("p_MRQ_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_COM;
        //    (param[1] = new OracleParameter("p_MRQ_VALID_FRM", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_MRQ_VALID_FRM;
        //    (param[2] = new OracleParameter("p_MRQ_VALID_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_MRQ_VALID_TO;
        //    (param[3] = new OracleParameter("p_MRQ_RES_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_RES_TP;
        //    (param[4] = new OracleParameter("p_MRQ_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_PTY_TP;
        //    (param[5] = new OracleParameter("p_MRQ_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_PTY_CD;
        //    (param[6] = new OracleParameter("p_MRQ_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_ITM_CD;
        //    (param[7] = new OracleParameter("p_MRQ_BRD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_BRD;
        //    (param[8] = new OracleParameter("p_MRQ_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT1;
        //    (param[9] = new OracleParameter("p_MRQ_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT2;
        //    (param[10] = new OracleParameter("p_MRQ_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT3;
        //    (param[11] = new OracleParameter("p_MRQ_CAT4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT4;
        //    (param[12] = new OracleParameter("p_MRQ_CAT5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CAT5;
        //    (param[13] = new OracleParameter("p_MRQ_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_QTY;
        //    (param[14] = new OracleParameter("p_MRQ_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_STUS;
        //    (param[15] = new OracleParameter("p_MRQ_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_CRE_BY;
        //    (param[16] = new OracleParameter("p_MRQ_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_MRQ_MOD_BY;
        //    (param[17] = new OracleParameter("p_MRQ_DAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_DAYS;
        //    //(param[18] = new OracleParameter("p_MRQ_WSDAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_WSDAYS;
        //    //(param[19] = new OracleParameter("p_MRQ_SSDAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_MRQ_SSDAYS;

        //    param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

        //    effects = (Int16)UpdateRecords("sp_save_stk_req", CommandType.StoredProcedure, param);
        //    return effects;
        //}
        //kapila
        public DataTable GetStockRequest(string _restp, string _loc, string _chnl, string _com, DateTime _date, string _item, String _brand, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_res_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _restp;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_stk_req", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetItemGIT(string _com, string _loc, string _item, string _brand, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, Decimal _days)//, Decimal _wsdays, Decimal _ssdays)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[7] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[8] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[9] = new OracleParameter("p_days", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _days;
            //(param[10] = new OracleParameter("p_days", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _wsdays;
            //(param[11] = new OracleParameter("p_days", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ssdays;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_git_itm_qty_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //dilshan on 23/11/2017
        public DataTable GetItemGITWH(string _com, string _loc, string _item, string _brand, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, Decimal _days, string _uloc)//, Decimal _wsdays, Decimal _ssdays)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[7] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[8] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[9] = new OracleParameter("p_days", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _days;
            (param[10] = new OracleParameter("p_uloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _uloc;
            //(param[10] = new OracleParameter("p_days", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _wsdays;
            //(param[11] = new OracleParameter("p_days", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ssdays;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_git_itm_qty_wh", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MasterItemComponent> getitemComponent(string _item)
        {
            List<MasterItemComponent> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ItemComponenet", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemComponent>(_dtResults, MasterItemComponent.Converter);
            }
            return _ListItems;
        }

        //Nadeeka 2014-12-31
        public Int32 GetTaxCodeSeq()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getTaxStucSeq", CommandType.StoredProcedure, param);
            return effects;
        }
        //2017-sep-26 Dilshan
        public int SaveMangerDetails(MgrCreation _hnd_over)
        {
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_HMFA_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_com;
            (param[1] = new OracleParameter("P_HMFA_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_pc;
            (param[2] = new OracleParameter("P_HMFA_MGR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_mgr_cd;
            (param[3] = new OracleParameter("P_HMFA_ACC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_acc_dt;
            (param[4] = new OracleParameter("P_HMFA_BONUS_ST_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_bonus_st_dt;
            (param[5] = new OracleParameter("P_HMFA_SR_OPEN_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_sr_open_dt;
            (param[6] = new OracleParameter("P_HMFA_ACT_STUS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_act_stus;
            (param[7] = new OracleParameter("P_HMFA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_cre_by;
            (param[8] = new OracleParameter("P_HMFA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[9] = new OracleParameter("P_HMFA_PC_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_pc_cat;
            (param[10] = new OracleParameter("P_HMFA_BONUS_METHOD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_bonus_method;
            (param[11] = new OracleParameter("P_HMFA_MGR_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_mgr_name;
            (param[12] = new OracleParameter("P_HMFA_MAINPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hmfa_mainpc;
            param[13] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_manager_det", CommandType.StoredProcedure, param);
            return result;
        }


        //2017-sep-26 Dilshan
        public int SaveCirDetails(hpr_disr_val_ref _hnd_over, int status)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_HDVR_FROM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_from_val;
            (param[1] = new OracleParameter("P_HDVR_TO_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_to_val;
            (param[2] = new OracleParameter("P_HDVR_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_val;
            (param[3] = new OracleParameter("P_HDVR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_cre_by;
            (param[4] = new OracleParameter("P_HDVR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[5] = new OracleParameter("P_HDVR_CIRCULAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_circular;
            (param[6] = new OracleParameter("P_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[7] = new OracleParameter("P_HDVR_RATEVALUE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_ratevalue;
            (param[8] = new OracleParameter("P_HDVR_BASE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdvr_base;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_circular_det", CommandType.StoredProcedure, param);
            return result;
        }
        //2017-sep-26 Dilshan
        public int SaveArrearsDetails(hpr_ars_rls_sch _hnd_over)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_HARS_SCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hars_sch;
            (param[1] = new OracleParameter("P_HARS_EFF_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hars_eff_from;
            (param[2] = new OracleParameter("P_HARS_EFF_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hars_eff_to;
            (param[3] = new OracleParameter("P_HARS_NO_RNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hars_no_rnt;
            (param[4] = new OracleParameter("P_HARS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hars_cre_by;
            (param[5] = new OracleParameter("P_HARS_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[6] = new OracleParameter("P_HARS_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hars_channel;
            (param[7] = new OracleParameter("P_HARS_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hars_pc;
            (param[8] = new OracleParameter("P_HARS_ACC_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hars_acc_from;
            (param[9] = new OracleParameter("P_HARS_ACC_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hars_acc_to;
            
            param[10] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_arears_det", CommandType.StoredProcedure, param);
            return result;
        }
        //2017-sep-26 Dilshan
        public int SaveBonusDetails(BonusDefinition _hnd_over)
        {
            OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("P_HBP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hbp_com;
            (param[1] = new OracleParameter("P_HBP_CIRCULAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hbp_circular;
            (param[2] = new OracleParameter("P_HBP_STRDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hbp_strdate;
            (param[3] = new OracleParameter("P_HBP_PCCAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hbp_pccat;
            (param[4] = new OracleParameter("P_HBP_FROM_ARRPER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hbp_from_arrper;
            (param[5] = new OracleParameter("P_HBP_TO_ARRPER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hbp_to_arrper;
            (param[6] = new OracleParameter("P_HBP_SR_FYEAR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hnd_over.hbp_sr_fyear;
            (param[7] = new OracleParameter("P_HBP_SR_TYEAR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hnd_over.hbp_sr_tyear;
            //(param[8] = new OracleParameter("P_HBP_FRMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hbp_frmdate;
            //(param[7] = new OracleParameter("P_HBP_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hbp_todate;
            (param[8] = new OracleParameter("P_HBP_TACCOUNT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hnd_over.hbp_taccount;
            (param[9] = new OracleParameter("P_HBP_FROM_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hbp_from_bal;
            (param[10] = new OracleParameter("P_HBP_TO_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hbp_to_bal;
            (param[11] = new OracleParameter("P_HBP_BNSPER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.hbp_bnsper;
            (param[12] = new OracleParameter("P_HBP_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hbp_cre_by;
            (param[13] = new OracleParameter("P_HBP_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[14] = new OracleParameter("P_HBP_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hbp_channel;
            (param[15] = new OracleParameter("P_HBP_SHSTRDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hbp_shstrdate;
            (param[16] = new OracleParameter("P_HBP_SHSTRAB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hbp_shstrab;

            param[17] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_bonus_det", CommandType.StoredProcedure, param);
            return result;
        }
        //2017-sep-26 Dilshan
        public int SaveLocDetails(hpr_disr_pc_defn _hnd_over)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_HDPD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_com;
            (param[1] = new OracleParameter("P_HDPD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_pc;
            (param[2] = new OracleParameter("P_HDPD_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_from_dt;
            (param[3] = new OracleParameter("P_HDPD_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_to_dt;
            (param[4] = new OracleParameter("P_HDPD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_cre_by;
            (param[5] = new OracleParameter("P_HDPD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[6] = new OracleParameter("P_HDPD_MANAGER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_manager;
            (param[7] = new OracleParameter("P_HDPD_CIRCULAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_circular;
            (param[8] = new OracleParameter("P_HDPD_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hdpd_channel;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_loc_det", CommandType.StoredProcedure, param);
            return result;
        }

        public List<MgrCreation> GetMgrextData(string com, string mgr)
        {
            List<MgrCreation> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_MGR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "sp_get_manager_det", CommandType.StoredProcedure, false, param);
            //if (availbale == true)
            //{
            //    dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVER_DET_BAL", CommandType.StoredProcedure, false, param);
            //}
            //else
            //{
            //    dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVER_DET", CommandType.StoredProcedure, false, param);
            //}
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<MgrCreation>(dtTemp, MgrCreation.webConverter);
            }
            return oResult;
        }

        public List<hpr_disr_val_ref> GetCircularData(string com, string mgr, string cat)
        {
            List<hpr_disr_val_ref> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CIR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr;
            (param[2] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "sp_get_circular_det", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_disr_val_ref>(dtTemp, hpr_disr_val_ref.webConverter);
            }
            return oResult;
        }

        public List<hpr_disr_val_ref> CheckCircularData(string com, string mgr, string cat)
        {
            List<hpr_disr_val_ref> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CIR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr;
            (param[2] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "sp_check_circular_det", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_disr_val_ref>(dtTemp, hpr_disr_val_ref.webConverter);
            }
            return oResult;
        }

        public List<hpr_disr_pc_defn> GetCirLocData(string com, string mgr)
        {
            List<hpr_disr_pc_defn> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CIR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "sp_get_cirloc_det", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_disr_pc_defn>(dtTemp, hpr_disr_pc_defn.webConverter);
            }
            return oResult;
        }
        public List<BonusDefinition> GetCircularcbdData(string com, string mgr)
        {
            List<BonusDefinition> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CIR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "sp_get_circularcbd_det", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<BonusDefinition>(dtTemp, BonusDefinition.webConverter);
            }
            return oResult;
        }

        public List<hpr_ars_rls_sch> GetSchemeData(string com, string channel, string location)
        {
            List<hpr_ars_rls_sch> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("P_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "sp_get_scheme_det", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_ars_rls_sch>(dtTemp, hpr_ars_rls_sch.webConverter);
            }
            return oResult;
        }

        public Int32 GetSchemeTerm(string _type, string _code, string _term)
        {
            int _eff = 0;
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("P_TERM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _term;

            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tblscheme", "sp_get_schemeterm_det", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count != 0)
            {
                //for (int i = 0; i < _result.Rows.Count; i++)
                //{
                ////if (!string.IsNullOrEmpty(_result.Rows[0]["ESDBAL"].ToString()))
                ////    _valESD = Convert.ToDecimal(_result.Rows[0]["ESDBAL"]);

                ////if (!string.IsNullOrEmpty(_result.Rows[0]["INTBAL"].ToString()))
                ////    _valInt = Convert.ToDecimal(_result.Rows[0]["INTBAL"]);

                _eff = 1;
                //}
            }
            return _eff;
        }

        public Int32 SaveItemTaxStructureDet(List<mst_itm_tax_structure_det> _lstTax)
        {
            //Nadeeka 25-05-2015
            //Modfiy by Rukshan 27/Nov/2015 add 8,9 param
            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            foreach (mst_itm_tax_structure_det _tax in _lstTax)
            {

                (param[0] = new OracleParameter("p_its_stuc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tax.Its_stuc_seq;
                (param[1] = new OracleParameter("p_its_stuc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Its_stuc_code;
                (param[2] = new OracleParameter("p_its_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Its_com;
                (param[3] = new OracleParameter("p_its_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Its_stus;
                (param[4] = new OracleParameter("p_its_tax_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Its_tax_cd;
                (param[5] = new OracleParameter("p_its_taxrate_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Its_taxrate_cd;
                (param[6] = new OracleParameter("p_its_tax_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Convert.ToDecimal(_tax.Its_tax_rate);
                (param[7] = new OracleParameter("p_its_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_tax.Its_act);
                (param[8] = new OracleParameter("p_its_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tax.Its_valid_from;
                (param[9] = new OracleParameter("p_its_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tax.Its_valid_to;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_TAX_STRUCTURE", CommandType.StoredProcedure, param);

            }
            return effects;

        }

        public Int32 DeleteItemTaxStructureDet(string _taxCode, string _user)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_its_stuc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxCode;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_DELETE_TAX", CommandType.StoredProcedure, param);

            return effects;

        }

        public List<mst_itm_tax_structure_det> GetItemTaxStructure(string _code)
        {
            List<mst_itm_tax_structure_det> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_TAX_STRU", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_tax_structure_det>(_dtResults, mst_itm_tax_structure_det.Converter);
            }
            return _ListItems;
        }
        public List<mst_itm_tax_structure_hdr> GetItemTaxStructureHeader(string _code)
        {
            List<mst_itm_tax_structure_hdr> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_TAX_STRU_HDR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_tax_structure_hdr>(_dtResults, mst_itm_tax_structure_hdr.Converter);
            }
            return _ListItems;
        }

        public Int32 SaveItemTaxStructureHdr(mst_itm_tax_structure_hdr _tax)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;


            (param[0] = new OracleParameter("p_ish_stuc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tax.Ish_stuc_seq;
            (param[1] = new OracleParameter("p_ish_stuc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Ish_stuc_code;
            (param[2] = new OracleParameter("p_ish_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Ish_com;
            (param[3] = new OracleParameter("p_ish_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Ish_des;
            (param[4] = new OracleParameter("p_ish_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tax.Ish_date;
            (param[5] = new OracleParameter("p_ish_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Ish_cre_by;
            (param[6] = new OracleParameter("p_ish_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.Ish_mod_by;
            (param[7] = new OracleParameter("p_ish_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_tax.Ish_act);
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_SAVE_ITEM_TAX_STRUCTURE_HDR", CommandType.StoredProcedure, param);

            return effects;

        }

        public Int32 DeleteItemCate1(List<REF_ITM_CATE1> _lstcate1)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            foreach (REF_ITM_CATE1 _cate1 in _lstcate1)
            {

                (param[0] = new OracleParameter("p_RIC1_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Ric1_cd;
                (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.RIC1_MOD_BY;
                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_CATE1", CommandType.StoredProcedure, param);
            }
            return effects;

        }

        public Int32 SaveItemCate1(List<REF_ITM_CATE1> _lstcate1)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            Int32 effectsItmUpdate = 0;
            foreach (REF_ITM_CATE1 _cate1 in _lstcate1)
            {
                (param[0] = new OracleParameter("p_RIC1_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Ric1_cd;
                (param[1] = new OracleParameter("p_RIC1_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.Ric1_desc;
                (param[2] = new OracleParameter("p_RIC1_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_cate1.Ric1_act);
                (param[3] = new OracleParameter("p_RIC1_ORDER", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cate1.Ric1_order;
                (param[4] = new OracleParameter("p_RIC1_AGE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cate1.Ric1_age;
                (param[5] = new OracleParameter("p_RIC1_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.RIC1_CRE_BY;
                (param[6] = new OracleParameter("p_RIC1_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.RIC1_MOD_BY;
                (param[7] = new OracleParameter("p_RIC1_INV_CONTRIBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.RIC1_INV_CONTRIBU;
                (param[8] = new OracleParameter("p_RIC1_GP_CONTRIBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1.RIC1_GP_CONTRIBU;                
                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CATE1", CommandType.StoredProcedure, param);
                if (_cate1.RIC1_Update == true)
                {
                    effectsItmUpdate = UpdateItemCatContribution(_cate1.Ric1_cd, _cate1.RIC1_INV_CONTRIBU, _cate1.RIC1_GP_CONTRIBU);
                }

            }
            return effects;

        }
        public Int32 DeleteItemCate2(List<MasterItemSubCate> _lstcate2)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            foreach (MasterItemSubCate _cate2 in _lstcate2)
            {

                (param[0] = new OracleParameter("p_RIC2_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.Ric2_cd;
                (param[1] = new OracleParameter("p_RIC2_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.Ric2_cd1;
                (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.RIC2_MOD_BY;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_CATE2", CommandType.StoredProcedure, param);
            }
            return effects;

        }
        public Int32 SaveItemCate2(List<MasterItemSubCate> _lstcate2)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            foreach (MasterItemSubCate _cate2 in _lstcate2)
            {
                (param[0] = new OracleParameter("p_RIC2_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.Ric2_cd;
                (param[1] = new OracleParameter("p_RIC2_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.Ric2_cd1;
                (param[2] = new OracleParameter("p_RIC2_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.Ric2_desc;
                (param[3] = new OracleParameter("p_RIC2_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_cate2.Ric2_act);
                (param[4] = new OracleParameter("p_RIC2_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.RIC2_CRE_BY;
                (param[5] = new OracleParameter("p_RIC2_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2.RIC2_MOD_BY;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CATE2", CommandType.StoredProcedure, param);
            }
            return effects;

        }

        public Int32 DeleteItemCate3(List<REF_ITM_CATE3> _lstcate3)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            foreach (REF_ITM_CATE3 _cate3 in _lstcate3)
            {

                (param[0] = new OracleParameter("p_RIC3_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric3_cd1;
                (param[1] = new OracleParameter("p_RIC3_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric3_cd2;
                (param[2] = new OracleParameter("p_RIC3_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric3_cd;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.RIC3_MOD_BY;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_CATE3", CommandType.StoredProcedure, param);
            }
            return effects;

        }
        public Int32 SaveItemCate3(List<REF_ITM_CATE3> _lstcate3)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            foreach (REF_ITM_CATE3 _cate3 in _lstcate3)
            {
                (param[0] = new OracleParameter("p_RIC3_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric3_cd1;
                (param[1] = new OracleParameter("p_RIC3_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric3_cd2;
                (param[2] = new OracleParameter("p_RIC3_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric3_cd;
                (param[3] = new OracleParameter("p_RIC2_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.Ric2_desc;
                (param[4] = new OracleParameter("p_RIC2_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_cate3.Ric2_act);
                (param[5] = new OracleParameter("p_RIC3_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.RIC3_MOD_BY;
                (param[6] = new OracleParameter("p_RIC3_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3.RIC3_MOD_BY;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CATE3", CommandType.StoredProcedure, param);
            }
            return effects;

        }
        public Int32 DeleteItemCate4(List<REF_ITM_CATE4> _lstcate4)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            foreach (REF_ITM_CATE4 _cate4 in _lstcate4)
            {

                (param[0] = new OracleParameter("p_RIC4_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd1;
                (param[1] = new OracleParameter("p_RIC4_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd2;
                (param[2] = new OracleParameter("p_RIC4_CD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd3;
                (param[3] = new OracleParameter("p_RIC4_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd;
                (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.RIC4_MOD_BY;
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_CATE4", CommandType.StoredProcedure, param);
            }
            return effects;

        }

        public Int32 SaveItemCate4(List<REF_ITM_CATE4> _lstcate4)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;
            foreach (REF_ITM_CATE4 _cate4 in _lstcate4)
            {
                (param[0] = new OracleParameter("p_RIC4_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd1;
                (param[1] = new OracleParameter("p_RIC4_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd2;
                (param[2] = new OracleParameter("p_RIC4_CD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd3;
                (param[3] = new OracleParameter("p_RIC4_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_cd;
                (param[4] = new OracleParameter("p_RIC4_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.Ric4_desc;
                (param[5] = new OracleParameter("p_RIC4_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_cate4.Ric4_act);
                (param[6] = new OracleParameter("p_RIC4_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.RIC4_CRE_BY;
                (param[7] = new OracleParameter("p_RIC4_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate4.RIC4_MOD_BY;
                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CATE4", CommandType.StoredProcedure, param);
            }
            return effects;

        }

        public Int32 DeleteItemCate5(List<REF_ITM_CATE5> _lstcate5)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            foreach (REF_ITM_CATE5 _cate5 in _lstcate5)
            {

                (param[0] = new OracleParameter("p_RIC5_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd1;
                (param[1] = new OracleParameter("p_RIC5_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd2;
                (param[2] = new OracleParameter("p_RIC5_CD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd3;
                (param[3] = new OracleParameter("p_RIC5_CD4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd4;
                (param[4] = new OracleParameter("p_RIC5_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd;
                (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.RIC5_MOD_BY;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_DELETE_CATE5", CommandType.StoredProcedure, param);
            }
            return effects;

        }
        public Int32 SaveItemCate5(List<REF_ITM_CATE5> _lstcate5)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;

            foreach (REF_ITM_CATE5 _cate5 in _lstcate5)
            {
                (param[0] = new OracleParameter("p_RIC5_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd1;
                (param[1] = new OracleParameter("p_RIC5_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd2;
                (param[2] = new OracleParameter("p_RIC5_CD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd3;
                (param[3] = new OracleParameter("p_RIC5_CD4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd4;
                (param[4] = new OracleParameter("p_RIC5_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_cd;
                (param[5] = new OracleParameter("p_RIC5_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.Ric5_desc;
                (param[6] = new OracleParameter("p_RIC5_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_cate5.Ric5_act);
                (param[7] = new OracleParameter("p_RIC5_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.RIC5_CRE_BY;
                (param[8] = new OracleParameter("p_RIC5_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate5.RIC5_MOD_BY;
                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_CATE5", CommandType.StoredProcedure, param);
            }
            return effects;

        }


        public MasterItem GetItemMaster(string _item)
        {// Nadeeka
            MasterItem _itemList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_itemMaster", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertAssetItem)[0];
            }
            return _itemList;
        }
        public DataTable GetItemTpAll()
        {// Nadeeka
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getAllitemtype", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetTaxCode()
        {// Nadeeka
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "SP_GET_TAX_CODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }




        public DataTable GetContainerType()
        {// Nadeeka
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getContainer", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetWarrantyPeriod()
        {// Nadeeka
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getWaraPrd", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #endregion Item Master

        public Int32 Update_to_serviceChnl_para(ServiceChnlDetails objservice_chnl)
        {
            //shanuka 09-10-2014
            OracleParameter[] param = new OracleParameter[25];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_SP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Company;
            (param[1] = new OracleParameter("p_SP_SERCHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Channel;
            (param[2] = new OracleParameter("p_SP_EXTERNALCUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.CusCode;
            (param[3] = new OracleParameter("p_SP_DEFINVC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.InvType;
            (param[4] = new OracleParameter("p_SP_DEFPB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Pricebook;

            (param[5] = new OracleParameter("p_SP_DEFPBLVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Pricelevel;
            (param[6] = new OracleParameter("p_SP_DEFCURRENCY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Currancy;
            (param[7] = new OracleParameter("p_SP_RESETJOBMONTHLY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsReset_job;
            (param[8] = new OracleParameter("p_SP_CONSUMABLE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Itemcode;

            (param[9] = new OracleParameter("p_SP_ISNEEDWIP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsWrkpro;
            (param[10] = new OracleParameter("p_SP_ISNEEDGATEPASS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsAllow_gate_pass;
            (param[11] = new OracleParameter("p_SP_WARPBK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Warrnty_pb;
            (param[12] = new OracleParameter("p_SP_WARPBLVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Warrnty_pl;

            (param[13] = new OracleParameter("p_SP_WARRPBITEMTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Item_stus;
            (param[14] = new OracleParameter("p_SP_DB_SERIAL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser1;
            (param[15] = new OracleParameter("p_SP_DB_CHASSIS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser2;
            (param[16] = new OracleParameter("p_SP_DB_VEHI_REG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser3;

            (param[17] = new OracleParameter("p_SP_DB_MSN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Ser4;
            (param[18] = new OracleParameter("p_SP_ALOC_SUPERVISOR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.IsAllowSuper;
            (param[19] = new OracleParameter("p_SP_INSPECTION_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.ItemCode_inspection;
            (param[20] = new OracleParameter("p_SP_JOB_SCREEN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.JobScreen;

            (param[21] = new OracleParameter("p_SP_CHECK_OLDPART", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objservice_chnl.Chk_recved;
            (param[22] = new OracleParameter("p_SP_DB_SLOT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Slot;
            (param[23] = new OracleParameter("p_sp_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = objservice_chnl.Cre_user;
            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_SERVICE_CHN_PARA", CommandType.StoredProcedure, param);
            return effects;

        }

        //shanuka 10-10-2014
        public DataTable get_sub_chanels(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _description = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "";
            //searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "";
            //searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "";
            //searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "";
            //searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "";
            //searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "";
            //searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6]) : "";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";


            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblser", "SP_GET_SB_CHNL_SERVICE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //shanuka 10-10-2014
        public DataTable GetServiceLocation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "SP_GET_SERVICE_LOCATIONS", CommandType.StoredProcedure, false, param);

            return _dtResults;

        }

        //shanuka 09-10-2014
        public DataTable get_serviceCenters(string com, string chnl)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chnl;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_SERVICE_CENTERS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //Nadeeka 13-12-2014
        public DataTable get_Language()
        {

            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_load_language", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //Nadeeka 13-12-2014
        public DataTable get_Buss_ent_type()
        {

            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_load_buss_ent_type", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //
        //shanuka 11-10-2014
        public Int32 Insert_to_serviceloc(List<ServiceChnlDetails> lstserviceloc)
        {
            Int32 effects = 0;
            foreach (ServiceChnlDetails _itemDetails in lstserviceloc)
            {
                OracleParameter[] param = new OracleParameter[5];

                (param[0] = new OracleParameter("p_SLL_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Company;
                (param[1] = new OracleParameter("p_SLL_SCV_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Itemcode;
                (param[2] = new OracleParameter("p_SLL_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.InvType;
                (param[3] = new OracleParameter("p_SLL_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemDetails.Ser1;

                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_INSERT_SERVICECENTERS", CommandType.StoredProcedure, param);

            }

            return effects;

        }
        //shanuka 11-10-2014
        public DataTable getAllservice_locDetails(string com, string loc, string sloc)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_sloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sloc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_ALL_SERVICE_LOC_DETAILS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //shanuka 11-10-2014
        public DataTable getAllservice_paraDets(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_ALL_SERVICEPARA_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //shanuka 11-10-2014
        public DataTable get_loc_services(string com, string srcenter, string type)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_ser_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = srcenter;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_LOCATION_SERVCE", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        //shanuka 11-10-2014
        public DataTable get_Status_for_services(string com, string srcenter, string type, string loc)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_ser_center", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = srcenter;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_CHK_STUS_LOCATION", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        public Int32 Update_to_InactiveServices(ServiceChnlDetails obj_services)
        {
            //shanuka 11-10-2014
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_services.Company;
            (param[1] = new OracleParameter("p_SLL_SCV_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_services.CusCode;
            (param[2] = new OracleParameter("p_SLL_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_services.InvType;
            (param[3] = new OracleParameter("p_SLL_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj_services.Itemcode;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_INACTIVE_SERVICECENTERS", CommandType.StoredProcedure, param);
            return effects;

        }




        //shanuka 11-10-2014
        public DataTable get_service_center_dets(string com)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_LOAD_SERVICECENTER_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }



        //Tharaka 2014-10-14
        public DataTable GetTownByDesc(string _Desc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TOWN_BY_DESC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //shanuka 15-10-2014
        public DataTable get_sub_chnl_stus(string com, string code)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_SUBCHANL_STUS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }


        //shanuka 18-10-2014
        public DataTable get_Default_val(string code)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_DAFAULTVAL", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //shanuka 21-10-2014
        public DataTable get_availble_AllocateItems(string com, string tpe, string loc, string cate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tpe;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[3] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_CHK_AVL_ITEMS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }
        //Darshana 23-10-2014
        public List<HpAccount> GetHpAccountsByDtRange(string _com, string _pc, DateTime _frmDt, DateTime _toDt)
        {
            List<HpAccount> _ListItems = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[3] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getaccbydtrange", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<HpAccount>(_dtResults, HpAccount.Converter);
            }
            return _ListItems;
        }

        //Chamal 09-10-2014
        public bool CheckReqNo(string _com, string _loc, string _doc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = new DataTable();
            _dt = QueryDataTable("tbl1", "chk_req_no", CommandType.StoredProcedure, false, param);
            if (_dt.Rows.Count > 0) return true; else return false;
        }
        //shanuka 25-10-2014
        public DataTable get_All_Bnk_StmDetails(DateTime from, DateTime to, string acc)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[1] = new OracleParameter("p_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[2] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "pkg_sun_upload.SP_GET_BANK_STM_DETS", CommandType.StoredProcedure, false, param);
            return tblDet;

        }

        /// <summary>
        /// damith 22-12-2014
        /// Saves the SMS log.
        /// </summary>
        /// <param name="_smsLogRef">The _SMS log reference.</param>
        /// <returns></returns>
        public int SaveSmsLog(Sms_Ref_Log _smsLogRef)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_reminderId", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_id;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_pc;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_loc;
            (param[4] = new OracleParameter("p_bdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_bdoc;
            (param[5] = new OracleParameter("p_bdoc_line ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_bdoc_line;
            (param[6] = new OracleParameter("p_rdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_rdoc;
            (param[7] = new OracleParameter("p_sms", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_sms;
            (param[8] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_email;
            (param[9] = new OracleParameter("p_smsseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_smsseq;
            (param[10] = new OracleParameter("p_sm_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_sm_stus;
            (param[11] = new OracleParameter("p_em_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_em_stus;
            (param[12] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_cre_by;
            (param[13] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsLogRef.Rml_cre_dt;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_save_sms_log", CommandType.StoredProcedure, param);
            return _effect;
        }

        /// <summary>
        /// damith 29-12-2014
        /// Gets the job estiamte tot.
        /// </summary>
        /// <param name="jobNo">The job no.</param>
        /// <returns></returns>
        public string GetJobEstiamteTot(string jobNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo.Trim();
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = new DataTable();
            _dt = QueryDataTable("tbl_det", "sp_get_estimate_tot", CommandType.StoredProcedure, false, param);
            return (!string.IsNullOrEmpty(_dt.Rows[0]["esi_net"].ToString())) ? _dt.Rows[0]["esi_net"].ToString() : null;
        }

        //Tharaka 2015-01-13
        public Int32 GetOtherShopCollectionsCount(string Com, string Loc, DateTime CurrentDate)
        {
            Int32 Count = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = CurrentDate;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_OTHERSHOPCOLLECTION_NTF", CommandType.StoredProcedure, false, param);

            Count = Convert.ToInt32(_result.Rows[0][0].ToString());

            return Count;
        }

        //Tharaka 2015-01-13
        public List<Notification_OthShpCollecitons> GetOtherShopCollections(String Com, String Loc, DateTime Date)
        {
            List<Notification_OthShpCollecitons> _ListItems = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_OTHERSHOPCOLLOCTIONS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<Notification_OthShpCollecitons>(_dtResults, Notification_OthShpCollecitons.Converter);
            }
            return _ListItems;
        }

        //Tharaka 2015-02-19
        public Master_Employee GetMasterEmployee(String Com, String emp)
        {
            Master_Employee _ListItems = new Master_Employee();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("p_empCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_inv_Emp", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<Master_Employee>(_dtResults, Master_Employee.Converter)[0];
            }
            return _ListItems;
        }

        //Chamal 2015-02-20
        public DataTable GetSerialSupplierCode(String _com, String _item, String _serial, Int16 _key)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_key", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _key;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_get_supplier", CommandType.StoredProcedure, false, param);
        }

        //kapila
        public DataTable GetSerialSupplierGRN(String _com, String _item, String _serial, Int16 _key)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_key", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _key;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_get_sup_grn", CommandType.StoredProcedure, false, param);
        }

        //Tharaka 2015-02-21
        public Int32 SAVE_MST_MSG_INFOBASE(MsgInformation oItem)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("P_MMI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_seq_no;
            (param[1] = new OracleParameter("P_MMI_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_com;
            (param[2] = new OracleParameter("P_MMI_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_loc;
            (param[3] = new OracleParameter("P_MMI_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_doc_tp;
            (param[4] = new OracleParameter("P_MMI_RECEIVER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_receiver;
            (param[5] = new OracleParameter("P_MMI_MOBI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_mobi_no;
            (param[6] = new OracleParameter("P_MMI_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_email;
            (param[7] = new OracleParameter("P_MMI_PD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_pd;
            (param[8] = new OracleParameter("P_MMI_MSG_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_msg_tp;
            (param[9] = new OracleParameter("P_MMI_SP_MSG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_sp_msg;
            (param[10] = new OracleParameter("P_MMI_SUPERIOR_MAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_superior_mail;
            (param[11] = new OracleParameter("P_MMI_DIVIDESECTIONDAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_dividesectiondays;
            (param[12] = new OracleParameter("P_MMI_SHOWDIVIDESECTIONS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_showdividesections;
            (param[13] = new OracleParameter("P_MMI_REP_FORMAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_rep_format;
            (param[14] = new OracleParameter("P_MMI_SEND_SPC_TIME", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_send_spc_time;
            (param[15] = new OracleParameter("P_MMI_SPC_TIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Mmi_spc_time;
            (param[16] = new OracleParameter("P_MMI_WITH_SR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_with_sr;
            (param[17] = new OracleParameter("P_MMI_SEND_DAY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_send_day;
            (param[18] = new OracleParameter("P_MMI_STAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_stage;
            (param[19] = new OracleParameter("P_MMI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Mmi_stus;
            (param[20] = new OracleParameter("P_MMI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_cre_by;
            (param[21] = new OracleParameter("P_MMI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Mmi_cre_dt;
            (param[22] = new OracleParameter("P_MMI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Mmi_mod_by;
            (param[23] = new OracleParameter("P_MMI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Mmi_mod_dt;
            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_MST_MSG_INFOBASE", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka 2015-05-16
        public List<SEC_SYSTEM_MENU_SUB> GET_REPORT_LIST_BY_MENU(String MenuName)
        {
            List<SEC_SYSTEM_MENU_SUB> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MenuName;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_REPORT_LIST_BY_MENU", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<SEC_SYSTEM_MENU_SUB>(_dtResults, SEC_SYSTEM_MENU_SUB.Converter);
            }
            return _ListItems;
        }

        //Tharaka 2015-05-21
        public DataTable GetSecurityUsers(String Com, String User, String Department, DateTime FromDAte, DateTime Todate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            (param[1] = new OracleParameter("P_DEP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Department;
            (param[2] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDAte;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Todate;
            (param[4] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SEC_USER_RPT", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 CheckSCMPeriodIsOpen(string _com, string _loc, int _year, int _month)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[3] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_chk_scm_period", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0) _effect = 1;
            return _effect;
        }


        public Int32 Common_save_smsout(SMS_OUT sms_out)
        {
            OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("S_SEQNO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = sms_out.SEQNO;
            (param[1] = new OracleParameter("S_SENDER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.SENDER;
            (param[2] = new OracleParameter("S_SENDERPHNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.SENDERPHNO;
            (param[3] = new OracleParameter("S_RECEIVER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.RECEIVER;
            (param[4] = new OracleParameter("S_RECEIVERPHNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.RECEIVERPHNO;
            (param[5] = new OracleParameter("S_MSG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.MSG;
            (param[6] = new OracleParameter("S_MSGID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.MSGID;
            (param[7] = new OracleParameter("S_MSGSTATUS", OracleDbType.Int16, null, ParameterDirection.Input)).Value = sms_out.MSGSTATUS;
            (param[8] = new OracleParameter("S_MSGTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.MSGTYPE;
            (param[9] = new OracleParameter("S_REFDOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.REFDOCNO;
            (param[10] = new OracleParameter("S_CREATETIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = sms_out.CREATETIME;
            (param[11] = new OracleParameter("S_DOWNLOADTIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = sms_out.DOWNLOADTIME;
            (param[12] = new OracleParameter("S_RECEIVEDTIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = sms_out.RECEIVEDTIME;
            (param[13] = new OracleParameter("S_DELETEDTIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = sms_out.DELETEDTIME;
            (param[14] = new OracleParameter("S_DELIVEREDTIME", OracleDbType.Date, null, ParameterDirection.Input)).Value = sms_out.DELIVEREDTIME;
            (param[15] = new OracleParameter("S_COMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sms_out.COMCODE;
            (param[16] = new OracleParameter("S_CATEID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = sms_out.CATEID;
            param[17] = new OracleParameter("O_EFFECT", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Int32 o_effect = (Int32)UpdateRecords("SP_SAVE_MST_MSG_INFOBASE", CommandType.StoredProcedure, param);
            return o_effect;
        }

        public Int32 Common_send_Email(MailAddress to, MailAddress cc, MailAddress bcc, string subject, bool isBodyHtml, string body, string[] attachment)
        {
            try
            {
                GeneralDAL generalDAL = new GeneralDAL();

                SmtpClient smtpClient = new SmtpClient();
                MailMessage message = new MailMessage();

                MailAddress fromAddress = new MailAddress(generalDAL.GetMailAddress(), generalDAL.GetMailDispalyName());
                message.From = fromAddress;
                message.To.Add(to);
                if (cc != null)
                    message.CC.Add(cc);
                if (bcc != null)
                    message.Bcc.Add(bcc);
                message.Subject = subject;


                message.IsBodyHtml = isBodyHtml;
                if (isBodyHtml == true)
                {
                    body = "<html><body>" + body + "<P style='color:" + generalDAL.GetMailFooterMsgColor() + "'>" + generalDAL.GetMailFooterMsg() + "</p>" + "</body></html>";
                    body = body.Replace("\\n", "<br/>");
                    message.Body = body;
                }
                else
                {
                    body = body + generalDAL.GetMailFooterMsg();
                    body = body.Replace("\\n", "\n\n");
                    message.Body = body;
                }

                for (int i = 0; i < attachment.Count(); i++)
                {
                    message.Attachments.Add(new Attachment(attachment[i]));
                }

                message.DeliveryNotificationOptions = DeliveryNotificationOptions.OnSuccess;

                smtpClient.Host = generalDAL.GetMailHost();
                smtpClient.Port = 25;

                smtpClient.Send(message);

                return 1;

            }
            catch (Exception e)
            {
                return -1;
            }

        }

        /*Warehouse Zone*/
        public Tuple<int, int> SaveWarehouseZone(WarehouseZone _WarehouseZone)
        {
            int _eff = 0;
            Int32 _autoNo = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_IZ_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_com_cd;
            (param[1] = new OracleParameter("p_IZ_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_loc_cd;
            (param[2] = new OracleParameter("p_IZ_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_zn_seq;
            (param[3] = new OracleParameter("p_IZ_ZN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_zn_desc;
            (param[4] = new OracleParameter("p_IZ_ZN_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_zn_id;
            (param[5] = new OracleParameter("p_IZ_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_is_def;
            (param[6] = new OracleParameter("p_IZ_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_act;
            (param[7] = new OracleParameter("p_IZ_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_cre_by;
            (param[8] = new OracleParameter("p_IZ_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_cre_when;
            (param[9] = new OracleParameter("p_IZ_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_mod_by;
            (param[10] = new OracleParameter("p_IZ_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_mod_when;
            (param[11] = new OracleParameter("p_IZ_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_session_id;
            param[12] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Zone", CommandType.StoredProcedure, param);
            if (!((OracleDecimal)param[12].Value).IsNull)
            {

                _autoNo = int.Parse(param[12].Value.ToString());
            }

            return new Tuple<int, int>(_eff, _autoNo);
        }
        public Int32 UpdateWarehouseZone(WarehouseZone _WarehouseZone)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_IZ_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_com_cd;
            (param[1] = new OracleParameter("p_IZ_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_loc_cd;
            (param[2] = new OracleParameter("p_IZ_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_zn_seq;
            (param[3] = new OracleParameter("p_IZ_ZN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_zn_desc;
            (param[4] = new OracleParameter("p_IZ_ZN_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_zn_id;
            (param[5] = new OracleParameter("p_IZ_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_is_def;
            (param[6] = new OracleParameter("p_IZ_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_act;
            (param[7] = new OracleParameter("p_IZ_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_cre_by;
            (param[8] = new OracleParameter("p_IZ_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_cre_when;
            (param[9] = new OracleParameter("p_IZ_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_mod_by;
            (param[10] = new OracleParameter("p_IZ_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_mod_when;
            (param[11] = new OracleParameter("p_IZ_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseZone.Iz_session_id;
            param[12] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Zone", CommandType.StoredProcedure, param);
            return _eff;
        }
        /*Warehouse Aisle */
        public Tuple<int, int> SaveWarehouseAisle(WarehouseAisle _WarehouseAisle)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_IA_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_com_cd;
            (param[1] = new OracleParameter("p_IA_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_loc_cd;
            (param[2] = new OracleParameter("p_IA_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_zn_seq;
            (param[3] = new OracleParameter("p_IA_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_asl_seq;
            (param[4] = new OracleParameter("p_IA_ASL_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_asl_desc;
            (param[5] = new OracleParameter("p_IA_ASL_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_asl_id;
            (param[6] = new OracleParameter("p_IA_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_act;
            (param[7] = new OracleParameter("p_IA_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_is_def;
            (param[8] = new OracleParameter("p_IA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_cre_by;
            (param[9] = new OracleParameter("p_IA_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_cre_when;
            (param[10] = new OracleParameter("p_IA_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_mod_by;
            (param[11] = new OracleParameter("p_IA_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_mod_when;
            (param[12] = new OracleParameter("p_IA_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_session_id;
            param[13] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Aisle", CommandType.StoredProcedure, param);
            if (!((OracleDecimal)param[13].Value).IsNull)
            {

                _autoNo = int.Parse(param[13].Value.ToString());
            }

            return new Tuple<int, int>(_eff, _autoNo);
        }
        public Int32 UpdateWarehouseAisle(WarehouseAisle _WarehouseAisle)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_IA_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_com_cd;
            (param[1] = new OracleParameter("p_IA_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_loc_cd;
            (param[2] = new OracleParameter("p_IA_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_zn_seq;
            (param[3] = new OracleParameter("p_IA_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_asl_seq;
            (param[4] = new OracleParameter("p_IA_ASL_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_asl_desc;
            (param[5] = new OracleParameter("p_IA_ASL_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_asl_id;
            (param[6] = new OracleParameter("p_IA_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_act;
            (param[7] = new OracleParameter("p_IA_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_is_def;
            (param[8] = new OracleParameter("p_IA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_cre_by;
            (param[9] = new OracleParameter("p_IA_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_cre_when;
            (param[10] = new OracleParameter("p_IA_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_mod_by;
            (param[11] = new OracleParameter("p_IA_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_mod_when;
            (param[12] = new OracleParameter("p_IA_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseAisle.Ia_session_id;
            param[13] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Aisle", CommandType.StoredProcedure, param);
            return _eff;
        }
        /*Warehouse Row */
        public Tuple<int, int> SaveWarehouseRow(WarehouseRow _WarehouseRow)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[16];


            (param[0] = new OracleParameter("p_IR_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_com_cd;
            (param[1] = new OracleParameter("p_IR_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_loc_cd;
            (param[2] = new OracleParameter("p_IR_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_zn_seq;
            (param[3] = new OracleParameter("p_IR_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_asl_seq;
            (param[4] = new OracleParameter("p_IR_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_row_seq;
            (param[5] = new OracleParameter("p_IR_ROW_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_row_desc;
            (param[6] = new OracleParameter("p_IR_ROW_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_row_id;
            (param[7] = new OracleParameter("p_IR_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_act;
            (param[8] = new OracleParameter("p_IR_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_is_def;
            (param[9] = new OracleParameter("p_IR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_cre_by;
            (param[10] = new OracleParameter("p_IR_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_cre_when;
            (param[11] = new OracleParameter("p_IR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_mod_by;
            (param[12] = new OracleParameter("p_IR_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_mod_when;
            (param[13] = new OracleParameter("p_IR_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_session_id;
            param[14] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Row", CommandType.StoredProcedure, param);
            if (!((OracleDecimal)param[14].Value).IsNull)
            {

                _autoNo = int.Parse(param[14].Value.ToString());
            }

            return new Tuple<int, int>(_eff, _autoNo);
        }

        public Int32 UpdateWarehouseRow(WarehouseRow _WarehouseRow)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[16];


            (param[0] = new OracleParameter("p_IR_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_com_cd;
            (param[1] = new OracleParameter("p_IR_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_loc_cd;
            (param[2] = new OracleParameter("p_IR_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_zn_seq;
            (param[3] = new OracleParameter("p_IR_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_asl_seq;
            (param[4] = new OracleParameter("p_IR_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_row_seq;
            (param[5] = new OracleParameter("p_IR_ROW_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_row_desc;
            (param[6] = new OracleParameter("p_IR_ROW_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_row_id;
            (param[7] = new OracleParameter("p_IR_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_act;
            (param[8] = new OracleParameter("p_IR_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_is_def;
            (param[9] = new OracleParameter("p_IR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_cre_by;
            (param[10] = new OracleParameter("p_IR_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_cre_when;
            (param[11] = new OracleParameter("p_IR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_mod_by;
            (param[12] = new OracleParameter("p_IR_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_mod_when;
            (param[13] = new OracleParameter("p_IR_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseRow.Ir_session_id;
            param[14] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Row", CommandType.StoredProcedure, param);
            return _eff;
        }
        /*Warehouse Level*/
        public Tuple<int, int> SaveWarehouseLevel(WarehouseLevel _WarehouseLevel)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[17];


            (param[0] = new OracleParameter("p_IL_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_com_cd;
            (param[1] = new OracleParameter("p_IL_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_loc_cd;
            (param[2] = new OracleParameter("p_IL_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_zn_seq;
            (param[3] = new OracleParameter("p_IL_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_asl_seq;
            (param[4] = new OracleParameter("p_IL_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_row_seq;
            (param[5] = new OracleParameter("p_IL_LVL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_seq;
            (param[6] = new OracleParameter("p_IL_LVL_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_desc;
            (param[7] = new OracleParameter("p_IL_LVL_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_id;
            (param[8] = new OracleParameter("p_IL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_act;
            (param[9] = new OracleParameter("p_IL_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_is_def;
            (param[10] = new OracleParameter("p_IL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_cre_by;
            (param[11] = new OracleParameter("p_IL_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_cre_when;
            (param[12] = new OracleParameter("p_IL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_mod_by;
            (param[13] = new OracleParameter("p_IL_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_mod_when;
            (param[14] = new OracleParameter("p_IL_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_session_id;
            param[15] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Level", CommandType.StoredProcedure, param);
            if (!((OracleDecimal)param[15].Value).IsNull)
            {

                _autoNo = int.Parse(param[15].Value.ToString());
            }

            return new Tuple<int, int>(_eff, _autoNo);

        }
        public Int32 UpdateWarehouseLevel(WarehouseLevel _WarehouseLevel)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[17];


            (param[0] = new OracleParameter("p_IL_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_com_cd;
            (param[1] = new OracleParameter("p_IL_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_loc_cd;
            (param[2] = new OracleParameter("p_IL_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_zn_seq;
            (param[3] = new OracleParameter("p_IL_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_asl_seq;
            (param[4] = new OracleParameter("p_IL_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_row_seq;
            (param[5] = new OracleParameter("p_IL_LVL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_seq;
            (param[6] = new OracleParameter("p_IL_LVL_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_desc;
            (param[7] = new OracleParameter("p_IL_LVL_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_id;
            (param[8] = new OracleParameter("p_IL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_act;
            (param[9] = new OracleParameter("p_IL_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_is_def;
            (param[10] = new OracleParameter("p_IL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_cre_by;
            (param[11] = new OracleParameter("p_IL_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_cre_when;
            (param[12] = new OracleParameter("p_IL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_mod_by;
            (param[13] = new OracleParameter("p_IL_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_mod_when;
            (param[14] = new OracleParameter("p_IL_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_session_id;
            param[15] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Level", CommandType.StoredProcedure, param);

            return _eff;

        }
        public Tuple<int, int> SaveWarehouseLevelExcel(WarehouseLevel _WarehouseLevel)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[17];


            (param[0] = new OracleParameter("p_IL_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_com_cd;
            (param[1] = new OracleParameter("p_IL_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_loc_cd;
            (param[2] = new OracleParameter("p_IL_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_zn_seq;
            (param[3] = new OracleParameter("p_IL_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_asl_seq;
            (param[4] = new OracleParameter("p_IL_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_row_seq;
            (param[5] = new OracleParameter("p_IL_LVL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_seq;
            (param[6] = new OracleParameter("p_IL_LVL_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_desc;
            (param[7] = new OracleParameter("p_IL_LVL_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_lvl_id;
            (param[8] = new OracleParameter("p_IL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_act;
            (param[9] = new OracleParameter("p_IL_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_is_def;
            (param[10] = new OracleParameter("p_IL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_cre_by;
            (param[11] = new OracleParameter("p_IL_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_cre_when;
            (param[12] = new OracleParameter("p_IL_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_mod_by;
            (param[13] = new OracleParameter("p_IL_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_mod_when;
            (param[14] = new OracleParameter("p_IL_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseLevel.Il_session_id;
            param[15] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.SP_Save_Level", CommandType.StoredProcedure, param);
            _autoNo = int.Parse(param[15].Value.ToString());
            return new Tuple<int, int>(_eff, _autoNo);
        }

        public List<WarehouseZone> GetWarehouseZone(string _Com, string _Loc)
        {
            List<WarehouseZone> _WarehouseZone = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchWarehouseZone", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _WarehouseZone = DataTableExtensions.ToGenericList<WarehouseZone>(_dtResults, WarehouseZone.Converter);
            }
            return _WarehouseZone;
        }

        public List<WarehouseAisle> GetWarehouseAisle(string _Com, string _Loc, string _Zone)
        {
            List<WarehouseAisle> _WarehouseAisle = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_Zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Zone;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchWarehouseAisle", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _WarehouseAisle = DataTableExtensions.ToGenericList<WarehouseAisle>(_dtResults, WarehouseAisle.Converter);
            }
            return _WarehouseAisle;
        }
        public List<WarehouseRow> GetWarehouseRow(string _Com, string _Loc, string _Zseq, string _Aisle)
        {
            List<WarehouseRow> _WarehouseRow = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_Zseq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Zseq;
            (param[3] = new OracleParameter("p_Aisle", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Aisle;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchWarehouseRow", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _WarehouseRow = DataTableExtensions.ToGenericList<WarehouseRow>(_dtResults, WarehouseRow.Converter);
            }
            return _WarehouseRow;
        }
        public List<WarehouseLevel> GetWarehouseLevel(string _Com, string _Loc, string p_Zseq, string _Aseq, string Rseq)
        {
            List<WarehouseLevel> _WarehouseLevel = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_Zseq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_Zseq;
            (param[3] = new OracleParameter("p_Aseq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Aseq;
            (param[4] = new OracleParameter("p_Rseq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Rseq;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchWarehouseLevel", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _WarehouseLevel = DataTableExtensions.ToGenericList<WarehouseLevel>(_dtResults, WarehouseLevel.Converter);
            }
            return _WarehouseLevel;
        }

        public DataTable GetItemCate1_active(string _initialSearchParams, string _searchCatergory, string _searchText)
        {


            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_MainItemCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_searchItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetItemSubCate2_active(string _initialSearchParams, string _searchCatergory, string _searchText)
        {


            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[2] = new OracleParameter("p_MCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_searchSubCat2", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetItemSubCate3_active(string _initialSearchParams, string _searchCatergory, string _searchText)
        {


            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[2] = new OracleParameter("p_MCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_SubCat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_searchSubCat3", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetItemSubCate4_active(string _initialSearchParams, string _searchCatergory, string _searchText)
        {


            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[2] = new OracleParameter("p_MCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_SubCat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("p_SubCat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_searchSubCat4", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetItemSubCate5_active(string _initialSearchParams, string _searchCatergory, string _searchText)
        {


            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[2] = new OracleParameter("p_MCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_SubCat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("p_SubCat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_SubCat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_searchSubCat5", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetWarehouseStorage()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_searchstorage", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Tuple<int, int> SaveWarehouseBin(WarehouseBin _WarehouseBin)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[27];
            (param[0] = new OracleParameter("p_IBN_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_com_cd;
            (param[1] = new OracleParameter("p_IBN_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_loc_cd;
            (param[2] = new OracleParameter("p_IBN_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_zn_seq;
            (param[3] = new OracleParameter("p_IBN_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_asl_seq;
            (param[4] = new OracleParameter("p_IBN_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_row_seq;
            (param[5] = new OracleParameter("p_IBN_LVL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_lvl_seq;
            (param[6] = new OracleParameter("p_IBN_BIN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_bin_seq;
            (param[7] = new OracleParameter("p_IBN_BIN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_bin_cd;
            (param[8] = new OracleParameter("p_IBN_BIN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_bin_desc;
            (param[9] = new OracleParameter("p_IBN_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_act;
            (param[10] = new OracleParameter("p_IBN_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_is_def;
            (param[11] = new OracleParameter("p_IBN_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_cre_by;
            (param[12] = new OracleParameter("p_IBN_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_cre_when;
            (param[13] = new OracleParameter("p_IBN_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_mod_by;
            (param[14] = new OracleParameter("p_IBN_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_mod_when;
            (param[15] = new OracleParameter("p_IBN_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_session_id;
            (param[16] = new OracleParameter("p_IBN_WIDTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_width;
            (param[17] = new OracleParameter("p_IBN_LENGTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_length;
            (param[18] = new OracleParameter("p_IBN_HEIGHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_height;
            (param[19] = new OracleParameter("p_IBN_WEIGHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_weight;
            (param[20] = new OracleParameter("p_IBN_CAPACITY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_capacity;
            (param[21] = new OracleParameter("p_IBN_CAPACITY_USED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_capacity_used;
            (param[22] = new OracleParameter("p_ibn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_tp;
            (param[23] = new OracleParameter("p_ibn_diam_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_diam_uom;
            (param[24] = new OracleParameter("p_ibn_weight_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_weight_uom;
            param[25] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[26] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.sp_SaveBin", CommandType.StoredProcedure, param);
            if (param[25].IsNullable != false)
            {
                _autoNo = int.Parse(param[25].Value.ToString());
            }

            return new Tuple<int, int>(_eff, _autoNo);
        }
        public Int32 UpdateWarehouseBin(WarehouseBin _WarehouseBin)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[27];
            (param[0] = new OracleParameter("p_IBN_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_com_cd;
            (param[1] = new OracleParameter("p_IBN_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_loc_cd;
            (param[2] = new OracleParameter("p_IBN_ZN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_zn_seq;
            (param[3] = new OracleParameter("p_IBN_ASL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_asl_seq;
            (param[4] = new OracleParameter("p_IBN_ROW_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_row_seq;
            (param[5] = new OracleParameter("p_IBN_LVL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_lvl_seq;
            (param[6] = new OracleParameter("p_IBN_BIN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_bin_seq;
            (param[7] = new OracleParameter("p_IBN_BIN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_bin_cd;
            (param[8] = new OracleParameter("p_IBN_BIN_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_bin_desc;
            (param[9] = new OracleParameter("p_IBN_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_act;
            (param[10] = new OracleParameter("p_IBN_IS_DEF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_is_def;
            (param[11] = new OracleParameter("p_IBN_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_cre_by;
            (param[12] = new OracleParameter("p_IBN_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_cre_when;
            (param[13] = new OracleParameter("p_IBN_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_mod_by;
            (param[14] = new OracleParameter("p_IBN_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_mod_when;
            (param[15] = new OracleParameter("p_IBN_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_session_id;
            (param[16] = new OracleParameter("p_IBN_WIDTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_width;
            (param[17] = new OracleParameter("p_IBN_LENGTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_length;
            (param[18] = new OracleParameter("p_IBN_HEIGHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_height;
            (param[19] = new OracleParameter("p_IBN_WEIGHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_weight;
            (param[20] = new OracleParameter("p_IBN_CAPACITY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_capacity;
            (param[21] = new OracleParameter("p_IBN_CAPACITY_USED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_capacity_used;
            (param[22] = new OracleParameter("p_ibn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_tp;
            (param[23] = new OracleParameter("p_ibn_diam_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_diam_uom;
            (param[24] = new OracleParameter("p_ibn_weight_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _WarehouseBin.Ibn_weight_uom;
            param[25] = new OracleParameter("O_AUTONO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[26] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_imports.sp_SaveBin", CommandType.StoredProcedure, param);
            return _eff;
        }
        public Int32 SaveWarehouseBinStoreFacility(warehouseStorageFacility _warehouseStorageFacility)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_IBNS_BIN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_bin_seq;
            (param[1] = new OracleParameter("p_IBNS_STOR_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_stor_line;
            (param[2] = new OracleParameter("p_IBNS_STOR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_stor_cd;
            (param[3] = new OracleParameter("p_IBNS_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_act;
            (param[4] = new OracleParameter("p_IBNS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_cre_by;
            (param[5] = new OracleParameter("p_IBNS_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_cre_when;
            (param[6] = new OracleParameter("p_IBNS_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_mod_by;
            (param[7] = new OracleParameter("p_IBNS_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_mod_when;
            (param[8] = new OracleParameter("p_IBNS_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseStorageFacility.Ibns_session_id;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_imports.sp_SaveBinStore", CommandType.StoredProcedure, param);
            return _eff;
        }

        public Int32 SaveWarehouseBinItem(warehouseBinItems _warehouseBinItems)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_IBNI_BIN_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_bin_seq;
            (param[1] = new OracleParameter("p_IBNI_CAT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cat_line;
            (param[2] = new OracleParameter("p_IBNI_CAT_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cat_cd1;
            (param[3] = new OracleParameter("p_IBNI_CAT_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cat_cd2;
            (param[4] = new OracleParameter("p_IBNI_CAT_CD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cat_cd3;
            (param[5] = new OracleParameter("p_IBNI_CAT_CD4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cat_cd4;
            (param[6] = new OracleParameter("p_IBNI_CAT_CD5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cat_cd5;
            (param[7] = new OracleParameter("p_IBNI_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_act;
            (param[8] = new OracleParameter("p_IBNI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cre_by;
            (param[9] = new OracleParameter("p_IBNI_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_cre_when;
            (param[10] = new OracleParameter("p_IBNI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_mod_by;
            (param[11] = new OracleParameter("p_IBNI_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_mod_when;
            (param[12] = new OracleParameter("p_IBNI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseBinItems.Ibni_session_id;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_imports.sp_SaveBinItems", CommandType.StoredProcedure, param);
            return _eff;
        }

        public List<WarehouseBin> GetWarehouseBin(int Seq, string _Loc, string _Com, int _Zone, int _Aisle, int _Row, int _Level)
        {
            List<WarehouseBin> _WarehouseBin = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_BinSeq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("p_SCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[3] = new OracleParameter("p_ZONE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Zone;
            (param[4] = new OracleParameter("p_AISLE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Aisle;
            (param[5] = new OracleParameter("p_ROW", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Row;
            (param[6] = new OracleParameter("p_LEVEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Level;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchBin", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _WarehouseBin = DataTableExtensions.ToGenericList<WarehouseBin>(_dtResults, WarehouseBin.Converter);
            }
            return _WarehouseBin;
        }
        public List<warehouseBinItems> GetWarehouseBinItems(int Seq)
        {
            List<warehouseBinItems> _warehouseBinItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_BinSeq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchBinItems", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _warehouseBinItems = DataTableExtensions.ToGenericList<warehouseBinItems>(_dtResults, warehouseBinItems.Converter);
            }
            return _warehouseBinItems;
        }
        public List<warehouseStorageFacility> GetWarehouseBinStorage(int Seq)
        {
            List<warehouseStorageFacility> _warehouseStorageFacility = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_BinSeq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_searchBinStorageF", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _warehouseStorageFacility = DataTableExtensions.ToGenericList<warehouseStorageFacility>(_dtResults, warehouseStorageFacility.Converter);
            }
            return _warehouseStorageFacility;
        }

        //24/Aug/2015 Rukshan
        public DataTable GetWarehouseBinByLoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _BCode = null;
            string _BDes = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _BCode = _searchText; break;
                    case "DESCRIPTION": _BDes = _searchText; break;
                    default: break;
                }
            }

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_BCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BCode;
            (param[3] = new OracleParameter("p_BDes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BDes;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblBin", "pkg_search_imp.sp_searchBinByLoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //10/12/2015 Lakshan Get Cat4
        public DataTable GetItemSubCat4(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }
            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            _Code = (_Code != null) ? (_Code.ToUpper() + "%") : "%";
            _Desc = (_Desc != null) ? (_Desc.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[2] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_imports_Enquiry.SP_GET_CAT4", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //10/12/2015 Lakshan Get Cat5
        public DataTable GetItemSubCat5(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Code = null;
            string _Desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _Code = _searchText; break;
                    case "DESCRIPTION": _Desc = _searchText; break;
                    default: break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            _Code = (_Code != null) ? (_Code.ToUpper() + "%") : "%";
            _Desc = (_Desc != null) ? (_Desc.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[2] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[6] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_imports_Enquiry.SP_GET_CAT5", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        #region FastForwardSCMWeb

        //Sahan
        public Int32 UpdateSupplierCurrency(SupplierCurrency currency)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_mscu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_COM;
            (param[1] = new OracleParameter("p_mscu_sup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_SUP_CD;
            (param[2] = new OracleParameter("p_mscu_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_CUR_CD;
            (param[3] = new OracleParameter("p_mscu_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = currency.MSCU_ACT;
            (param[4] = new OracleParameter("p_mscu_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = currency.MSCU_DEF;
            (param[5] = new OracleParameter("p_mscu_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_CRE_BY;
            (param[6] = new OracleParameter("p_mscu_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = currency.MSCU_CRE_DT;
            (param[7] = new OracleParameter("p_mscu_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_MOD_BY;
            (param[8] = new OracleParameter("p_mscu_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = currency.MSCU_MOD_DT;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_supplier_currency", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan
        public Int32 DeactivateSupplierCurrency(SupplierCurrency currency)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_mscu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_COM;
            (param[1] = new OracleParameter("p_mscu_sup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_SUP_CD;
            (param[2] = new OracleParameter("p_mscu_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = currency.MSCU_ACT;
            (param[3] = new OracleParameter("p_mscu_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = currency.MSCU_MOD_BY;
            (param[4] = new OracleParameter("p_mscu_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = currency.MSCU_MOD_DT;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_deact_sup_currency", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan
        public Int32 UpdateSupplierPorts(SupplierPort port)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_mspr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_COM;
            (param[1] = new OracleParameter("p_mspr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_CD;
            (param[2] = new OracleParameter("p_mspr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_TP;
            (param[3] = new OracleParameter("p_mspr_frm_port", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_FRM_PORT;
            (param[4] = new OracleParameter("p_mspr_to_port", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_TO_PORT;
            (param[5] = new OracleParameter("p_mspr_lead_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = port.MSPR_LEAD_TIME;
            (param[6] = new OracleParameter("p_mspr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = port.MSPR_ACT;
            (param[7] = new OracleParameter("p_mspr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_CRE_BY;
            (param[8] = new OracleParameter("p_mspr_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = port.MSPR_CRE_DT;
            (param[9] = new OracleParameter("p_mspr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_MOD_BY;
            (param[10] = new OracleParameter("p_mspr_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = port.MSPR_MOD_DT;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_supplier_ports", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan
        public Int32 DeactivateSupplierPorts(SupplierPort port)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_mspr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_COM;
            (param[1] = new OracleParameter("p_mspr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_CD;
            (param[2] = new OracleParameter("p_mspr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = port.MSPR_ACT;
            (param[3] = new OracleParameter("p_mspr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = port.MSPR_MOD_BY;
            (param[4] = new OracleParameter("p_mspr_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = port.MSPR_MOD_DT;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_deact_sup_port", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan
        public Int32 DeactivateSupplierItems(BusEntityItem _item)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_mbii_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_COM;
            (param[1] = new OracleParameter("p_mbii_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_CD;
            (param[2] = new OracleParameter("p_mbii_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.MBII_ACT;
            (param[3] = new OracleParameter("p_mbii_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_MOD_BY;
            (param[4] = new OracleParameter("p_mbii_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.MBII_MOD_DT;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_deact_sup_items", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan
        public Int32 UpdateSupplierItems(BusEntityItem _item)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_mbii_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_COM;
            (param[1] = new OracleParameter("p_mbii_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_CD;
            (param[2] = new OracleParameter("p_mbii_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_TP;
            (param[3] = new OracleParameter("p_mbii_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_ITM_CD;
            (param[4] = new OracleParameter("p_mbii_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.MBII_ACT;
            (param[5] = new OracleParameter("p_mbii_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_CRE_BY;
            (param[6] = new OracleParameter("p_mbii_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.MBII_CRE_DT;
            (param[7] = new OracleParameter("p_mbii_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.MBII_MOD_BY;
            (param[8] = new OracleParameter("p_mbii_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.MBII_MOD_DT;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_supplier_items", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan
        public Int32 UpdateSupplierTax(BusEntityTax _tax)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_mbit_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_COM;
            (param[1] = new OracleParameter("p_mbit_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_CD;
            (param[2] = new OracleParameter("p_mbit_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_TP;
            (param[3] = new OracleParameter("p_mbit_tax_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_TAX_CD;
            (param[4] = new OracleParameter("p_mbit_tax_rt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_TAX_RT_CD;
            (param[5] = new OracleParameter("p_mbit_tax_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tax.MBIT_TAX_RT;
            (param[6] = new OracleParameter("p_mbit_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tax.MBIT_ACT;
            (param[7] = new OracleParameter("p_mbit_effct_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tax.MBIT_EFFCT_DT;
            (param[8] = new OracleParameter("p_mbit_div_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tax.MBIT_DIV_RT;
            (param[9] = new OracleParameter("p_mbit_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_CRE_BY;
            (param[10] = new OracleParameter("p_mbit_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tax.MBIT_CRE_DT;
            (param[11] = new OracleParameter("p_mbit_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tax.MBIT_MOD_BY;
            (param[12] = new OracleParameter("p_mbit_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tax.MBIT_MOD_DT;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_supplier_tax", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }


        #endregion
        //11/12/2015 Rukshan
        public Int32 SaveDemurrage(DemurrageTracker Tracker)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_idi_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_com;
            (param[1] = new OracleParameter("P_idi_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_doc_no;
            (param[2] = new OracleParameter("P_idi_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_tp;
            (param[3] = new OracleParameter("P_idi_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_rmk;
            (param[4] = new OracleParameter("P_idi_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Tracker.idi_act;
            (param[5] = new OracleParameter("P_idi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_cre_by;
            (param[6] = new OracleParameter("P_idi_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Tracker.idi_cre_dt;
            (param[7] = new OracleParameter("P_idi_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_cre_session;
            (param[8] = new OracleParameter("P_idi_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_mod_by;
            (param[9] = new OracleParameter("P_idi_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Tracker.idi_mod_dt;
            (param[10] = new OracleParameter("P_idi_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_mod_session;
            (param[11] = new OracleParameter("P_idi_act_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_act_by;
            (param[12] = new OracleParameter("P_idi_act_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Tracker.idi_act_dt;
            (param[13] = new OracleParameter("P_idi_act_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Tracker.idi_act_session;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("pkg_imports_enquiry.sp_savedemu_infor", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 16/12/2015
        public Int32 SaveHsCode(HsCode hsCode)
        {
            OracleParameter[] param = new OracleParameter[22];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_mhc_frm_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_frm_cnty;
            (param[1] = new OracleParameter("p_mhc_to_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_to_cnty;
            (param[2] = new OracleParameter("p_mhc_hs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_hs_cd;
            (param[3] = new OracleParameter("p_mhc_hs_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_hs_desc;
            (param[4] = new OracleParameter("p_mhc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_tp;
            (param[5] = new OracleParameter("p_mhc_cost_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_cat;
            (param[6] = new OracleParameter("p_mhc_cost_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_tp;
            (param[7] = new OracleParameter("p_mhc_cost_ele", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_ele;
            (param[8] = new OracleParameter("p_mhc_cost_ele_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_ele_amt;
            (param[9] = new OracleParameter("p_mhc_custom__price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hsCode.Mhc_custom__price;
            (param[10] = new OracleParameter("p_mhc_weight_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hsCode.Mhc_weight_price;
            (param[11] = new OracleParameter("p_mhc_mp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hsCode.Mhc_mp;
            (param[12] = new OracleParameter("p_mhc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hsCode.Mhc_act;
            (param[13] = new OracleParameter("p_mhc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cre_by;
            (param[14] = new OracleParameter("p_mhc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hsCode.Mhc_cre_dt;
            (param[15] = new OracleParameter("p_mhc_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cre_session;
            (param[16] = new OracleParameter("p_mhc_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_mod_by;
            (param[17] = new OracleParameter("p_mhc_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hsCode.Mhc_mod_dt;
            (param[18] = new OracleParameter("p_mhc_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_mod_session;
            (param[19] = new OracleParameter("p_mhc_cce", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hsCode.Mhc_cce;
            (param[20] = new OracleParameter("p_mhc_cce_clm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hsCode.Mhc_cce_clm;
            param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_SAVE_HS_CODE2", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 17/12/2015
        public Int32 SaveHsCodeClaim(HsCodeClaim hsCodeClaim)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_mhcl_frm_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_frm_cnty;
            (param[1] = new OracleParameter("p_mhcl_to_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_to_cnty;
            (param[2] = new OracleParameter("p_mhcl_hs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_hs_cd;
            (param[3] = new OracleParameter("p_mhcl_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_tp;
            (param[4] = new OracleParameter("p_mhcl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_com;
            (param[5] = new OracleParameter("p_mhcl_cost_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_cost_cat;
            (param[6] = new OracleParameter("p_mhcl_cost_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_cost_tp;
            (param[7] = new OracleParameter("p_mhcl_cost_ele", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_cost_ele;
            (param[8] = new OracleParameter("p_mhcl_claim_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_claim_rt;
            (param[9] = new OracleParameter("p_mhcl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_act;
            (param[10] = new OracleParameter("p_mhcl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_cre_by;
            (param[11] = new OracleParameter("p_mhcl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_cre_dt;
            (param[12] = new OracleParameter("p_mhcl_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_cre_session;
            (param[13] = new OracleParameter("p_mhcl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_mod_by;
            (param[14] = new OracleParameter("p_mhcl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_mod_dt;
            (param[15] = new OracleParameter("p_mhcl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCodeClaim.Mhcl_mod_session;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("pkg_imports_enquiry.SP_SAVE_HS_CODE_CLAIM", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 13-01-2016
        public Int32 UpdateSupplierPort(SupplierPort _port)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_MSPR_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_COM;
            (param[1] = new OracleParameter("p_MSPR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_CD;
            (param[2] = new OracleParameter("p_MSPR_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_TP;
            (param[3] = new OracleParameter("p_MSPR_FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_FRM_PORT;
            (param[4] = new OracleParameter("p_MSPR_TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_TO_PORT;
            (param[5] = new OracleParameter("p_MSPR_LEAD_TIME", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _port.MSPR_LEAD_TIME;
            (param[6] = new OracleParameter("p_mbii_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _port.MSPR_ACT;
            (param[7] = new OracleParameter("p_MSPR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_CRE_BY;
            (param[8] = new OracleParameter("p_MSPR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _port.MSPR_CRE_DT;
            (param[9] = new OracleParameter("p_MSPR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_MOD_BY;
            (param[10] = new OracleParameter("p_MSPR_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _port.MSPR_MOD_DT;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //  ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_imports_Enquiry.sp_update_supplier_port", CommandType.StoredProcedure, param);
            //  ConnectionClose();
            return _eff;
        }

        //Rukshan 2015-12-28
        public int SAVE_ITM_PREFIX(ItemPrefix Item)
        {
            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0; ;
            (param[0] = new OracleParameter("P_MIP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MIP_COM;
            (param[1] = new OracleParameter("p_MIP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MIP_CD;
            (param[2] = new OracleParameter("p_MI_PREFIX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MI_PREFIX;
            (param[3] = new OracleParameter("p_MI_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MI_DESC;
            (param[4] = new OracleParameter("p_MI_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Item.MI_ACT;
            (param[5] = new OracleParameter("p_MI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MI_CRE_BY;
            (param[6] = new OracleParameter("p_MI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = Item.MI_CRE_DT;
            (param[7] = new OracleParameter("p_MI_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MI_CRE_SESSION;
            (param[8] = new OracleParameter("p_MI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MI_MOD_BY;
            (param[9] = new OracleParameter("p_MI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = Item.MI_MOD_DT;
            (param[10] = new OracleParameter("p_MI_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item.MI_MOD_SESSION;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("pkg_inventory.sp_save_itm_Prefix", CommandType.StoredProcedure, param);
            return effects;
        }
        //Rukshan 2015-12-28
        public List<ItemPrefix> GET_ITM_PREFIX(string _itm)
        {
            List<ItemPrefix> _ItemPrefix = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_get_itmby_PreFix_", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ItemPrefix = DataTableExtensions.ToGenericList<ItemPrefix>(_dtResults, ItemPrefix.Converter);
            }
            return _ItemPrefix;
        }

        //Lakshan 2015/12/28
        public List<BusEntityItem> GetBuninessEntityItemBySupplier(string _comp, string _code)
        {
            List<BusEntityItem> _ListItems = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mbii_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_mbii_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_imports_Enquiry.SP_GET_SUPPLIER_ITEMS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<BusEntityItem>(_dtResults, BusEntityItem.Converter);
            }
            return _ListItems;
        }
        //Rukshan 2015/12/29
        public DataTable GetBinType()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.SP_GetBinType", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Rukshan 2015/12/29
        public DataTable[] GetITEMCOST(string _com, string _Ord, string _item, string _model, string _status, int _row, string _bl)
        {
            DataTable DutyPaidTbl = new DataTable();
            DataTable DutyFree_PalTbl = new DataTable();
            DataTable DutyFreeTbl = new DataTable();
            DutyPaidTbl = null;
            DutyFree_PalTbl = null;
            DutyFreeTbl = null;
            if (_Ord == "A")
            {
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("P_ORDERFROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Ord;
                (param[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param[5] = new OracleParameter("P_ROW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _row;
                (param[6] = new OracleParameter("p_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
                param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DutyPaidTbl = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTY_P_ITEMCOST", CommandType.StoredProcedure, false, param);

                OracleParameter[] param2 = new OracleParameter[8];
                (param2[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param2[1] = new OracleParameter("P_ORDERFROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Ord;
                (param2[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param2[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param2[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param2[5] = new OracleParameter("P_ROW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _row;
                (param2[6] = new OracleParameter("p_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
                param2[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DutyFree_PalTbl = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTYFREE_P_ITEMCOST", CommandType.StoredProcedure, false, param2);

                OracleParameter[] param3 = new OracleParameter[8];
                (param3[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param3[1] = new OracleParameter("P_ORDERFROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Ord;
                (param3[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param3[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param3[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param3[5] = new OracleParameter("P_ROW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _row;
                (param3[6] = new OracleParameter("p_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
                param3[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DutyFreeTbl = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTYFREE_ITEMCOST", CommandType.StoredProcedure, false, param3);
            }
            else if (_Ord == "L")
            {
                OracleParameter[] param4 = new OracleParameter[8];
                (param4[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param4[1] = new OracleParameter("P_ORDERFROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Ord;
                (param4[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param4[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param4[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param4[5] = new OracleParameter("P_ROW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _row;
                (param4[6] = new OracleParameter("p_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
                param4[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DutyPaidTbl = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTY_P_ITEMCOST", CommandType.StoredProcedure, false, param4);
            }
            else if (_Ord == "I")
            {
                OracleParameter[] param5 = new OracleParameter[8];
                (param5[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param5[1] = new OracleParameter("P_ORDERFROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Ord;
                (param5[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param5[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param5[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param5[5] = new OracleParameter("P_ROW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _row;
                (param5[6] = new OracleParameter("p_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
                param5[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DutyFree_PalTbl = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTYFREE_P_ITEMCOST", CommandType.StoredProcedure, false, param5);

                OracleParameter[] param6 = new OracleParameter[7];
                (param6[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param6[1] = new OracleParameter("P_ORDERFROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Ord;
                (param6[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param6[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param6[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
                (param6[5] = new OracleParameter("P_ROW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _row;
                (param6[6] = new OracleParameter("p_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
                param6[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DutyFreeTbl = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTYFREE_ITEMCOST", CommandType.StoredProcedure, false, param6);
            }
            // DutyPaidTbl.Merge(DutyFree_PalTbl);
            // DutyPaidTbl.Merge(DutyFreeTbl);
            // DutyPaidTbl.Merge(DutyFree_PalTbl);
            // DutyPaidTbl.Merge(DutyFreeTbl);
            // return DutyPaidTbl;
            return new DataTable[] { DutyPaidTbl, DutyFree_PalTbl, DutyFreeTbl };
        }

        //Randima 11 Aug 2016
        public DataTable checkOrdType(string ordNo)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_PO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ordNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_search_ord_type", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Randima 20 Jul 2016
        public DataTable SearchPurOrdCostingDet(string _initialSearchParams, string _PONo, string _item, string _model, string searchType, DateTime? _frmDt, DateTime? _toDt)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            _PONo = !string.IsNullOrEmpty(_PONo) ? _PONo : "%";
            _item = !string.IsNullOrEmpty(_item) ? _item : "%";
            _model = !string.IsNullOrEmpty(_model) ? _model : "%";

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_PO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("P_S_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchType;
            (param[5] = new OracleParameter("P_FRM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[6] = new OracleParameter("P_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_search_PurchaseOrder_Det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Randima 20 Jul 2016
        public DataTable SearchLatestPriceBooks(string _initialSearchParams, string _item, string _status)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_PRICE_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_search_latest_pbook", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Randima 21 Jul 2016
        public DataTable SearchLatestOrders(string _item, string _tp)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[3];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_search_latest_orders", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Randima 21 Jul 2016
        public DataTable SearchPriceForGPCal(string _item, string _status, DateTime _frmDt, DateTime _toDt)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[5];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("P_FRM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[3] = new OracleParameter("P_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_search_price_GP", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Randima 26 Jul 2016
        public DataTable SerachBLOrdDet(string _blNo, string _item, string serachType, DateTime? _frmDt, DateTime? _toDt, string com)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[7];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_BL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blNo;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_S_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serachType;
            (param[3] = new OracleParameter("P_FRM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[4] = new OracleParameter("P_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            (param[5] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "sp_search_bl_detnew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        // Randima 26 Jul 2016
        public DataTable SerachBLOrdDet2(string _blNo, string _item, string serachType, DateTime? _frmDt, DateTime? _toDt, string com)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[7];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_BL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blNo;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_S_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serachType;
            (param[3] = new OracleParameter("P_FRM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt;
            (param[4] = new OracleParameter("P_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt;
            (param[5] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "sp_search_bl_detnew2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // Randima 19 DEC 2016
        public DataTable GetItmCostDetail(string _item, string com, string type, string reccount, string status)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_count", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reccount;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (type == "GRN")
            {
                _dtResults = QueryDataTable("tblItem", "SP_GET_ITM_COSTDETGRN", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tblItem", "SP_GET_ITM_COSTDET", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }

        // Randima 10 Aug 2016
        public DataTable GetVATRate(string _com, string _item)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[3];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_get_itm_vat_rt", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Rukshan 2015/12/29
        public DataTable GetDUTYPRICE_BYITEM(string _com, string _item, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.SP_GET_DUTY_PRICE_ITM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Rukshan 2016/1/2
        public DataTable GETLOGISTIC_COST(string _com, string _item, string _doc)
        {
            List<INT_BATCHLOGICOST> _ListItems = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_search_imp.SP_GETLOGISTIC_COST", CommandType.StoredProcedure, false, param);

            //if (_dtResults.Rows.Count > 0)
            //{
            //    _ListItems = DataTableExtensions.ToGenericList<INT_BATCHLOGICOST>(_dtResults, INT_BATCHLOGICOST.Converter);
            //}
            return _dtResults;
        }

        //Sahan 06 Jan 2016
        public Int32 SaveRoutes(RouteHeader Header)
        {
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_frh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.FRH_CD;
            (param[1] = new OracleParameter("p_frh_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.FRH_DESC;
            (param[2] = new OracleParameter("p_frh_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.FRH_CAT;
            (param[3] = new OracleParameter("p_frh_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Header.FRH_ACT;
            (param[4] = new OracleParameter("p_frh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.FRH_CRE_BY;
            (param[5] = new OracleParameter("p_frh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Header.FRH_CRE_DT;
            (param[6] = new OracleParameter("p_frh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.FRH_MOD_BY;
            (param[7] = new OracleParameter("p_frh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Header.FRH_MOD_DT;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_general.sp_save_routes", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 06 Jan 2016
        public Int32 AssignWareHouses(RouteWareHouse Warehouse)
        {
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_frw_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_CD;
            (param[1] = new OracleParameter("p_frw_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_WH_COM;
            (param[2] = new OracleParameter("p_frw_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_WH_CD;
            (param[3] = new OracleParameter("p_frw_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_COM_CD;
            (param[4] = new OracleParameter("p_frw_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_LOC_CD;
            (param[5] = new OracleParameter("p_frw_route_distance", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Warehouse.FRW_ROUTE_DISTANCE;
            (param[6] = new OracleParameter("p_frw_route_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_ROUTE_UOM;
            (param[7] = new OracleParameter("p_frw_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Warehouse.FRW_ACT;
            (param[8] = new OracleParameter("p_frw_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_CRE_BY;
            (param[9] = new OracleParameter("p_frw_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Warehouse.FRW_CRE_DT;
            (param[10] = new OracleParameter("p_frw_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warehouse.FRW_CRE_SESSION;

            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_general.sp_assign_warehouse", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 06 Jan 2016
        public Int32 AssignLocations(RouteShowRooms ShowRoom)
        {
            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_frs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ShowRoom.FRS_CD;
            (param[1] = new OracleParameter("p_frs_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ShowRoom.FRS_LINE;
            (param[2] = new OracleParameter("p_frs_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ShowRoom.FRS_COM_CD;
            (param[3] = new OracleParameter("p_frs_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ShowRoom.FRS_LOC_CD;
            (param[4] = new OracleParameter("p_frs_distance", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ShowRoom.FRS_DISTANCE;
            (param[5] = new OracleParameter("p_frs_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ShowRoom.FRS_UOM;
            (param[6] = new OracleParameter("p_frs_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ShowRoom.FRS_ACT;
            (param[7] = new OracleParameter("p_frs_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ShowRoom.FRS_CRE_BY;
            (param[8] = new OracleParameter("p_frs_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ShowRoom.FRS_CRE_DT;
            (param[9] = new OracleParameter("p_frs_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ShowRoom.FRS_CRE_SESSION;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_general.sp_assign_locations", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 06 Jan 2016
        public Int32 CreateSchedule(RouteSchedule Schedule)
        {
            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_frsh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Schedule.FRSH_CD;
            (param[1] = new OracleParameter("p_frsh_shed_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Schedule.FRSH_SHED_DT;
            (param[2] = new OracleParameter("p_frsh_shed_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Schedule.FRSH_SHED_DESC;
            (param[3] = new OracleParameter("p_frsh_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Schedule.FRSH_ACT;
            (param[4] = new OracleParameter("p_frsh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Schedule.FRSH_CRE_BY;
            (param[5] = new OracleParameter("p_frsh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Schedule.FRSH_CRE_DT;
            (param[6] = new OracleParameter("p_frsh_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Schedule.FRSH_CRE_SESSION;
            (param[7] = new OracleParameter("p_frsh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Schedule.FRSH_MOD_BY;
            (param[8] = new OracleParameter("p_frsh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Schedule.FRSH_MOD_DT;
            (param[9] = new OracleParameter("p_frsh_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Schedule.FRSH_MOD_SESSION;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_general.sp_save_route_schedule", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 09 Jan 2016
        public DataTable SearchRoutes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ROUTE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            code = (code != null) ? (code.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_frh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[1] = new OracleParameter("p_frh_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;

            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("flt_route_hdr", "pkg_general.sp_search_routes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 11 Jan 2016
        public DataTable LoadRouteSchedules(string p_route_code)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_route_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_route_code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("flt_route_shedule", "pkg_general.sp_load_route_schedules", CommandType.StoredProcedure, false, param);
        }

        //Sahan 11 Jan 2016
        public DataTable LoadRouteWareHouses(string p_route_code)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_route_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_route_code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("flt_route_wh", "pkg_general.sp_load_route_warehouses", CommandType.StoredProcedure, false, param);
        }

        //Sahan 11 Jan 2016
        public DataTable LoadRouteLocations(string p_route_code)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_route_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_route_code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("flt_route_sr", "pkg_general.sp_load_route_locations", CommandType.StoredProcedure, false, param);
        }

        //Sahan 11 Jan 2016
        public DataTable SearchWareHouses(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string company = null;
            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WH_COMPANY":
                        company = _searchText;
                        break;

                    case "CODE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            company = (company != null) ? (company.ToUpper()) : null;
            code = (code != null) ? (code.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mw_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_mw_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_mw_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;

            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_wh", "pkg_general.sp_search_warehouses", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 11 Jan 2016
        public DataTable SearchCompanies(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string company = null;
            string code = null;
            string loc = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "COMPANY":
                        company = _searchText;
                        break;

                    case "WH_COMPANY_CODE":
                        code = _searchText;
                        break;

                    case "LOCATION":
                        loc = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            company = (company != null) ? (company.ToUpper()) : null;
            code = (code != null) ? (code.ToUpper()) : null;
            loc = (loc != null) ? (loc.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_ml_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[3] = new OracleParameter("p_ml_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            (param[4] = new OracleParameter("p_selectedcompany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];

            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_loc", "pkg_general.sp_search_companies", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public List<CusdecTypes> GetCusdecEntryTypes(string _country)
        {
            List<CusdecTypes> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _country;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_CUSDEC_TP", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0) _ListItems = DataTableExtensions.ToGenericList<CusdecTypes>(_dtResults, CusdecTypes.Converter);
            return _ListItems;
        }

        public CusdecSubTypes GetCusdecEntrySubTypes(string _country, string _type, string _subType)
        {
            CusdecSubTypes _ListItems = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _country;
            (param[1] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("P_STP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_CUSDEC_STP", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0) _ListItems = DataTableExtensions.ToGenericList<CusdecSubTypes>(_dtResults, CusdecSubTypes.Converter)[0];
            return _ListItems;
        }

        /* 13/01/2016 Lakshan  get port data by code */
        public DataTable GET_PORT_DATA_BY_CD(string code)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_mp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = QueryDataTable("tbl", "pkg_imports_Enquiry.SP_GET_PORT_DATA_BY_CODE", CommandType.StoredProcedure, false, param);
            return result;

        }

        //Lakshan 2016/01/13
        public List<SupplierPort> GetSupplierPort(SupplierPort _port)
        {
            List<SupplierPort> _ListItems = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_MSPR_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_COM;
            (param[1] = new OracleParameter("p_MSPR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_CD;
            (param[2] = new OracleParameter("p_MSPR_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_TP;
            (param[3] = new OracleParameter("p_MSPR_FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_FRM_PORT;
            (param[4] = new OracleParameter("p_MSPR_TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port.MSPR_TO_PORT;
            (param[5] = new OracleParameter("p_MSPR_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _port.MSPR_ACT;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_imports_Enquiry.SP_GET_SUPPLIER_PORT", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<SupplierPort>(_dtResults, SupplierPort.Converter);
            }
            return _ListItems;
        }

        //Lakshan 22/01/2016
        public Int32 SaveWarrAmendReq(WarrantyAmendRequest war)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_Rwr_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = war.Rwr_seq;
            (param[1] = new OracleParameter("p_Rwr_req_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_req_by;
            (param[2] = new OracleParameter("p_Rwr_req_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = war.Rwr_req_dt;
            (param[3] = new OracleParameter("p_Rwr_req_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_req_session;
            (param[4] = new OracleParameter("p_Rwr_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_ser_id;
            (param[5] = new OracleParameter("p_Rwr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_stus;
            (param[6] = new OracleParameter("p_Rwr_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_app_by;
            (param[7] = new OracleParameter("p_Rwr_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = war.Rwr_app_dt;
            (param[8] = new OracleParameter("p_Rwr_app_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_app_session;
            (param[9] = new OracleParameter("p_Rwr_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = war.Rwr_warr_period;
            (param[10] = new OracleParameter("p_Rwr_warr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_warr_rmk;
            (param[11] = new OracleParameter("p_Rwr_st_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = war.Rwr_st_dt;
            (param[12] = new OracleParameter("p_Rwr_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_cust_cd;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_imports_Enquiry.SP_SAVE_WARR_AMEND_REQ", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 22/01/2016
        public Int32 UpdateWarrAmendReq(WarrantyAmendRequest war)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_Rwr_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = war.Rwr_seq;
            (param[1] = new OracleParameter("p_Rwr_req_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_req_by;
            (param[2] = new OracleParameter("p_Rwr_req_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = war.Rwr_req_dt;
            (param[3] = new OracleParameter("p_Rwr_req_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_req_session;
            (param[4] = new OracleParameter("p_Rwr_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_ser_id;
            (param[5] = new OracleParameter("p_Rwr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_stus;
            (param[6] = new OracleParameter("p_Rwr_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_app_by;
            (param[7] = new OracleParameter("p_Rwr_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = war.Rwr_app_dt;
            (param[8] = new OracleParameter("p_Rwr_app_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_app_session;
            (param[9] = new OracleParameter("p_Rwr_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = war.Rwr_warr_period;
            (param[10] = new OracleParameter("p_Rwr_warr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_warr_rmk;
            (param[11] = new OracleParameter("p_Rwr_st_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = war.Rwr_st_dt;
            (param[12] = new OracleParameter("p_Rwr_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war.Rwr_cust_cd;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_imports_Enquiry.SP_UPDATE_WARR_AMEND_REQ", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 25/01/2016
        public Int32 SaveSerialMasterLog(SerialMasterLog obj)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[73];
            (param[0] = new OracleParameter("p_Irsm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Irsm_seq;
            (param[1] = new OracleParameter("p_Irsm_log_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_log_by;
            (param[2] = new OracleParameter("p_Irsm_log_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_log_dt;
            (param[3] = new OracleParameter("p_Irsm_log_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_log_session;
            (param[4] = new OracleParameter("p_Irsm_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Irsm_ser_id;
            (param[5] = new OracleParameter("p_Irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_com;
            (param[6] = new OracleParameter("p_Irsm_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_sbu;
            (param[7] = new OracleParameter("p_Irsm_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_channel;
            (param[8] = new OracleParameter("p_Irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_loc;
            (param[9] = new OracleParameter("p_Irsm_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_loc_desc;
            (param[10] = new OracleParameter("p_Irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_doc_no;
            (param[11] = new OracleParameter("p_Irsm_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_doc_dt;
            (param[12] = new OracleParameter("p_Irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_invoice_no;
            (param[13] = new OracleParameter("p_Irsm_invoice_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_invoice_dt;
            (param[14] = new OracleParameter("p_Irsm_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_acc_no;
            (param[15] = new OracleParameter("p_Irsm_doc_year", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_doc_year;
            (param[16] = new OracleParameter("p_Irsm_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_direct;
            (param[17] = new OracleParameter("p_Irsm_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_itm_cd;
            (param[18] = new OracleParameter("p_Irsm_itm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_itm_brand;
            (param[19] = new OracleParameter("p_Irsm_itm_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_itm_model;
            (param[20] = new OracleParameter("p_Irsm_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_itm_desc;
            (param[21] = new OracleParameter("p_Irsm_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_itm_stus;
            (param[22] = new OracleParameter("p_Irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_ser_1;
            (param[23] = new OracleParameter("p_Irsm_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_ser_2;
            (param[24] = new OracleParameter("p_Irsm_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_ser_3;
            (param[25] = new OracleParameter("p_Irsm_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_ser_4;
            (param[26] = new OracleParameter("p_Irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_warr_no;
            (param[27] = new OracleParameter("p_Irsm_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_mfc;
            (param[28] = new OracleParameter("p_Irsm_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = obj.Irsm_unit_cost;
            (param[29] = new OracleParameter("p_Irsm_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = obj.Irsm_unit_price;
            (param[30] = new OracleParameter("p_Irsm_warr_start_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_warr_start_dt;
            (param[31] = new OracleParameter("p_Irsm_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Irsm_warr_period;
            (param[32] = new OracleParameter("p_Irsm_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_warr_rem;
            (param[33] = new OracleParameter("p_Irsm_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_cd;
            (param[34] = new OracleParameter("p_Irsm_cust_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_prefix;
            (param[35] = new OracleParameter("p_Irsm_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_name;
            (param[36] = new OracleParameter("p_Irsm_cust_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_addr;
            (param[37] = new OracleParameter("p_Irsm_cust_del_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_del_addr;
            (param[38] = new OracleParameter("p_Irsm_cust_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_town;
            (param[39] = new OracleParameter("p_Irsm_cust_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_tel;
            (param[40] = new OracleParameter("p_Irsm_cust_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_mobile;
            (param[41] = new OracleParameter("p_Irsm_cust_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_fax;
            (param[42] = new OracleParameter("p_Irsm_cust_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_email;
            (param[43] = new OracleParameter("p_Irsm_cust_vat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_vat_no;
            (param[44] = new OracleParameter("p_Irsm_orig_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_orig_grn_com;
            (param[45] = new OracleParameter("p_Irsm_orig_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_orig_grn_no;
            (param[46] = new OracleParameter("p_Irsm_orig_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_orig_grn_dt;
            (param[47] = new OracleParameter("p_Irsm_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_orig_supp;
            (param[48] = new OracleParameter("p_Irsm_exist_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_exist_grn_com;
            (param[49] = new OracleParameter("p_Irsm_exist_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_exist_grn_no;
            (param[50] = new OracleParameter("p_Irsm_exist_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_exist_grn_dt;
            (param[51] = new OracleParameter("p_Irsm_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_exist_supp;
            (param[52] = new OracleParameter("p_Irsm_warr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_warr_stus;
            (param[53] = new OracleParameter("p_Irsm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cre_by;
            (param[54] = new OracleParameter("p_Irsm_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_cre_when;
            (param[55] = new OracleParameter("p_Irsm_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_mod_by;
            (param[56] = new OracleParameter("p_Irsm_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_mod_when;
            (param[57] = new OracleParameter("p_Irsm_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_session_id;
            (param[58] = new OracleParameter("p_Irsm_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_anal_1;
            (param[59] = new OracleParameter("p_Irsm_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_anal_2;
            (param[60] = new OracleParameter("p_Irsm_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_anal_3;
            (param[61] = new OracleParameter("p_Irsm_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_anal_4;
            (param[62] = new OracleParameter("p_Irsm_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_anal_5;
            (param[63] = new OracleParameter("p_Irsm_rec_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_rec_com;
            (param[64] = new OracleParameter("p_Irsm_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_reg_no;
            (param[65] = new OracleParameter("p_Irsm_sup_warr_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Irsm_sup_warr_pd;
            (param[66] = new OracleParameter("p_Irsm_sup_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_sup_warr_rem;
            (param[67] = new OracleParameter("p_Irsm_sup_warr_stdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_sup_warr_stdt;
            (param[68] = new OracleParameter("p_Irsm_add_warr_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Irsm_add_warr_pd;
            (param[69] = new OracleParameter("p_Irsm_add_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_add_warr_rem;
            (param[70] = new OracleParameter("p_Irsm_add_warr_stdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_add_warr_stdt;
            (param[71] = new OracleParameter("p_Irsm_add_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_add_rec;
            param[72] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_imports_Enquiry.SP_SAVE_SERIAL_MASTER_LOG", CommandType.StoredProcedure, param);
            // effects = (Int32)UpdateRecords("SP_SAVE_SERIAL_MASTER_LOG", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 25/01/2016
        public Int32 UpdateWarrantyMasterAmend(InventoryWarrantyDetail obj)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_irsm_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_ser_id;
            (param[1] = new OracleParameter("p_irsm_warr_start_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = obj.Irsm_warr_start_dt;
            (param[2] = new OracleParameter("p_irsm_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Irsm_warr_period;
            (param[3] = new OracleParameter("p_irsm_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_warr_rem;
            (param[4] = new OracleParameter("p_irsm_cust_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_addr;
            (param[5] = new OracleParameter("p_irsm_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_cd;
            (param[6] = new OracleParameter("p_irsm_cust_del_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_del_addr;
            (param[7] = new OracleParameter("p_irsm_cust_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_email;
            (param[8] = new OracleParameter("p_irsm_cust_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_fax;
            (param[9] = new OracleParameter("p_irsm_cust_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_mobile;
            (param[10] = new OracleParameter("p_irsm_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_name;
            (param[11] = new OracleParameter("p_irsm_cust_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_prefix;
            (param[12] = new OracleParameter("p_irsm_cust_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_tel;
            (param[13] = new OracleParameter("p_irsm_cust_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_town;
            (param[14] = new OracleParameter("p_irsm_cust_vat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Irsm_cust_vat_no;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //  effects = (Int32)UpdateRecords("pkg_imports_Enquiry.SP_SAVE_SERIAL_MASTER_LOG", CommandType.StoredProcedure, param);
            effects = (Int32)UpdateRecords("pkg_imports_Enquiry.SP_UPDATE_WARR_MST_AMEND", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 25/01/2016
        public WarrantyAmendRequest GetWarrantyAmendReqData(WarrantyAmendRequest obj)
        {
            List<WarrantyAmendRequest> _ListItems = null;
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_irsm_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Rwr_seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_imports_Enquiry.SP_GET_WARR_AMEND_REQ_DATA", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<WarrantyAmendRequest>(_dtResults, WarrantyAmendRequest.Converter);
            }
            return _ListItems.FirstOrDefault();
        }
        //Rukshan 2016/01/26
        public DataTable GET_REF_SER2()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = QueryDataTable("tbl", "pkg_search_imp.SP_GET_REF_SER2", CommandType.StoredProcedure, false, param);
            return result;

        }

        //Sahan 29 Jan 2016
        public DataTable LoadLocationDetailsByCode(string company, string code)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_loc", "pkg_general.sp_load_location_data_by_code", CommandType.StoredProcedure, false, param);
        }

        //Lakshan 29/01/2016
        public DataTable SearchCurrencyData(string curr)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mcr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = curr;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_loc", "pkg_search_imp.SP_SELECT_CURRENCY_DATA", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 02/02/2016
        public DataTable SearchCustomerData(string customer)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_busentity", "pkg_search_imp.SP_SEARCH_CUSTOMER_DATA", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2016-02-02
        public List<PromotionVoucherPara> GET_VOUPARA_BY_CD(string Code)
        {
            List<PromotionVoucherPara> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Code;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_VOUPARA_BY_CD", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<PromotionVoucherPara>(_dtResults, PromotionVoucherPara.Converter);
            }
            return oResult;
        }

        //Tharaka 2016-02-03
        public List<REF_ALERT_SETUP> GET_REF_ALERT_SETUP(string Com, string Type, string PartyCode, string ModuleName, string Status)
        {
            List<REF_ALERT_SETUP> oResult = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            (param[2] = new OracleParameter("P_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PartyCode;
            (param[3] = new OracleParameter("P_MOD_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ModuleName;
            (param[4] = new OracleParameter("SP_GET_REF_ALERT_SETUP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_REF_ALERT_SETUP", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<REF_ALERT_SETUP>(_dtResults, REF_ALERT_SETUP.Converter);
            }
            return oResult;
        }


        //Sahan 05/Feb/2016
        public Int32 SaveItemKitComponent(ItemKitComponent ItemKitComp)
        {
            try
            {
                int _eff = 0;
                OracleParameter[] param = new OracleParameter[21];

                (param[0] = new OracleParameter("p_mikc_itm_code_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITM_CODE_MAIN;
                (param[1] = new OracleParameter("p_mikc_itm_code_component", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITM_CODE_COMPONENT;
                (param[2] = new OracleParameter("p_mikc_desc_component", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_DESC_COMPONENT;
                (param[3] = new OracleParameter("p_mikc_no_of_unit", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_NO_OF_UNIT;
                (param[4] = new OracleParameter("p_mikc_create_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_CREATE_BY;
                (param[5] = new OracleParameter("p_mikc_create_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_CREATE_WHEN;
                (param[6] = new OracleParameter("p_mikc_last_modify_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_LAST_MODIFY_BY;
                (param[7] = new OracleParameter("p_mikc_last_modify_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_LAST_MODIFY_WHEN;
                (param[8] = new OracleParameter("p_mikc_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_COST;
                (param[9] = new OracleParameter("p_mikc_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_SEQ_NO;
                (param[10] = new OracleParameter("p_mikc_itm_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITM_TYPE;
                (param[11] = new OracleParameter("p_mikc_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ACTIVE;
                (param[12] = new OracleParameter("p_mikc_item_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITEM_CATE;
                (param[13] = new OracleParameter("p_mikc_cost_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_COST_METHOD;
                (param[14] = new OracleParameter("p_mikc_chg_main_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_CHG_MAIN_SERIAL;
                (param[15] = new OracleParameter("p_mikc_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_UOM;
                (param[16] = new OracleParameter("p_mikc_isscan", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ISSCAN;
                (param[17] = new OracleParameter("p_mikc_scan_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_SCAN_SEQ;
                (param[18] = new OracleParameter("p_mikc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_TP;
                (param[19] = new OracleParameter("p_mikc_allow_edit", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ALLOW_EDIT;

                param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                _eff = (Int32)UpdateRecords("sp_save_itm_kit_component_c", CommandType.StoredProcedure, param);
                ConnectionClose();
                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Sahan 05/Feb/2016
        public DataTable LoadItemKitComponents(string item)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mikc_itm_code_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_itm_kit_component", "pkg_general.load_kit_itm_components", CommandType.StoredProcedure, false, param);
        }

        //Sahan 8 Feb 2016
        public DataTable SearchMainItems(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Cate = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Item = _searchText;
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText;
                        break;

                    case "CATEGORY":
                        Cate = _searchText;
                        break;

                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Cate = (Cate != null) ? (Cate.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[1] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[2] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cate;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "pkg_general.sp_load_main_items", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 8 Feb 2016
        public DataTable SearchComponentItems(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Cate = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Item = _searchText;
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText;
                        break;

                    case "CATEGORY":
                        Cate = _searchText;
                        break;

                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Cate = (Cate != null) ? (Cate.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[1] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[2] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cate;

            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "pkg_general.sp_load_components_items", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 08/Feb/2016
        public DataTable LoadSerialByBin(string company, string location, string serial, string _bin)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[3] = new OracleParameter("p_ins_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_ser", "pkg_general.load_ser_by_bin", CommandType.StoredProcedure, false, param);
        }

        //11-2-2016 Rukshan 
        public DataTable Check_MRN_Item(string _com, string _loc, string _item)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.SP_CHECK_MRN_ITEM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 17/02/2016
        public List<MasterLocationNew> GetMasterLocations(MasterLocationNew _loc)
        {
            List<MasterLocationNew> _list = new List<MasterLocationNew>();
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_Ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_com_cd;
            (param[1] = new OracleParameter("p_Ml_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_ope_cd;
            (param[2] = new OracleParameter("p_Ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_cd;
            (param[3] = new OracleParameter("p_Ml_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_act;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (string.IsNullOrEmpty(_loc.Ml_com_cd) && string.IsNullOrEmpty(_loc.Ml_loc_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("mst_loc", "pkg_general.sp_get_mst_loc_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<MasterLocationNew>(_dtResults, MasterLocationNew.Converter);
                }
            }
            return _list;
        }


        //Lakshan 17/02/2016
        public Int32 UpdateLocationMasterNew(MasterLocationNew _loc)
        {
            OracleParameter[] param = new OracleParameter[55];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_Ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_com_cd;
            (param[1] = new OracleParameter("p_Ml_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_ope_cd;
            (param[2] = new OracleParameter("p_Ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_cd;
            (param[3] = new OracleParameter("p_Ml_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_desc;
            (param[4] = new OracleParameter("p_Ml_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_ref;
            (param[5] = new OracleParameter("p_Ml_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_add1;
            (param[6] = new OracleParameter("p_Ml_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_add2;
            (param[7] = new OracleParameter("p_Ml_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_country_cd;
            (param[8] = new OracleParameter("p_Ml_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_province_cd;
            (param[9] = new OracleParameter("p_Ml_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_distric_cd;
            (param[10] = new OracleParameter("p_Ml_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_town_cd;
            (param[11] = new OracleParameter("p_Ml_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_tel;
            (param[12] = new OracleParameter("p_Ml_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_fax;
            (param[13] = new OracleParameter("p_Ml_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_email;
            (param[14] = new OracleParameter("p_Ml_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_web;
            (param[15] = new OracleParameter("p_Ml_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_contact;
            (param[16] = new OracleParameter("p_Ml_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_cate_1;
            (param[17] = new OracleParameter("p_Ml_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_cate_2;
            (param[18] = new OracleParameter("p_Ml_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_cate_3;
            (param[19] = new OracleParameter("p_Ml_buffer_grd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_buffer_grd;
            (param[20] = new OracleParameter("p_Ml_is_sub_loc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_is_sub_loc;
            (param[21] = new OracleParameter("p_Ml_main_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_main_loc_cd;
            (param[22] = new OracleParameter("p_Ml_is_online", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_is_online;
            (param[23] = new OracleParameter("p_Ml_manager_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_manager_cd;
            (param[24] = new OracleParameter("p_Ml_fwsale_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_fwsale_qty;
            (param[25] = new OracleParameter("p_Ml_suspend", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_suspend;
            (param[26] = new OracleParameter("p_Ml_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_act;
            (param[27] = new OracleParameter("p_Ml_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_cre_by;
            (param[28] = new OracleParameter("p_Ml_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Ml_cre_dt;
            (param[29] = new OracleParameter("p_Ml_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_mod_by;
            (param[30] = new OracleParameter("p_Ml_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Ml_mod_dt;
            (param[31] = new OracleParameter("p_Ml_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_session_id;
            (param[32] = new OracleParameter("p_Ml_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_anal1;
            (param[33] = new OracleParameter("p_Ml_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_anal2;
            (param[34] = new OracleParameter("p_Ml_anal3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loc.Ml_anal3;
            (param[35] = new OracleParameter("p_Ml_anal4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_anal4;
            (param[36] = new OracleParameter("p_Ml_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_anal5;
            (param[37] = new OracleParameter("p_Ml_anal6", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Ml_anal6;
            (param[38] = new OracleParameter("p_Ml_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_tp;
            (param[39] = new OracleParameter("p_Ml_allow_bin", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_allow_bin;
            (param[40] = new OracleParameter("p_Ml_def_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_def_pc;
            (param[41] = new OracleParameter("p_Ml_sev_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_sev_chnl;
            (param[42] = new OracleParameter("p_Ml_auto_ain", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_auto_ain;
            (param[43] = new OracleParameter("p_Ml_fx_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_fx_loc;
            (param[44] = new OracleParameter("p_Ml_scm2_st_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Ml_scm2_st_dt;
            (param[45] = new OracleParameter("p_Ml_is_chk_man_doc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_is_chk_man_doc;
            (param[46] = new OracleParameter("p_Ml_mobi", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_mobi;
            (param[47] = new OracleParameter("p_Ml_comm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loc.Ml_comm_dt;
            (param[48] = new OracleParameter("p_Ml_app_stk_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loc.Ml_app_stk_val;
            (param[49] = new OracleParameter("p_Ml_bank_grnt_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _loc.Ml_bank_grnt_val;
            (param[50] = new OracleParameter("p_Ml_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_wh_com;
            (param[51] = new OracleParameter("p_Ml_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_wh_cd;
            (param[52] = new OracleParameter("p_Ml_is_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_is_serial;
            (param[53] = new OracleParameter("p_Ml_is_pda", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _loc.Ml_is_pda;
            param[54] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_general.sp_save_loc_master", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 2016-Mar-01
        public Int32 Save_profit_center_new(MasterProfitCenter _pcheader, string _user)
        {
            Int32 effect = 0;
            OracleParameter[] param = new OracleParameter[64];

            (param[0] = new OracleParameter("p_MPC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_com;
            (param[1] = new OracleParameter("p_MPC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_cd;
            (param[2] = new OracleParameter("p_MPC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_desc;
            (param[3] = new OracleParameter("p_MPC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_tp;
            (param[4] = new OracleParameter("p_MPC_OTH_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_oth_ref;
            (param[5] = new OracleParameter("p_MPC_ADD_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_1;
            (param[6] = new OracleParameter("p_MPC_ADD_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_2;
            (param[7] = new OracleParameter("p_MPC_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_tel;
            (param[8] = new OracleParameter("p_MPC_FAX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_fax;
            (param[9] = new OracleParameter("p_MPC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_act;
            (param[10] = new OracleParameter("p_MPC_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_chnl;
            (param[11] = new OracleParameter("p_MPC_OPE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_ope_cd;
            (param[12] = new OracleParameter("p_MPC_DEF_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_pb;
            (param[13] = new OracleParameter("p_MPC_EDIT_PRICE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_edit_price;
            (param[14] = new OracleParameter("p_MPC_CHK_CREDIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_chk_credit;
            (param[15] = new OracleParameter("p_MPC_EDIT_RATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_edit_rate;
            (param[16] = new OracleParameter("p_MPC_DEF_DIS_RATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_dis_rate;
            (param[17] = new OracleParameter("p_MPC_PRINT_WARA_REMARKS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_wara_remarks;
            (param[18] = new OracleParameter("p_MPC_INTER_COM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_inter_com;
            (param[19] = new OracleParameter("p_MPC_PRINT_DIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_dis;
            (param[20] = new OracleParameter("p_MPC_PRINT_PAYMENT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_print_payment;
            (param[21] = new OracleParameter("p_MPC_CHECK_PAY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_check_pay;
            (param[22] = new OracleParameter("p_MPC_CHECK_CM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_check_cm;
            (param[23] = new OracleParameter("p_MPC_WITHOUT_PRICE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_without_price;
            (param[24] = new OracleParameter("p_MPC_ORDER_VALID_PD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_order_valid_pd;
            (param[25] = new OracleParameter("p_MPC_ORDER_RESTRIC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_order_restric;
            (param[26] = new OracleParameter("p_MPC_WARA_EXTEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_wara_extend;
            (param[27] = new OracleParameter("p_MPC_SO_SMS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_so_sms;
            (param[28] = new OracleParameter("p_MPC_MULTI_DEPT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_multi_dept;
            (param[29] = new OracleParameter("p_MPC_DEF_DEPT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_dept;
            (param[30] = new OracleParameter("p_MPC_DEF_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_loc;
            (param[31] = new OracleParameter("p_MPC_MAN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_man;
            (param[32] = new OracleParameter("p_MPC_DEF_EXRATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_exrate;
            (param[33] = new OracleParameter("p_MPC_DEF_CUSTOMER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_def_customer;
            (param[34] = new OracleParameter("p_MPC_ADD_HOURS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_add_hours;
            (param[35] = new OracleParameter("p_MPC_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_email;
            (param[36] = new OracleParameter("p_MPC_FWD_SALE_ST", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.Mpc_fwd_sale_st;
            (param[37] = new OracleParameter("p_MPC_MAX_FWDSALE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_max_fwdsale;
            (param[38] = new OracleParameter("p_MPC_HP_SYS_REC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_hp_sys_rec;
            (param[39] = new OracleParameter("p_MPC_IS_CHK_MAN_DOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_is_chk_man_doc;
            (param[40] = new OracleParameter("p_MPC_IS_DO_NOW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_is_do_now;
            (param[41] = new OracleParameter("p_MPC_DIST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_DIST;
            (param[42] = new OracleParameter("p_MPC_PROV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_PROV;
            (param[43] = new OracleParameter("p_MPC_OPN_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.MPC_OPN_DT;
            (param[44] = new OracleParameter("p_MPC_SQ_FT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.MPC_SQ_FT;
            (param[45] = new OracleParameter("p_MPC_MAN_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_MAN_NAME;
            (param[46] = new OracleParameter("p_MPC_JOINED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.MPC_JOINED_DT;
            (param[47] = new OracleParameter("p_MPC_HOVR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.MPC_HOVR_DT;
            (param[48] = new OracleParameter("p_MPC_NO_OF_STAFF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.MPC_NO_OF_STAFF;
            (param[49] = new OracleParameter("p_MPC_GRADE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.MPC_GRADE;
            (param[50] = new OracleParameter("p_mpc_num_fwdsale", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.MPC_NUM_FWDSALE;
            (param[51] = new OracleParameter("p_mpc_mul_crnote", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_mul_crnote;
            (param[52] = new OracleParameter("p_mpc_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_cate;
            (param[53] = new OracleParameter("p_mpc_issp_tax", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_issp_tax;
            (param[54] = new OracleParameter("p_mpc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[55] = new OracleParameter("p_mpc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.Mpc_cre_dt;
            (param[56] = new OracleParameter("p_mpc_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[57] = new OracleParameter("p_mpc_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pcheader.Mpc_mod_dt;
            (param[58] = new OracleParameter("p_mpc_so_res", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_so_res;
            (param[59] = new OracleParameter("p_mpc_so_rest_stk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_so_rest_stk;
            (param[60] = new OracleParameter("p_mpc_ord_alpbt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pcheader.Mpc_ord_alpbt;
            (param[61] = new OracleParameter("p_mpc_main_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_main_pc;
            (param[62] = new OracleParameter("p_mpc_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcheader.Mpc_town;
            param[63] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = UpdateRecords("sp_save_mst_profit_centernew", CommandType.StoredProcedure, param);
            return effect;
        }

        //Lakshan 2016-Mar-04
        public List<MasterBinLocation> GetMasterBinLocations(MasterBinLocation _bin)
        {
            List<MasterBinLocation> _list = new List<MasterBinLocation>();
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ibl_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin.Ibl_com_cd;
            (param[1] = new OracleParameter("p_ibl_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin.Ibl_loc_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_bin_loc", "pkg_general.sp_get_inr_loc_Bin_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterBinLocation>(_dtResults, MasterBinLocation.ConvertTotal);
            }
            return _list;
        }

        //Sahan 25 March 2016
        public Int32 UpdateBankAccounts(MasterBankAccount Account)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_msba_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_com;
            (param[1] = new OracleParameter("p_msba_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_cd;
            (param[2] = new OracleParameter("p_msba_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_desc;
            (param[3] = new OracleParameter("p_msba_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_acc_cd;
            (param[4] = new OracleParameter("p_msba_acc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_acc_desc;
            (param[5] = new OracleParameter("p_msba_acc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Account.Msba_acc_dt;
            (param[6] = new OracleParameter("p_msba_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Account.Msba_stus;
            (param[7] = new OracleParameter("p_msba_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_cre_by;
            (param[8] = new OracleParameter("p_msba_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Account.Msba_cre_dt;
            (param[9] = new OracleParameter("p_msba_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_mod_by;
            (param[10] = new OracleParameter("p_msba_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Account.Msba_mod_dt;
            (param[11] = new OracleParameter("p_msba_brn_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Account.Msba_brn_cd;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_bank_account", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 25 March 2016
        public DataTable LoadBankAccountData(MasterBankAccount AccountData)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountData.Msba_com;
            (param[1] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AccountData.Msba_acc_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_bankacc", "pkg_general.sp_load_bank_acc_data", CommandType.StoredProcedure, false, param);
        }

        //Sahan 25 March 2016
        public Int32 UpdateAccountFacility(BankAccountFacility Facility)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[24];

            (param[0] = new OracleParameter("p_msbf_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_COM;
            (param[1] = new OracleParameter("p_msbf_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_CD;
            (param[2] = new OracleParameter("p_msbf_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_ACC_CD;
            (param[3] = new OracleParameter("p_msbf_fac_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Facility.MSBF_FAC_DT;
            (param[4] = new OracleParameter("p_msbf_fac_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_FAC_TP;
            (param[5] = new OracleParameter("p_msbf_fac_lmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Facility.MSBF_FAC_LMT;
            (param[6] = new OracleParameter("p_msbf_fac_ult", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Facility.MSBF_FAC_ULT;
            (param[7] = new OracleParameter("p_msbf_valid_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = Facility.MSBF_VALID_FRM;
            (param[8] = new OracleParameter("p_msbf_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = Facility.MSBF_VALID_TO;
            (param[9] = new OracleParameter("p_msbf_fac_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Facility.MSBF_FAC_RT;
            (param[10] = new OracleParameter("p_msbf_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Facility.MSBF_ACT;
            (param[11] = new OracleParameter("p_msbf_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_CRE_BY;
            (param[12] = new OracleParameter("p_msbf_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Facility.MSBF_CRE_DT;
            (param[13] = new OracleParameter("p_msbf_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_MOD_BY;
            (param[14] = new OracleParameter("p_msbf_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Facility.MSBF_MOD_DT;
            (param[15] = new OracleParameter("p_msbf_isdefault", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Facility.MSBF_ISDEFAULT;
            (param[16] = new OracleParameter("p_msbf_cnty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_CNTY_CD;
            (param[17] = new OracleParameter("p_msbf_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Facility.MSBF_COMM_RT;
            (param[18] = new OracleParameter("p_msbf_fin_comm_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Facility.MSBF_FIN_COMM_RT;
            (param[19] = new OracleParameter("p_msbf_branch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_BRANCH_CD;
            (param[20] = new OracleParameter("p_msbf_our_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_OUR_REF;
            (param[21] = new OracleParameter("p_msbf_bank_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_BANK_REF;
            (param[22] = new OracleParameter("p_msbf_curr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Facility.MSBF_CURR;

            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_general.sp_update_bank_acc_facility", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 25 March 2016
        public DataTable LoadBankAccountFacilityData(BankAccountFacility FacilityData)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FacilityData.MSBF_COM;
            (param[1] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FacilityData.MSBF_CD;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_bankaccfac", "pkg_general.sp_load_bank_acc_facility_data", CommandType.StoredProcedure, false, param);
        }

        //Sahan 30 MAr 2016
        public DataTable SearchAgent(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string name = null;
            string add1 = null;
            string add2 = null;
            string mobile = null;
            string brno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;

                    case "NAME":
                        name = _searchText;
                        break;

                    case "ADDRESS 1":
                        add1 = _searchText;
                        break;

                    case "ADDRESS 2":
                        add2 = _searchText;
                        break;

                    case "MOBILE":
                        mobile = _searchText;
                        break;

                    case "BR NO":
                        brno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            code = (code != null) ? (code.ToUpper()) : null;
            name = (name != null) ? (name.ToUpper()) : null;
            add1 = (add1 != null) ? (add1.ToUpper()) : null;
            add2 = (add2 != null) ? (add2.ToUpper()) : null;
            mobile = (mobile != null) ? (mobile.ToUpper()) : null;
            brno = (brno != null) ? (brno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
            (param[3] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = add1;
            (param[4] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = add2;
            (param[5] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobile;
            (param[6] = new OracleParameter("p_br", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brno;
            (param[7] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_busentity", "pkg_general.sp_search_agent", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Sahan 30 MAr 2016
        public DataTable SearchBankAccounts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            code = (code != null) ? (code.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_bankcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;

            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_bankacc", "pkg_general.sp_load_bank_accounts", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 01 Apr 2016
        public List<TransportMethod> GET_TRANS_METH(TransportMethod _obj)
        {
            List<TransportMethod> _list = new List<TransportMethod>();
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_rtm_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_seq;
            (param[1] = new OracleParameter("p_rtm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_tp;
            (param[2] = new OracleParameter("p_rtm_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_act;
            (param[3] = new OracleParameter("p_rtm_def", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_def;
            (param[4] = new OracleParameter("p_rtm_sub_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_sub_lvl;
            (param[5] = new OracleParameter("p_rtm_sub_dis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_sub_dis;
            (param[6] = new OracleParameter("p_rtm_nxt_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_nxt_lvl;
            (param[7] = new OracleParameter("p_rtm_disp_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_disp_1;
            (param[8] = new OracleParameter("p_rtm_disp_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtm_disp_2;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_bin_loc", "pkg_general.sp_get_trans_meth", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<TransportMethod>(_dtResults, TransportMethod.Converter);
            }
            return _list;
        }

        //Lakshan 01 Apr 2016
        public List<TransportParty> GET_TRANSPORT_PTY(TransportParty _obj)
        {
            List<TransportParty> _list = new List<TransportParty>();
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_rtnp_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtnp_seq;
            (param[1] = new OracleParameter("p_rtnp_tnpt_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtnp_tnpt_seq;
            (param[2] = new OracleParameter("p_rtnp_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtnp_pty_tp;
            (param[3] = new OracleParameter("p_rtnp_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtnp_pty_cd;
            (param[4] = new OracleParameter("p_rtnp_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtnp_act;
            (param[5] = new OracleParameter("p_rtnp_is_flt_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rtnp_is_flt_job;
            (param[6] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbe_com;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_bin_loc", "sp_get_ref_transport_pty", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<TransportParty>(_dtResults, TransportParty.ConverterNew);
            }
            return _list;
        }

        //Sahan April 6 2016
        public MasterBusinessEntity GetAllCustomerProfileByCom(string CustCD, string nic, string DL, string PPNo, string brNo, string com)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "pkg_general.sp_getallcustomerprofilebycom", CommandType.StoredProcedure, false, param);

            MasterBusinessEntity bizEnt = new MasterBusinessEntity();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter)[0];
            }
            return bizEnt;
        }

        //Lakshan 12 APr 2016
        public Int32 Save_Int_Transport(Transport _obj)
        {

            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_itrn_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Itrn_seq;
            (param[1] = new OracleParameter("p_itrn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_com;
            (param[2] = new OracleParameter("p_itrn_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_loc;
            (param[3] = new OracleParameter("p_itrn_trns_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_no;
            (param[4] = new OracleParameter("p_itrn_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_ref_doc;
            (param[5] = new OracleParameter("p_itrn_trns_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_method;
            (param[6] = new OracleParameter("p_itrn_trns_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_pty_tp;
            (param[7] = new OracleParameter("p_itrn_trns_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_pty_cd;
            (param[8] = new OracleParameter("p_itrn_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_ref_no;
            (param[9] = new OracleParameter("p_itrn_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_rmk;
            (param[10] = new OracleParameter("p_itrn_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_stus;
            (param[11] = new OracleParameter("p_itrn_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_cre_by;
            (param[12] = new OracleParameter("p_itrn_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Itrn_cre_dt;
            (param[13] = new OracleParameter("p_itrn_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_cre_session;
            (param[14] = new OracleParameter("p_itrn_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_mod_by;
            (param[15] = new OracleParameter("p_itrn_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Itrn_mod_dt;
            (param[16] = new OracleParameter("p_itrn_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_mod_session;
            (param[17] = new OracleParameter("p_itrn_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_anal1;
            (param[18] = new OracleParameter("p_itrn_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_anal2;
            (param[19] = new OracleParameter("p_itrn_isactive", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.itrn_isactive; // add by akila 2017/07/18
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_general.sp_save_int_transport", CommandType.StoredProcedure, param);

            return effects;
        }
        //Rukshan 12/Apr/2016
        public DataTable GetItemStatusByCom(string _comp)
        {
            //  List<MasterItemStatus> _List = null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_get_status_com", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        //Rukshan 12/Apr/2016
        public bool CHECKALLOCATE_CUS(string _company, string _profitcenter, string _emp)
        {
            bool _isAllocate = false;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _emp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblPCEmp", "pkg_search_imp.CHECK_ALLOCATE_CUS", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                int value = Convert.ToInt32(tblDet.Rows[0][0].ToString());
                _isAllocate = Convert.ToBoolean(value);
            }
            return _isAllocate;
        }

        //Kelum : Save New Employee : 19/April/2016   
        public Int32 SaveNewEmployee(Employee _employeeNew)
        {
            OracleParameter[] param = new OracleParameter[34];

            (param[0] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_epf;
            (param[1] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_com_cd;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cd;
            (param[3] = new OracleParameter("p_cat_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cat_cd;
            (param[4] = new OracleParameter("p_cat_subcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cat_subcd;
            (param[5] = new OracleParameter("p_manager_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_manager_cd;
            (param[6] = new OracleParameter("p_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_title;
            (param[7] = new OracleParameter("p_name_initials", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_name_initials;
            (param[8] = new OracleParameter("p_first_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_first_name;
            (param[9] = new OracleParameter("p_last_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_last_name;
            (param[10] = new OracleParameter("p_sex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_sex;
            (param[11] = new OracleParameter("p_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_dob;
            (param[12] = new OracleParameter("p_per_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_per_add_1;
            (param[13] = new OracleParameter("p_per_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_per_add_2;
            (param[14] = new OracleParameter("p_per_add_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_per_add_3;
            (param[15] = new OracleParameter("p_living_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_living_add_1;
            (param[16] = new OracleParameter("p_living_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_living_add_2;
            (param[17] = new OracleParameter("p_living_add_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_living_add_3;
            (param[18] = new OracleParameter("p_police_station", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_police_station;
            (param[19] = new OracleParameter("p_mobi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_mobi_no;
            (param[20] = new OracleParameter("p_tel_home_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_tel_home_no;
            (param[21] = new OracleParameter("p_tel_off_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_tel_off_no;
            (param[22] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_nic;
            (param[23] = new OracleParameter("p_contractor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_contractor;
            (param[24] = new OracleParameter("p_is_max_stock_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_is_max_stock_val;
            (param[25] = new OracleParameter("p_max_stock_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_max_stock_val;
            (param[26] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_act;
            (param[27] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cre_by;
            (param[28] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_mod_by;
            (param[29] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_session_id;
            (param[30] = new OracleParameter("p_dep_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_dep_profit;
            (param[31] = new OracleParameter("p_supwise_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_supwise_cd;
            (param[32] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_email;
            param[33] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int32)this.UpdateRecords("sp_savenewemployee", CommandType.StoredProcedure, param);
        }

        //Kelum : Update Employee : 20/April/2016 
        public Int16 UpdateEmployee(Employee _employeeNew)
        {
            OracleParameter[] param = new OracleParameter[34];

            (param[0] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_epf;
            (param[1] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_com_cd;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cd;
            (param[3] = new OracleParameter("p_cat_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cat_cd;
            (param[4] = new OracleParameter("p_cat_subcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cat_subcd;
            (param[5] = new OracleParameter("p_manager_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_manager_cd;
            (param[6] = new OracleParameter("p_title", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_title;
            (param[7] = new OracleParameter("p_name_initials", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_name_initials;
            (param[8] = new OracleParameter("p_first_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_first_name;
            (param[9] = new OracleParameter("p_last_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_last_name;
            (param[10] = new OracleParameter("p_sex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_sex;
            (param[11] = new OracleParameter("p_dob", OracleDbType.Date, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_dob;
            (param[12] = new OracleParameter("p_per_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_per_add_1;
            (param[13] = new OracleParameter("p_per_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_per_add_2;
            (param[14] = new OracleParameter("p_per_add_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_per_add_3;
            (param[15] = new OracleParameter("p_living_add_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_living_add_1;
            (param[16] = new OracleParameter("p_living_add_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_living_add_2;
            (param[17] = new OracleParameter("p_living_add_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_living_add_3;
            (param[18] = new OracleParameter("p_police_station", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_police_station;
            (param[19] = new OracleParameter("p_mobi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_mobi_no;
            (param[20] = new OracleParameter("p_tel_home_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_tel_home_no;
            (param[21] = new OracleParameter("p_tel_off_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_tel_off_no;
            (param[22] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_nic;
            (param[23] = new OracleParameter("p_contractor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_contractor;
            (param[24] = new OracleParameter("p_is_max_stock_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_is_max_stock_val;
            (param[25] = new OracleParameter("p_max_stock_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_max_stock_val;
            (param[26] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_act;
            (param[27] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_cre_by;
            (param[28] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_mod_by;
            (param[29] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_session_id;
            (param[30] = new OracleParameter("p_dep_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_dep_profit;
            (param[31] = new OracleParameter("p_supwise_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_supwise_cd;
            (param[32] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employeeNew.ESEP_email;
            param[33] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return (Int16)this.UpdateRecords("sp_savenewemployee", CommandType.StoredProcedure, param);
        }

        //Kelum  : Get EPF No : 22/April/2016 
        public DataTable Get_EPFNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _firstname = null;
            string _lastname = null;
            string _desc = null;
            string _nic = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "FIRST NAME":
                        _firstname = _searchText;
                        break;
                    case "LAST NAME":
                        _lastname = _searchText;
                        break;
                    case "NAME WITH INITIALS":
                        _desc = _searchText;
                        break;
                    case "NIC":
                        _nic = _searchText;
                        break;
                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _firstname = (_firstname != null) ? (_firstname + "%") : "%";
            _lastname = (_lastname != null) ? (_lastname + "%") : "%";
            _desc = (_desc != null) ? (_desc + "%") : "%";
            _nic = (_nic != null) ? (_nic + "%") : "%";



            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;
            (param[3] = new OracleParameter("p_lastname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lastname;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[5] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_epf_no", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum  : Get EMP Code : 22/April/2016 
        public DataTable Get_EMPCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;
            string _epf = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "EPF":
                        _epf = _searchText;
                        break;


                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";
            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[3] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_emp_code", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        /*
        //Kelum : Get Manager : 22/April/2016 
        public DataTable Get_Manager(string _company, string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_manager", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Get Supervisor : 22/April/2016 
        public DataTable Get_Supervisor(string _company, string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_supervisor", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        */

        //Kelum : Get Category : 22/April/2016 
        public DataTable Get_Category(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_category", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Get SubCategory : 22/April/2016 
        public DataTable Get_SubCategory(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_subcategory", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Save Employee Proft Center : 25-April-2016
        public Int32 SaveEmployeeProfitCenter(List<MasterProfitCenter_LocationEmployee> _MPcE)
        {

            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            foreach (MasterProfitCenter_LocationEmployee _itm in _MPcE)
            {
                (param[0] = new OracleParameter("p_mpce_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_epf;
                (param[1] = new OracleParameter("p_mpce_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_com;
                (param[2] = new OracleParameter("p_mpce_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_pc;
                (param[3] = new OracleParameter("p_mpce_assn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm._mpce_assn_dt;
                (param[4] = new OracleParameter("p_mpce_rep_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_rep_cd;
                (param[5] = new OracleParameter("p_mpce_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_anal_1;
                //(param[] = new OracleParameter("p_mpce_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_anal_2;
                //(param[] = new OracleParameter("p_mpce_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_anal_3;
                (param[6] = new OracleParameter("p_mpce_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_act;
                (param[7] = new OracleParameter("p_mpce_max_stk_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_max_stk_val;
                (param[8] = new OracleParameter("p_mpce_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_mgr;
                (param[9] = new OracleParameter("p_mpce_is_rest", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_is_rest;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_saveempc_loc", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        //Kelum : Save Employee Location : 25-April-2016
        public Int32 SaveEmployeeLocation(List<MasterProfitCenter_LocationEmployee> _MLE)
        {

            OracleParameter[] param = new OracleParameter[11];
            Int32 effects = 0;

            foreach (MasterProfitCenter_LocationEmployee _itm in _MLE)
            {
                (param[0] = new OracleParameter("p_mpce_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_epf;
                (param[1] = new OracleParameter("p_mpce_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_com;
                (param[2] = new OracleParameter("p_mpce_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_pc;
                (param[3] = new OracleParameter("p_mpce_assn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm._mpce_assn_dt;
                (param[4] = new OracleParameter("p_mpce_rep_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_rep_cd;
                (param[5] = new OracleParameter("p_mpce_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_anal_1;
                //(param[] = new OracleParameter("p_mpce_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_anal_2;
                //(param[] = new OracleParameter("p_mpce_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_anal_3;
                (param[6] = new OracleParameter("p_mpce_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_act;
                (param[7] = new OracleParameter("p_mpce_max_stk_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_max_stk_val;
                (param[8] = new OracleParameter("p_mpce_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_mgr;
                (param[9] = new OracleParameter("p_mpce_is_rest", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_is_rest;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_saveempc_loc", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        //Kelum : Save Employee Customers : 25-April-2016
        public Int32 SaveEmployeeCustomers(List<MasterCustomerEmployee> _MstCusEmp)
        {

            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            foreach (MasterCustomerEmployee _itm in _MstCusEmp)
            {
                (param[0] = new OracleParameter("p_mpce_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_com;
                (param[1] = new OracleParameter("p_mpce_emp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_emp_cd;
                (param[2] = new OracleParameter("p_mpce_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_cus_cd;
                (param[3] = new OracleParameter("p_mpce_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mpce_stus;
                (param[4] = new OracleParameter("p_mpce_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_cre_by;
                (param[5] = new OracleParameter("p_mpce_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mpce_mod_by;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_saveempcustomers", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        //Kelum : Get Employee Details : 2016-April-26
        public Employee GetEmployeeMaster(string _employee, string _com)
        {// Nadeeka
            Employee _employeeList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_epfno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employee;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _emplyeeTable = QueryDataTable("tbl", "get_employeemaster", CommandType.StoredProcedure, false, param);
            if (_emplyeeTable.Rows.Count > 0)
            {
                _employeeList = DataTableExtensions.ToGenericList<Employee>(_emplyeeTable, Employee.ConvertTotal)[0];
            }
            return _employeeList;
        }

        //Kelum : Get Profit Center or Location : 2016-April-26
        public List<MasterProfitCenter_LocationEmployee> getEmployeeProfitCenter_Location(string _employee, string _com, string PCorL)
        {
            List<MasterProfitCenter_LocationEmployee> _ListItems = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_epfno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _employee;
            (param[1] = new OracleParameter("_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pcorl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PCorL;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getempprofitcenter_location", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterProfitCenter_LocationEmployee>(_dtResults, MasterProfitCenter_LocationEmployee.Converter);
            }

            return _ListItems;
        }

        // Kelum : Get Employee's Assinged Customers : 2016-April-26
        public List<MasterCustomerEmployee> getEmployeeCustomers(string _com, string _empcode)
        {
            List<MasterCustomerEmployee> _ListItems = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_empcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _empcode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_empcustomers", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterCustomerEmployee>(_dtResults, MasterCustomerEmployee.Converter);
            }

            return _ListItems;
        }
        // Rukshan  2016-April-27
        public DataTable getSeason(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_general.sp_getSeason", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }

        // Lakshan 2016 Apr 30
        public List<Transport> GET_INT_TRANSPORT(Transport _obj)
        {
            List<Transport> _ListItems = new List<Transport>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itrn_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_ref_doc;
            (param[1] = new OracleParameter("p_itrn_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_stus;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_general.sp_get_int_transport", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<Transport>(_dtResults, Transport.Converter);
            }

            return _ListItems;
        }

        //Kelum : Save Customer's Office of Entry : 2016-May-02
        public Int32 SaveCustomerOfficeofEntry(List<MasterBusinessOfficeEntry> _MstBusOffEntry)
        {

            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;

            foreach (MasterBusinessOfficeEntry _itm in _MstBusOffEntry)
            {
                (param[0] = new OracleParameter("p_mbbo_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mbbo_com;
                (param[1] = new OracleParameter("p_mbbo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mbbo_cd;
                (param[2] = new OracleParameter("p_mbbo_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mbbo_tp;
                (param[3] = new OracleParameter("p_mbbo_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mbbo_direct;
                (param[4] = new OracleParameter("p_mbbo_off_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mbbo_off_cd;
                (param[5] = new OracleParameter("p_mbbo_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm._mbbo_act;
                (param[6] = new OracleParameter("p_mbbo_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mbbo_cre_by;
                (param[7] = new OracleParameter("p_mbbo_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm._mbbo_mod_by;
                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_savecus_offofentry", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        //Kelum : Get Customer's Office of Entry : 2016-May-02
        public List<MasterBusinessOfficeEntry> getCustomerOfficeofEntry(string _com, string _emp, string _type)
        {
            List<MasterBusinessOfficeEntry> _ListOfficeEntry = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mbbo_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mbbo_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _emp;
            (param[2] = new OracleParameter("p_mbbo_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getcus_offofentry", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListOfficeEntry = DataTableExtensions.ToGenericList<MasterBusinessOfficeEntry>(_dtResults, MasterBusinessOfficeEntry.Converter);
            }

            return _ListOfficeEntry;
        }

        //ruksahan 09 MAr 2016
        public DataTable SearchBOQDocNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        code = _searchText;
                        break;
                    default:
                        break;
                }
            }

            code = (code != null) ? (code.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_bankacc", "pkg_sales.sp_search_satproDoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Kelum : Get PO/BL Number : 2016-June-01 
        public DataTable Get_PoBlNumber(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _code = _searchText;
                        break;

                    case "REFERENCE":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_po_or_bl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Get DOC_GRN Number : 2016-June-01
        public DataTable Get_DocGrnNumber(string _initialSearchParams, DateTime? _docdtfrom, DateTime? _docdtto, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _code = _searchText;
                        break;

                    case "OTHER DOCUMENT":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";


            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docdtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docdtfrom;
            (param[3] = new OracleParameter("p_docdtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docdtto;
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[7] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_docnoby_comdtdirectstus", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Get DOC_GRN Number : 2016-June-01
        public DataTable Get_DocGrnNumber2(string _initialSearchParams, DateTime? _docdtfrom, DateTime? _docdtto, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _code = _searchText;
                        break;

                    case "OTHER DOCUMENT":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";


            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docdtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docdtfrom;
            (param[3] = new OracleParameter("p_docdtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docdtto;
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[7] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_DOCNOBY_COMTDIRECTSTUS2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Get Entry Number : 2016-June-01
        public DataTable Get_EntryNumber(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _code = _searchText;
                        break;

                    case "OTHER DOCUMENT":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_entryby_type_and_status", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Kelum : Load Document Wise Balances : 2016-June-01
        public DataTable LoadDocumentWiseBalance(string _initialSearchParams, string _poblnumber, string _docno, string _entryno)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_poblno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poblnumber;
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[3] = new OracleParameter("p_direction", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("table", "sp_get_docwise_bal", CommandType.StoredProcedure, false, param);
            return dt;
        }

        // Lakshan 2016 Jul 30
        public List<MasterStatus> GET_MST_STUS(MasterStatus _obj)
        {
            List<MasterStatus> _ListItems = new List<MasterStatus>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mss_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mss_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_general.sp_get_mst_stus", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterStatus>(_dtResults, MasterStatus.Converter);
            }

            return _ListItems;
        }
        //Lakshika 2016-07-21
        public List<mst_commodel> GetCompanyByModel(string _code = null)
        {
            List<mst_commodel> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_COMPANY_BY_MODEL", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_commodel>(_dtResults, mst_commodel.Converter);
            }
            return _ListItems;
        }

        //Lakshika 2016-07-21
        public List<mst_model_replace> GetReplacedModelsByModel(string _code = null)
        {
            List<mst_model_replace> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_REPLACEDMODELS_BY_MODEL", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_model_replace>(_dtResults, mst_model_replace.Converter);
            }
            return _ListItems;
        }

        //Lakshika 2016-07-22
        public List<BusinessEntityVal> GetModelClassificationByModel(string _code = null)
        {
            List<BusinessEntityVal> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MODEL_CLASSIFICATIONS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<BusinessEntityVal>(_dtResults, BusinessEntityVal.Converter);
            }
            return _ListItems;
        }

        //Lakshan 2016-08-29
        public List<MasterBankBranch> GetBankBranchData(MasterBankBranch _obj)
        {
            List<MasterBankBranch> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_mbb_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbb_country_cd;
            (param[1] = new OracleParameter("p_mbb_bus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbb_bus_cd;
            (param[2] = new OracleParameter("p_mbb_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbb_cd;
            (param[3] = new OracleParameter("p_mbb_bus_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mbb_bus_tp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_mst_buscom_branch_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterBankBranch>(_dtResults, MasterBankBranch.Converter);
            }
            return _list;
        }
        //Lakshan 2016 Sep 22
        public List<SystemUserLoc> GET_SEC_USER_LOC_DATA(SystemUserLoc _obj)
        {
            List<SystemUserLoc> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_sel_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.SEL_USR_ID;
            (param[1] = new OracleParameter("p_sel_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.SEL_COM_CD;
            (param[2] = new OracleParameter("p_sel_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.SEL_LOC_CD;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_gt_sec_user_loc_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SystemUserLoc>(_dtResults, SystemUserLoc.converter);
            }
            return _list;
        }
        public List<PendingExchgAppHead> getPendingExchangeRequests(string company, string status, string appcd, string user, string page, string pagesize, string searchVal, string searchFld, string finstus, Int32 appLvl)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";

            List<PendingExchgAppHead> itmList = new List<PendingExchgAppHead>();
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_appcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appcd;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[4] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = page;
            (param[5] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pagesize;
            (param[6] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[7] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[8] = new OracleParameter("p_finstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = finstus;
            (param[9] = new OracleParameter("p_usrapplvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = appLvl;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblDtl", "SP_GET_PENDINGEXCHGREQ", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                itmList = DataTableExtensions.ToGenericList<PendingExchgAppHead>(_dtResults, PendingExchgAppHead.Converter);
            }
            return itmList;
        }

        public DataTable getApproveItemsModels(string reqno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_REQUESTITEMMODEL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //ruksahan 09 MAr 2016
        public DataTable SearchProDocNo(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        code = _searchText;
                        break;



                    default:
                        break;
                }
            }

            code = (code != null) ? (code.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_From", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_To", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_bankacc", "pkg_search_inv.sp_satproDoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //SUBODANA 2016-11-29
        public List<UnitConvert> GetModelUOM(string _code = null)
        {
            List<UnitConvert> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MODEL_UOM", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<UnitConvert>(_dtResults, UnitConvert.Converter);
            }
            return _ListItems;
        }

        public int UpdateMstMyAbans(string key_Code)
        {
            int _rowCount = 0;

            OracleParameter[] _parameter = new OracleParameter[2];

            (_parameter[0] = new OracleParameter("key_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = key_Code;
            _parameter[1] = new OracleParameter("o_effect ", OracleDbType.Int32, null, ParameterDirection.Output);

            _rowCount = (Int32)UpdateRecords("sp_update_mst_myabans", CommandType.StoredProcedure, _parameter);

            return _rowCount;
        }

        public List<ApprovalPermission> getApprovalPermission(string userid, string docLoc, string appcd)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<ApprovalPermission> _ListItems = new List<ApprovalPermission>();
            (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("p_docLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docLoc;
            (param[2] = new OracleParameter("p_appcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appcd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GETAPPPERMISSIONDET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<ApprovalPermission>(_dtResults, ApprovalPermission.Converter);
            }
            return _ListItems;
        }

        public List<ReferenceDetails> getReferenceDetails(string reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<ReferenceDetails> _ListItems = new List<ReferenceDetails>();
            (param[0] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVEREFDET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<ReferenceDetails>(_dtResults, ReferenceDetails.Converter);
            }
            return _ListItems;
        }

        public List<InvoiceCustomer> getInvoiceCustomer(string invNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<InvoiceCustomer> Items = new List<InvoiceCustomer>();
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_INVCUSTOMER", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<InvoiceCustomer>(_dtResults, InvoiceCustomer.Converter);
            }
            return Items;
        }

        public string getAccountSchema(string accNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            string schma = string.Empty;
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ACCOUNTSCHEMA", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                schma = _dtResults.Rows[0]["HPA_SCH_CD"].ToString();
            }
            return schma;
        }

        public string getPromotionDesc(string promocd)
        {
            OracleParameter[] param = new OracleParameter[2];
            string promodesc = string.Empty;
            (param[0] = new OracleParameter("p_promocd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = promocd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_PROMOTIONDESC", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                promodesc = _dtResults.Rows[0]["SARPT_DESC"].ToString();
            }
            return promodesc;
        }

        public List<ApprovalHistory> getApprovalHistoryDetails(string reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<ApprovalHistory> Items = new List<ApprovalHistory>();
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVEHISDET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalHistory>(_dtResults, ApprovalHistory.Converter);
            }
            return Items;
        }

        public string getCategoryDescription(string CD)
        {
            OracleParameter[] param = new OracleParameter[2];
            string MMCDESC = string.Empty;
            (param[0] = new OracleParameter("p_promocd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CD;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MMCCCATEDESC", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                MMCDESC = _dtResults.Rows[0]["MMCT_SDESC"].ToString();
            }
            return MMCDESC;
        }

        public string getReqestApprovalLeval(string appcd)
        {
            OracleParameter[] param = new OracleParameter[2];
            string MMCDESC = string.Empty;
            (param[0] = new OracleParameter("p_appcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appcd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVALLEVEL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                MMCDESC = _dtResults.Rows[0]["SARP_APP_LVL"].ToString();
            }
            return MMCDESC;
        }

        public List<ApproveHistoryDetails> getApprovalItemHistory(string reqNo, Int32 appLvl, Int32 lineno)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<ApproveHistoryDetails> Items = new List<ApproveHistoryDetails>();
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[1] = new OracleParameter("p_applvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = appLvl;
            (param[2] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPITMHISDET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApproveHistoryDetails>(_dtResults, ApproveHistoryDetails.Converter);
            }
            return Items;
        }

        public ApproveItemDetail getApproveItemDetails(string reqParam)
        {
            OracleParameter[] param = new OracleParameter[2];
            ApproveItemDetail Items = new ApproveItemDetail();
            (param[0] = new OracleParameter("p_prmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqParam;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPITMDETAIL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApproveItemDetail>(_dtResults, ApproveItemDetail.Converter)[0];
            }
            return Items;
        }

        public string getItemStatusDesc(string status)
        {
            OracleParameter[] param = new OracleParameter[2];
            string MMCDESC = string.Empty;
            (param[0] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPSTATUSDES", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                MMCDESC = _dtResults.Rows[0]["MIS_DESC"].ToString();
            }
            return MMCDESC;
        }

        public string getItemInSerial(string reqNo, Int32 lineno)
        {
            OracleParameter[] param = new OracleParameter[3];
            string MMCDESC = string.Empty;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPITMSERIAL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                MMCDESC = _dtResults.Rows[0]["GRAS_ANAL3"].ToString();
            }
            return MMCDESC;
        }

        public List<ApprovalRemarkLog> getApprovalRmkDetails(string reqNo, Int32 appLvl)
        {
            OracleParameter[] param = new OracleParameter[3];
            List<ApprovalRemarkLog> Items = new List<ApprovalRemarkLog>();
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[1] = new OracleParameter("p_applvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = appLvl;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVALREMARKDET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalRemarkLog>(_dtResults, ApprovalRemarkLog.Converter);
            }
            return Items;
        }

        public string getSubTypDescription(string subtyp)
        {
            OracleParameter[] param = new OracleParameter[2];
            string MMCDESC = string.Empty;
            (param[0] = new OracleParameter("p_subtyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subtyp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_REQSUBTYPDESC", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                MMCDESC = _dtResults.Rows[0]["MMCT_SDESC"].ToString();
            }
            return MMCDESC;
        }

        public List<ApprovalItemStatus> getItemStatusList(string com)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<ApprovalItemStatus> Items = new List<ApprovalItemStatus>();
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVALITMSTUS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalItemStatus>(_dtResults, ApprovalItemStatus.Converter);
            }
            return Items;
        }

        public string getReqCatCode(string reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            string desc = string.Empty;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPPROCEDURE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                desc = _dtResults.Rows[0]["GRAH_REQ_REM"].ToString();
            }
            return desc;
        }

        public List<ApprovalReqCategory> getAppReqCateList()
        {
            OracleParameter[] param = new OracleParameter[1];
            List<ApprovalReqCategory> Items = new List<ApprovalReqCategory>();
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPPROCEDURELIST", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalReqCategory>(_dtResults, ApprovalReqCategory.Converter);
            }
            return Items;
        }

        public ReferenceDetails getCreditTypData(string reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            ReferenceDetails Items = new ReferenceDetails();
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_CRETYPDATA", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ReferenceDetails>(_dtResults, ReferenceDetails.ConverterSub)[0];
            }
            return Items;
        }
        public bool validateItemCode(string itemCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            bool valid = false;
            (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_VALIDITMDET", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                valid = true;
            }

            return valid;
        }

        public string getApproveLevelForFinApproval(string appcd)
        {
            OracleParameter[] param = new OracleParameter[2];
            string LVL = string.Empty;
            (param[0] = new OracleParameter("p_appcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appcd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MINLVLFINAPP", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                LVL = _dtResults.Rows[0]["SART_APP_LVL"].ToString();
            }
            return LVL;
        }
        public string getApproveLevelForFinApprovalNew(string appcd, string company, string pc, string cate)
        {
            OracleParameter[] param = new OracleParameter[5];
            string LVL = string.Empty;
            (param[0] = new OracleParameter("p_appcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = appcd;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[3] = new OracleParameter("p_rv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MINLVLFINAPPNEW", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                LVL = _dtResults.Rows[0]["SART_APP_LVL"].ToString();
            }
            return LVL;
        }
        public Int32 UpdateApprovalHeader(ApprovalData data, string status)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[10];

                (param[0] = new OracleParameter("P_APPLVL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(data.UserPermission.SARP_APP_LVL);
                (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = data.LoginUser;
                (param[2] = new OracleParameter("P_REQCAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = data.ReqCategory;
                (param[3] = new OracleParameter("P_REQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = data.ReqNo;
                (param[4] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                (param[5] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
                (param[6] = new OracleParameter("P_ALWPRO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.AllowPromotion;
                (param[7] = new OracleParameter("P_RECBYBK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.ReceiveBuyBack;
                (param[8] = new OracleParameter("P_FREITMISU", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.AllowFreeItemIssue;
                param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_APPROVEREQUESTHDR", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public Int32 InserHdrLogAccExchange(string reqNo, string status, string remark, Int32 perLvl, string reqCat, string userid, ApprovalData data, Int32 MAXNUMBER)
        {
            try
            {
                Int32 result = -1;
                //Int32 MAXNUMBER = 1;
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPHEDDET", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count == 1)
                {
                    OracleParameter[] mxparam = new OracleParameter[3];
                    (mxparam[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
                    (mxparam[1] = new OracleParameter("p_applvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = perLvl;
                    mxparam[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                    //DataTable _dtMxResults = QueryDataTable("tbl", "SP_GET_MAXNUMBER", CommandType.StoredProcedure, false, mxparam);
                    //if (_dtMxResults.Rows.Count > 0)
                    //{
                    //    MAXNUMBER =(_dtMxResults.Rows[0]["MAXNUMBER"]!=DBNull.Value)? Convert.ToInt32(_dtMxResults.Rows[0]["MAXNUMBER"].ToString())+1:1;
                    //}

                    OracleParameter[] paramins = new OracleParameter[17];

                    (paramins[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_COM"].ToString();
                    (paramins[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_LOC"].ToString();
                    (paramins[2] = new OracleParameter("p_apptp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_APP_TP"].ToString();
                    (paramins[3] = new OracleParameter("p_fuccd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_FUC_CD"].ToString();
                    (paramins[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_REF"].ToString();
                    (paramins[5] = new OracleParameter("p_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_OTH_LOC"].ToString();
                    (paramins[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                    (paramins[7] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remark;
                    (paramins[8] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
                    (paramins[9] = new OracleParameter("p_applvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = perLvl;
                    (paramins[10] = new OracleParameter("p_othpc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dtResults.Rows[0]["GRAH_OTH_PC"].ToString();
                    (paramins[11] = new OracleParameter("p_nxtlno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = MAXNUMBER;
                    (paramins[12] = new OracleParameter("p_alwpro", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.AllowPromotion;
                    (paramins[13] = new OracleParameter("p_recbybk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.ReceiveBuyBack;
                    (paramins[14] = new OracleParameter("p_freitmisu", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.AllowFreeItemIssue;
                    (paramins[15] = new OracleParameter("p_reqcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqCat;
                    paramins[16] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
                    result = UpdateRecords("SP_INSERT_APPHDRLOG", CommandType.StoredProcedure, paramins);

                }
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }
        public Int32 getMaxNumber(string reqNo, Int32 perLvl)
        {
            try
            {
                OracleParameter[] mxparam = new OracleParameter[3];
                Int32 MAXNUMBER = 1;
                (mxparam[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
                (mxparam[1] = new OracleParameter("p_applvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = perLvl;
                mxparam[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtMxResults = QueryDataTable("tbl", "SP_GET_MAXNUMBER", CommandType.StoredProcedure, false, mxparam);
                if (_dtMxResults.Rows.Count > 0)
                {
                    MAXNUMBER = (_dtMxResults.Rows[0]["MAXNUMBER"] != DBNull.Value) ? Convert.ToInt32(_dtMxResults.Rows[0]["MAXNUMBER"].ToString()) + 1 : MAXNUMBER;
                }
                return MAXNUMBER;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public Int32 InsertApproveItemLogDetails(string reqno, ReferenceDetails refDet, string itmCd, string Warrenty, Int32 app_value, Int32 lineno, ApprovalData data, Int32 refline)
        {
            try
            {
                Int32 effect = -1;
                OracleParameter[] param = new OracleParameter[29];

                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[1] = new OracleParameter("p_gradline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
                (param[2] = new OracleParameter("p_appitmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
                (param[3] = new OracleParameter("p_gradvl1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_VAL1;
                (param[4] = new OracleParameter("p_appval", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_VAL2;
                (param[5] = new OracleParameter("p_gradval3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_VAL3;
                (param[6] = new OracleParameter("p_gradval4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_VAL4;
                (param[7] = new OracleParameter("p_gradval5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_VAL5;
                if (refDet.GRAD_ANAL5 == "EX-RECEIVE")
                {
                    (param[8] = new OracleParameter("p_gradanal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL8;
                }
                else
                {
                    (param[8] = new OracleParameter("p_gradanal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL1;
                }

                (param[9] = new OracleParameter("p_gradanal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL2;
                (param[10] = new OracleParameter("p_gradanal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL3;
                (param[11] = new OracleParameter("p_gradanal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL4;
                (param[12] = new OracleParameter("p_gradanal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL5;
                (param[13] = new OracleParameter("p_gradanal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL6;
                (param[14] = new OracleParameter("p_gradanal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL7;
                (param[15] = new OracleParameter("p_gradanal9", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL9;
                (param[16] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Warrenty;
                (param[17] = new OracleParameter("p_graddtprm", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(data.priceConsDate);
                (param[18] = new OracleParameter("p_gradanal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL10;
                (param[19] = new OracleParameter("p_gradisrt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_IS_RT1;
                (param[20] = new OracleParameter("p_gradisrt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_IS_RT2;
                (param[21] = new OracleParameter("p_sarpapplvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = app_value;
                (param[22] = new OracleParameter("p_mxnum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refline;
                (param[23] = new OracleParameter("p_gradanal15", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL15;
                (param[24] = new OracleParameter("p_gradanal17", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL17;
                (param[25] = new OracleParameter("p_gradanal18", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL18;
                (param[26] = new OracleParameter("p_recfreitm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refDet.GRAD_RCV_FREE_ITM;
                (param[27] = new OracleParameter("p_gradanal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refDet.GRAD_ANAL11;
                param[28] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
                effect = UpdateRecords("SP_INSERT_APPITMDETLOG", CommandType.StoredProcedure, param);

                return effect;

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public decimal getitemPrice(string pricebok, string pricebklvl, string app_item_code, Int32 qty, DateTime dateTime, string cuscd, string com)
        {
            try
            {
                OracleParameter[] mxparam = new OracleParameter[8];
                decimal value = -1;
                (mxparam[0] = new OracleParameter("p_pcbok", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pricebok;
                (mxparam[1] = new OracleParameter("p_pboklvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pricebklvl;
                (mxparam[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = app_item_code;
                (mxparam[3] = new OracleParameter("p_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = qty;
                (mxparam[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = dateTime;
                (mxparam[5] = new OracleParameter("p_cuscd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cuscd;
                (mxparam[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                mxparam[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtMxResults = QueryDataTable("tbl", "SP_GET_OUTITMPRICE", CommandType.StoredProcedure, false, mxparam);
                if (_dtMxResults.Rows.Count > 0)
                {
                    value = Math.Round(Convert.ToDecimal(_dtMxResults.Rows[0]["SAPD_ITM_PRICE"].ToString()), 2);
                }
                return value;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public decimal getTaxRate(string app_item_code, string com, string status)
        {
            try
            {
                OracleParameter[] mxparam = new OracleParameter[4];
                decimal tax = 0;
                (mxparam[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = app_item_code;
                (mxparam[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (mxparam[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
                mxparam[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtMxResults = QueryDataTable("tbl", "SP_GET_ITEMTAXRATE", CommandType.StoredProcedure, false, mxparam);
                if (_dtMxResults.Rows.Count > 0)
                {
                    tax = (_dtMxResults.Rows[0]["TAX"] != DBNull.Value) ? Convert.ToInt32(_dtMxResults.Rows[0]["TAX"].ToString()) : 0;
                }
                return tax;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<ReferenceDetailsLog> getApprovalLogDetails(string reqno, Int32 applvl)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                List<ReferenceDetailsLog> Items = new List<ReferenceDetailsLog>();
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[1] = new OracleParameter("p_applvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = applvl;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPHISDETLVL", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    Items = DataTableExtensions.ToGenericList<ReferenceDetailsLog>(_dtResults, ReferenceDetailsLog.Converter);
                }
                return Items;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateReqAppDetails(ReferenceDetailsLog log, string reqno)
        {
            try
            {
                Int32 effect = -1;
                OracleParameter[] param = new OracleParameter[9];

                (param[0] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_REQ_PARAM;
                (param[1] = new OracleParameter("p_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL10;
                (param[2] = new OracleParameter("p_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL11;
                (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = log.GRAD_DATE_PARAM;
                (param[4] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[5] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_LINE;
                (param[6] = new OracleParameter("p_recfree", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_RCV_FREE_ITM;
                (param[7] = new OracleParameter("p_anal15", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL15;
                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effect = UpdateRecords("SP_UPDATE_REQAPPDETAILS", CommandType.StoredProcedure, param);

                return effect;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateInItmReqDet(ReferenceDetailsLog log, string reqno)
        {
            try
            {
                Int32 effect = -1;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL10;
                (param[1] = new OracleParameter("p_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL11;
                (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = log.GRAD_DATE_PARAM;
                (param[3] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[4] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_LINE;
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effect = UpdateRecords("SP_UPDATE_OUTITMREQDET", CommandType.StoredProcedure, param);

                return effect;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int InserReqAppDetails(ReferenceDetailsLog log, int nextLine, string reqno, Int32 Active, ApprovalData data)
        {
            try
            {
                Int32 eff = 0;
                OracleParameter[] param = new OracleParameter[32];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = nextLine;
                (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_REQ_PARAM;
                (param[3] = new OracleParameter("p_val1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_VAL1;
                (param[4] = new OracleParameter("p_val2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_VAL2;
                (param[5] = new OracleParameter("p_val3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_VAL3;
                (param[6] = new OracleParameter("p_val4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_VAL4;
                (param[7] = new OracleParameter("p_val5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_VAL5;
                (param[8] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL1;
                (param[9] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL2;
                (param[10] = new OracleParameter("p_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL3;
                (param[11] = new OracleParameter("p_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL4;
                (param[12] = new OracleParameter("p_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL5;
                (param[13] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(data.priceConsDate);
                (param[14] = new OracleParameter("p_rt1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = log.GRAD_IS_RT1;
                (param[15] = new OracleParameter("p_rt2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = log.GRAD_IS_RT2;
                (param[16] = new OracleParameter("p_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL6;
                (param[17] = new OracleParameter("p_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL7;
                (param[18] = new OracleParameter("p_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL8;
                (param[19] = new OracleParameter("p_anal9", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL9;
                (param[20] = new OracleParameter("p_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL10;
                (param[21] = new OracleParameter("p_anal11", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL11;
                (param[22] = new OracleParameter("p_anal12", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL12;
                (param[23] = new OracleParameter("p_anal13", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL13;
                (param[24] = new OracleParameter("p_anal14", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL14;
                (param[25] = new OracleParameter("p_anal15", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = log.GRAD_ANAL15;
                (param[26] = new OracleParameter("p_anal16", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = log.GRAD_ANAL16;
                (param[27] = new OracleParameter("p_anal17", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = log.GRAD_ANAL17;
                (param[28] = new OracleParameter("p_anal18", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = log.GRAD_ANAL18;
                (param[29] = new OracleParameter("p_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Active;
                (param[30] = new OracleParameter("p_recfree", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_RCV_FREE_ITM;
                param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                eff = UpdateRecords("SP_INSERT_APPITMDETAILS", CommandType.StoredProcedure, param);
                return eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int InsertItmQtyLog(ApprovalData data, ReferenceDetails log, Int32 app_value, int lineno, Int32 refline)
        {
            try
            {
                Int32 eff = 0;
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = data.ReqNo;
                (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
                (param[2] = new OracleParameter("p_val1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = data.ItmQty;
                (param[3] = new OracleParameter("p_applvl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = app_value;
                (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(data.priceConsDate);
                (param[5] = new OracleParameter("p_mxlne", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refline;
                (param[6] = new OracleParameter("p_typ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "EX_ALW_QTY";
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                eff = UpdateRecords("SP_INSERT_APPITMQTYDETAILS", CommandType.StoredProcedure, param);
                return eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int InserReqAppQtyDetails(ReferenceDetailsLog log, int nextLine, string reqno)
        {
            try
            {
                Int32 eff = 0;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = nextLine;
                (param[2] = new OracleParameter("p_val1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = log.GRAD_VAL1;
                (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = log.GRAD_DATE_PARAM;
                (param[4] = new OracleParameter("p_typ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "EX_ALW_QTY";
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                eff = UpdateRecords("SP_INSERT_APPITMQTYDET", CommandType.StoredProcedure, param);
                return eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<ApprovalPriceBook> getRelatedPriceBook(string pc, string type, string com)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<ApprovalPriceBook> Items = new List<ApprovalPriceBook>();
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVALPRICEBOOK", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalPriceBook>(_dtResults, ApprovalPriceBook.Converter);
            }
            return Items;
        }

        public List<ApprovalPriceBookLevel> getRelatedPriceBookLevel(string pc, string type, string com, string pbook)
        {
            OracleParameter[] param = new OracleParameter[5];
            List<ApprovalPriceBookLevel> Items = new List<ApprovalPriceBookLevel>();
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_pcbk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbook;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_APPROVALPRICEBOOKLVL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalPriceBookLevel>(_dtResults, ApprovalPriceBookLevel.Converter);
            }
            return Items;
        }
        public List<ApprovalItemStatus> getPbLvlItemStatus(string pb, string lvl, string com)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<ApprovalItemStatus> Items = new List<ApprovalItemStatus>();
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pb;
            (param[2] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lvl;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_PBRELATEDITMSTATUS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalItemStatus>(_dtResults, ApprovalItemStatus.Converter);
            }
            return Items;

        }

        //subodana 2016-12-28
        public Int32 AmmendEPFNew(string empcd, string epfnw, string com)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_EMPCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = empcd;
            (param[1] = new OracleParameter("P_EPFNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = epfnw;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_UPDATE_EPFNO", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<InventorySerialN> getSerialDetailsForDeVal(string com, string location)
        {
            OracleParameter[] param = new OracleParameter[3];
            List<InventorySerialN> Items = new List<InventorySerialN>();
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ALLDEVALUATIONSER", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterNew);
            }
            return Items;
        }

        //Chamal 29-Dec-2016
        public DataTable Get_opbal_data(string _com, string _loc, DateTime _fromdate, DateTime _todate, int _processId, string _type)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate.Date;
            (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate.Date;
            (param[4] = new OracleParameter("p_balid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _processId;
            (param[5] = new OracleParameter("P_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_get_opbal_data", CommandType.StoredProcedure, false, param);
        }
        //Lakshan 03 Jan 2017
        public int SaveFleetVehicleMaster(FleetVehicleMaster _obj)
        {
            int _res = 0;
            OracleParameter[] param = new OracleParameter[66];
            (param[0] = new OracleParameter("p_fv_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_com;
            (param[1] = new OracleParameter("p_fv_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_pty_cd;
            (param[2] = new OracleParameter("p_fv_pty_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_pty_val;
            (param[3] = new OracleParameter("p_fv_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_reg_no;
            (param[4] = new OracleParameter("p_fv_reg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Fv_reg_dt;
            (param[5] = new OracleParameter("p_fv_make", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_make;
            (param[6] = new OracleParameter("p_fv_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_model;
            (param[7] = new OracleParameter("p_fv_colour", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_colour;
            (param[8] = new OracleParameter("p_fv_man_year", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_man_year;
            (param[9] = new OracleParameter("p_fv_eng_cap", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_eng_cap;
            (param[10] = new OracleParameter("p_fv_tans_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_tans_tp;
            (param[11] = new OracleParameter("p_fv_carr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_carr_tp;
            (param[12] = new OracleParameter("p_fv_width", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_width;
            (param[13] = new OracleParameter("p_fv_height", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_height;
            (param[14] = new OracleParameter("p_fv_length", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_length;
            (param[15] = new OracleParameter("p_fv_max_weight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_max_weight;
            (param[16] = new OracleParameter("p_fv_fuel_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_fuel_tp;
            (param[17] = new OracleParameter("p_fv_fuel_cosm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_fuel_cosm;
            (param[18] = new OracleParameter("p_fv_driver", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_driver;
            (param[19] = new OracleParameter("p_fv_helper", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_helper;
            (param[20] = new OracleParameter("p_fv_curr_meter", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_curr_meter;
            (param[21] = new OracleParameter("p_fv_last_fuel_meter", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_last_fuel_meter;
            (param[22] = new OracleParameter("p_fv_last_fuel_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Fv_last_fuel_dt;
            (param[23] = new OracleParameter("p_fv_dt_purchase", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Fv_dt_purchase;
            (param[24] = new OracleParameter("p_fv_pur_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_pur_stus;
            (param[25] = new OracleParameter("p_fv_pur_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_pur_price;
            (param[26] = new OracleParameter("p_fv_pur_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_pur_tp;
            (param[27] = new OracleParameter("p_fv_fuel_tnk_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_fuel_tnk_cap;
            (param[28] = new OracleParameter("p_fv_engine_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_engine_no;
            (param[29] = new OracleParameter("p_fv_chassis_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_chassis_no;
            (param[30] = new OracleParameter("p_fv_whl_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_whl_uom;
            (param[31] = new OracleParameter("p_fv_owner_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_owner_tp;
            (param[32] = new OracleParameter("p_fv_dealer_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_dealer_code;
            (param[33] = new OracleParameter("p_fv_image", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_image;
            (param[34] = new OracleParameter("p_fv_service_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_service_seq;
            (param[35] = new OracleParameter("p_fv_manf_fuel_cosm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_manf_fuel_cosm;
            (param[36] = new OracleParameter("p_fv_batt_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_batt_tp;
            (param[37] = new OracleParameter("p_fv_no_batt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_no_batt;
            (param[38] = new OracleParameter("p_fv_owner_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_owner_com;
            (param[39] = new OracleParameter("p_fv_man_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_man_ref_no;
            (param[40] = new OracleParameter("p_fv_vehi_capacity", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_vehi_capacity;
            (param[41] = new OracleParameter("p_fv_vehi_cap_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_vehi_cap_uom;
            (param[42] = new OracleParameter("p_fv_vehi_weight_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_vehi_weight_uom;
            (param[43] = new OracleParameter("p_fv_vehi_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_vehi_cost;
            (param[44] = new OracleParameter("p_fv_unweight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_unweight;
            (param[45] = new OracleParameter("p_fv_grweight", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_grweight;
            (param[46] = new OracleParameter("p_fv_body_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_body_tp;
            (param[47] = new OracleParameter("p_fv_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_country;
            (param[48] = new OracleParameter("p_fv_class", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_class;
            (param[49] = new OracleParameter("p_fv_tax_class", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_tax_class;
            (param[50] = new OracleParameter("p_fv_prov", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_prov;
            (param[51] = new OracleParameter("p_fv_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Fv_stus;
            (param[52] = new OracleParameter("p_fv_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_cre_by;
            (param[53] = new OracleParameter("p_fv_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Fv_cre_dt;
            (param[54] = new OracleParameter("p_fv_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_session_id;
            (param[55] = new OracleParameter("p_fv_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_mod_by;
            (param[56] = new OracleParameter("p_fv_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Fv_mod_dt;
            (param[57] = new OracleParameter("p_fv_mod_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_mod_session_id;
            (param[58] = new OracleParameter("p_Fv_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_rem;

            (param[59] = new OracleParameter("p_Fv_ft_size", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_ft_size;
            (param[60] = new OracleParameter("p_Fv_ft_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Fv_ft_qty;

            (param[61] = new OracleParameter("p_Fv_mt_size", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_mt_size;
            (param[62] = new OracleParameter("p_Fv_mt_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Fv_mt_qty;

            (param[63] = new OracleParameter("p_Fv_rt_size", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Fv_rt_size;
            (param[64] = new OracleParameter("p_Fv_rt_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Fv_rt_qty;

            param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _res = UpdateRecords("sp_save_flt_vehicle", CommandType.StoredProcedure, param);
            return _res;
        }
        //Lakshan 03 Jan 2017
        public List<FleetVehicleMaster> GET_FLT_VEHICLE_DATA(FleetVehicleMaster _obj)
        {
            OracleParameter[] param = new OracleParameter[5];
            List<FleetVehicleMaster> Items = new List<FleetVehicleMaster>();
            (param[0] = new OracleParameter("fv_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_com;
            (param[1] = new OracleParameter("p_fv_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_pty_cd;
            (param[2] = new OracleParameter("p_fv_pty_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_pty_val;
            (param[3] = new OracleParameter("p_fv_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Fv_reg_no;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_flt_vehicle_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<FleetVehicleMaster>(_dtResults, FleetVehicleMaster.Converter);
            }
            return Items;
        }
        //Lakshan 24 Jan 2017
        public List<RouteHeader> GET_ROUTE_HDR_DATA(RouteHeader _obj)
        {
            List<RouteHeader> _list = new List<RouteHeader>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_frh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.FRH_CD;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("flt_route_hdr", "sp_get_flt_route_hdr_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RouteHeader>(_dtResults, RouteHeader.Converter);
            }
            return _list;
        }
        //Lakshan 24 Jan 2017
        public List<RouteShowRooms> GET_ROUTE_SHOWROOM_DATA(RouteShowRooms _obj)
        {
            List<RouteShowRooms> _list = new List<RouteShowRooms>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_frh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.FRS_CD;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("flt_route_hdr", "sp_get_flt_route_sr_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RouteShowRooms>(_dtResults, RouteShowRooms.Converter);
            }
            return _list;
        }
        //Lakshan 24 Jan 2017
        public List<RouteWareHouse> GET_ROUTE_WAREHOUSE_DATA(RouteWareHouse _obj)
        {
            List<RouteWareHouse> _list = new List<RouteWareHouse>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_frh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.FRW_CD;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("flt_route_hdr", "sp_get_flt_route_wh_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RouteWareHouse>(_dtResults, RouteWareHouse.Converter);
            }
            return _list;
        }
        //Lakshan 24 Jan 2017
        public List<RouteSchedule> GET_ROUTE_SHEDULE_DATA(RouteSchedule _obj)
        {
            List<RouteSchedule> _list = new List<RouteSchedule>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_frh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.FRSH_CD;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("flt_route_hdr", "sp_get_flt_route_shedule_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RouteSchedule>(_dtResults, RouteSchedule.Converter);
            }
            return _list;
        }
        public DataTable getBalanceTblLocations(int seq, string company, string location)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[2] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[3] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                return QueryDataTable("tbl", "SP_GET_BMVLOCLIST", CommandType.StoredProcedure, false, param);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getLocaionDetails(string company, string location)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                return QueryDataTable("tbl", "SP_GET_BMVLOCDETAILS", CommandType.StoredProcedure, false, param);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getBalanaceItemData(int seq, string location, string com)
        {
            try
            {

                OracleParameter[] param = new OracleParameter[4];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                return QueryDataTable("tbl", "SP_GET_BMVBALANCEDETAILS", CommandType.StoredProcedure, false, param);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateAgingCompanyDetails(BMT_INV_BAL_COM bal)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[23];

                (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bal.BMI_SEQ_NO;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_COM_CD;
                (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_LOC_CD;
                (param[3] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_ITM_CD;
                (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_ITM_STUS;
                (param[5] = new OracleParameter("p_ageqty1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY1;
                (param[6] = new OracleParameter("p_agecost1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST1;
                (param[7] = new OracleParameter("p_ageqty2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY2;
                (param[8] = new OracleParameter("p_agecost2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST2;
                (param[9] = new OracleParameter("p_ageqty3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY3;
                (param[10] = new OracleParameter("p_agecost3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST3;
                (param[11] = new OracleParameter("p_ageqty4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY4;
                (param[12] = new OracleParameter("p_agecost4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST4;
                (param[13] = new OracleParameter("p_ageqty5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY5;
                (param[14] = new OracleParameter("p_agecost5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST5;
                (param[15] = new OracleParameter("p_ageqty6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY6;
                (param[16] = new OracleParameter("p_agecost6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST6;
                (param[17] = new OracleParameter("p_ageqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY_T;
                (param[18] = new OracleParameter("p_agecost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST_T;
                (param[19] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_DOC_NO;
                (param[20] = new OracleParameter("p_docdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = bal.BMI_DOC_DT;
                (param[21] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bal.BMI_ITEM_LINE;
                param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_COMPANYAGEDET", CommandType.StoredProcedure, param);

                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getInrSerBalanceData(string docNo, int itmLine, int batchLine, string itmcd)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
                (param[2] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmLine;
                (param[3] = new OracleParameter("p_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = batchLine;
                (param[4] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
                return QueryDataTable("tbl", "SP_GET_BMVBALANCESERIAL", CommandType.StoredProcedure, false, param);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateSerAgingCompanyDetails(BMT_INV_BAL_COM bal)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[23];

                (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bal.BMI_SEQ_NO;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_COM_CD;
                (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_LOC_CD;
                (param[3] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_ITM_CD;
                (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_ITM_STUS;
                (param[5] = new OracleParameter("p_ageqty1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY1;
                (param[6] = new OracleParameter("p_agecost1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST1;
                (param[7] = new OracleParameter("p_ageqty2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY2;
                (param[8] = new OracleParameter("p_agecost2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST2;
                (param[9] = new OracleParameter("p_ageqty3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY3;
                (param[10] = new OracleParameter("p_agecost3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST3;
                (param[11] = new OracleParameter("p_ageqty4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY4;
                (param[12] = new OracleParameter("p_agecost4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST4;
                (param[13] = new OracleParameter("p_ageqty5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY5;
                (param[14] = new OracleParameter("p_agecost5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST5;
                (param[15] = new OracleParameter("p_ageqty6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY6;
                (param[16] = new OracleParameter("p_agecost6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST6;
                (param[17] = new OracleParameter("p_ageqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_QTY_T;
                (param[18] = new OracleParameter("p_agecost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bal.BMI_AGE_COST_T;
                (param[19] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bal.BMI_DOC_NO;
                (param[20] = new OracleParameter("p_docdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = bal.BMI_DOC_DT;
                (param[21] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bal.BMI_ITEM_LINE;
                param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_COMBALANCEDET", CommandType.StoredProcedure, param);

                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateAllOutDocuments(DateTime runStrtDt, DateTime runEndDt, string company, string location, int direction, string userid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = direction;
                (param[4] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = runStrtDt.Date;
                (param[5] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = runEndDt.Date;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_ALLOUTDOCUMENT", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int getApproveLevelForFinApproval(DateTime runStrtDt, DateTime runEndDt, string company, string location, int direction, string userid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = direction;
                (param[4] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = runStrtDt.Date;
                (param[5] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = runEndDt.Date;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_ALLOUTDOCUMENT", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }


        public int updateAllInDocuments(DateTime runStrtDt, DateTime runEndDt, string company, string location, int direction, int seq, string userid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = direction;
                (param[4] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = runStrtDt.Date;
                (param[5] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = runEndDt.Date;
                (param[6] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_ALLOUTDOCUMENT", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Lakshan 26 Jan 2017
        public Int32 SaveItemMasterLog(string _item, string _userId)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_mi_log_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[2] = new OracleParameter("p_mi_log_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_itm_master_log", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveComItemNEW(List<MasterCompanyItem> _lst)
        {
            //Nadeeka 25-05-2015
            //Modify by rukshan 08/jan/2016
            //Modify by lakshan 27/jan/2017
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            foreach (MasterCompanyItem _itm in _lst)
            {
                (param[0] = new OracleParameter("p_mci_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mci_com;
                (param[1] = new OracleParameter("p_mci_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mci_itm_cd;
                (param[2] = new OracleParameter("p_mci_isfoc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mci_isfoc;
                (param[3] = new OracleParameter("p_mci_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mci_act;
                (param[4] = new OracleParameter("p_mci_hpqty_chk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Mci_hpqty_chk;
                (param[5] = new OracleParameter("p_mci_age_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Mci_age_type;
                (param[6] = new OracleParameter("p_mci_restric_inv_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Msi_restric_inv_tp;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_SAVE_ITEM_COM_NEW", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        //Lakshan 27 Jan 2017
        public Int32 SAVE_SAR_PC_WARA(List<mst_itm_pc_warr> _lst)
        {
            OracleParameter[] param = new OracleParameter[12];
            Int32 effects = 0;
            foreach (mst_itm_pc_warr _itm in _lst)
            {
                //if (string.IsNullOrEmpty(_itm.Pc_code))
                //{
                //    int x = 0;
                //}
                (param[0] = new OracleParameter("p_spw_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_com;
                (param[1] = new OracleParameter("p_spw_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_code;
                (param[2] = new OracleParameter("p_spw_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_item_code;
                (param[3] = new OracleParameter("p_spw_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_item_stus;
                (param[4] = new OracleParameter("p_spw_wara_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.Pc_wara_period;
                (param[5] = new OracleParameter("p_spw_wara_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_wara_rmk;
                (param[6] = new OracleParameter("p_spw_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Pc_valid_from;
                (param[7] = new OracleParameter("p_spw_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Pc_valid_to;
                (param[8] = new OracleParameter("p_spw_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_create_by;
                (param[9] = new OracleParameter("p_spw_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.Pc_create_when;
                (param[10] = new OracleParameter("p_spw_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Pc_type;
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("sp_save_sar_pc_wara", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        public List<mst_itm_pc_warr> getPcWarrantNew(string _item)
        {
            List<mst_itm_pc_warr> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_PC_WARA_NEW", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_pc_warr>(_dtResults, mst_itm_pc_warr.Converter);
            }
            return _ListItems;
        }
        //RUKSHAN
        public Int32 SaveItemKitComponentNEW(ItemKitComponent ItemKitComp)
        {
            try
            {
                int _eff = 0;
                OracleParameter[] param = new OracleParameter[20];

                (param[0] = new OracleParameter("p_mikc_itm_code_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITM_CODE_MAIN;
                (param[1] = new OracleParameter("p_mikc_itm_code_component", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITM_CODE_COMPONENT;
                (param[2] = new OracleParameter("p_mikc_desc_component", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_DESC_COMPONENT;
                (param[3] = new OracleParameter("p_mikc_no_of_unit", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_NO_OF_UNIT;
                (param[4] = new OracleParameter("p_mikc_create_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_CREATE_BY;
                (param[5] = new OracleParameter("p_mikc_create_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_CREATE_WHEN;
                (param[6] = new OracleParameter("p_mikc_last_modify_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_LAST_MODIFY_BY;
                (param[7] = new OracleParameter("p_mikc_last_modify_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_LAST_MODIFY_WHEN;
                (param[8] = new OracleParameter("p_mikc_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_COST;
                (param[9] = new OracleParameter("p_mikc_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_SEQ_NO;
                (param[10] = new OracleParameter("p_mikc_itm_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITM_TYPE;
                (param[11] = new OracleParameter("p_mikc_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ACTIVE;
                (param[12] = new OracleParameter("p_mikc_item_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ITEM_CATE;
                (param[13] = new OracleParameter("p_mikc_cost_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_COST_METHOD;
                (param[14] = new OracleParameter("p_mikc_chg_main_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_CHG_MAIN_SERIAL;
                (param[15] = new OracleParameter("p_mikc_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_UOM;
                (param[16] = new OracleParameter("p_mikc_isscan", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_ISSCAN;
                (param[17] = new OracleParameter("p_mikc_scan_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_SCAN_SEQ;
                (param[18] = new OracleParameter("p_mikc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemKitComp.MIKC_TP;

                param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                _eff = (Int32)UpdateRecords("pkg_general.sp_save_itm_kit_component", CommandType.StoredProcedure, param);
                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int32 SaveFinishGood_Itm(List<MasterKitComFineItem> _lst)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            foreach (MasterKitComFineItem _itm in _lst)
            {
                (param[0] = new OracleParameter("p_mif_kit_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MIF_KIT_CD;
                (param[1] = new OracleParameter("p_mif_fg_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MIF_FG_CD;
                (param[2] = new OracleParameter("p_mif_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itm.MIF_ACT;
                (param[3] = new OracleParameter("p_mif_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MIF_CRE_BY;
                (param[4] = new OracleParameter("p_mif_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.MIF_CRE_DT;
                (param[5] = new OracleParameter("p_mif_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.MIF_MOD_BY;
                (param[6] = new OracleParameter("p_mif_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itm.MIF_MOD_DT;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("SP_SAVE_KITFINITEM", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        //Lakshan Add 07 Feb 2017 as copy cant modify sp in package 
        public List<MasterLocationNew> GetMasterLocationDataNew(MasterLocationNew _loc)
        {
            List<MasterLocationNew> _list = new List<MasterLocationNew>();
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_Ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_com_cd;
            (param[1] = new OracleParameter("p_Ml_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_ope_cd;
            (param[2] = new OracleParameter("p_Ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_loc_cd;
            (param[3] = new OracleParameter("p_Ml_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.Ml_act;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (string.IsNullOrEmpty(_loc.Ml_com_cd) && string.IsNullOrEmpty(_loc.Ml_loc_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("mst_loc", "sp_get_mst_loc_data_new", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<MasterLocationNew>(_dtResults, MasterLocationNew.Converter2);
                }
            }
            return _list;
        }
        //Lakshan 18 feb 2017
        public MasterLocationPriorityHierarchy GET_MST_LOC_INFO_DATA(string _mliLocCd, string _mliCd)
        {
            MasterLocationPriorityHierarchy _obj = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mli_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mliLocCd;
            (param[1] = new OracleParameter("p_mli_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mliCd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_mst_loc_info_data", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _obj = DataTableExtensions.ToGenericList<MasterLocationPriorityHierarchy>(_dtResults, MasterLocationPriorityHierarchy.Converter)[0];
            }
            return _obj;
        }

        public DataTable userEmailList(string reqno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_enqid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblloc", "SP_GET_MAILSENDUSEREMAILS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //dilshan on 2018-09-03
        public DataTable userMobileNoList(string _cusNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cusid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_smssendusermobiles", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //dilshan on 2018-09-04
        public DataTable ExMobileNoList(string _cusNo, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cusid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusNo;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_smssendexmobiles", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //SUBODANA 2017-03-02
        public DataTable GetItemPrefix(string itm)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblloc", "SP_GET_ITEM_PREFIX", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Udaya add 24_03_2017
        public Int32 saveLoadingBay(LoadingBay _loBay)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("userId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.userId;
            (param[1] = new OracleParameter("companyCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.companyCode;
            (param[2] = new OracleParameter("locationID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.locationID;
            (param[3] = new OracleParameter("warehouseCom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.warehouseCom;
            (param[4] = new OracleParameter("warehouseLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.warehouseLoc;
            (param[5] = new OracleParameter("loadingBayID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.loadingBayID;
            (param[6] = new OracleParameter("Default1", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _loBay.Default1;
            (param[7] = new OracleParameter("sessionCreateBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.sessionCreateBy;
            (param[8] = new OracleParameter("sessionCreateDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loBay.sessionCreateDate;

            (param[9] = new OracleParameter("createSession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.createSession;
            (param[10] = new OracleParameter("sessionModBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.sessionModBy;
            (param[11] = new OracleParameter("sessionModDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _loBay.sessionModDate;

            (param[12] = new OracleParameter("modSession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loBay.modSession;
            (param[13] = new OracleParameter("Active", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _loBay.Active;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("SaveLoadingBay", CommandType.StoredProcedure, param);

            return _eff;
        }

        //dilshan 24/10/2017
        public Int32 saveDocLoadingBay(ReptPickHeader _doloBay)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doloBay.Tuh_doc_no;
            (param[1] = new OracleParameter("companyCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doloBay.Tuh_usr_com;
            (param[2] = new OracleParameter("loadingBayID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doloBay.Tuh_load_bay;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("SaveDocLoadingBay", CommandType.StoredProcedure, param);

            return _eff;
        }

        //Isuru 2017/03/24
        public DataTable LoadSunPrefixFacilityData(gnr_acc_sun_ledger FacilityData)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FacilityData.ledg_comp;
            (param[1] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FacilityData.ledg_sales_tp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_bankaccfac", "sp_load_prifix_typ_data", CommandType.StoredProcedure, false, param);
        }

        //Isuru 2017/03/25
        public List<sar_tp> GetMasterPrefixData(sar_tp _loc)
        {
            List<sar_tp> _list = new List<sar_tp>();
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_srtp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc.srtp_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (string.IsNullOrEmpty(_loc.srtp_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("mst_loc", "sp_get_srt_ty_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<sar_tp>(_dtResults, sar_tp.Converter);
                }
            }
            return _list;
        }
        public DataTable ViewCommissionsDetails(DateTime FromData, DateTime ToDate, string circularCode, string userid, string com)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromData;
            (param[1] = new OracleParameter("ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[2] = new OracleParameter("commissionsCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circularCode;
            (param[3] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[4] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_ViewCommissionsDetails", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public List<MasterItemModel> GetItemModelNew(string _code = null)
        {
            List<MasterItemModel> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_MODEL", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterItemModel>(_dtResults, MasterItemModel.Converter2);
            }
            return _ListItems;
        }
        public MasterItem GetItemMasterNew(string _item)
        {// Nadeeka
            MasterItem _itemList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_itemMaster", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal2)[0];
            }
            return _itemList;
        }

        //Udaya 25/04/2017
        public DataTable SearchProjectCode(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime FromDate, DateTime ToDate, string codeVwsSrh)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        code = _searchText;
                        break;
                    case "DATE":
                        code = _searchText;
                        break;
                    case "STATUS":
                        code = _searchText;
                        break;
                    default:
                        break;
                }
            }

            code = (code != null) ? (code.ToUpper()) : null;
            desc = (desc != null) ? (desc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[3] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = FromDate;
            (param[4] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[5] = new OracleParameter("p_codeVwsSrh", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = codeVwsSrh;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_prodoc", "sp_get_proDoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Isuru 2017/05/03
        public Int32 uploadlocmasterdet(MasterLocationNew _locmasterdet)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_com_cd;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_loc_cd;
            (param[2] = new OracleParameter("p_stk_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_app_stk_val;
            (param[3] = new OracleParameter("p_grt_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_bank_grnt_val;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_mod_by;
            (param[5] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_mod_dt;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_loc_master_details", CommandType.StoredProcedure, param);
            return effects;
        }


        //Isuru 2017/05/03
        public Int32 Updatelogdetails(MasterLocationNew _locmasterdet)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_com_cd;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_loc_cd;
            (param[2] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locmasterdet.Ml_mod_by;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_log_details", CommandType.StoredProcedure, param);
            return effects;
        }


        // Tharanga 2017/05/13
        public Int32 SaveVehicalTransportDefinitionNew(List<MasterProfitCenter> pcs, DateTime from, DateTime to, string satlesType, decimal regVal, string cre, string insCom, string insPol, int term, bool isReq, string _tp, string _book, string _level, string _serial, string _promotion, string _circuler, decimal _isRate, decimal _fromValue, decimal _toValue, string _type, string _circular)
        {
            try
            {
                int rows_aff = 0;
                InventoryDAL inv = new InventoryDAL();
                foreach (MasterProfitCenter pc in pcs)
                {

                    OracleParameter[] param = new OracleParameter[28];

                    inv.ConnectionOpen();
                    (param[0] = new OracleParameter("p_seq", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inv.GetSerialID();
                    (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_com;
                    (param[2] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
                    (param[3] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Mpc_cd;
                    (param[4] = new OracleParameter("p_ins_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insCom;
                    (param[5] = new OracleParameter("p_polc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = insPol;
                    (param[6] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
                    (param[7] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
                    (param[8] = new OracleParameter("p_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "CS";
                    (param[9] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
                    (param[10] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
                    (param[11] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
                    (param[12] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
                    (param[13] = new OracleParameter("p_itm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = 0.00;
                    (param[14] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = regVal;
                    (param[15] = new OracleParameter("p_is_req", OracleDbType.Byte, null, ParameterDirection.Input)).Value = isReq;
                    (param[16] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cre;
                    (param[17] = new OracleParameter("p_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
                    (param[18] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";// Nadeeka 02-04-2015
                    (param[19] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
                    (param[20] = new OracleParameter("p_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
                    (param[21] = new OracleParameter("p_svid_is_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _isRate;
                    (param[22] = new OracleParameter("p_svid_frm_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _fromValue;
                    (param[23] = new OracleParameter("p_svid_to_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _toValue;
                    (param[24] = new OracleParameter("p_svid_ins_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                    (param[25] = new OracleParameter("p_svid_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
                    (param[26] = new OracleParameter("p_svid_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
                    param[27] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                    rows_aff = UpdateRecords("sp_savevehicalinsurancedef", CommandType.StoredProcedure, param);
                    rows_aff = rows_aff + rows_aff;

                }
                pcs = null;
                //  ConnectionClose();
                return rows_aff;
            }
            catch (Exception) { return -1; }
        }
        //Change: remove item only ajuest to status and warr type(UOM) Udaya 01/06/2017
        public Int32 SaveANDDeleteStatusWarranty_log(string _item, string _status, string _UOM)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("P_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UOM;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_DELETE_ITM_WAR_LOG", CommandType.StoredProcedure, param);
            return effects;
        }
        //Change: remove item only ajuest to status Udaya 02/06/2017
        public Int32 SaveDeletePcWarranty_log(string _item, string _status, string _pcCode, string _comCode)
        {
            //Nadeeka 25-05-2015
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("P_PC_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcCode;
            (param[3] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_INST_DEL_ITEM_PC_WARA_LOG", CommandType.StoredProcedure, param);
            return effects;
        }
        //Add by Lakshan 05 Jun 2017
        public List<mst_itm_tax_structure_det> GetItemTaxStructureWeb(string _code)
        {
            List<mst_itm_tax_structure_det> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_TAX_STRU", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<mst_itm_tax_structure_det>(_dtResults, mst_itm_tax_structure_det.webConverter);
            }
            return _ListItems;
        }

        //Add by Dilshan 26 sep 2017
        public List<MgrCreation> GetMgrlocationWeb(string _code)
        {
            List<MgrCreation> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_TAX_STRU", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MgrCreation>(_dtResults, MgrCreation.webConverter);
            }
            return _ListItems;
        }
        //Add by Lakshan 05 Jun 2017
        public MST_TAX_CD GET_MST_TAX_CD_DATA(string _code)
        {
            MST_TAX_CD _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_MTC_TAX_RT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MST_TAX_CD_DATA", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MST_TAX_CD>(_dtResults, MST_TAX_CD.Converter)[0];
            }
            return _ListItems;
        }
        //Add by Lakshan 19Sep2017
        public DataTable GetEmailAddressData(string _com)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_alc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblloc", "sp_get_mst_alert_criteria_data", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //By Akila 2017/09/29
        public DataTable GetBankDetailsByBinCode(string _binCode)
        {
            DataTable _result = new DataTable();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_BinCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _binCode;
            param[1] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("BankDetails", "SP_Get_BNK_BY_BIN", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Added By Udaya 06.10.2017
        public DataTable getItemInSerial_Rev(string reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblREV", "SP_GET_APPITMSER_FOR_REV", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //akila 2017/10/10
        public List<PcAllowBanks> GetPcAllowBanks(string _comCode, string _profitCenter, string _moduleName)
        {
            DataTable _result = new DataTable();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_ProfitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_ModuleName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _moduleName;
            param[3] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("PcAllowBanks", "SP_GET_PC_ALW_BNKS", CommandType.StoredProcedure, false, param);

            List<PcAllowBanks> _pcAllowBanks = new List<PcAllowBanks>();
            if (_result.Rows.Count > 0)
            {
                _pcAllowBanks = DataTableExtensions.ToGenericList<PcAllowBanks>(_result, PcAllowBanks.Converter);
            }
            return _pcAllowBanks;
        }
        //Added By Udaya 06.10.2017
        public DataTable GetItemInProduction(string docNo, string comCode, string chk)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
            (param[2] = new OracleParameter("p_chk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chk;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPro", "sp_GetItem_In_Production", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Akila 2017/10/26
        public DataTable SearchSalesTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            OracleParameter[] param = new OracleParameter[4];
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _salesCode = null;
            string _mainCode = null;
            string _salesDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _salesCode = _searchText;
                        break;
                    case "MAIN TYPE":
                        _mainCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _salesDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _salesCode = (_salesCode != null) ? (_salesCode.ToUpper() + "%") : null;
            _mainCode = (_mainCode != null) ? (_mainCode.ToUpper() + "%") : null;
            _salesDesc = (_salesDesc != null) ? (_salesDesc.ToUpper() + "%") : null;

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesCode;
            (param[1] = new OracleParameter("p_MainType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCode;
            (param[2] = new OracleParameter("p_Description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_SEARCH_SALES_TYPES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAllCompanies() // Added by Chathura on 09-nov-2017
        {
            //MasterCompany _userList = null;
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblcomp", "SP_GET_ALL_COMPANIES", CommandType.StoredProcedure, false, param);

            //if (_dtResults.Rows.Count > 0)
            //{
            //    _userList = DataTableExtensions.ToGenericList<MasterCompany>(_dtResults, MasterCompany.Converter)[0];
            //}
            return _dtResults;
        }

        //Tharindu 2017-12-12
        public DataTable GetBrand(string _brnd)
        {
            //sp_getcategorydetail(p_cat in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brnd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_validatebrand", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Tharindu 2017-12-12
        public DataTable GetItemStatus(string _itmstatus)
        {
            //sp_getcategorydetail(p_cat in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmstatus;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_validate_itemstatus", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getExecMnagerMail(string excec, string type, string com)
        {
            try
            {
                DataTable _dtResults = null;

                OracleParameter[] param = new OracleParameter[4];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = excec;
                (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
                (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                _dtResults = QueryDataTable("tblcomp", "sp_get_employeeemails", CommandType.StoredProcedure, false, param);

                //if (_dtResults.Rows.Count > 0)
                //{
                //    _userList = DataTableExtensions.ToGenericList<MasterCompany>(_dtResults, MasterCompany.Converter)[0];
                //}
                return _dtResults;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Add by lakshan 28Nov2017
        public MasterItemBrand GET_ITM_BRAND_DATA(string _cd)
        {
            MasterItemBrand _obj = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mb_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mst_itm_brand_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _obj = DataTableExtensions.ToGenericList<MasterItemBrand>(_dtResults, MasterItemBrand.Converter)[0];
            }
            return _obj;
        }
        //Add by lakshan 28Nov2017
        public GradeMaster GET_MST_GRADE_DATA(string _com, string _chnl, string _cd)
        {
            GradeMaster _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mg_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mg_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[2] = new OracleParameter("p_mg_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mst_grade_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<GradeMaster>(_dtResults, GradeMaster.Converter)[0];
            }
            return _list;
        }

        //Akila 2017/12/04
        public List<Hpr_SysParameter> GetHprSysParaDetails(string _type, string _code)
        {
            List<Hpr_SysParameter> _paraList = new List<Hpr_SysParameter>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("Hpr_Sys_Para_Details", "SP_GET_SYSPARA_DET", CommandType.StoredProcedure, false, param);

            if (_tbl.Rows.Count > 0)
            {
                _paraList = DataTableExtensions.ToGenericList<Hpr_SysParameter>(_tbl, Hpr_SysParameter.Converter);
            }

            return _paraList;
        }


        //Akila 2017/12/11
        public DataTable GetSysParaDetails(string _company, string _chnl, string _type)
        {
            OracleParameter[] param = new OracleParameter[4];
            DataTable _parameters = new DataTable();
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _parameters = QueryDataTable("SysParaDetails", "SP_GET_SYS_PARA_DET_BYCHNL", CommandType.StoredProcedure, false, param);

            return _parameters;
        }
        //Akila 2017/12/15
        public Int16 UpdateRccReminderDetails(RCC _rcc)
        {
            Int16 rows_aff = 0;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_RccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc.Inr_no;
            (param[1] = new OracleParameter("p_RemCount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rcc.Inr_Rem_Count;
            (param[2] = new OracleParameter("p_Rem1Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rcc.Inr_Rem1_Snt_Date;
            (param[3] = new OracleParameter("p_Rem2Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rcc.Inr_Rem2_Snt_Date;
            (param[4] = new OracleParameter("p_Rem3Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rcc.Inr_Rem3_Snt_Date;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            
            rows_aff = (Int16)UpdateRecords("SP_UPDATE_RCC_REMDET", CommandType.StoredProcedure, param);
            return rows_aff;
        }
       //Add by Lakshan 28Dec2017
        public BusEntityItem GetBuninessEntityItemBySupplierItm(string _comp, string _code, string _itm)
        {
            BusEntityItem _ListItems = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mbii_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_mbii_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_mbii_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mst_busentity_itm_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<BusEntityItem>(_dtResults, BusEntityItem.Converter2)[0];
            }
            return _ListItems;
        }

        //akila 2017/12/28
        public Int16 UpdateRccWithRequest(RCC _rcc)
        {
            Int16 rows_aff = 0;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_inr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc.Inr_no;
            (param[1] = new OracleParameter("p_inr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc.Inr_mod_by;
            (param[2] = new OracleParameter("p_inr_is_add_to_stk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rcc.Inr_Is_Add_To_Stk;
            (param[3] = new OracleParameter("p_inr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc.Inr_Req_no;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            rows_aff = (Int16)UpdateRecords("SP_UPDATE_RCC_BCK_TO_STK", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        public DataTable GET_REF_AGE_SLOT(string _com)
        {
            //sp_getcategorydetail(p_cat in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_GET_REF_AGE_SLOT", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public string GetGrnItem(string com, string item)
        {
            string grnitem = "";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_GRNITEM", CommandType.StoredProcedure, false, param);

            if (_result != null && _result.Rows.Count > 0)
            {
                grnitem = _result.Rows[0][0].ToString();
            }

            return grnitem;
        }
        public List<ApprovalReqCategory> getAppReqCateList_New(string _Type, string _main)
        {
            OracleParameter[] param = new OracleParameter[3];
            List<ApprovalReqCategory> Items = new List<ApprovalReqCategory>();
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            (param[1] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getMoveSubTypebymain", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                Items = DataTableExtensions.ToGenericList<ApprovalReqCategory>(_dtResults, ApprovalReqCategory.Converternew);
            }
            return Items;
        }
        //Added By Dulaj 2018-Mar-10
        public DataTable GetProductCondtionParameters(string _com, string para_cd, string _tp, string to_stus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_rpp_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_rpp_para_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = para_cd;
            (param[2] = new OracleParameter("p_rpp_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[3] = new OracleParameter("to_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = to_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("refProdConTbl", "sp_get_product_contidon_parms", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Added By Dulaj 2018-Mar-5
        public DataTable GetProductCondtionParametersByCd(string _com, string para_cd, string _cd, string to_stus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_rpp_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_rpp_para_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = para_cd;
            (param[2] = new OracleParameter("p_rpp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[3] = new OracleParameter("to_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = to_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("refProdConTbl", "sp_get_parms_by_cd", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Added By Dulaj 2018-Mar-19
        public DataTable GetBatchStatus(string _com, string _loc, string _docType, string _direction, DateTime _frm, DateTime _to, Int16 _dateType, Int16 _isFinished, Int16 _wip,string doctypePending,int sp)
        {
            DataTable _result = new DataTable();
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            (param[3] = new OracleParameter("p_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _direction;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frm;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[6] = new OracleParameter("p_datetype", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _dateType;
            (param[7] = new OracleParameter("p_isfinshed", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isFinished;
            (param[8] = new OracleParameter("p_wip", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _wip;
            (param[9] = new OracleParameter("p_doctypePending", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctypePending;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (sp == 1)
            {
                 _result = QueryDataTable("batchSts", "SP_PDA_BATCH_STATUS", CommandType.StoredProcedure, false, param);
            }
            if (sp == 2)
            {
                 _result = QueryDataTable("batchSts", "SP_PDA_BATCH_STATUS_INV", CommandType.StoredProcedure, false, param);
            }
            return _result;
        }
        public DataTable GetItemStatusByUserSeq(string _tus_usrseq_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tus_usrseq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tus_usrseq_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("batchSts", "get_item_stas_by_user_seq", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetItemAvailability(string _item, string _com)
        {// Dilshan
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblItem", "get_itemavailability", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Dulaj 2018-Apr-10
       public DataTable GetUserDefineTemplate(string template, string user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_upd_tmp_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = template;
            (param[1] = new OracleParameter("p_upd_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblTemp", "get_template_by_usr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Dulaj 2018-Apr-11
        public Int32 SaveUserProfileTemplate(string _templateName, string _codes, string _values, string _userId, string _dectription, string _key, string _sessionId)
       {

           OracleParameter[] param = new OracleParameter[8];
           Int32 effects = 0;

           (param[0] = new OracleParameter("p_upd_tmp_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _templateName;
           (param[1] = new OracleParameter("p_upd_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _codes;
           (param[2] = new OracleParameter("p_upd_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _values;
           (param[3] = new OracleParameter("p_upd_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
           (param[4] = new OracleParameter("p_upd_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dectription;
           (param[5] = new OracleParameter("p_upd_key", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _key;
           (param[6] = new OracleParameter("p_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessionId;

           param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

           effects = (Int16)UpdateRecords("save_usr_pro_def", CommandType.StoredProcedure, param);

           return effects;

       }
       //Dulaj 12-Apr-2018
       public Int32 CheckTemplateName(string _tempName)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[1];
               (param[0] = new OracleParameter("p_tem_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tempName;

               OracleParameter orP = new OracleParameter("c_result", OracleDbType.Int32, null, ParameterDirection.Output);

               return ReturnSP_SingleValue("check_usr_template", CommandType.StoredProcedure, orP, param);
           }
           catch (Exception) { return 0; }
       }
        //Pasindu 2018/05/31
        public DataTable GetItemDetails(string p_location, string p_itemcode, string p_serial, string p_fromdt, string p_todt, string category01, string category02, string com)
       {
           OracleParameter[] param = new OracleParameter[9];
           (param[0] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_location;
           (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itemcode;
           (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_serial;
           (param[3] = new OracleParameter("p_fromdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(p_fromdt).Date;
           (param[4] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(p_todt).Date;
            (param[5] = new OracleParameter("p_cat01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category01;
            (param[6] = new OracleParameter("p_cat02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category02;
            (param[7] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _dtResults = QueryDataTable("tblItems", "SP_GET_ITEM_LIST_DETAILSCat", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
       //Pasindu 2018/05/31
       public DataTable GetItemAvaialableLocation(string p_serial)
       {
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_serial;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _dtResults = QueryDataTable("tblItems", "SP_ITEM_AVAILABLE_LOCATION", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
        //Dulaj 2018/Jul/04
        public DataTable GetRestrictedMrnLoc(string p_location, string p_itemcode, string p_todt)
       {
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_location;
           (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itemcode;
           (param[2] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(p_todt).Date;
           param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _dtResults = QueryDataTable("tblItems", "getrestrictedMrnloc", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
       public MasterLocation GetallLocationInfor(string _CompCode, string _LocCode)
       {
           MasterLocation _locList = null;

           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
           (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCode;
           param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("tblloc", "sp_get_all_location_by_code", CommandType.StoredProcedure, false, param);

           if (_dtResults.Rows.Count > 0)
           {
               _locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal)[0];
           }
           return _locList;
       }
        //Dulaj 2018/Aug/16
        public DataTable GetItmCostDetailSerial(string _item, string com, string type, string reccount, string status, string serial)
       {
           DataTable _dtResults = null;

           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
           (param[2] = new OracleParameter("p_count", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reccount;
           (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
           (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           if (type == "GRN")
           {
               _dtResults = QueryDataTable("tblItem", "sp_get_itm_costdet_ser_grn", CommandType.StoredProcedure, false, param);
           }
           else
           {
               _dtResults = QueryDataTable("tblItem", "sp_get_itm_costdet_serial", CommandType.StoredProcedure, false, param);
           }

           return _dtResults;
       }
       public Int32 save_busentity_newcom(string p_com, string p_cust_cd)
       {
           //shanuka on 30-09-2014
           OracleParameter[] param = new OracleParameter[3];
           Int32 effects = 0;
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
           (param[1] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cust_cd;
           param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           //effects = (Int32)UpdateRecords("sp_save_busentity_newcom", CommandType.StoredProcedure, param);
           effects = (Int16)UpdateRecords("sp_save_busentity_newcom", CommandType.StoredProcedure, param);
           return effects;

    }
       public DataTable LoadItemKitComponents_ACTIVE(string item)
       {
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_mikc_itm_code_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           return QueryDataTable("mst_itm_kit_component", "LOAD_KIT_ITM_COMPONENTS_ACTIVE", CommandType.StoredProcedure, false, param);
       }
        
        //Dulaj 2018/Oct/17
        public DataTable GetBinLocGRN(string com,string loc,string binCd,string decs)
       {
           DataTable _dtResults = new DataTable();
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
           (param[2] = new OracleParameter("p_BCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = binCd;
           (param[3] = new OracleParameter("p_BDes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = decs;
           param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           _dtResults = QueryDataTable("tblBin", "pkg_search_imp.sp_searchBinByLoc", CommandType.StoredProcedure, false, param);

           return _dtResults;
       }
     
        public DataTable Get_Custom_Assmnt_Det(string com, DateTime from, DateTime to, string type)
        {
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("customAssesment", "sp_get_cutom_assest", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Get_Shipment_Data(string com, DateTime from, DateTime to, string doc)
        {
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fro_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to.AddDays(1);
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("customAssesment", "SP_GET_SHIPMENT_DATA", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Get_Clr_usr(string com, DateTime from, DateTime to, string doc)
        {
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fro_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to.AddDays(1);
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("entryclr", "SP_GET_Clr_usr", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Get_Clr_Com(string com, DateTime from, DateTime to, string doc)
        {
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fro_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to.AddDays(1);
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("entryclr", "SP_GET_Clr_com", CommandType.StoredProcedure, false, param);
            return dt;
        }
        public DataTable Get_Clr_ShippingLine(string com, DateTime from, DateTime to, string doc)
        {
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fro_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = to.AddDays(1);
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("entryclr", "SP_GET_Clr_shpipping", CommandType.StoredProcedure, false, param);
            return dt;
        }

    //Written by Prabhath on 24/07/2013 for supp
    public class ODPStringVarray : IOracleCustomType, INullable
    {
        [OracleArrayMapping()]
        public string[] Array;
        public Commission_pc[] arr;

        private OracleUdtStatus[] m_statusArray;
        public OracleUdtStatus[] StatusArray
        {
            get
            {
                return this.m_statusArray;
            }
            set
            {
                this.m_statusArray = value;
            }
        }

        private bool m_bIsNull;

        public bool IsNull
        {
            get
            {
                return m_bIsNull;
            }
        }

        public static ODPStringVarray Null
        {
            get
            {
                ODPStringVarray obj = new ODPStringVarray();
                obj.m_bIsNull = true;
                return obj;
            }
        }

        public void ToCustomObject(OracleConnection con, IntPtr pUdt)
        {
            object objectStatusArray = null;
            Array = (string[])OracleUdt.GetValue(con, pUdt, 0, out objectStatusArray);
            m_statusArray = (OracleUdtStatus[])objectStatusArray;
        }

        public void FromCustomObject(OracleConnection con, IntPtr pUdt)
        {
            OracleUdt.SetValue(con, pUdt, 0, Array, m_statusArray);
        }

        public override string ToString()
        {
            if (m_bIsNull)
                return "ODPStringVarray.Null";
            else
            {
                string rtnstr = String.Empty;
                if (m_statusArray[0] == OracleUdtStatus.Null)
                    rtnstr = "NULL";
                else
                    rtnstr = Array.GetValue(0).ToString();
                for (int i = 1; i < m_statusArray.Length; i++)
                {
                    if (m_statusArray[i] == OracleUdtStatus.Null)
                        rtnstr += "," + "NULL";
                    else
                        rtnstr += "," + Array.GetValue(i).ToString();
                }
                return "ODPStringVarray(" + rtnstr + ")";
            }
        }

    }

 

    //Written by Prabhath on 24/07/2013
    [OracleCustomTypeMapping("EMS.MST_PC")]
    public class ODPVarrayFactory : IOracleCustomTypeFactory, IOracleArrayTypeFactory
    {
        // IOracleCustomTypeFactory
        public IOracleCustomType CreateObject()
        {
            return new ODPStringVarray();
        }

        // IOracleArrayTypeFactory Interface
        public Array CreateArray(int numElems)
        {
            return new string[numElems];
        }

        public Array CreateStatusArray(int numElems)
        {
            // CreateStatusArray may return null if null status information 
            // is not required.
            return new OracleUdtStatus[numElems];
        }

     
        }

        /// <summary>
        /// Udesh 01-Nov-2018
        /// Save Otp Authentication.
        /// </summary>
        /// <param name="_otpAuth">Otp Authentication reference.</param>
        /// <returns>int</returns>
        public int SaveOtpAuthentication(OtpAuthentication _otpAuth)
        {
          
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_SDK_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_TP;
            (param[1] = new OracleParameter("P_SDK_SB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_SB_TP;
            (param[2] = new OracleParameter("P_SDK_CUS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_CUS_CD;
            (param[3] = new OracleParameter("P_SDK_MOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_MOB;
            (param[4] = new OracleParameter("P_SDK_KEY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _otpAuth.SDK_KEY;
            (param[5] = new OracleParameter("P_SDK_IS_VALIDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _otpAuth.SDK_IS_VALIDATE;
            (param[6] = new OracleParameter("P_SDK_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _otpAuth.SDK_ACT;
            (param[7] = new OracleParameter("P_SDK_VALIDATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_VALIDATE_BY;
            (param[8] = new OracleParameter("P_SDK_VALIDATE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _otpAuth.SDK_VALIDATE_DT;
            (param[9] = new OracleParameter("P_SDK_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_SESSION;
            (param[10] = new OracleParameter("P_SDK_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_CRE_BY;
            (param[11] = new OracleParameter("P_SDK_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _otpAuth.SDK_CRE_DT;
            (param[12] = new OracleParameter("P_SDK_HASH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_HASH_KEY;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("pkg_dual_auth.sp_save_dual_auth", CommandType.StoredProcedure, param);
            return _effect;
        }

        public List<MasterItem> GetItemFromModel(string _Model)
        {// Wimal 16/06/2018
            List<MasterItem> _itemList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_itemOnModel", CommandType.StoredProcedure, false, param);

            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal2);
            }
            return _itemList;
        }

        /// <summary>
        /// Udesh 01-Nov-2018
        /// Get Duplicate Authentications.
        /// </summary>
        /// <param name="_otpAuth">Otp Authentication reference</param>
        /// <returns></returns>
        public DataTable GetDuplicateAuthentication(OtpAuthentication _otpAuth)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SDK_KEY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _otpAuth.SDK_KEY;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_dual_auth.sp_chk_duplicate_dual_auth", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        /// <summary>
        /// Udesh 01-Nov-2018
        /// Update Otp Authentication.
        /// </summary>
        /// <param name="_otpAuth">Otp Authentication reference.</param>
        /// <returns>int</returns>
        public int UpdateOtpAuthentication(OtpAuthentication _otpAuth)
        {

            int _effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_SDK_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_TP;
            (param[1] = new OracleParameter("P_SDK_CUS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_CUS_CD;
            (param[2] = new OracleParameter("P_SDK_IS_VALIDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _otpAuth.SDK_IS_VALIDATE;
            (param[3] = new OracleParameter("P_SDK_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _otpAuth.SDK_ACT;
            (param[4] = new OracleParameter("P_SDK_VALIDATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otpAuth.SDK_VALIDATE_BY;
            (param[5] = new OracleParameter("P_SDK_VALIDATE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _otpAuth.SDK_VALIDATE_DT;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("pkg_dual_auth.sp_update_dual_auth", CommandType.StoredProcedure, param);
            return _effect;
        }


        /// <summary>
        /// Gets the MST grade by company.
        /// Added by Udesh 15-Nov-2018
        /// </summary>
        /// <param name="_com">The COM.</param>
        /// <returns></returns>
        public DataTable GetMstGradeByCompany(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mg_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mst_grade_by_com", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }
        /// <summary>
        /// Udesh 12-Nov-2018
        /// Saves the bin assignment.
        /// </summary>
        /// <param name="_binAssignList">The bin assign list.</param>
        /// <returns>int</returns>
        public Int32 SaveBinAssignment(List<REF_BIN_ASSIGN> _binAssignList)
        {
            Int32 effects = 0;
            foreach (REF_BIN_ASSIGN _item in _binAssignList)
            {
                OracleParameter[] param = new OracleParameter[12];

                (param[0] = new OracleParameter("p_rba_bnk_id,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.RBA_BNK_ID;
                (param[1] = new OracleParameter("p_rba_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.RBA_TP;
                (param[2] = new OracleParameter("p_rba_frm_dt,", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.RBA_FRM_DT;
                (param[3] = new OracleParameter("p_rba_to_dt,", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.RBA_TO_DT;
                (param[4] = new OracleParameter("p_rba_bin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.RBA_BIN_NO;
                (param[5] = new OracleParameter("p_rba_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _item.RBA_ACT;
                (param[6] = new OracleParameter("p_rba_session_id,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.RBA_SESSION_ID;
                (param[7] = new OracleParameter("p_rba_cre_by,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.RBA_CRE_BY;
                (param[8] = new OracleParameter("p_rba_cre_dt,", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.RBA_CRE_DT;
                (param[9] = new OracleParameter("p_rba_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.RBA_MOD_BY;
                (param[10] = new OracleParameter("p_rba_mod_dt,", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.RBA_MOD_DT;
                
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = effects + (Int32)UpdateRecords("pk_ref_bin_assign.sp_save_bin_assign", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        /// <summary>
        /// Udesh 12-Nov-2018
        /// Gets the bin assignment details by bank code.
        /// </summary>
        /// <param name="_bankCode">The bank code.</param>
        /// <returns>Bin Assignment Details</returns>
        public DataTable GetBinAssignmentDetailsByBankCode(string _bankCode)
        {        
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rba_bnk_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pk_ref_bin_assign.sp_get_bin_assign_by_bank", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        /// <summary>
        /// Udesh 23-Nov-2018
        /// Gets the bin assignment details by bin number.
        /// </summary>
        /// <param name="_binNumber">The bin number.</param>
        /// <returns>Bin Assignment Details</returns>
        public REF_BIN_ASSIGN GetBinAssignmentDetailsByBinNumber(string _binNumber, DateTime _toDate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_rba_bin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _binNumber;
            (param[1] = new OracleParameter("p_rba_bin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toDate.ToString("dd/MMM/yyyy");
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pk_ref_bin_assign.sp_get_bin_assign_by_bin_no", CommandType.StoredProcedure, false, param);

            REF_BIN_ASSIGN _ref_bin_assign = null;

            if (_dtResults.Rows.Count > 0)
            {
                _ref_bin_assign = DataTableExtensions.ToGenericList<REF_BIN_ASSIGN>(_dtResults, REF_BIN_ASSIGN.Converter)[0];
            }

            return _ref_bin_assign;
        }
        public DataTable GetContribution(string itmCd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_res_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;            
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_con", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public Int32 UpdateItemContribution(string itmCd, string invenCon, string gPCon, string brnCon)
        {
            Int32 effects = 0;
           
                OracleParameter[] param = new OracleParameter[5];

                (param[0] = new OracleParameter("p_mi_cat_inv_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invenCon;
                (param[1] = new OracleParameter("p_mi_cat_gp_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = gPCon;
                (param[2] = new OracleParameter("p_mi_cat_brand_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brnCon;
                (param[3] = new OracleParameter("p_mi_cd,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
               

                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = effects + (Int32)UpdateRecords("SP_Update_Item_con", CommandType.StoredProcedure, param);            

            return effects;
        }
        public Int32 UpdateItemCatContribution(string cat, string invenCon, string gPCon)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_mi_cat_inv_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invenCon;
            (param[1] = new OracleParameter("p_mi_cat_gp_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = gPCon;
            (param[2] = new OracleParameter("p_mi_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = effects + (Int32)UpdateRecords("SP_Update_Item_con_by_cat", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 UpdateItemBrndContribution(string brndCon, string brnd)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_mi_brnd_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brndCon;
            (param[1] = new OracleParameter("p_mi_brand,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brnd;           
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //if (brndCon == "WELDRO")
            //{
            //    string abc = "123456";
            //}
            effects = effects + (Int32)UpdateRecords("SP_Update_Item_con_by_brnd", CommandType.StoredProcedure, param);

            return effects;
        }
        public REF_ITM_CATE1 GetItemCate1ById(string cd)
        {
            REF_ITM_CATE1 _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_mi_brnd_con,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEMCATE1_By_id", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<REF_ITM_CATE1>(_dtResults, REF_ITM_CATE1.Converter2)[0];
            }
            return _ListItems;
        }
        public List<MobilePrefix> GetMobilePrefixByPrefixCd(Int32 prefix)
        {
            List<MobilePrefix> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_mr_pref,", OracleDbType.Int32, null, ParameterDirection.Input)).Value = prefix;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MOB_PRE", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MobilePrefix>(_dtResults, MobilePrefix.Converter);
            }
            return _ListItems;
        }
        public List<Mst_Sys_Para> _Mst_Sys_Para(string _company, string _loc, string _type)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<Mst_Sys_Para> _list = new List<Mst_Sys_Para>();

            (param[0] = new OracleParameter("p_rest_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_Get_dispautocnl_loc", CommandType.StoredProcedure, false, param);
            //DataTable _tbl = QueryDataTable("int_req", "sp_rpt_col_cap_int", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<Mst_Sys_Para>(_dtResults, Mst_Sys_Para.Converter);
            }
            return _list;
        }

        public DataTable GetReimbusmentStus(string docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "SP_GET_REIMBUSMENT_STATUS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
    }
}
