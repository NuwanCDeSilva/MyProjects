using System;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Linq;
using System.Text;
using FF.BusinessObjects;
using Oracle.DataAccess.Client;
using FF.BusinessObjects.Tours;
using FF.BusinessObjects.ToursNew;
using FF.BusinessObjects.General;
using FF.BusinessObjects.Commission;
using FF.BusinessObjects.Financial;
using FF.BusinessObjects.Services;
using FF.BusinessObjects.Account;
using FF.BusinessObjects.Enadoc;

namespace FF.DataAccessLayer
{
    /// <summary>
    /// This is a Data Access Layer class for common search functionalty.
    /// Created By : Miginda Geeganage.
    /// Created On : 16/03/2012
    /// Modified By :
    /// Modified On :
    /// </summary>
    public class CommonSearchDAL : BaseDAL
    {
        //kapila
        public DataTable GetPreferLocSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LOCATION":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _description = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search_inv.sp_searchprefermrnlocs", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable SearchMasterTaxRateCodes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.sp_searchmastertaxratecode", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable SearchMasterTaxCodes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.sp_searchmastertaxcode", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetVItemforInvoiceSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchvitemforinvoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable Get_PendingDoc_ByRefNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _manDocNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "MANUAL NO":
                        _manDocNo = _searchText;
                        break;

                    case "INVOICE":
                        _manDocNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _manDocNo = (_manDocNo != null) ? (_manDocNo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_payType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_manDocNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manDocNo;
            (param[3] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_Pending_Adv", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetAvailableSerialSCM(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _status = null;
            string _serial = null;
            string _serial2 = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "OTHER SERIAL":
                        _serial2 = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _serial2 = (_serial2 != null) ? (_serial2.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[6] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchvalidserscm", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable SearchPromoCommDefData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _code = _searchText;
                        break;
                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_searchpromotcomm", CommandType.StoredProcedure, false, param);
        }

        //kapila
        public DataTable Get_CLS_ALW_LOC_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_scal_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_search_CLS_ALW_LOC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetAllPBLevelByBookData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE LEVEL":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchallpblevelbybook", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetAllPriceLevelByBookData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE LEVEL":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchpricelevelbybook", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetSerialPriceForCancel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _serial = null;
            string _pb = null;
            string _pblvl = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;
                    case "SERIAL":
                        _serial = _searchText;
                        break;
                    case "PRICEBOOK":
                        _pb = _searchText;
                        break;
                    case "LEVEL":
                        _pblvl = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _pb = (_pb != null) ? (_pb.ToUpper() + "%") : null;
            _pblvl = (_pblvl != null) ? (_pblvl.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpbserialforcancel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetCircularSearchForCancel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _serial = null;
            string _pb = null;
            string _pblvl = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;
                    case "SERIAL":
                        _serial = _searchText;
                        break;
                    case "PRICEBOOK":
                        _pb = _searchText;
                        break;
                    case "LEVEL":
                        _pblvl = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _pb = (_pb != null) ? (_pb.ToUpper() + "%") : null;
            _pblvl = (_pblvl != null) ? (_pblvl.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[2] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[3] = new OracleParameter("p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpbserialforcancel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable SearchLoyaltyCardNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _cardno = null;
            string _serial = null;
            string _type = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CARD NO":
                        _cardno = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "TYPE":
                        _type = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _cardno = (_cardno != null) ? (_cardno.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";
            _type = (_type != null) ? (_type.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[1].ToString()).Date;

            (param[2] = new OracleParameter("p_cdno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchloyaltycardno", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetCancelRequest(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _ref = null;
            string _inv = null;
            string _job = null;
            string _creditnote = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory)
                {
                    case "Request No":
                        _ref = _searchText;
                        break;

                    case "Invoice No":
                        _inv = _searchText;
                        break;

                    case "Job No":
                        _job = _searchText;
                        break;

                    case "Credit Note":
                        _creditnote = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : null;
            _inv = (_inv != null) ? (_inv.ToUpper() + "%") : null;
            _job = (_job != null) ? (_job.ToUpper() + "%") : null;
            _creditnote = (_creditnote != null) ? (_creditnote.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();


            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[4] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[5] = new OracleParameter("p_credit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creditnote;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_cancel_req", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetQuotation4Inv(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            string _customer = null;
            string _name = null;
            string _ref = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;

                    case "PARTY CODE":
                        _customer = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "REFERENCE":
                        _ref = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : "%";

            //sp_search_quotation(p_com in NVARCHAR2,p_profit IN NVARCHAR2,p_date in date,p_quotation in NVARCHAR2, p_customer in NVARCHAR2 ,  p_name in NVARCHAR2,c_data out SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[3] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_quotation_4_inv", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila 23/2/2016
        public DataTable GetServiceJobsF3(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string NAME = null;
            string DESCRIPTION = null;
            string ADDRESS1 = null;
            string ADDRESS2 = null;
            string Stage = null;
            string Mobile = null;
            string Serial = null;
            string ContPerson = null;
            string ContNo = null;
            string REQUEST = null;

            string SEARCH_KEY = null;





            string MAINJOB = null;

            Int32 isCustDate = 0;

            if (searchParams[2].ToString() == "")
            {
                Stage = null;
            }
            else
            {
                Stage = searchParams[2].ToString();
            }

            if (searchParams[3].ToString() == "")
            {
                isCustDate = 0;
            }
            else
            {
                isCustDate = Convert.ToInt32(searchParams[3].ToString());
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEARCH KEY":
                        SEARCH_KEY = _searchText;
                        break;
                    case "JOB":
                        JOB = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDRESS1":
                        ADDRESS1 = _searchText;
                        break;

                    case "ADDRESS2":
                        ADDRESS2 = _searchText;
                        break;

                    case "MOBILE":
                        Mobile = _searchText;
                        break;
                    case "SERIAL":
                        Serial = _searchText;
                        break;
                    case "CONTACT":
                        ContPerson = _searchText;
                        break;
                    case "CONTACT NO":
                        ContNo = _searchText;
                        break;

                    case "REQUEST":
                        REQUEST = _searchText;
                        break;
                    case "MAIN JOB":
                        MAINJOB = _searchText;
                        break;
                    default:
                        break;
                }
            }
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION.ToUpper()) : null;
            ADDRESS1 = (ADDRESS1 != null) ? (ADDRESS1.ToUpper()) : null;
            ADDRESS2 = (ADDRESS2 != null) ? (ADDRESS2.ToUpper()) : null;
            Mobile = (Mobile != null) ? (Mobile.ToUpper()) : null;
            REQUEST = (REQUEST != null) ? (REQUEST.ToUpper()) : null;
            MAINJOB = (MAINJOB != null) ? (MAINJOB.ToUpper()) : null;
            Serial = (Serial != null) ? (Serial.ToUpper()) : null;
            ContPerson = (ContPerson != null) ? (ContPerson.ToUpper()) : null;
            ContNo = (ContNo != null) ? (ContNo.ToUpper()) : null;

            if (_searchText != null && _searchText.Length > 0)
            {
                _fromDate = DateTime.MinValue;
                _toDate = DateTime.MaxValue;
            }

            OracleParameter[] param = new OracleParameter[19];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[6] = new OracleParameter("P_Stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stage;
            (param[7] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[8] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS1;
            (param[9] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS2;
            (param[10] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mobile;
            (param[11] = new OracleParameter("P_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Serial;
            (param[12] = new OracleParameter("P_CONTPER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ContPerson;
            (param[13] = new OracleParameter("P_CONTNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ContNo;
            (param[14] = new OracleParameter("P_ISCUSTEXPECTDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isCustDate;
            (param[15] = new OracleParameter("P_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            (param[16] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAINJOB;
            (param[17] = new OracleParameter("P_SEARCH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARCH_KEY;
            param[18] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_JOBS_F3", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable SearchSubLocationData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_mloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_searchsublocations", CommandType.StoredProcedure, false, param);
        }
        //kapila
        public DataTable GetDCNItems(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Item = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM CODE":
                        _Item = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _Item = (_Item != null) ? (_Item.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_qno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchdcnitems", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila 13/1/2016
        public DataTable GetSearchDataBySerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _serial = null;
            string _chassis = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;


                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "CHASSIS NO":
                        _chassis = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblIssuedSerialSearch", "pkg_search.sp_searchdatabyserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 19/11/2015
        public DataTable GetAcInsSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[11];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rccno = null;
            string _item = null;
            string _serial = null;
            string _warranty = null;
            string _stage = null;
            string _inv = null;
            string _cusname = null;
            string _cusaddr = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RCC NO":
                        _rccno = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "WARRANTY":
                        _warranty = _searchText;
                        break;

                    case "STAGE":
                        _stage = _searchText;
                        break;

                    case "INVOICE":
                        _inv = _searchText;
                        break;
                    case "CUS NAME":
                        _cusname = _searchText;
                        break;
                    case "CUS ADDR":
                        _cusaddr = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rccno = (_rccno != null) ? (_rccno.ToUpper() + "%") : "%";
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : "%";
            _stage = (_stage != null) ? (_stage.ToUpper() + "%") : "%";
            _inv = (_inv != null) ? (_inv.ToUpper() + "%") : "%";
            _cusname = (_cusname != null) ? (_cusname.ToUpper() + "%") : "%";
            _cusaddr = (_cusaddr != null) ? (_cusaddr.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            (param[2] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[6] = new OracleParameter("p_stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stage;
            (param[7] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[8] = new OracleParameter("p_cusname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusname;
            (param[9] = new OracleParameter("p_cusaddr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusaddr;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_acins", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSignOnSeqByDate(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //sp_searchrawpricelevel (p_com in NVARCHAR2, p_book in NVARCHAR2,p_level in NVARCHAR2,p_description in NVARCHAR2,c_data out sys_refcursor);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchsignonseqbydate", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetSignOnSeq(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _level = null;
            string _desc = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LEVEL":
                        _level = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _level = (_level != null) ? (_level.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_searchrawpricelevel (p_com in NVARCHAR2, p_book in NVARCHAR2,p_level in NVARCHAR2,p_description in NVARCHAR2,c_data out sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString(); (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchsignonseq", CommandType.StoredProcedure, false, param);

            return _result;
        }
        public DataTable SearchInv4InsReq(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;
            string _JOB = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    case "JOB": _JOB = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _manualrefno = (_manualrefno != null) ? (_manualrefno.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer + "%") : "%";
            _customername = (_customername != null) ? (_customername + "%") : "%";
            _status = (_status != null) ? (_status + "%") : "%";
            _JOB = (_JOB != null) ? (_JOB + "%") : "%";

            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[8] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JOB;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchInvoice", "pkg_search.sp_searchinvoiceInsReq", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable GetInsDebitNoteAccSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountseq = string.Empty;
            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT":
                        _accountseq = _searchText;
                        break;

                    case "ACCOUNT NO": //added by shani 19-02-2013
                        _accountno = _searchText;
                        break;



                    default:
                        break;
                }
            }

            _accountseq = _accountseq.Replace("%", "");
            _accountno = _accountno.Replace("%", "");

            if (string.IsNullOrEmpty(_accountseq))
            {
                _accountseq = "%";
            }

            if (string.IsNullOrEmpty(_accountno))
            {
                _accountno = "%";
            }

            if (string.IsNullOrEmpty(_invoiceno))
            {
                _invoiceno = "%";
            }

            //PROCEDURE sp_searchhpaccount(p_com IN NVARCHAR2,p_profit IN NVARCHAR2,p_status in NVARCHAR2,p_seqno in NUMBER,p_account in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();


            (param[2] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountseq;
            (param[3] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchinsdebitnoteacc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetInsPayReqAccSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountseq = string.Empty;
            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT":
                        _accountseq = _searchText;
                        break;

                    case "ACCOUNT NO": //added by shani 19-02-2013
                        _accountno = _searchText;
                        break;



                    default:
                        break;
                }
            }

            _accountseq = _accountseq.Replace("%", "");
            _accountno = _accountno.Replace("%", "");

            if (string.IsNullOrEmpty(_accountseq))
            {
                _accountseq = "%";
            }

            if (string.IsNullOrEmpty(_accountno))
            {
                _accountno = "%";
            }

            if (string.IsNullOrEmpty(_invoiceno))
            {
                _invoiceno = "%";
            }

            //PROCEDURE sp_searchhpaccount(p_com IN NVARCHAR2,p_profit IN NVARCHAR2,p_status in NVARCHAR2,p_seqno in NUMBER,p_account in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();


            (param[2] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountseq;
            (param[3] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchinspayreqacc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetSupplierQuotation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            string _customer = null;
            string _name = null;
            string _ref = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;

                    case "PARTY CODE":
                        _customer = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "REFERENCE":
                        _ref = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : "%";

            //sp_search_quotation(p_com in NVARCHAR2,p_profit IN NVARCHAR2,p_date in date,p_quotation in NVARCHAR2, p_customer in NVARCHAR2 ,  p_name in NVARCHAR2,c_data out SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[3] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_supp_quot", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable searchGRNData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _item = _searchText;
                        break;

                    case "INVOICE":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("P_INVO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.SP_SEARCH_GRN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchAgreementData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "CUSTOMER":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_search_agreement", CommandType.StoredProcedure, false, param);
        }
        //Sahan

        public DataTable SearchAllVehicles(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string REG = null;
            string bRAND = null;
            string MODEL = null;
            string TYPE = null;
            string OWNER = null;
            string CONTACT = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "NUMBER":
                        REG = _searchText;
                        break;
                    case "BRAND":
                        bRAND = _searchText;
                        break;
                    case "MODEL":
                        MODEL = _searchText;
                        break;
                    case "TYPE":
                        TYPE = _searchText;
                        break;
                    case "OWNER":
                        OWNER = _searchText;
                        break;
                    case "CONTACT NO":
                        CONTACT = _searchText;
                        break;
                }
            }

            REG = (REG != null) ? (REG + "%") : null;
            bRAND = (bRAND != null) ? (bRAND + "%") : null;
            MODEL = (MODEL != null) ? (MODEL + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            OWNER = (OWNER != null) ? (OWNER + "%") : null;
            CONTACT = (CONTACT != null) ? (CONTACT + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_REG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REG;
            (param[3] = new OracleParameter("P_bRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bRAND;
            (param[4] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MODEL;
            (param[5] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TYPE;
            (param[6] = new OracleParameter("P_OWNER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OWNER;
            (param[7] = new OracleParameter("P_CONTACT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CONTACT;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_ALL_VEHICLES", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable SearchMasterType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_search_master_type", CommandType.StoredProcedure, false, param);
        }

        //kapila
        public DataTable GetAgrClaimTypeSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];


            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_agr_claim_type", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetAgrTypeSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];


            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_agr_type", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetHpAcc4ActiveSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT NO":
                        _accountno = _searchText;
                        break;

                    case "INVOICE NO":
                        _invoiceno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;
            _invoiceno = (_invoiceno != null) ? (_invoiceno.ToUpper() + "%") : null;

            //PROCEDURE sp_searchhpaccount(p_com IN NVARCHAR2,p_profit IN NVARCHAR2,p_status in NVARCHAR2,p_seqno in NUMBER,p_account in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchhpacc4active", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetDepositChequeSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountseq = string.Empty;
            string _accountno = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CHQNO":
                        _accountseq = _searchText;
                        break;

                    case "CHEQUENO": //added by shani 19-02-2013
                        _accountno = _searchText;
                        break;


                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _accountseq = (_accountseq != null) ? (_accountseq.ToUpper() + "%") : null;
            _accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2]);
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]);

            (param[4] = new OracleParameter("p_chq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountseq;
            (param[5] = new OracleParameter("p_chqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchdeposit_chqno", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetItemSupplierSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_item_supplier", CommandType.StoredProcedure, false, param);

            return _dtResults;

        }

        public DataTable GetCustGradeSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = "0";
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "0";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];

            //  (param[0] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _code;
            (param[0] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_satis_grade", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCustSatisSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_cust_satisfac", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCustQuestSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_cust_question", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetItemSearchDataByCat(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchitembycate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_employee_All(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _epf = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _epf = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_empEpf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_search_Employee_All", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSerialNICAll(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string serial = null;
            string NIC = null;
            string province = null;
            string serial2 = null;
            string regno = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL":
                        serial = _searchText;
                        break;

                    case "NIC":
                        NIC = _searchText;
                        break;

                    case "PROVINCE":
                        province = _searchText;
                        break;

                    case "CHASSIS":
                        serial2 = _searchText;
                        break;

                    case "REGNO":
                        regno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            serial = (serial != null) ? (serial.ToUpper() + "%") : null;
            NIC = (NIC != null) ? (NIC.ToUpper() + "%") : null;
            province = (province != null) ? (province.ToUpper() + "%") : null;
            serial2 = (serial2 != null) ? (serial2.ToUpper() + "%") : null;
            regno = (regno != null) ? (regno.ToUpper() + "%") : null;

            //p_town in NVARCHAR2,p_district in NVARCHAR2,p_province in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[2] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial2;
            (param[3] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = regno;
            (param[4] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NIC;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GET_Serial_NIC_ALL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable SearchJobStage(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_SearchJobStage", CommandType.StoredProcedure, false, param);
        }

        //kapila
        public DataTable GatePassSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _des = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _code = _searchText;
                        break;

                    case "JOB NO":
                        _des = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _des = (_des != null) ? (_des.ToUpper() + "%") : null;

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2].ToString()).Date;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.SP_SEARCH_GATEPASS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable CustSatisfacSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _des = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SATISFACTION CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _des = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _des = (_des != null) ? (_des.ToUpper() + "%") : null;

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchcustsatisfac", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable searchOfficeTownData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string town = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TOWN":
                        town = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            town = (town != null) ? (town.ToUpper() + "%") : null;

            //p_town in NVARCHAR2,p_district in NVARCHAR2,p_province in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;
            //(param[1] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;

            //(param[2] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GET_Office_Town", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTown_new(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string town = null;
            string district = null;
            string province = null;
            string DS = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TOWN":
                        town = _searchText;
                        break;

                    case "DISTRICT":
                        district = _searchText;
                        break;

                    case "PROVINCE":
                        province = _searchText;
                        break;

                    case "DS":
                        DS = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            town = (town != null) ? (town.ToUpper() + "%") : null;
            district = (district != null) ? (district.ToUpper() + "%") : null;
            province = (province != null) ? (province.ToUpper() + "%") : null;
            DS = (DS != null) ? (DS.ToUpper() + "%") : null;

            //p_town in NVARCHAR2,p_district in NVARCHAR2,p_province in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;
            (param[1] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;

            (param[2] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[3] = new OracleParameter("p_ds", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DS;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GET_Towns_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable searchFinAdjTypeData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_search_adj_types", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable searchDepositBankCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _accname = null;
            string _acc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BANK":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ACCNAME":
                        _accname = _searchText;
                        break;

                    case "ACC":
                        _acc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _accname = (_accname != null) ? (_accname.ToUpper() + "%") : null;
            _acc = (_acc != null) ? (_acc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_accname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accname;
            (param[6] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_search_pc_dep_bank", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable searchPayCircularData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.SP_get_pay_circular", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable searchTownData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string town = null;
            string district = null;
            string province = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TOWN":
                        town = _searchText;
                        break;

                    case "DISTRICT":
                        district = _searchText;
                        break;

                    case "PROVINCE":
                        province = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            town = (town != null) ? (town.ToUpper() + "%") : null;
            district = (district != null) ? (district.ToUpper() + "%") : null;
            province = (province != null) ? (province.ToUpper() + "%") : null;

            //p_town in NVARCHAR2,p_district in NVARCHAR2,p_province in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;
            (param[1] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;

            (param[2] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GET_Town", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchBusDeptData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchallbusdept", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchBusDesigData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_dep", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchallbusdesig", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 12/8/2014
        public DataTable SearchSalesPromotor(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _epf = null;
            string _firstname = null;
            string _lastname = null;
            string _code = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF":
                        _epf = _searchText;
                        break;

                    case "FIRST NAME":
                        _firstname = _searchText;
                        break;

                    case "LAST NAME":
                        _lastname = _searchText;
                        break;

                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : "%";
            _firstname = (_firstname != null) ? (_firstname.ToUpper() + "%") : "%";
            _lastname = (_lastname != null) ? (_lastname.ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";

            //sp_searchemployeeinpc(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_epf in NVARCHAR2,p_firstname in NVARCHAR2,p_lastname in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];


            SalesDAL _salesDAL = new SalesDAL();

            List<MasterSalesPriorityHierarchy> _hierarchy = _salesDAL.GetSalesPriorityHierarchy(searchParams[0].ToString(), searchParams[1].ToString(), "PC_PRIT_HIERARCHY", "PC");

            // pc 
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "PC";
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchsalespromotor", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                return _dtResults;
            }
            // company 
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "COM";
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchsalespromotor", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                return _dtResults;
            }



            // Sub Channel
            string _schannl = string.Empty;
            if (_hierarchy != null && _hierarchy.Count > 0) _hierarchy = _hierarchy.Where(x => x.Mpi_cd == "SCHNL").ToList();
            if (_hierarchy != null && _hierarchy.Count > 0)
            {
                foreach (MasterSalesPriorityHierarchy _one in _hierarchy)
                {
                    _schannl = _one.Mpi_val;
                }

            }


            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "SCHNL";
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schannl;

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchsalespromotor", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                return _dtResults;
            }

            //  Channel
            string _channl = string.Empty;
            if (_hierarchy != null && _hierarchy.Count > 0) _hierarchy = _hierarchy.Where(x => x.Mpi_cd == "CHNL").ToList();
            if (_hierarchy != null && _hierarchy.Count > 0)
            {
                foreach (MasterSalesPriorityHierarchy _one in _hierarchy)
                {
                    _channl = _one.Mpi_val;
                }

            }


            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "CHNL";
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channl;

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchsalespromotor", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                return _dtResults;
            }


            return _dtResults;
        }
        // NADEEKA 11-05-2015
        public DataTable SearchPromotor(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _epf = null;
            string _firstname = null;
            string _lastname = null;
            string _code = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF":
                        _epf = _searchText;
                        break;

                    case "FIRST NAME":
                        _firstname = _searchText;
                        break;

                    case "LAST NAME":
                        _lastname = _searchText;
                        break;

                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : "%";
            _firstname = (_firstname != null) ? (_firstname.ToUpper() + "%") : "%";
            _lastname = (_lastname != null) ? (_lastname.ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";

            //sp_searchemployeeinpc(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_epf in NVARCHAR2,p_firstname in NVARCHAR2,p_lastname in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchpromotor", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public DataTable SearchReceiptByAnal3(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _receiptNo = null;
            string _manualNo = null;
            string _date = null;
            // string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT NO":
                        _receiptNo = _searchText;
                        break;

                    case "MANUAL NO":
                        _manualNo = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _receiptNo = (_receiptNo != null) ? (_receiptNo.ToUpper() + "%") : null;
            _manualNo = (_manualNo != null) ? (_manualNo.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;
            if (_receiptNo == null)
            {
                _receiptNo = _manualNo;
            }
            // _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            //sp_search_receipt( p_com in NVARCHAR2,p_pc IN NVARCHAR2, p_docno in NVARCHAR2,p_recTp in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;
            (param[3] = new OracleParameter("p_recTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_rec_by_anal3", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetSearchChqByDate(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _chqNo = null;
            string _bankCd = null;
            string _date = null;
            string _pc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                //   SARD_REF_NO as "CHEQUE NO", sar_receipt_type AS "RECEIPT TYPE",SARD_CHQ_BANK_CD as "BANK",sard_chq_dt as "DATE"
                switch (_searchCatergory.ToUpper())
                {
                    case "CHEQUE NO":
                        _chqNo = _searchText;
                        break;

                    case "BANK":
                        _bankCd = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText.ToString();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _chqNo = (_chqNo != null) ? (_chqNo.ToUpper() + "%") : null;
            _bankCd = (_bankCd != null) ? (_bankCd.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;
            _pc = (_pc != null) ? (_pc.ToUpper() + "%") : null;

            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_refNo in NVARCHAR2,p_bankCd in NVARCHAR2,p_chqDate in DATE,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();//_pc;
            (param[2] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqNo;
            (param[3] = new OracleParameter("p_bankCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString() == "" ? _bankCd : searchParams[2].ToString();
            (param[4] = new OracleParameter("p_chqDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString()).Date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblSearch", "pkg_search.sp_search_Mgr_Iss_cheque", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetManagerIssuReceipts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _othRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "OTH REF NO":
                        _othRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _othRef = (_othRef != null) ? (_othRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[5] = new OracleParameter("p_othRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othRef;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchManIssueReceipt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetGenDiscSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[3];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchgendiscdata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By kapila on 27/5/2014
        public DataTable GetBusinessCompanyData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;
            string _id = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "ID":
                        _id = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;
            _id = (_id != null) ? (_id.ToUpper() + "%") : null;

            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _id;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_searchbusinesscompdata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Getregionsearchdata(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[4];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchregiondata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Getzonesearchdata(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[4];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchzonedata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Getareasearchdata(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[4];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchareadata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 21/5/2014
        public DataTable GetServiceAgentLocation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address = null;
            string _city = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            //_address = (_address != null) ? (_address.ToUpper() + "%") : null;
            //_city = (_city != null) ? (_city.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            //(param[3] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            //(param[4] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_Service_Agent_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //This is method for testing.
        public DataTable GetCommonSearchData(string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Query Data base.
            _dtResults = QueryDataTable("tblSearchData", "sp_getcommonsearchdata", CommandType.StoredProcedure, false,
                                                   new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            return _dtResults;
        }

        //DAL method for location search.
        public DataTable GetLocationSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_searchlocation", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 7/6/2012
        public DataTable GetIssuedSerialSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _status = null;
            string _serial = null;
            string _docNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[6] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblIssuedSerialSearch", "pkg_search.sp_searchissuedserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 7/6/2012
        public DataTable GetIssuedSerialSearchDataOth(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _status = null;
            string _serial = null;
            string _docNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[6] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblIssuedSerialSearch", "pkg_search.sp_searchissuedserialOth", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Available Serial Search
        //Code by Prabhath on 19/03/2012
        public DataTable GetAvailableSerialSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _status = null;
            string _serial = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchavailableserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Available Serial Search
        //Code by darshana on 09/08/2012
        public DataTable GetAvailableSerialWithOthSerialSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _status = null;
            string _serial = null;
            string _serial2 = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "OTHER SERIAL":
                        _serial2 = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _serial2 = (_serial2 != null) ? (_serial2.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[6] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchvalidserwithothser", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Available None-Serials Search
        //Code by Chamal on 05/07/2012
        public DataTable GetAvailableNoneSerialSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _indocno = null;
            string _itemstatus = null;
            string _warrno = null;
            string _serialseq = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEQ. ID":
                        _serialseq = _searchText;
                        break;

                    case "ITEM STATUS":
                        _itemstatus = _searchText;
                        break;

                    case "INWARD DOCUMENT":
                        _indocno = _searchText;
                        break;

                    case "WARRANTY NO":
                        _warrno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _indocno = (_indocno != null) ? (_indocno.ToUpper() + "%") : null;
            _itemstatus = (_itemstatus != null) ? (_itemstatus.ToUpper() + "%") : null;
            _warrno = (_warrno != null) ? (_warrno.ToUpper() + "%") : null;
            _serialseq = (_serialseq != null) ? (_serialseq.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_inwarddocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _indocno;
            (param[5] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrno;
            (param[6] = new OracleParameter("p_serseq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialseq;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchavailablenoneserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Item Search from Item Master
        //Code by Prabhath on 19/03/2012
        public DataTable GetItemSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            string _Part_No = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;
                    case "PART NO":
                        _Part_No = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _Part_No = (_Part_No != null) ? (_Part_No.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_part_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Part_No;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_searchitem_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by Prabhath on 13/09/2012
        public DataTable GetItemforInvoiceSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            string _partNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    case "PART NO":
                        _partNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _partNo = (_partNo != null) ? (_partNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_partNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _partNo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchitemforinvoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        /// <summary>
        /// DAL method for User Location search.
        /// Created By : Mignda Geeganage On 20/03/2012
        /// </summary>
        public DataTable GetUserLocationSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblUserlocation", "pkg_search.sp_searchuserrolechnnllocs", CommandType.StoredProcedure, false, param);
            if (_dtResults != null) if (_dtResults.Rows.Count > 0) return _dtResults;

            OracleParameter[] param1 = new OracleParameter[5];
            (param1[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param1[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param1[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param1[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param1[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUserlocation1", "pkg_search.sp_searchuserrolelocs", CommandType.StoredProcedure, false, param1);
            if (_dtResults != null) if (_dtResults.Rows.Count > 0) return _dtResults;

            OracleParameter[] param2 = new OracleParameter[5];
            (param2[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param2[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param2[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param2[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param2[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUserlocation2", "pkg_search.sp_searchuserlocation", CommandType.StoredProcedure, false, param2);
            if (_dtResults != null) if (_dtResults.Rows.Count > 0) return _dtResults;

            return _dtResults;
        }

        /// <summary>
        /// DAL method for User ProfitCenter search.
        /// Created By : Mignda Geeganage On 20/03/2012
        /// </summary>
        public DataTable GetUserProfitCentreSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _profitCode = null;
            string _profitDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE": _profitCode = _searchText; break;
                    case "DESCRIPTION": _profitDesc = _searchText; break;
                    default: break;
                }
            }

            //Modify parameter values for LIKE search.
            _profitCode = (_profitCode != null) ? (_profitCode.ToUpper() + "%") : null;
            _profitDesc = (_profitDesc != null) ? (_profitDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCode;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitDesc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblUserlocation", "pkg_search.sp_searchuserrolechnnlpcs", CommandType.StoredProcedure, false, param);
            if (_dtResults != null) if (_dtResults.Rows.Count > 0) return _dtResults;

            OracleParameter[] param1 = new OracleParameter[5];
            (param1[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param1[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param1[2] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCode;
            (param1[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitDesc;
            param1[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUserlocation1", "pkg_search.sp_searchuserrolepcs", CommandType.StoredProcedure, false, param1);
            if (_dtResults != null) if (_dtResults.Rows.Count > 0) return _dtResults;

            OracleParameter[] param2 = new OracleParameter[5];
            (param2[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param2[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param2[2] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCode;
            (param2[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitDesc;
            param2[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUserlocation2", "pkg_search.sp_searchuserprofitcenters", CommandType.StoredProcedure, false, param2);
            if (_dtResults != null) if (_dtResults.Rows.Count > 0) return _dtResults;

            return _dtResults;
        }

        //Common Search from Invoice data.
        //Code by Miginda on 17/04/2012 and re-arranged by Prabhath on 26/04/2012
        public DataTable GetInvoiceSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchsalesdocument", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search from Invoice data.
        //Code by darshana on 26/11/2012
        public DataTable GetAllInvoiceSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchallsalesdocument", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for Invoice Type
        //Written By Prabhath on 26/04/2012
        public DataTable GetInvoiceTypeData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceType = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE TYPE":
                        _invoiceType = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceType = (_invoiceType != null) ? (_invoiceType.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_invoicetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceType;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinvoicetype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for Price Book
        //Written By Prabhath on 26/04/2012
        public DataTable GetPriceBookData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _priceBook = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE BOOK":
                        _priceBook = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _priceBook = (_priceBook != null) ? (_priceBook.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceBook;
            (param[4] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpricebook", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for Price Book
        //Written By Prabhath on 22/05/2012
        public DataTable GetPriceBookByCompanyData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _priceBook = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE BOOK":
                        _priceBook = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _priceBook = (_priceBook != null) ? (_priceBook.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceBook;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpricebookbycompany", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for Price Level
        //Written By Prabhath on 26/04/2012
        public DataTable GetPriceLevelData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _priceLevel = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE LEVEL":
                        _priceLevel = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _priceLevel = (_priceLevel != null) ? (_priceLevel.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_invtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();

            (param[4] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _priceLevel;
            (param[5] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpricelevel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for item status
        //Written By Prabhath on 27/04/2012
        public DataTable GetCompanyItemStatusData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _status = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _status = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcompanyitemStatus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for item status from price level
        //Written By Prabhath on 27/04/2012
        public DataTable GetPriceLevelItemStatusData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _status = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _status = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpricebookitemstatus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for customer according to the requirement
        //Written By Prabhath on 27/04/2012
        public DataTable GetCustomerGenaral(string _initialSearchParams, string _searchCatergory, string _searchText, string _returnCol, string _returnColDesc)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address = null;
            string _city = null;
            string _oth_id_no = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS":
                        _address = _searchText;
                        break;

                    case "CITY":
                        _city = _searchText;
                        break;

                    case "NIC NO":
                        _code = _searchText;
                        break;

                    case "MOBILE NO":
                        _code = _searchText;
                        break;
                    case "OTH NO":
                        _oth_id_no = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _address = (_address != null) ? (_address.ToUpper() + "%") : null;
            _city = (_city != null) ? (_city.ToUpper() + "%") : null;
            _oth_id_no = (_oth_id_no != null) ? (_oth_id_no.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_colname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _returnCol;
            (param[2] = new OracleParameter("p_coldescription", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _returnColDesc;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            (param[6] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;
            (param[7] = new OracleParameter("p_oth_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oth_id_no;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcustomer", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for currancy code
        //Written By Prabhath on 27/04/2012
        public DataTable GetCurrencyData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchcurrency", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for employee code
        //Written By Prabhath on 27/04/2012
        public DataTable GetEmployeeData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _epf = null;
            string _fname = null;
            string _lname = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "EPF NO":
                        _epf = _searchText;
                        break;

                    case "FIRST NAME":
                        _fname = _searchText;
                        break;

                    case "LAST NAME":
                        _lname = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : null;
            _fname = (_fname != null) ? (_fname.ToUpper() + "%") : null;
            _lname = (_lname != null) ? (_lname.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_empcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[4] = new OracleParameter("p_fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fname;
            (param[5] = new OracleParameter("p_lname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lname;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchemployee", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for Supplier
        //Written By Darshana on 08/05/2012
        public DataTable GetSupplierData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblsupplier", "pkg_search.sp_searchsupplier", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Nadeeka 07-jan-2015
        public DataTable GetClaimSupplierData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_scode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString(); ;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblsupplier", "pkg_search.sp_searchclaimsupplier", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for price level by price book
        //Written By Prabhath on 21/05/2012
        public DataTable GetPriceLevelByBookData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE LEVEL":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchpricelevelbybook", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for get purchase orders
        //Written By darshana on 21/05/2012
        public DataTable GetPurchaseOrders(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _status = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PO NO":
                        _docNo = _searchText;
                        break;

                    case "DOC REF":
                        _refNo = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;
                    //case "PO NO":
                    //    _status = _searchText;
                    //    break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_docRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search.sp_searchPurchaseOrder", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPurchaseOrdersByDate(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _status = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PO NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;
                    //case "PO NO":
                    //    _status = _searchText;
                    //    break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_docRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[3] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[4] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search.sp_searchPurchaseOrderByDate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 21/05/2012
        public DataTable GetReceiptTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchreceipttypes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetBusinessCompany(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;
            string _id = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "ID":
                        _id = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;
            _id = (_id != null) ? (_id.ToUpper() + "%") : null;

            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _id;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_searchbusinesscompany", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCreditNoteAll(string _initialSearchParams, string _searchCatergory, string _searchText, string _com, string _pc)
        {//Sanjeewa 2015-11-03
            DataTable _dtResults = new DataTable();

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _manref = null;
            string _basedoc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _invoice = _searchText;
                        break;

                    case "MANUAL_REF":
                        _manref = _searchText;
                        break;

                    case "BASE_NO":
                        _basedoc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : null;
            _manref = (_manref != null) ? (_manref.ToUpper() + "%") : null;
            _basedoc = (_basedoc != null) ? (_basedoc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manref;
            (param[4] = new OracleParameter("p_basedoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _basedoc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_searchcreditnoteall", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetBankAccounts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            //_dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_searchbankaccounts", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tblBankDetails", "sp_searchbankaccounts_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 20/4/2015
        public DataTable GetAllBankAccounts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_searchallbankaccounts", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetDivision(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblDivision", "pkg_search.sp_searchdivision", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for get receipt
        //Written By darshana on 18/06/2012
        public DataTable GetReceipts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _othRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "OTH REF NO":
                        _othRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _othRef = (_othRef != null) ? (_othRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_othRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othRef;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchReceipt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search for get receipt by receipt type
        //Written By chamal on 15/08/2012
        public DataTable GetReceiptsByType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT NO":
                        _docNo = _searchText;
                        break;

                    case "RECEIPT REF":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_sbtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search_inv.sp_searchReceiptByType_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetOutstandingInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _docNo = _searchText;
                        break;

                    case "REFERENCE":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblOutstanding", "pkg_search.sp_getoutstandinginv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana
        public DataTable GetOutstandingInvoiceweb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _docNo = _searchText;
                        break;

                    case "REFERENCE":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblOutstanding", "sp_getoutstinvweb", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Written By darshana on 18/06/2012
        public DataTable GetOutstandingInvoiceTBS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _docNo = _searchText;
                        break;

                    case "REFERENCE":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblOutstanding", "PKG_TOURS_SEARCH.sp_getoutstandinginv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 2/7/2012
        public DataTable GetOutsidePartySearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchoutsideparty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCountryData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchcountry", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 9/7/2012
        public DataTable GetGroupSaleSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            //sp_searchgroupsale   (p_com in NVARCHAR2, p_pc in NVARCHAR2,p_status in NUMBER,p_code IN NVARCHAR2,p_desc IN NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblGroupSaleSearch", "pkg_search.sp_search_groupsale", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 10/7/2012
        public DataTable GetCompanySearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_searchcompany", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //ISuru 2017/03/14
        public DataTable GetManagersetupSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "sp_searchManagersetup", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //13/07/2012
        public DataTable Getloc_HIRC_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6]) : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[6] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[8] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            //_dtResults = QueryDataTable("tblZPC", "pkg_search.sp_loc_hirc_search", CommandType.StoredProcedure, false, param); // tharaka 2016-01-21
            _dtResults = QueryDataTable("tblZPC", "SP_LOC_HIRCH_SEARCH", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //fazan 19-Nov-2015

        public DataTable GetCompanySearchDetails(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dtResult = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {

                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;

                }

            }


            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "ADMIN";
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //

            dtResult = QueryDataTable("tbl", "pkg_imports_Enquiry.sp_searchcompany_details", CommandType.StoredProcedure, false, param);
            //     dtResult = QueryDataTable("tbl", "SP_TEST_ASD", CommandType.StoredProcedure, false, param);

            return dtResult;
        }

        //fazan 19-Nov-2015
        public DataTable GetBLDetails(string initialparam, string bl_no)
        {
            DataTable _dvResult = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = initialparam;
            (param[1] = new OracleParameter("bl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bl_no;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dvResult = QueryDataTable("tblblsearch", "pkg_imports_Enquiry.sp_bl_details", CommandType.StoredProcedure, false, param);
            //  _dvResult = QueryDataTable("tblblsearch", "pkg_imports_Enquiry.sp_bl_dtls", CommandType.StoredProcedure, false, param);
            return _dvResult;

        }

        //fazan 21-Nov-2015
        public DataTable GetBLALL(bool status)
        {
            DataTable result = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            result = QueryDataTable("tblBLALL", "pkg_imports_Enquiry.sp_allBL_details", CommandType.StoredProcedure, false, param);
            return result;
        }

        // fazan 21-Nov-2015

        public DataTable GetSubSerial(string itemcode, string serialcode)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[1] = new OracleParameter("s_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialcode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblsub", "pkg_imports_Enquiry.sp_getSub_Serial", CommandType.StoredProcedure, false, param);

            return dt;


        }


        //fazan 21-Nov-2015
        public DataTable GetSerialWarrantyDetails(string serialcode)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("s_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialcode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblSerial", "pkg_imports_Enquiry.sp_getp_warrantydetails", CommandType.StoredProcedure, false, param);
            return dt;

        }

        //fazan 23-nov-2015

        public DataTable GetSearchBLByDate(string company)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblcalendar", "pkg_imports_Enquiry.SP_SEARCH_BL_POPUP", CommandType.StoredProcedure, false, param);
            return dt;
        }



        //fazan 23 nov 2015
        public DataTable FilterDateRange(string company, string from, string to)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("from_d", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = from;
            (param[2] = new OracleParameter("to_d", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = to;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblFilter", "pkg_imports_Enquiry.sp_bl_dates", CommandType.StoredProcedure, false, param);
            return dt;


        }

        //fazan 23 nov 2015
        public DataTable SearchAllBL(string company, string bl_no, string eta_frm, string eta_to, string clearance_frm, string clearance_to)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("bl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bl_no;
            (param[2] = new OracleParameter("ETA_frm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = eta_frm;
            (param[3] = new OracleParameter("ETA_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = eta_to;
            (param[4] = new OracleParameter("clearance_frm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = clearance_frm;
            (param[5] = new OracleParameter("clearance_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = clearance_to;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblFilter", "sp_searchallbl", CommandType.StoredProcedure, false, param);
            return dt;


        }


        //fazan 23 nov 2015
        public DataTable BL_Items(string doc_no, string _toBond)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[3];
            //  doc_no
            (param[0] = new OracleParameter("doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_no;
            (param[1] = new OracleParameter("p_to_bond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toBond;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblitems", "pkg_imports_Enquiry.SP_BL_ITEMS", CommandType.StoredProcedure, false, param);
            return dt;

        }

        //fazan 24 nov 2015
        public DataTable LoadDstinctBL_No()
        {
            DataTable dt = null;


            //

            string _code = null;
            string _description = null;
            string _searchCatergory = null;
            string _searchText = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {

                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;

                }

            }

            //


            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblBLs", " pkg_imports_Enquiry.SP_BL_NO", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 24 nov 2015
        public Int32 UpdateBLDetails_shipping(string doc_clear, string enrty_no, DateTime hand_over, string actual_eta, string blno, string p_loc, Int32 _actLead, DateTime filerec,DateTime actualClrDt,string clrUsr)
        {
            //DataTable dt = null;
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("doc_clear", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_clear;
            (param[1] = new OracleParameter("enrty_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = enrty_no;
            (param[2] = new OracleParameter("hand_over", OracleDbType.Date, null, ParameterDirection.Input)).Value = hand_over;
            (param[3] = new OracleParameter("blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            (param[4] = new OracleParameter("actual_eta", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = actual_eta;
            (param[5] = new OracleParameter("p_IB_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
            (param[6] = new OracleParameter("p_IB_ACT_LEAD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _actLead;
            (param[7] = new OracleParameter("p_fileRec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = filerec;
            (param[8] = new OracleParameter("p_actClrDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = actualClrDt;
            (param[9] = new OracleParameter("clrUsr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = clrUsr;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            // dt = QueryDataTable("tblBLupdate","pkg_imports_Enquiry.SP_BL_Update", CommandType.StoredProcedure, false, param);
            effects = (Int16)UpdateRecords("SP_BL_UPDATE", CommandType.StoredProcedure, param);
            return effects;
        }

        // //fazan 26 nov 2015
        public DataTable Container_Count(string blno)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblcn", "pkg_imports_Enquiry.SP_Container_count", CommandType.StoredProcedure, false, param);
            return dt;

        }
        //fazan 27 nov 2015
        public DataTable GetGrnDt(string company, string doc_no, int line_no)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_no;
            (param[2] = new OracleParameter("line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line_no;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblGRN", "pkg_imports_enquiry.SP_Get_GRN_Dt", CommandType.StoredProcedure, false, param);
            return dt;

        }


        //16/07/2012
        public DataTable GetCat_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2]) : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_mcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_scat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_itemcategorysearch", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //17/07/2012
        public DataTable GetInventoryTrackerSearchData(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //Set relavant parameters according to the,search catergory.

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            //  searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[7] = (searchParams[7] != "" || searchParams[7] != null) ? (searchParams[7].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[9] = (searchParams[9] != "" || searchParams[9] != null) ? (searchParams[9].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[10] = (searchParams[10] != "" || searchParams[10] != null) ? (searchParams[10].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[11] = (searchParams[11] != "" || searchParams[11] != null) ? (searchParams[11]) : "%";
            //   searchParams[12] = (searchParams[12] != "" || searchParams[12] != null) ? (searchParams[12].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[12] = (searchParams[12] != "" || searchParams[12] != null) ? (searchParams[12].ToUpper() + "%") : "%";
            searchParams[13] = (searchParams[13] != "" || searchParams[13] != null) ? (searchParams[13].ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("P_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_sub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[6] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[7] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[7];
            (param[8] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];
            (param[9] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[9];
            (param[10] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[10];
            (param[11] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[11];
            (param[12] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[12];
            (param[13] = new OracleParameter("p_sub1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[13];
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZIT", "pkg_search.sp_searchinventoryitem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 19/5/2017
        public DataTable GetJobRegNoSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search_inv.sp_searchjobregno", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila 2/7/2012
        public DataTable GetChannelSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchchannel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //DAL method for all PC search.
        //created by Shani on 17-07-2012
        public DataTable GetPC_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _pcCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _pcCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _pcCode = (_pcCode != null) ? (_pcCode.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            //PROCEDURE sp_search_allProfitcenters  (  p_com in NVARCHAR2,p_profitcenter in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcCode;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_search_allProfitcenters", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPriceItemSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            // sp_searchpricebookitem(p_pbook in NVARCHAR2,p_plevel in NVARCHAR2,p_qty in NUMBER,p_date in date,p_customer in NVARCHAR2,p_item in NVARCHAR2,p_desc in NVARCHAR2,
            //p_brand in NVARCHAR2,p_model in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString()).Date;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();

            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[7] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchpricebookitem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //by darshana
        public DataTable GetInvoiceByAcc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _account = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _invoice = _searchText;
                        break;

                    case "ACCOUNT":
                        _account = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : null;
            _account = (_account != null) ? (_account.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinvoicebyacc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //23/07/2012
        //sachith
        public DataTable GetItemDocSearchData(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //Set relavant parameters according to the,search catergory.

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6].ToUpper() + "%") : "%";
            searchParams[7] = (searchParams[7] != "" || searchParams[7] != null) ? (searchParams[7].ToUpper() + "%") : "%";
            searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper() + "%") : "%";
            searchParams[9] = (searchParams[9] != "" || searchParams[9] != null) ? (searchParams[9]) : "%";

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[6] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];

            (param[7] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[7];
            (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[9];
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];

            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZID", "pkg_search.sp_searchitemdocuments", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //23/07/2012
        //sachith
        public DataTable GetItemSerialSearchData(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //Set relavant parameters according to the,search catergory.

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6].ToUpper() + "%") : "%";
            searchParams[7] = (searchParams[7] != "" || searchParams[7] != null) ? (searchParams[7].ToUpper() + "%") : "%";
            //searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper() + "%") : "%";  kapila 4/8/2014
            searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper()) : "";
            searchParams[9] = (searchParams[9] != "" || searchParams[9] != null) ? (searchParams[9]) : "%";

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[6] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];

            (param[7] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[7];
            (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[9];
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];

            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZID", "pkg_search.sp_searchitemserials", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_SchemesCD_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _schCode = null;
            // string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _schCode = _searchText;
                        break;

                    //case "DESCRIPTION":
                    //    _locationDesc = _searchText;
                    //    break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _schCode = (_schCode != null) ? (_schCode.ToUpper() + "%") : null;
            //  _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_schemeCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schCode;//searchParams[0].ToString();

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_search_schemes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 26-07-2012
        public DataTable Get_PriceTypes_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _typeCode = null;
            string _Desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "TYPECODE":
                        _typeCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _Desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _typeCode = (_typeCode != null) ? (_typeCode.ToUpper() + "%") : null;
            _Desc = (_Desc != null) ? (_Desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_TypeCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _typeCode;// searchParams[0].ToString();
            (param[1] = new OracleParameter("p_descript", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;// searchParams[1].ToString();

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_search_PriceTypes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetWarrantySearchByWarrantyNoSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _item = null;
            string _desc = null;
            string _model = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : "%";
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";
            _model = (_model != null) ? (_model.ToUpper() + "%") : "%";

            //PROCEDURE sp_searchwarranty(p_warranty in NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_model in NVARCHAR2,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_searchwarranty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetWarrantySearchBySerialNoSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial = null;
            string _item = null;
            string _desc = null;
            string _model = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";
            _model = (_model != null) ? (_model.ToUpper() + "%") : "%";

            //PROCEDURE sp_searchwarrantyserial(p_serial in NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_model in NVARCHAR2,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_searchwarrantyserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetJobSearchBySerialNoSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial = null;
            string _item = null;
            string _desc = null;
            string _job = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "JOB #":
                        _job = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";
            _job = (_job != null) ? (_job.ToUpper() + "%") : "%";

            //PROCEDURE sp_searchwarrantyserial(p_serial in NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_model in NVARCHAR2,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[3] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_searchjobserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetGeneralRequestSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _request = null;
            string _baseDoc = null;
            string _docType = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "REQUEST NO":
                        _request = _searchText;
                        break;

                    case "BASE DOCUMENT":
                        _baseDoc = _searchText;
                        break;

                    case "DOCUMENT TYPE":
                        _docType = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _request = (_request != null) ? (_request.ToUpper() + "%") : "%";
            _baseDoc = (_baseDoc != null) ? (_baseDoc.ToUpper() + "%") : "%";
            _docType = (_docType != null) ? (_docType.ToUpper() + "%") : "%";

            //PROCEDURE  sp_searchgeneralrequest(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_requestno in NVARCHAR2,p_documentno in NVARCHAR2,p_doctype in NVARCHAR2,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_requestno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[3] = new OracleParameter("p_documentno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseDoc;
            (param[4] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_searchgeneralrequest", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInvoiceByInvType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _account = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "ACCOUNT NO":
                        _account = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _account = (_account != null) ? (_account.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            //PROCEDURE sp_searchsalesdocbyinvoicetype (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2,p_doctype in NVARCHAR2,p_invoicetype in NVARCHAR2,p_isHire in NUMBER, p_invoiceno IN NVARCHAR2,p_account in NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_invoicetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_isHire", OracleDbType.Int16, null, ParameterDirection.Input)).Value = searchParams[4].ToString() == "1" ? 1 : 0; //modified by shani //searchParams[3].ToString();

            (param[5] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[6] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[7] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[8] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[9] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchsalesdocbyinvoicetype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 11/07/2012
        public DataTable GetInvoiceItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Item = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM CODE":
                        _Item = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _Item = (_Item != null) ? (_Item.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchinvoiceitem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetHpAccountAdjSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountseq = string.Empty;
            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT":
                        _accountseq = _searchText;
                        break;

                    case "ACCOUNT NO": //added by shani 19-02-2013
                        _accountno = _searchText;
                        break;

                    case "INVOICE NO"://added by shani 19-02-2013
                        _invoiceno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _accountseq = (_accountseq != null) ? (_accountseq.ToUpper() + "%") : null;
            _accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;
            _invoiceno = (_invoiceno != null) ? (_invoiceno.ToUpper() + "%") : null;

            //PROCEDURE sp_searchhpaccount(p_com IN NVARCHAR2,p_profit IN NVARCHAR2,p_status in NVARCHAR2,p_seqno in NUMBER,p_account in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]);

            (param[4] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountseq;
            (param[5] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[6] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchhpaccount_adj", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Written By Prabhath on 14/08/2012
        public DataTable GetHpAccountSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountseq = string.Empty;
            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT":
                        _accountseq = _searchText;
                        break;

                    case "ACCOUNT NO": //added by shani 19-02-2013
                        _accountno = _searchText;
                        break;

                    case "INVOICE NO"://added by shani 19-02-2013
                        _invoiceno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_accountseq = (_accountseq != null) ? (_accountseq.ToUpper() + "%") : null;
            //_accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;
            //_invoiceno = (_invoiceno != null) ? (_invoiceno.ToUpper() + "%") : null;
            _accountseq = _accountseq.Replace("%", "");
            _accountno = _accountno.Replace("%", "");
            _invoiceno = _invoiceno.Replace("%", "");
            if (string.IsNullOrEmpty(_accountseq))
            {
                _accountseq = "%";
            }

            if (string.IsNullOrEmpty(_accountno))
            {
                _accountno = "%";
            }

            if (string.IsNullOrEmpty(_invoiceno))
            {
                _invoiceno = "%";
            }

            //PROCEDURE sp_searchhpaccount(p_com IN NVARCHAR2,p_profit IN NVARCHAR2,p_status in NVARCHAR2,p_seqno in NUMBER,p_account in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountseq;
            (param[4] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[5] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchhpaccount", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 15/08/2012
        public DataTable GetInsuCompany(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "Description":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchinscom", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 15/08/2012
        public DataTable GetInsuPolicy(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "Description":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchinspol", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 18/06/2012
        public DataTable GetBusinessCompanyBranch(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            // sp_searchbusinessbranch(p_bank in NVARCHAR2,p_branch in NVARCHAR2,p_desc in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search.sp_searchbusinessbranch", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search from Invoice data according to the customer.
        //darshana 16/05/2012
        public DataTable GetInvoicebyCustomer(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinvoicewithcus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetUserID(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string userID = null;
            string user_name = null;
            string department = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "USER_ID":
                        userID = _searchText;
                        break;

                    case "NAME":
                        user_name = _searchText;
                        break;

                    case "USER_DEPARTMENT":
                        department = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            userID = (userID != null) ? (userID.ToUpper() + "%") : null;
            user_name = (user_name != null) ? (user_name.ToUpper() + "%") : null;
            department = (department != null) ? (department.ToUpper() + "%") : null;

            //  p_userID in NVARCHAR2,p_username in NVARCHAR2,p_dept in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userID;
            (param[1] = new OracleParameter("p_username", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user_name;

            (param[2] = new OracleParameter("p_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = department;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GETUSERSfromSecUser", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSerialNIC(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string serial = null;
            string NIC = null;
            string province = null;
            string serial2 = null;
            string regno = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL":
                        serial = _searchText;
                        break;

                    case "NIC":
                        NIC = _searchText;
                        break;

                    case "PROVINCE":
                        province = _searchText;
                        break;

                    case "CHASSIS":
                        serial2 = _searchText;
                        break;

                    case "REGNO":
                        regno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            serial = (serial != null) ? (serial.ToUpper() + "%") : null;
            NIC = (NIC != null) ? (NIC.ToUpper() + "%") : null;
            province = (province != null) ? (province.ToUpper() + "%") : null;
            serial2 = (serial2 != null) ? (serial2.ToUpper() + "%") : null;
            regno = (regno != null) ? (regno.ToUpper() + "%") : null;

            //p_town in NVARCHAR2,p_district in NVARCHAR2,p_province in NVARCHAR2,c_data OUT sys_refcursor

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[3] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial2;
            (param[4] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = regno;
            (param[5] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NIC;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GET_Serial_NIC_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTown(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string town = null;
            string district = null;
            string province = null;
            string code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TOWN":
                        town = _searchText;
                        break;

                    case "DISTRICT":
                        district = _searchText;
                        break;

                    case "PROVINCE":
                        province = _searchText;
                        break;

                    case "CODE":
                        code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            town = (town != null) ? (town.ToUpper() + "%") : null;
            district = (district != null) ? (district.ToUpper() + "%") : null;
            province = (province != null) ? (province.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;
            (param[1] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;
            (param[2] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblusers", " pkg_search.SP_GET_Towns", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }






        //kapila 23/2/2013
        public DataTable GetRCC(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[11];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rccno = null;
            string _item = null;
            string _serial = null;
            string _warranty = null;
            string _stage = null;
            string _inv = null;
            string _cusname = null;
            string _cusaddr = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RCC NO":
                        _rccno = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "WARRANTY":
                        _warranty = _searchText;
                        break;

                    case "STAGE":
                        _stage = _searchText;
                        break;

                    case "INVOICE":
                        _inv = _searchText;
                        break;
                    case "CUS NAME":
                        _cusname = _searchText;
                        break;
                    case "CUS ADDR":
                        _cusaddr = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rccno = (_rccno != null) ? (_rccno.ToUpper() + "%") : string.Empty;
            _item = (_item != null) ? (_item.ToUpper() + "%") : string.Empty;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : string.Empty;
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : string.Empty;
            _stage = (_stage != null) ? (_stage.ToUpper() + "%") : string.Empty;
            _inv = (_inv != null) ? (_inv.ToUpper() + "%") : string.Empty;
            _cusname = (_cusname != null) ? (_cusname.ToUpper() + "%") : string.Empty;
            _cusaddr = (_cusaddr != null) ? (_cusaddr.ToUpper() + "%") : string.Empty;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            (param[2] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[6] = new OracleParameter("p_stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stage;
            (param[7] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[8] = new OracleParameter("p_cusname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusname;
            (param[9] = new OracleParameter("p_cusaddr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusaddr;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_rcc_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRCCByStage(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[8];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rccno = null;
            string _item = null;
            string _serial = null;
            string _warranty = null;
            string _stage = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RCC NO":
                        _rccno = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "WARRANTY":
                        _warranty = _searchText;
                        break;

                    case "STAGE":
                        _stage = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rccno = (_rccno != null) ? (_rccno.ToUpper() + "%") : "%";
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : "%";
            _stage = (_stage != null) ? (_stage.ToUpper() + "%") : "%";

            //sp_searchrccbystage(p_com in NVARCHAR2,p_loc IN NVARCHAR2,p_rccno in NVARCHAR2,p_item in NVARCHAR2,p_serial in NVARCHAR2,p_warr in NVARCHAR2,p_stage in NVARCHAR2,c_data out SYS_REFCURSOR);

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[6] = new OracleParameter("p_stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchrccbystage", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRCC_REQ(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[8];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rccno = null;
            string _item = null;
            string _serial = null;
            string _warranty = null;
            string _stage = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RCC NO":
                        _rccno = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "WARRANTY":
                        _warranty = _searchText;
                        break;

                    case "STAGE":
                        _stage = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rccno = (_rccno != null) ? (_rccno.ToUpper() + "%") : string.Empty;
            _item = (_item != null) ? (_item.ToUpper() + "%") : string.Empty;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : string.Empty;
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : string.Empty;
            _stage = (_stage != null) ? (_stage.ToUpper() + "%") : string.Empty;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            (param[2] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[6] = new OracleParameter("p_STAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stage;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_rcc_req", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //SACHITH
        //search ope
        public DataTable GetOPE(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[4];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchope", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        // 05/09/2012 Shani
        public DataTable Get_PC_HIRC_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6]) : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[6] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[8] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            //_dtResults = QueryDataTable("tblZPC", "pkg_search.sp_PC_hirc_search", CommandType.StoredProcedure, false, param); // Tharaka 2016-01-21
            _dtResults = QueryDataTable("tblZPC", "SP_PC_HIRCH_SEARCH", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchAvailableItemSerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {

            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = string.Empty;
            string _Desc = string.Empty;
            string _Model = string.Empty;
            string _Brand = string.Empty;
            string _Serial = string.Empty;
            string _Warranty = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _Desc = _searchText;
                        break;

                    case "MODEL":
                        _Model = _searchText;
                        break;

                    case "BRAND":
                        _Brand = _searchText;
                        break;

                    case "SERIAL":
                        _Serial = _searchText;
                        break;

                    case "WARRANTY":
                        _Warranty = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //sp_searchavailableitemserial(p_com in NVARCHAR2,p_loc IN NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_brand in NVARCHAR2,p_model in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,c_data out SYS_REFCURSOR)

            _item = (_item != string.Empty) ? (_item.ToUpper() + "%") : string.Empty;
            _Desc = (_Desc != string.Empty) ? (_Desc.ToUpper() + "%") : string.Empty;
            _Model = (_Model != string.Empty) ? (_Model.ToUpper() + "%") : string.Empty;
            _Brand = (_Brand != string.Empty) ? (_Brand.ToUpper() + "%") : string.Empty;
            _Serial = (_Serial != string.Empty) ? (_Serial.ToUpper() + "%") : string.Empty;
            _Warranty = (_Warranty != string.Empty) ? (_Warranty.ToUpper() + "%") : string.Empty;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[6] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            (param[7] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Warranty;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchavailableitemserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAllModels(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchallmodels", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAllInsTerms(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TERM":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("c_data", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchainsterm", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Available Serial Search
        //Code by darshana on 09/08/2012
        public DataTable GetDeliverdInvoiceItemSerials(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _warranty = null;
            string _status = null;
            string _serial = null;
            string _serial2 = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY NO":
                        _warranty = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "OTHER SERIAL":
                        _serial2 = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : null;
            _serial2 = (_serial2 != null) ? (_serial2.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();

            (param[4] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[7] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchinvdeliveritem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchAvlbleSerial4Invoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = string.Empty;
            string _Desc = string.Empty;
            string _Model = string.Empty;
            string _Brand = string.Empty;
            string _Serial = string.Empty;
            string _Warranty = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _Desc = _searchText;
                        break;

                    case "MODEL":
                        _Model = _searchText;
                        break;

                    case "BRAND":
                        _Brand = _searchText;
                        break;

                    case "SERIAL":
                        _Serial = _searchText;
                        break;

                    case "WARRANTY":
                        _Warranty = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //sp_searchavailableitemserial(p_com in NVARCHAR2,p_loc IN NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_brand in NVARCHAR2,p_model in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,c_data out SYS_REFCURSOR)

            _item = (_item != string.Empty) ? (_item.ToUpper() + "%") : string.Empty;
            _Desc = (_Desc != string.Empty) ? (_Desc.ToUpper() + "%") : string.Empty;
            _Model = (_Model != string.Empty) ? (_Model.ToUpper() + "%") : string.Empty;
            _Brand = (_Brand != string.Empty) ? (_Brand.ToUpper() + "%") : string.Empty;
            _Serial = (_Serial != string.Empty) ? (_Serial + "%") : string.Empty;
            _Warranty = (_Warranty != string.Empty) ? (_Warranty.ToUpper() + "%") : string.Empty;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[6] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            (param[7] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Warranty;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_avlbleserial4invoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchBankBranchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = string.Empty;
            string _Desc = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _Desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //PROCEDURE sp_search_bankbranch(p_bank in NVARCHAR2,p_branch IN NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            _code = (_code != string.Empty) ? (_code.ToUpper() + "%") : string.Empty;
            _Desc = (_Desc != string.Empty) ? (_Desc.ToUpper() + "%") : string.Empty;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_bankbranch", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPromotionSearch(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "CIRCULAR NO":
                        desc = _searchText;
                        desc = (desc != null) ? (desc.ToUpper() + "%") : "%";
                        searchParams[0] = desc;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            searchParams[0] = (searchParams[0] != "" || searchParams[1] != null) ? (searchParams[0].ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_circu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_search_promotion", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        public DataTable GetPriceDefCircularSearch(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            searchParams[0] = (searchParams[0] != "" || searchParams[1] != null) ? (searchParams[0].ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_circu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_search_pb_def_Circular", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetLoyaltyTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[1]);
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_search_loyaltytypes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //created by Shani on 17-10-2012
        public DataTable Get_employee_categories(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _categoryCD = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _categoryCD = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _categoryCD = (_categoryCD != null) ? (_categoryCD.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            //p_com in NVARCHAR2,p_empCat in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_empCat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _categoryCD;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_search_EmpCategory", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_employee_EPF(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _epf = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _epf = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_empCateCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_empEpf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_search_Employee_EPF", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 18-10-2012
        public DataTable Get_sales_subtypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _salesCode = null;
            string _salesDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SRTS_CD"://srts_cd
                        _salesCode = _searchText;
                        break;

                    case "SRTS_DESC"://srts_desc
                        _salesDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _salesCode = (_salesCode != null) ? (_salesCode.ToUpper() + "%") : "%";
            _salesDesc = (_salesDesc != null) ? (_salesDesc.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesCode;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getsales_subtypes", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetQuotationDetailForInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            string _customer = null;
            string _name = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;

                    case "PARTY CODE":
                        _customer = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";

            //sp_search_quotation(p_com in NVARCHAR2,p_profit IN NVARCHAR2,p_date in date,p_quotation in NVARCHAR2, p_customer in NVARCHAR2 ,  p_name in NVARCHAR2,c_data out SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2].ToString()).Date;
            (param[3] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[5] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_quotation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        // kapila 8/11/2012
        public DataTable Get_LOC_HIRC_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6]) : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[6] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[8] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_LOC_hirc_search", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 10/11/2012
        public DataTable Get_DocNum_ByRefNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _manDocNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "MANUAL NO":
                        _manDocNo = _searchText;
                        break;

                    case "INVOICE":
                        _manDocNo = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _manDocNo = (_manDocNo != null) ? (_manDocNo.ToUpper() + "%") : "%";
            // _salesDesc = (_salesDesc != null) ? (_salesDesc.ToUpper() + "%") : "%";
            //  p_payType in NVARCHAR2,p_docNo in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_payType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_manDocNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manDocNo;
            (param[3] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_DocsByRefNum", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written By Prabhath on 14/08/2012
        public DataTable GetAllHpAccountSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT NO":
                        _accountno = _searchText;
                        break;

                    case "INVOICE NO":
                        _invoiceno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;
            _invoiceno = (_invoiceno != null) ? (_invoiceno.ToUpper() + "%") : null;

            //PROCEDURE sp_searchhpaccount(p_com IN NVARCHAR2,p_profit IN NVARCHAR2,p_status in NVARCHAR2,p_seqno in NUMBER,p_account in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_searchallhpaccount", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 16-11-2012
        public DataTable Search_int_hdr_Document(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            ////Set relavant parameters according to the,search catergory.
            //if (!string.IsNullOrEmpty(_searchCatergory))
            //{
            //    switch (_searchCatergory.ToUpper())
            //    {
            //    }
            //}

            ////Modify parameter values for LIKE search.
            //_accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;
            //_invoiceno = (_invoiceno != null) ? (_invoiceno.ToUpper() + "%") : null;

            //(p_com in NVARCHAR2, p_docType in NVARCHAR2,p_direction in NUMBER,p_docDtFrom in DATE,p_docDtTo in DATE,p_otherLoc in NVARCHAR2,p_stus in NVARCHAR2

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());

            (param[3] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString()).Date;
            (param[4] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[4].ToString()).Date;
            (param[5] = new OracleParameter("p_otherLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5].ToString();
            (param[6] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6].ToString();
            //(param[4] = new OracleParameter("", OracleDbType.Date, null, ParameterDirection.Input)).Value = _invoiceno;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_search_int_hdr_Det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetReceiptsDate(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = string.Empty;
            string _refNo = string.Empty;
            string _othRef = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "OTH REF NO":
                        _othRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            // Replace 1st "%" by Nadeeka 21-12-2015
            //_docNo = _docNo.Replace("%", "");

            //_refNo = _refNo.Replace("%", "");

            //_othRef = _othRef.Replace("%", "");


            _docNo = (_docNo != "") ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != "") ? (_refNo.ToUpper() + "%") : null;
            _othRef = (_othRef != "") ? (_othRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_othRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othRef;
            (param[5] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchReceiptDate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetReceiptsDateTBS(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _othRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "OTH REF NO":
                        _othRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _othRef = (_othRef != null) ? (_othRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_othRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othRef;
            (param[5] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchReceiptDateTBS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 18/06/2012
        public DataTable GetPaymentDateTBS(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _othRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "OTH REF NO":
                        _othRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _othRef = (_othRef != null) ? (_othRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_othRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othRef;
            (param[5] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchPaymentDateTBS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by Chamal 15-03-2013
        public DataTable Search_int_hdr_Infor(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;
            string _othLoc = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    case "OTHER LOC": _othLoc = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }

            _document = (_document != null) ? (_document.ToUpper() + "%") : "%";
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date + "%") : "%";
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : "%";
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : "%";
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : "%";
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : "%";
            _othLoc = (_othLoc != null) ? (_othLoc + "%") : "%";

            #region pkg_search.sp_search_int_hdr_Infor

            //--sp_search_int_hdr_Infor
            //PROCEDURE sp_search_int_hdr_Infor
            //(p_docDtFrom in DATE,p_docDtTo in DATE,p_com in NVARCHAR2,p_loc in NVARCHAR2,p_docType in NVARCHAR2,p_direction in NUMBER,p_sub_tp in NVARCHAR2,p_doc_no in NVARCHAR2,p_manual_ref in NVARCHAR2,p_oth_docno in NVARCHAR2, p_entry_no in NVARCHAR2, p_job_no in NVARCHAR2, p_oth_loc in NVARCHAR2,p_stus in NVARCHAR2, c_data OUT sys_refcursor)
            //IS
            //--Chamal 14/03/2013
            //BEGIN

            //IF p_docDtFrom IS NULL OR p_docDtTo IS NULL THEN

            //OPEN c_data FOR
            //SELECT ith_doc_no as "Document", ith_sub_tp as "Sub Type", ith_doc_date as "Date",ith_manual_ref as "Manual Ref No", ith_oth_docno as "Other Document",
            //ith_entry_no as "Entry No", ith_job_no as "Job No", ith_oth_loc as "Other Loc", ith_stus as "Status"
            //FROM int_hdr
            //WHERE ith_com=p_com and
            //ith_loc=p_loc and
            //ith_direct=p_direction and
            //ith_doc_tp=p_docType and
            //NVL2(ith_sub_tp,ith_sub_tp,'N/A') LIKE NVL(p_sub_tp,'%') and
            //ith_doc_no LIKE NVL(p_doc_no,'%') and
            //NVL2(ith_manual_ref,ith_manual_ref,'N/A') LIKE NVL(p_manual_ref,'%') and
            //NVL2(ith_oth_docno,ith_oth_docno,'N/A') LIKE NVL(p_oth_docno,'%') and
            //NVL2(ith_entry_no,ith_entry_no,'N/A') LIKE NVL(p_entry_no,'%') and
            //NVL2(ith_job_no,ith_job_no,'N/A') LIKE NVL(p_job_no,'%') and
            //NVL2(ith_oth_loc,ith_oth_loc,'N/A') LIKE NVL (p_oth_loc,'%') and
            //ith_stus LIKE NVL(p_stus,'%');

            //ELSE
            //OPEN c_data FOR
            //SELECT ith_doc_no as "Document", ith_sub_tp as "Sub Type", ith_doc_date as "Date",ith_manual_ref as "Manual Ref No", ith_oth_docno as "Other Document",
            //ith_entry_no as "Entry No", ith_job_no as "Job No", ith_oth_loc as "Other Loc", ith_stus as "Status"
            //FROM int_hdr
            //WHERE ith_com=p_com and
            //ith_loc=p_loc and
            //ith_direct=p_direction and
            //ith_doc_tp=p_docType and
            //ith_doc_date BETWEEN p_docDtFrom and p_docDtTo and
            //NVL2(ith_sub_tp,ith_sub_tp,'N/A') LIKE NVL(p_sub_tp,'%') and
            //ith_doc_no LIKE NVL(p_doc_no,'%') and
            //NVL2(ith_manual_ref,ith_manual_ref,'N/A') LIKE NVL(p_manual_ref,'%') and
            //NVL2(ith_oth_docno,ith_oth_docno,'N/A') LIKE NVL(p_oth_docno,'%') and
            //NVL2(ith_entry_no,ith_entry_no,'N/A') LIKE NVL(p_entry_no,'%') and
            //NVL2(ith_job_no,ith_job_no,'N/A') LIKE NVL(p_job_no,'%') and
            //NVL2(ith_oth_loc,ith_oth_loc,'N/A') LIKE NVL (p_oth_loc,'%') and
            //ith_stus LIKE NVL(p_stus,'%');
            //END IF;

            //END;
            //--sp_search_int_hdr_Det

            #endregion pkg_search.sp_search_int_hdr_Infor

            OracleParameter[] param = new OracleParameter[15];
            //Fixed Date Range
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            //Search parameters
            (param[6] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[7] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[8] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[9] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[10] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[11] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[12] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othLoc;
            (param[13] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "pkg_search.sp_search_int_hdr_Infor", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        // Nadeeka 26-03-2015
        public DataTable Search_int_hdr_Infor_Quotation(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;
            string _othLoc = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    case "OTHER LOC": _othLoc = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }

            _document = (_document != null) ? (_document.ToUpper() + "%") : "%";
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date + "%") : "%";
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : "%";
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : "%";
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : "%";
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : "%";
            _othLoc = (_othLoc != null) ? (_othLoc + "%") : "%";



            OracleParameter[] param = new OracleParameter[16];
            //Fixed Date Range 
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (searchParams[3].ToString());
            (param[6] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[4].ToString());
            //Search parameters
            (param[7] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[8] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[9] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[10] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[11] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[12] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[13] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othLoc;
            (param[14] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "pkg_search.sp_search_int_hdr_Quo", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Code by Chamal 02-04-2013       
        //Code by Chamal 02-04-2013
        public DataTable Search_GIT_AODs(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;
            string _othLoc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    case "OTHER LOC": _othLoc = _searchText; break;
                    default: break;
                }
            }

            _document = (_document != null) ? (_document.ToUpper() + "%") : "%";
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date + "%") : "%";
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : "%";
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : "%";
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : "%";
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : "%";
            _othLoc = (_othLoc != null) ? (_othLoc + "%") : "%";

            OracleParameter[] param = new OracleParameter[15];
            //Fixed Date Range
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            //Search parameters
            (param[6] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[7] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[8] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[9] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[10] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[11] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[12] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othLoc;
            //Initial parameters
            (param[13] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();

            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "pkg_search.sp_search_int_hdr_Infor", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Code by Chamal 02-04-2013
        public DataTable Search_GIT_AODs_WithLoc(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    default: break;
                }
            }

            _document = (_document != null) ? (_document.ToUpper() + "%") : "%";
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date + "%") : "%";
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : "%";
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : "%";
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : "%";
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : "%";

            OracleParameter[] param = new OracleParameter[15];
            //Fixed Date Range
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            //Search parameters
            (param[6] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[7] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[8] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[9] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[10] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[11] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            //Initial parameters
            (param[12] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            (param[13] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5].ToString();

            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "pkg_search.sp_search_int_hdr_Infor", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Code by Chamal 27-03-2013
        public DataTable Search_inr_ser_infor(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ser1 = null;
            string _ser2 = null;
            string _itemStatus = null;
            string _itemCode = null;
            string _warrNo = null;
            string _docNo = null;
            string _docDate = null;

            //Set relevant parameters according to the,search category.
            if (searchParams[0].ToString() == "SER1_WITEM")
            {
                if (!string.IsNullOrEmpty(_searchCatergory))
                {
                    switch (_searchCatergory.ToUpper())
                    {
                        case "SERIAL 1": _ser1 = _searchText; break;
                        case "SERIAL 2": _ser2 = _searchText; break;
                        case "ITEM STATUS": _itemStatus = _searchText; break;
                        case "WARRANTY NO": _warrNo = _searchText; break;
                        case "DOC NO": _docNo = _searchText; break;
                        case "DOC DATE": _docDate = _searchText; break;
                        default: break;
                    }
                }
            }

            if (searchParams[0].ToString() == "SER1_WOITEM")
            {
                if (!string.IsNullOrEmpty(_searchCatergory))
                {
                    switch (_searchCatergory.ToUpper())
                    {
                        case "SERIAL 1": _ser1 = _searchText; break;
                        case "SERIAL 2": _ser2 = _searchText; break;
                        case "ITEM STATUS": _itemStatus = _searchText; break;
                        case "ITEM CODE": _itemCode = _searchText; break;
                        case "WARRANTY NO": _warrNo = _searchText; break;
                        case "DOC NO": _docNo = _searchText; break;
                        case "DOC DATE": _docDate = _searchText; break;
                        default: break;
                    }
                }
            }

            if (searchParams[0].ToString() == "SER2_WOITEM")
            {
                if (!string.IsNullOrEmpty(_searchCatergory))
                {
                    switch (_searchCatergory.ToUpper())
                    {
                        case "SERIAL 1": _ser1 = _searchText; break;
                        case "SERIAL 2": _ser2 = _searchText; break;
                        case "ITEM STATUS": _itemStatus = _searchText; break;
                        case "ITEM CODE": _itemCode = _searchText; break;
                        case "WARRANTY NO": _warrNo = _searchText; break;
                        case "DOC NO": _docNo = _searchText; break;
                        case "DOC DATE": _docDate = _searchText; break;
                        default: break;
                    }
                }
            }

            _ser1 = (_ser1 != null) ? (_ser1 + "%") : "%";
            _ser2 = (_ser2 != null) ? (_ser2 + "%") : "%";
            _itemStatus = (_itemStatus != null) ? (_itemStatus.ToUpper() + "%") : "%";
            _itemCode = (_itemCode != null) ? (_itemCode.ToUpper() + "%") : "%";
            _warrNo = (_warrNo != null) ? (_warrNo + "%") : "%";
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _docDate = (_docDate != null) ? (_docDate + "%") : "%";

            #region pkg_search.sp_search_inr_ser_Infor

            //--sp_search_inr_ser_infor
            //PROCEDURE sp_search_inr_ser_infor
            //(p_type in NVARCHAR2,p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_itemstatus in NUMBER,p_ser1 in NVARCHAR2,p_ser2 in NVARCHAR2,
            //p_warr in NVARCHAR2,p_docno in NVARCHAR2, p_docdate in DATE, c_data OUT sys_refcursor)
            //IS
            //--Chamal 27/03/2013
            //BEGIN

            //IF p_type = 'SER1_WITEM' THEN

            //    OPEN c_data FOR
            //    SELECT ins_ser_1 AS "Serial 1", ins_ser_2 AS "Serial 2", ins_itm_stus AS "Item Status", ins_itm_cd AS "Item Code",
            //    ins_warr_no AS "Warranty No", ins_doc_no AS "Doc No", ins_doc_dt AS "Doc Date"
            //    FROM INR_SER
            //    WHERE ins_com = p_com AND ins_loc = p_loc AND ins_ser_1 <> 'N/A' AND
            //    ins_itm_cd = p_item AND
            //    ins_ser_1 LIKE NVL(p_ser1,'%') AND
            //    ins_ser_2 LIKE NVL(p_ser2,'%') AND
            //    ins_itm_stus LIKE NVL(p_itemstatus,'%') AND
            //    ins_doc_no LIKE NVL(p_docno,'%') AND
            //    ins_doc_dt LIKE NVL(p_docdate,'%') AND
            //    NVL2(ins_warr_no,ins_warr_no,'N/A') LIKE NVL(p_warr,'%')
            //    ORDER BY ins_doc_dt DESC, ins_ser_1 DESC;

            //END IF;

            //IF p_type = 'SER1_WOITEM' THEN

            //    OPEN c_data FOR
            //    SELECT ins_ser_1 AS "Serial 1", ins_ser_2 AS "Serial 2", ins_itm_stus AS "Item Status", ins_itm_cd AS "Item Code",
            //    ins_warr_no AS "Warranty No", ins_doc_no AS "Doc No", ins_doc_dt AS "Doc Date"
            //    FROM INR_SER
            //    WHERE ins_com = p_com AND ins_loc = p_loc AND ins_ser_1 <> 'N/A' AND
            //    ins_itm_cd LIKE NVL(p_item,'%') AND
            //    ins_ser_1 LIKE NVL(p_ser1,'%') AND
            //    ins_ser_2 LIKE NVL(p_ser2,'%') AND
            //    ins_itm_stus LIKE NVL(p_itemstatus,'%') AND
            //    ins_doc_no LIKE NVL(p_docno,'%') AND
            //    ins_doc_dt LIKE NVL(p_docdate,'%') AND
            //    NVL2(ins_warr_no,ins_warr_no,'N/A') LIKE NVL(p_warr,'%')
            //    ORDER BY ins_doc_dt DESC, ins_ser_1 DESC;

            //END IF;

            //IF p_type = 'SER2_WOITEM' THEN

            //    OPEN c_data FOR
            //    SELECT ins_ser_2 AS "Serial 2", ins_ser_1 AS "Serial 1", ins_itm_stus AS "Item Status", ins_itm_cd AS "Item Code",
            //    ins_warr_no AS "Warranty No", ins_doc_no AS "Doc No", ins_doc_dt AS "Doc Date"
            //    FROM INR_SER
            //    WHERE ins_com = p_com AND ins_loc = p_loc AND ins_ser_1 <> 'N/A' AND ins_ser_2 <> 'N/A' AND
            //    ins_itm_cd LIKE NVL(p_item,'%') AND
            //    ins_ser_1 LIKE NVL(p_ser1,'%') AND
            //    ins_ser_2 LIKE NVL(p_ser2,'%') AND
            //    ins_itm_stus LIKE NVL(p_itemstatus,'%') AND
            //    ins_doc_no LIKE NVL(p_docno,'%') AND
            //    ins_doc_dt LIKE NVL(p_docdate,'%') AND
            //    NVL2(ins_warr_no,ins_warr_no,'N/A') LIKE NVL(p_warr,'%')
            //    ORDER BY ins_doc_dt DESC, ins_ser_2 DESC;

            //END IF;

            //END;--sp_search_inr_ser_infor

            #endregion pkg_search.sp_search_inr_ser_Infor

            OracleParameter[] param = new OracleParameter[11];
            //Initial parameters
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            if (searchParams[0].ToString() == "SER1_WITEM")
            {
                (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            }
            if (searchParams[0].ToString() == "SER1_WOITEM")
            {
                (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            }
            if (searchParams[0].ToString() == "SER2_WOITEM")
            {
                (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            }

            //Search parameters
            (param[4] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemStatus;
            (param[5] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser1;
            (param[6] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser2;
            (param[7] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrNo;
            (param[8] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[9] = new OracleParameter("p_docdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docDate;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSerials", "pkg_search.sp_search_inr_ser_infor", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetSchemaCategory(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchschemacategory", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSchemaType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchschematype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 23/11/2012
        public DataTable GetServiceAgent(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address = null;
            string _city = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            //_address = (_address != null) ? (_address.ToUpper() + "%") : null;
            //_city = (_city != null) ? (_city.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            //(param[3] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            //(param[4] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_Service_Agent", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 26-11-2012
        public DataTable Get_hp_parameterTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = string.Empty;
            string _Desc = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _Desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != string.Empty) ? (_code.ToUpper() + "%") : string.Empty;
            _Desc = (_Desc != string.Empty) ? (_Desc.ToUpper() + "%") : string.Empty;

            // PROCEDURE SP_Get_hpr_para_tp(p_code in NVARCHAR2,p_desc in NVARCHAR2, c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.SP_Get_hpr_para_tp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 26-11-2012
        public DataTable GET_FixAsset_ref(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = string.Empty;
            string _Loc = string.Empty;
            string _Status = string.Empty;
            string _date = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "REFERENCE":
                        _code = _searchText;
                        break;

                    case "DATE":
                        //_searchText.Replace("\\/", "-");
                        _date = _searchText;
                        break;

                    case "STATUS":
                        _Status = _searchText;
                        break;
                    //case "Status":
                    //    _Status = _searchText;
                    //    break;
                    default:
                        break;
                }
            }

            //remove startin %
            if (_Status != null && _Status.Length > 1)
                _Status = _Status.Substring(1, _Status.Length - 1);

            //  _code = (_code != string.Empty) ? (_code.ToUpper() + "%") : string.Empty;
            //   _date = (_date != string.Empty) ? (_date.ToUpper() + "%") : string.Empty;
            _date = (_date != null) ? (_date.ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _Status = (_Status != null) ? (_Status.ToUpper()) : "999";
            //_Status = (_Status != string.Empty) ? (_Status.ToUpper() + "%") : string.Empty;

            // ( p_com in NVARCHAR2,p_loc in NVARCHAR2,p_refNo in NVARCHAR2,p_type in NUMBER,p_status in NUMBER,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;//searchParams[0].ToString();
            (param[3] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Status;
            (param[5] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_FixAsset_ref", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Darshana on 28/12/2012
        public DataTable GetCustomerCommon(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address1 = null;
            string _address2 = null;
            string _NIC = null;
            string _Mob = null;
            string _Br = null;
            string _VAT = null;
            string _OTHNO = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS1":
                        _address1 = _searchText;
                        break;

                    case "ADDRESS2":
                        _address2 = _searchText;
                        break;

                    case "NIC":
                        _NIC = _searchText;
                        break;

                    case "MOBILE":
                        _Mob = _searchText;
                        break;

                    case "BR NO":
                        _Br = _searchText;
                        break;

                    case "VAT REG":
                        _VAT = _searchText;
                        break;

                    case "OTH NO":
                        _OTHNO = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _address1 = (_address1 != null) ? (_address1.ToUpper() + "%") : null;
            _address2 = (_address2 != null) ? (_address2.ToUpper() + "%") : null;
            _NIC = (_NIC != null) ? (_NIC.ToUpper() + "%") : null;
            _Mob = (_Mob != null) ? (_Mob.ToUpper() + "%") : null;
            _Br = (_Br != null) ? (_Br.ToUpper() + "%") : null;
            _VAT = (_VAT != null) ? (_VAT.ToUpper() + "%") : null;
            _OTHNO = (_OTHNO != null) ? (_OTHNO.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[3] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address1;
            (param[4] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address2;
            (param[5] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NIC;
            (param[6] = new OracleParameter("p_Mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Mob;
            (param[7] = new OracleParameter("p_BRNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Br;
            (param[8] = new OracleParameter("p_Tax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _VAT;
            (param[9] = new OracleParameter("p_oth_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OTHNO;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcustomerCommon", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Nadeeka on 15-dec-2014
        public DataTable GetSupplierCommon(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address1 = null;
            string _address2 = null;
            string _NIC = null;
            string _Mob = null;
            string _Br = null;
            string _VAT = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS1":
                        _address1 = _searchText;
                        break;

                    case "ADDRESS2":
                        _address2 = _searchText;
                        break;

                    case "NIC":
                        _NIC = _searchText;
                        break;

                    case "MOBILE":
                        _Mob = _searchText;
                        break;

                    case "BR NO":
                        _Br = _searchText;
                        break;

                    case "VAT REG":
                        _VAT = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _address1 = (_address1 != null) ? (_address1.ToUpper() + "%") : null;
            _address2 = (_address2 != null) ? (_address2.ToUpper() + "%") : null;
            _NIC = (_NIC != null) ? (_NIC.ToUpper() + "%") : null;
            _Mob = (_Mob != null) ? (_Mob.ToUpper() + "%") : null;
            _Br = (_Br != null) ? (_Br.ToUpper() + "%") : null;
            _VAT = (_VAT != null) ? (_VAT.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[3] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address1;
            (param[4] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address2;
            (param[5] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NIC;
            (param[6] = new OracleParameter("p_Mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Mob;
            (param[7] = new OracleParameter("p_BRNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Br;
            (param[8] = new OracleParameter("p_Tax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _VAT;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchsupplierCommon", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 12/01/2012
        public DataTable GetSearchMRN(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _mrn = null;
            string _manual = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MRN NO":
                        _mrn = _searchText;
                        break;

                    case "MANUAL REF.":
                        _manual = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _mrn = (_mrn != null) ? (_mrn.ToUpper() + "%") : null;
            _manual = (_manual != null) ? (_manual.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            // sp_searchmrn(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manual;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchmrn", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //----------------------------------------------------------------------------------------------------
        public DataTable SearchAcServicesJobs(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _jobNo = string.Empty;
            //string _Desc = string.Empty;
            string _status = string.Empty;
            string _jobTp = string.Empty;
            string _warrntyNo = string.Empty;
            string _date = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "JOB NO":
                        _jobNo = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "JOB TYPE":
                        _jobTp = _searchText;
                        break;
                    //case "WARRANTY_NO":
                    //    _warrntyNo = _searchText;
                    //    break;
                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //PROCEDURE sp_search_AcJob(p_jobno in NVARCHAR2,p_status in NVARCHAR2,p_jobType in NVARCHAR2,p_serial in NVARCHAR2, c_data Out sys_refcursor)

            _jobNo = (_jobNo != string.Empty) ? (_jobNo.ToUpper() + "%") : string.Empty;
            _status = (_status != string.Empty) ? (_status.ToUpper() + "%") : string.Empty;
            _jobTp = (_jobTp != string.Empty) ? (_jobTp.ToUpper() + "%") : string.Empty;
            _warrntyNo = (_warrntyNo != string.Empty) ? (_warrntyNo.ToUpper() + "%") : string.Empty;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            (param[2] = new OracleParameter("p_jobType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobTp;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrntyNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_AcJob", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                foreach (DataRow dr in _dtResults.Rows)
                {
                    if (dr["STATUS"].ToString() == "P")
                    {
                        dr["STATUS"] = "PENDING";
                    }
                    if (dr["STATUS"].ToString() == "C")
                    {
                        dr["STATUS"] = "COMPLEATE";
                    }
                    if (dr["STATUS"].ToString() == "A")
                    {
                        dr["STATUS"] = "APPROVED";
                    }
                    if (dr["STATUS"].ToString() == "R")
                    {
                        dr["STATUS"] = "REJECT";
                    }
                }
            }

            return _dtResults;
        }

        public DataTable GetInvoiceNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invno = null;
            string _type = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _invno = _searchText;
                        break;

                    case "DESCRIPTION":
                        _type = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invno = (_invno != null) ? (_invno.ToUpper() + "%") : null;
            _type = (_type != null) ? (_type.ToUpper() + "%") : null;
            //PROCEDURE  sp_get_Invoice(p_invoiceNo in NVARCHAR2, p_invTp in NVARCHAR2,c_data Out sys_refcursor);
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_invTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_get_Invoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAvailableSerialNonSerialSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial = null;
            string _indocno = null;
            string _itemstatus = null;
            string _warrno = null;
            string _serialseq = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEQ. ID":
                        _serialseq = _searchText;
                        break;

                    case "ITEM STATUS":
                        _itemstatus = _searchText;
                        break;

                    case "INWARD DOCUMENT":
                        _indocno = _searchText;
                        break;

                    case "WARRANTY NO":
                        _warrno = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _indocno = (_indocno != null) ? (_indocno.ToUpper() + "%") : "%";
            _itemstatus = (_itemstatus != null) ? (_itemstatus.ToUpper() + "%") : "%";
            _warrno = (_warrno != null) ? (_warrno.ToUpper() + "%") : "%";
            _serialseq = (_serialseq != null) ? (_serialseq.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_inwarddocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _indocno;
            (param[5] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrno;
            (param[6] = new OracleParameter("p_serseq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialseq;
            (param[7] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchserialnoneserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAvailableSeriaSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial = null;
            string _indocno = null;
            string _itemstatus = null;
            string _warrno = null;
            string _serialseq = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEQ. ID":
                        _serialseq = _searchText;
                        break;

                    case "ITEM STATUS":
                        _itemstatus = _searchText;
                        break;

                    case "INWARD DOCUMENT":
                        _indocno = _searchText;
                        break;

                    case "WARRANTY NO":
                        _warrno = _searchText;
                        break;

                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _indocno = (_indocno != null) ? (_indocno.ToUpper() + "%") : "%";
            _itemstatus = (_itemstatus != null) ? (_itemstatus.ToUpper() + "%") : "%";
            _warrno = (_warrno != null) ? (_warrno.ToUpper() + "%") : "%";
            _serialseq = (_serialseq != null) ? (_serialseq.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchinventorySerial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //sachith
        //2013/01/22
        public DataTable GetGRNItemSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchgrnitem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        // Nadeeka 09-03-2015
        public DataTable GetMainItemSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchmainitem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search from Invoice data according to the customer.
        //darshana 22/01/2013
        public DataTable GetCashInvoicebyCustomer(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcashinvoicewithcus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //sachith 23/01/2013
        public DataTable GetDIN(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string req_no = null;
            string create = null;
            string date = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQ NO":
                        req_no = _searchText;
                        break;

                    case "CREATE":
                        create = _searchText;
                        break;

                    case "DATE":
                        date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            req_no = (req_no != null) ? (req_no.ToUpper() + "%") : "%";
            create = (create != null) ? (create.ToUpper() + "%") : "%";
            date = (date != null) ? (date.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            (param[3] = new OracleParameter("p_create", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = create;
            (param[4] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblDin", "pkg_search.sp_searchdin", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search from Hire sales Invoice data according to the customer.
        //darshana 01/02/2013
        public DataTable GetHPInvoicebyCustomer(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _accNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "Account No":
                        _accNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[5] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchhpinvoicewithcus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Common Search from Invoice data.
        //Code by darshana on 26/11/2012
        public DataTable GetHpInvoices(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _accNo = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "ACCOUNT NO":
                        _accNo = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchhpinvoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchReceipt(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _receiptNo = null;
            string _manualNo = null;
            string _date = null;
            // string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT NO":
                        _receiptNo = _searchText;
                        break;

                    case "MANUAL NO":
                        _manualNo = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _receiptNo = (_receiptNo != null) ? (_receiptNo.ToUpper() + "%") : null;
            _manualNo = (_manualNo != null) ? (_manualNo.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;
            if (_receiptNo == null)
            {
                _receiptNo = _manualNo;
            }
            // _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            //sp_search_receipt( p_com in NVARCHAR2,p_pc IN NVARCHAR2, p_docno in NVARCHAR2,p_recTp in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiptNo;
            (param[3] = new OracleParameter("p_recTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_receipt", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //darshana on 09-02-2013
        public DataTable GetInvoiceForReversal(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinvforrev", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 13/02/2012
        public DataTable GetSearchInterTransferRequest(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _mrn = null;
            string _manual = null;
            string _status = null;
            string _loc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INTER-TRANSFER NO":
                        _mrn = _searchText;
                        break;

                    case "MANUAL REF.":
                        _manual = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "LOCATION":
                        _loc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _mrn = (_mrn != null) ? (_mrn.ToUpper() + "%") : null;
            _manual = (_manual != null) ? (_manual.ToUpper() + "%") : null;
            _loc = (_loc != null) ? (_loc.ToUpper() + "%") : null;

            // sp_searchinttrnsreq(p_com in NVARCHAR2,p_user in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manual;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinttrnsreq", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 14/02/2013
        public DataTable GetInvoiceforInterTransferSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;
            string _account = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    case "ACCOUNT":
                        _account = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;
            _account = (_account != null) ? (_account.ToUpper() + "%") : null;

            //PROCEDURE sp_searchintertrsales  (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2,p_doctype in NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_account in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            (param[7] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchintertrsales", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 19/02/2013
        public DataTable GetCircularSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;

                    case "PROMOTION":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcircular", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Darshana on 23/02/2012
        public DataTable GetSearchHpAdjuestment(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            // sp_searchmrn(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_hpAdjTypes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 19/02/2013
        public DataTable GetSerInvSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _Customer = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _invoiceNo = _searchText;
                        break;

                    case "CUSTOMER":
                        _Customer = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _Customer = (_Customer != null) ? (_Customer.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Customer;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchserviceinvoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //-------------------------------------------------------------------------------
        //Written By Shani on 26/02/2013
        public DataTable Get_Search_cheque(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _chqNo = null;
            string _bankCd = null;
            string _date = null;
            string _pc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                //   SARD_REF_NO as "CHEQUE NO", sar_receipt_type AS "RECEIPT TYPE",SARD_CHQ_BANK_CD as "BANK",sard_chq_dt as "DATE"
                switch (_searchCatergory.ToUpper())
                {
                    case "CHEQUE NO":
                        _chqNo = _searchText;
                        break;

                    case "BANK":
                        _bankCd = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText.ToString();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _chqNo = (_chqNo != null) ? (_chqNo.ToUpper() + "%") : null;
            _bankCd = (_bankCd != null) ? (_bankCd.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;
            _pc = (_pc != null) ? (_pc.ToUpper() + "%") : null;

            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_refNo in NVARCHAR2,p_bankCd in NVARCHAR2,p_chqDate in DATE,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();//_pc;
            (param[2] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqNo;
            (param[3] = new OracleParameter("p_bankCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString() == "" ? _bankCd : searchParams[2].ToString();
            (param[4] = new OracleParameter("p_chqDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(_date).Date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblSearch", "pkg_search.sp_search_cheque", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Search_return_cheque(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _chqNo = null;
            string _bankCd = null;
            string _date = null;
            string _pc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                //   SARD_REF_NO as "CHEQUE NO", sar_receipt_type AS "RECEIPT TYPE",SARD_CHQ_BANK_CD as "BANK",sard_chq_dt as "DATE"
                switch (_searchCatergory.ToUpper())
                {
                    case "CHEQUE NO":
                        _chqNo = _searchText;
                        break;

                    case "BANK":
                        _bankCd = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText.ToString();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _chqNo = (_chqNo != null) ? (_chqNo.ToUpper() + "%") : null;
            _bankCd = (_bankCd != null) ? (_bankCd.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;
            _pc = (_pc != null) ? (_pc.ToUpper() + "%") : null;

            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_refNo in NVARCHAR2,p_bankCd in NVARCHAR2,p_chqDate in DATE,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();//_pc;
            (param[2] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqNo;
            (param[3] = new OracleParameter("p_bankCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString() == "" ? _bankCd : searchParams[2].ToString();
            (param[4] = new OracleParameter("p_chqDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(_date).Date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblSearch", "pkg_search.sp_search_rtn_cheque", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written By Prabhath on 06/03/2013
        public DataTable GetWarrantyClaimableInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _Customer = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _invoiceNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //sp_searchwaraclaiminvoice(p_com in NVARCHAR2,p_customer in NVARCHAR2,p_item in NVARCHAR2,p_invoiceno in NVARCHAR2,c_data out SYS_REFCURSOR)
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString(); ;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString(); ;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString(); ;
            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchwaraclaiminvoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 06/03/2013
        public DataTable GetWarrantyClaimableSerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial1 = null;
            string _serial2 = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL 1":
                        _serial1 = _searchText;
                        break;

                    case "SERIAL 2":
                        _serial2 = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //PROCEDURE sp_searchwaraclaimserial(p_invoice in NVARCHAR2,p_item in NVARCHAR2,p_serial1 in NVARCHAR2,p_serial2 in NVARCHAR2,c_data out SYS_REFCURSOR);
            _serial1 = (_serial1 != null) ? (_serial1.ToUpper() + "%") : null;
            _serial2 = (_serial2 != null) ? (_serial2.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_serial1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[3] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchwaraclaimserial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Search Movement Document Sub Types
        //Code by Chamal on 09/03/2013
        public DataTable GetMovementDocSubTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docType = null;
            string _docTypeDesc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docType = _searchText;
                        break;

                    case "DESCRIPTION":
                        _docTypeDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docType = (_docType != null) ? (_docType.ToUpper() + "%") : null;
            _docTypeDesc = (_docTypeDesc != null) ? (_docTypeDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_movtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_movsubtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            (param[2] = new OracleParameter("p_movsubtypedesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docTypeDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_search_movcatetype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 11/03/2013
        public DataTable Get_Search_Registration_Det(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rec = null;
            string _engine = null;
            string _chassis = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                //   SARD_REF_NO as "CHEQUE NO", sar_receipt_type AS "RECEIPT TYPE",SARD_CHQ_BANK_CD as "BANK",sard_chq_dt as "DATE"
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT":
                        _rec = _searchText;
                        break;

                    case "ENGINE":
                        _engine = _searchText.ToString();
                        break;

                    case "CHASSIS":
                        _chassis = _searchText.ToString();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rec = (_rec != null) ? (_rec.ToUpper() + "%") : null;
            _engine = (_engine != null) ? (_engine.ToUpper() + "%") : null;
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : null;

            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_refNo in NVARCHAR2,p_bankCd in NVARCHAR2,p_chqDate in DATE,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();//_pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();//invoice;
            (param[3] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[5] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[6] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblSearch", "pkg_search.sp_search_reg_by_invoice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetVehicalInsuranceRef(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rec = null;
            string _vehNo = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECIEPT_NO":
                        _rec = _searchText;
                        break;

                    case "VEHICAL_NO":
                        _vehNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rec = (_rec != null) ? (_rec.ToUpper() + "%") : "%";
            _vehNo = (_vehNo != null) ? (_vehNo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[1] = new OracleParameter("p_vehNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_search_vehical_ins_ref", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCashCommissionCircularNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _circular = null;
            string _create = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR_NO":
                        _circular = _searchText;
                        break;

                    case "CREATE":
                        _create = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _circular = (_circular != null) ? (_circular.ToUpper() + "%") : "%";
            _create = (_create != null) ? (_create.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_cre", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _create;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_search_circularNo", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By darshana on 14/03/2013
        public DataTable Get_Search_Insuarance_Det(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rec = null;
            string _engine = null;
            string _chassis = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                //   SARD_REF_NO as "CHEQUE NO", sar_receipt_type AS "RECEIPT TYPE",SARD_CHQ_BANK_CD as "BANK",sard_chq_dt as "DATE"
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT":
                        _rec = _searchText;
                        break;

                    case "ENGINE":
                        _engine = _searchText.ToString();
                        break;

                    case "CHASSIS":
                        _chassis = _searchText.ToString();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rec = (_rec != null) ? (_rec.ToUpper() + "%") : null;
            _engine = (_engine != null) ? (_engine.ToUpper() + "%") : null;
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : null;

            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_refNo in NVARCHAR2,p_bankCd in NVARCHAR2,p_chqDate in DATE,c_data OUT sys_refcursor);

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();//_pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();//invoice;
            (param[3] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[5] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[6] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblSearch", "pkg_search.sp_search_ins_by_invoice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetVehicalInsuranceDebitNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _debit = null;
            string _create = null;
            string _creDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DEBIT_NO":
                        _debit = _searchText;
                        break;

                    case "SETTLE_BY":
                        _create = _searchText;
                        break;

                    case "SETTLE_DATE":
                        _creDt = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _debit = (_debit != null) ? (_debit.ToUpper() + "%") : "%";
            _create = (_create != null) ? (_create.ToUpper() + "%") : "%";
            _creDt = (_creDt != null) ? (_creDt.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_debit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _debit;
            (param[1] = new OracleParameter("p_crete", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _create;
            (param[2] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _create;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_search_vehins_debit", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetvehicalInsuranceRegistrationNUmber(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _regNo = null;
            string _regUser = null;
            string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REGISTRATION_NO":
                        _regNo = _searchText;
                        break;

                    case "REGISTRATION_BY":
                        _regUser = _searchText;
                        break;

                    case "REGISTRATION_DATE":
                        _regDt = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _regNo = (_regNo != null) ? (_regNo.ToUpper() + "%") : "%";
            _regUser = (_regUser != null) ? (_regUser.ToUpper() + "%") : "%";
            _regDt = (_regDt != null) ? (_regDt.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regNo;
            (param[1] = new OracleParameter("p_reg_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regUser;
            (param[2] = new OracleParameter("p_reg_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _regDt;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("tblItemSearch", "pkg_search.sp_search_vehins_reg_no", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable Get_Hp_ActiveAccounts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string accountNo = null;
            string pc = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT NUMBER":
                        accountNo = _searchText;
                        break;

                    //case "STATUS":
                    //    _regUser = _searchText;
                    //    break;
                    case "PROFIT CENTER":
                        pc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            accountNo = (accountNo != null) ? (accountNo.ToUpper() + "%") : "%";
            pc = (pc != null) ? (pc.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc; //searchParams[1].ToString();
            (param[2] = new OracleParameter("p_Currentdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2].ToString()).Date; ;
            (param[3] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString()).Date;
            (param[4] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[4].ToString()).Date;
            (param[5] = new OracleParameter("p_accountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accountNo;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("tblItemSearch", "pkg_search.get_active_hp_ACC", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetRawPriceBook(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _book = null;
            string _desc = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BOOK":
                        _book = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _book = (_book != null) ? (_book.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_searchrawpricebook (p_com in NVARCHAR2, p_book in NVARCHAR2,p_description in NVARCHAR2,c_data out sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _book;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchrawpricebook", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetRawPriceLevel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _level = null;
            string _desc = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LEVEL":
                        _level = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _level = (_level != null) ? (_level.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_searchrawpricelevel (p_com in NVARCHAR2, p_book in NVARCHAR2,p_level in NVARCHAR2,p_description in NVARCHAR2,c_data out sys_refcursor);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _level;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchrawpricelevel", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetVehicalJobRegistrationNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _engine = null;
            string _chassis = null;
            string _vehNo = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "VEHICAL NUMBER":
                        _vehNo = _searchText;
                        break;

                    case "ENGINE":
                        _engine = _searchText;
                        break;

                    case "CHASSIS":
                        _chassis = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _vehNo = (_vehNo != null) ? (_vehNo.ToUpper() + "%") : "%";
            _engine = (_engine != null) ? (_engine.ToUpper() + "%") : "%";
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : "%";

            //sp_searchrawpricelevel (p_com in NVARCHAR2, p_book in NVARCHAR2,p_level in NVARCHAR2,p_description in NVARCHAR2,c_data out sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[1] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[2] = new OracleParameter("p_vehNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchvehjob", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetSchemaTypeByCate(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cate_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchschematypebycate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //darshana on 10-04-2013
        public DataTable GetAllScheme(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchscheme", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_invoiceDet(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invNo = null;
            string _custCd = null;
            string _name = null;
            string _status = null;
            string _docTp = null;
            string _pcenter = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invNo = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _custCd = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invNo = (_invNo != null) ? (_invNo.ToUpper() + "%") : "%";
            _custCd = (_custCd != null) ? (_custCd.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _status = (_status != null) ? (_status.ToUpper() + "%") : "%";
            _pcenter = (_pcenter != null) ? (_pcenter.ToUpper() + "%") : "%";
            _docTp = (_docTp != null) ? (_docTp.ToUpper() + "%") : "%";

            // sp_search_salesdoc
            //(p_com in NVARCHAR2,p_pcenter IN NVARCHAR2,p_doctype in NVARCHAR2, p_invoiceno IN NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_status in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcenter;
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docTp;
            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[4] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCd;
            (param[5] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_search_salesdoc", CommandType.StoredProcedure, false, param);
            //if (_result != null)
            //{
            //    foreach (DataRow dr in _result.Rows)
            //    {
            //        if (dr["STATUS"].ToString() == "1")
            //        {
            //            dr["STATUS"] = "APPROVED";
            //        }
            //        if (dr["STATUS"].ToString() == "0")
            //        {
            //            dr["STATUS"] = "NOT APPROVED";
            //        }
            //    }
            //}
            return _result;
        }

        public DataTable Get_Party_Types(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchPartyTypes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchTransactionType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            // sp_searchtransactiontype(p_com in NVARCHAR2,p_code in NVARCHAR2,p_description in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchtransactiontype", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable Get_Party_Codes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_party_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchPartyCodes", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetVoucheNos(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _voucher = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "VOUCHER NUMBER":
                        _voucher = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _voucher = (_voucher != null) ? (_voucher.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_getvoucher", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //darshana on 16-04-2013
        public DataTable GetItemBrands(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchbrand", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_Promotion_Codes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _result = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _promo = null;
            //string _regUser = null;
            //string _regDt = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "CODE":
                        _promo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _promo = (_promo != null) ? (_promo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _result = QueryDataTable("Table", "pkg_search.sp_searchpromocode", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetCircularSearchByBookAndLevel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;

                    case "PROMOTION":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[3] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcirbybookandlevel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Search Serial prices circulars
        public DataTable GetCircularSearchForSerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchserialCircular", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSerialDetForCir(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _invoiceNo = _searchText;
                        break;

                    case "SERIAL":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[2] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchserpriceitmsforCir", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAllProofDocs(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _invoiceNo = _searchText;
                        break;

                    case "DESCRIPTION":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchproofdoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInternalVoucherExpense(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _expense = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EXPENSE CODE":
                        _expense = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _expense = (_expense != null) ? (_expense.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_exp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_vou_expen", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_GPC(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string gpc_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        gpc_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            ////Modify parameter values for LIKE search.
            // sp_search_GPC(  p_GPC in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            //gpc_ = (_invoiceNo != null) ? (gpc_.ToUpper() + "%") : null;
            //desc_ = (_manualRef != null) ? (desc_.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_GPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = gpc_;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_GPC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //darshana on 09-02-2013
        public DataTable GetInvoiceForReversalOth(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinvforrevoth", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by darshana on 26/11/2012
        public DataTable GetHpInvoicesOth(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _accNo = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "ACCOUNT NO":
                        _accNo = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchhpinvoiceOth", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Chamal 03/05/2013
        public DataTable Get_Move_Types(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code_;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "pkg_search.sp_search_move_types", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Chamal 03/05/2013
        public DataTable Get_InventoryDirections(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code_;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "pkg_search.sp_search_inv_direct", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by darshana on 26/11/2012
        public DataTable GetComInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "Ref No":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[2] = new OracleParameter("p_refDoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcominv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by darshana on 11/05/2013
        public DataTable GetItemByType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;
            string _model = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();   //kapila 5/2/2016
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.

            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchitembytype_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count == 0)
            {
                _dtResults = null;
            }
            return _dtResults;
        }

        public DataTable GetCreditNote(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _baseRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL_REF":
                        _manualRef = _searchText;
                        break;

                    case "BASE NO":
                        _baseRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : "%";
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : "%";
            _baseRef = (_baseRef != null) ? (_baseRef.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_basedoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseRef;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcreditnote", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Shani 15/05/2013
        public DataTable Get_system_role(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string com_ = null;
            string code_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ID":
                        code_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            com_ = (com_ != null) ? (com_.ToUpper() + "%") : "%";
            code_ = (code_ != null) ? (code_.ToUpper() + "%") : "%";
            desc_ = (desc_ != null) ? (desc_.ToUpper() + "%") : "%";

            //sp_search_system_role(p_com in NVARCHAR2,p_roleID in NVARCHAR2, p_roleName in NVARCHAR2,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_roleID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code_;
            (param[2] = new OracleParameter("p_roleName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "pkg_search.sp_search_system_role", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCustomerId(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _nic = null;
            string _dl = null;
            string _pp = null;
            string _br = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NIC NO":
                        _nic = _searchText;
                        break;

                    case "PP NO":
                        _pp = _searchText;
                        break;

                    case "BR NO":
                        _br = _searchText;
                        break;

                    case "DL NO":
                        _dl = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_code = (_code != null) ? (_code.ToUpper() + "%") : null;
            //_nic = (_nic != null) ? (_nic.ToUpper() + "%") : null;
            //_dl = (_dl != null) ? (_dl.ToUpper() + "%") : null;
            //_pp = (_pp != null) ? (_pp.ToUpper() + "%") : null;
            //_br = (_br != null) ? (_br.ToUpper() + "%") : null;

            _code = (_code != null) ? (_code.ToUpper()) : null;
            _nic = (_nic != null) ? (_nic.ToUpper()) : null;
            _dl = (_dl != null) ? (_dl.ToUpper()) : null;
            _pp = (_pp != null) ? (_pp.ToUpper()) : null;
            _br = (_br != null) ? (_br.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_pp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pp;
            (param[4] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dl;
            (param[5] = new OracleParameter("p_br", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _br;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcusids", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetVehicalRegistrationRef(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rec = null;
            string _vehNo = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECIEPT_NO":
                        _rec = _searchText;
                        break;

                    case "VEHICAL_NO":
                        _vehNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rec = (_rec != null) ? (_rec.ToUpper() + "%") : "%";
            _vehNo = (_vehNo != null) ? (_vehNo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[1] = new OracleParameter("p_vehNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_search_vehical_reg_ref", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchBuyBackItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            _model = (_model != null) ? (_model.ToUpper() + "%") : "%";
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : "%";

            //PROCEDURE sp_searchbuybackitem(p_company in NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_model in NVARCHAR2,p_brand in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblsp_searchbuybackitem", "pkg_search.sp_searchbuybackitem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Search scheme commision by circular
        public DataTable GetSchemeComByCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo + "%") : null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_schemscombycir", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchInvoice(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _manualrefno = (_manualrefno != null) ? (_manualrefno.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer + "%") : "%";
            _customername = (_customername != null) ? (_customername + "%") : "%";
            _status = (_status != null) ? (_status + "%") : "%";

            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchInvoice", "pkg_search.sp_searchinvoice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Shani 22/05/2013
        public DataTable Get_system_option_Groups(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string grpId_ = null;
            string desc_ = null;
            string fromPd_ = null;
            string toPd_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ID":
                        grpId_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    case "FROM":
                        fromPd_ = _searchText;
                        break;

                    case "TO":
                        toPd_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            grpId_ = (grpId_ != null) ? (grpId_.ToUpper() + "%") : "%";
            desc_ = (desc_ != null) ? (desc_.ToUpper() + "%") : "%";
            fromPd_ = (fromPd_ != null) ? (fromPd_.ToUpper() + "%") : "%";
            toPd_ = (toPd_ != null) ? (toPd_.ToUpper() + "%") : "%";

            //p_groupID, p_desc,p_fromPd,p_toPd

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_groupID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = grpId_;//searchParams[0].ToString();
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            (param[2] = new OracleParameter("p_fromPd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fromPd_;
            (param[3] = new OracleParameter("p_toPd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = toPd_;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblgroups", "pkg_search.sp_search_system_optionGroups", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchLoyaltyCard(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _cardno = null;
            string _serial = null;
            string _type = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CARD NO":
                        _cardno = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "TYPE":
                        _type = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _cardno = (_cardno != null) ? (_cardno.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial.ToUpper() + "%") : "%";
            _type = (_type != null) ? (_type.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[1].ToString()).Date;

            (param[2] = new OracleParameter("p_cdno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cardno;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchloyaltycard", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //darshana on 06-06-2013
        public DataTable SearchGsByCus(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "GROUP CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Convert.ToInt16(searchParams[3]);
            (param[4] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[5]).Date;

            (param[6] = new OracleParameter("p_gs", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[7] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchValidGsByCus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetLoyaltyCardNos(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _card = null;
            string _loyalty = null;
            string _customer = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CARD NO":
                        _card = _searchText;
                        break;

                    case "LOYALTY TYPE":
                        _loyalty = _searchText;
                        break;

                    case "CUSTOMER":
                        _customer = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _card = (_card != null) ? (_card.ToUpper() + "%") : "%";
            _loyalty = (_loyalty != null) ? (_loyalty.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_card", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _card;
            (param[1] = new OracleParameter("p_loyalty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loyalty;
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_search_loyalty_card_nos", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDocProInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _reciept = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "RECIEPT NO":
                        _reciept = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _reciept = (_reciept != null) ? (_reciept.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchinvoice_doc_pro", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDocProEngine(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _reciept = null;
            string _engine = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "RECIEPT NO":
                        _reciept = _searchText;
                        break;

                    case "ENGINE":
                        _engine = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _reciept = (_reciept != null) ? (_reciept.ToUpper() + "%") : "%";
            _engine = (_engine != null) ? (_engine.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_eng", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchengine_doc_pro", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDocProChassis(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _reciept = null;
            string _chassis = null;
            string _venNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "RECIEPT NO":
                        _reciept = _searchText;
                        break;

                    case "CHASSIS":
                        _chassis = _searchText;
                        break;

                    case "REGISTRATION NO":
                        _venNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _reciept = (_reciept != null) ? (_reciept.ToUpper() + "%") : "%";
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : "%";
            _venNo = (_venNo != null) ? (_venNo.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_cha", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[5] = new OracleParameter("p_veh", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _venNo;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchchassis_doc_pro", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchEmployeeAssignToProfitCenter(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _epf = null;
            string _firstname = null;
            string _lastname = null;
            string _code = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF":
                        _epf = _searchText;
                        break;

                    case "FIRST NAME":
                        _firstname = _searchText;
                        break;

                    case "LAST NAME":
                        _lastname = _searchText;
                        break;

                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : "%";
            _firstname = (_firstname != null) ? (_firstname.ToUpper() + "%") : "%";
            _lastname = (_lastname != null) ? (_lastname.ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";

            //sp_searchemployeeinpc(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_epf in NVARCHAR2,p_firstname in NVARCHAR2,p_lastname in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[3] = new OracleParameter("p_firstname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _firstname;
            (param[4] = new OracleParameter("p_lastname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lastname;
            (param[5] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchemployeeinpc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetVehicalRMVNotSendInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _reciept = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "RECIEPT NO":
                        _reciept = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _reciept = (_reciept != null) ? (_reciept.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchinvoice_rmv_not", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetVehicalRMVNotSendEngine(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _reciept = null;
            string _engine = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "RECIEPT NO":
                        _reciept = _searchText;
                        break;

                    case "ENGINE":
                        _engine = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _reciept = (_reciept != null) ? (_reciept.ToUpper() + "%") : "%";
            _engine = (_engine != null) ? (_engine.ToUpper() + "%") : "%";

            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_eng", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchengine_rmv_not", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetVehicalRMVNotSendChassis(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null;
            string _reciept = null;
            string _chassis = null;
            string _vehNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "RECIEPT NO":
                        _reciept = _searchText;
                        break;

                    case "CHASSIS":
                        _chassis = _searchText;
                        break;

                    case "REGISTRATION NO":
                        _vehNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _reciept = (_reciept != null) ? (_reciept.ToUpper() + "%") : "%";
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : "%";
            _vehNo = (_vehNo != null) ? (_vehNo.ToUpper() + "%") : "%";
            //sp_searchloyaltycard (p_customer in NVARCHAR2,p_date in date,p_cdno in NVARCHAR2,p_serial in NVARCHAR2,p_type in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_cha", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[5] = new OracleParameter("p_veh", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _vehNo;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblResult", "pkg_search.sp_searchchassis_rmv_not", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetVehical_regTxn(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _rec = null;
            string _invoice = null;
            string _chassis = null;
            string _engine = null;
            string _date = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT":
                        _rec = _searchText;
                        break;

                    case "INVOICE":
                        _invoice = _searchText;
                        break;

                    case "CHASSIS":
                        _chassis = _searchText;
                        break;

                    case "ENGINE":
                        _engine = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _rec = (_rec != null) ? (_rec.ToUpper() + "%") : "%";
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _chassis = (_chassis != null) ? (_chassis.ToUpper() + "%") : "%";
            _engine = (_engine != null) ? (_engine.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date.ToUpper() + "%") : "%";

            //(p_regReceipt in NVARCHAR2,p_invoice in NVARCHAR2,p_chassis in NVARCHAR2,p_engine in NVARCHAR2,p_date in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_regReceipt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rec;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_chassis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[3] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[4] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_search_vehical_regTxn", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchMRN_AllLoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _mrn = null;
            string _manual = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MRN NO":
                        _mrn = _searchText;
                        break;

                    case "MANUAL REF.":
                        _manual = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _mrn = (_mrn != null) ? (_mrn.ToUpper() + "%") : null;
            _manual = (_manual != null) ? (_manual.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            // sp_searchmrn(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manual;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchmrn_all_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_All_Roles(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _com = null;
            string _roleID = null;
            string _roleName = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "COMPANY":
                        _com = _searchText;
                        break;

                    case "CODE":
                        _roleID = _searchText;
                        break;

                    case "NAME":
                        _roleName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _roleID = (_roleID != null) ? (_roleID.ToUpper() + "%") : "%";
            _roleName = (_roleName != null) ? (_roleName.ToUpper() + "%") : "%";

            //sp_SearchAllRoles( p_com in NVARCHAR2,p_roleID in NVARCHAR2,p_roleName in NVARCHAR2, c_data OUT SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//_com;
            (param[1] = new OracleParameter("p_roleID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _roleID;
            (param[2] = new OracleParameter("p_roleName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _roleName;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_SearchAllRoles", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_All_SystemUsers(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            // string _com = null;
            string _userID = null;
            string _userName = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "USER ID":
                        _userID = _searchText;
                        break;

                    case "NAME":
                        _userName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _userID = (_userID != null) ? (_userID.ToUpper() + "%") : "%";
            _userName = (_userName != null) ? (_userName.ToUpper() + "%") : "%";

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;//_com;
            (param[1] = new OracleParameter("p_userName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userName;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_Search_systemUser", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_All_SecUsersPerimssionTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            // string _com = null;
            string _code = null;
            string _desc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PERMISSION CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //SP_Get_SecUserPermission( p_code  in NVARCHAR2,p_desc in NVARCHAR2,c_data OUT sys_refcursor )
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;//_com;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.SP_Get_SecUserPermission", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetQuotationByCust(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            //   string _customer = null;
            string _name = null;
            string _ref = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;



                    case "NAME":
                        _name = _searchText;
                        break;

                    case "REFERENCE":
                        _ref = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "%";
            //   _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : "%";

            //sp_search_quotation(p_com in NVARCHAR2,p_profit IN NVARCHAR2,p_date in date,p_quotation in NVARCHAR2, p_customer in NVARCHAR2 ,  p_name in NVARCHAR2,c_data out SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_quot_by_cust", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetQuotationAll(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            string _customer = null;
            string _name = null;
            string _ref = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;

                    case "PARTY CODE":
                        _customer = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "REFERENCE":
                        _ref = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : "%";

            //sp_search_quotation(p_com in NVARCHAR2,p_profit IN NVARCHAR2,p_date in date,p_quotation in NVARCHAR2, p_customer in NVARCHAR2 ,  p_name in NVARCHAR2,c_data out SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[3] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_quotation_all", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Designations(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";

            //(p_cat in NVARCHAR2,p_desc in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_getuser_category", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_Departments(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;
            string _hed_fof_dept = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "HEAD OF DEPARTMENT":
                        _hed_fof_dept = _searchText;
                        break;
                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";
            _hed_fof_dept = (_hed_fof_dept != null) ? (_hed_fof_dept + "%") : "%";

            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_head_of_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hed_fof_dept;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_dept", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 17/6/2013
        public DataTable GetCustomerAll(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address = null;
            string _city = null;
            string _nic = null;
            string _pp = null;
            string _dl = null;
            string _brno = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS":
                        _address = _searchText;
                        break;

                    case "NIC":
                        _address = _searchText;
                        break;

                    case "PASPORT":
                        _address = _searchText;
                        break;

                    case "DRIVING LICENCE":
                        _address = _searchText;
                        break;

                    case "BR NUMBER":
                        _address = _searchText;
                        break;

                    case "CITY":
                        _city = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _address = (_address != null) ? (_address.ToUpper() + "%") : null;
            _city = (_city != null) ? (_city.ToUpper() + "%") : null;
            _nic = (_nic != null) ? (_nic.ToUpper() + "%") : null;
            _pp = (_pp != null) ? (_pp.ToUpper() + "%") : null;
            _dl = (_dl != null) ? (_dl.ToUpper() + "%") : null;
            _brno = (_brno != null) ? (_brno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[2] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            (param[3] = new OracleParameter("p_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;
            (param[4] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[5] = new OracleParameter("p_pp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pp;
            (param[6] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dl;
            (param[7] = new OracleParameter("p_brno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brno;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search.sp_searchcustomerall", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetPrefixData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchprefix", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by DARSHANA on 29/06/2013
        public DataTable GetItemforInvoiceSearchDataByModel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            string _part = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    case "PART#":
                        _part = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _part = (_part != null) ? (_part.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_part", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _part;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchitemforinvoicebyModel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchDataForPromotion(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _promotion = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PROMOTION":
                        _promotion = _searchText.Replace("%", string.Empty);
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _promotion = (_promotion != null) ? (_promotion.ToUpper() + "%") : null;

            //sp_searchpromotion(p_promo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promotion;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_searchpromotion", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchWarrantyExtend(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _invoice = null;
            string _code = null;
            string _name = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";

            //sp_searchpromotion(p_promo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[4] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[6] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2]);
            (param[7] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]);
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_search_warr_item", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_AC_SevCharge_itmes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _itemcd = null;
            string _desc = null;
            string _tpcode = null;
            string _tpdesc = null;
            //string _name = null;

            // mi_cd as "CODE",mi_shortdesc AS "DESCRIPTION",mi_cate_1 AS "TYPE_CODE",SEV_ITM_TP.sit_desc AS "TYPE_DESCRIPTION"
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _itemcd = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "TYPE_DESCRIPTION":
                        _tpdesc = _searchText;
                        //_itemcd = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _itemcd = (_itemcd != null) ? (_itemcd.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : "%";
            _tpdesc = (_tpdesc != null) ? (_tpdesc.ToUpper() + "%") : "%";
            //_name = (_name != null) ? (_name.ToUpper() + "%") : "%";

            //PROCEDURE sp_get_AC_SevCharge_itmes(p_com in NVARCHAR2, p_sevTp in NVARCHAR2,c_data Out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcd;
            (param[2] = new OracleParameter("p_tpDesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tpdesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_get_AC_SevCharge_itmes", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchEliteCommCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _circular = null;
            string _auto = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _circular = _searchText;
                        break;

                    case "NUMBER":
                        _auto = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _circular = (_circular != null) ? (_circular.ToUpper() + "%") : "%";
            _auto = (_auto != null) ? (_auto.ToUpper() + "%") : "%";

            //sp_searchpromotion(p_promo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[2] = new OracleParameter("p_auto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_searchelitecomm_circular", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Search_Approve_Permissions(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _permCd = null;
            string _permDesc = null;
            string _mainTp = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PERMISSION_CODE":
                        _permCd = _searchText;
                        break;

                    case "DESCRIPTION":
                        _permDesc = _searchText;
                        break;

                    case "TYPE":
                        _mainTp = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _permCd = (_permCd != null) ? (_permCd.ToUpper() + "%") : "%";
            _permDesc = (_permDesc != null) ? (_permDesc.ToUpper() + "%") : "%";
            _mainTp = (_mainTp != null) ? (_mainTp.ToUpper() + "%") : "%";

            // sp_SearchApprovePermission (p_permCd in NVARCHAR2,p_permDesc in NVARCHAR2,p_mainTp in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_permCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _permCd;
            (param[1] = new OracleParameter("p_permDesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _permDesc;
            (param[2] = new OracleParameter("p_mainTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainTp;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_SearchApprovePermission", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Search_ApprovePermission_Levels(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _permCd = null;
            string _permDesc = null;
            string _mainTp = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LEVEL_CODE":
                        _permCd = _searchText;
                        break;
                    //case "DESCRIPTION":
                    //    _permDesc = _searchText;
                    //    break;
                    //case "TYPE":
                    //    _permDesc = _searchText;
                    //    break;
                    //default:
                    //    break;
                }
            }
            //Modify parameter values for LIKE search.
            _permCd = (_permCd != null) ? (_permCd.ToUpper() + "%") : "%";

            // sp_SearchApprPermissionLevels (p_permCd in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_permCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_SearchApprPermissionLevels", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Search_PurchaseOrders(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _status = null;
            string _date = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "DOC REF":
                        _refNo = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;

            try
            {
                _status = searchParams[2].ToString();
            }
            catch (Exception ex)
            {
                _status = "%";
            }
            //sp_get_PurchaseOrders (p_com in NVARCHAR2,p_subTp in NVARCHAR2,p_docNo in NVARCHAR2,p_docRef in NVARCHAR2,p_status in NVARCHAR2,p_date in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_docRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search.sp_get_PurchaseOrders", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchPromotinalCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _circular = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _circular = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _circular = (_circular != null) ? (_circular.ToUpper() + "%") : "%";

            //sp_get_PurchaseOrders (p_com in NVARCHAR2,p_subTp in NVARCHAR2,p_docNo in NVARCHAR2,p_docRef in NVARCHAR2,p_status in NVARCHAR2,p_date in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search.sp_searchpromotionalcir", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_employee_sub_categories(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _categoryCD = null;
            string _locationDesc = null;
            string _subcategory = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _categoryCD = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    case "CATEGORY":
                        _subcategory = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _categoryCD = (_categoryCD != null) ? (_categoryCD.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";
            _subcategory = (_subcategory != null) ? (_subcategory.ToUpper() + "%") : "%";
            //p_com in NVARCHAR2,p_empCat in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_empCat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _categoryCD;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            (param[3] = new OracleParameter("p_subCat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subcategory;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search.sp_search_EmpsubCategory", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPritHeirachySearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_prit_hirachy", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetIncSchPersonSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_search_Inc_Sch_Psn_Cat", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetIncSchSaleTypeSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_srch_sch_sale_tp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRCCDefSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search.sp_searchRccDef", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchProdBonusCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _circular = null;
            string _auto = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _circular = _searchText;
                        break;

                    case "NUMBER":
                        _auto = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _circular = (_circular != null) ? (_circular.ToUpper() + "%") : "%";
            _auto = (_auto != null) ? (_auto.ToUpper() + "%") : "%";

            //sp_searchpromotion(p_promo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = searchParams[3].ToString();

            (param[4] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchprod_bonus_circ", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchDataForPromoByComp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _promotion = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PROMOTION":
                        _promotion = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _promotion = (_promotion != null) ? (_promotion.ToUpper() + "%") : null;

            //sp_searchpromotion(p_promo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];

            (param[1] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _promotion;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblpromoSearch", "pkg_search.sp_searchpromotion_by_com", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCircularSearchDataByComp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;

                    case "PROMOTION":
                        _manualRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[2] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            // _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcircular_by_com", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tblInvoiceSearch", "sp_searchcircular_by_comnw", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCat_ItemSearchData(string _type, string _mcat, string _cat, string _brand, string _model, string _item, string _desn)
        {
            DataTable _dtResults = null;

            ////Spliit for Search control type.
            //if (_initialSearchParams.Contains(":"))
            //{
            //    string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
            //    _initialSearchParams = arr[1];
            //}

            ////Spliit for Search SP parameters.
            //string[] seperator = new string[] { "|" };
            //string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //string _code = null;
            //string _description = null;

            ////Set relavant parameters according to the,search catergory.
            //if (!string.IsNullOrEmpty(_searchCatergory))
            //{
            //    switch (_searchCatergory.ToUpper())
            //    {
            //        case "CODE":
            //            _code = _searchText;
            //            break;
            //        case "DESCRIPTION":
            //            _description = _searchText;
            //            break;
            //        default:
            //            break;
            //    }
            //}

            ////Modify parameter values for LIKE search.
            //searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            //searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            //searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2]) : "%";
            //searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            //_code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            //_description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_mcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mcat;
            (param[2] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desn;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_categoryitemsearch", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAdvancedReciept(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT NO":
                        _docNo = _searchText;
                        break;

                    case "RECEIPT REF":
                        _refNo = _searchText;
                        break;

                    case "REF":
                        refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : "%";
            refNo = (refNo != null) ? (refNo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_anal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            (param[3] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchadvancedreciept", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInventoryTrackerSearchData_NEW2(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //Set relavant parameters according to the,search catergory.

            //Modify parameter values for LIKE search.

            if (searchParams[11] == "No_Loc")
            {
                searchParams[0] = !string.IsNullOrEmpty(searchParams[0]) ? (searchParams[0].ToUpper()) : "";
                searchParams[1] = !string.IsNullOrEmpty(searchParams[1]) ? (searchParams[1].ToUpper()) : null;
            }
            else
            {
                searchParams[0] = !string.IsNullOrEmpty(searchParams[0]) ? (searchParams[0].ToUpper() + "%") : "";
                searchParams[1] = !string.IsNullOrEmpty(searchParams[1]) ? (searchParams[1].ToUpper() + "%") : "";
            }

            //updated by akila 2017/12/09
            //searchParams[1] = !string.IsNullOrEmpty(searchParams[1]) ? (searchParams[1].ToUpper() + "%") : "";
            searchParams[2] = !string.IsNullOrEmpty(searchParams[2]) ? (searchParams[2].ToUpper() + "%") : "";
            //  searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = !string.IsNullOrEmpty(searchParams[4]) ? (searchParams[4].ToUpper() + "%") : "";
            searchParams[5] = !string.IsNullOrEmpty(searchParams[5]) ? (searchParams[5].ToUpper() + "%") : "";
            searchParams[6] = !string.IsNullOrEmpty(searchParams[6]) ? (searchParams[6].ToUpper() + "%") : "";
            searchParams[7] = !string.IsNullOrEmpty(searchParams[7]) ? (searchParams[7].ToUpper() + "%") : "";
            searchParams[8] = !string.IsNullOrEmpty(searchParams[8]) ? (searchParams[8].ToUpper() + "%") : "";
            searchParams[9] = !string.IsNullOrEmpty(searchParams[9]) ? (searchParams[9].ToUpper() + "%") : "";
            searchParams[10] = !string.IsNullOrEmpty(searchParams[10]) ? (searchParams[10].ToUpper() + "%") : "";
            searchParams[11] = !string.IsNullOrEmpty(searchParams[11]) ? (searchParams[11]) : "";
            //   searchParams[12] = (searchParams[12] != "" || searchParams[12] != null) ? (searchParams[12].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[12] = !string.IsNullOrEmpty(searchParams[12]) ? (searchParams[12].ToUpper()) : "";
            searchParams[13] = !string.IsNullOrEmpty(searchParams[13]) ? (searchParams[13].ToUpper() + "%") : "";

            searchParams[14] = !string.IsNullOrEmpty(searchParams[14]) ? (searchParams[14].ToUpper() + "%") : "";
            searchParams[16] = !string.IsNullOrEmpty(searchParams[16]) ? (searchParams[16].ToUpper() + "%") : null;
            searchParams[17] = !string.IsNullOrEmpty(searchParams[17]) ? (searchParams[17].ToUpper() + "%") : null;
            //searchParams[18] = !string.IsNullOrEmpty(searchParams[18]) ? (searchParams[18].ToUpper() + "%") : null;

            //Updated by akila 2017/12/05
            string _colorCode = null;
            if (searchParams != null && searchParams.Length > 17)
            {
                if (searchParams[11] == "No_Loc")
                {
                    _colorCode = !string.IsNullOrEmpty(searchParams[18]) ? (searchParams[18].ToUpper()) : null;
                }
                else
                {
                    _colorCode = !string.IsNullOrEmpty(searchParams[18]) ? (searchParams[18].ToUpper()) + '%' : null;
                }

            }

            string _size = null;
            if (searchParams != null && searchParams.Length > 18)
            {
                if (searchParams[11] == "No_Loc")
                {
                    _size = !string.IsNullOrEmpty(searchParams[19]) ? (searchParams[19].ToUpper()) : null;
                }
                else
                {
                    _size = !string.IsNullOrEmpty(searchParams[19]) ? (searchParams[19].ToUpper() + "%") : null;
                }

            }


            //OracleParameter[] param = new OracleParameter[19];
            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("P_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[14];
            (param[3] = new OracleParameter("p_ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[5] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[6] = new OracleParameter("p_sub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[7] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[8] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[7];
            (param[9] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];
            (param[10] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[9];
            (param[11] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[10];
            (param[12] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[11];
            (param[13] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[12];
            (param[14] = new OracleParameter("p_sub1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[13];
            (param[15] = new OracleParameter("p_mi_cate_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[16];
            (param[16] = new OracleParameter("p_mi_cate_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[17];
            (param[17] = new OracleParameter("p_color", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _colorCode;
            (param[18] = new OracleParameter("p_size", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _size;
            //(param[17] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[18];


            param[19] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //need to uncomment before the checkin (parameter 17)
            //Query Data base.
            //_dtResults = QueryDataTable("tblInv", "pkg_search.sp_searchinventoryitem_NEW", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tblInv", "sp_search_inv_item_WInds", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCustomerCodeLoyalty(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _nic = null;
            string _name = null;
            string _address = null;
            string _city = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NIC":
                        _nic = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS":
                        _address = _searchText;
                        break;

                    case "CITY":
                        _city = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _nic = (_nic != null) ? (_nic.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _address = (_address != null) ? (_address.ToUpper() + "%") : "%";
            _city = (_city != null) ? (_city.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[4] = new OracleParameter("p_add", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            (param[5] = new OracleParameter("p_city", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_getloyaltycustomercode", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Darshana on 21/08/2013
        public DataTable GetCustomerCommonByNIC(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address1 = null;
            string _address2 = null;
            string _NIC = null;
            string _Mob = null;
            string _Br = null;
            string _VAT = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS1":
                        _address1 = _searchText;
                        break;

                    case "ADDRESS2":
                        _address2 = _searchText;
                        break;

                    case "NIC":
                        _NIC = _searchText;
                        break;

                    case "MOBILE":
                        _Mob = _searchText;
                        break;

                    case "BR NO":
                        _Br = _searchText;
                        break;

                    case "VAT REG":
                        _VAT = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _address1 = (_address1 != null) ? (_address1.ToUpper() + "%") : null;
            _address2 = (_address2 != null) ? (_address2.ToUpper() + "%") : null;
            _NIC = (_NIC != null) ? (_NIC.ToUpper() + "%") : null;
            _Mob = (_Mob != null) ? (_Mob.ToUpper() + "%") : null;
            _Br = (_Br != null) ? (_Br.ToUpper() + "%") : null;
            _VAT = (_VAT != null) ? (_VAT.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[3] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address1;
            (param[4] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address2;
            (param[5] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NIC;
            (param[6] = new OracleParameter("p_Mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Mob;
            (param[7] = new OracleParameter("p_BRNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Br;
            (param[8] = new OracleParameter("p_Tax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _VAT;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchcustomerCommonByNIC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInventoryTrackeChannel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _dec = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _dec = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _dec = (_dec != null) ? (_dec.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_role", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dec;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "sp_search_inv_channel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetApprovedRequestData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _receiveno = null;
            string _issueno = null;
            string _reqno = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIVE DOC":
                        _receiveno = _searchText;
                        break;

                    case "ISSUE DOC":
                        _issueno = _searchText;
                        break;

                    case "REQUEST NO":
                        _reqno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _receiveno = (_receiveno != null) ? (_receiveno.ToUpper() + "%") : "%";
            _issueno = (_issueno != null) ? (_issueno.ToUpper() + "%") : "%";
            _reqno = (_reqno != null) ? (_reqno.ToUpper() + "%") : "%";

            //sp_searchrequestdata(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_receiveno in NVARCHAR2,p_issueno in NVARCHAR2,p_reqno in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_receiveno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _receiveno;
            (param[3] = new OracleParameter("p_issueno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _issueno;
            (param[4] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblreqdata", "pkg_search.sp_searchrequestdata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInvoiceforExchange(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoice = null; string _do = null; string _serial1 = null; string _serial2 = null; string _warranty = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO": _invoice = _searchText; break;
                    case "DO NO": _do = _searchText; break;
                    case "SERIAL 1": _serial1 = _searchText; break;
                    case "SERIAL 2": _serial2 = _searchText; break;
                    case "WARRANTY NO": _warranty = _searchText; break;
                    default: break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _do = (_do != null) ? (_do.ToUpper() + "%") : "%";
            _serial1 = (_serial1 != null) ? (_serial1.ToUpper() + "%") : "%";
            _serial2 = (_serial2 != null) ? (_serial2.ToUpper() + "%") : "%";
            _warranty = (_warranty != null) ? (_warranty.ToUpper() + "%") : "%";
            //PROCEDURE sp_searchinvoicedata(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_invoiceno in NVARCHAR2,p_deliverno in NVARCHAR2,p_serial1 in NVARCHAR2,p_serial2 in NVARCHAR2,p_warranty in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            (param[2] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_deliverno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _do;
            (param[4] = new OracleParameter("p_serial1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[5] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            (param[6] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblreqivoice", "pkg_search.sp_searchinvoicedata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCashComCircSearchDataByComp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            // string _manualRef = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;
                    //case "PROMOTION":
                    //    _manualRef = _searchText;
                    //    break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //PROCEDURE sp_searchcircular (p_circular in NVARCHAR2,p_promo in NVARCHAR2, c_data out SYS_REFCURSOR);
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            // _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            //  (param[2] = new OracleParameter("p_promo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_cash_com_circ_by_com", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //sachith 2013/10/02
        public DataTable GetInvoiceReversal(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[4] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchinvrev", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by darshana on 26/11/2012
        public DataTable GetHpInvoicesForCancel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _accNo = null;
            string _customerCode = null;
            string _customerName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "ACCOUNT NO":
                        _accNo = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        _customerCode = _searchText;
                        break;

                    case "NAME":
                        _customerName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;
            _customerCode = (_customerCode != null) ? (_customerCode.ToUpper() + "%") : null;
            _customerName = (_customerName != null) ? (_customerName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString()).Date;

            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[5] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCode;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerName;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchhpinvoiceforCancel", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetExchangedReceiveDoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _accNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _invoiceNo = _searchText;
                        break;

                    case "REQUEST NO":
                        _accNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;

            //sp_searchexINdocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[3] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblExchange", "pkg_search.sp_searchexINdocument", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetSupplierClaimDoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _supplier = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _docNo = _searchText;
                        break;

                    case "SUPPLIER":
                        _supplier = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _supplier = (_supplier != null) ? (_supplier.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblExchange", "pkg_search.sp_searchSupplierClaimHeader", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetExchangedIssueDoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoiceNo = null;
            string _accNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _invoiceNo = _searchText;
                        break;

                    case "REQUEST NO":
                        _accNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;

            //sp_searchexOUTdocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[3] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblExchange", "pkg_search.sp_searchexOUTdocument", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetAuditJobNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _job = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "JOB":
                        _job = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _job = (_job != null) ? (_job.ToUpper() + "%") : null;

            //sp_searchexINdocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblExchange", "sp_get_audit_job", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetReverseAccDet(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _accNo = null;
            string _accSeq = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT NO":
                        _accNo = _searchText;
                        break;

                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "ACCOUNT SEQ":
                        _accSeq = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _accNo = (_accNo != null) ? (_accNo.ToUpper() + "%") : null;
            _accSeq = (_accSeq != null) ? (_accSeq.ToUpper() + "%") : null;

            //sp_searchexOUTdocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[4] = new OracleParameter("p_InvNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accSeq;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblExchange", "pkg_search.sp_search_rev_acc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAuditCashVerification(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _sequence = null;
            string _job = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEQUENCE":
                        _sequence = _searchText;
                        break;

                    case "JOB":
                        _job = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _sequence = (_sequence != null) ? (_sequence.ToUpper() + "%") : "%";
            _job = (_job != null) ? (_job.ToUpper() + "%") : "%";

            //sp_searchexOUTdocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sequence;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblExchange", "sp_search_aud_cvr_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAuditStockVerification(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _sequence = null;
            string _job = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEQUENCE":
                        _sequence = _searchText;
                        break;

                    case "JOB":
                        _job = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _sequence = (_sequence != null) ? (_sequence.ToUpper() + "%") : "%";
            _job = (_job != null) ? (_job.ToUpper() + "%") : "%";

            //sp_searchexOUTdocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sequence;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblExchange", "sp_search_aud_stk", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchServiceJob(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _job = null;
            string _invoice = null;
            string _customer = null;
            string _name = null;
            string _item = null;
            string _serial = null;
            string _warranty = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "JOB":
                        _job = _searchText;
                        break;

                    case "INVOICE":
                        _invoice = _searchText;
                        break;

                    case "CUSTOMER":
                        _customer = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "WARRANTY":
                        _warranty = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _job = (_job != null) ? (_job.ToUpper() + "%") : "%";
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _serial = (_serial != null) ? (_serial + "%") : "%";
            _warranty = (_warranty != null) ? (_warranty + "%") : "%";

            //sp_searchservice(p_com in NVARCHAR2,p_jobno in NVARCHAR2,p_inv in NVARCHAR2,p_item in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,p_cuscd in NVARCHAR2 ,p_cusname in NVARCHAR2,c_data out sys_refcursor);
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[6] = new OracleParameter("p_cuscd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_cusname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSerJob", "pkg_search.sp_searchservice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetInventoryItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            _model = (_model != null) ? (_model.ToUpper() + "%") : "%";
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_get_inr_loc_itm", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchGvCategory(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            { string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None); _initialSearchParams = arr[1]; }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _description = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            //sp_searchgvcat (p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblsch", "pkg_search.sp_searchgvcat", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetProvinceData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_province", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetDistrictByProvinceData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_prov", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_district", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetTownByDistrictData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_dist", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_town", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetGradeByComData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_grade", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetHpAccountDateSearchData(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountseq = string.Empty;
            string _accountno = string.Empty;
            string _invoiceno = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT":
                        _accountseq = _searchText;
                        break;

                    case "ACCOUNT NO": //added by shani 19-02-2013
                        _accountno = _searchText;
                        break;

                    case "INVOICE NO"://added by shani 19-02-2013
                        _invoiceno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _accountseq = (_accountseq != null) ? (_accountseq.ToUpper() + "%") : null;
            _accountno = (_accountno != null) ? (_accountno.ToUpper() + "%") : null;
            _invoiceno = (_invoiceno != null) ? (_invoiceno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountseq;
            (param[3] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "pkg_search.sp_search_accDate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPromotionlDiscountHeader(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _sequence = string.Empty;
            string _circular = string.Empty;
            decimal _rate = 0;
            decimal _value = 0;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEQUENCE":
                        _sequence = _searchText;
                        break;

                    case "CIRCULAR":
                        _circular = _searchText;
                        break;

                    case "DISCOUNT RATE":
                        if (_searchText.Length > 1)
                            _searchText = _searchText.Substring(1, _searchText.Length - 1);
                        _rate = Convert.ToDecimal(_searchText);
                        break;

                    case "DISCOUNT VALUE":
                        if (_searchText.Length > 1)
                            _searchText = _searchText.Substring(1, _searchText.Length - 1);
                        _value = Convert.ToDecimal(_searchText);
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _sequence = (_sequence != null) ? (_sequence.ToUpper() + "%") : null;
            _circular = (_circular != null) ? (_circular.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sequence;
            (param[1] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;

            (param[2] = new OracleParameter("p_rate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rate;
            (param[3] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            (param[4] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//Convert.ToDateTime(searchParams[0]);

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "sp_search_pro_dis", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_PC_HIRC_SearchRawData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "";
            //searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "";
            //searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "";
            //searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "";
            //searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "";
            //searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "";
            //searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6]) : "";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[6] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[8] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_PC_hirc_rawsearch", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAccountChecklist(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _pod = string.Empty;
            string _doc = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "POD":
                        _pod = _searchText;
                        break;

                    case "DOC":
                        _doc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _pod = (_pod != null) ? (_pod.ToUpper() + "%") : null;
            _doc = (_doc != null) ? (_doc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_pod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pod;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;

            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_is_dt", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[1]);
            (param[4] = new OracleParameter("p_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];//Convert.ToDateTime(searchParams[0]);
            (param[5] = new OracleParameter("p_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];//Convert.ToDateTime(searchParams[0]);
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];//Convert.ToDateTime(searchParams[0]);

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "sp_search_acc_chk", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPBonusVoucherData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _voucher = null;
            string _pc = null;
            string _accref = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "VOUCHER":
                        _voucher = _searchText;
                        break;

                    case "PC":
                        _pc = _searchText;
                        break;

                    case "ACCREF":
                        _accref = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _voucher = (_voucher != null) ? (_voucher.ToUpper() + "%") : null;
            _pc = (_pc != null) ? (_pc.ToUpper() + "%") : null;
            _accref = (_accref != null) ? (_accref.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_accref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accref;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchpbvoucher", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAccountChecklistPOD(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _pod = string.Empty;
            string _doc = string.Empty;

            //Set relavant parameters according to the,search catergory. Invoice No
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "POD":
                        _pod = _searchText;
                        break;

                    case "DOC":
                        _doc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _pod = (_pod != null) ? (_pod.ToUpper() + "%") : null;
            _doc = (_doc != null) ? (_doc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];

            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pod;
            (param[3] = new OracleParameter("p_pod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceiptType", "sp_search_doc_pod", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Search_inr_ser_Supinfor(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ser1 = null;
            string _ser2 = null;
            string _itemCode = null;
            string _warrNo = null;
            string _docNo = null;
            string _sup = null;

            //Set relevant parameters according to the,search category.

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SUPPLIER": _sup = _searchText; break;
                    case "SERIAL 1": _ser1 = _searchText; break;
                    case "SERIAL 2": _ser2 = _searchText; break;
                    case "ITEM CODE 2": _itemCode = _searchText; break;
                    case "WARRANTY NO": _warrNo = _searchText; break;
                    case "DOC NO": _docNo = _searchText; break;
                    default: break;
                }
            }

            _sup = (_sup != null) ? (_sup + "%") : "%";
            _ser1 = (_ser1 != null) ? (_ser1 + "%") : "%";
            _ser2 = (_ser2 != null) ? (_ser2 + "%") : "%";
            _itemCode = (_itemCode != null) ? (_itemCode.ToUpper() + "%") : "%";
            _warrNo = (_warrNo != null) ? (_warrNo + "%") : "%";
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[9];
            //Initial parameters
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            //Search parameters
            (param[2] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sup;
            (param[3] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser1;
            (param[4] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser2;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[6] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrNo;
            (param[7] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSerials", "pkg_search.sp_searchSupplierFromSer", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetDeductionRefData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchdeduction", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRefundRefData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.sp_searchrefunds", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSearchPBonusCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _circular = null;
            string _auto = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _circular = _searchText;
                        break;

                    case "NUMBER":
                        _auto = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _circular = (_circular != null) ? (_circular.ToUpper() + "%") : "%";
            _auto = (_auto != null) ? (_auto.ToUpper() + "%") : "%";

            //sp_searchpromotion(p_promo in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];

            (param[1] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_searchprod_bonus_circular", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Darshana on 21-02-2014
        public DataTable GetAdvancedRecieptForCus(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RECEIPT NO":
                        _docNo = _searchText;
                        break;

                    case "RECEIPT REF":
                        _refNo = _searchText;
                        break;

                    case "REF":
                        refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : "%";
            refNo = (refNo != null) ? (refNo.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_rec_sb_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_anal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            (param[5] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[6] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search.sp_searchadvansforcus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCategory3(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docNo = _searchText;
                        break;

                    case "DESCRIPTION":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : "%";

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("sp_searchcat3", "sp_searchcat3", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //darshana on 24-05-2014
        public DataTable GetAllInactiveScheme(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchInactScheme", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Darshana on 10-06-2014
        public DataTable GetDisVouTp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docNo = _searchText;
                        break;

                    case "DESCRIPTION":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : "%";

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPromoVou", "pkg_search.sp_searchPromoVou", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Search Promotion Vouchers by circular code
        //GetSchemeComByCircular
        public DataTable GetPromotionVoucherByCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoiceNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CIRCULAR":
                        _invoiceNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cir", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceSearch", "pkg_search.sp_search_promovouhcir", CommandType.StoredProcedure, false, param);
        }

        public DataTable SearchAvlbleSerial4Item(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _Desc = string.Empty;
            string _Model = string.Empty;
            string _Brand = string.Empty;
            string _Serial = string.Empty;
            string _Warranty = string.Empty;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {   //TypeCode
                    case "DESCRIPTION":
                        _Desc = _searchText;
                        break;

                    case "MODEL":
                        _Model = _searchText;
                        break;

                    case "BRAND":
                        _Brand = _searchText;
                        break;

                    case "SERIAL":
                        _Serial = _searchText;
                        break;

                    case "WARRANTY":
                        _Warranty = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //sp_searchavailableitemserial(p_com in NVARCHAR2,p_loc IN NVARCHAR2,p_item in NVARCHAR2,p_description in NVARCHAR2,p_brand in NVARCHAR2,p_model in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,c_data out SYS_REFCURSOR)

            _Desc = (_Desc != string.Empty) ? (_Desc.ToUpper() + "%") : string.Empty;
            _Model = (_Model != string.Empty) ? (_Model.ToUpper() + "%") : string.Empty;
            _Brand = (_Brand != string.Empty) ? (_Brand.ToUpper() + "%") : string.Empty;
            _Serial = (_Serial != string.Empty) ? (_Serial + "%") : string.Empty;
            _Warranty = (_Warranty != string.Empty) ? (_Warranty.ToUpper() + "%") : string.Empty;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desc;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            (param[6] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Warranty;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_avlbleserial4item", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 10-07-2014
        public DataTable GetPromotionVoucherAll(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docNo = _searchText;
                        break;

                    case "DESCRIPTION":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : "%";

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPromoVou", "pkg_search.sp_searchPromoVouAll", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 18-07-2014
        public DataTable GetMasterItemModel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docNo = _searchText;
                        break;

                    case "DESCRIPTION":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : "%";

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMasterItems", "pkg_search.sp_search_Model", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 16-09-2014
        public DataTable GetChequeVouchers(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "VOUCHER":
                        _docNo = _searchText;
                        break;

                    case "NAME":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo + "%") : null;
            _refNo = (_refNo != null) ? (_refNo + "%") : null;

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString(); ;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_chq_vous", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 13-09-2014
        public DataTable GetServiceJobDetails(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string jobNum = null;
            string ItemCode = null;
            string ItemDescroption = null;
            string SearilNum = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "JOB":
                        jobNum = _searchText;
                        break;

                    case "ITEM":
                        ItemCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        ItemDescroption = _searchText;
                        break;

                    case "SERIAL":
                        SearilNum = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            jobNum = (jobNum != null) ? (jobNum + "%") : null;
            ItemCode = (ItemCode != null) ? (ItemCode + "%") : null;
            ItemDescroption = (ItemDescroption != null) ? (ItemDescroption + "%") : null;
            SearilNum = (SearilNum != null) ? (SearilNum + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_JobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNum;
            (param[2] = new OracleParameter("P_ItemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemCode;
            (param[3] = new OracleParameter("P_itemDescrip", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemDescroption;
            (param[4] = new OracleParameter("P_itemSerial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SearilNum;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_Job_Details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 01-10-2014
        public DataTable GetAllEmp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CATEGORY = null;
            string EPF = null;
            string NAME = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CATEGORY":
                        CATEGORY = _searchText;
                        break;

                    case "EPF":
                        EPF = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            CATEGORY = (CATEGORY != null) ? (CATEGORY + "%") : null;
            EPF = (EPF != null) ? (EPF + "%") : null;
            NAME = (NAME != null) ? (NAME + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_CATEGORY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CATEGORY;
            (param[2] = new OracleParameter("P_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EPF;
            (param[3] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[4] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_Get_All_Emp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 01-10-2014
        public DataTable GetDefectTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string cateCode = string.Empty;
            if (searchParams.Length == 4)
            {
                cateCode = searchParams[2].ToString();
            }
            else
            {
                cateCode = string.Empty;
            }

            string CATEGORY = null;
            string TYPE = null;
            string DESCRIPTION = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CATEGORY":
                        CATEGORY = _searchText;
                        break;

                    case "TYPE":
                        TYPE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            CATEGORY = (CATEGORY != null) ? (CATEGORY + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            //(param[2] = new OracleParameter("P_CATEGORY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CATEGORY;
            (param[2] = new OracleParameter("P_CATEGORY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_SDT_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TYPE;
            (param[4] = new OracleParameter("P_DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[5] = new OracleParameter("P_CATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cateCode;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_SEARCH_DEFECT_TYPES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_Utilization_Location(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _loc = null;
            string _des = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LOCATION":
                        _loc = _searchText;
                        break;

                    case "DESCRIPTION":
                        _des = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _loc = (_loc != null) ? (_loc + "%") : null;
            _des = (_des != null) ? (_des + "%") : null;

            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "SP_GET_UTLI_LOC", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 13-10-2014
        public DataTable GetServiceJobs(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string NAME = null;
            string DESCRIPTION = null;
            string ADDRESS1 = null;
            string ADDRESS2 = null;
            string Stage = null;
            string Mobile = null;
            string REQUEST = null;

            string SEARCH_KEY = null;





            string MAINJOB = null;

            Int32 isCustDate = 0;

            if (searchParams[2].ToString() == "")
            {
                Stage = null;
            }
            else
            {
                Stage = searchParams[2].ToString();
            }

            if (searchParams[3].ToString() == "")
            {
                isCustDate = 0;
            }
            else
            {
                isCustDate = Convert.ToInt32(searchParams[3].ToString());
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEARCH KEY":
                        SEARCH_KEY = _searchText;
                        break;
                    case "JOB":
                        JOB = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDRESS1":
                        ADDRESS1 = _searchText;
                        break;

                    case "ADDRESS2":
                        ADDRESS2 = _searchText;
                        break;

                    case "MOBILE":
                        Mobile = _searchText;
                        break;

                    case "REQUEST":
                        REQUEST = _searchText;
                        break;
                    case "MAIN JOB":
                        MAINJOB = _searchText;
                        break;
                    default:
                        break;
                }
            }
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION.ToUpper()) : null;
            ADDRESS1 = (ADDRESS1 != null) ? (ADDRESS1.ToUpper()) : null;
            ADDRESS2 = (ADDRESS2 != null) ? (ADDRESS2.ToUpper()) : null;
            Mobile = (Mobile != null) ? (Mobile.ToUpper()) : null;
            REQUEST = (REQUEST != null) ? (REQUEST.ToUpper()) : null;
            MAINJOB = (MAINJOB != null) ? (MAINJOB.ToUpper()) : null;

            if (_searchText != null && _searchText.Length > 0)
            {
                _fromDate = DateTime.MinValue;
                _toDate = DateTime.MaxValue;
            }

            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[6] = new OracleParameter("P_Stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stage;
            (param[7] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[8] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS1;
            (param[9] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS2;
            (param[10] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mobile;
            (param[11] = new OracleParameter("P_ISCUSTEXPECTDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isCustDate;
            (param[12] = new OracleParameter("P_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            (param[13] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAINJOB;
            (param[14] = new OracleParameter("P_SEARCH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARCH_KEY;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_JOBS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Nadeeka 24-06-2015
        public DataTable GetServiceJobsWarrClaim(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string NAME = null;
            string DESCRIPTION = null;
            string ADDRESS1 = null;
            string ADDRESS2 = null;
            string Stage = null;
            string Mobile = null;
            string REQUEST = null;
            string MAINJOB = null;
            string SEARCH_KEY = null;
            Int32 isCustDate = 0;

            if (searchParams[2].ToString() == "")
            {
                Stage = null;
            }
            else
            {
                Stage = searchParams[2].ToString();
            }

            if (searchParams[3].ToString() == "")
            {
                isCustDate = 0;
            }
            else
            {
                isCustDate = Convert.ToInt32(searchParams[3].ToString());
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEARCH KEY":
                        SEARCH_KEY = _searchText;
                        break;
                    case "JOB":
                        JOB = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDRESS1":
                        ADDRESS1 = _searchText;
                        break;

                    case "ADDRESS2":
                        ADDRESS2 = _searchText;
                        break;

                    case "MOBILE":
                        Mobile = _searchText;
                        break;

                    case "REQUEST":
                        REQUEST = _searchText;
                        break;
                    case "MAIN JOB":
                        MAINJOB = _searchText;
                        break;
                    default:
                        break;
                }
            }
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION.ToUpper() + "%") : null;
            ADDRESS1 = (ADDRESS1 != null) ? (ADDRESS1.ToUpper() + "%") : null;
            ADDRESS2 = (ADDRESS2 != null) ? (ADDRESS2.ToUpper() + "%") : null;
            Mobile = (Mobile != null) ? (Mobile.ToUpper() + "%") : null;
            REQUEST = (REQUEST != null) ? (REQUEST.ToUpper() + "%") : null;
            MAINJOB = (MAINJOB != null) ? (MAINJOB.ToUpper() + "%") : null;

            if (_searchText != null && _searchText.Length > 0)
            {
                _fromDate = DateTime.MinValue;
                _toDate = DateTime.MaxValue;
            }

            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[6] = new OracleParameter("P_Stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stage;
            (param[7] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[8] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS1;
            (param[9] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS2;
            (param[10] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mobile;
            (param[11] = new OracleParameter("P_ISCUSTEXPECTDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isCustDate;
            (param[12] = new OracleParameter("P_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            (param[13] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAINJOB;
            (param[14] = new OracleParameter("P_SEARCH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARCH_KEY;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_JOBS_SUP_WARA", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka on 23-10-2014
        public DataTable Get_Service_Estimates(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _estimate = null;
            string _PC = null;
            string _Job = null;
            string _remark = null;
            string _Status = null;
            string _Desk = null;
            DateTime dt = Convert.ToDateTime("01-Oct-1948");

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ESTIMATE":
                        _estimate = _searchText;
                        break;

                    case "PC":
                        _PC = _searchText;
                        break;

                    case "JOB":
                        _Job = _searchText;
                        break;

                    case "REMARK":
                        _remark = _searchText;
                        break;

                    case "STATUS":
                        _Status = _searchText;
                        break;

                    case "DATE":
                        dt = Convert.ToDateTime(_searchText);
                        break;

                    case "DESCRIPTION":
                        _Desk = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _estimate = (_estimate != null) ? (_estimate + "%") : null;
            _PC = (_PC != null) ? (_PC + "%") : null;
            _Job = (_Job != null) ? (_Job + "%") : null;
            _remark = (_remark != null) ? (_remark + "%") : null;
            _Status = (_Status != null) ? (_Status + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_ESTNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _estimate;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Job;
            (param[4] = new OracleParameter("P_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remark;
            (param[5] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Status;
            (param[6] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = dt;
            (param[7] = new OracleParameter("P_DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desk;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_ESTIMATES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka on 30-10-2014
        public DataTable Get_LOC_SCV_MRN(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CODE = null;
            string DESCRIPTION = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    default:
                        break;
                }
            }

            CODE = (CODE != null) ? (CODE + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            (param[1] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_LOC_SCV_MRN", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_Service_Def_Code(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _type = null;
            string _des = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _type = _searchText;
                        break;

                    case "DESCRIPTION":
                        _des = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.

            _type = (_type != null) ? (_type + "%") : null;
            _des = (_des != null) ? (_des + "%") : null;
            //sp_searchcat3(p_com in NVARCHAR2,p_code in NVARCHAR2,p_desc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "SP_GET_SCV_CODE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchWarranty(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial1 = null;
            string _serial2 = null;
            string _reg = null;
            string _warr = null;
            string _invoice = null;
            string _ITEM = null;
            string _DESCRIPTION = null;
            string _MODEL = null;
            string _CUSTOMER = null;
            string _MOBILE = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "WARRANTY #":
                        _warr = _searchText;
                        break;

                    case "SERIAL #":
                        _serial1 = _searchText;
                        break;

                    case "ENGINE #":
                        _serial1 = _searchText;
                        break;

                    case "CHASSIS #":
                        _serial2 = _searchText;
                        break;

                    case "EMI #":
                        _serial1 = _searchText;
                        break;

                    case "EMI II #":
                        _serial2 = _searchText;
                        break;

                    case "REG #":
                        _reg = _searchText;
                        break;

                    case "REGISTRATION #":
                        _reg = _searchText;
                        break;

                    case "ITEM":
                        _ITEM = _searchText;
                        break;

                    case "DESCRIPTION":
                        _DESCRIPTION = _searchText;
                        break;

                    case "MODEL":
                        _MODEL = _searchText;
                        break;

                    case "CUSTOMER":
                        _CUSTOMER = _searchText;
                        break;

                    case "OTH SERIAL #":
                        _serial2 = _searchText;
                        break;

                    case "MOBILE":
                        _MOBILE = _searchText;
                        break;
                    case "INVOICE NO":
                        _invoice = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial1 = (_serial1 != null) ? (_serial1 + "%") : "%";
            _serial2 = (_serial2 != null) ? (_serial2 + "%") : "%";
            _warr = (_warr != null) ? (_warr + "%") : "%";
            _reg = (_reg != null) ? (_reg + "%") : "%";
            _ITEM = (_ITEM != null) ? (_ITEM + "%") : "%";
            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _DESCRIPTION = (_DESCRIPTION != null) ? (_DESCRIPTION.ToUpper() + "%") : "%";
            _MODEL = (_MODEL != null) ? (_MODEL.ToUpper() + "%") : "%";
            _CUSTOMER = (_CUSTOMER != null) ? (_CUSTOMER.ToUpper() + "%") : "%";
            _MOBILE = (_MOBILE != null) ? (_MOBILE.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_order", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[3] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            (param[4] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warr;
            (param[5] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reg;
            (param[6] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;

            (param[7] = new OracleParameter("P_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DESCRIPTION;
            (param[8] = new OracleParameter("P_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MODEL;
            (param[9] = new OracleParameter("P_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CUSTOMER;
            (param[10] = new OracleParameter("P_ANAL4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ITEM;
            (param[11] = new OracleParameter("P_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MOBILE;

            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.sp_searchwarranty", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-11-25
        public DataTable GET_CHEQUE_BOOKs(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string BOOK = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BOOK":
                        BOOK = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            BOOK = (BOOK != null) ? (BOOK + "%") : "%";

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_BOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BOOK;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_GET_CHEQUE_BOOKs", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-11-26
        public DataTable SERCH_TECHCOMMTBYCHNNL(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CODE = null;
            string DESC = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESC = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            CODE = (CODE != null) ? (CODE + "%") : "%";
            DESC = (DESC != null) ? (DESC + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESC;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SERCH_TECHCOMMTBYCHNNL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-11-28
        public DataTable SEARCH_ESTIMATE_ITEMS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string MODEL = null;
            string ITME = null;
            string DESC = null;
            string BRAND = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MODEL":
                        MODEL = _searchText;
                        break;

                    case "ITEM":
                        ITME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESC = _searchText;
                        break;

                    case "BRAND":
                        BRAND = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            MODEL = (MODEL != null) ? (MODEL + "%") : "%";
            ITME = (ITME != null) ? (ITME + "%") : "%";
            DESC = (DESC != null) ? (DESC + "%") : "%";
            BRAND = (BRAND != null) ? (BRAND + "%") : "%";

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_ESTIMATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MODEL;
            (param[2] = new OracleParameter("P_ITME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ITME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESC;
            (param[4] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BRAND;
            (param[5] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[6] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SEARCH_ESTIMATE_ITEMS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-11-28
        public DataTable SEARCH_CONSUMABLE_ITEMS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string MODEL = null;
            string ITME = null;
            string DESC = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MODEL":
                        MODEL = _searchText;
                        break;

                    case "ITEM":
                        ITME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESC = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            MODEL = (MODEL != null) ? (MODEL + "%") : "%";
            ITME = (ITME != null) ? (ITME + "%") : "%";
            DESC = (DESC != null) ? (DESC + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MODEL;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ITME;
            (param[2] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESC;
            (param[3] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SEARCH_CONSUMABLEITEMS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-12-01
        public DataTable SEARCH_SCV_CONF_REQNO(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string REQUEST = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST":
                        REQUEST = _searchText;
                        break;

                    default:
                        break;
                }
            }

            REQUEST = (REQUEST != null) ? (REQUEST + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3]);
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[2] = new OracleParameter("P_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("P_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SEARCH_SCV_CONF_REQNO", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-12-01
        public DataTable SEARCH_SCV_CONF_JOB(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string REQUEST = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "JOB":
                        REQUEST = _searchText;
                        break;

                    default:
                        break;
                }
            }

            REQUEST = (REQUEST != null) ? (REQUEST + "%") : "%";

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3]);
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[2] = new OracleParameter("P_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SEARCH_SCV_CONF_JOB", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-12-01
        public DataTable SEARCH_SCV_CONF_CUST(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CODE = null;
            string NAME = null;
            string ADD1 = null;
            string ADD2 = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        CODE = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "ADD1":
                        ADD1 = _searchText;
                        break;

                    case "ADD2":
                        ADD2 = _searchText;
                        break;

                    default:
                        break;
                }
            }

            CODE = (CODE != null) ? (CODE + "%") : "%";
            NAME = (NAME != null) ? (NAME + "%") : "%";
            ADD1 = (ADD1 != null) ? (ADD1 + "%") : "%";
            ADD2 = (ADD2 != null) ? (ADD2 + "%") : "%";

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            (param[4] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[5] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADD1;
            (param[6] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADD2;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SEARCH_SCV_CONF_CUST", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka on 2014-12-04
        public DataTable Get_Service_Estimates_ByJob(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _estimate = null;
            string _PC = null;
            string _Job = null;
            string _remark = null;
            string _Status = null;
            string _Desk = null;
            DateTime dt = Convert.ToDateTime("01-Oct-1948");

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ESTIMATE":
                        _estimate = _searchText;
                        break;

                    case "PC":
                        _PC = _searchText;
                        break;

                    case "JOB":
                        _Job = _searchText;
                        break;

                    case "REMARK":
                        _remark = _searchText;
                        break;

                    case "STATUS":
                        _Status = _searchText;
                        break;

                    case "DATE":
                        dt = Convert.ToDateTime(_searchText);
                        break;

                    case "DESCRIPTION":
                        _Desk = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _estimate = (_estimate != null) ? (_estimate + "%") : null;
            _PC = (_PC != null) ? (_PC + "%") : null;
            _Job = (_Job != null) ? (_Job + "%") : null;
            _remark = (_remark != null) ? (_remark + "%") : null;
            _Status = (_Status != null) ? (_Status + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_ESTNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _estimate;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("P_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remark;
            (param[5] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Status;
            (param[6] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = dt;
            (param[7] = new OracleParameter("P_DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Desk;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_Search_ESTIMATE_BYJOB", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Chamal on 09-Dec-2014
        public DataTable GetServiceRequests(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string REQ = null;
            string NAME = null;
            string DATE = null;
            string SERIAL_NO = null;
            string WAR_NO = null;
            string OTH_REF = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQ NO":
                        REQ = _searchText;
                        break;

                    case "CUSTOMER":
                        NAME = _searchText;
                        break;

                    case "SERIAL NO":
                        SERIAL_NO = _searchText;
                        _fromDate = DateTime.MinValue.Date;
                        _toDate = DateTime.MaxValue.Date;
                        break;

                    case "DATE":
                        DATE = _searchText;
                        break;

                    case "WARRANTY NO":
                        WAR_NO = _searchText;
                        _fromDate = DateTime.MinValue.Date;
                        _toDate = DateTime.MaxValue.Date;
                        break;

                    case "OTHER REF":
                        OTH_REF = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            NAME = (NAME != null) ? (NAME + "%") : null;
            REQ = (REQ != null) ? (REQ + "%") : null;
            SERIAL_NO = (SERIAL_NO != null) ? (SERIAL_NO + "%") : null;
            DATE = (DATE != null) ? (DATE + "%") : null;
            OTH_REF = (OTH_REF != null) ? (OTH_REF + "%") : null;

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_REQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQ;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SERIAL_NO;
            (param[4] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[6] = new OracleParameter("P_STAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[7] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[8] = new OracleParameter("P_WAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = WAR_NO;
            param[9] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[10] = new OracleParameter("P_OTH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OTH_REF;

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_REQS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka on 2014-12-18
        public DataTable SearchServiceInvoice(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;
            string _JOB = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    case "JOB": _JOB = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _manualrefno = (_manualrefno != null) ? (_manualrefno.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer + "%") : "%";
            _customername = (_customername != null) ? (_customername + "%") : "%";
            _status = (_status != null) ? (_status + "%") : "%";
            _JOB = (_JOB != null) ? (_JOB + "%") : "%";

            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[8] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JOB;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchInvoice", "pkg_search.sp_searchSCVinvoice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka on 2014-12-22
        public DataTable GetServiceDetailSearials(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            String option = string.Empty;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            if (searchParams[3].ToString() == "SERIAL1")
            {
                option = "SERIAL1";
            }
            else if (searchParams[3].ToString() == "SERIAL2")
            {
                option = "SERIAL2";
            }
            else if (searchParams[3].ToString() == "REGISTRATION")
            {
                option = "REGISTRATION";
            }

            string SEARIAL = null;
            string ITEM = null;
            string WARRANTY = null;
            string STATUS = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        ITEM = _searchText;
                        break;

                    case "WARRANTY":
                        WARRANTY = _searchText;
                        break;

                    case "STATUS":
                        STATUS = _searchText;
                        break;

                    default:
                        SEARIAL = _searchText;
                        break;
                }
            }

            SEARIAL = (SEARIAL != null) ? (SEARIAL + "%") : null;
            ITEM = (ITEM != null) ? (ITEM + "%") : null;
            WARRANTY = (WARRANTY != null) ? (WARRANTY + "%") : null;
            STATUS = (STATUS != null) ? (STATUS + "%") : null;

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("P_SEARIAL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARIAL;
            (param[4] = new OracleParameter("P_ITME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ITEM;
            (param[5] = new OracleParameter("P_WARR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = WARRANTY;
            (param[6] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = STATUS;
            (param[7] = new OracleParameter("P_OPTN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = option;

            (param[8] = new OracleParameter("P_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[5].ToString()).Date;
            (param[9] = new OracleParameter("P_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[6].ToString()).Date;

            param[10] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.sp_get_scv_det_searials", CommandType.StoredProcedure, false, param);

            _dtResults.Columns[0].ColumnName = searchParams[4].ToString();

            return _dtResults;
        }

        public DataTable SearchScvTaskCateByLoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_SearchScvTaskCateByLoc", CommandType.StoredProcedure, false, param);
        }

        public DataTable SearchScvPriority(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "pkg_search.sp_SearchPriority", CommandType.StoredProcedure, false, param);
        }

        public DataTable SearchScvStageChg(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            DataTable _d0 = new DataTable();
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "LOC";
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[3] = new OracleParameter("p_taskloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Convert.ToDecimal(searchParams[4].ToString());
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[5].ToString()).Date;
            (param[6] = new OracleParameter("p_js", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6].ToString();
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[8] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _d0 = QueryDataTable("tblZPC", "pkg_search.sp_SearchScvChg", CommandType.StoredProcedure, false, param);

            DataTable _d1 = new DataTable();
            param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "SCHNL";
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_taskloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Convert.ToDecimal(searchParams[4].ToString());
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[5].ToString()).Date;
            (param[6] = new OracleParameter("p_js", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6].ToString();
            (param[7] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[8] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _d1 = QueryDataTable("tblZPC", "pkg_search.sp_SearchScvChg", CommandType.StoredProcedure, false, param);
            _d0.Merge(_d1);
            return _d0;
        }

        //Tharaka 2015-01-17
        public DataTable GetItemByTypeNew(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;
            string _model = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.SP_GETITMSBYTYPE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka on 26-01-2015
        public DataTable GetServiceJobsWIP(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string NAME = null;
            string DESCRIPTION = null;
            string ADDRESS1 = null;
            string ADDRESS2 = null;
            string Stage = null;
            string Mobile = null;
            string PRORITY = null;
            string MAIN_JOB = null;

            string UserID = null;
            string SEARCH_KEY = null;

            if (searchParams[2].ToString() == "")
            {
                Stage = null;
            }
            else
            {
                Stage = searchParams[2].ToString();
            }

            if (searchParams[3].ToString() == "")
            {
                UserID = ""; ;
            }
            else
            {
                UserID = searchParams[3].ToString();
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEARCH KEY":
                        SEARCH_KEY = _searchText;
                        break;
                    case "JOB":
                        JOB = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDRESS1":
                        ADDRESS1 = _searchText;
                        break;

                    case "ADDRESS2":
                        ADDRESS2 = _searchText;
                        break;

                    case "MOBILE":
                        Mobile = _searchText;
                        break;

                    case "SERVICE LEVEL":
                        PRORITY = _searchText;
                        break;

                    case "MAIN JOB":
                        MAIN_JOB = _searchText;
                        break;

                    default:
                        break;
                }
            }
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION.ToUpper() + "%") : null;
            ADDRESS1 = (ADDRESS1 != null) ? (ADDRESS1.ToUpper() + "%") : null;
            ADDRESS2 = (ADDRESS2 != null) ? (ADDRESS2.ToUpper() + "%") : null;
            Mobile = (Mobile != null) ? (Mobile.ToUpper() + "%") : null;
            PRORITY = (PRORITY != null) ? (PRORITY.ToUpper() + "%") : null;
            MAIN_JOB = (MAIN_JOB != null) ? (MAIN_JOB.ToUpper() + "%") : null;

            if (_searchText != null && _searchText.Length > 0)
            {
                _fromDate = DateTime.MinValue;
                _toDate = DateTime.MaxValue;
            }

            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[6] = new OracleParameter("P_Stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stage;
            (param[7] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[8] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS1;
            (param[9] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS2;
            (param[10] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mobile;
            (param[11] = new OracleParameter("P_USERID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[12] = new OracleParameter("P_PRORITY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRORITY;
            (param[13] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAIN_JOB;
            (param[14] = new OracleParameter("P_SEARCH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARCH_KEY;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_JOBS_WIP_NEW", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-02-07
        public DataTable GetDOInvoiceNumber(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _item = _searchText;
                        break;

                    case "INVOICE":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("P_INVO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.SP_GETDOCINVOICENUM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-02-12
        public DataTable GET_ITEM_COMP(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;
            string _cate1 = null;
            string _cate2 = null;
            string _cate3 = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    case "CATEGORY1":
                        _cate1 = _searchText;
                        break;

                    case "CATEGORY2":
                        _cate2 = _searchText;
                        break;

                    case "CATEGORY3":
                        _cate3 = _searchText;
                        break;
                }
            }

            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;
            _cate1 = (_cate1 != null) ? (_cate1.ToUpper() + "%") : null;
            _cate2 = (_cate2 != null) ? (_cate2.ToUpper() + "%") : null;
            _cate3 = (_cate3 != null) ? (_cate3.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_ITMECODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate1;
            (param[3] = new OracleParameter("P_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate2;
            (param[4] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3;
            (param[5] = new OracleParameter("P_CAT2Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search.SP_GET_ITEM_COMP", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-03-09
        public DataTable SEARCH_FAC_COM(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string COMPANY = null;
            string PC = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "COMPANY":
                        COMPANY = _searchText;
                        break;

                    case "PC":
                        PC = _searchText;
                        break;
                }
            }

            COMPANY = (COMPANY != null) ? (COMPANY.ToUpper() + "%") : null;
            PC = (PC != null) ? (PC.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_FACCOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COMPANY;
            (param[3] = new OracleParameter("P_FACPC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_FAC_COM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-03-09
        public DataTable SEARCH_ENQUIRY(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string COMPANY = null;
            string PC = null;

            string ENQID = null;
            string REF = null;
            string TYPE = null;
            string CUSTCODE = null;
            string NAME = null;
            string ADD1 = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ENQUIRY ID":
                        ENQID = _searchText;
                        break;

                    case "REFFERENCE NUM":
                        REF = _searchText;
                        break;

                    case "TYPE":
                        TYPE = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        CUSTCODE = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "ADDRESS":
                        ADD1 = _searchText;
                        break;
                }
            }

            ENQID = (ENQID != null) ? (ENQID + "%") : null;
            REF = (REF != null) ? (REF + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            CUSTCODE = (CUSTCODE != null) ? (CUSTCODE + "%") : null;
            NAME = (NAME != null) ? (NAME + "%") : null;
            ADD1 = (ADD1 != null) ? (ADD1 + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_ENQID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ENQID;
            (param[3] = new OracleParameter("P_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REF;
            (param[4] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TYPE;
            (param[5] = new OracleParameter("P_CUSTCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CUSTCODE;
            (param[6] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[7] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADD1;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_ENQUIRY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SEARCH_SCV_CONF_BY_JOB(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string REQUEST = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CONF":
                        REQUEST = _searchText;
                        break;

                    default:
                        break;
                }
            }

            REQUEST = (REQUEST != null) ? (REQUEST + "%") : "%";

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3]);
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[2] = new OracleParameter("P_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("P_CONF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblschemes", "pkg_search.SP_SEARCH_SCV_CONF_BY_JOB", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-03-26
        public DataTable SEARCH_Invoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string INVOICE_NO = null;
            string ENQUIRY_NO = null;
            string CUSTOMER_CODE = null;
            string NAME = null;
            string STATUS = null;
            DateTime DATE = Convert.ToDateTime("03-09-1999");
            Int32 idDateSearch = 0;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        INVOICE_NO = _searchText;
                        break;

                    case "ENQUIRY NO":
                        ENQUIRY_NO = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        CUSTOMER_CODE = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "STATUS":
                        STATUS = _searchText;
                        break;

                    case "DATE":
                        bool asdasd = DateTime.TryParse(_searchText, out DATE);
                        if (asdasd)
                        {
                            idDateSearch = 1;
                        }
                        break;
                }
            }

            INVOICE_NO = (INVOICE_NO != null) ? (INVOICE_NO.ToUpper() + "%") : null;
            ENQUIRY_NO = (ENQUIRY_NO != null) ? (ENQUIRY_NO.ToUpper() + "%") : null;
            CUSTOMER_CODE = (CUSTOMER_CODE != null) ? (CUSTOMER_CODE.ToUpper() + "%") : null;
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            STATUS = (STATUS != null) ? (STATUS.ToUpper() + "%") : null;
            DATE = (DATE != Convert.ToDateTime("03-09-1999")) ? (DATE) : Convert.ToDateTime("03-09-1999");

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_INVOICENO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = INVOICE_NO;
            (param[3] = new OracleParameter("P_ENQUIRYID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ENQUIRY_NO;
            (param[4] = new OracleParameter("P_CUSTOMERCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CUSTOMER_CODE;
            (param[5] = new OracleParameter("P_CUSTOMERNAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[6] = new OracleParameter("P_STATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = STATUS;
            (param[7] = new OracleParameter("P_IFDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = idDateSearch;
            (param[8] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DATE;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_INVOICE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-03-31
        public DataTable SEARCH_ChargeCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CODE = null;
            string DESCRIPTION = null;
            string ADDITIONAL = null;
            string FROM = null;
            string TO = null;
            decimal? RATE = null;
            DateTime DATE = Convert.ToDateTime("03-09-1999");
            Int32 idDateSearch = 0;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDITIONAL":
                        ADDITIONAL = _searchText;
                        break;

                    case "FROM":
                        FROM = _searchText;
                        break;

                    case "TO":
                        TO = _searchText;
                        break;

                    case "DATE":
                        bool bool1 = DateTime.TryParse(_searchText, out DATE);
                        if (bool1)
                        {
                            idDateSearch = 1;
                        }
                        break;

                    case "RATE":
                        RATE = Convert.ToDecimal(_searchText);
                        break;

                }
            }

            CODE = (CODE != null) ? (CODE + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION + "%") : null;
            ADDITIONAL = (ADDITIONAL != null) ? (ADDITIONAL + "%") : null;
            FROM = (FROM != null) ? (FROM + "%") : null;
            TO = (TO != null) ? (TO + "%") : null;
            RATE = (RATE != null) ? RATE : null;
            DATE = (DATE != Convert.ToDateTime("03-09-1999")) ? (DATE) : Convert.ToDateTime("03-09-1999");

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("P_ADDI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDITIONAL;
            (param[5] = new OracleParameter("P_FROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FROM;
            (param[6] = new OracleParameter("P_TO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TO;
            (param[7] = new OracleParameter("P_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = RATE;
            (param[8] = new OracleParameter("P_IFDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = idDateSearch;
            (param[9] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DATE;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_ChargeCOde", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-04-01
        public DataTable SEARCH_TransferCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CODE = null;
            string DESCRIPTION = null;
            string FROM_DATE = null;
            string TO_DATE = null;
            string FROM = null;
            string TO = null;
            string CLASS = null;
            string VEHICLE = null;
            decimal? RATE = null;
            DateTime DATE = Convert.ToDateTime("03-09-1999");
            Int32 idDateSearch = 0;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "FROM":
                        FROM_DATE = _searchText;
                        break;

                    case "TO":
                        TO = _searchText;
                        break;

                    case "CLASS":
                        CLASS = _searchText;
                        break;

                    case "VEHICLE":
                        VEHICLE = _searchText;
                        break;

                    case "DATE":
                        bool bool1 = DateTime.TryParse(_searchText, out DATE);
                        if (bool1)
                        {
                            idDateSearch = 1;
                        }
                        break;

                    case "RATE":
                        if (!string.IsNullOrEmpty(_searchText))
                        {
                            RATE = Convert.ToDecimal(_searchText);
                        }
                        break;
                }
            }

            CODE = (CODE != null) ? (CODE + "%") : null;
            VEHICLE = (VEHICLE != null) ? (VEHICLE + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION + "%") : null;
            CLASS = (CLASS != null) ? (CLASS + "%") : null;
            FROM = (FROM != null) ? (FROM + "%") : null;
            TO = (TO != null) ? (TO + "%") : null;
            RATE = (RATE != null) ? RATE : null;
            DATE = (DATE != Convert.ToDateTime("03-09-1999")) ? (DATE) : Convert.ToDateTime("03-09-1999");

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("P_FROM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FROM;
            (param[5] = new OracleParameter("P_TO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TO;
            (param[6] = new OracleParameter("P_CLSS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CLASS;
            (param[7] = new OracleParameter("P_VEHICLE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = VEHICLE;
            (param[8] = new OracleParameter("P_IFDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = idDateSearch;
            (param[9] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DATE;
            (param[10] = new OracleParameter("P_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = RATE;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_TRASFCODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-04-01
        public DataTable SEARCH_Miscellaneous(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CODE = null;
            string DESCRIPTION = null;
            string FROM_DATE = null;
            string TO_DATE = null;
            string FROM = null;
            string TO = null;
            string CLASS = null;
            string VEHICLE = null;
            decimal? RATE = null;
            DateTime DATE = Convert.ToDateTime("03-09-1999");
            Int32 idDateSearch = 0;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "DATE":
                        bool bool1 = DateTime.TryParse(_searchText, out DATE);
                        if (bool1)
                        {
                            idDateSearch = 1;
                        }
                        break;

                    case "RATE":
                        if (!string.IsNullOrEmpty(_searchText))
                        {
                            RATE = Convert.ToDecimal(_searchText);
                        }
                        break;
                }
            }

            CODE = (CODE != null) ? (CODE + "%") : null;
            VEHICLE = (VEHICLE != null) ? (VEHICLE + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION + "%") : null;
            CLASS = (CLASS != null) ? (CLASS + "%") : null;
            FROM = (FROM != null) ? (FROM + "%") : null;
            TO = (TO != null) ? (TO + "%") : null;
            RATE = (RATE != null) ? RATE : null;
            DATE = (DATE != Convert.ToDateTime("03-09-1999")) ? (DATE) : Convert.ToDateTime("03-09-1999");

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("P_IFDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = idDateSearch;
            (param[5] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DATE;
            (param[6] = new OracleParameter("P_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = RATE;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_Miscellaneous", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka on 2015-06-04
        public DataTable GetServiceJobsEnqeuiy(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string NAME = null;
            string DESCRIPTION = null;
            string ADDRESS1 = null;
            string ADDRESS2 = null;
            string Stage = null;
            string Mobile = null;
            string REQUEST = null;
            string MAIN_JOB = null;
            string REG_NO = null;
            string SEARCH_KEY = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEARCH KEY":
                        SEARCH_KEY = _searchText;
                        break;
                    case "JOB":
                        JOB = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDRESS1":
                        ADDRESS1 = _searchText;
                        break;

                    case "ADDRESS2":
                        ADDRESS2 = _searchText;
                        break;

                    case "MOBILE":
                        Mobile = _searchText;
                        break;

                    case "REQUEST":
                        REQUEST = _searchText;
                        break;
                    case "MAIN JOB":
                        MAIN_JOB = _searchText;
                        break;
                    case "REG NO":
                        REG_NO = _searchText;
                        break;
                    default:
                        break;
                }
            }
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION.ToUpper() + "%") : null;
            ADDRESS1 = (ADDRESS1 != null) ? (ADDRESS1.ToUpper() + "%") : null;
            ADDRESS2 = (ADDRESS2 != null) ? (ADDRESS2.ToUpper() + "%") : null;
            Mobile = (Mobile != null) ? (Mobile.ToUpper() + "%") : null;
            REQUEST = (REQUEST != null) ? (REQUEST.ToUpper() + "%") : null;
            MAIN_JOB = (MAIN_JOB != null) ? (MAIN_JOB.ToUpper() + "%") : null;
            REG_NO = (REG_NO != null) ? (REG_NO.ToUpper() + "%") : null;

            if (_searchText != null && _searchText.Length > 0)
            {
                _fromDate = DateTime.MinValue;
                _toDate = DateTime.MaxValue;
            }

            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[4] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[5] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[6] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS1;
            (param[7] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS2;
            (param[8] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mobile;
            (param[9] = new OracleParameter("P_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            (param[10] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAIN_JOB;
            (param[11] = new OracleParameter("P_REGNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REG_NO;
            (param[12] = new OracleParameter("P_SEARCH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARCH_KEY;
            param[13] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_search.SP_SEARCH_JOB_ENQUIRY_NEW", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-06-06
        public DataTable SearchDrivers(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string EPF = null;
            string FNAME = null;
            string LNAME = null;
            string MOBILE = null;
            string NIC = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF":
                        EPF = _searchText;
                        break;
                    case "FIRST NAME":
                        FNAME = _searchText;
                        break;
                    case "LAST NAME":
                        LNAME = _searchText;
                        break;
                    case "MOBILE":
                        MOBILE = _searchText;
                        break;
                    case "NIC":
                        NIC = _searchText;
                        break;
                }
            }

            EPF = (EPF != null) ? (EPF + "%") : null;
            FNAME = (FNAME != null) ? (FNAME + "%") : null;
            LNAME = (LNAME != null) ? (LNAME + "%") : null;
            MOBILE = (MOBILE != null) ? (MOBILE + "%") : null;
            NIC = (NIC != null) ? (NIC + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EPF;
            (param[3] = new OracleParameter("P_FNAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = FNAME;
            (param[4] = new OracleParameter("P_LNAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = LNAME;
            (param[5] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MOBILE;
            (param[6] = new OracleParameter("P_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NIC;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_Drivers", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-06-06
        public DataTable SearchVehicle(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string REG = null;
            string bRAND = null;
            string MODEL = null;
            string TYPE = null;
            string OWNER = null;
            string CONTACT = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "NUMBER":
                        REG = _searchText;
                        break;
                    case "BRAND":
                        bRAND = _searchText;
                        break;
                    case "MODEL":
                        MODEL = _searchText;
                        break;
                    case "TYPE":
                        TYPE = _searchText;
                        break;
                    case "OWNER":
                        OWNER = _searchText;
                        break;
                    case "CONTACT NO":
                        CONTACT = _searchText;
                        break;
                }
            }

            REG = (REG != null) ? (REG + "%") : null;
            bRAND = (bRAND != null) ? (bRAND + "%") : null;
            MODEL = (MODEL != null) ? (MODEL + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            OWNER = (OWNER != null) ? (OWNER + "%") : null;
            CONTACT = (CONTACT != null) ? (CONTACT + "%") : null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_REG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REG;
            (param[3] = new OracleParameter("P_bRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bRAND;
            (param[4] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MODEL;
            (param[5] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TYPE;
            (param[6] = new OracleParameter("P_OWNER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OWNER;
            (param[7] = new OracleParameter("P_CONTACT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CONTACT;
            (param[8] = new OracleParameter("P_VEHITYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_Vehicle", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //PEMIL 2015-06-08
        public DataTable SearchDriverTBS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string com_cd = null;
            string epf = null;
            string cat_subcd = null;
            string first_name = null;
            string last_name = null;
            string nic = null;
            string tou_lic = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        com_cd = _searchText;
                        break;

                    case "EPF NO":
                        epf = _searchText;
                        break;

                    case "CATEGORY":
                        cat_subcd = _searchText;
                        break;

                    case "FIRST NAME":
                        first_name = _searchText;
                        break;

                    case "LAST NAME":
                        last_name = _searchText;
                        break;

                    case "NIC":
                        nic = _searchText;
                        break;

                    case "LICENSE NO":
                        tou_lic = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            com_cd = (com_cd != null) ? (com_cd.ToUpper() + "%") : null;
            epf = (epf != null) ? (epf.ToUpper() + "%") : null;
            cat_subcd = (cat_subcd != null) ? (cat_subcd.ToUpper() + "%") : null;
            first_name = (first_name != null) ? (first_name.ToUpper() + "%") : null;
            last_name = (last_name != null) ? (last_name.ToUpper() + "%") : null;
            last_name = (last_name != null) ? (last_name.ToUpper() + "%") : null;
            nic = (nic != null) ? (nic.ToUpper() + "%") : null;
            tou_lic = (tou_lic != null) ? (tou_lic.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = epf;
            (param[2] = new OracleParameter("CAT_SUBCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat_subcd;
            (param[3] = new OracleParameter("FIRST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = first_name;
            (param[4] = new OracleParameter("LAST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = last_name;
            (param[5] = new OracleParameter("NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[6] = new OracleParameter("TOU_LIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tou_lic;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("SEARCH_Vehicle", "pkg_search.SP_SearchDriverTBS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //PEMIL 2015-06-09
        public DataTable SearchEmployeeTBS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string com_cd = null;
            string epf = null;
            string cat_subcd = null;
            string first_name = null;
            string last_name = null;
            string nic = null;
            string tou_lic = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        com_cd = _searchText;
                        break;

                    case "EPF NO":
                        epf = _searchText;
                        break;

                    case "CATEGORY":
                        cat_subcd = _searchText;
                        break;

                    case "FIRST NAME":
                        first_name = _searchText;
                        break;

                    case "LAST NAME":
                        last_name = _searchText;
                        break;

                    case "NIC":
                        nic = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            com_cd = (com_cd != null) ? (com_cd.ToUpper() + "%") : null;
            epf = (epf != null) ? (epf.ToUpper() + "%") : null;
            cat_subcd = (cat_subcd != null) ? (cat_subcd.ToUpper() + "%") : null;
            first_name = (first_name != null) ? (first_name.ToUpper() + "%") : null;
            last_name = (last_name != null) ? (last_name.ToUpper() + "%") : null;
            last_name = (last_name != null) ? (last_name.ToUpper() + "%") : null;
            nic = (nic != null) ? (nic.ToUpper() + "%") : null;
            tou_lic = (tou_lic != null) ? (tou_lic.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = epf;
            (param[2] = new OracleParameter("CAT_SUBCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat_subcd;
            (param[3] = new OracleParameter("FIRST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = first_name;
            (param[4] = new OracleParameter("LAST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = last_name;
            (param[5] = new OracleParameter("NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("SearchEmployeeTBS", "pkg_search.SP_SearchEmployeeTBS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka 2015-06-10
        public DataTable SearchEnquiryWithStage(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string COMPANY = null;
            string PC = null;

            string ENQID = null;
            string REF = null;
            string TYPE = null;
            string CUSTCODE = null;
            string NAME = null;
            string ADD1 = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ENQUIRY ID":
                        ENQID = _searchText;
                        break;

                    case "REFFERENCE NUM":
                        REF = _searchText;
                        break;

                    case "TYPE":
                        TYPE = _searchText;
                        break;

                    case "CUSTOMER CODE":
                        CUSTCODE = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "ADDRESS":
                        ADD1 = _searchText;
                        break;
                }
            }

            ENQID = (ENQID != null) ? (ENQID + "%") : null;
            REF = (REF != null) ? (REF + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            CUSTCODE = (CUSTCODE != null) ? (CUSTCODE + "%") : null;
            NAME = (NAME != null) ? (NAME + "%") : null;
            ADD1 = (ADD1 != null) ? (ADD1 + "%") : null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_ENQID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ENQID;
            (param[3] = new OracleParameter("P_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REF;
            (param[4] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[5] = new OracleParameter("P_CUSTCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CUSTCODE;
            (param[6] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[7] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADD1;
            (param[8] = new OracleParameter("P_STAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[9] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_ENQUIRYWITHSTAGE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-06-13
        public DataTable SearchLogHeader(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string LOG_NUMBER = null;
            string ENQUIRY = null;
            string CUSTOMER = null;
            string DRIVER = null;
            string VEHICLE = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LOG NUMBER":
                        LOG_NUMBER = _searchText;
                        break;

                    case "ENQUIRY":
                        ENQUIRY = _searchText;
                        break;

                    case "CUSTOMER":
                        CUSTOMER = _searchText;
                        break;

                    case "DRIVER":
                        DRIVER = _searchText;
                        break;

                    case "VEHICLE":
                        VEHICLE = _searchText;
                        break;
                }
            }

            LOG_NUMBER = (LOG_NUMBER != null) ? (LOG_NUMBER + "%") : null;
            ENQUIRY = (ENQUIRY != null) ? (ENQUIRY + "%") : null;
            CUSTOMER = (CUSTOMER != null) ? (CUSTOMER + "%") : null;
            DRIVER = (DRIVER != null) ? (DRIVER + "%") : null;
            VEHICLE = (VEHICLE != null) ? (VEHICLE + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_LOG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = LOG_NUMBER;
            (param[3] = new OracleParameter("P_ENQUIRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ENQUIRY;
            (param[4] = new OracleParameter("P_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CUSTOMER;
            (param[5] = new OracleParameter("P_DRIVER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DRIVER;
            (param[6] = new OracleParameter("P_FLEET", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = VEHICLE;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "PKG_TOURS_SEARCH.SP_SEARCH_LOGHEADER", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #region Transaction -Imports
        //Rukshan 2015-06-24
        public DataTable Get_All_PINo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            // string _com = null;
            string _PINO = null;
            string _REFNO = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PINO":
                        _PINO = _searchText;

                        break;

                    case "REFERENCES NO":
                        _REFNO = _searchText;

                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _PINO = (_PINO != null) ? (_PINO.ToUpper() + "%") : "%";
            _REFNO = (_REFNO != null) ? (_REFNO.ToUpper() + "%") : "%";

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("ip_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PINO;//_com;
            (param[1] = new OracleParameter("ip_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _REFNO;
            (param[2] = new OracleParameter("IP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "ems.pkg_search_imp.sp_Search_PiNo", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //PEMIL 2015-09-23
        public DataTable SEARCH_PINO_PI(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            // string _com = null;
            string _PINO = null;
            string _REFNO = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PI NO":
                        _PINO = _searchText;

                        break;

                    case "REFERENCES NO":
                        _REFNO = _searchText;

                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _PINO = (_PINO != null) ? (_PINO.ToUpper() + "%") : "%";
            _REFNO = (_REFNO != null) ? (_REFNO.ToUpper() + "%") : "%";

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("ip_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PINO;//_com;
            (param[1] = new OracleParameter("ip_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _REFNO;
            (param[2] = new OracleParameter("IP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "ems.pkg_search_imp.SP_SEARCH_PINO_PI", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPaymentSubTerm(string _PCAD, string _PCD)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_CAD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCAD;
            (param[1] = new OracleParameter("P_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PCD;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblPaySearch", "pkg_search_imp.SP_Search_Payment_SubTerm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan
        public DataTable GetBankAccountFacility(string _initialSearchParams, string _SearchText)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_Acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SearchText;
            (param[3] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblBankAccountSearch", "pkg_search_imp.SP_Search_AccountByID", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable SearchBusEntity(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string name = null;
            string nic = null;
            string mob = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;
                    case "NAME":
                        name = _searchText;
                        break;
                    case "NIC":
                        nic = _searchText;
                        break;
                    case "MOBILE":
                        mob = _searchText;
                        break;
                }
            }

            code = (code != null) ? (code + "%") : null;
            name = (name != null) ? (name + "%") : null;
            nic = (nic != null) ? (nic + "%") : null;
            mob = (mob != null) ? (mob + "%") : null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[4] = new OracleParameter("NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
            (param[5] = new OracleParameter("NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[6] = new OracleParameter("mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mob;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_busentity", "pkg_search_imp.SP_SEARCHBUSENTITY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchTraderTerms(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string MCAT_CD = null;
            string MCAT_DESC = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        MCAT_CD = _searchText;
                        break;
                    case "DESCRIPTION":
                        MCAT_DESC = _searchText;
                        break;
                }
            }

            MCAT_CD = (MCAT_CD != null) ? (MCAT_CD + "%") : null;
            MCAT_DESC = (MCAT_DESC != null) ? (MCAT_DESC + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MCAT_CD;
            (param[2] = new OracleParameter("P_DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MCAT_DESC;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_cost_tp", "pkg_search_imp.SP_SEARCH_TRADE_TERMS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchOrderPlanNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string opno = null;
            string refno = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ORDERPLAN NO":
                        opno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            opno = (opno != null) ? (opno.ToUpper() + "%") : "%";
            refno = (refno != null) ? (refno.ToUpper() + "%") : "%";

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//_com;
            (param[1] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opno;
            (param[2] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("IMP_OP_HDR", "pkg_search_imp.SP_Search_OrderPlanNo", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchBank(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//tp;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("MST_BUSCOM", "pkg_search_imp.SP_Search_Bank", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Rukshan
        public DataTable SearchCostType(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("PT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//tp;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("MST_COST_ELE", "pkg_search_imp.SP_CostType", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchCompanyCurrancy(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//tp;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("MST_COST_ELE", "pkg_search_imp.SP_SearchCompanyCurrency", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchModel(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm_model", "pkg_search_imp.SP_Search_MODEL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string description = null;
            string model = null;
            string brand = null;
            string partno = null;
            string itemtype = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;
                    case "DESCRIPTION":
                        description = _searchText;
                        break;
                    case "MODEL":
                        model = _searchText;
                        break;
                    case "BRAND":
                        brand = _searchText;
                        break;
                    case "PARTNO":
                        partno = _searchText;
                        break;
                    case "ITEMTYPE":
                        itemtype = _searchText;
                        break;
                }
            }

            code = (code != null) ? (code + "%") : null;
            description = (description != null) ? (description + "%") : null;
            model = (model != null) ? (model + "%") : null;
            brand = (brand != null) ? (brand + "%") : null;
            partno = (partno != null) ? (partno + "%") : null;
            itemtype = (itemtype != null) ? (itemtype + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[1] = new OracleParameter("DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = description;
            (param[2] = new OracleParameter("MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            (param[3] = new OracleParameter("BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[4] = new OracleParameter("PARTNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partno;
            (param[5] = new OracleParameter("ITEMTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemtype;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("MST_ITM", "pkg_search_imp.SP_Search_ITEM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-07-04
        public DataTable SEARCH_FIN_HDR(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string IF_DOC_NO = null;
            string IF_SBU = null;
            string IF_TP = null;
            string IF_SUB_TP = null;
            string IF_REF_NO = null;
            string IF_FILE_NO = null;
            string IF_OTHDOC_NO = null;
            string IF_SUPP = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        IF_DOC_NO = _searchText;
                        break;
                    case "SBU":
                        IF_SBU = _searchText;
                        break;
                    case "TYPE":
                        IF_TP = _searchText;
                        break;
                    case "SUB TYPE":
                        IF_SUB_TP = _searchText;
                        break;
                    case "REFERENCE":
                        IF_REF_NO = _searchText;
                        break;
                    case "FILE NO":
                        IF_FILE_NO = _searchText;
                        break;
                    case "OTHER DOC":
                        IF_OTHDOC_NO = _searchText;
                        break;
                    case "SUPPLIER":
                        IF_SUPP = _searchText;
                        break;
                    default:
                        break;
                }
            }

            IF_DOC_NO = (IF_DOC_NO != null) ? (IF_DOC_NO.ToUpper() + "%") : "%";
            IF_SBU = (IF_SBU != null) ? (IF_SBU.ToUpper() + "%") : "%";
            IF_TP = (IF_TP != null) ? (IF_TP.ToUpper() + "%") : "%";
            IF_SUB_TP = (IF_SUB_TP != null) ? (IF_SUB_TP.ToUpper() + "%") : "%";
            IF_REF_NO = (IF_REF_NO != null) ? (IF_REF_NO.ToUpper() + "%") : "%";
            IF_FILE_NO = (IF_FILE_NO != null) ? (IF_FILE_NO.ToUpper() + "%") : "%";
            IF_OTHDOC_NO = (IF_OTHDOC_NO != null) ? (IF_OTHDOC_NO.ToUpper() + "%") : "%";
            IF_SUPP = (IF_SUPP != null) ? (IF_SUPP.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_IF_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_DOC_NO;
            (param[2] = new OracleParameter("P_IF_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_SBU;
            (param[3] = new OracleParameter("P_IF_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_TP;
            (param[4] = new OracleParameter("P_IF_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_SUB_TP;
            (param[5] = new OracleParameter("P_IF_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_REF_NO;
            (param[6] = new OracleParameter("P_IF_FILE_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_FILE_NO;
            (param[7] = new OracleParameter("P_IF_OTHDOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_OTHDOC_NO;
            (param[8] = new OracleParameter("P_IF_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IF_SUPP;
            (param[9] = new OracleParameter("P_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[10] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("IMP_OP_HDR", "pkg_search_imp.SP_SEARCH_FIN_HDR", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan 2015-07-04
        public DataTable SEARCH_FIN_ByID(string _initialSearchParams, string _docno)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_Value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_IF_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("IMP_OP_HDR", "pkg_search_imp.SP_SEARCH_ALLFIN_BYDOC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable SP_Search_Order(string P_ORDERPLAN_NO)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ORDERPLAN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = P_ORDERPLAN_NO;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_op_hdr", "pkg_search_imp.SP_Search_Order", CommandType.StoredProcedure, false, param);
        }

        public DataTable SP_Search_OP_Itms(string P_ORDERPLAN_NO)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ORDERPLAN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = P_ORDERPLAN_NO;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_op_itm", "pkg_search_imp.SP_Search_OP_Itms", CommandType.StoredProcedure, false, param);
        }

        public DataTable SearchFacilityLimit(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblFacility", "pkg_search_imp.SP_Search_FacilityLimit", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka 2015-07-09
        public DataTable GetAgents(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_MBE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblsupplier", "pkg_search_imp.SP_SEARCHAGENT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-07-13
        public DataTable SearchBLHeader(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            string BL = null;
            string Reff = null;
            string Remark = null;
            string date = null;
            string status = null;
            Int32 isDate = 0;
            DateTime DtDate = DateTime.Now.Date;
            string Def_status = string.Empty;
            if (searchParams.Length == 4)
            {
                Def_status = searchParams[2];
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC":
                        doc = _searchText;
                        break;

                    case "BL":
                        BL = _searchText;
                        break;
                    case "DATE":
                        date = _searchText;
                        bool asdasd = DateTime.TryParse(_searchText, out DtDate);
                        isDate = 1;
                        break;
                    case "REFERENCE":
                        Reff = _searchText;
                        break;
                    case "REMARK":
                        Remark = _searchText;
                        break;
                    case "STATUS":
                        status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;
            BL = (BL != null) ? (BL.ToUpper() + "%") : null;
            Reff = (Reff != null) ? (Reff.ToUpper() + "%") : null;
            Remark = (Remark != null) ? (Remark.ToUpper() + "%") : null;
            status = (status != null) ? (status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_ISCUSDEC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[4] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            (param[5] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DtDate;
            (param[6] = new OracleParameter("P_REFF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Reff;
            (param[7] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remark;
            (param[8] = new OracleParameter("P_ISDate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            (param[9] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[10] = new OracleParameter("P_DEF_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Def_status;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblsupplier", "pkg_search_imp.SP_SEACH_BL_HEAD", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchBLHeaderWithSeq(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            string BL = null;
            string Reff = null;
            string Remark = null;
            string date = null;
            string status = null;
            Int32 isDate = 0;
            DateTime DtDate = DateTime.Now.Date;
            string Def_status = string.Empty;
            if (searchParams.Length == 4)
            {
                Def_status = searchParams[2];
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC":
                        doc = _searchText;
                        break;

                    case "BL":
                        BL = _searchText;
                        break;
                    case "DATE":
                        date = _searchText;
                        bool asdasd = DateTime.TryParse(_searchText, out DtDate);
                        isDate = 1;
                        break;
                    case "REFERENCE":
                        Reff = _searchText;
                        break;
                    case "REMARK":
                        Remark = _searchText;
                        break;
                    case "STATUS":
                        status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;
            BL = (BL != null) ? (BL.ToUpper() + "%") : null;
            Reff = (Reff != null) ? (Reff.ToUpper() + "%") : null;
            Remark = (Remark != null) ? (Remark.ToUpper() + "%") : null;
            status = (status != null) ? (status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_ISCUSDEC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[4] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            (param[5] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DtDate;
            (param[6] = new OracleParameter("P_REFF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Reff;
            (param[7] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remark;
            (param[8] = new OracleParameter("P_ISDate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            (param[9] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[10] = new OracleParameter("P_DEF_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Def_status;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblsupplier", "sp_seach_bl_headseq", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchPRNREQNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string prnno = null;
            string refno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        prnno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;
                    default:
                        break;
                }
            }
            prnno = (prnno != null) ? (prnno.ToUpper() + "%") : null;
            refno = (refno != null) ? (refno.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("PRN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prnno;
            (param[2] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            (param[3] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("INT_REQ", "pkg_search_imp.SearchPRNREQNo", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchPRNHeader(string p_itr_req_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itr_req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("INT_REQ", "pkg_search_imp.SearchPRNHeader", CommandType.StoredProcedure, false, param);
        }

        public DataTable SearchPRNItems(Int32 p_itri_seq_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_itri_seq_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("INT_REQ_ITM", "pkg_search_imp.SearchPRNItems", CommandType.StoredProcedure, false, param);
        }

        public DataTable SearchQuotation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            string _customer = null;
            string _name = null;
            string _ref = null;
            string _date = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;
                    case "PARTY CODE":
                        _customer = _searchText;
                        break;
                    case "NAME":
                        _name = _searchText;
                        break;
                    case "REFERENCE":
                        _ref = _searchText;
                        break;
                    case "DATE":
                        _date = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "%";
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("H_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[3] = new OracleParameter("PARTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("PARTY_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[6] = new OracleParameter("P_DATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("QUO_HDR", "pkg_search_imp.SP_SEARCH_QUOTATION", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchOrderPlanNoByStatus(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string opno = null;
            string refno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ORDERPLAN NO":
                        opno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            opno = (opno != null) ? (opno.ToUpper() + "%") : "%";
            refno = (refno != null) ? (refno.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//_com;
            (param[1] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opno;
            (param[2] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("IMP_OP_HDR", "pkg_search_imp.SP_Search_OrderPlanNoByStatus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable LoadKit(string p_iok_op_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_iok_op_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_iok_op_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_op_kit", "pkg_search_imp.LoadKit", CommandType.StoredProcedure, false, param);
        }

        #endregion


        //Sahan
        public DataTable LoadSupplierCurrencies(string p_mscu_com, string p_mscu_sup_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mscu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mscu_com;
            (param[1] = new OracleParameter("p_mscu_sup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mscu_sup_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_sup_cur", "pkg_general.sp_search_sup_curr", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadAllPorts(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_port", "pkg_general.SP_Search_All_ports", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadSupplierPorts(string p_mspr_com, string p_mspr_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mscu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_com;
            (param[1] = new OracleParameter("p_mscu_sup_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_supp_port", "pkg_general.sp_search_sup_ports", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadSupplierItems(string p_mbii_com, string p_mbii_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mbii_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbii_com;
            (param[1] = new OracleParameter("p_mbii_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbii_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_sup_itm", "pkg_general.sp_search_sup_items", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadAllTaxCat(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_tax_master", "pkg_general.sp_search_tax_types", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadAllTaxCodes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_tax_cd", "pkg_general.sp_search_tax_codes", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadSupplierTaxCodes(string p_mbit_com, string p_mbit_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mbit_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbit_com;
            (param[1] = new OracleParameter("p_mbit_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mbit_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_busentity_tax", "pkg_general.sp_search_sup_tax", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable GetSupplierProfileByGrup(string CustCD, string nic, string DL, string PPNo, string brNo, string mobNo)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_CustCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CustCD;
            (param[1] = new OracleParameter("p_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[2] = new OracleParameter("p_dl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DL;
            (param[3] = new OracleParameter("p_passport", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PPNo;
            (param[4] = new OracleParameter("p_brNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brNo;
            (param[5] = new OracleParameter("P_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobNo;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getcustomergrup", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan
        public DataTable LoadCurrencyText(string p_mcr_cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mcr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mcr_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_cur", "pkg_general.sp_search_curr_desc", CommandType.StoredProcedure, false, param);
        }

        //Sahan
        public DataTable LoadCountryText(string p_mcu_cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mcu_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mcu_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_country", "pkg_general.sp_search_country_desc", CommandType.StoredProcedure, false, param);
        }

        #region Item Master
        // Nadeeka 09-07-2015
        public DataTable GetItemSearchDataMaster(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.sp_searchMasterItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Randima 2016-11-23
        public DataTable GetBLItems(string _initialSearchParams, string _searchCatergory, string _searchText, int _seqNo)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqNo;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_searchBLItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Randima 2016-11-24
        public DataTable GetPIItems(string _initialSearchParams, string _searchCatergory, string _searchText, string _piNo)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _piNo;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_searchPIItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCat_SearchDataMaster(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            string _type = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            //  searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2]) : "%";

            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";

            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            //searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            //searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            _type = searchParams[4];
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_mcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_scat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_scat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_scat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[7] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_itemcategorysearcheMaster", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        // Nadeeka 09-07-2015
        public DataTable GetItemSearchUOMMaster(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _UOM = null;
            string _description = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _UOM = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;



                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _UOM = (_UOM != null) ? (_UOM.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UOM;
            (param[1] = new OracleParameter("p_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.SP_SearchUOM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        // Nadeeka 09-07-2015
        public DataTable GetItemSearchColorMaster(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _UOM = null;
            string _description = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _UOM = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;



                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _UOM = (_UOM != null) ? (_UOM.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UOM;
            (param[1] = new OracleParameter("p_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.SP_SearchColor", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        // Nadeeka 09-07-2015
        public DataTable GetItemSearchTaxMaster(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            string _com = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "COMPANY":
                        _com = _searchText;
                        break;
                    case "DESCRIPTION":
                        _description = _searchText;
                        break;


                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _com = (_com != null) ? (_com.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search.SP_TaxStucture", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        #endregion Item Master


        public DataTable SearchRequestType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string request_type = null;
            string description = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST TYPE":
                        request_type = _searchText;
                        break;

                    case "DESCRIPTION":
                        description = _searchText;
                        break;

                }
            }

            request_type = (request_type != null) ? (request_type + "%") : null;
            description = (description != null) ? (description + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request_type;
            (param[3] = new OracleParameter("TP_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = description;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblSearchRequestType", "PKG_SALES.SP_SEARCHREQUESTTYPE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchExecutive(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string employee_id = null;
            string user_id = null;
            string user_name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EMPLOYEE ID":
                        employee_id = _searchText;
                        break;

                    case "USER ID":
                        user_id = _searchText;
                        break;

                    case "USER NAME":
                        user_name = _searchText;
                        break;
                }
            }

            employee_id = (employee_id != null) ? (employee_id + "%") : null;
            user_id = (user_id != null) ? (user_id + "%") : null;
            user_name = (user_name != null) ? (user_name + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("EMP_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = employee_id;
            (param[1] = new OracleParameter("USR_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user_id;
            (param[2] = new OracleParameter("USR_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user_name;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUser", "PKG_SALES.SP_SEARCHEXECUTIVE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Search_INT_REQ(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string request_no = null;
            string request_type = null;
            string customer = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        request_no = _searchText;
                        break;

                    case "REQUEST TYPE":
                        request_type = _searchText;
                        break;

                    case "CUSTOMER":
                        customer = _searchText;
                        break;
                }
            }

            request_no = (request_no != null) ? (request_no + "%") : null;
            request_type = (request_type != null) ? (request_type + "%") : null;
            customer = (customer != null) ? (customer + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request_no;
            (param[3] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request_type;
            (param[5] = new OracleParameter("BUS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            (param[6] = new OracleParameter("EXCECUTIVE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUser", "PKG_SALES.SP_SEARCH_INT_REQ", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Search_INT_REQ_RER(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string request_no = null;
            string request_type = null;
            string customer = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        request_no = _searchText;
                        break;

                    case "REQUEST TYPE":
                        request_type = _searchText;
                        break;

                    case "CUSTOMER":
                        customer = _searchText;
                        break;
                }
            }

            request_no = (request_no != null) ? (request_no + "%") : null;
            request_type = (request_type != null) ? (request_type + "%") : null;
            customer = (customer != null) ? (customer + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request_no;
            (param[3] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request_type;
            (param[5] = new OracleParameter("BUS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUser", "PKG_SALES.SP_SEARCH_INT_REQ_RER", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Search_INR_SER(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string ser_1 = null;
            string ser_2 = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL1":
                        ser_1 = _searchText;
                        break;

                    case "SERIAL2":
                        ser_2 = _searchText;
                        break;

                }
            }

            ser_1 = (ser_1 != null) ? (ser_1 + "%") : null;
            ser_2 = (ser_2 != null) ? (ser_2 + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("SER_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_1;
            (param[4] = new OracleParameter("SER_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_2;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUser", "PKG_SALES.SP_SEARCH_INR_SER", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Search_INT_RES(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string reservation_no = null;
            string reservation_type = null;
            string customer = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RESERVATION NO":
                        reservation_no = _searchText;
                        break;

                    case "RESERVATION TYPE":
                        reservation_type = _searchText;
                        break;

                    case "CUSTOMER":
                        customer = _searchText;
                        break;
                }
            }

            reservation_no = (reservation_no != null) ? (reservation_no + "%") : null;
            reservation_type = (reservation_type != null) ? (reservation_type + "%") : null;
            customer = (customer != null) ? (customer + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reservation_no;
            (param[3] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reservation_type;
            (param[4] = new OracleParameter("CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            (param[5] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUser", "PKG_SALES.SP_SEARCH_INR_RES", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #region PDA // Sahan 24 Aug 2015

        //Sahan 24 Aug 2015
        public DataTable LoadUserLocation(string p_user, string p_com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("sec_user_loc", "pkg_pda.searchuserlocation", CommandType.StoredProcedure, false, param);
        }

        #endregion

        //THaraka 2015-09-08 to filter service enquiry
        public DataTable GET_EQULPC_TO_PC(string com, string pc)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUser", "SP_GET_EQULPC_TO_PC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Code by Rukshan 12-sep-2015 
        public DataTable Search_int_hdr_Temp_Infor(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;
            string _othLoc = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    case "OTHER LOC": _othLoc = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }

            _document = (_document != null) ? (_document.ToUpper() + "%") : "%";
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : "%";
            _date = (_date != null) ? (_date + "%") : "%";
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : "%";
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : "%";
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : "%";
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : "%";
            _othLoc = (_othLoc != null) ? (_othLoc + "%") : "%";

            OracleParameter[] param = new OracleParameter[15];
            //Fixed Date Range
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            //Search parameters
            (param[6] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[7] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[8] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[9] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[10] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[11] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[12] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othLoc;
            (param[13] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "pkg_search_imp.sp_search_int_hdrTemp_Infor", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Code by Rukshan 15-sep-2015 
        public DataTable GET_DeliverByOption(string _com)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbldeliver", "pkg_search_imp.get_DeliverBy", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Darshana 24-Sep-2015
        public DataTable GetModelMaster(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "pkg_search.sp_searchmodelmaster", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka 2015-10-13
        public DataTable SEARCH_ROUTE(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblZPC", "pkg_search.SP_SEARCH_ROUTE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan 2015-10-14
        public DataTable GetInventoryChannel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _dec = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _dec = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _dec = (_dec != null) ? (_dec.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dec;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblReceipt", "pkg_search_imp.SP_SEARCH_CHANEL", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 19/Oct/2015

        public DataTable SearchPurchaseOrdersFast(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "DOC REF":
                        _refNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper()) : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper()) : null;

            //sp_get_PurchaseOrders (p_com in NVARCHAR2,p_subTp in NVARCHAR2,p_docNo in NVARCHAR2,p_docRef in NVARCHAR2,p_status in NVARCHAR2,p_date in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_docRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.searchpurchaseordfast", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 03/Nov/2015
        public DataTable SearchPriceBookWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _pricebook = null;
            string _description = null;
            string _status = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BOOK":
                        _pricebook = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _pricebook = (_pricebook != null) ? (_pricebook.ToUpper()) : null;
            _description = (_description != null) ? (_description.ToUpper()) : null;
            _status = (_status != null) ? (_status.ToUpper()) : null;

            if (!string.IsNullOrEmpty(_status))
            {
                if (_status == "ACTIVE")
                {
                    _status = "1";
                }
                else
                {
                    _status = "0";
                }
            }
            else
            {
                _status = null;
            }

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_sapb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sapb_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pricebook;
            (param[2] = new OracleParameter("p_sapb_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_sapb_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("sar_pb", "pkg_price_web.sp_search_price_books_popup", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka 2015-11-03
        public DataTable SEARCH_BIN(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code + "%") : "%";
            _description = (_description != null) ? (_description + "%") : "%";
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_BINCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblZPC", "pkg_search_imp.SP_SEARCH_BIN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 04/Nov/2015
        public DataTable SearchPriceBookLevelsWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            string _status = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper()) : null;
            _description = (_description != null) ? (_description.ToUpper()) : null;
            _status = (_status != null) ? (_status.ToUpper()) : null;

            if (!string.IsNullOrEmpty(_status))
            {
                if (_status == "ACTIVE")
                {
                    _status = "1";
                }
                else
                {
                    _status = "0";
                }
            }
            else
            {
                _status = null;
            }

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_allcheck", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_activecheck", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_sapl_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_sapl_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_sapl_pb_lvl_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_sapl_pb_lvl_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[6] = new OracleParameter("p_sapl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("sar_pb_lvl", "pkg_price_web.sp_search_pb_level_popup", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 23/11/2015
        public DataTable GetContainerType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dt = null;
            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblContainerType", "pkg_imports_Enquiry.SP_GET_CONTAINER_TYPE", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Lakshan 23/11/2015
        public DataTable GetContainerAgent(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dt = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_mbe_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblAgent", "pkg_imports_Enquiry.SP_GET_CONTAINER_AGENT", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharaka 2015-11-24
        public DataTable SEARCH_DISPOSAL_JOB(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string DOCUMENT = null;
            string DATE = null;
            string REFERENCE = null;
            string Stratus = null;
            Int32 isDateSearch = 1;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        DOCUMENT = _searchText;
                        break;

                    case "DATE":
                        DATE = _searchText;
                        isDateSearch = 1;
                        break;
                    case "REFERENCE":
                        REFERENCE = _searchText;
                        break;
                    case "STATUS":
                        Stratus = _searchText;
                        break;


                    default:
                        break;
                }
            }

            DOCUMENT = (DOCUMENT != null) ? (DOCUMENT + "%") : "%";
            DATE = (DATE != null) ? (DATE + "%") : "%";
            REFERENCE = (REFERENCE != null) ? (REFERENCE + "%") : "%";
            Stratus = (Stratus != null) ? (Stratus + "%") : "%";

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOCUMENT;
            (param[3] = new OracleParameter("P_FROM_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[4] = new OracleParameter("P_TO_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[5] = new OracleParameter("P_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REFERENCE;
            (param[6] = new OracleParameter("P_ISDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDateSearch;
            (param[7] = new OracleParameter("P_STAUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stratus;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblZPC", "pkg_search.SP_SEARCH_DISPOSAL_JOB", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30/11/2015
        public DataTable GetAdminTeamByCompany(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_COM_CDS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _initialSearchParams;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCompany", "pkg_search_imp.SP_SEARCH_ADMIN_TEAM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 02/12/2015
        public DataTable SEARCH_LC_NO(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dtResult = null;
            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "FACILITY NO":
                        _code = _searchText;
                        break;

                    case "REF NO":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dtResult = QueryDataTable("tblContainerType", "pkg_search_imp.SP_Search_Lc_No", CommandType.StoredProcedure, false, param);
            return dtResult;
        }

        //Lakshan 02/12/2015
        public DataTable SEARCH_ENTRY_NO(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dtResult = null;
            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ENTRY NO":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dtResult = QueryDataTable("tblContainerType", "pkg_search_imp.SP_Search_Entry_No", CommandType.StoredProcedure, false, param);
            return dtResult;
        }

        //Lakshan 06-02-2016
        public DataTable SEARCH_TO_BOND_NO(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dtResult = null;
            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BOND NO":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dtResult = QueryDataTable("tblToBond", "pkg_search_imp.SP_Search_to_bond_no", CommandType.StoredProcedure, false, param);
            return dtResult;
        }

        //Rukshan 08/12/2015
        public DataTable GetDemurage_Para(string _com, string _doc, DateTime Fdate, DateTime Todate)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("P_FDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Fdate;
            (param[3] = new OracleParameter("P_TDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Todate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbldemu", "pkg_search_imp.SP_SEACH_Demu_para", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Rukshan 09/Dec/2015
        public DataTable GetDemurrageCount(string doc)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("count", "pkg_search_imp.SP_SEACH_Demu_count", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 14/Dec/2015
        public DataTable GetHsCodeDutyTypes(string _comp)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_comp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "SP_GET_HS_CODE_Duty_TYPE2", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 14/Dec/2015
        public DataTable GetHsClaimDutyTypes(string _comp)
        {
            //Spliit for Search control type.
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_comp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblItem", "pkg_imports_Enquiry.SP_GET_HS_CODE_CLAIM_TYPE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 15/Dec/2015
        public DataTable SearchOrderPlanNoNew(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string opno = null;
            string refno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ORDERPLAN NO":
                        opno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            opno = (opno != null) ? (opno.ToUpper() + "%") : "%";
            refno = (refno != null) ? (refno.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];//_com;
            (param[1] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opno;
            (param[2] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("IMP_OP_HDR", "pkg_imports_Enquiry.SP_Search_OrderPlanNoByStatus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //15-12-2015 Lakshan 
        public DataTable searchGRNDataNew(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _item = _searchText;
                        break;

                    case "REFERENCE NO":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("P_INVO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_SEARCH_GRN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //15-12-2015 Lakshan 
        public DataTable SearchGetHsCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_HS_CODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //15-12-2015 Lakshan 
        public DataTable GetHsCodeData(string code)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_HS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_HS_DATA_BY_HS_CODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //15-12-2015 Lakshan 
        public DataTable GetHsCodeEntryType(string _country)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COUNTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _country;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_HS_ENTRY_TYPE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //15-12-2015 Lakshan 
        public DataTable GetHsDutyBU(string country, string hsCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_HS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode;
            (param[1] = new OracleParameter("P_COUNTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_HS_DUTY_BR_UP", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //15-12-2015 Lakshan 
        public DataTable GetHsClaimBU(string country, string hsCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COUNTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[1] = new OracleParameter("P_HS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_HS_CLAIM_BR_UP", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //15-12-2015 Lakshan 
        public DataTable SearchGetPort(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _item = (_item != null) ? (_item + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_PORT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-12-15
        public DataTable GetItemSearchDataWithBIN(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            string _Part_No = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;
                    case "PART NO":
                        _Part_No = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _Part_No = (_Part_No != null) ? (_Part_No.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_part_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Part_No;
            (param[6] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search_imp.SP_SEARCHITEM_BIN", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //17-12-2015 Lakshan 
        public DataTable SearchHsDefinitionDuty(HsCode hsCode)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_mhc_frm_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_frm_cnty;
            (param[1] = new OracleParameter("p_mhc_to_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_to_cnty;
            (param[2] = new OracleParameter("p_mhc_hs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_hs_cd;
            (param[3] = new OracleParameter("p_mhc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_tp;
            (param[4] = new OracleParameter("p_mhc_cost_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_cat;
            (param[5] = new OracleParameter("p_mhc_cost_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_tp;
            (param[6] = new OracleParameter("p_mhc_cost_ele", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsCode.Mhc_cost_ele;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "sp_get_hs_defi_dutySP", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-12-16
        public DataTable SearchSerialByLocBIN(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ser1 = null;
            string _ser2 = null;
            string _itemStatus = null;
            string _itemCode = null;
            string _warrNo = null;
            string _docNo = null;
            string _docDate = null;

            if (searchParams[0].ToString() == "SER1_WITEM")
            {
                if (!string.IsNullOrEmpty(_searchCatergory))
                {
                    switch (_searchCatergory.ToUpper())
                    {
                        case "SERIAL 1": _ser1 = _searchText; break;
                        case "SERIAL 2": _ser2 = _searchText; break;
                        case "ITEM STATUS": _itemStatus = _searchText; break;
                        case "WARRANTY NO": _warrNo = _searchText; break;
                        case "DOC NO": _docNo = _searchText; break;
                        case "DOC DATE": _docDate = _searchText; break;
                        default: break;
                    }
                }
            }

            if (searchParams[0].ToString() == "SER1_WOITEM")
            {
                if (!string.IsNullOrEmpty(_searchCatergory))
                {
                    switch (_searchCatergory.ToUpper())
                    {
                        case "SERIAL 1": _ser1 = _searchText; break;
                        case "SERIAL 2": _ser2 = _searchText; break;
                        case "ITEM STATUS": _itemStatus = _searchText; break;
                        case "ITEM CODE": _itemCode = _searchText; break;
                        case "WARRANTY NO": _warrNo = _searchText; break;
                        case "DOC NO": _docNo = _searchText; break;
                        case "DOC DATE": _docDate = _searchText; break;
                        default: break;
                    }
                }
            }

            if (searchParams[0].ToString() == "SER2_WOITEM")
            {
                if (!string.IsNullOrEmpty(_searchCatergory))
                {
                    switch (_searchCatergory.ToUpper())
                    {
                        case "SERIAL 1": _ser1 = _searchText; break;
                        case "SERIAL 2": _ser2 = _searchText; break;
                        case "ITEM STATUS": _itemStatus = _searchText; break;
                        case "ITEM CODE": _itemCode = _searchText; break;
                        case "WARRANTY NO": _warrNo = _searchText; break;
                        case "DOC NO": _docNo = _searchText; break;
                        case "DOC DATE": _docDate = _searchText; break;
                        default: break;
                    }
                }
            }

            _ser1 = (_ser1 != null) ? (_ser1 + "%") : "%";
            _ser2 = (_ser2 != null) ? (_ser2 + "%") : "%";
            _itemStatus = (_itemStatus != null) ? (_itemStatus.ToUpper() + "%") : "%";
            _itemCode = (_itemCode != null) ? (_itemCode.ToUpper() + "%") : "%";
            _warrNo = (_warrNo != null) ? (_warrNo + "%") : "%";
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _docDate = (_docDate != null) ? (_docDate + "%") : "%";

            OracleParameter[] param = new OracleParameter[12];
            //Initial parameters
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            if (searchParams[0].ToString() == "SER1_WITEM")
            {
                (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            }
            if (searchParams[0].ToString() == "SER1_WOITEM")
            {
                (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            }
            if (searchParams[0].ToString() == "SER2_WOITEM")
            {
                (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            }

            //Search parameters
            (param[4] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemStatus;
            (param[5] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser1;
            (param[6] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser2;
            (param[7] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrNo;
            (param[8] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[9] = new OracleParameter("p_docdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docDate;
            (param[10] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSerials", "pkg_search.SP_SEARCH_SERIAL_LOC_BIN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //17-12-2015 Lakshan 
        public DataTable SearchHsDefinitionClaim(HsCodeClaim hsClaimCode)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_mhcl_frm_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_frm_cnty;
            (param[1] = new OracleParameter("p_mhcl_to_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_to_cnty;
            (param[2] = new OracleParameter("p_mhcl_hs_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_hs_cd;
            (param[3] = new OracleParameter("p_mhcl_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_tp;
            (param[4] = new OracleParameter("p_mhcl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_com;
            (param[5] = new OracleParameter("p_mhcl_cost_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_cost_cat;
            (param[6] = new OracleParameter("p_mhcl_cost_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_cost_tp;
            (param[7] = new OracleParameter("p_mhcl_cost_ele", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hsClaimCode.Mhcl_cost_ele;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.sp_get_hs_defi_claim", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 2015-12-18
        public DataTable GetBusinessCompanyDataByCountry(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;
            string _id = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    case "ID":
                        _id = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;
            _id = (_id != null) ? (_id + "%") : null;
            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("P_MBI_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _id;
            (param[1] = new OracleParameter("P_MBI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("P_MBI_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[3] = new OracleParameter("P_MBI_COUNTRY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[4] = new OracleParameter("P_mbi_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_imports_Enquiry.SP_SEARCH_BUSINESS_COMP_DATA", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 2015-12-19
        public DataTable GetContainerNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;
            string _id = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory)
                {
                    case "Code":
                        _code = _searchText;
                        break;
                    case "Doc No":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;

            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_ibc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_ibc_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            // _dtResults = QueryDataTable("tblBankDetails", "pkg_imports_Enquiry.SP_SEARCH_CONTAINER_NO", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tblBankDetails", "SP_SEARCH_CONTAINER_NO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 2015-12-19
        public DataTable GetBlNumber(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;
            string _id = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory)
                {
                    case "Code":
                        _code = _searchText;
                        break;
                    case "Doc No":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;

            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_ibc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_ibc_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_imports_Enquiry.SP_GET_BL_NO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharaka 2015-12-21
        public DataTable SEARCH_RECEIPT_UNALO(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = string.Empty;
            string _refNo = string.Empty;
            string _othRef = string.Empty;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "OTH REF NO":
                        _othRef = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _docNo = _docNo.Replace("%", "");
            _refNo = _refNo.Replace("%", "");
            _othRef = _othRef.Replace("%", "");

            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _othRef = (_othRef != null) ? (_othRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[4] = new OracleParameter("p_othRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othRef;
            (param[5] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblReceipt", "PKG_SEARCH.SP_SEARCH_RECEIPT_UNALO", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 2015-12-23
        public DataTable Search_Tax_Master_Data(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;

            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("P_TAX_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("P_TAX_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblTaxData", "pkg_imports_Enquiry.SP_SEARCH_TAX_DATA", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 2015-12-23
        public DataTable Search_Tax_CODES(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _txCode = null;
            string _rtCode = null;
            string _rt = null;
            string _claimRt = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _txCode = _searchText;
                        break;
                    case "RATE CODE":
                        _rtCode = _searchText;
                        break;
                    case "RATE":
                        _rt = _searchText;
                        break;
                    case "DIV RATE":
                        _claimRt = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _txCode = (_txCode != null) ? (_txCode + "%") : null;
            _rtCode = (_rtCode != null) ? (_rtCode + "%") : null;
            _rt = (_rt != null) ? (_rt + "%") : null;
            _claimRt = (_claimRt != null) ? (_claimRt + "%") : null;

            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("P_MTC_TAX_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _txCode;
            (param[1] = new OracleParameter("P_MTC_TAX_RT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtCode;
            (param[2] = new OracleParameter("P_MTC_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _rt;
            (param[3] = new OracleParameter("P_MTC_CLAIM_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _claimRt;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblTaxData", "pkg_imports_Enquiry.SP_SEARCH_TAX_CODES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 2015-12-29
        public DataTable GetTaxClaimCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;
            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_mtc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_mtc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_mtc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_imports_Enquiry.SP_GET_TAX_CLAIM_CD", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 2015/12/30
        public DataTable GetBrandManager(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;
            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_esep_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_esep_manager_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_esep_name_initials", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_imports_Enquiry.SP_GET_BRAND_MANAGER", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Dilshan on 02/02/2018
        public DataTable GetUser(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;
            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_esep_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_esep_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_esep_name_initials", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_imports_Enquiry.SP_GET_USER", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by Rukshan 05-Jan-2016 
        public DataTable GET_Vehicle(string _COM, string _VNO)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
            (param[1] = new OracleParameter("p_VNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _VNO;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbldeliver", "pkg_search_imp.get_Vehicle", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Code by Rukshan 05-Jan-2016 
        public DataTable GET_TRANSPORT_JOB(string _COM, string _VNO)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
            (param[1] = new OracleParameter("p_VNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _VNO;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbldeliver", "pkg_search_imp.get_TRANSPORT_JOB", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Code by Rukshan 07-Jan-2016 
        public DataTable GET_UOM_CAT(string _CAT)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CAT;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUOM", "pkg_search_imp.get_UOM_CAT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Code by Rukshan 07-Jan-2016 
        public DataTable GET_ITM_REPL_REASON()
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblUOM", "pkg_search_imp.get_ITM_REPL_REASON", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchOrderPlanNoByStatusNew(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string opno = null;
            string refno = null;
            string supplier = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ORDERPLAN NO":
                        opno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;

                    case "SUPPLIER":
                        supplier = _searchText;
                        break;

                    default:
                        break;
                }
            }

            opno = (opno != null) ? (opno.ToUpper()) : null;
            refno = (refno != null) ? (refno.ToUpper()) : null;
            supplier = (supplier != null) ? (supplier.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_io_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_io_op_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opno;
            (param[2] = new OracleParameter("p_io_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            (param[3] = new OracleParameter("p_io_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
            (param[4] = new OracleParameter("p_io_op_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[5] = new OracleParameter("p_io_op_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("IMP_OP_HDR", "pkg_search_imp.sp_search_op_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        /*Lakshan 08/01/2016 from Country search*/
        public DataTable GetAllCountryData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCurrency", "pkg_search_imp.sp_searchAllcountry", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 12 Jan 2015
        public DataTable GetAvailableSeriaSearchDataWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial = null;
            string _warrno = null;
            string _itemstatus = null;
            string _indocno = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL NO":
                        _serial = _searchText;
                        break;

                    case "WARRANTY NO":
                        _warrno = _searchText;
                        break;

                    case "STATUS DESCRIPTION":
                        _itemstatus = _searchText;
                        break;

                    case "INWARD DOCUMENT":
                        _indocno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _serial = (_serial != null) ? (_serial.ToUpper()) : null;
            _warrno = (_warrno != null) ? (_warrno.ToUpper()) : null;
            _itemstatus = (_itemstatus != null) ? (_itemstatus.ToUpper()) : null;
            _indocno = (_indocno != null) ? (_indocno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrno;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_inward_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _indocno;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAvailableSerialSearch", "pkg_search.sp_searchinventorySerialWeb", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 14/01/2016
        public DataTable GET_DISTRICT_DATA(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string country = null;
            string desc = null;
            string province = null;
            string district = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "COUNTRY CODE":
                        country = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;
                    case "PROVINCE CODE":
                        province = _searchText;
                        break;
                    case "DISTRICT CODE":
                        district = _searchText;
                        break;

                    default:
                        break;
                }
            }
            country = (country != null) ? (country.ToUpper() + "%") : null;
            desc = (desc != null) ? (desc.ToUpper() + "%") : null;
            province = (province != null) ? (province.ToUpper() + "%") : null;
            district = (district != null) ? (district.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_mt_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[0] = new OracleParameter("p_mt_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            (param[0] = new OracleParameter("p_mt_province_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[0] = new OracleParameter("p_mt_distric_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblContainerType", "pkg_imports_Enquiry.SP_GET_DISTRICT_DATA", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 19-Jan-2016 
        public DataTable SearchGetProcedureCode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_cogn_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_cogn_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_PROCDURE_CODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 2016-01-19
        public DataTable SearchCusdecHeader(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _othdoc = null;
            string _blno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;

                    case "OTH DOC":
                        _othdoc = _searchText;
                        break;
                    case "BL NO":
                        _blno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper() + "%") : null;
            _blno = (_blno != null) ? (_blno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[4] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            (param[5] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.SP_SEARCH_CUSDEC_HDR", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }




        //Lakshan 18/01/2016
        public DataTable SearchWarrentyAmendSerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string serial = null;
            string warranty = null;
            string invoice = null;
            string document = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        serial = _searchText;
                        break;

                    case "WARRANTY #":
                        warranty = _searchText;
                        break;

                    case "INVOICE #":
                        invoice = _searchText;
                        break;

                    case "DOCUMENT #":
                        document = _searchText;
                        break;

                    default:
                        break;
                }
            }

            serial = (serial != null) ? (serial) : null;
            warranty = (warranty != null) ? (warranty) : null;
            invoice = (invoice != null) ? (invoice) : null;
            document = (document != null) ? (document) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = warranty;
            (param[2] = new OracleParameter("p_irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("p_irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;
            (param[4] = new OracleParameter("p_irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[5] = new OracleParameter("p_irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (serial == null && warranty == null && invoice == null && document == null)
            {
                // _dtResults = QueryDataTable("mst_loc", "pkg_search_imp.SP_GET_ITEM_DATA_WA_SERIAL", CommandType.StoredProcedure, false, param);
                _dtResults = QueryDataTable("mst_loc", "SP_GET_ITEM_DATA_WA_SERIAL", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("mst_loc", "SP_GET_ITEM_DATA_WA_SERIALSP", CommandType.StoredProcedure, false, param);
            }


            return _dtResults;
        }

        //Lakshan 21/01/2016
        public DataTable SearchWarrentyAmendWarrenty(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string serial = null;
            string warranty = null;
            string invoice = null;
            string document = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        serial = _searchText;
                        break;

                    case "WARRANTY #":
                        warranty = _searchText;
                        break;

                    case "INVOICE #":
                        invoice = _searchText;
                        break;

                    case "DOCUMENT #":
                        document = _searchText;
                        break;

                    default:
                        break;
                }
            }

            serial = (serial != null) ? (serial) : null;
            warranty = (warranty != null) ? (warranty) : null;
            invoice = (invoice != null) ? (invoice) : null;
            document = (document != null) ? (document) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = warranty;
            (param[2] = new OracleParameter("p_irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("p_irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;
            (param[4] = new OracleParameter("p_irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[5] = new OracleParameter("p_irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //_dtResults = QueryDataTable("mst_loc", "pkg_search_imp.SP_GET_ITEM_DATA_WA_WARRANTY", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("ser_mst", "SP_GET_ITEM_DATA_WA_WARRANTY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 21/01/2016
        public DataTable SearchWarrentyAmendInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string serial = null;
            string warranty = null;
            string invoice = null;
            string document = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        serial = _searchText;
                        break;

                    case "WARRANTY #":
                        warranty = _searchText;
                        break;

                    case "INVOICE #":
                        invoice = _searchText;
                        break;

                    case "DOCUMENT #":
                        document = _searchText;
                        break;

                    default:
                        break;
                }
            }

            serial = (serial != null) ? (serial) : null;
            warranty = (warranty != null) ? (warranty) : null;
            invoice = (invoice != null) ? (invoice) : null;
            document = (document != null) ? (document) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = warranty;
            (param[2] = new OracleParameter("p_irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("p_irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;
            (param[4] = new OracleParameter("p_irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[5] = new OracleParameter("p_irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_loc", "SP_GET_ITEM_DATA_WA_INVOICE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 21/01/2016
        public DataTable SearchWarrentyAmendDocNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string serial = null;
            string warranty = null;
            string invoice = null;
            string document = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        serial = _searchText;
                        break;

                    case "WARRANTY #":
                        warranty = _searchText;
                        break;

                    case "INVOICE #":
                        invoice = _searchText;
                        break;

                    case "DOCUMENT #":
                        document = _searchText;
                        break;

                    default:
                        break;
                }
            }

            serial = (serial != null) ? (serial + "%") : null;
            warranty = (warranty != null) ? (warranty + "%") : null;
            invoice = (invoice != null) ? (invoice + "%") : null;
            document = (document != null) ? (document + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = warranty;
            (param[2] = new OracleParameter("p_irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("p_irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;
            (param[4] = new OracleParameter("p_irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[5] = new OracleParameter("p_irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //_dtResults = QueryDataTable("mst_loc", "pkg_search_imp.SP_GET_ITEM_DATA_WA_DOCUMENT", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("mst_loc", "SP_GET_ITEM_DATA_WA_DOCUMENT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 21/01/2016
        public DataTable SearchWarrentyAmendData(string comp, string loc, string serial1, string warr, string inv, string doc)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comp;
            (param[1] = new OracleParameter("p_irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial1;
            (param[3] = new OracleParameter("p_irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = warr;
            (param[4] = new OracleParameter("p_irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv;
            (param[5] = new OracleParameter("p_irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //_dtResults = QueryDataTable("mst_loc", "pkg_search_imp.SP_SEARCH_WARRANTY_DATA", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("mst_loc", "sp_search_warranty_data_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 2016-01-22
        public DataTable SearchCusdec(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _othdoc = null;
            string _blno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;

                    case "OTH DOC":
                        _othdoc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper() + "%") : null;
            _blno = (_blno != null) ? (_blno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[1] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_imports_Enquiry.sp_searchEntry", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 21/01/2016
        public DataTable SearchWarrentyAmendRequestData(string comp, string loc, DateTime fromDate, DateTime toDate)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comp;
            (param[1] = new OracleParameter("p_irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[3] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_loc", "pkg_search_imp.SP_GET_WARRANTY_REQ_DATA", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 2016-01-24
        public DataTable SearchCusdecReq(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string reqNo = null;
            string reqDate = null;
            string tobondNo = null;
            string blNo = null;
            Int32 isDate = 0;
            DateTime DtDate = DateTime.Now.Date;
            string Def_status = string.Empty;
            if (searchParams.Length == 4)
            {
                Def_status = searchParams[2];
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQ NO":
                        reqNo = _searchText;
                        break;
                    case "REQ DATE":
                        reqDate = _searchText;
                        bool _isDate = DateTime.TryParse(_searchText, out DtDate);
                        if (_isDate == true) isDate = 1;
                        break;
                    case "TOBOND NO":
                        tobondNo = _searchText;
                        break;
                    case "BL NO":
                        blNo = _searchText;
                        break;
                    default:
                        break;
                }
            }

            reqNo = (reqNo != null) ? (reqNo.ToUpper() + "%") : null;
            reqDate = (reqDate != null) ? (reqDate.ToUpper() + "%") : null;
            blNo = (blNo != null) ? (blNo.ToUpper() + "%") : null;
            tobondNo = (tobondNo != null) ? (tobondNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[3] = new OracleParameter("p_reqdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = DtDate.Date;
            (param[4] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tobondNo;
            (param[5] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blNo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.SP_SEARCH_CUSDEC_REQ", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 28/01/2016
        public DataTable GetHSHistory(string com, string country, string docType, string item)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[2] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docType;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_get_hs_historynew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        /*Lakshan 01/02/2016*/
        public DataTable GetSupplierCommonNew(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string name = null;
            string add = null;
            string nic = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;

                    case "DESCRIPTION":
                        name = _searchText;
                        break;

                    case "ADDRESS":
                        add = _searchText;
                        break;

                    case "NIC":
                        nic = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            code = (code != null) ? (code + "%") : null;
            name = (name != null) ? (name + "%") : null;
            add = (add != null) ? (add + "%") : null;
            nic = (nic != null) ? (nic + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_mbe_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
            (param[3] = new OracleParameter("p_mbe_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = add;
            (param[4] = new OracleParameter("p_mbe_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_imp.sp_search_customer_WARR_AMEND", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 2016/02/03
        public DataTable GetValid_ExchangeRates(string _com, string fromCur, string toCur, DateTime fromDt)
        {
            List<MasterExchangeRate> _paraRate = new List<MasterExchangeRate>();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mer_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fromCur;
            (param[2] = new OracleParameter("p_mer_to_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = toCur;
            (param[3] = new OracleParameter("p_mer_vad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //sp_getValid_exratedetails(p_com in NVARCHAR2,p_mer_cur in NVARCHAR2,p_mer_to_cur in NVARCHAR2 ,p_mer_vad_from in date, c_data OUT sys_refcursor)
            DataTable _tbl = QueryDataTable("tbl", "pkg_search_imp.SP_GET_VALID_EXG_RATE", CommandType.StoredProcedure, false, param);
            return _tbl;

        }

        //Lakshan 2016/02/05
        public DataTable GetVahicleAllocationEnquiryData(string _com, string _pc, string _veh_tp, string _fleet, DateTime expect_dt, string _whole_day)
        {
            List<MasterExchangeRate> _paraRate = new List<MasterExchangeRate>();

            OracleParameter[] param = new OracleParameter[7];
            if (_whole_day == "1")
            {
                expect_dt = expect_dt.Date;
            }
            (param[0] = new OracleParameter("p_gce_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_gce_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_gce_veh_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _veh_tp;
            (param[3] = new OracleParameter("p_gce_fleet", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fleet;
            (param[4] = new OracleParameter("p_gce_expect_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = expect_dt;
            (param[5] = new OracleParameter("p_whole_day", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _whole_day;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "pkg_search_imp.SP_SEARCH_FLEET_ENQUERY_POPUP", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        //Lakshan 2016/02/05
        public DataTable GetVahiclesNotAllocated(string _pc)
        {
            List<MasterExchangeRate> _paraRate = new List<MasterExchangeRate>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mfa_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "pkg_search_imp.SP_SEARCH_FLEET_NOT_ALLOCATE", CommandType.StoredProcedure, false, param);
            return _tbl;

        }

        //nuwan 2016/02/08
        public List<MST_CUS_SEARCH_HEAD> getCustomerDetails(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string type = null)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Code":
                        searchFld = "Mbe_cd";
                        break;
                    case "Name":
                        searchFld = "Mbe_name";
                        break;
                    case "NIC":
                        searchFld = "Mbe_nic";
                        break;
                    case "Mobile No":
                        searchFld = "Mbe_mob";
                        break;
                    case "BR No":
                        searchFld = "Mbe_br_no";
                        break;
                    case "Address1":
                        searchFld = "MBE_ADD1";
                        break;
                    case "Address2":
                        searchFld = "MBE_ADD2";
                        break;
                    case "VAT Reg":
                        searchFld = "MBE_TAX_NO";
                        break;
                    case "Passport No":
                        searchFld = "MBE_PP_NO";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<MST_CUS_SEARCH_HEAD> cuslist = null;
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
                param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblCus", "SP_SEARCH_CUSTOMERDETAILS", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    cuslist = DataTableExtensions.ToGenericList<MST_CUS_SEARCH_HEAD>(_dtResults, MST_CUS_SEARCH_HEAD.Converter);
                }
                return cuslist;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }
        public List<MST_TOWN_SEARCH_HEAD> getTownDetails(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Town":
                        searchFld = "mt_desc";
                        break;
                    case "District":
                        searchFld = "mdis_desc";
                        break;
                    case "Province":
                        searchFld = "mpro_desc";
                        break;
                    case "Code":
                        searchFld = "mt_cd";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<MST_TOWN_SEARCH_HEAD> townlist = null;
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbltOWN", "SP_SEARCH_PERTOWNDETAILS", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    townlist = DataTableExtensions.ToGenericList<MST_TOWN_SEARCH_HEAD>(_dtResults, MST_TOWN_SEARCH_HEAD.Converter);
                }
                return townlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<MST_PROFIT_CENTER_SEARCH_HEAD> getProfitCenters(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "mpc_cd";
                    break;
                case "Description":
                    searchFld = "mpc_desc";
                    break;
                case "Address":
                    searchFld = "mpc_add1";
                    break;
                case "Chanel":
                    searchFld = "mpc_chnl";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_PROFIT_CENTER_SEARCH_HEAD> profCenters = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_PROFITCENTERS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                profCenters = DataTableExtensions.ToGenericList<MST_PROFIT_CENTER_SEARCH_HEAD>(_dtResults, MST_PROFIT_CENTER_SEARCH_HEAD.Converter);
            }
            return profCenters;
        }
        //dilshan 28/09/2017
        public List<MST_PROFIT_CENTER_SEARCH_HEAD> getMgProfitCenters(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string mgr)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "mpc_cd";
                    break;
                case "Description":
                    searchFld = "mpc_desc";
                    break;
                case "Address":
                    searchFld = "mpc_add1";
                    break;
                case "Chanel":
                    searchFld = "mpc_chnl";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_PROFIT_CENTER_SEARCH_HEAD> profCenters = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search.ToUpper();
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_mgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mgr;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "sp_search_mgrprofitcenters", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                profCenters = DataTableExtensions.ToGenericList<MST_PROFIT_CENTER_SEARCH_HEAD>(_dtResults, MST_PROFIT_CENTER_SEARCH_HEAD.Converter);
            }
            return profCenters;
        }

        public List<MST_EMPLOYEE_SEARCH_HEAD> getEmployeeDetails(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Epf No":
                    searchFld = "MEMP_EPF";
                    break;
                case "Category":
                    searchFld = "MEMP_CAT_SUBCD";
                    break;
                case "First Name":
                    searchFld = "MEMP_FIRST_NAME";
                    break;
                case "Last Name":
                    searchFld = "MEMP_LAST_NAME";
                    break;
                case "NIC":
                    searchFld = "MEMP_NIC";
                    break;
                case "MOBILE":
                    searchFld = "MEMP_MOBI_NO";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_EMPLOYEE_SEARCH_HEAD> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_EMPLOYEEDETAILS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<MST_EMPLOYEE_SEARCH_HEAD>(_dtResults, MST_EMPLOYEE_SEARCH_HEAD.Converter);
            }
            return emp;
        }
        public List<EMP_SEARCH_HEAD_SCM> getEmployeeDetailsSCM(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Epf No":
                    searchFld = "MEMP_EPF";
                    break;
                case "Category":
                    searchFld = "MEMP_CAT_SUBCD";
                    break;
                case "First Name":
                    searchFld = "MEMP_FIRST_NAME";
                    break;
                case "Last Name":
                    searchFld = "MEMP_LAST_NAME";
                    break;
                case "NIC":
                    searchFld = "MEMP_NIC";
                    break;
                case "MOBILE":
                    searchFld = "MEMP_MOBI_NO";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<EMP_SEARCH_HEAD_SCM> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_EMPLOYEEDETAILSSCM", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<EMP_SEARCH_HEAD_SCM>(_dtResults, EMP_SEARCH_HEAD_SCM.Converter);
            }
            return emp;
        }

        //dilshan 28/09/2017
        public List<EMP_SEARCH_HEAD_SCM> getManagerDetails(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Epf No":
                    searchFld = "MEMP_EPF";
                    break;
                case "Category":
                    searchFld = "ESEP_CAT_CD";
                    break;
                case "First Name":
                    searchFld = "MEMP_FIRST_NAME";
                    break;
                case "Last Name":
                    searchFld = "MEMP_LAST_NAME";
                    break;
                case "NIC":
                    searchFld = "MEMP_NIC";
                    break;
                case "MOBILE":
                    searchFld = "MEMP_MOBI_NO";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<EMP_SEARCH_HEAD_SCM> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search.ToUpper();
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "sp_search_managerdetails", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<EMP_SEARCH_HEAD_SCM>(_dtResults, EMP_SEARCH_HEAD_SCM.Converter);
            }
            return emp;
        }

        //dilshan 28/09/2017
        public List<hpr_disr_val_ref> getCircular(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string Cat)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "circular code":
                    searchFld = "HDVR_CIRCULAR";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<hpr_disr_val_ref> emp = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cat;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "sp_search_circular", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<hpr_disr_val_ref>(_dtResults, hpr_disr_val_ref.Converter);
            }
            return emp;
        }

        //dilshan 28/09/2017
        public List<BonusDefinition> getCircularcbd(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "circular code":
                    searchFld = "HBP_CIRCULAR";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<BonusDefinition> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "sp_search_circularcbd", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<BonusDefinition>(_dtResults, BonusDefinition.Converter);
            }
            return emp;
        }

        //dilshan 28/09/2017
        public List<hpr_sch_tp> getSchemeType(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "HST_CD";
                    break;
                case "Description":
                    searchFld = "HST_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<hpr_sch_tp> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search.ToUpper();
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "sp_search_schemetype", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<hpr_sch_tp>(_dtResults, hpr_sch_tp.webConverter);
            }
            return emp;
        }

        //dilshan 28/09/2017
        public List<hpr_sch_det> getScheme(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "HSD_CD";
                    break;
                case "Description":
                    searchFld = "HSD_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<hpr_sch_det> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search.ToUpper();
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "sp_search_scheme", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<hpr_sch_det>(_dtResults, hpr_sch_det.webConverter);
            }
            return emp;
        }
        public List<EMP_SEARCH_HEAD_SCM> getEmployeeCatSCM(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Category":
                    searchFld = "MEMP_CAT_SUBCD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<EMP_SEARCH_HEAD_SCM> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_EMPLOYEECATSCM", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<EMP_SEARCH_HEAD_SCM>(_dtResults, EMP_SEARCH_HEAD_SCM.Converter2);
            }
            return emp;
        }
        //SUBODANA
        public List<mst_fleet_search_head> getFleetDetails(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Reg No":
                    searchFld = "MSTF_REGNO";
                    break;
                case "Vehicle Type":
                    searchFld = "MSTF_VEH_TP";
                    break;
                case "Model":
                    searchFld = "MSTF_MODEL";
                    break;
                case "Owner Contact":
                    searchFld = "MSTF_OWN_CONT";
                    break;
                case "Owner":
                    searchFld = "MSTF_OWN_NM";
                    break;
                case "Brand":
                    searchFld = "MSTF_BRD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<mst_fleet_search_head> fleet = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_FLEETDETAILS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                fleet = DataTableExtensions.ToGenericList<mst_fleet_search_head>(_dtResults, mst_fleet_search_head.Converter);
            }
            return fleet;
        }
        //SUBODANA
        public List<MST_SER_PROVIDER_SEARCH_HEAD> getServiceProviderDetails(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Company":
                    searchFld = "MSP_COM";
                    break;
                case "Category":
                    searchFld = "MSP_CATE";
                    break;
                case "Code":
                    searchFld = "MSP_CD";
                    break;
                case "Description":
                    searchFld = "MSP_DESC";
                    break;
                case "Status":
                    searchFld = "MSP_ACT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_SER_PROVIDER_SEARCH_HEAD> insby = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_SERVICEPROVIDER", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                insby = DataTableExtensions.ToGenericList<MST_SER_PROVIDER_SEARCH_HEAD>(_dtResults, MST_SER_PROVIDER_SEARCH_HEAD.Converter);
            }
            return insby;
        }
        /*Lakshan 11-Feb-2016*/
        public DataTable GetItemBinSearchData(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //Set relavant parameters according to the,search catergory.

            //Modify parameter values for LIKE search.
            //searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            //searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            //searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            //searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            //searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            //searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            //searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6].ToUpper() + "%") : "%";
            //searchParams[7] = (searchParams[7] != "" || searchParams[7] != null) ? (searchParams[7].ToUpper() + "%") : "%";
            //searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper() + "%") : "%";
            //searchParams[9] = (searchParams[9] != "" || searchParams[9] != null) ? (searchParams[9]) : "%";
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper()) : "";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper()) : "";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper()) : "";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper()) : "";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper()) : "";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper()) : "";
            searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6].ToUpper()) : "";
            searchParams[7] = (searchParams[7] != "" || searchParams[7] != null) ? (searchParams[7].ToUpper()) : "";
            searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper()) : "";
            searchParams[9] = (searchParams[9] != "" || searchParams[9] != null) ? (searchParams[9]) : "";

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[6] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];

            (param[7] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[7];
            (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[9];
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];

            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            //_dtResults = QueryDataTable("tblZID", "pkg_search.sp_search_item_bin_data", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tblZID", "sp_search_item_bin_data", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Sahan 12 Feb 2016
        public DataTable LoadColours()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_clr", "pkg_general.sp_load_colours", CommandType.StoredProcedure, false, param);
        }

        ////Sahan 12 Feb 2016
        //public DataTable LoadColours()
        //{
        //    OracleParameter[] param = new OracleParameter[1];
        //    param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

        //    return QueryDataTable("dtGrade", "pkg_search.sp_get_mst_grade", CommandType.StoredProcedure, false, param);
        //}
        public List<MST_BANKACC_SEARCH_HEAD> getDepositedBanks(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Account Code":
                    searchFld = "MSBA_ACC_CD";
                    break;
                case "Description":
                    searchFld = "MSBA_ACC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_BANKACC_SEARCH_HEAD> emp = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_BANKACCOUNTS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<MST_BANKACC_SEARCH_HEAD>(_dtResults, MST_BANKACC_SEARCH_HEAD.Converter);
            }
            return emp;
        }
        //Lakshan 15 Feb 2016
        public DataTable SearchMstGradeTypes(GradeMaster obj)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mg_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Mg_com;
            (param[1] = new OracleParameter("p_mg_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Mg_chnl;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_get_mst_grade", CommandType.StoredProcedure, false, param);
        }

        public List<MST_BUSCOM_BANK_SEARCH_HEAD> getBusComBanks(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MBI_CD";
                    break;
                case "Description":
                    searchFld = "MBI_DESC";
                    break;
                case "Id":
                    searchFld = "MBI_ID";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_BUSCOM_BANK_SEARCH_HEAD> busCom = new List<MST_BUSCOM_BANK_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_BUSCOMBANKACCOUNTS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                busCom = DataTableExtensions.ToGenericList<MST_BUSCOM_BANK_SEARCH_HEAD>(_dtResults, MST_BUSCOM_BANK_SEARCH_HEAD.Converter);
            }
            return busCom;
        }

        public List<MST_BUSCOM_BANKBRANCH_SEARCH_HEAD> getBoscomBankBranchs(string bankcd, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MBB_CD";
                    break;
                case "Description":
                    searchFld = "MBB_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_BUSCOM_BANKBRANCH_SEARCH_HEAD> busComBranch = new List<MST_BUSCOM_BANKBRANCH_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bankcd;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_BUSCOMBANKBRANCHES", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                busComBranch = DataTableExtensions.ToGenericList<MST_BUSCOM_BANKBRANCH_SEARCH_HEAD>(_dtResults, MST_BUSCOM_BANKBRANCH_SEARCH_HEAD.Converter);
            }
            return busComBranch;
        }

        //Lakshan 2016-02-16
        public DataTable SearchOperation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string cd = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        cd = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            cd = (cd != null) ? (cd.ToUpper() + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mso_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_mso_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            (param[2] = new OracleParameter("p_mso_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_get_operation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Nuwan 2016/02/17
        public List<MST_ADVAN_REF_SEARCH_HEAD> getAdvanceRerference(string company, string cusCd, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Receipt No":
                    searchFld = "SAR_RECEIPT_NO";
                    break;
                case "Receipt Ref":
                    searchFld = "SAR_MANUAL_REF_NO";
                    break;
                case "Ref":
                    searchFld = "SAR_ANAL_3";
                    break;
                case "Balancce Amt":
                    searchFld = "SAR_USED_AMT";
                    break;
                case "Customer":
                    searchFld = "SAR_DEBTOR_CD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_ADVAN_REF_SEARCH_HEAD> advRef = new List<MST_ADVAN_REF_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cuscd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cusCd;
            (param[6] = new OracleParameter("p_recetype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "ADVAN";
            (param[7] = new OracleParameter("p_debcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "CASH";
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblAdvRef", "SP_SEARCH_ADVANREFERENCES", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                advRef = DataTableExtensions.ToGenericList<MST_ADVAN_REF_SEARCH_HEAD>(_dtResults, MST_ADVAN_REF_SEARCH_HEAD.Converter);
            }
            return advRef;
        }

        public List<MST_CREDIT_NOTE_REF_SEARCH_HEAD> getCredNoteRerference(string customer, string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Invoice":
                    searchFld = "SAH_INV_NO";
                    break;
                case "Manual Ref":
                    searchFld = "SAH_MAN_REF";
                    break;
                case "Base No":
                    searchFld = "SAH_REF_DOC";
                    break;
                case "Credit Amt":
                    searchFld = "CREDIT_AMT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CREDIT_NOTE_REF_SEARCH_HEAD> advRef = new List<MST_CREDIT_NOTE_REF_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            (param[6] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            (param[7] = new OracleParameter("p_waveoffval", OracleDbType.Int32, null, ParameterDirection.Input)).Value = vaweOffVal(company);
            (param[8] = new OracleParameter("p_stat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "C";
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblAdvRef", "SP_SEARCH_CREDNOTEREFERENCES", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                advRef = DataTableExtensions.ToGenericList<MST_CREDIT_NOTE_REF_SEARCH_HEAD>(_dtResults, MST_CREDIT_NOTE_REF_SEARCH_HEAD.Converter);
            }
            return advRef;
        }
        public int vaweOffVal(string company)
        {

            int vaweOff = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_GET_WAVEOFFVAL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0 && _dtResults.Rows[0]["MC_WAVEOFF_VAL"].ToString() != "")
            {
                vaweOff = Convert.ToInt32(_dtResults.Rows[0]["MC_WAVEOFF_VAL"].ToString());
            }
            return vaweOff;
        }

        public List<MST_LOYALTYCARD_SEARCH_HEAD> getLoyaltyCard(string customer, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Card No":
                    searchFld = "SALCM_NO";
                    break;
                case "Serial":
                    searchFld = "SALCM_CD_SER";
                    break;
                case "Type":
                    searchFld = "SALCM_LOTY_TP";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_LOYALTYCARD_SEARCH_HEAD> loyCd = new List<MST_LOYALTYCARD_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblLoyCd", "SP_SEARCH_LOYALTYCARD", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                loyCd = DataTableExtensions.ToGenericList<MST_LOYALTYCARD_SEARCH_HEAD>(_dtResults, MST_LOYALTYCARD_SEARCH_HEAD.Converter);
            }
            return loyCd;
        }

        //Lakshan 24/Feb/2016
        public DataTable SearchRefLocCate1()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_search_ref_loc_cate1", CommandType.StoredProcedure, false, param);
        }

        //Lakshan 24/Feb/2016
        public DataTable SearchMstChnl(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string cd = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        cd = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            cd = (cd != null) ? (cd.ToUpper() + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_msc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_msc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            (param[2] = new OracleParameter("p_msc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            (param[3] = new OracleParameter("p_msc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_search_mst_chnl", CommandType.StoredProcedure, false, param);
        }

        //Lakshan 24/Feb/2016
        public DataTable SearchRefLocCate3(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string cd = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        cd = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            cd = (cd != null) ? (cd.ToUpper() + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_rlc3_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_rlc3_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            (param[2] = new OracleParameter("p_rlc3_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            (param[3] = new OracleParameter("p_rlc3_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_search_ref_loc_cate3", CommandType.StoredProcedure, false, param);
        }

        public List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD> getTransportEnqiurySearch(string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Enquiry Id":
                    searchFld = "GCE_ENQ_ID";
                    break;
                case "Ref Num":
                    searchFld = "GCE_REF";
                    break;
                case "Type":
                    searchFld = "GCE_ENQ_TP";
                    break;
                case "Customer Code":
                    searchFld = "GCE_CUS_CD";
                    break;
                case "Name":
                    searchFld = "GCE_NAME";
                    break;
                case "Address":
                    searchFld = "GCE_ADD1";
                    break;
                case "NIC":
                    searchFld = "GCE_NIC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD> enq = new List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_proCen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblenq", "SP_SEARCH_TRANSPORTENQUIRY", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                enq = DataTableExtensions.ToGenericList<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD>(_dtResults, MST_TRANSPORT_ENQUIRY_SEARCH_HEAD.Converter);
            }
            return enq;
        }

        public List<MST_CHARG_CODE_SEARCH_HEAD> getChargCodeList(string company, string category, string pgeNum, string pgeSize, string searchFld, string searchVal, string pc)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "STC_CD";
                    break;
                case "Description":
                    searchFld = "STC_DESC";
                    break;
                case "Service By":
                    searchFld = "SERVICE_PROVIDER_DESC";
                    break;
                case "From":
                    searchFld = "STC_FRM";
                    break;
                case "To":
                    searchFld = "STC_TO";
                    break;
                case "Rate":
                    searchFld = "STC_RT";
                    break;
                case "Class":
                    searchFld = "STC_CLS";
                    break;
                case "Vehicle":
                    searchFld = "STC_VEH_TP";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHARG_CODE_SEARCH_HEAD> crg = new List<MST_CHARG_CODE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;
            (param[6] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_CHARGCODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHARG_CODE_SEARCH_HEAD>(_dtResults, MST_CHARG_CODE_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        //Lakshan 26/Feb/2016
        public DataTable SearchDocPriceDefDocTp(PriceDefinitionRef _def, string _searchCatergory, string _searchText)
        {
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE TYPE":
                        _def.Sadd_doc_tp = _searchText.ToUpper() + "%";
                        break;
                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_p_lvl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_com;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_pb;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_search_doc_price_def_doc_tp", CommandType.StoredProcedure, false, param);
        }
        //Lakshan 26/Feb/2016
        public DataTable SearchDocPriceDefPrBook(PriceDefinitionRef _def, string _searchCatergory, string _searchText)
        {
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE BOOK":
                        _def.Sadd_pb = _searchText.ToUpper() + "%";
                        break;
                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_p_lvl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_com;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_pb;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_search_doc_pri_def_pr_book", CommandType.StoredProcedure, false, param);
        }
        //Lakshan 26/Feb/2016
        public DataTable SearchDocPriceDefPrLVL(PriceDefinitionRef _def, string _searchCatergory, string _searchText)
        {
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PRICE LEVEL":
                        _def.Sadd_p_lvl = _searchText.ToUpper() + "%";
                        break;
                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_pc;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_doc_tp;
            (param[2] = new OracleParameter("p_p_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_p_lvl;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_com;
            (param[4] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _def.Sadd_pb;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dtGrade", "pkg_search_imp.sp_search_doc_pri_def_PR_LVL", CommandType.StoredProcedure, false, param);
        }
        public List<MST_COUNTRY_SEARCH> getCountry(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MCU_CD";
                    break;
                case "Description":
                    searchFld = "MCU_DESC";
                    break;
                case "Region Code":
                    searchFld = "MCU_REGION_CD";
                    break;
                case "Capital":
                    searchFld = "MCU_CAPITAL";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_COUNTRY_SEARCH> crg = new List<MST_COUNTRY_SEARCH>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_COUNTRY_EQ", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_COUNTRY_SEARCH>(_dtResults, MST_COUNTRY_SEARCH.Converter);
            }
            return crg;
        }

        //Lakshan 02 Mar 2016
        public DataTable SearchMainItemsData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Cate = null;
            string Model = null;
            string Brand = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Item = _searchText + "%";
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText + "%";
                        break;

                    case "MAIN CATEGORY":
                        Cate = _searchText + "%";
                        break;
                    case "MODEL":
                        Model = _searchText + "%";
                        break;
                    case "BRAND":
                        Brand = _searchText + "%";
                        break;

                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Cate = (Cate != null) ? (Cate.ToUpper()) : null;
            Model = (Model != null) ? (Model.ToUpper()) : null;
            Brand = (Brand != null) ? (Brand.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[1] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[2] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cate;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[5] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[6] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;

            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "pkg_search_imp.SP_SEARCH_MAIN_ITEM_DATA", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Randima 19/Oct/2016

        public DataTable SearchMainItemsDataSplit(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Cate = null;
            string Model = null;
            string Brand = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Item = _searchText + "%";
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText + "%";
                        break;

                    case "MAIN CATEGORY":
                        Cate = _searchText + "%";
                        break;
                    case "MODEL":
                        Model = _searchText + "%";
                        break;
                    case "BRAND":
                        Brand = _searchText + "%";
                        break;

                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Cate = (Cate != null) ? (Cate.ToUpper()) : null;
            Model = (Model != null) ? (Model.ToUpper()) : null;
            Brand = (Brand != null) ? (Brand.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[1] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[2] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cate;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[5] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[6] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;

            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "SP_SEARCH_MAIN_ITEM_DATA_SPLIT", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 02 Mar 2016
        public DataTable SearchMainItemsSer(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Cate = null;
            string Model = null;
            string Brand = null;
            string Serial = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Item = _searchText + "%";
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText + "%";
                        break;

                    case "MAIN CATEGORY":
                        Cate = _searchText + "%";
                        break;
                    case "MODEL":
                        Model = _searchText + "%";
                        break;
                    case "BRAND":
                        Brand = _searchText + "%";
                        break;
                    case "SERIAL #":
                        Serial = _searchText + "%";
                        break;
                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Cate = (Cate != null) ? (Cate.ToUpper()) : null;
            Model = (Model != null) ? (Model.ToUpper()) : null;
            Brand = (Brand != null) ? (Brand.ToUpper()) : null;
            Serial = (Serial != null) ? (Serial) : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[1] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[2] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cate;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[5] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[6] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
            (param[7] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Serial;

            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "pkg_search_imp.SP_SEARCH_MAIN_ITEM_SER", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MST_CHARG_CODE_AIRTVL_SEARCH_HEAD> getChargCodeListArrival(string company, string category, string pgeNum, string pgeSize, string searchFld, string searchVal, string pc)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "SAC_CD";
                    break;
                case "Description":
                    searchFld = "SAC_TIC_DESC";
                    break;
                case "Additional":
                    searchFld = "SAC_ADD_DESC";
                    break;
                case "Service By":
                    searchFld = "SERVICE_PROVIDER_DESC";
                    break;
                case "From":
                    searchFld = "SAC_FROM";
                    break;
                case "To":
                    searchFld = "SAC_TO";
                    break;
                case "Rate":
                    searchFld = "SAC_RT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHARG_CODE_AIRTVL_SEARCH_HEAD> crg = new List<MST_CHARG_CODE_AIRTVL_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;
            (param[6] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_CHARGCODEAIRTVL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHARG_CODE_AIRTVL_SEARCH_HEAD>(_dtResults, MST_CHARG_CODE_AIRTVL_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD> getChargCodeListMsclens(string company, string category, string pgeNum, string pgeSize, string searchFld, string searchVal, string pc)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "SSM_CD";
                    break;
                case "Description":
                    searchFld = "SSM_DESC";
                    break;
                case "Service By":
                    searchFld = "SERVICE_PROVIDER_DESC";
                    break;
                case "From Date":
                    searchFld = "SSM_FRM_DT";
                    break;
                case "To Date":
                    searchFld = "SSM_TO_DT";
                    break;
                case "Rate":
                    searchFld = "SSM_RT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD> crg = new List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;
            (param[6] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_CHARGCODEMSCELNS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD>(_dtResults, MST_CHARG_CODE_MSCELNS_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_RECEIPT_TYPE_SEARCH_HEAD> getReceiptTypes(string company, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Type":
                    searchFld = "MSRT_CD";
                    break;
                case "Description":
                    searchFld = "MSRT_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_RECEIPT_TYPE_SEARCH_HEAD> crg = new List<MST_RECEIPT_TYPE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_RECEIPTTYPE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_RECEIPT_TYPE_SEARCH_HEAD>(_dtResults, MST_RECEIPT_TYPE_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_DIVISION_SEARCH_HEAD> getDivisions(string company, string profCen, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MSRD_CD";
                    break;
                case "Description":
                    searchFld = "MSRD_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_DIVISION_SEARCH_HEAD> crg = new List<MST_DIVISION_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profCen;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_DIVISION", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_DIVISION_SEARCH_HEAD>(_dtResults, MST_DIVISION_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_OUTSTANDING_INVOICE_SEARCH_HEAD> getOutstandingInvoice(string company, string profCen, string cusCd, string othText, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Invoice":
                    searchFld = "SIH_INV_NO";
                    break;
                case "Reference":
                    searchFld = "SIH_MAN_REF";
                    break;
                case "Balance":
                    searchFld = "SIH_BALANCE";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_OUTSTANDING_INVOICE_SEARCH_HEAD> crg = new List<MST_OUTSTANDING_INVOICE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profCen;
            (param[6] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cusCd;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_OUTSTANGINGINVOICE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_OUTSTANDING_INVOICE_SEARCH_HEAD>(_dtResults, MST_OUTSTANDING_INVOICE_SEARCH_HEAD.Converter);
            }
            return crg;
        }
        public List<MST_OUTSTANDING_INVOICE_SEARCH_HEAD> getOutstandingInvoice2(string company, string profCen, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Invoice":
                    searchFld = "SIH_INV_NO";
                    break;
                case "Reference":
                    searchFld = "SIH_MAN_REF";
                    break;
                case "Balance":
                    searchFld = "SIH_BALANCE";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_OUTSTANDING_INVOICE_SEARCH_HEAD> crg = new List<MST_OUTSTANDING_INVOICE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profCen;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_OUTSTANGINGINVOICE2", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_OUTSTANDING_INVOICE_SEARCH_HEAD>(_dtResults, MST_OUTSTANDING_INVOICE_SEARCH_HEAD.Converter);
            }
            return crg;
        }
        public List<MST_PROF_CEN_SEARCH_HEAD> getAllProfitCenters(string company, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MPC_CD";
                    break;
                case "Description":
                    searchFld = "MPC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_PROF_CEN_SEARCH_HEAD> crg = new List<MST_PROF_CEN_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_PROFITCENTERSBYCOM", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_PROF_CEN_SEARCH_HEAD>(_dtResults, MST_PROF_CEN_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_GIFTVOUCHER_ISSSUE_SEARCH_HEAD> getGVISUVouchers(string company, string type, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Item":
                    searchFld = "MI_CD";
                    break;
                case "Description":
                    searchFld = "MI_LONGDESC";
                    break;
                case "Model":
                    searchFld = "MI_MODEL";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_GIFTVOUCHER_ISSSUE_SEARCH_HEAD> crg = new List<MST_GIFTVOUCHER_ISSSUE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[6] = new OracleParameter("p_cmpnum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mcIsComItem(company);
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_GIFTVOUCHERITMBYTYPE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_GIFTVOUCHER_ISSSUE_SEARCH_HEAD>(_dtResults, MST_GIFTVOUCHER_ISSSUE_SEARCH_HEAD.Converter);
            }
            return crg;
        }
        public Int32 mcIsComItem(string company)
        {

            OracleParameter[] param = new OracleParameter[2];
            Int32 loyCus = 0;
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_CHECK_IS_CMPITM", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                loyCus = Convert.ToInt32(_dtResults.Rows[0]["mc_is_com_itm"].ToString());
            }
            return loyCus;

        }

        public List<MST_RECEIPT_SEARCH_HEAD> getReceiptEntries(string company, string profCen, DateTime _fromDate, DateTime _toDate, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Doc No":
                    searchFld = "SIR_RECEIPT_NO";
                    break;
                case "Ref No":
                    searchFld = "SIR_MANUAL_REF_NO";
                    break;
                case "Oth Ref No":
                    searchFld = "SIR_ANAL_3";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_RECEIPT_SEARCH_HEAD> crg = new List<MST_RECEIPT_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profCen;
            (param[6] = new OracleParameter("p_frmdte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[7] = new OracleParameter("p_todte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_RECEIPTDETAILS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_RECEIPT_SEARCH_HEAD>(_dtResults, MST_RECEIPT_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_RECEIPT_SEARCH_HEAD> getUnallowReceiptEntries(string company, string profCen, DateTime _fromDate, DateTime _toDate, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Doc No":
                    searchFld = "SIR_RECEIPT_NO";
                    break;
                case "Ref No":
                    searchFld = "SIR_MANUAL_REF_NO";
                    break;
                case "Oth Ref No":
                    searchFld = "SIR_ANAL_3";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_RECEIPT_SEARCH_HEAD> crg = new List<MST_RECEIPT_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profCen;
            (param[6] = new OracleParameter("p_frmdte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[7] = new OracleParameter("p_todte", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_UNALRECEIPTDETAILS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_RECEIPT_SEARCH_HEAD>(_dtResults, MST_RECEIPT_SEARCH_HEAD.Converter);
            }
            return crg;
        }


        //Lakshan 2016 Mar 18
        public DataTable GetBlItmByDocNo(string _docNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ibi_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_imports_Enquiry.sp_get_bl_by_bl_itm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<MST_CHANNEL_SEARCH_HEAD> getChannels(string company, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MPI_VAL";
                    break;
                case "Description":
                    searchFld = "MSC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHANNEL_SEARCH_HEAD> crg = new List<MST_CHANNEL_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "CHNL";
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_CHANNEL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHANNEL_SEARCH_HEAD>(_dtResults, MST_CHANNEL_SEARCH_HEAD.Converter);
            }
            return crg;
        }
        public List<MST_SUBCHANNEL_SEARCH_HEAD> getSubChannels(string channel, string company, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MPI_VAL";
                    break;
                case "Description":
                    searchFld = "MSC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_SUBCHANNEL_SEARCH_HEAD> crg = new List<MST_SUBCHANNEL_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "CHNL";
            (param[6] = new OracleParameter("p_type1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "SCHNL";
            (param[7] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_SUBCHANNEL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_SUBCHANNEL_SEARCH_HEAD>(_dtResults, MST_SUBCHANNEL_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_SERVICE_CODE_SEARCH_HEAD> getServiceCodes(string company, string profcen, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "MCC_CD";
                    break;
                case "Description":
                    searchFld = "MCC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_SERVICE_CODE_SEARCH_HEAD> crg = new List<MST_SERVICE_CODE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profcen;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_SERVICECODES", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_SERVICE_CODE_SEARCH_HEAD>(_dtResults, MST_SERVICE_CODE_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_COST_SHEET_SEARCH_HEAD> getCoseSheets(string company, string profcen, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Cost Sheet No":
                    searchFld = "QCH_COST_NO";
                    break;
                case "Ref":
                    searchFld = "QCH_REF";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_COST_SHEET_SEARCH_HEAD> crg = new List<MST_COST_SHEET_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_profcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profcen;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_COSTSHEET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_COST_SHEET_SEARCH_HEAD>(_dtResults, MST_COST_SHEET_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        //Lakshan 02 Mar 2016
        public DataTable SearchMainItemsComp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Brand = null;
            string Model = null;
            string Part = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        Item = _searchText + "%";
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText + "%";
                        break;

                    case "BRAND":
                        Brand = _searchText + "%";
                        break;
                    case "MODEL":
                        Model = _searchText + "%";
                        break;
                    case "PART #":
                        Part = _searchText + "%";
                        break;

                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? Desc : null;
            Brand = (Brand != null) ? (Brand.ToUpper()) : null;
            Model = (Model != null) ? (Model.ToUpper()) : null;
            Part = (Part != null) ? (Part.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_mi_purcom_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[2] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[3] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;
            (param[4] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[5] = new OracleParameter("p_mi_part_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Part;

            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "pkg_search_imp.sp_se_mst_itm_comp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana
        public List<MST_CURRENCY_SEARCH_HEAD> GetAllCurrencyNew(string company, string profCen, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Currency Code":
                    searchFld = "MCR_CD";
                    break;
                case "Currency Description":
                    searchFld = "MCR_DESC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CURRENCY_SEARCH_HEAD> crg = new List<MST_CURRENCY_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_CURRENCY_NEW", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CURRENCY_SEARCH_HEAD>(_dtResults, MST_CURRENCY_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_COMPANIES_SEARCH_HEAD> GetLogCompanies(string company, string type, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Company":
                    searchFld = "MFB_FACCOM";
                    break;
                case "PC":
                    searchFld = "MFB_FACPC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_COMPANIES_SEARCH_HEAD> crg = new List<MST_COMPANIES_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_COMPANIES", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_COMPANIES_SEARCH_HEAD>(_dtResults, MST_COMPANIES_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_LOGSHEET_SEARCH_HEAD> GetLogSheets(string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Log Number":
                    searchFld = "TLH_LOG_NO";
                    break;
                case "Enquiry":
                    searchFld = "TLH_REQ_NO";
                    break;
                case "Customer":
                    searchFld = "TLH_CUS_CD";
                    break;
                case "Driver":
                    searchFld = "TLH_DRI_CD";
                    break;
                case "Vehicle":
                    searchFld = "TLH_FLEET";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_LOGSHEET_SEARCH_HEAD> crg = new List<MST_LOGSHEET_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_LOGSHEETHED", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_LOGSHEET_SEARCH_HEAD>(_dtResults, MST_LOGSHEET_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_ENQUIRY_SEARCH_HEAD> GetLogEnquiries(string company, string userDefPro, string type, string stage, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Enquiry":
                    searchFld = "GCE_ENQ_ID";
                    break;
                case "Refference Num":
                    searchFld = "GCE_REF";
                    break;
                case "Customer Code":
                    searchFld = "GCE_CUS_CD";
                    break;
                case "Name":
                    searchFld = "GCE_NAME";
                    break;
                case "Address":
                    searchFld = "GCE_ADD1";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_ENQUIRY_SEARCH_HEAD> crg = new List<MST_ENQUIRY_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            (param[6] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[7] = new OracleParameter("p_stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stage;
            (param[8] = new OracleParameter("p_regex", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "[^,]+";
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_ENQUIRYWITHSTAGE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_ENQUIRY_SEARCH_HEAD>(_dtResults, MST_ENQUIRY_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        public List<MST_EMPLOYEE_SEARCH_HEAD> GetLogDrivers(string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Epf No":
                    searchFld = "MEMP_EPF";
                    break;
                case "Category":
                    searchFld = "MEMP_CAT_SUBCD";
                    break;
                case "First Name":
                    searchFld = "MEMP_FIRST_NAME";
                    break;
                case "Last Name":
                    searchFld = "MEMP_LAST_NAME";
                    break;
                case "NIC":
                    searchFld = "MEMP_NIC";
                    break;
                case "MOBILE":
                    searchFld = "MEMP_MOBI_NO";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_EMPLOYEE_SEARCH_HEAD> emp = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_TOURDRIVERS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                emp = DataTableExtensions.ToGenericList<MST_EMPLOYEE_SEARCH_HEAD>(_dtResults, MST_EMPLOYEE_SEARCH_HEAD.Converter);
            }
            return emp;
        }

        public List<mst_fleet_search_head> GetLogVehicles(string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Reg No":
                    searchFld = "MSTF_REGNO";
                    break;
                case "Vehicle Type":
                    searchFld = "MSTF_VEH_TP";
                    break;
                case "Model":
                    searchFld = "MSTF_MODEL";
                    break;
                case "Owner Contact":
                    searchFld = "MSTF_OWN_CONT";
                    break;
                case "Owner":
                    searchFld = "MSTF_OWN_NM";
                    break;
                case "Brand":
                    searchFld = "MSTF_BRD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<mst_fleet_search_head> fleet = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_TOURFLEETS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                fleet = DataTableExtensions.ToGenericList<mst_fleet_search_head>(_dtResults, mst_fleet_search_head.Converter);
            }
            return fleet;
        }
        //Rukshan 11/Apr/2016
        public DataTable Get_Sales_Ex(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _epf = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;
                    case "EPF":
                        _epf = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : null;
            _locationDesc = (_locationDesc != null) ? (_locationDesc + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_empEpf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            (param[4] = new OracleParameter("p_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "pkg_search_imp.sp_search_Sales_Ex", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD> geTRANSEnqiurySearch(string company, string userDefPro, string type, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Enquiry Id":
                    searchFld = "GCE_ENQ_ID";
                    break;
                case "Ref Num":
                    searchFld = "GCE_REF";
                    break;
                case "Refference Num":
                    searchFld = "GCE_REF";
                    break;
                case "Customer Code":
                    searchFld = "GCE_CUS_CD";
                    break;
                case "Name":
                    searchFld = "GCE_NAME";
                    break;
                case "Address":
                    searchFld = "GCE_ADD1";
                    break;
                case "NIC":
                    searchFld = "GCE_NIC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD> enq = new List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_proCen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            (param[6] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblenq", "SP_SEARCH_TRANSENQUIRY", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                enq = DataTableExtensions.ToGenericList<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD>(_dtResults, MST_TRANSPORT_ENQUIRY_SEARCH_HEAD.Converter);
            }
            return enq;
        }

        //Common Search for customer according to the Sales Executive
        //Written By Rukshan on 12/Apr/2016
        public DataTable GetCustomerBYsalesExe(string _initialSearchParams, string _searchCatergory, string _searchText, string _returnCol, string _returnColDesc)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _address = null;
            string _city = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ADDRESS":
                        _address = _searchText;
                        break;

                    case "CITY":
                        _city = _searchText;
                        break;

                    case "NIC NO":
                        _code = _searchText;
                        break;

                    case "MOBILE NO":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _address = (_address != null) ? (_address.ToUpper() + "%") : null;
            _city = (_city != null) ? (_city.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_colname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _returnCol;
            (param[2] = new OracleParameter("p_coldescription", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _returnColDesc;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            (param[6] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _city;
            (param[7] = new OracleParameter("P_EXCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.sp_searchcustomerByExecu", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD> getAllEnquirySearch(string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Enquiry":
                    searchFld = "GCE_ENQ_ID";
                    break;
                case "Enquiry Id":
                    searchFld = "GCE_ENQ_ID";
                    break;
                case "Ref Num":
                    searchFld = "GCE_REF";
                    break;
                case "Refference Num":
                    searchFld = "GCE_REF";
                    break;
                case "Customer Code":
                    searchFld = "GCE_CUS_CD";
                    break;
                case "Name":
                    searchFld = "GCE_NAME";
                    break;
                case "Address":
                    searchFld = "GCE_ADD1";
                    break;
                case "NIC":
                    searchFld = "GCE_NIC";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD> enq = new List<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_proCen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblenq", "SP_SEARCH_ALLENQUIRY", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                enq = DataTableExtensions.ToGenericList<MST_TRANSPORT_ENQUIRY_SEARCH_HEAD>(_dtResults, MST_TRANSPORT_ENQUIRY_SEARCH_HEAD.Converter);
            }
            return enq;
        }
        //Lakshan 30 Apr 2016
        public DataTable SearchAdminTeam(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _decs = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _decs = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _decs = (_decs != null) ? (_decs.ToUpper() + "%") : null;
            _code = (_code != null) ? (_code + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_mso_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_mso_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_mso_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _decs;
            (param[3] = new OracleParameter("p_mso_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("mst_ope", "pkg_search_imp.sp_search_mst_ope", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 06 May 2016
        public DataTable SEARCH_INT_ADHOC_HDR(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string refNo = null;
            DateTime date = DateTime.MinValue;
            Int32 sts = -1;
            Int32 isDate = 0;
            string loc = null;
            string manual = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REFERENCE":
                        refNo = _searchText;
                        break;
                    case "DATE":
                        if (DateTime.TryParse(_searchText, out date))
                        {
                            date = Convert.ToDateTime(_searchText);
                            isDate = 1;
                        }
                        else
                        {
                            isDate = 0;
                        }
                        break;

                    case "STATUS":
                        if (_searchText == "%PENDING-P")
                        {
                            sts = 0;
                        }
                        else if (_searchText == "%APPROVED-A")
                        {
                            sts = 1;
                        }
                        else if (_searchText == "%REJECTED-R")
                        {
                            sts = 2;
                        }
                        else if (_searchText == "%CONFIRMED-C")
                        {
                            sts = 3;
                        }
                        break;
                    case "LOCATION":
                        loc = _searchText;
                        break;
                    case "MANUAL NO":
                        manual = _searchText;
                        break;
                    default:
                        break;
                }
            }
            refNo = (refNo != null) ? (refNo.ToUpper() + "%") : null;
            loc = (loc != null) ? (loc.ToUpper() + "%") : null;
            manual = (manual != null) ? (manual.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_iadh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_iadh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_iadh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_iadh_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            (param[4] = new OracleParameter("p_iadh_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[5] = new OracleParameter("p_iadh_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = sts;
            (param[6] = new OracleParameter("p_iadh_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            (param[7] = new OracleParameter("p_iadh_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = manual;
            (param[8] = new OracleParameter("p_is_date", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_ser_int_adhoc_hdr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //SUBODANA 2016-05-11
        public DataTable Get_Sar_Types(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code_;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "sp_search_Sar_types", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //ISURU
        public DataTable Get_Rcpt_Types(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code_;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc_;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "SP_COLLECT_RECPT_TYPES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        public DataTable Get_Sar_SubTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docType = null;
            string _docTypeDesc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docType = _searchText;
                        break;

                    case "DESCRIPTION":
                        _docTypeDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docType = (_docType != null) ? (_docType.ToUpper() + "%") : null;
            _docTypeDesc = (_docTypeDesc != null) ? (_docTypeDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_movtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_movsubtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            (param[2] = new OracleParameter("p_movsubtypedesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docTypeDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_search_sarsub_type", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public List<GEN_CUST_ENQ> GET_TOURS_ENQ(string company, string userDefPro, string pgeNum, string pgeSize, string searchFld, string searchVal, String Status)
        {
            string search = "";
            if (searchFld == "reqDte" || searchFld == "expDte")
            {
                search = (!string.IsNullOrEmpty(searchVal)) ? Convert.ToDateTime(searchVal).ToString("yyyy/MM/dd") : DateTime.MinValue.ToString("yyyy/MM/dd");
            }
            else
            {
                search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            }

            switch (searchFld)
            {
                case "SysId":
                    searchFld = "GCE_ENQ_ID";
                    break;
                case "CusId":
                    searchFld = "GCE_CUS_CD";
                    break;
                case "Name":
                    searchFld = "GCE_NAME";
                    break;
                case "Mob":
                    searchFld = "GCE_MOB";
                    break;
                case "reqDte":
                    searchFld = "GCE_DT";
                    break;
                case "expDte":
                    searchFld = "GCE_EXPECT_DT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<GEN_CUST_ENQ> enq = new List<GEN_CUST_ENQ>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_proCen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblenq", "SP_SEARCH_ENQTOURS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                enq = DataTableExtensions.ToGenericList<GEN_CUST_ENQ>(_dtResults, GEN_CUST_ENQ.ConverterEnqtour);
            }
            return enq;
        }
        public List<MST_PROFIT_CENTER_SEARCH_HEAD> getUserProfitCenters(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string userId)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "mpc_cd";
                    break;
                case "Description":
                    searchFld = "mpc_desc";
                    break;
                case "Address":
                    searchFld = "mpc_add1";
                    break;
                case "Chanel":
                    searchFld = "mpc_chnl";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_PROFIT_CENTER_SEARCH_HEAD> profCenters = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_USERPROCEN", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                profCenters = DataTableExtensions.ToGenericList<MST_PROFIT_CENTER_SEARCH_HEAD>(_dtResults, MST_PROFIT_CENTER_SEARCH_HEAD.Converter);
            }
            return profCenters;
        }

        //Subodana 2016-05-20

        public DataTable Get_BondNumber(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            _searchText = (_searchText != null) ? (_searchText.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "SP_GET_BOND_NO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Subodana 2016-05-20

        public DataTable Get_GrnNumber(string com, string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            _searchText = (_searchText != null) ? (_searchText.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "SP_GET_GRN_NO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2016-05-20
        public DataTable Get_ReqNumber(string com, string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            _searchText = (_searchText != null) ? (_searchText.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "SP_GET_REQ_NO", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //subodana 2016-05-20
        public DataTable Get_OtherLoc(string com, string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            _searchText = (_searchText != null) ? (_searchText.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "SP_GET_Other_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2016-05-20
        public DataTable Get_Operationteam(string com, string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            _searchText = (_searchText != null) ? (_searchText.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "SP_GET_OPERCODE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MST_FAC_LOC_SEARCH_HEAD> getFacLocation(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string pc)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "FAC_CODE";
                    break;
                case "Description":
                    searchFld = "FAC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;
            }
            List<MST_FAC_LOC_SEARCH_HEAD> townlist = new List<MST_FAC_LOC_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbltOWN", "SP_SEARCH_FACLOCATIONS", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                townlist = DataTableExtensions.ToGenericList<MST_FAC_LOC_SEARCH_HEAD>(_dtResults, MST_FAC_LOC_SEARCH_HEAD.Converter);
            }
            return townlist;
        }


        //SUBODANA 2016-05-25
        public DataTable Get_Color_All(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _descrip = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _descrip = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _descrip = (_descrip != null) ? (_descrip + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _descrip;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "sp_search_color_All", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2016-05-25
        public DataTable SearchApprovedDocNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCNO":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.

            _code = (_code != null) ? (_code + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("mst_ope", "sp_search_approvedoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //SUBODANA 2016-05-25
        public DataTable Get_ReqApprType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _type = null;
            string _descrip = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _type = _searchText;
                        break;

                    case "DESCRIPTION":
                        _descrip = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _type = (_type != null) ? (_type.ToUpper() + "%") : null;
            _descrip = (_descrip != null) ? (_descrip + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _descrip;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "sp_search_request_app_type", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 25 May 2016
        public DataTable SearchInrBinLoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Code = null;
            string Desc = null;
            string Loc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Code = _searchText + "%";
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText + "%";
                        break;

                    case "LOCATION":
                        Loc = _searchText + "%";
                        break;

                    default:
                        break;
                }
            }

            Code = (Code != null) ? (Code.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Loc = (Loc != null) ? (Loc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ibl_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ibl_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ibl_bin_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Code;
            (param[3] = new OracleParameter("p_ibl_bin_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;

            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("inr_bin_loc", "pkg_search_imp.sp_search_inr_bin_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //subodana 2016-05-26
        public DataTable SearchLoadingPlace(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _place = null;
            _searchCatergory = _searchCatergory.ToUpper();
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LOADING PLACE":
                        _place = _searchText;
                        break;


                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _place = (_place != null) ? (_place + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_place", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _place;
            (param[2] = new OracleParameter("p_frmdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString(); ;
            (param[3] = new OracleParameter("p_todate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("mst_ope", "sp_search_loadingplace", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //subodana 2016-05-30
        public DataTable SearchStockDocNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _DOC = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "STOCK DOC":
                        _DOC = _searchText;
                        break;


                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _DOC = (_DOC != null) ? (_DOC + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("mst_ope", "sp_search_StockDoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //subodana 2016-05-30
        public DataTable SearchClompanyLocation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _loc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "LOCATION":
                        _loc = _searchText;
                        break;


                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _loc = (_loc != null) ? (_loc + "%") : null;

            //(  p_com in NVARCHAR2,p_empCateCode in NVARCHAR2,p_empEpf in NVARCHAR2,p_description in NVARCHAR2,c_data out SYS_REFCURSOR);

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("mst_ope", "sp_search_comlocation", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD> getOtherChargesForTransport(string service, string company, string pgeNum, string pgeSize, string searchFld, string searchVal, string userDefPro, string addedChgCd)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "SSM_CD";
                    break;
                case "Description":
                    searchFld = "SSM_DESC";
                    break;
                case "Service By":
                    searchFld = "SERVICE_PROVIDER_DESC";
                    break;
                case "From Date":
                    searchFld = "SSM_FRM_DT";
                    break;
                case "To Date":
                    searchFld = "SSM_TO_DT";
                    break;
                case "Rate":
                    searchFld = "SSM_RT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD> crg = new List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = service;
            (param[6] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = addedChgCd;
            (param[7] = new OracleParameter("p_parechg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_OTHCHARGCODEMSCELNS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD>(_dtResults, MST_CHARG_CODE_MSCELNS_SEARCH_HEAD.Converter);
            }
            return crg;
        }
        public List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD> getMescChargesWitoutParent(string service, string company, string pgeNum, string pgeSize, string searchFld, string searchVal, string userDefPro, string addedChgCd)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "SSM_CD";
                    break;
                case "Description":
                    searchFld = "SSM_DESC";
                    break;
                case "Service By":
                    searchFld = "SERVICE_PROVIDER_DESC";
                    break;
                case "From Date":
                    searchFld = "SSM_FRM_DT";
                    break;
                case "To Date":
                    searchFld = "SSM_TO_DT";
                    break;
                case "Rate":
                    searchFld = "SSM_RT";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD> crg = new List<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = service;
            (param[6] = new OracleParameter("p_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = addedChgCd;
            (param[7] = new OracleParameter("p_parechg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userDefPro;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_MESCWITHOUTOUTPARENT", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHARG_CODE_MSCELNS_SEARCH_HEAD>(_dtResults, MST_CHARG_CODE_MSCELNS_SEARCH_HEAD.Converter);
            }
            return crg;
        }
        //Lakshan 31 May 2016
        public DataTable SearchExchangeRateHistry(MasterExchangeRate busObj)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_mer_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = busObj.Mer_com;
            (param[1] = new OracleParameter("p_mer_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = busObj.Mer_cur;
            (param[2] = new OracleParameter("p_mer_to_cur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = busObj.Mer_to_cur;
            (param[3] = new OracleParameter("p_mer_vad_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = busObj.Mer_vad_from;
            (param[4] = new OracleParameter("p_mer_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = busObj.Mer_act;
            (param[5] = new OracleParameter("p_date_range", OracleDbType.Int32, null, ParameterDirection.Input)).Value = busObj.isDateRange;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("mst_exg_rate", "pkg_search_imp.sp_ser_mst_exg_rate", CommandType.StoredProcedure, false, param);
            return _tbl;

        }

        //Lakshan 04 Jun 2016
        public DataTable SER_REF_COND_TP(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _decs = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _decs = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _decs = (_decs != null) ? (_decs + "%") : null;
            _code = (_code != null) ? (_code + "%") : null;

            List<RepConditionType> _list = new List<RepConditionType>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_rct_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_rct_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_rct_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_rct_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _decs;
            (param[4] = new OracleParameter("p_rct_ini", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_ser_ref_cond_tp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-06-09*
        public DataTable SearchReversalInvoice(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;
            string _srn = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REVERSAL NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    case "SRN NO": _srn = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null && _invoice != "") ? (_invoice.ToUpper() + "%") : null;
            _manualrefno = (_manualrefno != null && _manualrefno != "") ? (_manualrefno.ToUpper() + "%") : null;
            _customer = (_customer != null && _customer != "") ? (_customer + "%") : null;
            _customername = (_customername != null && _customername != "") ? (_customername + "%") : null;
            _status = (_status != null && _status != "") ? (_status + "%") : null;
            _srn = (_srn != null && _srn != "") ? (_srn + "%") : null;
            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[8] = new OracleParameter("p_srn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _srn;
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (!string.IsNullOrEmpty(_invoice))
            {
                _dtResults = QueryDataTable("tblSearchInvoice", "SP_SEARCHREVERSALWEB", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tblSearchInvoice", "SP_SEARCHREVERSALINVOICE2", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }

        //subodana 2016-06-15
        public DataTable SearchFileNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _fileno = null;
            string _docno = null;
            string _blno = null;


            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "FILENO": _fileno = _searchText; break;
                    case "DOCNO": _docno = _searchText; break;
                    case "BLNO": _blno = _searchText; break;
                    default: break;
                }
            }

            _fileno = (_fileno != null) ? (_fileno.ToUpper() + "%") : "%";
            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : "%";
            _blno = (_blno != null) ? (_blno + "%") : "%";


            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_fileno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fileno;
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchfile", "sp_search_FileNo", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Lakshan 16 Jun 2016
        public DataTable SearchProfitCenterByUser(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _user = string.IsNullOrEmpty(searchParams[1].ToString()) ? null : searchParams[1].ToString();
            string _code = null;
            string _decs = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _decs = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _decs = (_decs != null) ? (_decs + "%") : null;
            _code = (_code != null) ? (_code + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_mpc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sup_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_mpc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_mpc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _decs;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_ser_sec_user_prof", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 16 Jun 2016
        public DataTable SearchUserLocationByUser(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _user = string.IsNullOrEmpty(searchParams[1].ToString()) ? null : searchParams[1].ToString();
            string _code = null;
            string _decs = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText.ToUpper();
                        break;

                    case "DESCRIPTION":
                        _decs = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _decs = (_decs != null) ? (_decs + "%") : null;
            _code = (_code != null) ? (_code + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_sel_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sel_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_sel_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_ml_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _decs;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_ser_sec_user_loc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan 2016-Jun-18
        public DataTable SearchCusdecHeaderForInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _othdoc = null;
            string _blno = null;
            string _Cus = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;

                    case "OTH DOC":
                        _othdoc = _searchText;
                        break;
                    case "BL NO":
                        _blno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper() + "%") : null;
            _blno = (_blno != null) ? (_blno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[3] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            (param[4] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            (param[5] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2].ToString());
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString());
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_ser_cusdec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 20 Jun 2016
        public DataTable SearchBLHeaderNew(string _initialSearchParams, string _searchCatergory, string _searchText, Int32 isDate, DateTime from, DateTime to)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            string BL = null;
            string Reff = null;
            string Remarks = null;
            string status = null;
            string loc = null;
            string cust = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC":
                        doc = _searchText;
                        break;

                    case "BL":
                        BL = _searchText;
                        break;
                    case "REFERENCE":
                        Reff = _searchText;
                        break;
                    case "REMARK":
                        Remarks = _searchText;
                        break;
                    case "STATUS":
                        status = _searchText;
                        break;
                    case "LOCATION":
                        loc = _searchText;
                        break;
                    case "CUSTOMER":
                        cust = _searchText;
                        break;

                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;
            BL = (BL != null) ? (BL.ToUpper() + "%") : null;
            Reff = (Reff != null) ? (Reff.ToUpper() + "%") : null;
            Remarks = (Remarks != null) ? (Remarks.ToUpper() + "%") : null;
            status = (status != null) ? (status.ToUpper() + "%") : null;
            loc = (loc != null) ? (loc.ToUpper() + "%") : null;
            cust = (cust != null) ? (cust.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_ISCUSDEC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[4] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            (param[5] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[6] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[7] = new OracleParameter("P_REFF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Reff;
            (param[8] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remarks;
            (param[9] = new OracleParameter("P_ISDate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            (param[10] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[11] = new OracleParameter("p_ib_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[12] = new OracleParameter("p_ib_supp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cust;
            param[13] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //_dtResults = QueryDataTable("tblsupplier", "pkg_search_imp.SP_SEACH_BL_HEAD", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("int_hdr", "pkg_search_imp.sp_seach_bl_head_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Randima 15 Jul 2016
        public DataTable SearchBLHeaderCosting(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime fromDate, DateTime toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            string BL = null;
            string Reff = null;
            string Remarks = null;
            string actualDt = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC":
                        doc = _searchText;
                        break;

                    case "BL #":
                        BL = _searchText;
                        break;
                    case "REFERENCE":
                        Reff = _searchText;
                        break;
                    case "REMARK":
                        Remarks = _searchText;
                        break;
                    case "ACTUAL DATE":
                        actualDt = _searchText;
                        break;

                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;
            BL = (BL != null) ? (BL.ToUpper() + "%") : null;
            Reff = (Reff != null) ? (Reff.ToUpper() + "%") : null;
            Remarks = (Remarks != null) ? (Remarks.ToUpper() + "%") : null;
            actualDt = (actualDt != null) ? (actualDt.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_DT_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[2] = new OracleParameter("P_DT_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            (param[3] = new OracleParameter("P_IS_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = 'I';
            (param[4] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "A";
            (param[5] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[6] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            (param[7] = new OracleParameter("P_REFF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Reff;
            (param[8] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remarks;
            (param[9] = new OracleParameter("P_ACTUAL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = actualDt;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("int_hdr", "pkg_search_imp.sp_seach_bl_head_cost", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        // Randima 25 Jul 2016
        public DataTable SearchItemGRN(string _searchCatergory, string _searchText, string _tp, string _PONo, string item)
        {
            DataTable _dtResults = null;

            string GRNNo = null;
            string date = null;
            string loc = null;
            string status = null;
            string unitCost = null;
            string qty = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "GRN #":
                        GRNNo = _searchText;
                        break;

                    case "DATE":
                        date = _searchText;
                        break;
                    case "LOCATION":
                        loc = _searchText;
                        break;
                    case "STATUS":
                        status = _searchText;
                        break;
                    case "UNIT COST":
                        loc = _searchText;
                        break;
                    case "QUANTITY":
                        qty = _searchText;
                        break;

                    default:
                        break;
                }
            }

            GRNNo = (GRNNo != null) ? (GRNNo.ToUpper() + "%") : null;
            date = (date != null) ? (date.ToUpper() + "%") : null;
            loc = (loc != null) ? (loc.ToUpper() + "%") : null;
            status = (status != null) ? (status.ToUpper() + "%") : null;
            unitCost = (unitCost != null) ? (unitCost.ToUpper() + "%") : null;
            int? qtyNo = (qty != null) ? Convert.ToInt32(qty) : (int?)null;


            OracleParameter[] param = new OracleParameter[10];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[1] = new OracleParameter("P_PO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[2] = new OracleParameter("P_GRN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = GRNNo;
            (param[3] = new OracleParameter("P_DATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = date;
            (param[4] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[5] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[6] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[7] = new OracleParameter("P_UNIT_COST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = unitCost;
            (param[8] = new OracleParameter("P_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = qtyNo;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "pkg_search_imp.sp_search_item_GRN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable SearchItemGRNnew(string _searchCatergory, string _searchText, string _tp, string _PONo, string item)
        {
            DataTable _dtResults = null;

            string GRNNo = null;
            string date = null;
            string loc = null;
            string status = null;
            string unitCost = null;
            string qty = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "GRN #":
                        GRNNo = _searchText;
                        break;

                    case "DATE":
                        date = _searchText;
                        break;
                    case "LOCATION":
                        loc = _searchText;
                        break;
                    case "STATUS":
                        status = _searchText;
                        break;
                    case "UNIT COST":
                        loc = _searchText;
                        break;
                    case "QUANTITY":
                        qty = _searchText;
                        break;

                    default:
                        break;
                }
            }

            GRNNo = (GRNNo != null) ? (GRNNo.ToUpper() + "%") : null;
            date = (date != null) ? (date.ToUpper() + "%") : null;
            loc = (loc != null) ? (loc.ToUpper() + "%") : null;
            status = (status != null) ? (status.ToUpper() + "%") : null;
            unitCost = (unitCost != null) ? (unitCost.ToUpper() + "%") : null;
            int? qtyNo = (qty != null) ? Convert.ToInt32(qty) : (int?)null;


            OracleParameter[] param = new OracleParameter[10];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[1] = new OracleParameter("P_PO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[2] = new OracleParameter("P_GRN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = GRNNo;
            (param[3] = new OracleParameter("P_DATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = date;
            (param[4] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[5] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[6] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[7] = new OracleParameter("P_UNIT_COST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = unitCost;
            (param[8] = new OracleParameter("P_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = qtyNo;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "sp_search_item_GRNNew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Randima 18 Jul 2016
        public DataTable SearchPurOrdCosting(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime fromDate, DateTime toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string PO = null;
            string Reff = null;
            string Remarks = null;
            string Dt = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PO #":
                        PO = _searchText;
                        break;

                    case "REFERENCE":
                        Reff = _searchText;
                        break;
                    case "REMARKS":
                        Remarks = _searchText;
                        break;
                    case "DATE":
                        Dt = _searchText;
                        break;

                    default:
                        break;
                }
            }

            PO = (PO != null) ? (PO.ToUpper() + "%") : null;
            Reff = (Reff != null) ? (Reff.ToUpper() + "%") : null;
            Remarks = (Remarks != null) ? (Remarks.ToUpper() + "%") : null;
            Dt = (Dt != null) ? (Dt.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = 'L';
            (param[2] = new OracleParameter("P_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = 'N';
            (param[3] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = 'A';
            (param[4] = new OracleParameter("P_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[5] = new OracleParameter("P_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            (param[6] = new OracleParameter("P_PO_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PO;
            (param[7] = new OracleParameter("P_REFF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Reff;
            (param[8] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remarks;
            (param[9] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Dt;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("int_hdr", "pkg_search.sp_search_PurchaseOrder_Cost", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Lakshan 21 Jun 2016
        public DataTable SearchCusdecReqNew(string _initialSearchParams, string _searchCatergory, string _searchText, Int32 isDate, DateTime from, DateTime to)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string reqNo = null;
            string reqDate = null;
            string tobondNo = null;
            string blNo = null;
            string sts = null;
            string cust = null;
            string loc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQ NO":
                        reqNo = _searchText;
                        break;
                    case "TOBOND NO":
                        tobondNo = _searchText;
                        break;
                    case "BL NO":
                        blNo = _searchText;
                        break;
                    case "STATUS":
                        sts = _searchText;
                        break;
                    case "LOCATION":
                        loc = _searchText;
                        break;
                    case "CUSTOMER":
                        cust = _searchText;
                        break;
                    default:
                        break;
                }
            }

            reqNo = (reqNo != null) ? (reqNo.ToUpper() + "%") : null;
            reqDate = (reqDate != null) ? (reqDate.ToUpper() + "%") : null;
            blNo = (blNo != null) ? (blNo.ToUpper() + "%") : null;
            tobondNo = (tobondNo != null) ? (tobondNo.ToUpper() + "%") : null;
            sts = (sts != null) ? (sts.ToUpper() + "%") : null;
            loc = (loc != null) ? (loc.ToUpper() + "%") : null;
            cust = (cust != null) ? (cust.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[3] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tobondNo;
            (param[4] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blNo;
            (param[5] = new OracleParameter("p_is_date", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            (param[6] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[7] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[8] = new OracleParameter("p_mss_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sts;
            (param[9] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cust;
            (param[10] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //_dtResults = QueryDataTable("tbl", "sp_search_cusdec_req_new", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_search_cusdec_req_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable SearchCusdecHeaderNew(string _initialSearchParams, string _searchCatergory, string _searchText, Int32 isDate, DateTime from, DateTime to)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _othdoc = null;
            string _blno = null;
            string sts = null;
            string cust = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;

                    case "OTH DOC":
                        _othdoc = _searchText;
                        break;
                    case "BL NO":
                        _blno = _searchText;
                        break;
                    case "STATUS":
                        sts = _searchText;
                        break;
                    case "CUSTOMER":
                        cust = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper() + "%") : null;
            _blno = (_blno != null) ? (_blno.ToUpper() + "%") : null;
            sts = (sts != null) ? (sts.ToUpper() + "%") : null;
            cust = (cust != null) ? (cust.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[4] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            (param[5] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            (param[6] = new OracleParameter("p_mss_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sts;
            (param[7] = new OracleParameter("p_cuh_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cust;
            (param[8] = new OracleParameter("p_is_date", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            (param[9] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[10] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_search_cusdec_hdr_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-07-01
        public DataTable SearchRoutDetailsnew(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _routcd = null;


            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ROUTNO": _routcd = _searchText; break;
                    default: break;
                }
            }

            _routcd = (_routcd != null) ? (_routcd.ToUpper() + "%") : "%";

            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _routcd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblSearchInvoice", "sp_searchRoutdetailsnew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-06-09*
        public DataTable SearchResvationRequestNo(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _resno = null;
            string _type = null;
            string _customer = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO": _resno = _searchText; break;
                    case "REQUEST TYPE": _type = _searchText; break;
                    case "CUSTOMER": _customer = _searchText; break;
                    default: break;
                }
            }

            _resno = (_resno != null) ? (_resno.ToUpper() + "%") : "%";
            _type = (_type != null) ? (_type.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer + "%") : "%";


            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_searchResReqNo", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-07-07
        public DataTable SearchResvationApproveNo(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _resno = null;
            // string _type = null;
            string _customer = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RESERVATION NO": _resno = _searchText; break;
                    case "CUSTOMER": _customer = _searchText; break;
                    default: break;
                }
            }

            _resno = (_resno != null) ? (_resno.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer + "%") : "%";


            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resno;
            (param[4] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_searchResAppNo", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public List<MST_CHARG_CODE_SEARCH_HEAD> getChargCodeListWithType(string company, string category, string pgeNum, string pgeSize, string searchFld, string searchVal, string pc, string type)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "STC_CD";
                    break;
                case "Description":
                    searchFld = "STC_DESC";
                    break;
                case "Service By":
                    searchFld = "SERVICE_PROVIDER_DESC";
                    break;
                case "From":
                    searchFld = "STC_FRM";
                    break;
                case "To":
                    searchFld = "STC_TO";
                    break;
                case "Rate":
                    searchFld = "STC_RT";
                    break;
                case "Class":
                    searchFld = "STC_CLS";
                    break;
                case "Vehicle":
                    searchFld = "STC_VEH_TP";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<MST_CHARG_CODE_SEARCH_HEAD> crg = new List<MST_CHARG_CODE_SEARCH_HEAD>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;
            (param[6] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[7] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblcrg", "SP_SEARCH_CHARGCODEWITHTYPE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                crg = DataTableExtensions.ToGenericList<MST_CHARG_CODE_SEARCH_HEAD>(_dtResults, MST_CHARG_CODE_SEARCH_HEAD.Converter);
            }
            return crg;
        }

        //Lakshan 18 Jul 2016
        public DataTable SearchAodDocumentForItemAllocation(string _initialSearchParams, DateTime _dtFrom, DateTime _dtTo, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[3] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            (param[4] = new OracleParameter("p_inb_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("mst_ope", "pkg_search_inv.sp_ser_inr_batch_itm_all", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-08-01   
        public DataTable GetChanalDetailsNew(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_searchChanalNew", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshika 2016/Aug/05
        public DataTable GET_CUSDEC_NO(string _cusdecNo)
        {
            DataTable dtResult = null;

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_cusdecNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dtResult = QueryDataTable("tblContainerType", "GET_CUSDEC_NO", CommandType.StoredProcedure, false, param);
            return dtResult;
        }

        //subodana 2016-08-04
        public DataTable GetTransportMethods(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _type = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _type = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _type = (_type != null) ? (_type.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_searchtrmethod", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2016-08-04
        public DataTable GetTransportParty(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _type = null;
            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TYPE":
                        _type = _searchText;
                        break;
                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _type = (_type != null) ? (_type.ToUpper() + "%") : null;
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_searchtrparty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2016-08-04
        public DataTable GetTransportReference(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _method = null;
            string _party = null;
            string _refno = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "METHOD":
                        _method = _searchText;
                        break;
                    case "PARTY":
                        _party = _searchText;
                        break;
                    case "REF NO":
                        _refno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _method = (_method != null) ? (_method.ToUpper() + "%") : null;
            _party = (_party != null) ? (_party.ToUpper() + "%") : null;
            _refno = (_refno != null) ? (_refno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refno;
            (param[1] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[2] = new OracleParameter("p_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _method;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_searchtrREF", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2016-08-08
        public DataTable GetAODTrackerDOC(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _docdate = null;
            string _doctype = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;
                    case "DATE":
                        _docdate = _searchText;
                        break;
                    case "DOC TYPE":
                        _doctype = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _docdate = (_docdate != null) ? (_docdate.ToUpper() + "%") : null;
            _doctype = (_doctype != null) ? (_doctype.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_docdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docdate;
            (param[3] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_searchtrackerDoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //subodana
        public DataTable SearchSerialByLocBINNEW(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ser1 = null;
            string _ser2 = null;
            string _itemStatus = null;
            string _itemCode = null;
            string _warrNo = null;
            string _docNo = null;
            string _docDate = null;


            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL1": _ser1 = _searchText; break;
                    case "SERIAL2": _ser2 = _searchText; break;
                    case "ITEMSTATUS": _itemStatus = _searchText; break;
                    case "WARRANTYNO": _warrNo = _searchText; break;
                    case "DOCNO": _docNo = _searchText; break;
                    case "DOCDATE": _docDate = _searchText; break;
                    default: break;
                }
            }


            _ser1 = (_ser1 != null) ? (_ser1 + "%") : "%";
            _ser2 = (_ser2 != null) ? (_ser2 + "%") : "%";
            _itemStatus = (_itemStatus != null) ? (_itemStatus.ToUpper() + "%") : "%";
            _itemCode = (_itemCode != null) ? (_itemCode.ToUpper() + "%") : "%";
            _warrNo = (_warrNo != null) ? (_warrNo + "%") : "%";
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : "%";
            _docDate = (_docDate != null) ? (_docDate + "%") : "%";

            OracleParameter[] param = new OracleParameter[12];
            //Initial parameters
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();

            //Search parameters
            (param[4] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemStatus;
            (param[5] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser1;
            (param[6] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser2;
            (param[7] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrNo;
            (param[8] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[9] = new OracleParameter("p_docdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docDate;
            (param[10] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSerials", "SP_SEARCH_SERIAL_LOC_BINNEW", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Rukshan 2016-08-11
        public DataTable SEARCHLOAD_PLS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _des = null;



            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _des = _searchText;
                        break;


                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _des = (_des != null) ? (_des.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mlp_ldcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_mlp_lddes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            (param[2] = new OracleParameter("p_mlp_conty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search_imp.sp_search_LOAD_PLS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 13 Aug 2016
        public DataTable Search_int_hdr_Infor_New(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;
            string _othLoc = null;
            string _status = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    case "OTHER LOC": _othLoc = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }
            _document = (_document != null) ? (_document.ToUpper() + "%") : null;
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date + "%") : null;
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : null;
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : null;
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : null;
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : null;
            _othLoc = (_othLoc != null) ? (_othLoc + "%") : null;

            OracleParameter[] param = new OracleParameter[15];
            //Fixed Date Range
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            //Search parameters
            (param[6] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[7] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[8] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[9] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[10] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[11] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[12] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othLoc;
            (param[13] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblInventoryDoc", "pkg_search_imp.sp_ser_int_hdr_inf_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "ith_doc_date,Document";
                _dtResults = dv.ToTable();
            }
            _dtResults.Columns.Remove("ith_doc_date");
            return _dtResults;
        }

        //Lakshan 19 Aug 2016
        public DataTable SearchBankDetails(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _desc = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _desc = (_desc != null) ? (_desc + "%") : null;
            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_mbi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_mbi_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[2] = new OracleParameter("p_mbi_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.IsNullOrEmpty(searchParams[0].ToString()) ? null : searchParams[0].ToString();
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "pkg_search_imp.sp_ser_mst_buscom", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 19 Aug 2016
        public DataTable SearchChequeDetailsReturnChk(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _frmChqDte, DateTime _toChqDte)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ref = null;
            string _bank = null;
            string _branch = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CHEQUE #":
                        _ref = _searchText;
                        break;
                    case "BANK":
                        _bank = _searchText;
                        break;
                    case "BRANCH":
                        _branch = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _ref = (_ref != null) ? (_ref + "%") : null;
            _bank = (_bank != null) ? (_bank + "%") : null;
            _branch = (_branch != null) ? (_branch + "%") : null;
            // sp_searchbusinesscompany(p_cd in NVARCHAR2,p_desc in NVARCHAR2,p_type in NVARCHAR2, c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_sar_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sar_profit_center_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_sard_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_sard_chq_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[4] = new OracleParameter("p_sard_chq_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _branch;
            (param[5] = new OracleParameter("p_sard_chq_dt_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmChqDte;
            (param[6] = new OracleParameter("p_sard_chq_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toChqDte;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "sp_ser_cheque_no", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 20 Aug 2016
        public DataTable GetChequeDetForReturn(RecieptHeader _recHdr, RecieptItem _recItm, DateTime _dtFrom, DateTime _dtTo)
        {
            Int32 _isDtSearch = 0;
            if (!string.IsNullOrEmpty(_recItm.Sard_ref_no))
            {
                _isDtSearch = 1;
            }
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_sar_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recHdr.Sar_com_cd;
            (param[1] = new OracleParameter("p_sar_profit_center_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recHdr.Sar_profit_center_cd;
            (param[2] = new OracleParameter("p_sard_chq_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recItm.Sard_chq_bank_cd;
            (param[3] = new OracleParameter("p_sard_chq_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recItm.Sard_chq_branch;
            (param[4] = new OracleParameter("p_sard_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recItm.Sard_ref_no;
            (param[5] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[6] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            (param[7] = new OracleParameter("p_is_dt_search", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isDtSearch;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblBankDetails", "sp_ser_cheque_ret", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Lakshan 25 Aug 2016
        public DataTable GetShipmentTrackerDatByClearenseDate(ImportsBLHeader _obj, DateTime _dtFrom, DateTime _dtTo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ib_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_com;
            (param[1] = new OracleParameter("p_dt_fr", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[2] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("blHdr", "pkg_search_imp.sp_ser_ship_trc_data", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //subodana
        public DataTable GetDocNumforTP(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _type = searchParams[0].ToString();
            string _date = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC":
                        _docno = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date.ToUpper() + "%") : null;
            //PROCEDURE  sp_get_Invoice(p_invoiceNo in NVARCHAR2, p_invTp in NVARCHAR2,c_data Out sys_refcursor);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[3] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "sp_get_docwithtp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 13 Sep 2016
        public DataTable Search_int_hdr_Infor_new(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _document = null;
            string _subType = null;
            string _date = null;
            string _manualRefNo = null;
            string _othDoc = null;
            string _entryNo = null;
            string _jobNo = null;
            string _othLoc = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT": _document = _searchText; break;
                    case "SUB TYPE": _subType = _searchText; break;
                    case "DATE": _date = _searchText; break;
                    case "MANUAL REF NO": _manualRefNo = _searchText; break;
                    case "OTHER DOCUMENT": _othDoc = _searchText; break;
                    case "ENTRY NO": _entryNo = _searchText; break;
                    case "JOB NO": _jobNo = _searchText; break;
                    case "OTHER LOC": _othLoc = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }

            _document = (_document != null) ? (_document.ToUpper() + "%") : null;
            _subType = (_subType != null) ? (_subType.ToUpper() + "%") : null;
            _date = (_date != null) ? (_date + "%") : null;
            _manualRefNo = (_manualRefNo != null) ? (_manualRefNo + "%") : null;
            _othDoc = (_othDoc != null) ? (_othDoc + "%") : null;
            _entryNo = (_entryNo != null) ? (_entryNo + "%") : null;
            _jobNo = (_jobNo != null) ? (_jobNo + "%") : null;
            _othLoc = (_othLoc != null) ? (_othLoc + "%") : null;

            OracleParameter[] param = new OracleParameter[15];
            //Fixed Date Range
            (param[0] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[5] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[3].ToString());
            //Search parameters
            (param[6] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[7] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[8] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRefNo;
            (param[9] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDoc;
            (param[10] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[11] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[12] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othLoc;
            (param[13] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "sp_search_int_hdr_Infor_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable SearchInvoiceWeb(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null) ? (_invoice.ToUpper() + "%") : "%";
            _manualrefno = (_manualrefno != null) ? (_manualrefno.ToUpper() + "%") : "%";
            _customer = (_customer != null) ? (_customer + "%") : "%";
            _customername = (_customername != null) ? (_customername + "%") : "%";
            _status = (_status != null) ? (_status + "%") : "%";

            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchInvoice", "sp_searchinvoiceWeb", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public List<MST_SRCH_ITM> getItemSearchDetails(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Item Code":
                        searchFld = "MI_CD";
                        break;
                    case "Description":
                        searchFld = "MI_SHORTDESC";
                        break;
                    case "Brand":
                        searchFld = "MI_BRAND";
                        break;
                    case "Model":
                        searchFld = "MI_MODEL";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<MST_SRCH_ITM> itmList = new List<MST_SRCH_ITM>();
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblCus", "SP_SEARCH_ITEMDET", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    itmList = DataTableExtensions.ToGenericList<MST_SRCH_ITM>(_dtResults, MST_SRCH_ITM.Converter);
                }
                return itmList;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }

        //Randima 25 Oct 2016
        public DataTable GetItmStusByCompany(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("status", "sp_get_item_satus_byCompany", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public List<DEPO_AMT_SEARCH_HED> getDepositAmounts(string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "GCD_CD";
                    break;
                case "Deposti Amount":
                    searchFld = "GCD_DPST_AMT";
                    break;
                case "Liability Amount":
                    searchFld = "GCD_LBLTY_AMT";
                    break;
                case "Daily Rental Code":
                    searchFld = "GCD_DAILY_RNT_CD";
                    break;
                case "Daily Rental Amount":
                    searchFld = "GCD_DAILY_RNT_AMT";
                    break;
                default:
                    searchFld = "";
                    break;
            }
            List<DEPO_AMT_SEARCH_HED> itmList = new List<DEPO_AMT_SEARCH_HED>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblDtl", "SP_SEARCH_LIABILITYDET", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                itmList = DataTableExtensions.ToGenericList<DEPO_AMT_SEARCH_HED>(_dtResults, DEPO_AMT_SEARCH_HED.Converter);
            }
            return itmList;
        }
        //Lakshan 04 Jun 2016
        public DataTable SER_REF_COND_TP_NEW(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _decs = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _decs = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _decs = (_decs != null) ? (_decs + "%") : null;
            _code = (_code != null) ? (_code + "%") : null;

            List<RepConditionType> _list = new List<RepConditionType>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_rct_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_rct_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_rct_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_rct_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_rct_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            (param[5] = new OracleParameter("p_rct_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5].ToString();
            (param[6] = new OracleParameter("p_rct_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _decs;
            (param[7] = new OracleParameter("p_rct_ini", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ser_ref_cond_tp_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 23 Nov 2016
        public DataTable GetItemSearchDataForBatch(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            string _Part_No = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;
                    case "PART NO":
                        _Part_No = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _Part_No = (_Part_No != null) ? (_Part_No.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_inb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_mi_longdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[5] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("p_mi_part_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Part_No;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_ser_item_by_batch_no", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by RUKSHAN on 29/11/2012
        public DataTable GetKitItemforInvoiceSearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search_inv.sp_searchkititemforinvoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 03 Jan 2017
        public DataTable SearchFleetRegistrationNO(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Fv_com = searchParams[0].ToString();
            string Fv_pty_cd = searchParams[1].ToString(); ;
            string Fv_pty_val = searchParams[2].ToString(); ;
            string Fv_reg_no = null;
            string Fv_make = null;
            string Fv_model = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REGISTER NO":
                        Fv_reg_no = _searchText;
                        break;
                    case "MODEL":
                        Fv_model = _searchText;
                        break;
                    case "MAKE":
                        Fv_make = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            Fv_reg_no = (Fv_reg_no != null) ? (Fv_reg_no.ToUpper() + "%") : null;
            Fv_make = (Fv_make != null) ? (Fv_make.ToUpper() + "%") : null;
            Fv_model = (Fv_model != null) ? (Fv_model.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_fv_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Fv_com;
            (param[1] = new OracleParameter("p_fv_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Fv_pty_cd;
            (param[2] = new OracleParameter("p_fv_pty_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Fv_pty_val;
            (param[3] = new OracleParameter("p_fv_reg_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Fv_reg_no;
            (param[4] = new OracleParameter("p_fv_make", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Fv_make;
            (param[5] = new OracleParameter("p_fv_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Fv_model;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_ser_flt_vehicle", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Akila 2016/12/31
        public DataTable GetItemByLocation(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[4] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search_inv.sp_searchitembylocation", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Add by Akila 2016/12/17
        public DataTable GetSubReceiptTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {

            DataTable _subReceiptTypes = new DataTable();
            try
            {
                //Spliit for Search control type.
                if (_initialSearchParams.Contains(":"))
                {
                    string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                    _initialSearchParams = arr[1];
                }

                //Spliit for Search SP parameters.
                string[] seperator = new string[] { "|" };
                string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

                OracleParameter[] _parameter = new OracleParameter[3];

                (_parameter[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
                (_parameter[1] = new OracleParameter("p_ReceiptType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

                _parameter[2] = new OracleParameter("o_SubRecTypes", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _subReceiptTypes = QueryDataTable("tbl_SubReceiptTypes", "Sp_Get_SubReceiptTypes", CommandType.StoredProcedure, false, _parameter);
            }
            catch (Exception)
            {
                throw;
            }
            return _subReceiptTypes;
        }

        //add by Akila 2017/01/05
        public DataTable GetInvoiceWithoutReversal(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _manualRef = null;
            string _customer = string.IsNullOrEmpty(searchParams[3].ToString()) ? null : searchParams[3].ToString();

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "MANUAL REF NO":
                        _manualRef = _searchText;
                        break;
                    case "Customer Code":
                        _customer = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _manualRef = (_manualRef != null) ? (_manualRef.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualRef;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceWithoutRevers", "pkg_search_inv.sp_searchinvwithoutrevers", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //LAkshan 10 Jan 2016
        public DataTable SearchProductionNoAodOut(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _docNo = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = !string.IsNullOrEmpty(_docNo) ? (_docNo + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_sph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sph_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_sph_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_sph_pro_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_sph_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("sat_pro", "sp_ser_sat_pro_hdr", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "sph_dt ASC";
                _dtResults = dv.ToTable();
            }
            if (_dtResults.Columns.Contains("sph_dt"))
            {
                _dtResults.Columns.Remove("sph_dt");
            }
            return _dtResults;
        }

        //Lakshan 25 Jan 2017
        public DataTable GetItemSearchDataForProductionPlan(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            string _Part_No = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;
                    case "PART NO":
                        _Part_No = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _Part_No = (_Part_No != null) ? (_Part_No.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_inb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_mi_longdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[5] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("p_mi_part_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Part_No;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_ser_item_by_product_no", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetItemforKit(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;



                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "pkg_search_inv.sp_searchvitemforkit", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Add by Akila 2017/01/21
        public DataTable GetServiceJobsByCustomer(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string REQUEST = null;
            string MAINJOB = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "JOB":
                        JOB = _searchText;
                        break;
                    case "REQUEST":
                        REQUEST = _searchText;
                        break;
                    case "MAIN JOB":
                        MAINJOB = _searchText;
                        break;
                    default:
                        break;
                }
            }

            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            REQUEST = (REQUEST != null) ? (REQUEST.ToUpper()) : null;
            MAINJOB = (MAINJOB != null) ? (MAINJOB.ToUpper()) : null;


            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_STAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_CUSTOMER_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[5] = new OracleParameter("P_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REQUEST;
            (param[6] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAINJOB;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("CustomerJobs", "pkg_search_inv.SP_GET_SCV_JOBBYCUS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SearchCreditNotes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;
            string _creditNote = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    case "CREDIT NOTE":
                        _creditNote = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;
            _creditNote = (_creditNote != null) ? (_creditNote.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_creditNote", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creditNote;
            (param[3] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[4] = new OracleParameter("o_searchData", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCreditNotes", "pkg_search_inv.SP_SEARCH_CRENOTES", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchEmployeeByType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "NAME":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_esep_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_esep_cat_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_esep_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("p_esep_first_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_mst_emp_by_tp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchFleetModel(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_frm_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_frm_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_r_model", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchFleetMake(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_frm_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_frm_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_r_make", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchFleetBattryType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fbt_batt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_fbt_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_r_battery_tp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchFleetFuelType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ful_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_ful_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_r_fuel_type", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchFleetTaxClass(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ftc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_ftc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_veh_tax_class", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 30 Jan 2017
        public DataTable SearchFleetVehClass(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ftc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_ftc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_veh_class", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 30 Jan 2017
        public DataTable SearchFleetVehCarryerTp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "DESCRIPTION":
                        _name = _searchText;
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fct_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_fct_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_emp", "sp_ser_flt_r_carrier_tp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2017/02/17
        public List<ref_comm_hdr> getCommissionCode(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "COMM_CD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<ref_comm_hdr> comm = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_COMMISSION_CD", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<ref_comm_hdr>(_dtResults, ref_comm_hdr.Converter2);
            }
            return comm;
        }
        public List<ACCCODESEARCH> getHandAccCodes(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string pc, DateTime date)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Account Code":
                    searchFld = "HAL_ACC_NO";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<ACCCODESEARCH> comm = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[6] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_HANDACC_CODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<ACCCODESEARCH>(_dtResults, ACCCODESEARCH.Converter);
            }
            return comm;
        }
        //subodana 2017/05/16
        public List<REF_BONUS_HDR> getBonusCodeCode(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string schemeCode)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "BONUS_CD";
                    break;
                // Added by Udesh - 12-Oct-2018
                case "Circ No":
                    searchFld = "BONUS_Circ_No";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<REF_BONUS_HDR> comm = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search.ToUpper();// Set ToUpper by Udesh - 12-Oct-2018
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_schemecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schemeCode;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_BONUS_NO", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<REF_BONUS_HDR>(_dtResults, REF_BONUS_HDR.Converter2);
            }
            return comm;
        }
        //subodana 2017/03/16
        public List<Sar_Type> GetCommissionInvTp(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "CODE";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<Sar_Type> comm = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_COMMIINVTP_CD", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<Sar_Type>(_dtResults, Sar_Type.Converter);
            }
            return comm;
        }
        public List<Sar_Type> GetPromoCircula(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "CODE";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<Sar_Type> comm = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_PROMO_CIR", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<Sar_Type>(_dtResults, Sar_Type.Converter);
            }
            return comm;
        }
        //Lakshan 21 Feb 2017
        public DataTable SearchBLHeaderForSI(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            string BL = null;
            string Reff = null;
            string Remark = null;
            string date = null;
            string status = null;
            Int32 isDate = 0;
            DateTime DtDate = DateTime.Now.Date;
            string Def_status = string.Empty;
            if (searchParams.Length == 4)
            {
                Def_status = searchParams[2];
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC":
                        doc = _searchText;
                        break;

                    case "BL":
                        BL = _searchText;
                        break;
                    case "DATE":
                        date = _searchText;
                        bool asdasd = DateTime.TryParse(_searchText, out DtDate);
                        isDate = 1;
                        break;
                    case "REFERENCE":
                        Reff = _searchText;
                        break;
                    case "REMARK":
                        Remark = _searchText;
                        break;
                    case "STATUS":
                        status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;
            BL = (BL != null) ? (BL.ToUpper() + "%") : null;
            Reff = (Reff != null) ? (Reff.ToUpper() + "%") : null;
            Remark = (Remark != null) ? (Remark.ToUpper() + "%") : null;
            status = (status != null) ? (status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_ISCUSDEC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[4] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            (param[5] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DtDate;
            (param[6] = new OracleParameter("P_REFF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Reff;
            (param[7] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remark;
            (param[8] = new OracleParameter("P_ISDate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDate;
            (param[9] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[10] = new OracleParameter("P_DEF_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Def_status;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblsupplier", "sp_seach_bl_head_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Isuru 21/03/2017
        public DataTable GetCat_SearchData_FORBM(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "%") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4]) : "%";
            searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_mcat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_scat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_scat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_scat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[7] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "sp_categorysetforBrandMan", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_LoadingBays(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("RES_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _initialSearchParams;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblBays", "SP_GetLoadingBays", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_LoadingBaysDoc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _initialSearchParams;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblBays", "sp_getloadingbaysdoc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<LoadingBay> Get_LoadingBayOtherDetails(string userid, string locid, string locbayid)
        {
            List<LoadingBay> lBay = null;
            DataTable _dtResults = null;
            userid = (userid != null) ? (userid.ToUpper() + "%") : null;
            locid = (locid != null) ? (locid.ToUpper() + "%") : null;
            locbayid = (locbayid != null) ? (locbayid.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("UserId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("LocId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locid;
            (param[2] = new OracleParameter("LocBayId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locbayid;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblBaysSearch", "SP_GetLoadingBaysSearch", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                lBay = DataTableExtensions.ToGenericList<LoadingBay>(_dtResults, LoadingBay.Converter);
            }
            return lBay;
        }
        public Int32 ExistsLoadingBaysUpdate(string useridU, string locationidU, string loadingBayidU, string userid, string locationid, string loadingBayId, int active, string modUser, DateTime modDate, string modSession, string comCode, string wCom, string wLoc)
        {
            //DataTable dt = null;
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("useridU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = useridU;
            (param[1] = new OracleParameter("locationidU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locationidU;
            (param[2] = new OracleParameter("loadingBayidU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loadingBayidU;
            (param[3] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[4] = new OracleParameter("locationid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locationid;
            (param[5] = new OracleParameter("loadingBayId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loadingBayId;
            (param[6] = new OracleParameter("active", OracleDbType.Int16, null, ParameterDirection.Input)).Value = active;
            (param[7] = new OracleParameter("modUser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modUser;
            (param[8] = new OracleParameter("modDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = modDate;
            (param[9] = new OracleParameter("modSession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modSession;
            (param[10] = new OracleParameter("comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
            (param[11] = new OracleParameter("wCom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = wCom;
            (param[12] = new OracleParameter("wLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = wLoc;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("UpdateLoadBay", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable Get_UsersFrompda(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblUsers", "SP_GetUsersFrompda", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetUserLocationFrompda(string _initialSearchParams, string _searchCatergory, string _searchText) // GetUserLocationSearchData
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbllocations", "GetUserLocationFrompda", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable Get_RecordExistInBay(string userid, string locCode, string comCode, string wCom, string wLoc, string lBay) // GetUserLocationSearchData
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locCode;
            (param[2] = new OracleParameter("comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;

            (param[3] = new OracleParameter("wCom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = wCom;
            (param[4] = new OracleParameter("wLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = wLoc;
            (param[5] = new OracleParameter("lBay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lBay;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblExData", "RecordExistInBay", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getWarehouseData(string userid, string locCode, string comCode) // GetUserLocationSearchData
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[1] = new OracleParameter("locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locCode;
            (param[2] = new OracleParameter("comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblExUserData", "GetWHComandLoc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Isuru 2017/03/23
        public DataTable GetInv_TypCre_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "sp_search_invoice_typecre", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Isuru 2017/03/27
        public DataTable GetInv_Typforupdate_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText, string _pc)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "sp_search_invoicefor_update", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Udaya 30/03/2017
        public DataTable GetAllEngineNos(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblEngNos", "sp_searchAllEngineNos", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Udaya 30/03/2017
        public DataTable GetAllChassiNos(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblChassiNos", "sp_searchAllchassiNos", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Udaya 30/03/2017
        public DataTable GetAllJobNos(string _initialSearchParams, string _searchCatergory, string _searchText, string _fromDate, string _todate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            string _date = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "DATE":
                        _date = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "") : "";
            _description = (_description != null) ? (_description.ToUpper() + "") : "";
            _date = (_date != null) ? (_date.ToUpper() + "") : null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("p_profitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_allocation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[6] = new OracleParameter("p_frmDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[7] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[8] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblJobNos", "sp_searchAllJobNos", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Udaya 31/03/2017
        public DataTable GetAllAodNos(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblAodNos", "sp_searchAllAodNos", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Udaya 31/03/2017
        public DataTable GetAllTechnician(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblTechnician", "sp_searchAllTechnician", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //create by randima modify by lakshan 03 Apr 2017
        public DataTable SearchMainItemsDataSplitByItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Item = null;
            string Desc = null;
            string Cate = null;
            string Model = null;
            string Brand = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        Item = _searchText;
                        break;

                    case "DESCRIPTION":
                        Desc = _searchText + "%";
                        break;

                    case "MAIN CATEGORY":
                        Cate = _searchText + "%";
                        break;
                    case "MODEL":
                        Model = _searchText + "%";
                        break;
                    case "BRAND":
                        Brand = _searchText + "%";
                        break;

                    default:
                        break;
                }
            }

            Item = (Item != null) ? (Item.ToUpper()) : null;
            Desc = (Desc != null) ? (Desc.ToUpper()) : null;
            Cate = (Cate != null) ? (Cate.ToUpper()) : null;
            Model = (Model != null) ? (Model.ToUpper()) : null;
            Brand = (Brand != null) ? (Brand.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[1] = new OracleParameter("p_mi_shortdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Desc;
            (param[2] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Cate;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[5] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[6] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Brand;

            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("mst_itm", "SP_SER_MAIN_SPLIT_DATA_BY_ITM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Akila 2017/04/18
        public DataTable SearchAllEmployee(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _epf = null;
            string _nic = null;
            string _fname = null;
            string _lname = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF NO":
                        _epf = _searchText;
                        break;

                    case "NIC NO":
                        _nic = _searchText;
                        break;

                    case "FIRST NAME":
                        _fname = _searchText;
                        break;

                    case "LAST NAME":
                        _lname = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _epf = (_epf != null) ? (_epf.ToUpper() + "%") : null;
            _nic = (_nic != null) ? (_nic.ToUpper() + "%") : null;
            _fname = (_fname != null) ? (_fname.ToUpper() + "%") : null;
            _lname = (_lname != null) ? (_lname.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_EpfNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _epf;
            (param[2] = new OracleParameter("p_NicNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_Fname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fname;
            (param[4] = new OracleParameter("p_Lname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lname;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("EmployeeDetails", "pkg_search.sp_search_allemp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchExchangeRequest(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _requestNo = null;


            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        _requestNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _requestNo = (_requestNo != null) ? (_requestNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_RequestNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestNo;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("ExchangeRequests", "pkg_inventory.SP_SEARCH_EXCHANGEREQUEST", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchForwardInvoice(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _invoiceNo = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INVOICE NO":
                        _invoiceNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _invoiceNo = (_invoiceNo != null) ? (_invoiceNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_Invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("ForwardInvoice", "pkg_inventory.SP_SEARCH_FORWARDINVOICE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SearchFixAssetRequest(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _requestNo = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        _requestNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _requestNo = (_requestNo != null) ? (_requestNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_RequestNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestNo;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("FixAssetRequest", "pkg_inventory.SP_SEARCH_FIXASSETREQ", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //ISURU 2017/03/24
        public DataTable SearchPRNREQNoforall(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string prnno = null;
            string refno = null;
            string stus = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        prnno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;

                    case "REQUEST STATUS":
                        stus = _searchText;
                        break;
                    default:
                        break;
                }
            }
            prnno = (prnno != null) ? (prnno.ToUpper() + "%") : null;
            refno = (refno != null) ? (refno.ToUpper() + "%") : null;
            stus = (stus != null) ? (stus.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("REF_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("PRN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prnno;
            (param[3] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            (param[4] = new OracleParameter("ref_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("INT_REQ", "SP_PRNREQ_forall", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Isuru 2017/03/25
        public DataTable SearchPRNItemsfordesc(Int32 p_itri_seq_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_itri_seq_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("INT_REQ_ITM", "sp_SearchPRNItems_fordesc", CommandType.StoredProcedure, false, param);
        }
        //ISURU 2017/04/25
        public DataTable SearchItemforchange(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code = null;
            string description = null;
            string model = null;
            string brand = null;
            string partno = null;
            string itemtype = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code = _searchText;
                        break;
                    case "DESCRIPTION":
                        description = _searchText;
                        break;
                    case "MODEL":
                        model = _searchText;
                        break;
                    case "BRAND":
                        brand = _searchText;
                        break;
                    case "PART NO":
                        partno = _searchText;
                        break;
                    case "ITEMTYPE":
                        itemtype = _searchText;
                        break;
                }
            }

            code = (code != null) ? (code + "%") : null;
            description = (description != null) ? (description + "%") : null;
            model = (model != null) ? (model + "%") : null;
            brand = (brand != null) ? (brand + "%") : null;
            partno = (partno != null) ? (partno + "%") : null;
            itemtype = (itemtype != null) ? (itemtype + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[1] = new OracleParameter("DESCRIPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = description;
            (param[2] = new OracleParameter("MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            (param[3] = new OracleParameter("BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[4] = new OracleParameter("PARTNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partno;
            (param[5] = new OracleParameter("ITEMTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemtype;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("MST_ITM", "sp_search_itemforchage", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Isuru 2017/04/27
        public List<PLU_SEARCH_ITM> getItemSearchDetailsforplu(string pgeNum, string pgeSize, string searchFld, string searchVal, string customercode)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Item Code":
                        searchFld = "MI_CD";
                        break;
                    case "Description":
                        searchFld = "MI_LONGDESC";
                        break;
                    case "PLU Code":
                        searchFld = "MBII_PLU_CD";
                        break;
                    case "Brand":
                        searchFld = "MI_BRAND";
                        break;
                    case "Model":
                        searchFld = "MI_MODEL";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<PLU_SEARCH_ITM> itmList = new List<PLU_SEARCH_ITM>();
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customercode;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblCus", "SP_SEARCH_ITEMDETFORPLU", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    itmList = DataTableExtensions.ToGenericList<PLU_SEARCH_ITM>(_dtResults, PLU_SEARCH_ITM.Converter);
                }
                return itmList;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }

        //Isuru 2017/04/28
        public DataTable GetCustomerCodeDetails(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            // _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            // _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            //_code = (_code != null) ? (_code + "%") : null;
            //_description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "sp_customercd_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Isuru 2017/04/28
        public DataTable GetItemCodeDetails(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            // _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            //_description = (_description != null) ? (_description.ToUpper() + "%") : "%";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "sp_itmcd_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Udaya 29/04/2017
        public DataTable GetUserLocationByRoleAndCompany(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblUserlocationByRoleAndCom", "sp_getalllocationsByRoleAndCom", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //tharanga 04/may/2017
        public DataTable GetServiceCenterDetails(string _com_CD, string _svc_CD, string _Town_CD, string _searchText)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com_CD;
            (param[1] = new OracleParameter("p_svc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _svc_CD;
            (param[2] = new OracleParameter("p_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Town_CD;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblusers", " sp_get_service_center", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Isuru 2017/05/03
        public List<mst_busentity_customer> GetCustomerDetailsforplu(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Customer Code":
                        searchFld = "MBE_CD";
                        break;
                    case "Name":
                        searchFld = "MBE_NAME";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<mst_busentity_customer> itmList = new List<mst_busentity_customer>();
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblCus", "SP_SEARCH_CUSDETFORPLU", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    itmList = DataTableExtensions.ToGenericList<mst_busentity_customer>(_dtResults, mst_busentity_customer.Converter);
                }
                return itmList;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }

        //Isuru 201/05/09
        public DataTable Get_All_Users(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            // string _com = null;
            string _userID = null;
            string _userName = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "USER ID":
                        _userID = _searchText;
                        break;

                    case "NAME":
                        _userName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _userID = (_userID != null) ? (_userID.ToUpper() + "%") : "%";
            _userName = (_userName != null) ? (_userName.ToUpper() + "%") : "%";

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;//_com;
            (param[1] = new OracleParameter("p_userName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userName;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_SearchAll_SystemUsers", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Udaya 09/05/2017
        public DataTable creditNoteVirtualItems(string _initialSearchParams, string _searchCatergory, string _searchText, string filter)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_filter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = filter;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblVInvoice", "sp_get_creditNoteVirtualItems", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Udaya 12/05/2017
        public DataTable creditNoteInvoiceType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblVInvoiceType", "sp_get_creditNoteInvoiceTypes", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Akila 2017/05/16
        public DataTable SearchServiceJobInStage(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _jobNo = null;
            string _serialNo = null;
            string _Manual_Referance = null;


            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory)
                {
                    case "Job No":
                        _jobNo = _searchText;
                        break;

                    case "Serial No":
                        _serialNo = _searchText;
                        break;
                    case "Manual Referance":
                        _Manual_Referance = _searchText;
                        break;



                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _jobNo = (_jobNo != null) ? (_jobNo.ToUpper() + "%") : null;
            _serialNo = (_serialNo != null) ? (_serialNo.ToUpper() + "%") : null;
            _Manual_Referance = (_Manual_Referance != null) ? (_Manual_Referance.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_JobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[3] = new OracleParameter("p_Serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo;
            (param[4] = new OracleParameter("p_Manu_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Manual_Referance;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("ServiceJobInStage", "pkg_inventory.SP_SEARCH_JOBS_IN_STAGE", CommandType.StoredProcedure, false, param);
            //_dtResults = QueryDataTable("ServiceJobInStage", "SP_SEARCH_JOBS_IN_STAGE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Isuru 2017/05/22
        public DataTable SearchChequeCodes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _chequeno = null;


            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CHEQUE NO":
                        _chequeno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _chequeno = (_chequeno != null) ? (_chequeno.ToUpper() + "%") : null;

            //PROCEDURE  sp_get_Invoice(p_invoiceNo in NVARCHAR2, p_invTp in NVARCHAR2,c_data Out sys_refcursor);
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_chequeno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "sp_get_cheque_code", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Isuru 2017/05/22
        public DataTable Searchaccountcode(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _accountcode = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ACCOUNT CODE":
                        _accountcode = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _accountcode = (_accountcode != null) ? (_accountcode.ToUpper() + "%") : null;

            //PROCEDURE  sp_get_Invoice(p_invoiceNo in NVARCHAR2, p_invTp in NVARCHAR2,c_data Out sys_refcursor);
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accountcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountcode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblLocationSearch", "sp_get_account_code", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        // Tharanga 2017/06/01
        public DataTable GetItemSerNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _itemSer = null;



            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory)
                {
                    case "Serial Number":
                        _itemSer = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _itemSer = (_itemSer != null) ? (_itemSer.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_itm_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemSer;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSerNo", "pkg_inventory.sp_get_itm_ser", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //subodana 2017-06-02
        public List<BTU_SEARCH> getBTUCodes(string pgeNum, string pgeSize, string searchFld, string searchVal, string cat)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "BTU":
                    searchFld = "MI_SIZE";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<BTU_SEARCH> btu = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_BTUCODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                btu = DataTableExtensions.ToGenericList<BTU_SEARCH>(_dtResults, BTU_SEARCH.Converter2);
            }
            return btu;
        }

        //Tharanga 2017/06/05
        public DataTable GetsubJobNo(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _itemSer = null;
            string _frmloc = null;
            string _subjob = null;
            string _jobNo = null;



            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory)
                {
                    case "From Location":
                        _frmloc = _searchText;
                        break;
                    case "Sub Job No":
                        _subjob = _searchText;
                        break;
                    case "Job Number":
                        _jobNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _itemSer = (_itemSer != null) ? (_itemSer.ToUpper() + "%") : null;
            _frmloc = (_frmloc != null) ? (_frmloc.ToUpper() + "%") : null;
            _subjob = (_subjob != null) ? (_subjob.ToUpper() + "%") : null;
            _jobNo = (_jobNo != null) ? (_jobNo.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_JonNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[1] = new OracleParameter("p_SubJob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subjob;
            (param[2] = new OracleParameter("p_currLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_FromLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _frmloc;
            (param[4] = new OracleParameter("p_frmDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSerNo", "pkg_search.SP_SEARCH_subJob", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Tharanga 2017/06/05
        public DataTable GetJobNo(string _subJob, string _loc)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_JonNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[1] = new OracleParameter("p_SubJob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJob;
            (param[2] = new OracleParameter("p_currLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_FromLoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[4] = new OracleParameter("p_frmDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = null;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = null;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSerNo", "pkg_search.SP_SEARCH_subJob", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Udaya 16.06.2017 - collect Credit note SRN 
        public DataTable SearchReversalInvoiceForCreditDebit(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;
            string _srn = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REVERSAL NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    case "SRN NO": _srn = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null && _invoice != "") ? (_invoice.ToUpper() + "%") : null;
            _manualrefno = (_manualrefno != null && _manualrefno != "") ? (_manualrefno.ToUpper() + "%") : null;
            _customer = (_customer != null && _customer != "") ? (_customer + "%") : null;
            _customername = (_customername != null && _customername != "") ? (_customername + "%") : null;
            _status = (_status != null && _status != "") ? (_status + "%") : null;
            _srn = (_srn != null && _srn != "") ? (_srn + "%") : null;
            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[8] = new OracleParameter("p_srn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _srn;
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchInvoice", "SP_SEARCHREVERSALWEB", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Udaya 30.06.2017 - collect Debit note SRN 
        public DataTable SearchReversalInvoiceForDebit(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;
            string _srn = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REVERSAL NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    case "SRN NO": _srn = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null && _invoice != "") ? (_invoice.ToUpper() + "%") : null;
            _manualrefno = (_manualrefno != null && _manualrefno != "") ? (_manualrefno.ToUpper() + "%") : null;
            _customer = (_customer != null && _customer != "") ? (_customer + "%") : null;
            _customername = (_customername != null && _customername != "") ? (_customername + "%") : null;
            _status = (_status != null && _status != "") ? (_status + "%") : null;
            _srn = (_srn != null && _srn != "") ? (_srn + "%") : null;
            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[8] = new OracleParameter("p_srn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _srn;
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblSearchInvoice", "SP_SEARCH_DEBITNOTE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Add by akila 2017/06/21 search advisor
        public DataTable SearchServiceAdvisor(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string CATEGORY = null;
            string EPF = null;
            string NAME = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF":
                        EPF = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            EPF = (EPF != null) ? (EPF + "%") : null;
            NAME = (NAME != null) ? (NAME + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_CATEGORY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_EPF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = EPF;
            (param[4] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("Advisors", "pkg_inventory.SP_SEARCH_GET_ALL_ADVISORS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Add by laksha 23 Jun 2017
        public DataTable GetServiceJobsWIPWEB(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string JOB = null;
            string NAME = null;
            string DESCRIPTION = null;
            string ADDRESS1 = null;
            string ADDRESS2 = null;
            string Stage = null;
            string Mobile = null;
            string PRORITY = null;
            string MAIN_JOB = null;

            string UserID = null;
            string SEARCH_KEY = null;

            if (searchParams[2].ToString() == "")
            {
                Stage = null;
            }
            else
            {
                Stage = searchParams[2].ToString();
            }

            if (searchParams[3].ToString() == "")
            {
                UserID = ""; ;
            }
            else
            {
                UserID = searchParams[3].ToString();
            }

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SEARCH KEY":
                        SEARCH_KEY = _searchText;
                        break;
                    case "JOB":
                        JOB = _searchText;
                        break;

                    case "NAME":
                        NAME = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    case "ADDRESS1":
                        ADDRESS1 = _searchText;
                        break;

                    case "ADDRESS2":
                        ADDRESS2 = _searchText;
                        break;

                    case "MOBILE":
                        Mobile = _searchText;
                        break;

                    case "SERVICE LEVEL":
                        PRORITY = _searchText;
                        break;

                    case "MAIN JOB":
                        MAIN_JOB = _searchText;
                        break;

                    default:
                        break;
                }
            }
            NAME = (NAME != null) ? (NAME.ToUpper() + "%") : null;
            JOB = (JOB != null) ? (JOB.ToUpper() + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION.ToUpper() + "%") : null;
            ADDRESS1 = (ADDRESS1 != null) ? (ADDRESS1.ToUpper() + "%") : null;
            ADDRESS2 = (ADDRESS2 != null) ? (ADDRESS2.ToUpper() + "%") : null;
            Mobile = (Mobile != null) ? (Mobile.ToUpper() + "%") : null;
            PRORITY = (PRORITY != null) ? (PRORITY.ToUpper() + "%") : null;
            MAIN_JOB = (MAIN_JOB != null) ? (MAIN_JOB.ToUpper() + "%") : null;

            if (_searchText != null && _searchText.Length > 0)
            {
                _fromDate = DateTime.MinValue;
                _toDate = DateTime.MaxValue;
            }

            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = JOB;
            (param[2] = new OracleParameter("P_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = NAME;
            (param[3] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DESCRIPTION;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[6] = new OracleParameter("P_Stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stage;
            (param[7] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[8] = new OracleParameter("P_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS1;
            (param[9] = new OracleParameter("P_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ADDRESS2;
            (param[10] = new OracleParameter("P_MOBILE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Mobile;
            (param[11] = new OracleParameter("P_USERID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[12] = new OracleParameter("P_PRORITY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRORITY;
            (param[13] = new OracleParameter("P_MAINJOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MAIN_JOB;
            (param[14] = new OracleParameter("P_SEARCH_KEY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SEARCH_KEY;
            (param[15] = new OracleParameter("p_jbd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            // _dtResults = QueryDataTable("tbl", "pkg_search.SP_GET_SCV_JOBS_WIP_NEW", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "sp_get_scv_jobs_wip_web", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Add by Lakshan 28 Jun 2017
        public DataTable GetQuotationAllWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _quotation = null;
            string _customer = null;
            string _name = null;
            string _ref = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "QUOTATION":
                        _quotation = _searchText;
                        break;

                    case "PARTY CODE":
                        _customer = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "REFERENCE":
                        _ref = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _quotation = (_quotation != null) ? (_quotation.ToUpper() + "%") : "";
            _customer = (_customer != null) ? (_customer.ToUpper() + "%") : "";
            _name = (_name != null) ? (_name.ToUpper() + "%") : "";
            _ref = (_ref != null) ? (_ref.ToUpper() + "%") : "";

            //sp_search_quotation(p_com in NVARCHAR2,p_profit IN NVARCHAR2,p_date in date,p_quotation in NVARCHAR2, p_customer in NVARCHAR2 ,  p_name in NVARCHAR2,c_data out SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_quotation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quotation;
            (param[3] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ser_quotation_all_web", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //add by akila 2017/06/28
        public DataTable SearchSupplierData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "NAME":
                        _name = _searchText;
                        break;

                    case "CODE":
                        _code = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("Suppliers", "pkg_inventory.SP_SEARCH_SUPPLIER", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Add by lakshan 12Aug2017
        public DataTable GetItemforBoqMrn(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _item = null;
            string _description = null;
            string _model = null;
            string _brand = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    case "MODEL":
                        _model = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            _model = (_model != null) ? (_model.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_mci_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_mi_longdesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("mst_itm", "sp_search_boq_itm_for_mrn", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "item DESC";
                _dtResults = dv.ToTable();
            }
            return _dtResults;
        }

        //Add by lakshan 12Aug2017
        public DataTable SearchBoqProNoInMrn(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _docNo = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docNo = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = !string.IsNullOrEmpty(_docNo) ? (_docNo + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_sph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sph_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_sph_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_sph_pro_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_sph_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("sat_pro", "sp_ser_sat_pro_hdr_for_mrn", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "sph_dt ASC";
                _dtResults = dv.ToTable();
            }
            if (_dtResults.Columns.Contains("sph_dt"))
            {
                _dtResults.Columns.Remove("sph_dt");
            }
            return _dtResults;
        }
        //Udaya 14.08.2017
        public DataTable SEARCH_PRN_REQNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string prnno = null;
            string refno = null;
            string stus = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUEST NO":
                        prnno = _searchText;
                        break;

                    case "REFERENCE NO":
                        refno = _searchText;
                        break;

                    case "REQUEST STATUS":
                        stus = _searchText;
                        break;
                    default:
                        break;
                }
            }
            prnno = (prnno != null) ? (prnno.ToUpper() + "%") : null;
            refno = (refno != null) ? (refno.ToUpper() + "%") : null;
            stus = (stus != null) ? (stus.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("REF_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("PRN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prnno;
            (param[3] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            (param[4] = new OracleParameter("ref_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("dtlINT_REQ", "SP_SEARCH_PRNREQ", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Add by Lakshan 20Aug2017
        public DataTable SearchMrnDocumentsWeb(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _dtFrom, DateTime _dtTo)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _mrn = null;
            string _refNo = null;
            string _status = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MRN NO":
                        _mrn = _searchText;
                        break;

                    case "REF DOCUMENT":
                        _refNo = _searchText;
                        break;
                    case "STATUS":
                        _status = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _mrn = (_mrn != null) ? (_mrn.ToUpper()) : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper()) : null;
            _status = (_status != null) ? (_status.ToUpper()) : null;


            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            (param[4] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[5] = new OracleParameter("p_mss_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("p_itr_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[7] = new OracleParameter("p_sel_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString(); ;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("int_req", "sp_search_mrn_for_web", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = new DataView(_dtResults);
                dv.Sort = "itr_dt, itr_req_no ASC";
                _dtResults = dv.ToTable();

                _dtResults.Columns.Remove("itr_dt");
                _dtResults.Columns.Remove("itr_req_no");
            }
            return _dtResults;
        }
        //Add by Lakshan 23Aug2017
        public DataTable GetInvTrackerDocData(string _initialSearchParams)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper()) : "";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper()) : "";
            searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper()) : "";
            searchParams[8] = (searchParams[8] != "" || searchParams[8] != null) ? (searchParams[8].ToUpper()) : "";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];
            (param[2] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[3] = new OracleParameter("p_inb_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblZID", "sp_inv_track_doc_data", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        // add by tharanga 2017/08/29
        public DataTable Get_route_SearchData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _loc = null;
            string _des = null;



            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _des = _searchText;
                        break;
                    case "LOCATION":
                        _loc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "") : "%";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "0") : "%";
            //searchParams[2] = (searchParams[2] != "" || searchParams[2] != null) ? (searchParams[2].ToUpper() + "%") : "%";
            //searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            //searchParams[4] = (searchParams[4] != "" || searchParams[4] != null) ? (searchParams[4].ToUpper() + "%") : "%";
            //searchParams[5] = (searchParams[5] != "" || searchParams[5] != null) ? (searchParams[5].ToUpper() + "%") : "%";
            //searchParams[6] = (searchParams[6] != "" || searchParams[6] != null) ? (searchParams[6]) : "%";
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _des = (_des != null) ? (_des.ToUpper() + "%") : "%";
            _loc = (_loc != null) ? (_loc.ToUpper() + "%") : "%";


            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_routecd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("tbl", "sp_search_ROOT_DET", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Add by Lakshan 11Sep2017
        public DataTable SearchSalesOrderWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            if (searchParams[0] != "")
            {
                string[] arr = searchParams[0].Split(new string[] { ":" }, StringSplitOptions.None);
                searchParams[0] = arr[1];
            }
            string p_soh_so_no = null;
            string p_soh_man_ref = null;
            string p_soh_sales_ex_cd = null;
            string p_soh_cus_cd = null;
            string p_soh_cus_name = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ORDER NO":
                        p_soh_so_no = _searchText;
                        break;

                    case "MANUAL REF":
                        p_soh_man_ref = _searchText;
                        break;
                    case "EXC CODE":
                        p_soh_sales_ex_cd = _searchText;
                        break;
                    case "CUS CD":
                        p_soh_cus_cd = _searchText;
                        break;
                    case "CUS NAME":
                        p_soh_cus_name = _searchText;
                        break;
                    default:
                        break;
                }
            }
            p_soh_so_no = (!string.IsNullOrEmpty(p_soh_so_no)) ? (p_soh_so_no.ToUpper() + "%") : null;
            p_soh_man_ref = (!string.IsNullOrEmpty(p_soh_man_ref)) ? (p_soh_man_ref.ToUpper() + "%") : null;
            p_soh_sales_ex_cd = (!string.IsNullOrEmpty(p_soh_sales_ex_cd)) ? (p_soh_sales_ex_cd.ToUpper() + "%") : null;
            p_soh_cus_cd = (!string.IsNullOrEmpty(p_soh_cus_cd)) ? (p_soh_cus_cd.ToUpper() + "%") : null;
            p_soh_cus_name = (!string.IsNullOrEmpty(p_soh_cus_name)) ? (p_soh_cus_name.ToUpper() + "%") : null;
            if (_searchCatergory == null)
            {
                _searchCatergory = "";
            }
            if (_searchCatergory.Equals("PENDING"))//Added By Dulaj 2018/Dec/20
            {
                OracleParameter[] param = new OracleParameter[10];
                (param[0] = new OracleParameter("p_soh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
                (param[1] = new OracleParameter("p_soh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
                (param[2] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_so_no;
                (param[3] = new OracleParameter("p_soh_man_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_man_ref;
                (param[4] = new OracleParameter("p_soh_sales_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_sales_ex_cd;
                (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2]).Date;
                (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]).Date;
                (param[7] = new OracleParameter("p_soh_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_cus_cd;
                (param[8] = new OracleParameter("p_soh_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_cus_name;
                param[9] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _dtResults = QueryDataTable("sao_hdr", "sp_search_salesoreder_pending", CommandType.StoredProcedure, false, param);
            }
            else
            {
                OracleParameter[] param = new OracleParameter[10];
                (param[0] = new OracleParameter("p_soh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
                (param[1] = new OracleParameter("p_soh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
                (param[2] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_so_no;
                (param[3] = new OracleParameter("p_soh_man_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_man_ref;
                (param[4] = new OracleParameter("p_soh_sales_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_sales_ex_cd;
                (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2]).Date;
                (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]).Date;
                (param[7] = new OracleParameter("p_soh_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_cus_cd;
                (param[8] = new OracleParameter("p_soh_cus_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_soh_cus_name;
                param[9] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _dtResults = QueryDataTable("sao_hdr", "sp_search_salesoreder_web", CommandType.StoredProcedure, false, param);
            }
            return _dtResults;
        }
        public List<SHWRMMAN_SEARCH> getShowManager(string pgeNum, string pgeSize, string searchFld, string searchVal, string com)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "HMFA_MGR_CD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<SHWRMMAN_SEARCH> btu = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_PGENUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("P_PAGESIZE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("P_FIELD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("P_SEARCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_SHW_MNGR", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                btu = DataTableExtensions.ToGenericList<SHWRMMAN_SEARCH>(_dtResults, SHWRMMAN_SEARCH.Converter);
            }
            return btu;
        }
        //Add by Lakshan 12Oct2017
        //update by dilshan 19/10/2017
        public DataTable GetInventoryTrackerSearchDataWEB(string _initialSearchParams)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            //Set relavant parameters according to the,search catergory.

            //Modify parameter values for LIKE search.

            if (searchParams[11] == "No_Loc")
            {
                searchParams[0] = !string.IsNullOrEmpty(searchParams[0]) ? (searchParams[0].ToUpper()) : "";
            }
            else
            {
                searchParams[0] = !string.IsNullOrEmpty(searchParams[0]) ? (searchParams[0].ToUpper() + "%") : "";
            }
            searchParams[1] = !string.IsNullOrEmpty(searchParams[1]) ? (searchParams[1].ToUpper() + "%") : "";
            searchParams[2] = !string.IsNullOrEmpty(searchParams[2]) ? (searchParams[2].ToUpper() + "%") : "";
            //  searchParams[3] = (searchParams[3] != "" || searchParams[3] != null) ? (searchParams[3].ToUpper() + "%") : "%";
            searchParams[4] = !string.IsNullOrEmpty(searchParams[4]) ? (searchParams[4].ToUpper() + "%") : "";
            searchParams[5] = !string.IsNullOrEmpty(searchParams[5]) ? (searchParams[5].ToUpper() + "%") : "";
            searchParams[6] = !string.IsNullOrEmpty(searchParams[6]) ? (searchParams[6].ToUpper() + "%") : "";
            searchParams[7] = !string.IsNullOrEmpty(searchParams[7]) ? (searchParams[7].ToUpper() + "%") : "";
            searchParams[8] = !string.IsNullOrEmpty(searchParams[8]) ? (searchParams[8].ToUpper() + "%") : "";
            searchParams[9] = !string.IsNullOrEmpty(searchParams[9]) ? (searchParams[9].ToUpper() + "%") : "";
            searchParams[10] = !string.IsNullOrEmpty(searchParams[10]) ? (searchParams[10].ToUpper() + "%") : "";
            searchParams[11] = !string.IsNullOrEmpty(searchParams[11]) ? (searchParams[11]) : "";
            //   searchParams[12] = (searchParams[12] != "" || searchParams[12] != null) ? (searchParams[12].ToUpper() + "%") : searchParams[4].ToUpper();
            searchParams[12] = !string.IsNullOrEmpty(searchParams[12]) ? (searchParams[12].ToUpper()) : "";
            searchParams[13] = !string.IsNullOrEmpty(searchParams[13]) ? (searchParams[13].ToUpper() + "%") : "";

            searchParams[14] = !string.IsNullOrEmpty(searchParams[14]) ? (searchParams[14].ToUpper() + "%") : "";
            searchParams[16] = !string.IsNullOrEmpty(searchParams[16]) ? (searchParams[16].ToUpper() + "%") : null;
            searchParams[17] = !string.IsNullOrEmpty(searchParams[17]) ? (searchParams[17].ToUpper() + "%") : null;
            searchParams[18] = !string.IsNullOrEmpty(searchParams[18]) ? (searchParams[18].ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[19];
            //OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("P_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[14];
            (param[3] = new OracleParameter("p_ststus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[5] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4];
            (param[6] = new OracleParameter("p_sub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5];
            (param[7] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[6];
            (param[8] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[7];
            (param[9] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[8];
            (param[10] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[9];
            (param[11] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[10];
            (param[12] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[11];
            (param[13] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[12];
            (param[14] = new OracleParameter("p_sub1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[13];
            (param[15] = new OracleParameter("p_mi_cate_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[16];
            (param[16] = new OracleParameter("p_mi_cate_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[17];
            (param[17] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[18];
            param[18] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //need to uncomment before the checkin (parameter 17)
            //Query Data base.
            //_dtResults = QueryDataTable("tblInv", "pkg_search.sp_searchinventoryitem_NEW", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tblInv", "sp_search_inventory_item", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Added By Udaya 14/Oct/2017
        public DataTable SearchRevInvoice(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _invoice = null;
            string _manualrefno = null;
            string _customer = null;
            string _customername = null;
            string _status = null;
            string _srn = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REVERSAL NO": _invoice = _searchText; break;
                    case "MANUAL REF NO": _manualrefno = _searchText; break;
                    case "CUSTOMER CODE": _customer = _searchText; break;
                    case "NAME": _customername = _searchText; break;
                    case "STATUS": _status = _searchText; break;
                    case "SRN NO": _srn = _searchText; break;
                    default: break;
                }
            }

            _invoice = (_invoice != null && _invoice != "") ? (_invoice.ToUpper() + "%") : null;
            _manualrefno = (_manualrefno != null && _manualrefno != "") ? (_manualrefno.ToUpper() + "%") : null;
            _customer = (_customer != null && _customer != "") ? (_customer + "%") : null;
            _customername = (_customername != null && _customername != "") ? (_customername + "%") : null;
            _status = (_status != null && _status != "") ? (_status + "%") : null;
            _srn = (_srn != null && _srn != "") ? (_srn + "%") : null;
            // sp_searchinvoice (p_com in NVARCHAR2,p_pcenter IN NVARCHAR2, p_invoiceno IN NVARCHAR2,p_manualref in NVARCHAR2,p_customercode in NVARCHAR2,p_customername in NVARCHAR2,p_fromdate in DATE,p_todate in DATE,c_data out SYS_REFCURSOR)

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[3] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[4] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_manualref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualrefno;
            (param[6] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[7] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[8] = new OracleParameter("p_srn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _srn;
            (param[9] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (string.IsNullOrEmpty(_invoice))
            {
                _dtResults = QueryDataTable("tblSearchInvoice", "SP_SEARCHREVERSALWEB", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tblSearchInvoice", "SP_SEARCHREVERSALINVOICE2", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }

        //Lakshan 19Oct2017
        public DataTable SearchSerialsByJobNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _available = string.IsNullOrEmpty(searchParams[1].ToString()) ? null : searchParams[1].ToString();
            string _serial1 = null;
            string _item = null;
            string _docNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        _serial1 = _searchText;
                        break;

                    case "ITEM CODE":
                        _item = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial1 = (_serial1 != null) ? (_serial1 + "%") : null;
            _item = (_item != null) ? (_item + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ins_available", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[4] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_inb_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[7] = new OracleParameter("p_inb_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[4].ToString());
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ser_inr_ser_by_job_no", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 24Oct2017
        public DataTable SearchLocationByLocationCategory(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _com = null;
            string _category = null;
            string _loc = null;
            string _des = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _loc = _searchText;
                        break;

                    case "DESCRIPTION":
                        _des = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _loc = string.IsNullOrEmpty(_loc) ? "" : _loc;
            _des = string.IsNullOrEmpty(_des) ? "" : _des;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ml_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_ml_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _des;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_search_location_by_cat", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Added By Udaya 06/Nov/2017
        public DataTable GetCourierNos(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblCourierNos", "sp_get_Courier_Nos", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharindu 2017-11-13
        public DataTable Get_RootTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string code_ = null;
            string desc_ = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        code_ = _searchText;
                        break;

                    case "DESCRIPTION":
                        desc_ = _searchText;
                        break;

                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            //Query Data base.
            _dtResults = QueryDataTable("tblMovTypes", "sp_search_root", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Akila 2017/11/27
        public DataTable SearchNationality(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);


            string _code = null;
            string _description = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText.ToUpper();
                        break;

                    case "DESCRIPTION":
                        _description = _searchText.ToUpper();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_Desciption", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inventory.SP_SEARCH_BUS_NATIONAL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Getbrandmng(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string esep_epf = null;
            string esep_name_initials = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EPF":
                        esep_epf = _searchText.Remove(0, 1);
                        break;

                    case "NAME":
                        esep_name_initials = _searchText;
                        break;

                    default:
                        break;
                }
            }
            DataTable _requests = new DataTable();


            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "") : "";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            esep_epf = (esep_epf != null) ? (esep_epf.ToUpper() + "%") : "%";
            esep_name_initials = (esep_name_initials != null) ? (esep_name_initials.ToUpper() + "%") : "";

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_esep_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = esep_epf;
            (param[2] = new OracleParameter("p_esep_name_initials", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = esep_name_initials;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "get_brnd_mngr", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //add by tharanga 2017/11/28
        public DataTable GetDocSubTypes_ADJ(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docType = null;
            string _docTypeDesc = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _docType = _searchText.ToUpper();
                        break;

                    case "DESCRIPTION":
                        _docTypeDesc = _searchText.ToUpper();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docType = (_docType != null) ? (_docType.ToUpper() + "%") : null;
            _docTypeDesc = (_docTypeDesc != null) ? (_docTypeDesc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_movtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_movsubtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            (param[2] = new OracleParameter("p_movsubtypedesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docTypeDesc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_search_movcatetype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Tharindu 2017-12-07
        public DataTable Get_RefernceTypes(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            // DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText.ToUpper();
                        break;

                    case "DESCRIPTION":
                        _description = _searchText.ToUpper();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code + "%") : null;
            _description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_Code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_Desciption", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[2] = new OracleParameter("p_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inventory.SP_SEARCH_REFERNCE_CODE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //add by tharanga 2017/12/19
        public DataTable get_quo_to_inv(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _entryNo = null;


            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {

                    case "ENTRY NO": _entryNo = _searchText.ToUpper(); break;
                    default: break;
                }
            }


            _entryNo = (_entryNo != null) ? (_entryNo + "%") : "%";




            OracleParameter[] param = new OracleParameter[7];
            //Fixed Date Range 
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docDtFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_docDtTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            //Initial parameters
            (param[3] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[4] = new OracleParameter("p_sts", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[4].ToString());
            (param[5] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInventoryDoc", "sp_get_quo_to_inv", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable GET_PRIT_BY_CUST(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : "%";
            _description = (_description != null) ? (_description.ToUpper() + "%") : "%";
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_SCHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("P_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblZPC", "SP_GET_PRIT_BY_CUST", CommandType.StoredProcedure, false, param);
        }
        public DataTable GetCrCdCircular(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string circular = null;
            string esep_name_initials = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        circular = _searchText;
                        break;

                    default:
                        break;
                }
            }
            DataTable _requests = new DataTable();


            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "") : "";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            circular = (circular != null) ? (circular.ToUpper() + "%") : null;
            esep_name_initials = (esep_name_initials != null) ? (esep_name_initials.ToUpper() + "%") : "";

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CIRCUL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = circular;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tblZPC", "GET_ADJ_SUN_CIRC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetADJREQ_DET(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string p_req_no = null;
            string esep_name_initials = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REQUST_NUMBER":
                        p_req_no = _searchText;
                        break;

                    default:
                        break;
                }
            }
            DataTable _requests = new DataTable();

            /*
             * OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_reqTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqTp;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt.Date;
            (param[5] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt.Date;
            (param[6] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subTp;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_searchintr_req", CommandType.StoredProcedure, false, param); ;
             * 
             * 
             * */
            //Modify parameter values for LIKE search.
            searchParams[0] = (searchParams[0] != "" || searchParams[0] != null) ? (searchParams[0].ToUpper() + "") : "";
            searchParams[1] = (searchParams[1] != "" || searchParams[1] != null) ? (searchParams[1].ToUpper() + "%") : "%";
            p_req_no = (p_req_no != null) ? (p_req_no.ToUpper() + "%") : null;
            esep_name_initials = (esep_name_initials != null) ? (esep_name_initials.ToUpper() + "%") : "";
            DateTime _fromDate = DateTime.Now;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_reqTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[5] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[6] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[7] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_req_no;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_searcADJ_req", CommandType.StoredProcedure, false, param);
        }
        //Add by lakshan 31Jan2018
        public DataTable SerachSatProHdr(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _dtFrom, DateTime _dtTo)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _code = _searchText;
                        break;
                    default:
                        break;
                }
            }
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_sph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_fr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[2] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            (param[3] = new OracleParameter("p_sph_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_sph_pro_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[5] = new OracleParameter("p_sph_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[6] = new OracleParameter("p_sph_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblZPC", "sp_search_sat_pro_doc", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        //Tharindu 2018-04-17
        public DataTable GetCourierCompany(string refdoc, string loc, string com)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refdoc;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblZPC", "sp_get_courier_com", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }


        //akila 2018/01/25
        public DataTable SearchEvents(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);


            string _evnetId = null;
            string _customerCd = null;
            string _name = null;
            string _contactNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "EVENT ID":
                        _evnetId = _searchText.ToUpper();
                        break;

                    case "NAME":
                        _name = _searchText.ToUpper();
                        break;
                    case "CUSTOMER":
                        _customerCd = _searchText.ToUpper();
                        break;

                    case "CONTACT NO":
                        _contactNo = _searchText.ToUpper();
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _evnetId = (_evnetId != null) ? (_evnetId + "%") : null;
            _name = (_name != null) ? (_name + "%") : null;
            _customerCd = (_customerCd != null) ? (_customerCd + "%") : null;
            _contactNo = (_contactNo != null) ? (_contactNo + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_EventCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _evnetId;
            (param[1] = new OracleParameter("p_CustCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerCd;
            (param[2] = new OracleParameter("p_Name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[3] = new OracleParameter("p_ContactNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _contactNo;
            param[4] = new OracleParameter("out_SearchData", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("Event_Data", "SP_SEARCH_EVENTS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetDocTypes(string _com, string _loc, string _docName)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docName;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("doctyptbl", "get_doc_types", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Akila 2018/03/29
        public DataTable SearchDistrictDetails(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);


            string _districtCode = null;
            string _district = null;
            string _province = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DISTRICT CODE":
                        _districtCode = _searchText.ToUpper();
                        break;

                    case "DISTRICT":
                        _district = _searchText.ToUpper();
                        break;
                    case "PROVINCE":
                        _province = _searchText.ToUpper();
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _districtCode = (_districtCode != null) ? (_districtCode + "%") : null;
            _district = (_district != null) ? (_district + "%") : null;
            _province = (_province != null) ? (_province + "%") : null;


            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("P_DISCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _districtCode;
            (param[1] = new OracleParameter("P_DISTRICT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _district;
            (param[2] = new OracleParameter("P_PROVINCE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _province;
            param[3] = new OracleParameter("S_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("District_Search_Details", "SP_SEARCH_DISTRICT_DET", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Search_mid_account(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _account = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MID":
                        _account = _searchText.ToUpper();
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _account = (_account != null) ? (_account + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[1] = new OracleParameter("P_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[2] = new OracleParameter("P_PUN_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_SEARCH_SUN_ACC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<RENT_SCH_SEARCH> getRentSCHDetail(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "ID":
                        searchFld = "ID";
                        break;
                    case "Profitcenter":
                        searchFld = "Profitcenter";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<RENT_SCH_SEARCH> rentschlist = null;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblRentSCH", "SP_GET_SCH_HDR_DETAILS", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    rentschlist = DataTableExtensions.ToGenericList<RENT_SCH_SEARCH>(_dtResults, RENT_SCH_SEARCH.Converter);
                }
                return rentschlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }

        public List<PAYMENT_TYPES> getPaymentTypes(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "ID":
                        searchFld = "ID";
                        break;
                    case "Description":
                        searchFld = "Description";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<PAYMENT_TYPES> rentschlist = null;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblPayTp", "SP_GET_SCH_PAYMENT_TYPES", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    rentschlist = DataTableExtensions.ToGenericList<PAYMENT_TYPES>(_dtResults, PAYMENT_TYPES.Converter);
                }
                return rentschlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }


        public List<PAYMENT_SUB_TYPES> getPaymentSubTypes(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string p_type)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "ID":
                        searchFld = "ID";
                        break;
                    case "Description":
                        searchFld = "Description";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<PAYMENT_SUB_TYPES> rentschlist = null;
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
                param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblPaySTp", "SP_GET_SCH_PAYMENT_SUB_TYPES", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    rentschlist = DataTableExtensions.ToGenericList<PAYMENT_SUB_TYPES>(_dtResults, PAYMENT_SUB_TYPES.Converter);
                }
                return rentschlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }
        public DataTable Search_veh_reg_ref(string _initialSearchParams, string _searchCatergory, string _searchText)
        {

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ref = null;
            string _inv = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "REF":
                        _ref = _searchText.ToUpper();
                        break;
                    case "invoice":
                        _inv = _searchText.ToUpper();
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _ref = (_ref != null) ? (_ref + "%") : null;
            _inv = (_inv != null) ? (_inv + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_VEH_REG_REF", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2018/06/06
        public List<ref_cht_accgrp> getChartAccCodeCode(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "ACC_CD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<ref_cht_accgrp> comm = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_SEARCH_CHARTACCNO", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<ref_cht_accgrp>(_dtResults, ref_cht_accgrp.Converter2);
            }
            return comm;
        }
        //Pasindu 2018/06/01
        public List<REF_BONUS_SCHEME> getSchemeCode(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string p_circu_number)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "SCHEME_CD";
                    break;
                default:
                    searchFld = "";
                    break;

            }
            List<REF_BONUS_SCHEME> comm = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_circu_number", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_circu_number;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblProf", "SP_GET_SCHEME_NUMBER", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                comm = DataTableExtensions.ToGenericList<REF_BONUS_SCHEME>(_dtResults, REF_BONUS_SCHEME.Converter2);
            }
            return comm;
        }
        public DataTable Get_tec_by_teamcd(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string cateCode = string.Empty;
            if (searchParams.Length == 4)
            {
                cateCode = searchParams[2].ToString();
            }
            else
            {
                cateCode = string.Empty;
            }

            string TEAM_CD = null;
            string TYPE = null;
            string DESCRIPTION = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "TEAM_CODE":
                        TEAM_CD = _searchText;
                        break;

                    case "TYPE":
                        TYPE = _searchText;
                        break;

                    case "DESCRIPTION":
                        DESCRIPTION = _searchText;
                        break;

                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            TEAM_CD = (TEAM_CD != null) ? (TEAM_CD + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            DESCRIPTION = (DESCRIPTION != null) ? (DESCRIPTION + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("P_TEAM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = TEAM_CD;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "SP_GET_EMP_BY_TEAM_CD", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable Get_scv_location(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string svc_loc_cd = null;
            string TYPE = null;
            string svc_loc_cd_des = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERVICE_CODE":
                        svc_loc_cd = _searchText.ToUpper();
                        break;

                    case "SERVICE_LOCATION":
                        svc_loc_cd_des = _searchText.ToUpper();
                        break;



                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            svc_loc_cd = (svc_loc_cd != null) ? (svc_loc_cd + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            svc_loc_cd_des = (svc_loc_cd_des != null) ? (svc_loc_cd_des + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("P_SCV_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd;
            (param[3] = new OracleParameter("P_SCV_LOC_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd_des;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "SP_GET_SCV_LOC_BY_AREA", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable serch_pcbysvcloc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string svc_loc_cd = null;
            string TYPE = null;
            string svc_loc_cd_des = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        svc_loc_cd = _searchText.ToUpper();
                        break;

                    case "DESCRIPTION":
                        svc_loc_cd_des = _searchText.ToUpper();
                        break;



                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            svc_loc_cd = (svc_loc_cd != null) ? (svc_loc_cd + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            svc_loc_cd_des = (svc_loc_cd_des != null) ? (svc_loc_cd_des + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd;
            (param[3] = new OracleParameter("p_pc_des", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd_des;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_serch_pcbysvcloc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable Get_scv_location_BY_LOCTIONTABLE(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string svc_loc_cd = null;
            string TYPE = null;
            string svc_loc_cd_des = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        svc_loc_cd = _searchText.ToUpper();
                        break;

                    case "DESCRIPTION":
                        svc_loc_cd_des = _searchText.ToUpper();
                        break;



                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            svc_loc_cd = (svc_loc_cd != null) ? (svc_loc_cd + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            svc_loc_cd_des = (svc_loc_cd_des != null) ? (svc_loc_cd_des + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd;
            (param[2] = new OracleParameter("p_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd_des;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_ser_loc_by_code", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable Get_scv_agent(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string svc_loc_cd = null;
            string TYPE = null;
            string svc_loc_cd_des = null;
            string svc_agent_cd = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        svc_loc_cd = _searchText.ToUpper();
                        break;

                    case "AGENT":
                        svc_agent_cd = _searchText.ToUpper();
                        break;
                    case "DESCRIPTION":
                        svc_loc_cd_des = _searchText.ToUpper();
                        break;
                    case "COMPANY":
                        searchParams[0] = _searchText.ToUpper();
                        break;



                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            svc_loc_cd = (svc_loc_cd != null) ? (svc_loc_cd + "%") : null;
            TYPE = (TYPE != null) ? (TYPE + "%") : null;
            svc_loc_cd_des = (svc_loc_cd_des != null) ? (svc_loc_cd_des + "%") : null;
            svc_agent_cd = (svc_agent_cd != null) ? (svc_agent_cd + "%") : null;
            searchParams[0] = (searchParams[0] != null) ? (searchParams[0] + "%") : null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("P_SCV_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd;
            (param[3] = new OracleParameter("P_SCV_LOC_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_loc_cd_des;
            (param[4] = new OracleParameter("P_SCV_AGENT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = svc_agent_cd;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "SP_GET_AGENT_LOC_BY_AREA", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable searchDepositBankCode_cred_card(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _name = null;
            string _accname = null;
            string _acc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BANK":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _name = _searchText;
                        break;

                    case "ACCNAME":
                        _accname = _searchText;
                        break;

                    case "ACC":
                        _acc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _name = (_name != null) ? (_name.ToUpper() + "%") : null;
            _accname = (_accname != null) ? (_accname.ToUpper() + "%") : null;
            _acc = (_acc != null) ? (_acc.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[5] = new OracleParameter("p_accname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accname;
            (param[6] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[7] = new OracleParameter("p_online", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[5].ToString());
            (param[8] = new OracleParameter("p_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[4].ToString());
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblBankDetails", "sp_search_pc_dep_bank_for_cred", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }





        public List<SRCH_PAY_REQ> searchPaymentRequest(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string reqtp)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Request #":
                    searchFld = "MPRH_REQ_NO";
                    break;
                case "Date":
                    searchFld = "MPRH_REQ_DT";
                    break;
                case "Pay Type":
                    searchFld = "MPRH_PAY_TP";
                    break;
                case "Creditor":
                    searchFld = "MPRH_CREDITOR";
                    break;
                case "Net Amount":
                    searchFld = "MPRH_NET_AMT";
                    break;
                default:
                    searchFld = "";
                    break;
            }
            List<SRCH_PAY_REQ> rentschlist = new List<SRCH_PAY_REQ>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqtp;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPayTp", "SP_SEARCH_PAYMENTREQUEST", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                rentschlist = DataTableExtensions.ToGenericList<SRCH_PAY_REQ>(_dtResults, SRCH_PAY_REQ.Converter);
            }
            return rentschlist;
        }

        public List<SRCH_ACC_DET> searchAccountnumbers(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "RCA_ACC_NO";
                    break;
                case "Description":
                    searchFld = "RCA_ACC_DESC";
                    break;
                default:
                    searchFld = "";
                    break;
            }
            List<SRCH_ACC_DET> rentschlist = new List<SRCH_ACC_DET>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPayTp", "SP_SEARCH_ACCOUNTCODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                rentschlist = DataTableExtensions.ToGenericList<SRCH_ACC_DET>(_dtResults, SRCH_ACC_DET.Converter);
            }
            return rentschlist;
        }

        public List<SRCH_TEMP_SRCH> searchFieldValue(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "RTS_CD";
                    break;
                case "Description":
                    searchFld = "RTS_DESC";
                    break;
                default:
                    searchFld = "";
                    break;
            }
            List<SRCH_TEMP_SRCH> rentschlist = new List<SRCH_TEMP_SRCH>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPayTp", "SP_SEARCH_SRCHFIELD", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                rentschlist = DataTableExtensions.ToGenericList<SRCH_TEMP_SRCH>(_dtResults, SRCH_TEMP_SRCH.Converter);
            }
            return rentschlist;
        }
        //Rangika 2018/06/08
        public DataTable get_item_rest(string _com, string mic_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mic_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mic_cd;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("status", "sp_get_item_rest", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public List<COMMON_SEARCH> searchCommonDataValue(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string userId, string type)
        {
            string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
            switch (searchFld)
            {
                case "Code":
                    searchFld = "CODE";
                    break;
                case "Description":
                    searchFld = "DESCRIPTION";
                    break;
                default:
                    searchFld = "";
                    break;
            }
            List<COMMON_SEARCH> itm = new List<COMMON_SEARCH>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
            (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
            (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
            (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
            (param[6] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPayTp", "SP_SEARCH_COMMONSRCHFIELD", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                itm = DataTableExtensions.ToGenericList<COMMON_SEARCH>(_dtResults, COMMON_SEARCH.Converter);
            }
            return itm;
        }

        public List<PAYMENT_TYPES> getAccPaymentTypes(string pgeNum, string pgeSize, string searchFld, string searchVal, string company)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Code":
                        searchFld = "SAPT_CD";
                        break;
                    case "Description":
                        searchFld = "SAPT_DESC";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<PAYMENT_TYPES> rentschlist = null;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblPayTp", "SP_GET_ACCPAYMENT_TYPES", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    rentschlist = DataTableExtensions.ToGenericList<PAYMENT_TYPES>(_dtResults, PAYMENT_TYPES.Converter);
                }
                return rentschlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public DataTable Search_Bond_Itm_Model(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _model = null;
            string _desc = null;



            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MODEL":
                        _model = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _model = (_model != null) ? (_model.ToUpper() + "%") : "%";
            _desc = (_desc != null) ? (_desc + "%") : "%";



            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_Search_model_cusdec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Search_Wharf_Employee(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _cd = null;
            string _name = null;



            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _cd = _searchText;
                        break;
                    case "NAME":
                        _name = _searchText;
                        break;
                    default:
                        break;
                }
            }
            //Modify parameter values for LIKE search.
            _cd = (_cd != null) ? (_cd.ToUpper() + "%") : "%";
            _name = (_name != null) ? (_name + "%") : "%";



            //sp_search_dept (p_code in NVARCHAR2, p_desc in NVARCHAR2,c_data OUT sys_refcursor);
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[1] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_Search_whf_employee", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable SEARCH_TO_BOND_NO_Shp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable dtResult = null;
            string _code = null;
            string _description = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "BOND NO":
                        _code = _searchText;
                        break;

                    case "DESCRIPTION":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code + "%") : null;
            _description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[1] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dtResult = QueryDataTable("tblToBond", "pkg_search_imp.SP_Search_to_bond_no", CommandType.StoredProcedure, false, param);
            return dtResult;
        }
        //Dulaj 2018-Nov-30
        public DataTable Get_All_Users_Loc(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            // string _com = null;
            string _userID = null;
            string _userName = null;
            string _email = null;
            string _mobile = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "USER ID":
                        _userID = _searchText;
                        break;

                    case "NAME":
                        _userName = _searchText;
                        break;

                    case "EMAIL":
                        _email = _searchText;
                        break;

                    case "MOBILE":
                        _mobile = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            //_com = (_com != null) ? (_com.ToUpper() + "%") : "%";
            _userID = (_userID != null) ? (_userID.ToUpper() + "%") : "%";
            _userName = (_userName != null) ? (_userName.ToUpper() + "%") : "%";
            _email = (_email != null) ? (_email + "%") : "%";
            _mobile = (_mobile != null) ? (_mobile.ToUpper() + "%") : "%";

            //sp_Search_systemUser( p_userID in NVARCHAR2,p_userName in NVARCHAR2, c_data OUT SYS_REFCURSOR);
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;//_com;
            (param[1] = new OracleParameter("p_userName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userName;
            (param[2] = new OracleParameter("p_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _email;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "sp_SearchAll_SystemUsers_loc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable SearchCusdecHeaderWithStus(string _initialSearchParams, string _searchCatergory, string _searchText, string stus)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _othdoc = null;
            string _blno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;

                    case "OTH DOC":
                        _othdoc = _searchText;
                        break;
                    case "BL NO":
                        _blno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper() + "%") : null;
            _blno = (_blno != null) ? (_blno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[4] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            (param[5] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            (param[6] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_search_cusdec_hdr_With_Stus", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<ACCOUNT_TAX> srchTaxTypes(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string creditor)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Code":
                        searchFld = "TAX_CD";
                        break;
                    case "Description":
                        searchFld = "TAX_DESC";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<ACCOUNT_TAX> rentschlist = new List<ACCOUNT_TAX>();
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[5] = new OracleParameter("p_creditor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creditor;
                param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblPayTp", "SP_GET_ACCPAYMENT_TAX", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    rentschlist = DataTableExtensions.ToGenericList<ACCOUNT_TAX>(_dtResults, ACCOUNT_TAX.Converter);
                }
                return rentschlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Chamal 20-Dec-2018
        public string GetBarcodeString(string _type)
        {
            string _doc = string.Empty;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldoc", "SP_GET_BARCODE_STR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                byte[] byteArray = (Byte[])_dtResults.Rows[0]["RBZ_TEXT"];
                _doc = System.Text.Encoding.UTF8.GetString(byteArray);
            }
            return _doc;
        }

        //Chamal 20-Dec-2018
        public DataTable GetDocumentSerials(string _docno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbldoc", "SP_GET_BARCODE_STR_DOC", CommandType.StoredProcedure, false, param);
        }
        //Nuwan 2018/Dec/26
        public List<PUR_SEARCH> searchPOPayRequest(string pgeNum, string pgeSize, string searchFld, string searchVal, string company, string creditor)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Purchase Order":
                        searchFld = "PURNO";
                        break;
                    default:
                        searchFld = "";
                        break;
                }
                List<PUR_SEARCH> rentschlist = new List<PUR_SEARCH>();
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[1] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[2] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[3] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[5] = new OracleParameter("p_creditor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creditor;
                param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblPayTp", "SP_SEARCH_ACCPODET", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    rentschlist = DataTableExtensions.ToGenericList<PUR_SEARCH>(_dtResults, PUR_SEARCH.Converter);
                }
                return rentschlist;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Chamal 31-Dec-2018
        public DataTable GerBarcodePrinters(string _user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbldoc", "SP_GET_BARCODE_PRINTERS", CommandType.StoredProcedure, false, param);
        }
        public DataTable SearchCusdecHeaderHS(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _othdoc = null;
            string _blno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;

                    case "OTH DOC":
                        _othdoc = _searchText;
                        break;
                    case "BL NO":
                        _blno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper() + "%") : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper() + "%") : null;
            _blno = (_blno != null) ? (_blno.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            (param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_search_cusdec_hdr_hs", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GerHsSearchDetails(string company, string entry, string hscode, DateTime fromDate, DateTime toDate, string description)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDate;
            (param[2] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate.AddDays(1);
            (param[3] = new OracleParameter("p_doc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = entry;
            (param[4] = new OracleParameter("p_des", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = description;
            (param[5] = new OracleParameter("p_hs", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = hscode;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbldoc", "sp_search_hs_det", CommandType.StoredProcedure, false, param);
        }
        //Chamal 05-Jan-2019
        public DataTable GerBarcodeLabels(string _user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbldoc", "SP_GET_BARCODE_LABELS", CommandType.StoredProcedure, false, param);
        }
        //Dulaj 2018-Sep-04
        public DataTable LoadCusdecDatabyDoc(string doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("imp_cus_hdr", "getcusdatabysino", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UploadEnadocDoc(REF_ENADOC_DOCS refEnadocDoc)
        {
            OracleParameter[] param = new OracleParameter[16];

            (param[0] = new OracleParameter("P_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_SEQ;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_COM;
            (param[2] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_LOC;
            (param[3] = new OracleParameter("P_LOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_LOC_TP;
            (param[4] = new OracleParameter("P_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_DOC_TP;
            (param[5] = new OracleParameter("P_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_DOC_NO;
            (param[6] = new OracleParameter("P_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_DOC_DT.Date;
            (param[7] = new OracleParameter("P_ENADOC_REFNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_ENADOC_REFNO;
            (param[8] = new OracleParameter("P_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_STUS;
            (param[9] = new OracleParameter("P_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_CRE_BY;
            (param[10] = new OracleParameter("P_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_CRE_SESSION;
            (param[11] = new OracleParameter("P_APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_APP_BY;
            (param[12] = new OracleParameter("P_APP_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_APP_SESSION;
            (param[13] = new OracleParameter("P_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_MOD_BY;
            (param[14] = new OracleParameter("P_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refEnadocDoc.REND_MOD_SESSION;

            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_SAVE_REFENADOCDOCS", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetEnadocDoc(DocSearchParam endoc_doc_param)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_Document_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = endoc_doc_param.DocumentNo;
            (param[1] = new OracleParameter("P_Document_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = endoc_doc_param.DocumentType;
            (param[2] = new OracleParameter("P_Document_From_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = endoc_doc_param.From.ToShortDateString();
            (param[3] = new OracleParameter("P_Document_To_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = endoc_doc_param.To.ToShortDateString();
            (param[4] = new OracleParameter("Is_Upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = endoc_doc_param.IsUpload;
            (param[5] = new OracleParameter("P_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = endoc_doc_param.GlblLoc;
            (param[6] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = endoc_doc_param.GlblCom;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_Select_Enadoc_Doc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 SetEnadocHash(string enadocHash, string userId)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_hash", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = enadocHash;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_UPDATE_ENADOC_HASH", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetEnadocUserPermissions(string userId, string com)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_User_Id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
            (param[1] = new OracleParameter("P_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_Enadoc_User_Permission", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public List<Mst_Sys_Para> Get_hp_collection_aloow_det(string _msp_pty_com, string _msp_pty_tp, string _msp_pty_cd, string _msp_dir_pty_cd, string _msp_rest_type)
        {
            DataTable _dtResults = null;
            List<Mst_Sys_Para> _LIST = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_msp_pty_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msp_pty_com;
            (param[1] = new OracleParameter("p_msp_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msp_pty_tp;
            (param[2] = new OracleParameter("p_msp_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msp_pty_cd;
            (param[3] = new OracleParameter("p_msp_dir_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msp_dir_pty_cd;
            (param[4] = new OracleParameter("p_msp_rest_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _msp_rest_type;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblItemSearch", "SP_GET_SYS_DET_BYCOM", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _LIST = DataTableExtensions.ToGenericList<Mst_Sys_Para>(_dtResults, Mst_Sys_Para.Converter);
            }
            return _LIST;

        }

        //Dilan 16/Jan/2019
        public Int32 SetAccessToken(string token, string refreshToken)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("P_TOKEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = token;
            (param[1] = new OracleParameter("P_REFRESH_TOKEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refreshToken;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_UPDATE_ENADOC_TOKEN", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetAccessToken()
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_SELECT_ENADOC_TOKEN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //dilan 22/Jan/2019
        public DataTable GetTagProfileByLibId(string libId)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_Library", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = libId;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_SELECT_TAG_BY_ID", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //dilan 24/Jan/2019
        public DataTable GetViewAccessToken(string com, string userid, int libId)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[2] = new OracleParameter("P_LIB_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = libId;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_GET_ENADOC_TOKEN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Dulaj 2019/Jan/29
        public DataTable GetShipmentTrackerDatByClearenseDatePending(ImportsBLHeader _obj, DateTime _dtFrom, DateTime _dtTo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ib_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_com;
            (param[1] = new OracleParameter("p_dt_fr", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[2] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("blHdr", "sp_ser_ship_trc_data_pending", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Dulaj 2019/Jan/29
        public DataTable GetShipmentTrackerDatByClearenseDateActual(ImportsBLHeader _obj, DateTime _dtFrom, DateTime _dtTo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ib_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ib_com;
            (param[1] = new OracleParameter("p_dt_fr", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[2] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("blHdr", "sp_ser_ship_trc_data_actual", CommandType.StoredProcedure, false, param);
            return _result;
        }
    }
}
