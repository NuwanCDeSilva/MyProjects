using System;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using System.Linq;
using FF.BusinessObjects;
using Oracle.DataAccess.Client;
using FF.BusinessObjects.InventoryNew;
using FF.BusinessObjects.General;
using FF.BusinessObjects.MessagePortal;
using FF.BusinessObjects.Sales;
using FF.BusinessObjects.Security;
using FF.BusinessObjects.Financial;

namespace FF.DataAccessLayer
{
    public class InventoryDAL : BaseDAL
    {    
        //kapila
        public DataTable get_srn_items(string _refNo)
        {
            List<RecieptItem> _ReceiptList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReceiptHeader", "sp_get_srn_items", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable Get_serial_by_itm_stus(string company, string location, string itemCode, string _stus, string serial)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_get_serial_by_itm_stus", CommandType.StoredProcedure, false, param);

            return dt;
        }
        //kapila
        public DataTable get_orig_inv_dt(string _company, string _invoice)
        {
            //sp_getwarrantysearch(p_com in NVARCHAR2,p_serial1 in NVARCHAR2,p_serial2 in NVARCHAR2,p_warranty in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_get_orig_inv_dt", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //kapila
        public DataTable getMstSysParam(string _com, string _pty_tp, string _pty_cd, string _rest_tp, string _brand, string _cat)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_tp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_cd;
            (param[3] = new OracleParameter("p_rest_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rest_tp;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_Get_mst_sys_param", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public Int16 UpdateReqStatusByReqNo(string _reqno, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatereqhdrbyreqno", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public DataTable GetINRSERMST_Rcc(string _company, string _loc, string _serial, string _war, string _inv, string _doc)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_war", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _war;
            (param[4] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[5] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_search_warranty_data_rcc", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public int SaveInventoryRequestItmBal(InventoryReqItemBal _inventoryReqItmBal)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_irb_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_SEQ;
            (param[1] = new OracleParameter("p_irb_rt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_RT_CD;
            (param[2] = new OracleParameter("p_irb_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_ITM;
            (param[3] = new OracleParameter("p_irb_req_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_REQ_LINE;
            (param[4] = new OracleParameter("p_irb_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_LINE;
            (param[5] = new OracleParameter("p_irb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_LOC;
            (param[6] = new OracleParameter("p_irb_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_STUS;
            (param[7] = new OracleParameter("p_irb_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryReqItmBal.IRB_QTY;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_updateinvreqitmbal", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //kapila
        public DataTable GetRootBalances(string _com, string _loc, string _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_root_bal", CommandType.StoredProcedure, false, param);

            return dt;
        }
        //kapila
        public Int16 Update_MRN_Ref_By_MRN(string _reqdno, string _mrnno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqdno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrnno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_mrnrefbymrn", CommandType.StoredProcedure, param);
            return effects;
        }
        public bool Is_Found_Mst_Sys_Para(string _company, string _loc, string _type)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tbl", "SP_IS_FOUND_MST_SYS_PARA_NEW", CommandType.StoredProcedure, false, param);
            bool _isValid = false;
            if (_tbl != null)
            {
                if (_tbl.Rows.Count > 0)
                {
                    _isValid = true;
                }
            }

            return _isValid;
        }

        ////dilshan on 05/12/2018
        //public bool Is_Found_Ref_Mrnauto_Para(string _company, string _loc, string _type)
        //{
        //    OracleParameter[] param = new OracleParameter[4];
        //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
        //    (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
        //    (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

        //    param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
        //    DataTable _tbl = QueryDataTable("tbl", "SP_IS_FOUND_REF_MRNAUTO_PARA", CommandType.StoredProcedure, false, param);
        //    bool _isValid = false;
        //    if (_tbl != null)
        //    {
        //        if (_tbl.Rows.Count > 0)
        //        {
        //            _isValid = true;
        //        }
        //    }

        //    return _isValid;
        //}
        public List<ReptPickSerials> GetAvailableSerials(string company, string location)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_getavailableserials", CommandType.StoredProcedure, false, param);

            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();

            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }
        //kapila
        public DataTable GetTaxStrucData(string _com, string _item)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_tax_by_itm", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable Get_SCV_Area()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_scv_area", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable ProcessMovementListing(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[9] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[10] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[11] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inv_reports.PROC_MOVEMENT_LISTING", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_DocBy_Job(string _com, string _loc, DateTime _date, string _job)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_docno_byjob", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable Get_DocBy_Rcc(string _com, string _loc, DateTime _date, string _job, string _rcc, string _rccloc)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[4] = new OracleParameter("p_rcc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc;
            (param[5] = new OracleParameter("p_rccloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccloc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_docno_byrcc", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable Get_Movment_Details(string _req)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mov", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_mov_det_byReq", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable Get_MRN_Prefer_Loc(string _company, string _Item)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getmrnpreferlocs", CommandType.StoredProcedure, false, param);

            return dt;
        }


        public DataTable Get_Dispatch_Details(string _req)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_disp_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getwarehousereqdetbyreq", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public Int32 Import_SI(string _SI, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_SI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SI;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_import_si", CommandType.StoredProcedure, param);
            return result;
        }

        public DataTable ProcessInventoryStatement_SCM(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[9] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[10] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[11] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.PROC_INVENTORY_STATEMENT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getMstSysPara(string _com, string _pty_tp, string _pty_cd, string _rest_tp, string _dir_pry_cd)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_tp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_cd;
            (param[3] = new OracleParameter("p_rest_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rest_tp;
            (param[4] = new OracleParameter("p_dir_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dir_pry_cd;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_Get_mst_sys_para", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Int16 UpdateDispatchRequestStatus(string _com, string _loc, string _quono)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_quono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quono;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_dispatchreqstatus", CommandType.StoredProcedure, param);
            return effects;
        }

        public int UpdateInventoryRequestStusByRef(InventoryRequest _inventoryRequest)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_ref;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[6] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_int_req_stus_byref", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        public DataTable getNextSerialSCM(string _com, string _loc, string _item, string _stus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getnextserSCM", CommandType.StoredProcedure, false, param);
            return _result;
        }

        /// <summary>
        /// getSerialSCMToMob By DULANGA 2017-2-2 
        /// </summary>
        /// <param name="_com"></param>
        /// <param name="_loc"></param>
        /// <param name="_serial"></param>
        /// <returns></returns>
        public DataTable getSerialSCMToMob(string _com, string _loc, string _serial, string _item)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_GetSerialInfoBySerialNoMOB", CommandType.StoredProcedure, false, param);
            return _result;

        }

        public Int16 UpdateDispatchRequestDocNo(string _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_dispatchreqdocno", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable IsValid_SCM_Serial(string _com, string _loc, string _item, string _ser)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (_para[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (_para[3] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;

            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_getavailableserSCM", CommandType.StoredProcedure, false, _para);

            return _result;
        }
        public Int16 ReserveSerialSCM(string _ref, string _com, string _loc, string _item, string _serial)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_upd_inv_item_serial_det", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }
        public Int16 UpdateAutoNumberSCM(string _loc, string _module)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_updateautonoscm", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        public DataTable getAutoNumberSCM(string _loc, string _module)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_AUTONUM_SCM", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public Int16 save_dispatch_req_whouse_det(InventoryRequestItem _reqItm, string _appSeqNo, string _seqno, string _itmStus)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_DISP_APP_SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appSeqNo;
            (param[1] = new OracleParameter("p_DISP_REQ_LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_line_no;
            (param[2] = new OracleParameter("p_DISP_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqItm.Itri_itm_cd;
            (param[3] = new OracleParameter("p_DISP_ITEM_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStus;
            (param[4] = new OracleParameter("p_DISP_ITEM_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[5] = new OracleParameter("p_DISP_ITEM_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[6] = new OracleParameter("p_DISP_CURRENT_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[7] = new OracleParameter("p_DISP_CANCEL_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[8] = new OracleParameter("p_DISP_RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[9] = new OracleParameter("p_DISP_RES_LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[10] = new OracleParameter("p_DISP_RES_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[11] = new OracleParameter("p_DISP_RES_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[12] = new OracleParameter("p_DISP_RES_BALQTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[13] = new OracleParameter("p_DISP_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[14] = new OracleParameter("p_DISP_CREATE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now.ToShortDateString();
            (param[15] = new OracleParameter("p_DISP_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[16] = new OracleParameter("p_DISP_LAST_MODIFY_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now.ToShortDateString();
            (param[17] = new OracleParameter("p_DISP_AVAILABLE_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[18] = new OracleParameter("p_DISP_ANY_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;

            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_dispatch_whouse_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 save_dispatch_req_whouse_hdr(InventoryRequest _req, string _appSeqNo, string _seqno)
        {
            OracleParameter[] param = new OracleParameter[18];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_DISP_APP_SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _appSeqNo;
            (param[1] = new OracleParameter("p_DISP_REQ_SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqno;
            (param[2] = new OracleParameter("p_DISP_FROM_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_issue_from;
            (param[3] = new OracleParameter("p_DISP_TO_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_loc;
            (param[4] = new OracleParameter("p_DISP_REQ_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "APPROVED";
            (param[5] = new OracleParameter("p_CREATED_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "AUTO_Q";
            (param[6] = new OracleParameter("p_CREATED_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[7] = new OracleParameter("p_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_cre_by;
            (param[8] = new OracleParameter("p_LAST_MODIFY_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[9] = new OracleParameter("p_DISP_APP_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[10] = new OracleParameter("p_DISP_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_com;
            (param[11] = new OracleParameter("p_PDA_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[12] = new OracleParameter("p_DISP_DOC_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "MRN_APP";
            (param[13] = new OracleParameter("p_DISP_SO_RES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[14] = new OracleParameter("p_DISP_IS_TRANS_REQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[15] = new OracleParameter("p_DISP_PICK_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[16] = new OracleParameter("p_DISP_CUST_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;

            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_dispatch_whouse_hdr", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 save_dispatch_request_details(InventoryRequestItem _reqItm, string _seqno, DateTime _Dispd_date, string _itmStus, string _itmDesc, string _model, string _brand)
        {
            OracleParameter[] param = new OracleParameter[41];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_DISPD_REQT_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_DISPD_LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_line_no;
            (param[2] = new OracleParameter("p_DISPD_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Dispd_date;
            (param[3] = new OracleParameter("p_DISPD_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqItm.Itri_itm_cd;
            (param[4] = new OracleParameter("p_DISPD_REQUSTED_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[5] = new OracleParameter("p_DISPD_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[6] = new OracleParameter("p_DISPD_ITEM_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStus;
            (param[7] = new OracleParameter("p_DISPD_APPROVED_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[8] = new OracleParameter("p_DISPD_APPROVED_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqItm.Itri_itm_cd;
            (param[9] = new OracleParameter("p_DISPD_ITEM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmDesc;
            (param[10] = new OracleParameter("p_DISPD_ITEM_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_DISPD_REMARKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[12] = new OracleParameter("p_DISPD_SHOP_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[13] = new OracleParameter("p_DISPD_FORWARD_SALES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[14] = new OracleParameter("p_DISPD_BUFFER_LIMIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[15] = new OracleParameter("p_DISPD_SR_REQUEST_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[16] = new OracleParameter("p_DISPD_ITEM_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[17] = new OracleParameter("p_DISPD_AOD_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _reqItm.Itri_qty;
            (param[18] = new OracleParameter("p_DISPD_RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[19] = new OracleParameter("p_DISPD_RES_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[20] = new OracleParameter("p_DISPD_RES_LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[21] = new OracleParameter("p_DISPD_RES_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[22] = new OracleParameter("p_DISPD_RES_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[23] = new OracleParameter("p_DISPD_RES_BALQTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[24] = new OracleParameter("p_DISPD_CHK_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[25] = new OracleParameter("p_DISP_PRO_IN_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[26] = new OracleParameter("p_DISP_MRN_BAL_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[27] = new OracleParameter("p_DISP_COST_APPLICABLE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[28] = new OracleParameter("p_DISP_ALTERNATE_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[29] = new OracleParameter("p_DISP_PRO_OUT_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[30] = new OracleParameter("p_DISP_KIT_ITEM_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[31] = new OracleParameter("p_DISPD_CAN_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[32] = new OracleParameter("p_DISPD_BAL_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[33] = new OracleParameter("p_DISP_RTN_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[34] = new OracleParameter("p_DISP_ANY_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[35] = new OracleParameter("p_DISP_SO_RES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[36] = new OracleParameter("p_DISP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = null;
            (param[37] = new OracleParameter("p_DISP_BASE_KLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = null;
            (param[38] = new OracleParameter("p_DISP_BASE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = null;
            (param[39] = new OracleParameter("p_DISPF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = null;

            param[40] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_dispatch_request_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 save_dispatch_request(InventoryRequest _req, string _seqno)
        {
            OracleParameter[] param = new OracleParameter[39];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_DISP_REQT_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_DISP_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_req_no;
            (param[2] = new OracleParameter("p_DISP_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_loc;
            (param[3] = new OracleParameter("p_DISP_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[4] = new OracleParameter("p_DISP_AUTHORIZED_BY1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "AUTO_Q";
            (param[5] = new OracleParameter("p_DISP_AUTHORIZED_BY2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[6] = new OracleParameter("p_DISP_AUTHORIZED_BY3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[7] = new OracleParameter("p_DISP_CREATED_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_cre_by;
            (param[8] = new OracleParameter("p_DISP_APPROVED_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[9] = new OracleParameter("p_DISP_CREATED_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[10] = new OracleParameter("p_DISP_COMMENTS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_note;
            (param[11] = new OracleParameter("p_DISP_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "APPROVED";
            (param[12] = new OracleParameter("p_DISP_REQ_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "MANAGER";
            (param[13] = new OracleParameter("p_DISP_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_com;
            (param[14] = new OracleParameter("p_DISP_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "SR_REQ_APP";
            (param[15] = new OracleParameter("p_DISP_PREFER_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_issue_from;
            (param[16] = new OracleParameter("p_DISP_REQUEST_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "NOR";
            (param[17] = new OracleParameter("p_DISP_LAST_MODIFY_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_cre_by;
            (param[18] = new OracleParameter("p_DISP_LAST_MODIFY_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[19] = new OracleParameter("p_DISP_PRODUCTION_STAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[20] = new OracleParameter("p_DISP_PRODUCTION_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req.Itr_ref;
            (param[21] = new OracleParameter("p_DISP_SUB_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[22] = new OracleParameter("p_MAIN_MRN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[23] = new OracleParameter("p_PRO_MRN_SUB_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "MAIN";
            (param[24] = new OracleParameter("p_DISP_REQUEST_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _req.Itr_dt;
            (param[25] = new OracleParameter("p_DISP_AODNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[26] = new OracleParameter("p_DISP_DEL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[27] = new OracleParameter("p_DIPS_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[28] = new OracleParameter("p_DISP_SKIP_APP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[29] = new OracleParameter("p_DISP_PDA_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[30] = new OracleParameter("p_DISP_COLLECTOR_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[31] = new OracleParameter("p_DISP_COLLECTOR_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "N/A";
            (param[32] = new OracleParameter("p_DISP_CUST_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[33] = new OracleParameter("p_DISP_TEMP_LOCA", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[34] = new OracleParameter("p_DISP_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[35] = new OracleParameter("p_DISP_DOC_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[36] = new OracleParameter("p_DISP_SKD_REQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            (param[37] = new OracleParameter("p_disp_is_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
            param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_dispatch_request", CommandType.StoredProcedure, param);
            return effects;
        }

        public MasterCompany GetCompByCode(string _CompCode)
        {
            MasterCompany _userList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblcomp", "SP_GET_COMP_BY_CODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<MasterCompany>(_dtResults, MasterCompany.Converter)[0];
            }
            return _userList;
        }

        public DataTable ConsignDetailsReport(DateTime _fromDate, DateTime _toDate, string _com, string _user, string _pb, string _pblvl)
        {
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[5] = new OracleParameter("in_pb_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_consign_dtl", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getItemListDetails(string _cat, string _cat1)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat;
            (param[2] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;

            DataTable _result = QueryDataTable("tbl", "sp_get_item_list", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable CusDecEntryRequest(string in_user, string in_Company, DateTime in_fromdate, DateTime in_todate, string in_subtp, Int32 _in_isall)
        {
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[2] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[3] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_fromdate;
            (param[4] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_todate;
            (param[5] = new OracleParameter("in_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_subtp;
            (param[6] = new OracleParameter("in_isall", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _in_isall;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.SP_PRINT_CUSDEC_REQ_ENTRY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //dilshan on 22/03/2018
        public DataTable TRNoteRequest(string in_user, string in_Company, DateTime in_fromdate, DateTime in_todate, string in_subtp, Int32 _in_isall, string in_docno,string entry01,string entry02)
        {
            OracleParameter[] param = new OracleParameter[7];
            //param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //(param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            //(param[2] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            //(param[3] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_fromdate;
            //(param[4] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_todate;
            //(param[5] = new OracleParameter("in_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_subtp;
            //(param[6] = new OracleParameter("in_isall", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _in_isall;

            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_docno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_fromdate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_todate;
            (param[4] = new OracleParameter("p_cuic_doc_no_01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entry01;
            (param[5] = new OracleParameter("p_cuic_doc_no_02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entry02;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "getTRNoteRequest", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getAsAtAgeDetails(DateTime _from, DateTime _to, string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcat4, string _itemcat5,
    string _itemcode, string _brand, string _model, string _supplier, string _user, string _brndMan, Int16 _isComAge, string _pb, string _pblvl)
        {
            OracleParameter[] param = new OracleParameter[19];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_do_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_do_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[6] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[7] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[8] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat4;
            (param[9] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat5;
            (param[10] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[11] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[13] = new OracleParameter("in_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[14] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[15] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[16] = new OracleParameter("in_is_com_age", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isComAge;
            //Wimal @ 09/09/2018 - get price to age report
            (param[17] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[18] = new OracleParameter("in_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_asat_age_scm_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getAgeSummery(DateTime _from, DateTime _to, DateTime _pre, string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcat4, string _itemcat5,
    string _itemcode, string _brand, string _model, string _supplier, string _user, string _brndMan, Int16 _isComAge, string _pb, string _pblvl)
        {
            OracleParameter[] param = new OracleParameter[20];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("in_predate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _pre;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[9] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat4;
            (param[10] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat5;
            (param[11] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[12] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[13] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[14] = new OracleParameter("in_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[15] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[16] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[17] = new OracleParameter("in_is_com_age", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isComAge;
            //Wimal @ 09/09/2018 - get price to age report
            (param[18] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[19] = new OracleParameter("in_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "SP_GET_AGE_SUMMERY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int16 UpdateInvoicveDODate(string _invno, Int16 _invlineno, DateTime _dodate)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invlineno;
            (param[2] = new OracleParameter("p_do_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dodate;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_invdoitems", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable ReservationReport(string in_user, string in_Company, string in_loc, DateTime in_fromdate, DateTime in_todate, DateTime in_expdate, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model)
        {
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[2] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[3] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_fromdate;
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_todate;
            (param[6] = new OracleParameter("p_expdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_expdate;
            (param[7] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[8] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[9] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[10] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[11] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[12] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[13] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[14] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.SP_PRINT_RESERVATION", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable MRNStatusReport(string in_user, string in_Company, string in_loc, string in_to, DateTime in_fromdate, DateTime in_todate, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model)
        {
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[2] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[3] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[4] = new OracleParameter("in_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_to;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_fromdate;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_todate;
            (param[7] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[8] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[9] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[10] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[11] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[12] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[13] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[14] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.SP_PRINT_MRN_STUS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //public DataTable SRMRNStatusReport(string in_user, string in_Company, string in_loc, string in_to, DateTime in_fromdate, DateTime in_todate, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model)
        //{
        //    OracleParameter[] param = new OracleParameter[15];
        //    param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
        //    (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
        //    (param[2] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
        //    (param[3] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
        //    (param[4] = new OracleParameter("in_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_to;
        //    (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_fromdate;
        //    (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_todate;
        //    (param[7] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
        //    (param[8] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
        //    (param[9] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
        //    (param[10] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
        //    (param[11] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
        //    (param[12] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
        //    (param[13] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
        //    (param[14] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;

        //    DataTable _dtResults = QueryDataTable("tbl", "sp_get_sr_mrn_stus", CommandType.StoredProcedure, false, param);
        //    return _dtResults;
        //}

        public DataTable SRMRNStatusReport(DateTime _fromtDate, DateTime _totDate, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _Com, string _Loc, string _OtherLoc, string _User)
        {
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromtDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _totDate;
            (param[3] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[6] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[7] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[8] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[9] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[10] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[12] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OtherLoc;
            (param[14] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            return QueryDataTable("int_hdr", "sp_get_disp_app_mrn_dtl", CommandType.StoredProcedure, false, param);
        }

        public DataTable ToBondStatusReport(DateTime _fromdate, DateTime _todate, string _tobondno, string _grnno, string _reqno, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model, string in_loc)
        {
            OracleParameter[] param = new OracleParameter[17];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobondno;
            (param[4] = new OracleParameter("in_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _grnno;
            (param[5] = new OracleParameter("in_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[6] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[7] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[8] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[9] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[10] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[11] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[12] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[13] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[14] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[15] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[16] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.SP_PRINT_TOBOND_STUS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ImportScheduleReport(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_imp_schedule_hdr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ImportScheduleSun(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_imp_schedule_sun", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ImportScheduleGRNDtl(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_imp_schedule_grn_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ImportScheduleReport_Excel(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_imp_schedule_hdr1", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable PickPlanReport(DateTime _fromdate, DateTime _todate, string in_Company, string _loc, string in_user_id, string _docno, string _route, string _reqtp, int timeSelect)
        {
            OracleParameter[] param = new OracleParameter[10];
            DataTable _dtResults = new DataTable();
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[7] = new OracleParameter("in_route", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route;
            (param[8] = new OracleParameter("in_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqtp;
            (param[9] = new OracleParameter("in_timeSelect", OracleDbType.Int16, null, ParameterDirection.Input)).Value = timeSelect;
            if (in_Company == "AAL")
            {
                _dtResults = QueryDataTable("tbl", "sp_get_pick_plan_AAL", CommandType.StoredProcedure, false, param);//sp_get_pick_plan - sp_get_pick_plan_UdayaForTest - sp_get_pick_plan_AAL
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "sp_get_pick_plan", CommandType.StoredProcedure, false, param);//sp_get_pick_plan - sp_get_pick_plan_UdayaForTest
            }
            return _dtResults;
        }

        public DataTable IntertransferDtlReport(DateTime _fromdate, DateTime _todate, string in_Company, string _fromloc, string _toloc, string in_user_id, string _docno, string _route, string _status)
        {
            OracleParameter[] param = new OracleParameter[10];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[5] = new OracleParameter("in_toloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[6] = new OracleParameter("in_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[8] = new OracleParameter("in_route", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route;
            (param[9] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_intr_app_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable MRNPRintReport(string _docno)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mrn_print", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ItemBufferStatusReport(string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model, string in_loc, string _in_subtp)
        {
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[2] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[4] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[5] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[6] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[7] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[8] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[9] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[11] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[12] = new OracleParameter("in_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _in_subtp;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.SP_PRINT_ITEM_BUFFER_STUS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Update_Manual_DocNo_prefix(string _Loc, string _DocType, Int32 _DocNo, string _TxnNo, string _prefix)
        {

            OracleParameter[] param1 = new OracleParameter[6];
            Int32 effects = 0;

            (param1[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param1[1] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param1[2] = new OracleParameter("p_docno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _DocNo;
            (param1[3] = new OracleParameter("p_txnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TxnNo;
            (param1[4] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;

            param1[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_manual_docno_prefix", CommandType.StoredProcedure, param1);


            //update document pages
            DateTime _cDate = DateTime.Now.Date;
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_txnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TxnNo;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cDate;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param[4] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;
            (param[5] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_update_man_doc_pages_prefix", CommandType.StoredProcedure, false, param);


            return 1;

        }

        public DataTable GetTempManualDocDet(string _User)
        {
            //(p_user in string,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblManualDocDet", "SP_GET_MANUAL_DOC_DET", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Get_manual_docs_ByRef(string _ref)
        {
            //(p_ref in NVARCHAR2,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            DataTable _dtResults = null;
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "sp_get_manual_docs_ByRef", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public List<ManualDocDetail> Get_manual_doc(string p_ref, string p_itmCd, string p_prifix, string p_bookNo)
        {
            List<ManualDocDetail> _list = null;
            //(p_ref in NVARCHAR2,p_itmCd in NVARCHAR2,p_prifix in NVARCHAR2,p_bookNo in NUMBER,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ref;
            (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itmCd;
            (param[2] = new OracleParameter("p_prifix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_prifix;
            (param[3] = new OracleParameter("p_bookNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bookNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblManDoc = QueryDataTable("_tblBalance", "sp_get_manual_doc", CommandType.StoredProcedure, false, param);
            if (_tblManDoc.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ManualDocDetail>(_tblManDoc, ManualDocDetail.Converter);
            }
            return _list;


        }
        public DataTable GetLastNoSeqPageDetails(DateTime _asAtDate, string _Loc)
        {
            // Sanjeewa 06-05-2013         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_AS_AT_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_manual_doc_details1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public int UpdateGntManDocPages(string _prefix, string _loc, string _code, int _current, int _last, string _user, string _rmk)
        {
            int effected = 0;
            ConnectionOpen();
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            (param[1] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_current", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _current;
            (param[4] = new OracleParameter("p_last", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _last;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_update_gnt_man_doc_pages", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }
        public int UpdateGntManDocDt(string _loc, string _code, string _type, int _current, string _prefix, string _bookNo)
        {
            int effected = 0;
            ConnectionOpen();
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_current", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _current;
            (param[4] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            (param[5] = new OracleParameter("p_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bookNo;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_update_gnt_man_doc_dt1", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }
        public DataTable Get_all_manual_docs_by_type(string _loc, string _code)
        {

            //ConnectionOpen();
            DataTable dt;
            ConnectionOpen();
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_loc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbl_ManDocs", "sp_get_manual_docs_by_type", CommandType.StoredProcedure, false, param);
            //ConnectionClose();

            return dt;
        }
        public Int16 DeleteTempPickSer(string _docno)
        {
            Int16 rows_affected = 0;

            OracleCommand CMD = new OracleCommand("sp_del_temp_pick_ser", oConnection);
            CMD.CommandType = CommandType.StoredProcedure;
            CMD.Parameters.Add("p_docno", OracleDbType.NVarchar2).Value = _docno;

            CMD.ExecuteNonQuery();


            return rows_affected;
        }
        public int Save_manual_doc_pages(Int32 _userseqno, string _refNo)
        {
            int rows_effected = 0;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_userseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _userseqno;
            (param[1] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            return rows_effected = UpdateRecords("sp_save_manual_doc_pages", CommandType.StoredProcedure, param);

        }
        public Int32 delete_temp_current_receipt(string _User, string _Prefix, Int32 _RecNo)
        {

            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[1] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param[2] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RecNo + 1;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_del_tmp_col_man_doc_dt", CommandType.StoredProcedure, param);
            return effects;

        }
        public Int32 delete_temp_current_receipt_det(string _User, string _module)
        {

            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[1] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_del_tmp_cur_rec_dt", CommandType.StoredProcedure, param);
            return effects;

        }
        public int save_temp_existing_receipt_det(string _User, string _Loc, string _item, string _Prefix, Int32 _Recno, string _module)
        {
            string _sql = "";
            string _BookNo = "";

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param[3] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Recno;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_manual_bookno", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                _BookNo = Convert.ToString(_result.Rows[0]["mdd_bk_no"]);
            }

            OracleParameter[] param1 = new OracleParameter[5];

            (param1[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param1[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param1[2] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param1[3] = new OracleParameter("p_bookno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _BookNo;

            param1[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result1 = QueryDataTable("tbl", "sp_get_cur_rec_no", CommandType.StoredProcedure, false, param1);

            if (_result1.Rows.Count > 0)
            {
                Int32 v_cur = Convert.ToInt32(_result1.Rows[0]["mdd_current"]);
                string v_bookno = Convert.ToString(_result1.Rows[0]["mdd_bk_no"]);
                Int32 v_first = Convert.ToInt32(_result1.Rows[0]["mdd_first"]);
                Int32 v_last = Convert.ToInt32(_result1.Rows[0]["mdd_last"]);

                OracleParameter[] param2 = new OracleParameter[11];
                Int32 effects = 0;

                (param2[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
                (param2[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param2[2] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
                (param2[3] = new OracleParameter("p_bookno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BookNo;
                (param2[4] = new OracleParameter("p_cur", OracleDbType.Int32, null, ParameterDirection.Input)).Value = v_cur;
                (param2[5] = new OracleParameter("v_bookno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = v_bookno;
                (param2[6] = new OracleParameter("v_first", OracleDbType.Int32, null, ParameterDirection.Input)).Value = v_first;
                (param2[7] = new OracleParameter("v_last", OracleDbType.Int32, null, ParameterDirection.Input)).Value = v_last;
                (param2[8] = new OracleParameter("v_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
                (param2[9] = new OracleParameter("v_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;

                param2[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int32)UpdateRecords("sp_tmp_collect_man_doc_dt", CommandType.StoredProcedure, param2);

                Boolean _isCurRecSuccess = check_temp_current_receipt_book(_Loc, _item, _Prefix, _BookNo, _Recno, _User, _module);
                if (_isCurRecSuccess == true)
                {
                    save_temp_current_receipt_det(_User, _Loc, _item, _Prefix, _BookNo, _Recno + 1, _module);
                }
            }

            return 1;

        }
        private void save_temp_current_receipt_det(string _User, string _Loc, string _item, string _Prefix, string _bookno, Int32 _Recno, string _module)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param[4] = new OracleParameter("p_bookno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bookno;
            (param[5] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Recno;
            (param[6] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_tmp_cur_rec_dt", CommandType.StoredProcedure, param);

        }
        public Boolean Check_Temp_coll_Man_doc_dt(string _User, string _Loc, string _item, string _Prefix, Int32 _Recno, string _module)
        {
            Boolean Save_Success = true;
            try
            {

                string _BkNo = get_Manual_bookno(_User, _Loc, _item, _Prefix, _Recno);

                Boolean _IsOk = check_current_receipt_book(_Loc, _item, _Prefix, _BkNo, _Recno);
                if (_IsOk == false)
                {
                    Boolean _isCurRecSuccess = check_temp_current_receipt_book(_Loc, _item, _Prefix, _BkNo, _Recno, _User, _module);
                    if (_isCurRecSuccess == false)
                    {
                        Save_Success = false;
                        return Save_Success;
                    }
                }

                if (Save_Success == true)
                {
                    //save_temp_current_receipt_det(_User, _Loc, _item, _Prefix, _BkNo, _Recno + 1,_module);
                }

            }

            catch (Exception e)
            {
                Save_Success = false;
                throw new Exception(e.Message);
            }

            return Save_Success;
        }
        private Boolean check_temp_current_receipt_book(string _Loc, string _item, string _Prefix, string _BookNo, Int32 _Recno, string _user, string _Module)
        {
            Boolean _ok = false;

            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param[2] = new OracleParameter("p_bookno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BookNo;
            (param[3] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Recno;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Module;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_chk_tmp_cur_rec_bk", CommandType.StoredProcedure, param);

            if (effects == 1)
            {
                _ok = false;
            }
            else
            {
                _ok = true;
            }

            return _ok;
        }
        private Boolean check_current_receipt_book(string _Loc, string _item, string _Prefix, string _BookNo, Int32 _Recno)
        {
            //Check_Current_Receipt_Book
            Boolean _ok = false;

            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param[3] = new OracleParameter("p_bookno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BookNo;
            (param[4] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Recno;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_chk_cur_rec_bk", CommandType.StoredProcedure, param);

            if (effects == 1)
            {
                _ok = true;
            }
            else
            {
                _ok = false;
            }

            return _ok;
        }
        private string get_Manual_bookno(string _User, string _Loc, string _item, string _Prefix, Int32 _Recno)
        {
            string _BookNo = "";

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Prefix;
            (param[3] = new OracleParameter("p_recno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Recno;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_manual_bookno", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                _BookNo = Convert.ToString(_result.Rows[0]["mdd_bk_no"]);
            }

            return _BookNo;

        }
        public Boolean IsValidManualDocument(string _Comp, string _Loc, string _DocType, Int32 _NextNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param[2] = new OracleParameter("p_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NextNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_is_valid_manual_no", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                return true;
            }
            else
            {
                return false;
            }


        }
        public Int32 GetNextManualDocNo(string _Comp, string _Loc, string _DocType)
        {

            Int32 _NextNo = 0;

            OracleParameter[] param1 = new OracleParameter[4];

            (param1[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Comp;
            (param1[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param1[2] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;

            param1[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _NextNo = (Int32)UpdateRecords("sp_getnextmanualdocno", CommandType.StoredProcedure, param1);

            return _NextNo;

        }
        public Int32 UpdateManualDocNo(string _Loc, string _DocType, Int32 _DocNo, string _TxnNo)
        {


            OracleParameter[] param1 = new OracleParameter[5];
            Int32 effects = 0;

            (param1[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param1[1] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param1[2] = new OracleParameter("p_docno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _DocNo;
            (param1[3] = new OracleParameter("p_txnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TxnNo;

            param1[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_update_manual_docno", CommandType.StoredProcedure, param1);


            //update document pages
            DateTime _cDate = DateTime.Now.Date;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_txnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TxnNo;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cDate;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param[4] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 _effect = (Int32)UpdateRecords("sp_update_man_doc_pages", CommandType.StoredProcedure, param);


            return 1;

        }
        public Boolean IsValidManualDocument_prefix(string _Comp, string _Loc, string _DocType, Int32 _NextNo, string _prefix)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param[2] = new OracleParameter("p_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NextNo;
            (param[3] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_is_valid_manual_no_prefix", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                return true;
            }
            else
            {
                return false;
            }


        }
        //kapila
        public DataTable GetManualDocBookNo(string _Comp, string _Loc, string _DocType, Int32 _NextNo, string _prefix)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocType;
            (param[2] = new OracleParameter("p_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NextNo;
            (param[3] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_MANUAL_BK_NO", CommandType.StoredProcedure, false, param);

            return _dtResults;

        }

        //kapila
        public DataTable getReqHdrByReqNo(string _com, string _pc, string _req)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getreqhdrby_reqno", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        //kapila
        public Int32 UpdateTempWaraUpload(string Str_DO_No, DateTime Str_warrantystartdate, Int32 Str_warrantyperiod, string Str_salesorderno,
            string Str_customerphoneno, DateTime Str_podate,
            string Str_invoiceno, string Str_location, string Str_itemcode, string Str_serialno,
            String Str_Item_Status, decimal Str_Unit_Price, string Str_WarrNo, string Str_NewWarrNo, string Str_grn_no, DateTime Str_grn_date,
            string Str_supp_code, string Str_chassis_no)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_transactionno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_DO_No;
            (param[1] = new OracleParameter("p_warrantystartdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Str_warrantystartdate;
            (param[2] = new OracleParameter("p_warrantyperiod", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Str_warrantyperiod;
            (param[3] = new OracleParameter("p_salesorderno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_salesorderno;

            (param[4] = new OracleParameter("p_customerphoneno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_customerphoneno;
            (param[5] = new OracleParameter("p_podate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Str_podate;
            (param[6] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_invoiceno;
            (param[7] = new OracleParameter("p_transaction_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_location;
            //(param[11] = new OracleParameter("p_warrem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_warranty_remarks;
            (param[8] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_itemcode;
            (param[9] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_serialno;
            //  (param[14] = new OracleParameter("p_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_Reg_No;
            (param[10] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_Item_Status;
            (param[11] = new OracleParameter("p_unitprice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Str_Unit_Price;
            (param[12] = new OracleParameter("p_warrantyno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_WarrNo;
            (param[13] = new OracleParameter("p_newwarno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_NewWarrNo;
            (param[14] = new OracleParameter("p_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_grn_no;
            (param[15] = new OracleParameter("p_grndate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Str_grn_date;
            (param[16] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_supp_code;
            (param[17] = new OracleParameter("p_chasis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_chassis_no;
            //   (param[23] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Str_acc_no;

            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_upd_temp_wara_upload", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public DataTable Get_TempIssued_Items(string Com, string _mloc, string _sloc, string _Type)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_MLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mloc;
            (param[2] = new OracleParameter("P_SLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sloc;
            (param[3] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPISSUE", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable getSubLocationStock(string _com, string _mloc, string _sloc, Int32 _isOpr, DateTime _endDate, string _user, Int32 _isRep)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mloc;
            (param[2] = new OracleParameter("p_sloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sloc;
            (param[3] = new OracleParameter("p_is_opr_til", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isOpr;
            (param[4] = new OracleParameter("p_end_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _endDate.Date;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_isrep", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isRep;

            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_inventory.sp_get_sub_loc_stock", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public Int32 UPD_TMP_ISSUE_RET(string _com, string _loc, string _item, string _ser, string _doctp)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("P_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("P_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[4] = new OracleParameter("P_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_UPD_TMP_ISSUE_RET", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public DataTable PrintTempIssueItems(string _com, string _loc, DateTime _fromDate, DateTime _toDate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;

            param[4] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_rep_sales.Print_temp_issue_items", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable PrintMoveCostDetailReport(string _com, string _loc, DateTime in_FromDate, DateTime in_ToDate, string _doctp, string _direct, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model, string _docno)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[16];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("in_DOCTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[5] = new OracleParameter("in_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _direct;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[7] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[9] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[10] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[11] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[12] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[13] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[14] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_mov_cost_detail", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable PrintTransDetListReport(string _com, string _loc, DateTime in_FromDate, DateTime in_ToDate, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_trans_det_list", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable SerialAgeReport_SCM(DateTime in_AsatDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model, string in_itemsStatus, string in_loc, Int32 in_age_frm, Int32 in_age_to)
        {
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asAtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_AsatDate;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[9] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[10] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[11] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[12] = new OracleParameter("in_itemsStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_itemsStatus;
            (param[13] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[14] = new OracleParameter("in_age_frm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_age_frm;
            (param[15] = new OracleParameter("in_age_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_age_to;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.PROC_SERIAL_AGE_REPORT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable GetStockBalanceWithSerial_Asat_SCM(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
    string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, DateTime _asatdate, Int16 _serialrep, Int16 _status, string _Loc, string _Com)
        {
            //Sanjeewa 2013-03-01
            //Change the pkg_inv_bal.PROC_INVENTORY_BALANCE -->pkg_inv_bal.PROC_INVENTORY_BALANCE_NEW by Nadeeka - opening balance getting from the opening balance table.
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[13] = new OracleParameter("in_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            (param[14] = new OracleParameter("IN_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[15] = new OracleParameter("IN_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            DataTable _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INV_BALANCE_SER_ASAT", CommandType.StoredProcedure, false, param);
            //DataTable _tblData = QueryDataTable("tbData", "pkg_scm_reports.PROC_INV_BALANCE_SER_ASAT", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetItemConditionDetail(string _itemcode, string _brand, string _model, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcat4, string _itemcat5,
            string _Itemstatus, string _Com, string _Loc, string _condtp, string _user, string _itemcond, string _allroute, string _route)
        {
            //Sanjeewa 2017-02-17            
            OracleParameter[] param = new OracleParameter[17];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[2] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[3] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[4] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[5] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[6] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[7] = new OracleParameter("in_Itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat4;
            (param[8] = new OracleParameter("in_Itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat5;
            (param[9] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[10] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[11] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[12] = new OracleParameter("in_cond_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _condtp;
            (param[13] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[14] = new OracleParameter("in_itm_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcond;
            (param[15] = new OracleParameter("in_all_route", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _allroute;
            (param[16] = new OracleParameter("in_route", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_itm_cond_dtl", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //kapila
        public DataTable GetStockBalanceWithCost_SCM(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
  string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, DateTime _asatdate, Int16 _serialrep, Int16 _status, string _Loc, string _Com)
        {
            //Sanjeewa 2013-03-01
            //Change the pkg_inv_bal.PROC_INVENTORY_BALANCE -->pkg_inv_bal.PROC_INVENTORY_BALANCE_NEW by Nadeeka - opening balance getting from the opening balance table.
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[13] = new OracleParameter("in_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            (param[14] = new OracleParameter("IN_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[15] = new OracleParameter("IN_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            DataTable _tblData = QueryDataTable("tbData", "pkg_scm_reports.PROC_INVENTORY_BALANCE_ASAT", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public DataTable get_ref_rpt_para(string _pty_tp, string _pty_cd)
        {
            // kapila 17/12/2015
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_tp;
            (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_cd;

            DataTable dt = QueryDataTable("tbl", "sp_get_rpt_para", CommandType.StoredProcedure, false, param);

            return dt;
        }

        //kapila
        public DataTable AgeReport_SCM(DateTime in_AsatDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model, string in_itemsStatus, string in_loc, Int32 _inparafrm, Int32 _inparato, Int32 _inparacd)
        {   // kapila 16/12/2015
            OracleParameter[] param = new OracleParameter[17];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asAtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_AsatDate;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[9] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[10] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[11] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[12] = new OracleParameter("in_itemsStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_itemsStatus;
            (param[13] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[14] = new OracleParameter("in_para_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inparafrm;
            (param[15] = new OracleParameter("in_para_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inparato;
            (param[16] = new OracleParameter("in_para_cd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inparacd;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_scm_reports.PROC_AGE_REPORT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable getpurchaseOrderSummery(string _com, string _loc, string _purType, string _supplier, string _itemcode, string _cat1, string _cat2, DateTime _fromDate, DateTime _toDate, string doctype, string docno)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_purType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _purType;
            (param[3] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[8] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[9] = new OracleParameter("doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[10] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_purchaseorder_summery", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getpurchaseOrderSummery_excel(string _com, string _loc, string _purType, string _supplier, string _itemcode, string _cat1, string _cat2, DateTime _fromDate, DateTime _toDate, string doctype, string docno)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_purType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _purType;
            (param[3] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[8] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[9] = new OracleParameter("doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[10] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_purchaseorder_summery_excel", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getpurchaseOrder_grnpening(string _com, string _loc, string _supplier, string _itemcode, string _cat1, string _cat2, DateTime _fromDate, DateTime _toDate, string doctype, string docno)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[3] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[7] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[8] = new OracleParameter("doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[9] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_purchaseorder_grnpending", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getExcessStockDetails(string in_item, string in_Brand, string in_model, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_com, string in_loc, string in_tp, string in_user)
        {   //Sanjeewa 2016-06-28
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[2] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[3] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[4] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[5] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[6] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[7] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[8] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[9] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_com;
            (param[10] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[11] = new OracleParameter("in_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_tp;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excess_stock", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getpurchaseOrderPrint_HDR(string _com, string _loc)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_poprint_lophdr", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public string getSalesRestrictbyUser(string _user)
        {
            // Sanjeewa 2016-10-28
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_check_emp_restrict", CommandType.StoredProcedure, false, param);
            string _exec = "";
            if (_result.Rows.Count > 0)
            {
                foreach (DataRow drow in _result.Rows)
                {
                    _exec = drow["se_emp_cd"].ToString();
                }
            }
            else
            {
                _exec = "";
            }

            return _exec;
        }
        public DataTable getItemCanibalisePrint(string _docno)
        {   // Sanjeewa 2016-06-29
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            DataTable _result = QueryDataTable("tbl", "sp_get_item_canib_print", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getMRNPrint(string _docno)
        {   // Sanjeewa 2016-07-29
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            DataTable _result = QueryDataTable("tbl", "sp_get_mrn_print", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getLocManagerDetail(string _loc)
        {   // Sanjeewa 2016-06-30
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _result = QueryDataTable("tbl", "sp_get_loc_mgr_dtl", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getpurchaseOrder_Print_Dtl(string _com, string _po)
        {
            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _po;
            param[2] = new OracleParameter("c_poDtl", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_poprint_lopdtl", CommandType.StoredProcedure, false, param);
            return _result;

        }

        public DataTable pendingDelivery(DateTime _asAtDate, string _User, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _agetp, decimal _age, string _com, string _pc, string _latestcost)
        {
            // Wimal 09/04/2016         
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[7] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[8] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[9] = new OracleParameter("in_agetp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agetp;
            (param[10] = new OracleParameter("in_age", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _age;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[12] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[13] = new OracleParameter("in_latestcost", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _latestcost;

            DataTable _dtResults;
            //_dtResults = QueryDataTable("tbl", "pkg_forward_sales1.PROC_FWD_SALES2", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "sp_pendingDelivery", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable getGITReport_Current(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5)
        {  // Wimal @ 21/12/2015 Modified Sanjeewa 2016-06-08 - Modified Lakshika 2016-09-23 (Cat4, Cat5)
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[1] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("toloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[4] = new OracleParameter("itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[5] = new OracleParameter("itembrand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("itemmodel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("Cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("Cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("Cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("Cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("Cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_GIT_Current", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getGITReport_Asat(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _User, int _export)
        {  //Sanjeewa 2016-09-17
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[14] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _export;
            //(param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;            

            DataTable _result = QueryDataTable("tbl", "sp_get_git_asat", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getGITReport_Asat_Recon(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _User, int _export)
        {  //Sanjeewa 2016-11-04
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[14] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _export;
            //(param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;            

            DataTable _result = QueryDataTable("tbl", "sp_get_git_asat_reconciliation", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable LOPOCostDetailsReport(DateTime _fromDate, DateTime _toDate, string _com, string _user, string _pb, string _pblvl)
        {  //Modified Sanjeewa 2016-06-09
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[5] = new OracleParameter("in_pb_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_lopo_cost_dtl", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getGITReport_ASAT(string _com, string _toloc, string _fromloc, string _supplier, string _itemcode, string _cat1, string _cat2, DateTime _fromDate, DateTime _toDate, string doctype, string docno)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_toloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[2] = new OracleParameter("p_fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[3] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[8] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[9] = new OracleParameter("doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[10] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_GIT_ASAT", CommandType.StoredProcedure, false, param);
            return _result;
        }



        public DataTable get_liabilityReport(string _com, string entryNo)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_Liability", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable get_WaraPrint_Main(string _com, string entryNo, string mainItemCode, string mainserial)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryNo;
            (param[2] = new OracleParameter("MainItemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mainItemCode;
            (param[3] = new OracleParameter("MainSerial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mainserial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_waraprint_M_Ser", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable get_WaraPrint_Sub(string _com, string entryNo, string mainItemCode, string mainserial)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryNo;
            (param[2] = new OracleParameter("MainItemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mainItemCode;
            (param[3] = new OracleParameter("MainSerial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mainserial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_waraprint_S_Ser", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable PrintInvoice_Hdr(string _comcode, string _DocNo)
        {
            // Wimal 09/04/2016         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comcode;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_invprint_invHdr", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintInvoice_Dtl(string _comcode, string _DocNo)
        {
            // Wimal 09/04/2016         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comcode;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_invprint_invdtl", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintInvoice_Tax(string _DocNo)
        {
            // Sanjeewa 20/10/2016         
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_invoice_tax", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintInvoice_Pay(string _comcode, string _DocNo)
        {
            // Wimal 09/04/2016         
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comcode;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_invprint_invpaytype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable getsostatus(string _com, string _loc, string _supplier, string _itemcode, string _cat1, string _cat2, DateTime _fromDate, DateTime _toDate, string doctype, string docno)
        {

            // Wimal @ 21/12/2015
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[3] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[7] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[8] = new OracleParameter("doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[9] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_so_status", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getvalueAddtion(string _com, DateTime _fromDate, DateTime _toDate)
        {

            // Wimal @ 29/12/2015
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_value_addtion", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public DataTable GetSerialBalance_Curr_SCM(string _com, string _loc, string _item, string _itemstatus, string _withRCC)
        {
            //kapila 15/12/2015
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("in_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            //  (param[5] = new OracleParameter("in_withRCC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _withRCC;

            DataTable _tblData = QueryDataTable("tbData", "pkg_scm_reports.sp_get_inv_bal_serial_curr_scm", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable GetSerialBalance_Curr_SCM_New(string _com, string _loc, string _item, string _itemstatus, string _withRCC)
        {
            //kapila 15/12/2015
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("in_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            //  (param[5] = new OracleParameter("in_withRCC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _withRCC;

            DataTable _tblData = QueryDataTable("tbData", "pkg_scm_reports.sp_get_inv_bal_serial_curr", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //kapila
        public DataTable GetStockBalanceCurrent_SCM(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
  string _itemcat1, string _itemcat2, string _itemcat3, string _itemcat4, string _itemcat5, Int16 _withcost, Int16 _serialrep, string _com, string _loc, string _withRCC, string _withJob, string _withGIT)
        {
            //Sanjeewa 2013-03-01
            OracleParameter[] param = new OracleParameter[17];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_Itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat4;
            (param[11] = new OracleParameter("in_Itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat5;
            (param[12] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[13] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[14] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[15] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[16] = new OracleParameter("in_withRCC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _withRCC;

            DataTable _tblData = new DataTable();
            if (_withGIT == "Y")
            {
                if (_withJob == "Y")
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BAL_CURR_GIT_J", CommandType.StoredProcedure, false, param);// NADEEKA 01-06-2015
                }
                else
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BAL_CURR_GIT", CommandType.StoredProcedure, false, param);
                }


            }
            else
            {
                if (_withJob == "Y")
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_JOB", CommandType.StoredProcedure, false, param); // NADEEKA 01-06-2015
                }
                else
                {
                    _tblData = QueryDataTable("tbData", "pkg_scm_reports.PROC_INVENTORY_BALANCE_CURR", CommandType.StoredProcedure, false, param);
                }
            };
            return _tblData;
        }

        //kapila
        public DataTable PrintMovementAuditTrialReport(string _com, string _loc, DateTime in_FromDate, DateTime in_ToDate, string _doctp, string _subdoctp, string _direct, string in_item, string in_Brand, string in_model, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, Int32 _isSer, string _othloc, string _docno, Int32 _appstus)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[5] = new OracleParameter("p_subdoctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subdoctp;
            (param[6] = new OracleParameter("p_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _direct;
            (param[7] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[8] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[9] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[10] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[11] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[12] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[13] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[14] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[15] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othloc;
            (param[16] = new OracleParameter("in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[17] = new OracleParameter("in_app_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _appstus;
            param[18] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (_isSer == 1)
                _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_movaudittrial_ser", CommandType.StoredProcedure, false, param);
            else
                _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_movaudittrial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable PrintContainerVolReport(string _com, string _loc, DateTime in_FromDate, DateTime in_ToDate, string _country, string _agent, string _port)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("in_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _country;
            (param[5] = new OracleParameter("in_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agent;
            (param[6] = new OracleParameter("in_port", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _port;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_cont_volume", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable PrintTotalImportsReport(string _com, string _loc, DateTime in_FromDate, DateTime in_ToDate, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model, string _supp, string _agent)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[15];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
            (param[12] = new OracleParameter("in_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supp;
            (param[13] = new OracleParameter("in_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agent;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_tot_impts", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public Int32 CheckValidServiceAgent(string _item, string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_chk_valid_agent4_item", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public DataTable GetBatchwiseExpDates(string _com, string _loc, string _item, string _stus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblItemComponent", "sp_get_exp_itm_batch", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        //kapila
        public Int32 UPDATE_OLD_PART_BY_GATEPASS(string jobnumber, Int32 jobLine)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobnumber;
            (param[1] = new OracleParameter("P_JOBLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = jobLine;

            param[2] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_upd_old_part_by_gatepass", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public Int32 UPDATE_SCV_JOB_DET_BY_GATEPASS(string jobnumber, Int32 jobLine, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobnumber;
            (param[1] = new OracleParameter("P_JOBLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = jobLine;
            (param[2] = new OracleParameter("P_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_updjob_det_by_gatepass", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public Int32 SaveGatePassHdr(string _com, string _loc, string _doc, DateTime _date, string _jobno, Int32 _jobline, string _rmk, string _stus, string _creby, string _satis, string _satisRem, string _transMethod, string _ref)
        {
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;
            (param[5] = new OracleParameter("p_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobline;
            (param[6] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk;
            (param[7] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[8] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creby;
            (param[9] = new OracleParameter("p_satis", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _satis;
            (param[10] = new OracleParameter("p_satis_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _satisRem;
            (param[11] = new OracleParameter("p_transMethod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transMethod;
            (param[12] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_save_gate_pass_hdr", CommandType.StoredProcedure, param);
            return effects;
        }
        //kapila
        public DataTable GetPendingTemSavedGRN(string _com, string _loc, string _pono)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pono;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPending", "sp_get_temp_grn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable getItemByType(string _type)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_item_by_type", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        //kapila
        public Boolean IsAgentParaExist(string _com, string _code)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _Found = QueryDataTable("tbl", "sp_chk_agnt", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _Found;
        }
        //kapila
        public DataTable GetPendingRCC(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_pending_rcc", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetMasterTypes(string _code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_master_types", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //kapila
        public DataTable GetSuplierByItem(string _com, string _item)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tbl", "sp_get_sup_by_itm", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        //kapila
        public List<MasterItem> GetItemsByCate(string _mainCate, string _subCate, string _itmRange)
        {
            List<MasterItem> _itmDet = new List<MasterItem>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCate;
            (param[1] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subCate;
            (param[2] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmRange;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getitembycate", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _itmDet = DataTableExtensions.ToGenericList<MasterItem>(_tblData, MasterItem.ConvertTotal);
            }

            return _itmDet;
        }

        //kapila
        public DataTable GetSalesDetailsMobSer(string _invNo)
        {
            // Nadeeka 13-12-2012 
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_sales_details_mobser", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        //kapila 9/2/2015
        public Int32 UpdateTempWaraCust(string _customercode, string _customername, string _customeraddressinvoce, string _customerphoneno, string _warrantyno)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customercode;
            (param[1] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[2] = new OracleParameter("p_customeraddressinvoce", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customeraddressinvoce;
            (param[3] = new OracleParameter("p_customerphoneno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerphoneno;
            (param[4] = new OracleParameter("p_warrantyno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrantyno;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_up_temp_wara_cust", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public Boolean checkDealerInvoice(string _inv, Int32 _scm)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (_para[1] = new OracleParameter("p_scm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scm;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _esdStus = QueryDataTable("tbl", "sp_chk_is_dealer_inv", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _esdStus;
        }

        //kapila
        public int updateJobReqByRCC(string _rccno, string _aodno)
        {
            int rows_aff = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_rcc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            (param[1] = new OracleParameter("p_aod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_aff = UpdateRecords("sp_upd_reqhdr_by_rcc", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        //kapila
        public int updateJobReqDetByRCC(string _rccno, string _aodno)
        {
            int rows_aff = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_rcc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            (param[1] = new OracleParameter("p_aod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_aff = UpdateRecords("sp_upd_reqdet_by_rcc", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        //kapila
        public DataTable GetCustIncomeGroup(string _com, string _code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_incm_grp", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Sanjeewa 2015-07-13
        public DataTable GetInsuredStockDetails(string _user, string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_insured_stock", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Sanjeewa 2015-07-13
        public DataTable GetCurrBalancewithPriceDetails(string _user, string _com, string _loc, string _supplier, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3)
        {
            OracleParameter[] param = new OracleParameter[11];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_inv_bal_sale", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        public List<Service_Charge> Get_RCC_Charge(string _com, string _loc, string _schnl, DateTime _date, string _tp)
        {
            List<Service_Charge> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_schnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _schnl;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_rcc_chg", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<Service_Charge>(_result, Service_Charge.Converter_1);
            }

            return _list;
        }

        public DataTable ProcessBOCReservedSerials(DateTime in_FromDate, DateTime in_ToDate, string in_DocType, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3, string in_direc, string in_user, string in_subType)
        {   // kapila
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_DocType;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;
            (param[8] = new OracleParameter("p_direc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_direc;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[10] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[11] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[12] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[13] = new OracleParameter("p_subType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_subType;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getBOCReservedSerials", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 19/11/2014
        public Int32 UpdateTempWara(string _transactionno, Int32 _wara_line_no, DateTime _warrantystartdate, Int32 _warrantyperiod, string _salesorderno, string _customercode, string _customername, string _customeraddressinvoce, string _customerphoneno, DateTime _podate, string _invoiceno, string _transaction_location, string _itemstatus, Decimal _unitprice, string _vhlregno, string _warranty_remarks, string _hpacctno, string _warrantyno, string _itemcd = null, string _ItmSer = null,
            string p_modelno = null, string p_warrantystatus = null, string p_showroomname = null, string p_createdby = null, DateTime p_grn_date = default(DateTime))
        {
            OracleParameter[] param = new OracleParameter[26];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_transactionno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transactionno;
            (param[1] = new OracleParameter("p_wara_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _wara_line_no;
            (param[2] = new OracleParameter("p_warrantystartdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warrantystartdate;
            (param[3] = new OracleParameter("p_warrantyperiod", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warrantyperiod;
            (param[4] = new OracleParameter("p_salesorderno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesorderno;
            (param[5] = new OracleParameter("p_customercode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customercode;
            (param[6] = new OracleParameter("p_customername", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customername;
            (param[7] = new OracleParameter("p_customeraddressinvoce", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customeraddressinvoce;
            (param[8] = new OracleParameter("p_customerphoneno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customerphoneno;
            (param[9] = new OracleParameter("p_podate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _podate;
            (param[10] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            (param[11] = new OracleParameter("p_transaction_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _transaction_location;
            (param[12] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[13] = new OracleParameter("p_unitprice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _unitprice;
            (param[14] = new OracleParameter("p_vhlregno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vhlregno;
            (param[15] = new OracleParameter("p_warranty_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty_remarks;
            (param[16] = new OracleParameter("p_hpacctno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hpacctno;
            (param[17] = new OracleParameter("p_warrantyno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrantyno;
            (param[18] = new OracleParameter("p_Itemcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcd;
            (param[19] = new OracleParameter("p_itmSer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItmSer;
            (param[20] = new OracleParameter("p_modelno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_modelno;
            (param[21] = new OracleParameter("p_warrantystatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_warrantystatus;
            (param[22] = new OracleParameter("p_showroomname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_showroomname;
            (param[23] = new OracleParameter("p_createdby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_createdby;
            (param[24] = new OracleParameter("p_grn_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_grn_date;

            param[25] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //effects = (Int16)UpdateRecords("sp_upd_temp_wara", CommandType.StoredProcedure, param);
            effects = (Int16)UpdateRecords("sp_upd_temp_waraNEW", CommandType.StoredProcedure, param);
            return effects;
        }

        public int DeleteRCCLocations(string _com, string _agent, string _loc, string _user)
        {
            int row_aff = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ragl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ragl_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agent;
            (param[2] = new OracleParameter("p_ragl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_ragl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            row_aff = UpdateRecords("sp_del_rcc_loc", CommandType.StoredProcedure, param);
            return row_aff;
        }

        public int UpdateRCCLocations(RCCLocations _RccLoc)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ragl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RccLoc.Ragl_com;
            (param[1] = new OracleParameter("p_ragl_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RccLoc.Ragl_agent;
            (param[2] = new OracleParameter("p_ragl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RccLoc.Ragl_loc;
            (param[3] = new OracleParameter("p_ragl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RccLoc.Ragl_mod_by;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_upd_rcc_loc", CommandType.StoredProcedure, param);
        }

        public DataTable GetLocsByAgent(string _com, string _agent)
        {//kapila 20/5/2014
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agent;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_getlocsbyagent", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written by Chamal De Silva 21/08/2012
        public Int16 CheckInventoryNo(string _fnName, string _param, string _paramVal)
        {
            OracleParameter[] param = new OracleParameter[1];
            (param[0] = new OracleParameter(_param, OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramVal;
            OracleParameter _outParam = new OracleParameter("p_out", OracleDbType.Int32, null, ParameterDirection.Output);
            Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue(_fnName, CommandType.StoredProcedure, _outParam, param));
            return _effect;
        }

        //Written by Chamal De Silva 23/08/2012
        public Boolean CheckUserPermission(string _user, string _company, string _party, string _permissionCode)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_pary", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _permissionCode;
            OracleParameter _outParam = new OracleParameter("p_out", OracleDbType.Int32, null, ParameterDirection.Output);
            Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue("sp_getusrperm", CommandType.StoredProcedure, _outParam, param));
            if (_effect == 1)
            {
                return true;
            }
            else
            {
                return false;
            }
        }

        //Written by Chamal De Silva 24/10/2012
        public Boolean CancelInventoryDocument(string _doc, string _user)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_cancel_inv_doc", CommandType.StoredProcedure, param);
            if (effected == 1)
                return true;
            else
                return false;
        }

        //Serial Scan Common Control
        //Code By - Prabhath on 12/03/2012
        #region SerialScan

        /// <summary>
        /// Get All Company Item Status according to the logged user company
        /// </summary>
        /// <param name="_company">Company code</param>
        /// <returns>Status/Description</returns>
        public DataTable GetAllCompanyStatus(string _company)
        {
            //Query Data base.
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            ConnectionOpen();
            DataTable _dtItemStatus = QueryDataTable("tblCompanyItemStatus", "sp_scansearchstatus", CommandType.StoredProcedure, false, param);
            //ConnectionClose();

            return _dtItemStatus;
        }

        public List<MasterCompanyItemStatus> GetAllCompanyStatuslist(string _company)
        {
            List<MasterCompanyItemStatus> _list = null;
            //Query Data base.
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            ConnectionOpen();
            DataTable _dtItemStatus = QueryDataTable("tblCompanyItemStatus", "sp_scansearchstatus", CommandType.StoredProcedure, false, param);
            //ConnectionClose();

            if (_dtItemStatus.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterCompanyItemStatus>(_dtItemStatus, MasterCompanyItemStatus.ConvertTotal);
            }

            return _list;
        }

        /// <summary>
        /// Get all location bin code  according to the logged user company/location
        /// </summary>
        /// <param name="_company">Company Code</param>
        /// <param name="_location">Location Code</param>
        /// <returns>Bin Code/Description</returns>
        public DataTable GetAllLocationBin(string _company, string _location)
        {
            //Query Data base.
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            ConnectionOpen();
            DataTable _dtBin = QueryDataTable("tblLocationBin", "sp_scansearchbin", CommandType.StoredProcedure, false, param);
            //TODO: Put ths SP name
            //ConnectionClose();

            return _dtBin;
        }

        //Code By - Prabhath on 26/03/2012
        public Boolean IsItemSerialized_1(string _item)
        {
            //ConnectionOpen();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isItemSerialized_1 = QueryDataTable("tblItem", "sp_checkserial1_isserialized", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return _isItemSerialized_1;
        }

        //Code By - Prabhath on 26/03/2012
        public Boolean IsItemSerialized_2(string _item)
        {
            //ConnectionOpen();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isItemSerialized_2 = QueryDataTable("tblItem", "sp_checkserial2_isserialized", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return _isItemSerialized_2;
        }

        //Code By - Prabhath on 26/03/2012
        public Boolean IsItemSerialized_3(string _item)
        {
            //ConnectionOpen();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isItemSerialized_3 = QueryDataTable("tblItem", "sp_checkserial3_isserialized", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return _isItemSerialized_3;
        }

        //Code By - Prabhath on 26/03/2012
        public Boolean IsItemHaveSubItem(string _item)
        {
            //ConnectionOpen();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isItemHaveSubItem = QueryDataTable("tblItem", "SP_CHECKISSUBSERIALIZED", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return _isItemHaveSubItem;
        }

        //Code By - Prabhath on 27/03/2012
        public Boolean IsUOMDecimalAllow(string _item)
        {
            //ConnectionOpen();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isUOMDecimalAllow = QueryDataTable("tblUom", "sp_checkUOMdecimalallow", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            //ConnectionClose();
            return _isUOMDecimalAllow;
        }

        public List<InventorySerialRefN> GetItemDetailBySerial(string _company, string _location, string _serial)
        {
            List<InventorySerialRefN> _itemList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblserial", "sp_getItemBySerial", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<InventorySerialRefN>(_itemTable, InventorySerialRefN.Converter);
            }
            return _itemList;
        }

        #endregion SerialScan

        /// <summary>
        /// Get All Item Details
        /// </summary>
        /// <param name="_company">User loged company</param>
        /// <returns>List of items</returns>
        public List<MasterItem> GetAllItems(string _company, string _item)
        {
            List<MasterItem> _itemList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_allitemdetails", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal);
            }
            return _itemList;
        }

        /// <summary>
        /// Get a Item Detail
        /// </summary>
        /// <param name="_company">User loged company</param>
        /// <returns>List of items</returns>
        public MasterItem GetItem(string _company, string _item)
        {
            MasterItem _itemList = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_allitemdetails", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal)[0];
            }
            return _itemList;
        }

        /// <summary>
        /// This method is used to get ralavant item components for given main item.
        /// Code By : Miginda Geeganage - On : 26/04/2012
        /// </summary>
        /// <param name="_mainItemCode"></param>
        /// <returns></returns>
        public List<MasterItemComponent> GetItemComponents(string _mainItemCode)
        {
            List<MasterItemComponent> _itemComponentList = null;
            MasterItemComponent _itemComponent = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_main_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainItemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblItemComponent", "sp_get_mst_itm_components", CommandType.StoredProcedure, false, param);

            if (_resultDT.Rows.Count > 0)
            {
                _itemComponentList = new List<MasterItemComponent>();

                for (int i = 0; i < _resultDT.Rows.Count; i++)
                {
                    _itemComponent = new MasterItemComponent();
                    _itemComponent.ComponentItem = new MasterItem()
                    {
                        Mi_cd = ((_resultDT.Rows[i]["micp_comp_itm_cd"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["micp_comp_itm_cd"].ToString()),
                        Mi_longdesc = ((_resultDT.Rows[i]["mi_longdesc"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["mi_longdesc"].ToString()),
                        Mi_brand = ((_resultDT.Rows[i]["mi_brand"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["mi_brand"].ToString()),
                        Mi_model = ((_resultDT.Rows[i]["mi_model"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["mi_model"].ToString()),
                        Mi_itm_tp = ((_resultDT.Rows[i]["mi_itm_tp"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["mi_itm_tp"].ToString())
                    };

                    _itemComponent.Micp_itm_tp = ((_resultDT.Rows[i]["micp_itm_tp"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["micp_itm_tp"].ToString());
                    _itemComponent.Micp_itm_cd = ((_resultDT.Rows[i]["micp_itm_cd"] == DBNull.Value) ? string.Empty : _resultDT.Rows[i]["micp_itm_cd"].ToString());
                    _itemComponent.Micp_cost_percentage = ((_resultDT.Rows[i]["micp_cost_percentage"] == DBNull.Value) ? 0 : Convert.ToDecimal(_resultDT.Rows[i]["micp_cost_percentage"]));
                    _itemComponent.Micp_qty = ((_resultDT.Rows[i]["micp_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_resultDT.Rows[i]["micp_qty"]));

                    _itemComponent.Micp_isprice = ((_resultDT.Rows[i]["micp_isprice"] == DBNull.Value) ? false : Convert.ToBoolean(_resultDT.Rows[i]["micp_isprice"]));
                    _itemComponent.Micp_must_scan = ((_resultDT.Rows[i]["micp_must_scan"] == DBNull.Value) ? false : Convert.ToBoolean(_resultDT.Rows[i]["micp_must_scan"]));
                    _itemComponent.Micp_act = ((_resultDT.Rows[i]["micp_act"] == DBNull.Value) ? false : Convert.ToBoolean(_resultDT.Rows[i]["micp_act"]));

                    _itemComponentList.Add(_itemComponent);
                }
            }

            return _itemComponentList;
        }

        #region RCC

        public List<RCC> GetRCC()
        {
            List<RCC> _rccList = null;

            DataTable _dtResults = QueryDataTable("tblRCC", "SP_GET_RCC", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            if (_dtResults.Rows.Count > 0)
            {
                _rccList = DataTableExtensions.ToGenericList<RCC>(_dtResults, RCC.Converter);
            }
            return _rccList;
        }

        public List<RCC> GetRCC_REQ()
        {
            List<RCC> _rccList = null;

            DataTable _dtResults = QueryDataTable("tblRCC", "SP_GET_RCC_RQ", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            if (_dtResults.Rows.Count > 0)
            {
                _rccList = DataTableExtensions.ToGenericList<RCC>(_dtResults, RCC.Converter);
            }
            return _rccList;
        }

        public RCC GetRCCbyNo(string RccNo)
        {
            RCC _rcc = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = RccNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_rcc_by_no", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _rcc = DataTableExtensions.ToGenericList<RCC>(_dtResults, RCC.Converter)[0];
            }
            return _rcc;
        }

        public DataTable GetRCCbyNoTable(string _rcc)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_rcc_by_no", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int32 UpdateInvoiceStatus(string _invNo, string _status)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_invoice_stus", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetJobForSerial(string _com, string _item, string _ser, Int32 _serid)
        {   // Nadeeka 12-11-2015
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[3] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serid;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_isSerialUsedToJob", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable FastMovingReport(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_model, Int16 in_AllCompany, Int16 in_isFast, string in_pc)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[11] = new OracleParameter("in_AllCompany", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_AllCompany;
            (param[12] = new OracleParameter("in_isFast", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_isFast;
            (param[13] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_pc;

            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_inv_reports.PROC_FASTMOVING_REPORT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable NonMovingReport(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_model, Int16 in_AllCompany)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[11] = new OracleParameter("in_AllCompany", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_AllCompany;

            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_inv_reports.PROC_NON_MOVING_REPORT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable SerialAgeReport(DateTime in_AsatDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_model, string in_itemsStatus, string in_loc, Int32 in_fromage, Int32 in_toage, Int32 in_iscomage)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asAtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_AsatDate;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[9] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[10] = new OracleParameter("in_itemsStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_itemsStatus;
            (param[11] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[12] = new OracleParameter("in_fromage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_fromage;
            (param[13] = new OracleParameter("in_toage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_toage;
            (param[14] = new OracleParameter("in_is_com_age", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_iscomage;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inv_reports.PROC_SERIAL_AGE_REPORT_NEW", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetPODetails(string _po)
        {   // Nadeeka 30-03-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _po;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_PO_Details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCrditNoteforWarrantyClaim(string in_AdjNo)
        {   // Nadeeka 07-06-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("in_AdjNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_AdjNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getCreditNoteDetailsSCM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCrditNoteforWarrantyClaimScm2(string in_AdjNo)
        {   // Nadeeka 07-06-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("in_AdjNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_AdjNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_getCreditNoteDetailsSCM2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetPODeliveryDetails(string _po)
        {   // Nadeeka 30-03-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _po;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_PO_Delivery_Details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessInventoryStatement(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[9] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[10] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[11] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inv_reports.PROC_INVENTORY_STATEMENT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessPSI(DateTime in_FromDate, DateTime in_ToDate, string in_user_id, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[9] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[10] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[11] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;

            DataTable _dtResults = QueryDataTable("tbl", "sp_print_psi_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessMovementAuditTrialWithSerial(DateTime in_FromDate, DateTime in_ToDate, string in_DocType, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3, string in_direc, string in_user, string in_subType)
        {   // Nadeeka 27-02-13
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_DocType;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;
            (param[8] = new OracleParameter("p_direc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_direc;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[10] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[11] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[12] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[13] = new OracleParameter("p_subType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_subType;
         //   (param[14] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_oth_loc;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _dtResults = QueryDataTable("tbl", "sp_getMovmentAuditTrialSerial", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getMovmentAuditTrialSerialn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessMovementAuditTrial(DateTime in_FromDate, DateTime in_ToDate, string in_DocType, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3, string in_direc, string in_user, string in_subType, string _docno)
        {   // Nadeeka 28-02-13
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_DocType;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;
            (param[8] = new OracleParameter("p_direc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_direc;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[10] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[11] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[12] = new OracleParameter("p_subType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_subType;
            (param[13] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[14] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[15] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getMovmentAuditTrialn", CommandType.StoredProcedure, false, param);
            //DataTable _dtResults = QueryDataTable("tbl", "sp_getMovmentAuditTrialn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessMovementAuditTrial_ARL(DateTime in_FromDate, DateTime in_ToDate, string in_DocType, string in_Location_code, string in_Oth_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3, string in_direc, string in_user, string in_subType, string _docno)
        {   // Nadeeka 28-02-13
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[2] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Oth_Location_code;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[5] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_DocType;
            (param[6] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[7] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[8] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;
            (param[9] = new OracleParameter("p_direc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_direc;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[12] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[13] = new OracleParameter("p_subType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_subType;
            (param[14] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[15] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getMovmentAuditTrialn_ARL", CommandType.StoredProcedure, false, param);
            //DataTable _dtResults = QueryDataTable("tbl", "sp_getMovmentAuditTrialn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable DamgeGoodApproval(DateTime in_FromDate, DateTime in_ToDate, string in_Location_code, string in_Company, string in_Brand, string in_Model, string in_Itemcode, string in_Itemcat1, string in_Itemcat2, string in_Itemcat3, string in_user)
        {   // Nadeeka 08-03-13
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
            (param[2] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[4] = new OracleParameter("in_Location_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Location_code;
            (param[5] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[6] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[7] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[9] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[10] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[11] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inv_reports.PROC_DAMEGE_ITEMS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetMoveSubTypeTable(string _type)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getMoveSubType", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ServicejobCard(string _jobNo)
        {   // Nadeeka 24-04-13
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_ServiceJobCard", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        // Nadeeka
        public Int32 SaveWarrantyReplacement(Service_Replacement_Hstry _warRep)
        {
            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_rrh_repl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_dt;
            (param[1] = new OracleParameter("p_rrh_sold_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_itm_cd;
            (param[2] = new OracleParameter("p_rrh_sold_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_sold_ser1;
            (param[3] = new OracleParameter("p_rrh_sold_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_sold_ser2;
            (param[4] = new OracleParameter("p_rrh_sold_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_sold_warr;
            (param[5] = new OracleParameter("p_rrh_sold_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warRep.Rrh_sold_serid;
            (param[6] = new OracleParameter("p_rrh_repl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_itm_cd;
            (param[7] = new OracleParameter("p_rrh_repl_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_ser1;
            (param[8] = new OracleParameter("p_rrh_repl_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_ser2;
            (param[9] = new OracleParameter("p_rrh_repl_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_serid;
            (param[10] = new OracleParameter("p_rrh_repl_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_repl_warr;
            (param[11] = new OracleParameter("p_rrh_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_job_no;
            (param[12] = new OracleParameter("p_rrh_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _warRep.Rrh_job_line;
            (param[13] = new OracleParameter("p_rrh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_cre_by;
            (param[14] = new OracleParameter("p_rrh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warRep.Rrh_cre_dt;
            (param[15] = new OracleParameter("p_rrh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warRep.Rrh_mod_by;
            (param[16] = new OracleParameter("p_rrh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _warRep.Rrh_mod_dt;

            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = UpdateRecords("sp_save_ref_repl_his", CommandType.StoredProcedure, param);

            return effects;
        }
        public DataTable ServicejobCardDefect(string _jobNo)
        {   // Nadeeka 24-04-13
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_ServiceJobCardDefects", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ServicejobCardHistory(string _jobNo)
        {   // Nadeeka 26-04-13
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_ServiceJobCardHistory", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetMoveSubTypeAllTable(string _maintype, string _subtype)
        {   // Chamal 12-03-2013
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_MainType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maintype;
            (param[1] = new OracleParameter("p_SubType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getMoveSubTypeAll", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MasterRCCDef> GetRCCDefinition(string D_Type)
        {
            List<MasterRCCDef> _rccDefList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = D_Type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRCCDef", "SP_GET_RCC_DEF", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _rccDefList = DataTableExtensions.ToGenericList<MasterRCCDef>(_dtResults, MasterRCCDef.Converter);
            }
            return _rccDefList;
        }

        public List<MasterBusinessEntity> GetServiceAgent(string _Type)
        {
            List<MasterBusinessEntity> _rccDefList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRCCDef", "SP_GET_BUSENTITY", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _rccDefList = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter);
            }
            return _rccDefList;
        }

        /// <summary>
        /// Added By Dulanga 2016-1-21
        /// </summary>
        /// <param name="_Type"></param>
        /// <param name="_code"></param>
        /// <param name="_com"></param>
        /// <returns></returns>
        public List<MasterBusinessEntity> GetMobCustSearch(string _Type, string _code, string _com)
        {
            List<MasterBusinessEntity> _rccDefList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRCCDef", "sp_mob_search_busentity", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _rccDefList = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_dtResults, MasterBusinessEntity.Converter);
            }
            return _rccDefList;
        }


        /// <summary>
        /// search item mob dulanga 2018/10/18
        /// </summary>
        /// <param name="type"></param>
        /// <param name="code"></param>
        /// <returns></returns>
        public DataTable GetMobSearchItem(string type, string code)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRCCDef", "sp_mob_search_items", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }





        //kapila 23/4/2012
        public int Update_RCC_JobOpen(RCC _RCC)
        {
            int rows_aff = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_INR_JB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_jb_no;
            (param[1] = new OracleParameter("p_inr_hollogram_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_hollogram_no;
            (param[2] = new OracleParameter("p_inr_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_anal1;
            (param[3] = new OracleParameter("p_inr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_anal2;
            (param[4] = new OracleParameter("p_inr_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_anal7;
            (param[5] = new OracleParameter("p_INR_OPEN_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_open_by;
            (param[6] = new OracleParameter("p_INR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_no;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            rows_aff = UpdateRecords("sp_update_rcc_jobopen", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        //kapila 25/4/2012
        public int Update_RCC_Repair(RCC _RCC)
        {
            int rows_aff = 0;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_Inr_is_repaired", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_repaired;
            (param[1] = new OracleParameter("p_Inr_repair_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_repair_stus;
            (param[2] = new OracleParameter("p_Inr_rem2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_rem2;
            (param[3] = new OracleParameter("p_Inr_is_returned", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_returned;
            (param[4] = new OracleParameter("p_Inr_return_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_return_dt;
            (param[5] = new OracleParameter("p_Inr_ret_condition", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_ret_condition;
            (param[6] = new OracleParameter("p_Inr_hollogram_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_hollogram_no;
            (param[7] = new OracleParameter("p_Inr_is_replace", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_replace;
            (param[8] = new OracleParameter("p_Inr_is_resell", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_resell;
            (param[9] = new OracleParameter("p_Inr_is_ret", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_ret;
            (param[10] = new OracleParameter("p_Inr_is_dispose", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_dispose;
            (param[11] = new OracleParameter("p_INR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_no;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //ConnectionOpen();
            rows_aff = UpdateRecords("sp_update_rcc_repair", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        //kapila 26/4/2012
        public int Update_RCC_complete(RCC _RCC)
        {
            int rows_aff = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_Inr_is_complete", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_complete;
            (param[1] = new OracleParameter("p_Inr_complete_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_complete_dt;
            (param[2] = new OracleParameter("p_Inr_complete_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_complete_by;
            (param[3] = new OracleParameter("p_Inr_rem3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_rem3;
            (param[4] = new OracleParameter("p_Inr_closure_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_closure_tp;
            (param[5] = new OracleParameter("p_INR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_no;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            // ConnectionOpen();
            rows_aff = UpdateRecords("sp_update_rcc_comp", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        public int SaveRCC(RCC _RCC)
        {
            int rows_aff = 0;
            OracleParameter[] param = new OracleParameter[69];

            (param[0] = new OracleParameter("p_INR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_no;
            (param[1] = new OracleParameter("p_INR_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_com_cd;
            (param[2] = new OracleParameter("p_INR_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_loc_cd;
            (param[3] = new OracleParameter("p_INR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_dt;
            (param[4] = new OracleParameter("p_INR_IS_MANUAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_manual;
            (param[5] = new OracleParameter("p_INR_MANUAL_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_manual_ref;
            (param[6] = new OracleParameter("p_INR_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_tp;
            (param[7] = new OracleParameter("p_INR_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_sub_tp;
            (param[8] = new OracleParameter("p_INR_AGENT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_agent;
            (param[9] = new OracleParameter("p_INR_COL_METHOD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_col_method;
            (param[10] = new OracleParameter("p_INR_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_inv_no;
            (param[11] = new OracleParameter("p_INR_ACC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_acc_no;
            (param[12] = new OracleParameter("p_INR_INV_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_inv_dt;
            (param[13] = new OracleParameter("p_INR_OTH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_oth_doc_no;
            (param[14] = new OracleParameter("p_INR_OTH_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_oth_doc_dt;
            (param[15] = new OracleParameter("p_INR_CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_cust_cd;
            (param[16] = new OracleParameter("p_INR_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_cust_name;
            (param[17] = new OracleParameter("p_INR_ADDR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_addr;
            (param[18] = new OracleParameter("p_INR_TEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_tel;
            (param[19] = new OracleParameter("p_INR_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_itm;
            (param[20] = new OracleParameter("p_INR_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_ser;
            (param[21] = new OracleParameter("p_INR_WARR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_warr;
            (param[22] = new OracleParameter("p_INR_DEF_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_def_cd;
            (param[23] = new OracleParameter("p_INR_DEF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_def;
            (param[24] = new OracleParameter("p_INR_CONDITION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_condition;
            (param[25] = new OracleParameter("p_INR_ACCESSORIES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_accessories;
            (param[26] = new OracleParameter("p_INR_EASY_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_easy_loc;
            (param[27] = new OracleParameter("p_INR_INSP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_insp_by;
            (param[28] = new OracleParameter("p_INR_REM1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_rem1;
            (param[29] = new OracleParameter("p_INR_DEF_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_def_rem;
            (param[30] = new OracleParameter("p_INR_IS_JB_OPEN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_jb_open;
            (param[31] = new OracleParameter("p_INR_JB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_jb_no;
            (param[32] = new OracleParameter("p_INR_OPEN_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_open_by;
            (param[33] = new OracleParameter("p_INR_JB_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_jb_rem;
            (param[34] = new OracleParameter("p_INR_IS_REPAIRED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_repaired;
            (param[35] = new OracleParameter("p_INR_REPAIR_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_repair_stus;
            (param[36] = new OracleParameter("p_INR_REM2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_rem2;
            (param[37] = new OracleParameter("p_INR_IS_RETURNED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_returned;
            (param[38] = new OracleParameter("p_INR_RETURN_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_return_dt;
            (param[39] = new OracleParameter("p_INR_RET_CONDITION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_ret_condition;
            (param[40] = new OracleParameter("p_INR_HOLLOGRAM_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_hollogram_no;
            (param[41] = new OracleParameter("p_INR_IS_REPLACE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_replace;
            (param[42] = new OracleParameter("p_INR_IS_RESELL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_resell;
            (param[43] = new OracleParameter("p_INR_IS_RET", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_ret;
            (param[44] = new OracleParameter("p_INR_IS_DISPOSE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_dispose;
            (param[45] = new OracleParameter("p_INR_ACKNOLEDGE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_acknoledge_dt;
            (param[46] = new OracleParameter("p_INR_IS_COMPLETE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_complete;
            (param[47] = new OracleParameter("p_INR_COMPLETE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_complete_dt;
            (param[48] = new OracleParameter("p_INR_COMPLETE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_complete_by;
            (param[49] = new OracleParameter("p_INR_REM3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_rem3;
            (param[50] = new OracleParameter("p_INR_CLOSURE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_closure_tp;
            (param[51] = new OracleParameter("p_INR_STAGE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_stage;
            (param[52] = new OracleParameter("p_INR_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_stus;
            (param[53] = new OracleParameter("p_INR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_cre_by;
            (param[54] = new OracleParameter("p_INR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_cre_dt;
            (param[55] = new OracleParameter("p_INR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_mod_by;
            (param[56] = new OracleParameter("p_INR_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_mod_dt;
            (param[57] = new OracleParameter("p_INR_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_session_id;
            (param[58] = new OracleParameter("p_INR_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_anal1;
            (param[59] = new OracleParameter("p_INR_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCC.Inr_anal2;
            (param[60] = new OracleParameter("p_INR_ANAL3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_anal3;
            (param[61] = new OracleParameter("p_INR_ANAL4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_anal4;
            (param[62] = new OracleParameter("p_INR_ANAL5", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_anal5;
            (param[63] = new OracleParameter("p_INR_ANAL6", OracleDbType.Date, null, ParameterDirection.Input)).Value = _RCC.Inr_anal6;
            (param[64] = new OracleParameter("p_inr_is_req", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_is_req;
            (param[65] = new OracleParameter("p_inr_serial_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.Inr_serial_id;
            (param[66] = new OracleParameter("p_INR_IS_EXTERNAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.INR_IS_EXTERNAL;
            (param[67] = new OracleParameter("p_INR_WAR_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _RCC.INR_WAR_PERIOD;
            param[68] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            rows_aff = UpdateRecords("sp_save_rcc", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        #endregion RCC

        //Status change- Inventory
        //Code By - Shani on 23/4/2012
        #region

        public List<string> Get_all_Itemcodes()
        {
            //ConnectionOpen();
            DataTable dt = new DataTable("ItemCodes");
            ConnectionOpen();

            dt = QueryDataTable("tbl_ItemCodes", "sp_getall_itemcodes", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));
            //ConnectionClose();

            List<string> itemcodes = new List<string>();
            foreach (DataRow r in dt.Rows)
            {
                // Get the value of the wanted column and cast it to string
                string st = (string)r["MI_CD"];
                itemcodes.Add(st);
            }

            return itemcodes;
        }

        public DataTable Get_all_LocationsTable(string company)
        {
            // Nadeeka 26-02-13
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;

            DataTable dt = QueryDataTable("tbl", "SP_GETALLLOCATIONS_COMPANY", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public List<string> GetAll_binCodes_for_loc(string company, string location)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_bins", "sp_getall__bincodes_for_loc", CommandType.StoredProcedure, false, param);

            List<string> bin_list = new List<string>();

            foreach (DataRow r in _dtResults.Rows)
            {
                // Get the value of the wanted column and cast it to string
                string st = (string)r["INB_BIN"];
                bin_list.Add(st);
            }
            bin_list.Sort();

            List<string> binList = new List<string>();
            binList.Add("--select--");
            foreach (string r in bin_list)
            {
                // Get the value of the wanted column and cast it to string
                binList.Add(r);
            }

            return binList;
        }

        //Code By - Shani on 24/4/2012
        public Dictionary<string, string> Get_all_ItemSatus()
        {
            //ConnectionOpen();
            DataTable dt = new DataTable("ItemCodes");
            ConnectionOpen();

            dt = QueryDataTable("tbl_ItemCodes", "sp_get_all_item_satus", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));
            //ConnectionClose();

            Dictionary<string, string> itemStatus_list = new Dictionary<string, string>();
            foreach (DataRow r in dt.Rows)
            {
                // Get the value of the wanted column and cast it to string
                string st_code = (string)r["MIS_CD"];
                string st_descript = (string)r["MIS_DESC"];
                itemStatus_list.Add(st_code, st_descript);
            }

            return itemStatus_list;
        }

        public DataTable getDetail_on_serial1(string _company, string _location, string _serial1)
        {
            //List<InventorySerial> _int_ser_List = new List<InventorySerial>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = new DataTable();
            _itemTable = QueryDataTable("tblserial", "sp_get_detail_on_serial_no1", CommandType.StoredProcedure, false, param);

            return _itemTable;
        }

        public DataTable getMovementSerial(string _item, string _serial1)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = new DataTable();
            _itemTable = QueryDataTable("tblserial", "sp_get_Ser", CommandType.StoredProcedure, false, param);

            return _itemTable;
        }
        //Code by- Shani on 25/4/2012

        public List<ReptPickSerials> Search_by_serial(string company, string location, string itemCode, string bin, string serial_1, string serial_2)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[4] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial_1;
            (param[5] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial_2;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_search_by_serialNo", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();

            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }

            return serial_list;
        }

        public List<ReptPickSerials> Get_all_serials_for_itemCD(string company, string location, string binCode, string itemCode)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = binCode;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_serials_for_itemcd", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }

            return serial_list;
        }

        //11-5-2012 Consignment
        // to search item by supplier and serial 1 or serial 2
        public DataTable getDetail_on_serial_Supplier(string _company, string _location, string supplierCD, string serial_1, string serial_2)
        {
            //List<InventorySerial> _int_ser_List = new List<InventorySerial>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_supplierCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplierCD;
            (param[3] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial_1;
            (param[4] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial_2;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = new DataTable();
            // get from INR_SER
            _itemTable = QueryDataTable("tblserial", "sp_GETdetail_on_ser_Supplier", CommandType.StoredProcedure, false, param);

            return _itemTable;
        }

        // on 9-5-2012
        public Boolean Update_sat_itm_DO_qty(string invoiceNo, Int32 item_Line, int DO_qty)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_itemline", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item_Line;
            (param[2] = new OracleParameter("p_do_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = DO_qty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_sat_itm_do_qty", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        //on 8-5-2012
        public List<ReptPickSerials> Search_serials_for_itemCD(string company, string location, string itemCode, string pbook, string pblvl, string supplier, bool ISsupplier)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbook;
            (param[4] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblvl;
            (param[5] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
            (param[6] = new OracleParameter("p_issupplier", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(ISsupplier);
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_search_serials_for_itemCD", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }
        public List<ReptPickSerials> Search_serials_for_itemCD2(string company, string location, string itemCode, string status, string supplier)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[4] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_search_serials_for_itemCD2", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }
        //Add by Lakshan 21 Oct 2016 
        public List<ReptPickSerials> Search_serials_for_itemCD_batch_base(string company, string location, string itemCode, string pbook, string pblvl, string supplier, string _baseBatchNo, bool ISsupplier)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbook;
            (param[4] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblvl;
            (param[5] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
            (param[6] = new OracleParameter("p_issupplier", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(ISsupplier);
            (param[7] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseBatchNo;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_search_serials_for_bat_base", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }

        public List<ReptPickSerials> Search_Serial_For_Job_Item_old(string company, string location, string itemCode, string itemstatus, decimal qty, string jobno, int joblineno)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_item_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemstatus;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = qty;
            (param[5] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            (param[6] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = joblineno;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_serials_for_itemcodejob", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }

        public List<ReptPickSerials> Search_Serial_For_Job_Item(string company, string location, string bin, string itemCode, string itemstatus, decimal qty, string jobno, int joblineno)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[4] = new OracleParameter("p_item_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = qty;
            (param[6] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            (param[7] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = joblineno;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_serials_for_itmcdjobnew", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }
        //Add by Lakshan 21 Oct 2016 Get serial for batch wise aod out
        public List<ReptPickSerials> Search_Serial_For_Batch_Base_Item(string company, string location, string bin, string itemCode, string itemstatus, decimal qty, string _baseBatchNo)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[4] = new OracleParameter("p_item_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = qty;
            (param[6] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseBatchNo;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_serials_for_batch_base", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }

        //Chamal 06-Sep-2016
        public Int32 UpdateReservedSerialID(string _company, string _location, string _item, int _serID)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serID;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_res_ser_id", CommandType.StoredProcedure, param);
        }



        //10-5-2012 consigment return note
        public List<ReptPickSerials> GET_ser_for_ItmCD_Supplier(string company, string location, string binCode, string itemCode, string supplier)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = binCode;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[4] = new OracleParameter("p_supplierCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_GET_ser_for_ItmCD_Supplier", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }

        //2-5-2012
        public ReptPickSerials Get_all_details_on_serialID(string company, string location, string bin, string itemCode, int serial_ID)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[4] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serial_ID;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_get_detail_on_serial_ID", CommandType.StoredProcedure, false, param);
            ReptPickSerials _reptPickSerials = new ReptPickSerials();
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials = SetReptPickSerials(tr);
            }
            return _reptPickSerials;
        }

        public ReptPickSerials Get_all_details_on_serial(string company, string location, string bin, string itemCode, string serial_1)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[4] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial_1;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //query the INR_SER table
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_get_serial_detail", CommandType.StoredProcedure, false, param);

            ReptPickSerials _reptPickSerials = new ReptPickSerials();
            if (dt == null || dt.Rows.Count <= 0) return _reptPickSerials;//Added by Prabhath on 31/12/2013
            var _lst = (from DataRow _dts in dt.Rows select _dts).ToList();

            System.Threading.Tasks.Parallel.ForEach(_lst, tr => { _reptPickSerials = SetReptPickSerials(tr); });
            return _reptPickSerials;
        }

        //on 27/4/2012
        //sp_get_location_by_code   (p_com_code in string,p_loc_code in string,c_data OUT sys_refcursor)
        public DataTable Get_location_by_code(string com_code, string location, int _all = 0)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com_code;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[3] = new OracleParameter("is_all", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _all;
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_location", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);

            return dt;
        }


        // on 27/4/2012
        public string Get_item_description(string itemCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_itm_desc", "sp_MST_ITM_Descript", CommandType.StoredProcedure, false, param);
            string des = "";
            foreach (DataRow tr in dt.Rows)
            {
                des = (string)tr["MI_SHORTDESC"];
            }
            return des;
        }

        //on 2-5-2012
        //this method is for non-serial items
        public Boolean Update_serialID_INS_AVAILABLE(string compny, string location, string itemCD, Int32 ser_ID, int availability)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = compny;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[3] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_ID;
            (param[4] = new OracleParameter("availability", OracleDbType.Int32, null, ParameterDirection.Input)).Value = availability;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_ser_id_INS_AVAILABLE", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        //on 26/4/2012
        public Boolean Update_inrser_INS_AVAILABLE(string compny, string location, string itemCD, string ser_1, int availability)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = compny;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[3] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_1;
            (param[4] = new OracleParameter("availability", OracleDbType.Int32, null, ParameterDirection.Input)).Value = availability;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_inrser_INS_AVAILABLE", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        #endregion

        //Stock Adjustment- Inventory
        //Code By - Shani on 5/4/2012
        #region

        public List<string> GetAll_Adj_SubTypes()
        {
            //ConnectionOpen();
            DataTable dt = new DataTable("Adj_sub_items");
            //ConnectionOpen();

            dt = QueryDataTable("tblAdj_sub_items", "sp_get_adj_sub_items", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));
            //ConnectionClose();

            List<string> L = new List<string>();
            foreach (DataRow r in dt.Rows)
            {
                // Get the value of the wanted column and cast it to string
                string st = (string)r["MMCT_SCD"];
                // string st = (string)r["MMCT_SDESC"];
                L.Add(st);
            }

            return L;
        }

        public string Get_Adj_SubTypes_description(string subtypeCd)
        {
            DataTable dt = new DataTable("Adj_sub_items");

            //OracleParameter[] param = new OracleParameter[2];
            //(param[0] = new OracleParameter("subtype_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subtypeCd;
            //param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblAdj_sub_items", "sp_get_adj_sub_items", CommandType.StoredProcedure, false, new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            //  dt = QueryDataTable("tblAdj_sub_items", "sp_get_adj_sub_items", CommandType.StoredProcedure, false, param);
            //ConnectionClose();

            List<string> L = new List<string>();
            string desc = "";
            foreach (DataRow r in dt.Rows)
            {
                // Get the value of the wanted column and cast it to string
                string code = Convert.ToString(r["MMCT_SCD"]);
                desc = Convert.ToString(r["MMCT_SDESC"]);
                if (code == subtypeCd)
                {
                    return desc;
                }

                // L.Add(st);
            }

            // return L;
            return desc;
        }

        public int Generate_new_seq_num(string usrID, string doc_type, int direction_, string company_)
        {
            //ConnectionOpen();
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("usrid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = usrID;
            (param[1] = new OracleParameter("doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_type;
            (param[2] = new OracleParameter("direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = direction_;
            (param[3] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company_;
            //  param[4] = new OracleParameter("seq_number", OracleDbType.Int32, null, ParameterDirection.Output);
            OracleParameter outParameter = new OracleParameter("seq_number", OracleDbType.Int32, null, ParameterDirection.Output);
            //param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            // ReturnSP_SingleValue(String _storedProcedure, CommandType _commTypes,OracleParameter _outPara, params OracleParameter[] _parameters)
            int seq = ReturnSP_SingleValue("SP_SEQ_NUM_GENERATOR", CommandType.StoredProcedure, outParameter, param);
            //ConnectionClose();
            return seq;
        }

        //public Int32 SaveSeq_to_TempPickHDR()
        //{
        //}
        #endregion

        #region InventoryRequest(MRN/GRAN/DIN/INTER-TRANSFER)

        //Miginda - 31/03/2012
        public List<InventoryRequest> GetAllInventoryRequestData(InventoryRequest _inventoryRequest)
        {
            List<InventoryRequest> _inventoryRequestList = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[3] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[4] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[6] = new OracleParameter("p_createdBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_getallinventoryrequestdata", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //Convert datatable to relavant generic List.
                _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterTotal);
            }

            return _inventoryRequestList;
        }

        //Chamal - 06/06/2012
        public DataTable GetAllInventoryRequestDataTable(InventoryRequest _inventoryRequest)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[3] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[4] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[6] = new OracleParameter("p_createdBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_getallinventoryrequestdata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Miginda - 02/04/2012
        public InventoryRequest GetInventoryRequestDataByReqNo(InventoryRequest _inputInventoryRequest)
        {
            InventoryRequest _inventoryRequest = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inputInventoryRequest.Itr_req_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblInventoryRequestData", "sp_getinventoryrequestdata", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //Convert datatable to relavant generic List.
                _inventoryRequest = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter)[0];
            }

            return _inventoryRequest;
        }

        public DataTable GetInventoryRequestByReqNo(string _reqNo)
        {//Nadeeka 04-01-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_getinventoryrequestdata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetUserNameByUserID(string _UserID)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _UserID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUser", "SP_GET_USER_BY_USERID", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInventoryRequestSerialsBySeqNo(string _seqNo)
        {//Nadeeka 04-01-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_getinventoryrequestSerials", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInventoryRequestItemsBySeqNo(string _seqNo)
        {//Nadeeka 04-01-2013
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_getinventoryrequestItems", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Miginda - 02/04/2012
        public List<InventoryRequestItem> GetInventoryRequestItemDataByReqNo(InventoryRequest _inputInventoryRequest)
        {
            List<InventoryRequestItem> _inventoryRequestItemList = null;
            InventoryRequestItem _inventoryRequestItem = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inputInventoryRequest.Itr_req_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getinventoryrequestitemdata", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _inventoryRequestItemList = new List<InventoryRequestItem>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _inventoryRequestItem = new InventoryRequestItem();
                    _inventoryRequestItem.Itri_seq_no = (_dtResults.Rows[i]["Itri_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Itri_seq_no"]);
                    _inventoryRequestItem.Itri_line_no = (_dtResults.Rows[i]["Itri_line_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Itri_line_no"]);
                    _inventoryRequestItem.Itri_itm_stus = (_dtResults.Rows[i]["Itri_itm_stus"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Itri_itm_stus"].ToString();
                    _inventoryRequestItem.Itri_qty = (_dtResults.Rows[i]["Itri_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Itri_qty"]);
                    _inventoryRequestItem.Itri_unit_price = (_dtResults.Rows[i]["Itri_unit_price"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Itri_unit_price"]);
                    _inventoryRequestItem.Itri_app_qty = (_dtResults.Rows[i]["Itri_app_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Itri_app_qty"]); //Tharanga Itri_app_qty change to Itri_qty
                    _inventoryRequestItem.Itri_res_no = (_dtResults.Rows[i]["Itri_res_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Itri_res_no"].ToString();
                    _inventoryRequestItem.Itri_note = (_dtResults.Rows[i]["Itri_note"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Itri_note"].ToString();
                    _inventoryRequestItem.Itri_mitm_cd = (_dtResults.Rows[i]["itri_mitm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["itri_mitm_cd"].ToString();
                    _inventoryRequestItem.Itri_mitm_stus = (_dtResults.Rows[i]["itri_mitm_stus"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["itri_mitm_stus"].ToString();
                    _inventoryRequestItem.Itri_mqty = (_dtResults.Rows[i]["itri_mqty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["itri_mqty"]);
                    _inventoryRequestItem.Itri_bqty = (_dtResults.Rows[i]["itri_bqty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["itri_bqty"]);//Tharanga Itri_qty change to itri_bqty
                    _inventoryRequestItem.ITRI_ITM_COND = (_dtResults.Rows[i]["itri_itm_cond"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["itri_itm_cond"].ToString();
                    //Added By Prabhath on 12/01/2012
                    _inventoryRequestItem.Itri_itm_cd = (_dtResults.Rows[i]["itri_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["itri_itm_cd"].ToString();
                    _inventoryRequestItem.Mi_longdesc = (_dtResults.Rows[i]["mi_longdesc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["mi_longdesc"].ToString();
                    _inventoryRequestItem.Mi_brand = (_dtResults.Rows[i]["mi_brand"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["mi_brand"].ToString();
                    _inventoryRequestItem.Mi_model = (_dtResults.Rows[i]["mi_model"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["mi_model"].ToString();

                    _inventoryRequestItem.Itri_mitm_cd = (_dtResults.Rows[i]["itri_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["itri_itm_cd"].ToString();

                    _inventoryRequestItem.MasterItem = new MasterItem()
                    {
                        Mi_cd = (_dtResults.Rows[i]["itri_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["itri_itm_cd"].ToString(),
                        Mi_longdesc = (_dtResults.Rows[i]["mi_longdesc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["mi_longdesc"].ToString(),
                        Mi_brand = (_dtResults.Rows[i]["mi_brand"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["mi_brand"].ToString(),
                        Mi_model = (_dtResults.Rows[i]["mi_model"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["mi_model"].ToString()
                    };

                    _inventoryRequestItemList.Add(_inventoryRequestItem);
                }
            }

            return _inventoryRequestItemList;
        }

        //Chamal 06/06/2012
        public DataTable GetInventoryRequestItemDataByReqNo(string _reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getinventoryrequestitemdata", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable GetJobNoByReqNo(string _reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_get_jobno_by_req", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Miginda - 02/04/2012
        public int SaveInventoryRequestItem(InventoryRequestItem _inventoryRequestItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[31];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_seq_no;
            (param[1] = new OracleParameter("p_itri_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_line_no;
            if (_inventoryRequestItem.MasterItem != null)
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.MasterItem.Mi_cd;
            }
            else
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            }

            (param[3] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_itm_stus;
            (param[4] = new OracleParameter("p_itri_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_qty;
            (param[5] = new OracleParameter("p_itri_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_unit_price;
            (param[6] = new OracleParameter("p_itri_app_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_app_qty;
            (param[7] = new OracleParameter("p_itri_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_no;
            (param[8] = new OracleParameter("p_itri_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_note;
            (param[9] = new OracleParameter("p_itri_mitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            (param[10] = new OracleParameter("p_itri_mitm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_stus;
            (param[11] = new OracleParameter("p_itri_mqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mqty;
            (param[12] = new OracleParameter("p_itri_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_bqty;
            (param[13] = new OracleParameter("p_itri_itm_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.ITRI_ITM_COND;
            (param[14] = new OracleParameter("P_itri_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_job_no;//Add by Suneth 20-11-2014
            (param[15] = new OracleParameter("P_itri_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_job_line;//Add by Suneth 20-11-2014
            (param[16] = new OracleParameter("P_itri_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_com;
            (param[17] = new OracleParameter("P_itri_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_loc;
            (param[18] = new OracleParameter("P_itri_po_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_po_qty;
            (param[19] = new OracleParameter("P_itri_iss_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_issue_qty;
            (param[20] = new OracleParameter("P_itri_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_qty;
            (param[21] = new OracleParameter("P_itri_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_line;
            (param[22] = new OracleParameter("P_itri_cncl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_cncl_qty;
            (param[23] = new OracleParameter("P_itri_shop_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_shop_qty;
            (param[24] = new OracleParameter("P_itri_fd_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_fd_qty;
            (param[25] = new OracleParameter("P_itri_git_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_git_qty;
            (param[26] = new OracleParameter("P_itri_buffer", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_buffer;
            (param[27] = new OracleParameter("P_itri_advan_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_advan_qty;
            (param[28] = new OracleParameter("P_itri_base_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_base_req_no;//Add by Rukshan 19-12-2015
            (param[29] = new OracleParameter("P_itri_base_req_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_base_req_line;//Add by Rukshan 19-12-2015
            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_updateinventoryrequestitem", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Chamal - 10/07/2012
        public int SaveInventoryRequestSerials(InventoryRequestSerials _inventoryRequestSerials)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[21];
            (param[0] = new OracleParameter("p_itrs_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_seq_no;
            (param[1] = new OracleParameter("p_itrs_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_line_no;
            (param[2] = new OracleParameter("p_itrs_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_line;
            (param[3] = new OracleParameter("p_itrs_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_itm_cd;
            (param[4] = new OracleParameter("p_itrs_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_itm_stus;
            (param[5] = new OracleParameter("p_itrs_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_1;
            (param[6] = new OracleParameter("p_itrs_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_2;
            (param[7] = new OracleParameter("p_itrs_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_3;
            (param[8] = new OracleParameter("p_itrs_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_4;
            (param[9] = new OracleParameter("p_itrs_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_qty;
            (param[10] = new OracleParameter("p_itrs_in_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_seqno;
            (param[11] = new OracleParameter("p_itrs_in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_docno;
            (param[12] = new OracleParameter("p_itrs_in_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_itmline;
            (param[13] = new OracleParameter("p_itrs_in_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_batchline; //Corrected by Chamal 08-Feb-2013
            (param[14] = new OracleParameter("p_itrs_in_serline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_serline;
            (param[15] = new OracleParameter("p_itrs_in_docdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_docdt;
            (param[16] = new OracleParameter("p_itrs_trns_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_trns_tp;
            (param[17] = new OracleParameter("p_itrs_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_rmk;
            (param[18] = new OracleParameter("p_itrs_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_id;
            (param[19] = new OracleParameter("p_itrs_nitm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_nitm_stus;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_updateinvreqserials", CommandType.StoredProcedure, param);
            return rows_affected;
        } 

        //Miginda - 02/04/2012
        public int SaveInventoryRequest(InventoryRequest _inventoryRequest)
        {
            int seqno = 0;
            OracleParameter[] param = new OracleParameter[39];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[2] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[3] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_sub_tp;
            (param[4] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[5] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_ref;
            (param[6] = new OracleParameter("p_itr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_dt;
            (param[7] = new OracleParameter("p_itr_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exp_dt;
            (param[8] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[9] = new OracleParameter("p_itr_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_no;
            (param[10] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_bus_code;
            (param[11] = new OracleParameter("p_itr_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_note;
            (param[12] = new OracleParameter("p_itr_issue_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_from;
            (param[13] = new OracleParameter("p_itr_rec_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_rec_to;
            (param[14] = new OracleParameter("p_itr_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_direct;
            (param[15] = new OracleParameter("p_itr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_country_cd;
            (param[16] = new OracleParameter("p_itr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_town_cd;
            (param[17] = new OracleParameter("p_itr_cur_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cur_code;
            (param[18] = new OracleParameter("p_itr_exg_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exg_rate;
            (param[19] = new OracleParameter("p_itr_collector_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_id;
            (param[20] = new OracleParameter("p_itr_collector_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_name;
            (param[21] = new OracleParameter("p_itr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_act;
            (param[22] = new OracleParameter("p_itr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            (param[23] = new OracleParameter("p_itr_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[24] = new OracleParameter("p_itr_issue_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com; //add chamal 17-08-2012
            (param[25] = new OracleParameter("p_itr_gran_opt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt1; //add chamal 17-08-2012
            (param[26] = new OracleParameter("p_itr_gran_opt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt2; //add chamal 17-08-2012
            (param[27] = new OracleParameter("p_itr_gran_opt3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt3; //add chamal 17-08-2012
            (param[28] = new OracleParameter("p_itr_gran_opt4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt4; //add chamal 17-08-2012
            (param[29] = new OracleParameter("p_itr_gran_nstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_nstus; //add chamal 17-08-2012
            (param[30] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by; //add chamal 17-08-2012
            (param[31] = new OracleParameter("p_itr_gran_narrt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_narrt; //add chamal 17-08-2012
            (param[32] = new OracleParameter("p_itr_gran_app_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_note; //add chamal 17-08-2012
            (param[33] = new OracleParameter("p_itr_gran_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_stus; //add chamal 17-08-2012
            (param[34] = new OracleParameter("p_itr_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal1; //add scahith 2012/11/3
            (param[35] = new OracleParameter("p_itr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal2; //add scahith 2013/02/15
            (param[36] = new OracleParameter("p_itr_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_seq_no; //add Prabhath 2013/02/23
            (param[37] = new OracleParameter("P_itr_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_line; //add tharaka 2014-10-30
            param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            seqno = UpdateRecords("sp_updateinventoryrequest", CommandType.StoredProcedure, param);
            _inventoryRequest.Itr_seq_no = seqno;
            return seqno;
        }

        //Miginda - 18/05/2012
        //Sahan added p_itr_gran_app_by parameter 07/Nov/2015
        public int UpdateInventoryRequestStatus(InventoryRequest _inventoryRequest)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[6] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_int_req_status", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        //Code By Miginda on 19/05/2012
        public int DeleteInventoryRequestItemData(InventoryRequest _inventoryRequest)
        {
            //ConnectionOpen();
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            OracleParameter outParameter = new OracleParameter("hdr_seq_no", OracleDbType.Int32, null, ParameterDirection.Output);
            int hdr_seq_no = ReturnSP_SingleValue("sp_delete_inv_req_data", CommandType.StoredProcedure, outParameter, param);
            //ConnectionClose();
            return hdr_seq_no;
        }

        //Code by Chamal De Silva on 06/07/2012
        public DataTable GetAllGRANSerialsTable(string _company, string _loc, string _documentType, string _docNo)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentType;
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "SP_GETGRANSERIALS", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }

        //Code by Chamal De Silva on 06/07/2012
        public List<InventoryRequestSerials> GetAllGRANSerialsList(string _company, string _loc, string _documentType, string _docNo)
        {
            List<InventoryRequestSerials> _reqserials = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentType;
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "SP_GETGRANSERIALS", CommandType.StoredProcedure, false, param);

            if (_tblItem.Rows.Count > 0)
            {
                _reqserials = DataTableExtensions.ToGenericList<InventoryRequestSerials>(_tblItem, InventoryRequestSerials.ConvertTotal);
            }
            return _reqserials;
        }

        #endregion

        //Written By P.Wijetunge on 9/4/2012
        public MasterAutoNumber GetAutoNumber(string _module, Int32? _direction, string _startChar, string _catType, string _catCode, DateTime? _modifyDate, Int32? _year)
        {
            OracleParameter[] param = new OracleParameter[8];
            MasterAutoNumber _masterAutoNumber = new MasterAutoNumber();

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startChar;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catType;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catCode;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _modifyDate;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAuto", "sp_autonumber", CommandType.StoredProcedure, false, param);
            //   p_module IN NVARCHAR2,p_direction IN NUMBER,p_startchar IN NVARCHAR2,p_cattype in NVARCHAR2,p_catcode in NVARCHAR2,p_modifydate in DATE,p_year in NUMBER ,c_data out SYS_REFCURSOR
            if (_dtResults.Rows.Count > 0)
            {
                _masterAutoNumber = DataTableExtensions.ToGenericList<MasterAutoNumber>(_dtResults, MasterAutoNumber.ConvertTotal)[0];
            }
            else if (_dtResults.Rows.Count == 0)
            {
                //_masterAutoNumber.Aut_number = 999;//since the auto number not generated, it is hard corded.

                _masterAutoNumber.Aut_cate_cd = _catCode;
                _masterAutoNumber.Aut_cate_tp = _catType;
                _masterAutoNumber.Aut_direction = _direction;
                _masterAutoNumber.Aut_modify_dt = _modifyDate;
                _masterAutoNumber.Aut_moduleid = _module;
                _masterAutoNumber.Aut_number = 1;
                _masterAutoNumber.Aut_start_char = _startChar;
                _masterAutoNumber.Aut_year = _year;
            }

            //if (_masterAutoNumber == null)
            //{
            //    _masterAutoNumber.Aut_cate_cd = _catCode;
            //    _masterAutoNumber.Aut_cate_tp = _catType;
            //    _masterAutoNumber.Aut_direction = _direction;
            //    _masterAutoNumber.Aut_modify_dt = _modifyDate;
            //    _masterAutoNumber.Aut_moduleid = _module;
            //    _masterAutoNumber.Aut_number = 1;
            //    _masterAutoNumber.Aut_start_char = _startChar;
            //    _masterAutoNumber.Aut_year = _year;
            //}

            return _masterAutoNumber;
        }

        //Written By P.Wijetunge on 9/4/2012
        public Int16 UpdateAutoNumber(MasterAutoNumber _masterAutoNumber)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_moduleid;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_start_char;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_tp;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_cd;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_modify_dt;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_year;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            
            effected = UpdateRecords("sp_updateautonumber", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        //Written By Chamal De Silva on 15/05/2012
        public Int16 UpdateOtherDocuments(string _docNo, string _othDocNo)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_otherdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDocNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_updateotherdocno", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        //Written By P.Wijetunge on 10/4/2012
        public DataTable GetAllPurchaseOrder(string _company, string _adminTeam, string _status)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminTeam;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblPo", "sp_getpurchaseorder", CommandType.StoredProcedure, false, param);
        }

        //Written By P.Wijetunge on 10/4/2012
        public DataTable GetAllPurchaseOrderDetail(string _company, string _adminTeam, string _poNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminTeam;
            (param[2] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblPo", "sp_getpurchaseorderdetail", CommandType.StoredProcedure, false, param);
        }

        public List<PurchaseOrderDetail> GetAllPurchaseOrderDetailList(string _company, string _adminTeam, string _poNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<PurchaseOrderDetail> _itemList = null;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminTeam;
            (param[2] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tblPo", "sp_getpurchaseorderdetail", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<PurchaseOrderDetail>(_tbl, PurchaseOrderDetail.ConvertDetails);
            }
            return _itemList;
        }

        #region Inventory IN Process

        //Written By P.Wijetunge on 02/04/2012
        //Edit By rukshan Add Bool Parameter for Temp save 12/sep/2015
        public Int32 SaveInvnetoryHeader(InventoryHeader _header, bool _isTemp = false)
        {
            OracleParameter[] param = new OracleParameter[61];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_acc_no;
            (param[1] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_anal_1;
            (param[2] = new OracleParameter("p_anal_10", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_anal_10 == true ? 1 : 0;
            (param[3] = new OracleParameter("p_anal_11", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_anal_11 == true ? 1 : 0;
            (param[4] = new OracleParameter("p_anal_12", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_anal_12 == true ? 1 : 0;
            (param[5] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_anal_2;
            (param[6] = new OracleParameter("p_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_anal_3;
            (param[7] = new OracleParameter("p_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_anal_4;
            (param[8] = new OracleParameter("p_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_anal_5;
            (param[9] = new OracleParameter("p_anal_6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _header.Ith_anal_6;//Decimal to Int32
            (param[10] = new OracleParameter("p_anal_7", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _header.Ith_anal_7;//Decimal to Int32
            (param[11] = new OracleParameter("p_anal_8", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.Ith_anal_8;
            (param[12] = new OracleParameter("p_anal_9", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.Ith_anal_9;
            (param[13] = new OracleParameter("p_bus_entity", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_bus_entity;
            (param[14] = new OracleParameter("p_cate_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_cate_tp;
            (param[15] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_channel;
            (param[16] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_com;
            (param[17] = new OracleParameter("p_com_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_com_docno;
            (param[18] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_cre_by;
            (param[19] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.Ith_cre_when;
            (param[20] = new OracleParameter("p_del_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_del_add1;
            (param[21] = new OracleParameter("p_del_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_del_add2;
            (param[22] = new OracleParameter("p_del_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_del_code;//"del code";
            (param[23] = new OracleParameter("p_del_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_del_party;
            (param[24] = new OracleParameter("p_del_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_del_town;
            (param[25] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_direct == true ? 1 : 0;
            (param[26] = new OracleParameter("p_doc_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.Ith_doc_date.Date;
            //(param[26] = new OracleParameter("p_doc_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now.Date;
            (param[27] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_doc_no;
            (param[28] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_doc_tp;
            (param[29] = new OracleParameter("p_doc_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _header.Ith_doc_year;
            (param[30] = new OracleParameter("p_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_entry_no;
            (param[31] = new OracleParameter("p_entry_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_entry_tp;
            (param[32] = new OracleParameter("p_git_close", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_git_close == true ? 1 : 0;
            (param[33] = new OracleParameter("p_git_close_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.Ith_git_close_date;
            (param[34] = new OracleParameter("p_git_close_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_git_close_doc;
            (param[35] = new OracleParameter("p_is_manual", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_is_manual == true ? 1 : 0;
            (param[36] = new OracleParameter("p_isprinted", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _header.Ith_isprinted == true ? 1 : 0;
            (param[37] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_job_no;
            (param[38] = new OracleParameter("p_loading_point", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_loading_point;
            (param[39] = new OracleParameter("p_loading_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_loading_user;
            (param[40] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_loc;
            (param[41] = new OracleParameter("p_manual_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_manual_ref;
            (param[42] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_mod_by;
            (param[43] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.Ith_mod_when;
            (param[44] = new OracleParameter("p_noofcopies", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _header.Ith_noofcopies;
            (param[45] = new OracleParameter("p_oth_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_oth_loc;
            (param[46] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_pc; // add 18/05/2012 chamal
            (param[47] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_remarks;
            (param[48] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_sbu;
            (param[49] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _header.Ith_seq_no;// GetSerialID();
            (param[50] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_session_id;
            (param[51] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_stus;
            (param[52] = new OracleParameter("p_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_sub_tp;
            (param[53] = new OracleParameter("p_vehi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_vehi_no;
            (param[54] = new OracleParameter("p_sub_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_sub_docno;
            (param[55] = new OracleParameter("p_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_oth_docno;
            (param[56] = new OracleParameter("p_oth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_oth_com; //add 22/05/2012 chamal
            (param[57] = new OracleParameter("p_Ith_gen_frm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_gen_frm; //add 22/05/2012 chamal
            (param[57] = new OracleParameter("p_Ith_gen_frm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.Ith_gen_frm; //add 22/05/2012 chamal
            (param[58] = new OracleParameter("p_ith_sup_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _header.ITH_SUP_INV_NO; //add 06Feb2018 Lakshan
            (param[59] = new OracleParameter("p_ith_sup_inv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _header.ITH_SUP_INV_DT; //add 06Feb2018 Lakshan
            param[60] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //p_del_cd
            if (_isTemp == false)
            {
                effects = (Int16)UpdateRecords("sp_save_inthdr", CommandType.StoredProcedure, param);
            }
            else
            {
                effects = (Int16)UpdateRecords("sp_save_inthdr_temp", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        //Written By P.Wijetunge on 02/04/2012
        public bool SaveInventoryItem(InventoryItem _item)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_seq_no;
            (param[1] = new OracleParameter("p_item_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_item_line;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_doc_no;
            (param[3] = new OracleParameter("p_bin_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_bin_code;
            (param[4] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_code;
            (param[5] = new OracleParameter("p_item_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_status;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_qty;
            (param[7] = new OracleParameter("p_bal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_bal_qty;
            (param[8] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_year;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_intitm", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        //Written By P.Wijetunge on 02/04/2012
        //Edit by Chamal De Silva on 17/04/2012
        //Edit By rukshan Add Bool Parameter for Temp save 12/sep/2015

        public Int32 SaveInventorySerial(InventorySerialN _serial, Int16 _invDirect, bool _isTemp = false)
        {
            OracleParameter[] param = new OracleParameter[49];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_seq_no;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_itm_line;
            (param[2] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_batch_line;
            (param[3] = new OracleParameter("p_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_ser_line;
            (param[4] = new OracleParameter("p_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_direct;
            (param[5] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_doc_no;
            (param[6] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_doc_dt;
            (param[7] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_com;
            (param[8] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_loc;
            (param[9] = new OracleParameter("p_bin;", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_bin;
            (param[10] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_itm_cd;
            (param[11] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_itm_stus;
            (param[12] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.Ins_unit_cost;
            (param[13] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_ser_id;
            (param[14] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_1;
            (param[15] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_2;
            (param[16] = new OracleParameter("p_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_3;
            (param[17] = new OracleParameter("p_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_4;
            (param[18] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_warr_no;
            (param[19] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_warr_period;
            (param[20] = new OracleParameter("p_orig_grncom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_orig_grncom;
            (param[21] = new OracleParameter("p_orig_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_orig_grnno;
            (param[22] = new OracleParameter("p_orig_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_orig_grndt;
            (param[23] = new OracleParameter("p_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_orig_supp;
            (param[24] = new OracleParameter("p_exist_grncom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_exist_grncom;
            (param[25] = new OracleParameter("p_exist_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_exist_grnno;
            (param[26] = new OracleParameter("p_exist_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_exist_grndt;
            (param[27] = new OracleParameter("p_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_exist_supp;
            (param[28] = new OracleParameter("p_cross_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_seqno;
            (param[29] = new OracleParameter("p_cross_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_itmline;
            (param[30] = new OracleParameter("p_cross_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_batchline;
            (param[31] = new OracleParameter("p_cross_serline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_serline;
            if (_serial.Ins_issue_dt.Date == Convert.ToDateTime("01-Jan-0001").Date) _serial.Ins_issue_dt = DateTime.MaxValue.Date;
            (param[32] = new OracleParameter("p_issue_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_issue_dt;
            (param[33] = new OracleParameter("p_inv_direction", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invDirect;

            (param[34] = new OracleParameter("p_cross_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_cross_doc_no;
            (param[35] = new OracleParameter("p_fifo_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_fifo_doc_no;
            (param[36] = new OracleParameter("p_fifo_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_fifo_doc_dt.Date;
            (param[37] = new OracleParameter("p_fifo_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_fifo_ser_id;
            (param[38] = new OracleParameter("p_fifo_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_fifo_ser_1;
            (param[39] = new OracleParameter("p_is_fifo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serial.Ins_is_fifo;

            (param[40] = new OracleParameter("p_ageloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ageloc;
            if (_serial.Ins_ageloc_dt == null || _serial.Ins_ageloc_dt == Convert.ToDateTime("01-Jan-0001").Date) _serial.Ins_ageloc_dt = _serial.Ins_doc_dt;
            (param[41] = new OracleParameter("p_ageloc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_ageloc_dt;
            (param[42] = new OracleParameter("p_isownmrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_isownmrn;

            (param[43] = new OracleParameter("p_ispge", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_is_pgs;
            (param[44] = new OracleParameter("p_pgscount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_pgs_count;
            (param[45] = new OracleParameter("p_pgspref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_pg_prefix;
            (param[46] = new OracleParameter("p_stpg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_st_pg;
            (param[47] = new OracleParameter("p_edpg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_ed_pg;

            param[48] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            if (_isTemp == false)
            {
                effects = (Int16)UpdateRecords("sp_save_intser_n", CommandType.StoredProcedure, param);
            }
            else
            {
                effects = (Int16)UpdateRecords("sp_save_intser_n_temp", CommandType.StoredProcedure, param);
            }

            return effects;
        }

        //Written by Chamal De Silva on 21/07/2012
        public Int32 UpdateOutCrossRef(string p_doc_no, Int32 p_ser_id, DateTime p_issue_dt, Int32 p_cross_seqno, Int32 p_cross_itmline, Int32 p_cross_batchline, Int32 p_cross_serline)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_doc_no;
            (param[1] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ser_id;
            (param[2] = new OracleParameter("p_cross_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_cross_seqno;
            (param[3] = new OracleParameter("p_cross_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_cross_itmline;
            (param[4] = new OracleParameter("p_cross_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_cross_batchline;
            (param[5] = new OracleParameter("p_cross_serline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_cross_serline;
            (param[6] = new OracleParameter("p_issue_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_issue_dt.Date;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_intser", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Chamal De Silva on 21/07/2012
        public Int32 UpdateOutDocStatus(string p_doc_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_doc_no;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_outhdr", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Chamal De Silva on 05/04/2013
        public Int32 UpdateErrAODLocation(string p_doc_no, string p_loca)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_doc_no;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loca;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_erraodloc", CommandType.StoredProcedure, param);
            return effects;
        }
        //Written by Sanjeewa 2016-12-16
        public Int32 UpdateErrAODLocationBMT(string p_doc_no, string p_loca, string p_com)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_doc_no;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loca;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_erraodlocBMT", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By P.Wijetunge on 02/04/2012
        //Edit by Chamal De Silva on 17/04/2012
        public bool SaveInventorySerialRef(InventorySerialRefN _serial, Int16 _invDirect)
        {
            OracleParameter[] param = new OracleParameter[46];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_loc;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_bin;
            (param[3] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_doc_no;
            (param[4] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_seq_no;
            (param[5] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_itm_line;
            (param[6] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_batch_line;
            (param[7] = new OracleParameter("p_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_ser_line;
            (param[8] = new OracleParameter("p_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_direct;
            (param[9] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_doc_dt;
            (param[10] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_itm_cd;
            (param[11] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_itm_stus;
            (param[12] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.Ins_unit_cost;
            (param[13] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.Ins_unit_price;
            (param[14] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_ser_id;
            (param[15] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_1;
            (param[16] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_2;
            (param[17] = new OracleParameter("p_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_3;
            (param[18] = new OracleParameter("p_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ser_4;
            (param[19] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_warr_no;
            (param[20] = new OracleParameter("p_available", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serial.Ins_available;
            (param[21] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_warr_period;
            (param[22] = new OracleParameter("p_orig_grncom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_orig_grncom;
            (param[23] = new OracleParameter("p_orig_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_orig_grnno;
            (param[24] = new OracleParameter("p_orig_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_orig_grndt;
            (param[25] = new OracleParameter("p_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_orig_supp;
            (param[26] = new OracleParameter("p_exist_grncom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_exist_grncom;
            (param[27] = new OracleParameter("p_exist_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_exist_grnno;
            (param[28] = new OracleParameter("p_exist_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_exist_grndt;
            (param[29] = new OracleParameter("p_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_exist_supp;
            (param[30] = new OracleParameter("p_cross_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_seqno;
            (param[31] = new OracleParameter("p_cross_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_itmline;
            (param[32] = new OracleParameter("p_cross_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_batchline;
            (param[33] = new OracleParameter("p_cross_serline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_cross_serline;
            (param[34] = new OracleParameter("p_issue_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_issue_dt;
            (param[35] = new OracleParameter("p_inv_direction", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invDirect;
            if (_serial.Ins_ageloc_dt == null || _serial.Ins_ageloc_dt == Convert.ToDateTime("01-Jan-0001").Date) _serial.Ins_ageloc_dt = _serial.Ins_doc_dt;
            (param[36] = new OracleParameter("p_ageloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_ageloc;
            (param[37] = new OracleParameter("p_ageloc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Ins_ageloc_dt;
            (param[38] = new OracleParameter("p_isownmrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_isownmrn;

            (param[39] = new OracleParameter("p_ispge", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_is_pgs;
            (param[40] = new OracleParameter("p_pgscount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_pgs_count;
            (param[41] = new OracleParameter("p_pgspref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_pg_prefix;
            (param[42] = new OracleParameter("p_stpg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_st_pg;
            (param[43] = new OracleParameter("p_edpg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_ed_pg;
            (param[44] = new OracleParameter("p_tmpalwduplicateser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.tmpalwduplicateser;

            param[45] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_inrser_n", CommandType.StoredProcedure, param);
          
            return effects >= 1 ? true : false;
        }

        //Written By P.Wijetunge on 02/04/2012
        public bool SaveInventoryBatch(InventoryBatchN _batch)
        {
            OracleParameter[] param = new OracleParameter[34];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_seq_no;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_itm_line;
            (param[2] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_batch_line;
            (param[3] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_batch_no;
            (param[4] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_doc_no;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_com;
            (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_loc;
            (param[7] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_bin;
            (param[8] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_cd;
            (param[9] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_stus;
            (param[10] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_qty;
            (param[11] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_cost;
            (param[12] = new OracleParameter("p_bal_qty1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Itb_bal_qty1;
            (param[13] = new OracleParameter("p_bal_qty2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Itb_bal_qty2;
            (param[14] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_price;
            (param[15] = new OracleParameter("p_base_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no;
            (param[16] = new OracleParameter("p_base_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_ref_no;
            (param[17] = new OracleParameter("p_base_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Itb_base_doc_dt;
            (param[18] = new OracleParameter("p_base_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmcd;
            (param[19] = new OracleParameter("p_base_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmline;
            (param[20] = new OracleParameter("p_base_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmstus;
            (param[21] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_job_no;
            (param[22] = new OracleParameter("p_git_ignore", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore;
            (param[23] = new OracleParameter("p_git_ignore_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore_by;
            (param[24] = new OracleParameter("p_git_ignore_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore_dt;
            (param[25] = new OracleParameter("p_git_ignore_effdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore_effdt;
            (param[26] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_res_no;
            (param[27] = new OracleParameter("p_res_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_res_lineno;
            (param[28] = new OracleParameter("p_base_doc_no1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no1;
            (param[29] = new OracleParameter("p_base_doc_no2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no2;
            (param[30] = new OracleParameter("p_base_doc_no3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no3;
            (param[31] = new OracleParameter("p_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_cur_cd;
            (param[32] = new OracleParameter("p_grup_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_grup_cur_cd;
            param[33] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_intbatch", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        //Written By P.Wijetunge on 02/04/2012
        public bool SaveWarrantyDetail(InventoryWarrantyDetail _inventoryWarrantyDetail)
        {
            #region add by lakshan 28jun2017
            MasterItem _itm = GetItemMaster(_inventoryWarrantyDetail.Irsm_itm_cd);
            if (_itm != null)
            {
                _inventoryWarrantyDetail.Irsm_itm_brand = _itm.Mi_brand;
                _inventoryWarrantyDetail.Irsm_itm_desc = _itm.Mi_shortdesc;
                _inventoryWarrantyDetail.Irsm_itm_model = _itm.Mi_model;
            }
            #endregion
            OracleParameter[] param = new OracleParameter[66];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_acc_no;
            (param[1] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_1;
            (param[2] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_2;
            (param[3] = new OracleParameter("p_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_3;
            (param[4] = new OracleParameter("p_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_4;
            (param[5] = new OracleParameter("p_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_5;
            (param[6] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_channel;
            (param[7] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_com;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cre_by;
            (param[9] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cre_when;
            (param[10] = new OracleParameter("p_cust_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_addr;
            (param[11] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_cd;
            (param[12] = new OracleParameter("p_cust_del_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_del_addr;
            (param[13] = new OracleParameter("p_cust_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_email;
            (param[14] = new OracleParameter("p_cust_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_fax;
            (param[15] = new OracleParameter("p_cust_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_mobile;
            (param[16] = new OracleParameter("p_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_name;
            (param[17] = new OracleParameter("p_cust_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_prefix;
            (param[18] = new OracleParameter("p_cust_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_tel;
            (param[19] = new OracleParameter("p_cust_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_town;
            (param[20] = new OracleParameter("p_cust_vat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_vat_no;
            (param[21] = new OracleParameter("p_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_direct;
            (param[22] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_doc_dt;
            (param[23] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_doc_no;
            (param[24] = new OracleParameter("p_doc_year", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_doc_year;
            (param[25] = new OracleParameter("p_exist_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_grn_com;
            (param[26] = new OracleParameter("p_exist_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_grn_dt;
            (param[27] = new OracleParameter("p_exist_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_grn_no;
            (param[28] = new OracleParameter("p_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_supp;
            (param[29] = new OracleParameter("p_invoice_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_invoice_dt;
            (param[30] = new OracleParameter("p_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_invoice_no;
            (param[31] = new OracleParameter("p_itm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_brand;
            (param[32] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_cd;
            (param[33] = new OracleParameter("p_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_desc;
            (param[34] = new OracleParameter("p_itm_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_model;
            (param[35] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_stus;
            (param[36] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_loc;
            (param[37] = new OracleParameter("p_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_loc_desc;
            (param[38] = new OracleParameter("p_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_mfc;
            (param[39] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_mod_by;
            (param[40] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_mod_when;
            (param[41] = new OracleParameter("p_orig_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_grn_com;
            (param[42] = new OracleParameter("p_orig_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_grn_dt;
            (param[43] = new OracleParameter("p_orig_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_grn_no;
            (param[44] = new OracleParameter("p_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_supp;
            (param[45] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_sbu;
            (param[46] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_1;
            (param[47] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_2;
            (param[48] = new OracleParameter("p_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_3;
            (param[49] = new OracleParameter("p_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_4;
            (param[50] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_id;
            (param[51] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_session_id;
            (param[52] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_unit_cost;
            (param[53] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_unit_price;
            (param[54] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_no;
            (param[55] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_period;
            (param[56] = new OracleParameter("p_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_rem;
            (param[57] = new OracleParameter("p_warr_start_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_start_dt;
            (param[58] = new OracleParameter("p_warr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_stus;

            //Sahan
            (param[59] = new OracleParameter("p_irsm_sys_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_SYS_BLNO;
            (param[60] = new OracleParameter("p_irsm_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_BLNO;
            (param[61] = new OracleParameter("p_irsm_bl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_BL_DT;
            (param[62] = new OracleParameter("p_irsm_sys_fin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_SYS_FIN_NO;
            (param[63] = new OracleParameter("p_irsm_fin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_FIN_NO;
            (param[64] = new OracleParameter("p_irsm_fin_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_FIN_DT;

            param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_inr_sermst", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        //Written By P.Wijetunge on 02/04/2012
        public bool SaveWarrantySubDetail(InventoryWarrantySubDetail _inventoryWarrantySubDetail)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;

            (param[0] = new OracleParameter("Irsms_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_act;
            (param[1] = new OracleParameter("Irsms_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_itm_cd;
            (param[2] = new OracleParameter("Irsms_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_itm_stus;
            (param[3] = new OracleParameter("Irsms_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_mfc;
            (param[4] = new OracleParameter("Irsms_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_ser_id;
            (param[5] = new OracleParameter("Irsms_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_ser_line;
            (param[6] = new OracleParameter("Irsms_sub_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_sub_ser;
            (param[7] = new OracleParameter("Irsms_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_tp;
            (param[8] = new OracleParameter("Irsms_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_warr_no;
            (param[9] = new OracleParameter("Irsms_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_warr_period;
            (param[10] = new OracleParameter("Irsms_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantySubDetail.Irsms_warr_rem;
            effects = (Int16)UpdateRecords("", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        // Written by P.Wijetunge on 05/04/2012
        /// <summary>
        /// Common Get Serial ID function return and increase the serial id no
        /// </summary>
        /// <returns>Unique Serial ID </returns>
        public Int32 GetSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getserialid", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 GetReqSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getreqserialid", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 GetSMSSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("o_smsid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getsmsid", CommandType.StoredProcedure, param);
            return effects;
        }

        #endregion

        #region Inventory In/Out Process

        //Written By Chamal De Silva on 10/04/2012
        public Int16 UpdateInventoryLocation(InventoryLocation _invLoca, Int16 _invDirect)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invLoca.Inl_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invLoca.Inl_loc;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invLoca.Inl_itm_cd;
            (param[3] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invLoca.Inl_itm_stus;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_qty;
            (param[5] = new OracleParameter("p_free_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_free_qty;
            (param[6] = new OracleParameter("p_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_res_qty;
            (param[7] = new OracleParameter("p_isu_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_isu_qty;
            (param[8] = new OracleParameter("p_bl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_bl_qty;
            (param[9] = new OracleParameter("p_eo_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_eo_qty;
            (param[10] = new OracleParameter("p_ro_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invLoca.Inl_ro_qty;
            (param[11] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invLoca.Inl_cre_by;
            (param[12] = new OracleParameter("p_inv_direction", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invDirect;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inrloc", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By Chamal De Silva on 10/04/2012
        //Edit By rukshan Add Bool Parameter for Temp save 12/sep/2015
        public Int16 UpdateInventoryItem(InventoryItem _item, bool _isTemp = false)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_bal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_bal_qty;
            (param[1] = new OracleParameter("p_bin_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_bin_code;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_doc_no;
            (param[3] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_code;
            (param[4] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_item_line;
            (param[5] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_status;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_qty;
            (param[7] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_seq_no;
            (param[8] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_year;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            if (_isTemp == false)
            {
                effects = (Int16)UpdateRecords("sp_update_intitm", CommandType.StoredProcedure, param);
            }
            else
            {
                effects = (Int16)UpdateRecords("sp_update_intitm_temp", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        //Written By Chamal De Silva on 10/04/2012
        //Edit By rukshan Add Bool Parameter for Temp save 12/sep/2015
        public Int16 UpdateInventoryItemForMac(InventoryItem _item, bool _isTemp = false)
        {
            OracleParameter[] param = new OracleParameter[12];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_bal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_bal_qty;
            (param[1] = new OracleParameter("p_bin_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_bin_code;
            (param[2] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_doc_no;
            (param[3] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_code;
            (param[4] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_item_line;
            (param[5] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_status;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_qty;
            (param[7] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_seq_no;
            (param[8] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_year;
            (param[9] = new OracleParameter("p_iti_uom_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_pkg_uom_tp;
            (param[10] = new OracleParameter("p_iti_uom_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Iti_pkg_uom_qty;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            if (_isTemp == false)
            {
                // effects = (Int16)UpdateRecords("sp_update_intitm", CommandType.StoredProcedure, param);
                effects = (Int16)UpdateRecords("sp_update_intitm_mac", CommandType.StoredProcedure, param);
            }
            else
            {
                effects = (Int16)UpdateRecords("sp_update_intitm_temp_mac", CommandType.StoredProcedure, param);
            }
            return effects;
        }

        //Written By Chamal De Silva on 10/04/2012
        public Int16 GetInventoryItemLine(InventoryItem _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Iti_seq_no;
            (param[1] = new OracleParameter("p_bin_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_bin_code;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_code;
            (param[3] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Iti_item_status;
            OracleParameter _outParam = new OracleParameter("o_itm_line", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = Convert.ToInt16(ReturnSP_SingleValue("sp_getintitmline", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        //Written By Chamal De Silva on 10/04/2012
        public Int16 GetInventoryBatchLine(InventoryBatchN _batch)
        {
            OracleParameter[] param = new OracleParameter[14];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_seq_no;
            (param[1] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_batch_no;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_bin;
            (param[3] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_cd;
            (param[4] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_stus;
            (param[5] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_cost;
            (param[6] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_price;
            (param[7] = new OracleParameter("p_base_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no;
            (param[8] = new OracleParameter("p_base_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmcd;
            (param[9] = new OracleParameter("p_base_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmline;
            (param[10] = new OracleParameter("p_base_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmstus;
            (param[11] = new OracleParameter("p_base_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Itb_base_batchline;
            (param[12] = new OracleParameter("p_base_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_ref_no;
            (param[13] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_base_refline;
            OracleParameter _outparam = new OracleParameter("o_batch_line", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = Convert.ToInt16(ReturnSP_SingleValue("sp_getintbatchline", CommandType.StoredProcedure, _outparam, param));
            return effects;
        }

        //Written By Chamal De Silva on 10/04/2012
        //Edit By rukshan Add Bool Parameter for Temp save 12/sep/2015
        public Int16 UpdateInventoryBatch(InventoryBatchN _batch, bool _isTemp = false)
        {
            //try
            //{
            Int16 effects = 0;
            OracleParameter[] param = new OracleParameter[40];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_seq_no;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_itm_line;
            (param[2] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_batch_line;
            (param[3] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_batch_no;
            (param[4] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_doc_no;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_com;
            (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_loc;
            (param[7] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_bin;
            (param[8] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_cd;
            (param[9] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_stus;
            (param[10] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_qty;
            (param[11] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_cost;
            (param[12] = new OracleParameter("p_bal_qty1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Itb_bal_qty1;
            (param[13] = new OracleParameter("p_bal_qty2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Itb_bal_qty2;
            (param[14] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_price;
            (param[15] = new OracleParameter("p_base_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no;
            (param[16] = new OracleParameter("p_base_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_ref_no;
            (param[17] = new OracleParameter("p_base_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Itb_base_doc_dt;
            (param[18] = new OracleParameter("p_base_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmcd;
            (param[19] = new OracleParameter("p_base_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmline;
            (param[20] = new OracleParameter("P_base_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Itb_base_batchline;
            (param[21] = new OracleParameter("p_base_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmstus;
            (param[22] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_job_no;
            (param[23] = new OracleParameter("p_git_ignore", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore;
            (param[24] = new OracleParameter("p_git_ignore_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore_by;
            (param[25] = new OracleParameter("p_git_ignore_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore_dt;
            (param[26] = new OracleParameter("p_git_ignore_effdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Itb_git_ignore_effdt;
            (param[27] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_res_no;
            (param[28] = new OracleParameter("p_res_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_res_lineno;
            (param[29] = new OracleParameter("p_base_doc_no1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no1;
            (param[30] = new OracleParameter("p_base_doc_no2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no2;
            (param[31] = new OracleParameter("p_base_doc_no3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no3;
            (param[32] = new OracleParameter("p_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_cur_cd;
            (param[33] = new OracleParameter("p_grup_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_grup_cur_cd;
            (param[34] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_base_refline;
            (param[35] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_job_line;
            (param[36] = new OracleParameter("p_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Inb_exp_dt; //kapila 4/7/2015
            (param[37] = new OracleParameter("p_manufac_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Inb_manufac_dt; //kapila 20/7/2015
            (param[38] = new OracleParameter("p_mitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_mitm_cd; //Chamal 14/09/2015
            param[39] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            if (_isTemp == false)
            {
                effects = (Int16)UpdateRecords("sp_update_intbatch_new1", CommandType.StoredProcedure, param);
              //  effects = (Int16)UpdateRecords("sp_update_intbatch_new", CommandType.StoredProcedure, param);
            }
            else
            {
                effects = (Int16)UpdateRecords("sp_update_intbatch_new_temp", CommandType.StoredProcedure, param);
            }
            if (effects > 1)
            {
                int tmpFind = 0;
            }
            return effects;
            //}
            //catch (Exception ex)
            //{
            //    throw ex;
            //}
        }

        //Written By Chamal De Silva on 10/04/2012
        public Int16 UpdateInventoryBatchRef(InventoryBatchN _batch, Int16 _invDirect)
        {
            OracleParameter[] param = new OracleParameter[41];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_base_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no;
            (param[1] = new OracleParameter("p_base_doc_no1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no1;
            (param[2] = new OracleParameter("p_base_doc_no2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no2;
            (param[3] = new OracleParameter("p_base_doc_no3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_doc_no3;
            (param[4] = new OracleParameter("p_base_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmcd;
            (param[5] = new OracleParameter("p_base_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmline;
            (param[6] = new OracleParameter("p_base_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Itb_base_batchline;
            (param[7] = new OracleParameter("p_base_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_itmstus;
            (param[8] = new OracleParameter("p_base_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_base_qty;
            (param[9] = new OracleParameter("p_base_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_base_ref_no;
            (param[10] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_batch_line;
            (param[11] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_batch_no;
            (param[12] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_bin;
            (param[13] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_com;
            (param[14] = new OracleParameter("p_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_cur_cd;
            (param[15] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Inb_doc_dt;
            (param[16] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_doc_no;
            (param[17] = new OracleParameter("p_ex_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_ex_rate;
            (param[18] = new OracleParameter("p_excess_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_excess_qty;
            (param[19] = new OracleParameter("p_free_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_free_qty;
            (param[20] = new OracleParameter("p_grup_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_grup_cur_cd;
            (param[21] = new OracleParameter("p_grup_ex_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_grup_ex_rate;
            (param[22] = new OracleParameter("p_isu_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_isu_qty;
            (param[23] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_cd;
            (param[24] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_itm_line;
            (param[25] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_itm_stus;
            (param[26] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_job_no;
            (param[27] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_loc;
            (param[28] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_qty;
            (param[29] = new OracleParameter("p_res_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_res_lineno;
            (param[30] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_res_no;
            (param[31] = new OracleParameter("p_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_res_qty;
            (param[32] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_seq_no;
            (param[33] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_cost;
            (param[34] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _batch.Inb_unit_price;
            (param[35] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batch.Inb_job_line;
            (param[36] = new OracleParameter("p_inv_direction", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invDirect;
            (param[37] = new OracleParameter("p_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Inb_exp_dt;
            (param[38] = new OracleParameter("p_manufac_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _batch.Inb_manufac_dt;
            (param[39] = new OracleParameter("p_mitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch.Inb_mitm_cd; //Chamal 15/09/2015
            param[40] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
          effects = (Int16)UpdateRecords("sp_update_inrbatch_new1", CommandType.StoredProcedure, param);
            //effects = (Int16)UpdateRecords("sp_update_inrbatch_new1", CommandType.StoredProcedure, param);
            return effects;
        }

        //public Int16 UpdateInventoryWarrantyMaster(InventoryWarrantyDetail _warranty)
        //       {
        //           OracleParameter[] param = new OracleParameter[60];
        //           Int16 effects = 0;
        //           (param[0] = new OracleParameter("Irsm_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_acc_no;
        //           (param[1] = new OracleParameter("Irsm_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_anal_1;
        //           (param[2] = new OracleParameter("Irsm_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_anal_2;
        //           (param[3] = new OracleParameter("Irsm_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_anal_3;
        //           (param[4] = new OracleParameter("Irsm_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_anal_4;
        //           (param[5] = new OracleParameter("Irsm_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_anal_5;
        //           (param[6] = new OracleParameter("Irsm_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_channel;
        //           (param[7] = new OracleParameter("Irsm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_com;
        //           (param[8] = new OracleParameter("Irsm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cre_by;
        //           (param[9] = new OracleParameter("Irsm_cre_when", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cre_when;
        //           (param[10] = new OracleParameter("Irsm_cust_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_addr;
        //           (param[11] = new OracleParameter("Irsm_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_cd;
        //           (param[12] = new OracleParameter("Irsm_cust_del_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_del_addr;
        //           (param[13] = new OracleParameter("Irsm_cust_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_email;
        //           (param[14] = new OracleParameter("Irsm_cust_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_fax;
        //           (param[15] = new OracleParameter("Irsm_cust_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_mobile;
        //           (param[16] = new OracleParameter("Irsm_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_name;
        //           (param[17] = new OracleParameter("Irsm_cust_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_prefix;
        //           (param[18] = new OracleParameter("Irsm_cust_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_tel;
        //           (param[19] = new OracleParameter("Irsm_cust_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_town;
        //           (param[20] = new OracleParameter("Irsm_cust_vat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_cust_vat_no;
        //           (param[21] = new OracleParameter("Irsm_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_direct;
        //           (param[22] = new OracleParameter("Irsm_doc_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_doc_dt;
        //           (param[23] = new OracleParameter("Irsm_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_doc_no;
        //           (param[24] = new OracleParameter("Irsm_doc_year", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_doc_year;
        //           (param[25] = new OracleParameter("Irsm_exist_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_exist_grn_com;
        //           (param[26] = new OracleParameter("Irsm_exist_grn_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_exist_grn_dt;
        //           (param[27] = new OracleParameter("Irsm_exist_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_exist_grn_no;
        //           (param[28] = new OracleParameter("Irsm_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_exist_supp;
        //           (param[29] = new OracleParameter("Irsm_invoice_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_invoice_dt;
        //           (param[30] = new OracleParameter("Irsm_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_invoice_no;
        //           (param[31] = new OracleParameter("Irsm_itm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_itm_brand;
        //           (param[32] = new OracleParameter("Irsm_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_itm_cd;
        //           (param[33] = new OracleParameter("Irsm_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_itm_desc;
        //           (param[34] = new OracleParameter("Irsm_itm_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_itm_model;
        //           (param[35] = new OracleParameter("Irsm_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_itm_stus;
        //           (param[36] = new OracleParameter("Irsm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_loc;
        //           (param[37] = new OracleParameter("Irsm_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_loc_desc;
        //           (param[38] = new OracleParameter("Irsm_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_mfc;
        //           (param[39] = new OracleParameter("Irsm_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_mod_by;
        //           (param[40] = new OracleParameter("Irsm_mod_when", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_mod_when;
        //           (param[41] = new OracleParameter("Irsm_orig_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_orig_grn_com;
        //           (param[42] = new OracleParameter("Irsm_orig_grn_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_orig_grn_dt;
        //           (param[43] = new OracleParameter("Irsm_orig_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_orig_grn_no;
        //           (param[44] = new OracleParameter("Irsm_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_orig_supp;
        //           (param[45] = new OracleParameter("Irsm_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_sbu;
        //           (param[46] = new OracleParameter("Irsm_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_ser_1;
        //           (param[47] = new OracleParameter("Irsm_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_ser_2;
        //           (param[48] = new OracleParameter("Irsm_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_ser_3;
        //           (param[49] = new OracleParameter("Irsm_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_ser_4;
        //           (param[50] = new OracleParameter("Irsm_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_ser_id;
        //           (param[51] = new OracleParameter("Irsm_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_session_id;
        //           (param[52] = new OracleParameter("Irsm_unit_cost", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_unit_cost;
        //           (param[53] = new OracleParameter("Irsm_unit_price", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_unit_price;
        //           (param[54] = new OracleParameter("Irsm_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_warr_no;
        //           (param[55] = new OracleParameter("Irsm_warr_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_warr_period;
        //           (param[56] = new OracleParameter("Irsm_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_warr_rem;
        //           (param[57] = new OracleParameter("Irsm_warr_start_dt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_warr_start_dt;
        //           (param[58] = new OracleParameter("Irsm_warr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty.Irsm_warr_stus;

        //           param[59] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
        //           effects = (Int16)UpdateRecords("sp_update_inr_sermst", CommandType.StoredProcedure, param);
        //           return effects;
        //       }

        //Written By Chamal De Silva on 10/04/2012
        public Int16 GetInventorySerLine(InventorySerialN _serial)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_seq_no;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_itm_line;
            (param[2] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Ins_batch_line;
            (param[3] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_bin;
            (param[4] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_itm_cd;
            (param[5] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Ins_itm_stus;
            (param[6] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.Ins_unit_cost;
            OracleParameter _outParam = new OracleParameter("o_ser_no", OracleDbType.Int32, null, ParameterDirection.Output);
            //Int16 _effect = Convert.ToInt16(ReturnSP_SingleValue("sp_getintserline", CommandType.StoredProcedure, _outParam, param));
            effects = Convert.ToInt16(ReturnSP_SingleValue("sp_getintserline_duplicate", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        //Written By Chamal De Silva on 15/04/2012
        public Int16 UpdateMovementDocNo(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_movseqno", CommandType.StoredProcedure, param);

            return effects;
        }

        //Written By Chamal De Silva on 22/04/2013
        public Int16 UpdateMovementDocNo_Other(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_movseqno_other", CommandType.StoredProcedure, param);
            return effects;
        }

        // Nadeeka 24-11-2015
        public Int16 UpdateMovementStatus(string _docno, string _sts, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_ith_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sts;
            (param[1] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_ith_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inv_hdr", CommandType.StoredProcedure, param);
            return effects;
        }


        //kapila
        public Int16 UpdateMovementDocNo_Batch(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_movseqno_batch", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateRCCDocNo(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_rcc_req_no", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By M.Geeganage on 19/04/2012
        public Int16 UpdateInventoryRequestDocNo(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_InvReqDocNo", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written By Chamal De Silva on 13/06/2012
        public List<InventorySerialN> GetIntSerList(Int32 _seqNo, string _docNo)
        {
            List<InventorySerialN> _sers = new List<InventorySerialN>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblMovSerials = QueryDataTable("tblMovSerials", "sp_getintser", CommandType.StoredProcedure, false, param);

            OracleParameter[] param1 = new OracleParameter[3];      //24/9/2015
            (param1[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param1[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param1[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblMovBatch = QueryDataTable("tblMovBatch", "sp_getintserasbatch", CommandType.StoredProcedure, false, param1);
            _tblMovSerials.Merge(_tblMovBatch);
            if (_tblMovSerials.Rows.Count > 0)
            {
                _sers = DataTableExtensions.ToGenericList<InventorySerialN>(_tblMovSerials, InventorySerialN.ConverterTotal);
            }

            return _sers;
        }

        public List<InventorySerialN> GetIntSerList_new(string _docNo)
        {
            List<InventorySerialN> _sers = new List<InventorySerialN>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblMovSerials = QueryDataTable("tblMovSerials", "sp_getintserasbatch_new", CommandType.StoredProcedure, false, param);
            if (_tblMovSerials.Rows.Count > 0)
            {
                //_sers = DataTableExtensions.ToGenericList<InventorySerialN>(_tblMovSerials, InventorySerialN.ConverterTotal);//ConverterTotalNEW
                _sers = DataTableExtensions.ToGenericList<InventorySerialN>(_tblMovSerials, InventorySerialN.ConverterTotalNEW);//ConverterTotalNEW
            }

            return _sers;
        }

        public List<InventorySubSerialMaster> GetAvailablesubSerils(Int32 _serialid)
        {
            List<InventorySubSerialMaster> _sers = new List<InventorySubSerialMaster>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialid;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblMovSerials = QueryDataTable("tblMovSerials", "sp_getSubSerialDetails", CommandType.StoredProcedure, false, param);


            if (_tblMovSerials.Rows.Count > 0)
            {
                _sers = DataTableExtensions.ToGenericList<InventorySubSerialMaster>(_tblMovSerials, InventorySubSerialMaster.ConvertSelected);
            }

            return _sers;
        }
        public List<InventorySubSerialMaster> GetAvailablesubSerilsMain(Int32 _serialid)
        {
            List<InventorySubSerialMaster> _sers = new List<InventorySubSerialMaster>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialid;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);



            DataTable _tblMovSerials = QueryDataTable("tblMovSerials", "sp_getSubSerialDetails_main", CommandType.StoredProcedure, false, param);
            if (_tblMovSerials.Rows.Count > 0)
            {
                _sers = DataTableExtensions.ToGenericList<InventorySubSerialMaster>(_tblMovSerials, InventorySubSerialMaster.ConvertSelected);
            }

            return _sers;
        }

        //Code by Chamal De Silva 07-Jul-2012
        public ReptPickSerials GetAvailableSerIDInformation(string _com, string _loc, string _itemCode, string _serial1, string _serial2, string _serialid)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[3] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[4] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            (param[5] = new OracleParameter("p_serial_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialid;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_getavailableseridinfor", CommandType.StoredProcedure, false, param);
            ReptPickSerials serial_list = null;

            //foreach (DataRow tr in dt.Rows)
            //{
            //    ReptPickSerials _reptPickSerials = new ReptPickSerials();
            //    DateTime _date = Convert.ToDateTime(DateTime.Now.Date).Date;

            //    _reptPickSerials.Tus_batch_line = Convert.ToInt32(tr["INS_BATCH_LINE"]);
            //    _reptPickSerials.Tus_bin = Convert.ToString(tr["INS_BIN"]);
            //    _reptPickSerials.Tus_com = Convert.ToString(tr["INS_COM"]);
            //    //    _reptPickSerials.Tus_cre_by = GlbUserName.Trim();//not sure
            //    _reptPickSerials.Tus_cre_dt = _date;//not sure
            //    _reptPickSerials.Tus_doc_dt = Convert.ToDateTime(tr["INS_DOC_DT"]);
            //    _reptPickSerials.Tus_doc_no = Convert.ToString(tr["INS_DOC_NO"]);
            //    _reptPickSerials.Tus_exist_grncom = Convert.ToString(tr["INS_EXIST_GRNCOM"]);//not sure
            //    // _reptPickSerials.Tus_exist_grndt = Convert.ToDateTime(tr["INS_EXIST_GRNDT"]);//not sure
            //    _reptPickSerials.Tus_exist_grnno = Convert.ToString(tr["INS_EXIST_GRNNO"]);
            //    _reptPickSerials.Tus_exist_supp = Convert.ToString(tr["INS_EXIST_SUPP"]);//TODO : GET SUPPLIER
            //    _reptPickSerials.Tus_itm_cd = Convert.ToString(tr["INS_ITM_CD"]);
            //    _reptPickSerials.Tus_itm_line = Convert.ToInt32(tr["INS_ITM_LINE"]);
            //    _reptPickSerials.Tus_itm_stus = Convert.ToString(tr["INS_ITM_STUS"]);//or ddl selected status?
            //    _reptPickSerials.Tus_loc = Convert.ToString(tr["INS_LOC"]);//not sure
            //    _reptPickSerials.Tus_orig_grncom = Convert.ToString(tr["INS_ORIG_GRNCOM"]);
            //    _reptPickSerials.Tus_orig_grndt = Convert.ToDateTime(tr["INS_ORIG_GRNDT"]);
            //    _reptPickSerials.Tus_orig_grnno = Convert.ToString(tr["INS_ORIG_GRNNO"]);
            //    _reptPickSerials.Tus_orig_supp = Convert.ToString(tr["INS_ORIG_SUPP"]);//TODO : GET SUPPLIER
            //    _reptPickSerials.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure
            //    _reptPickSerials.Tus_seq_no = Convert.ToInt32(tr["INS_SEQ_NO"]);
            //    _reptPickSerials.Tus_ser_1 = Convert.ToString(tr["INS_SER_1"]);
            //    _reptPickSerials.Tus_ser_2 = Convert.ToString(tr["INS_SER_2"]);
            //    _reptPickSerials.Tus_ser_3 = Convert.ToString(tr["INS_SER_3"]);
            //    _reptPickSerials.Tus_ser_4 = Convert.ToString(tr["INS_SER_4"]);
            //    _reptPickSerials.Tus_ser_id = Convert.ToInt32(tr["INS_SER_ID"]);
            //    _reptPickSerials.Tus_ser_line = Convert.ToInt32(tr["INS_SER_LINE"]);
            //    // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
            //    _reptPickSerials.Tus_unit_cost = Convert.ToDecimal(tr["INS_UNIT_COST"]);
            //    _reptPickSerials.Tus_unit_price = Convert.ToDecimal(tr["INS_UNIT_PRICE"]);
            //    //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
            //    _reptPickSerials.Tus_warr_no = Convert.ToString(tr["INS_WARR_NO"]);
            //    _reptPickSerials.Tus_warr_period = Convert.ToInt32(tr["INS_WARR_PERIOD"]);

            //    serial_list = _reptPickSerials;
            //}

            foreach (DataRow tr in dt.Rows)
            {
                serial_list = SetReptPickSerials(tr);
            }
            return serial_list;
        }

        #endregion

        #region Delivery Order Process

        // Written by Chamal De Silva 16-Jun-2012
        public Int16 UpdateInvoicveDOQty(string _invno, Int16 _invlineno, decimal _doqty)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _invlineno;
            (param[2] = new OracleParameter("p_do_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doqty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_invoiceitems", CommandType.StoredProcedure, param);
            return effects;
        }

        // Written by Chamal De Silva 16-Jun-2012
        public Int16 UpdateInvoiceDOStatus(string _invno)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_invchdrstus", CommandType.StoredProcedure, param);
            return effects;
        }

        #endregion

        #region Deliver Order Quatation Based
        // Nadeeka 26-03-2015
        public Int16 UpdateQuatationDOQty(string _quono, Int16 _quolineno, decimal _doqty)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quono;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _quolineno;
            (param[2] = new OracleParameter("p_issue_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doqty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_quotationitems", CommandType.StoredProcedure, param);
            return effects;
        }



        // Nadeeka 26-03-2015
        public Int16 UpdateQuatationDOStatus(string _quono)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quono;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_quochdrstus", CommandType.StoredProcedure, param);
            return effects;
        }
        #endregion


        public DataTable GetpoSummary(string _com, string _type, string _supplier, string _item, string _cat1, string _cat2, string _cat3, string _brand, String _model, DateTime _fdate, DateTime _tdate)
        {
            // Nadeeka 27-04-2015
            OracleParameter[] param = new OracleParameter[12];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[3] = new OracleParameter("in_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("in_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[5] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[9] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[10] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[11] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            DataTable _tblData = QueryDataTable("tbl", "sp_po_summary", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public DataTable GetReplaceOriginalItems(string _serial)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_newjobSer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblItemComponent", "sp_getReplacementItemHistory", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }


        //Written By Prabhath on 02/05/2012

        public DataTable GetItemComponentTable(string _mainItemCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_main_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainItemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblItemComponent", "sp_get_mst_itm_components", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        //Miginda - 03/05/2012
        public PurchaseOrder GetPurchaseOrderHeaderDetails(string _companyCode, string _docNo)
        {
            PurchaseOrder _purchaseOrder = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _companyCode;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblPOHeaderData", "sp_get_po_header_details", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //Convert datatable to relavant generic List.
                _purchaseOrder = DataTableExtensions.ToGenericList<PurchaseOrder>(_dtResults, PurchaseOrder.ConvertTotal)[0];
            }

            return _purchaseOrder;
        }

        //Miginda - 03/05/2012
        public List<PurchaseOrderDelivery> GetConsignmentItemDetails(string _companyCode, string _docNo, string _locCode)
        {
            List<PurchaseOrderDelivery> _purchaseOrderDeliveryList = null;
            PurchaseOrderDelivery _purchaseOrderDelivery = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _companyCode;
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblConsignmentItemDetails", "sp_get_consign_item_details", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _purchaseOrderDeliveryList = new List<PurchaseOrderDelivery>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _purchaseOrderDelivery = new PurchaseOrderDelivery();

                    _purchaseOrderDelivery.Podi_seq_no = (_dtResults.Rows[i]["podi_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["podi_seq_no"]);
                    _purchaseOrderDelivery.Podi_line_no = (_dtResults.Rows[i]["podi_line_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["podi_line_no"]);
                    _purchaseOrderDelivery.Podi_del_line_no = (_dtResults.Rows[i]["podi_del_line_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["podi_del_line_no"]);

                    _purchaseOrderDelivery.Podi_itm_stus = (_dtResults.Rows[i]["PODI_ITM_STUS"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["PODI_ITM_STUS"].ToString();
                    _purchaseOrderDelivery.Podi_bal_qty = (_dtResults.Rows[i]["PODI_BAL_QTY"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["PODI_BAL_QTY"]);
                    _purchaseOrderDelivery.Actual_qty = 0;
                    _purchaseOrderDelivery.Podi_loca = (_dtResults.Rows[i]["PODI_LOCA"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["PODI_LOCA"].ToString();
                    _purchaseOrderDelivery.MasterItem = new MasterItem()
                    {
                        Mi_cd = (_dtResults.Rows[i]["PODI_ITM_CD"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["PODI_ITM_CD"].ToString(),
                        Mi_longdesc = (_dtResults.Rows[i]["MI_LONGDESC"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["MI_LONGDESC"].ToString(),
                        Mi_brand = (_dtResults.Rows[i]["MI_BRAND"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["MI_BRAND"].ToString(),
                        Mi_model = (_dtResults.Rows[i]["MI_MODEL"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["MI_MODEL"].ToString(),
                        Mi_is_ser1 = (_dtResults.Rows[i]["mi_is_ser1"] == DBNull.Value) ? -2 : Convert.ToInt32(_dtResults.Rows[i]["mi_is_ser1"]),
                        Mi_is_ser2 = (_dtResults.Rows[i]["mi_is_ser2"] == DBNull.Value) ? -2 : Convert.ToInt32(_dtResults.Rows[i]["mi_is_ser2"]),
                        Mi_is_ser3 = (_dtResults.Rows[i]["mi_is_ser3"] == DBNull.Value) ? false : Convert.ToBoolean(_dtResults.Rows[i]["mi_is_ser3"])
                    };

                    _purchaseOrderDelivery.PurchaseOrderDetail = new PurchaseOrderDetail()
                    {
                        Pod_unit_price = (_dtResults.Rows[i]["pod_unit_price"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_unit_price"]),
                        Pod_line_no = (_dtResults.Rows[i]["pod_line_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["pod_line_no"])
                    };

                    _purchaseOrderDeliveryList.Add(_purchaseOrderDelivery);
                }
            }

            return _purchaseOrderDeliveryList;
        }

        //Code By Miginda on 10/05/2012
        public int UpdateConsignReceiptBalanceQty(int _seq_no, int _line_no, int _del_line_no, string _loc, string _item_cd, decimal _act_qty)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq_no;
            (param[1] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line_no;
            (param[2] = new OracleParameter("p_del_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _del_line_no;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item_cd;
            (param[5] = new OracleParameter("p_act_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _act_qty;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Open the connection and call the stored procedure.
            //ConnectionOpen(); Edit (Comment) by Chamal 15-05-2012
            rows_affected = UpdateRecords("sp_update_po_items_balqty", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Add By Chamal on 15/11/2012
        public int UpdatePOStatus(string _pono, string _user)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pono;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("SP_UPDATE_PO_STATUS", CommandType.StoredProcedure, param);
            return rows_affected;
        }




        //Nadeeka 14-02-2015
        public int UpdateSupplierClaimDoc(string _aodin, string _suppdoc, string _aodjob)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodin;

            (param[1] = new OracleParameter("p_Suppdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _suppdoc;
            (param[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodjob;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("SP_UPDATE_SUPP_CLAIM_DOC", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Nadeeka 14-02-2015
        public int UpdateSupplierClaimWarranty(string _aodin)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodin;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("SP_UPDATE_SUPP_CLAIM_WARRANTY", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Nadeeka 14-02-2015
        public int CheckSubSerialAvl(string _subser, string _subItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[3];
            //  (param[0] = new OracleParameter("p_serId", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            (param[0] = new OracleParameter("p_subser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subser;
            (param[1] = new OracleParameter("p_subItem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subItem;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_check_Sub_Ser", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Nadeeka 23-02-2015
        public int checkReqItemAllowCompany(string _item, string _com)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_check_ReqItemAllowCompany", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //Nadeeka 23-02-2015
        public int checkReqItemAllow(string _item)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_check_ReqItemAllow", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //Nadeeka 24-02-2015
        public int CheckJobInventoryBalance(string _com, string _loc, string _job, Int16 _jobline, string _item, string _itemsts, decimal _qty)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[3] = new OracleParameter("p_jobline", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _jobline;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_itemSts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsts;
            (param[6] = new OracleParameter("p_Qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_CheckJobInventoryBalance", CommandType.StoredProcedure, param);
            return rows_affected;
        }


        //Nadeeka 14-02-2015
        public int UpdateSupplierClaimSubItemsy(string _subItem, string _oldSubSer, string _newSubSer)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[4];
            //   (param[0] = new OracleParameter("p_serId", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            (param[0] = new OracleParameter("p_subitem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subItem;
            (param[1] = new OracleParameter("p_oldsubserial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldSubSer;
            (param[2] = new OracleParameter("p_newsubserial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newSubSer;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_update_claim_sub_serial", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Miginda - 03/05/2012
        public List<PurchaseOrder> GetAllPendingConsignmentRequestData(PurchaseOrder _paramPurchaseOrder)
        {
            List<PurchaseOrder> _purchaseOrderList = null;
            PurchaseOrder _purchaseOrder = null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterLocation.Ml_loc_cd;
            (param[2] = new OracleParameter("p_orderStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_stus;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterBusinessEntity.Mbe_tp;
            (param[4] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.FromDate;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.ToDate;
            (param[6] = new OracleParameter("p_suppCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_supp;
            (param[7] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_doc_no;
            (param[8] = new OracleParameter("p_subtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_sub_tp;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "sp_get_pending_cons_requests", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _purchaseOrderList = new List<PurchaseOrder>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _purchaseOrder = new PurchaseOrder();

                    _purchaseOrder.Poh_seq_no = (_dtResults.Rows[i]["POH_SEQ_NO"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["POH_SEQ_NO"]);
                    _purchaseOrder.Poh_doc_no = (_dtResults.Rows[i]["POH_DOC_NO"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["POH_DOC_NO"].ToString();
                    _purchaseOrder.Poh_dt = (_dtResults.Rows[i]["POH_DT"] == DBNull.Value) ? DateTime.MinValue : Convert.ToDateTime(_dtResults.Rows[i]["POH_DT"]);
                    _purchaseOrder.Poh_ref = (_dtResults.Rows[i]["POH_REF"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["POH_REF"].ToString();

                    _purchaseOrder.MasterBusinessEntity = new MasterBusinessEntity()
                    {
                        Mbe_cd = (_dtResults.Rows[i]["POH_SUPP"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["POH_SUPP"].ToString(),
                        Mbe_name = (_dtResults.Rows[i]["MBE_NAME"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["MBE_NAME"].ToString(),
                        Mbe_acc_cd = (_dtResults.Rows[i]["MBE_ACC_CD"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["MBE_ACC_CD"].ToString(),
                    };

                    _purchaseOrderList.Add(_purchaseOrder);
                }
            }

            return _purchaseOrderList;
        }

        //Add Chamal 26/02/2013
        public DataTable GetAllPendingPurchaseOrderDataTable(PurchaseOrder _paramPurchaseOrder)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterLocation.Ml_loc_cd;
            (param[2] = new OracleParameter("p_orderStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_stus;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterBusinessEntity.Mbe_tp;
            (param[4] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.FromDate;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.ToDate;
            (param[6] = new OracleParameter("p_suppCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_supp;
            (param[7] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_doc_no;
            (param[8] = new OracleParameter("p_subtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_sub_tp;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "sp_get_pending_cons_requests", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Add Chamal 26/02/2013
        public DataTable GetPOItemsDataTable(string _comCode, string _poNo, Int32 _all)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            (param[2] = new OracleParameter("p_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _all;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "sp_getpogrnpendingitems_new1", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Add Chamal 01/10/2014
        public DataTable GetSCM2PoDT(string _document)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_po", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "SP_GETSCM2PODET", CommandType.StoredProcedure, false, param);
            return dt;
            //CREATE OR REPLACE PROCEDURE SP_GETSCM2PODET(p_po in NVARCHAR2,c_data out sys_refcursor) is
            //--Written by Chamal on 01/10/2014
            //begin
            //open c_data for
            //    SELECT POD_LINE_NO AS LINE_NO,POD_ITM_CD AS ITEM_CODE,POD_ITM_STUS AS ITEM_STATUS,POD_UNIT_PRICE AS UNIT_RATE,POD_QTY AS QTY
            //    FROM PUR_DET
            //    WHERE POD_SEQ_NO IN (SELECT POH_SEQ_NO FROM PUR_HDR WHERE POH_DOC_NO =p_po)
            //    ORDER BY POD_ITM_CD,POD_ITM_STUS,POD_UNIT_PRICE,POD_QTY;
            //END;
        }

        //Code By Miginda on 08/05/2012
        public Int32 IsExistInSerialMaster(string _companyCode, string _itemCode, string _serialNo1)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _companyCode;
            (param[1] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[2] = new OracleParameter("p_serialNo1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo1;
            OracleParameter outParameter = new OracleParameter("serial_id", OracleDbType.Int32, null, ParameterDirection.Output);
            return ReturnSP_SingleValue("sp_isexist_in_serial_master", CommandType.StoredProcedure, outParameter, param);
        }

        //Chamal 06-Feb-2014
        public int IsExistInSerial1(string _com, string _itemCode, string _serialNo1)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[2] = new OracleParameter("p_serialNo1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo1;
            OracleParameter outParameter = new OracleParameter("serial_id", OracleDbType.Int32, null, ParameterDirection.Output);
            return ReturnSP_SingleValue("sp_isexist_ser1_com", CommandType.StoredProcedure, outParameter, param);
        }

        //Chamal 06-Feb-2014
        public int IsExistInSerial2(string _com, string _itemCode, string _serialNo2)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[2] = new OracleParameter("p_serialNo1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo2;
            OracleParameter outParameter = new OracleParameter("serial_id", OracleDbType.Int32, null, ParameterDirection.Output);
            return ReturnSP_SingleValue("sp_isexist_ser2_com", CommandType.StoredProcedure, outParameter, param);
        }

        public DataTable GetAvailableItemStatus(string _company, string _location, string _bin, string _item, string _serial)
        {
            //p_com in NVARCHAR2,p_loc in NVARCHAR2,p_bin in NVARCHAR2,p_item in NVARCHAR2,p_serial in NVARCHAR2
            //sp_availableitemstatus
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblAvlItmStatus = QueryDataTable("_tblAvlItmStatus", "sp_availableitemstatus", CommandType.StoredProcedure, false, param);
            return _tblAvlItmStatus;
        }

        //HW
        public List<InventoryLocation> GetItemInventoryBalance(string _company, string _location, string _item, string _status)
        {
            List<InventoryLocation> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_inventorybalance", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_tblBalance, InventoryLocation.ConvertTotal);
            }
            return _list;
        }

        public DataTable GetItemInventoryBalanceStatus(string _company, string _location, string _item, string _status)
        {
            //sp_invbalancestatus(p_com in NVARCHAR2,p_loc in NVARCHAR2 ,p_item in NVARCHAR2,p_status in NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_invbalancestatus", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        //hw by prabhath on 14 05 2012
        private ReptPickSerials SetReptPickSerials(DataRow _tr)
        {
            ReptPickSerials _pick = new ReptPickSerials();
            DateTime _date = Convert.ToDateTime(DateTime.Now.Date).Date;
            _pick.Tus_batch_line = Convert.ToInt32(_tr["INS_BATCH_LINE"]);
            _pick.Tus_bin = Convert.ToString(_tr["INS_BIN"]);
            _pick.Tus_com = Convert.ToString(_tr["INS_COM"]);
            //    _reptPickSerials.Tus_cre_by = GlbUserName.Trim();//not sure
            _pick.Tus_cre_dt = _date;//not sure
            _pick.Tus_doc_dt = Convert.ToDateTime(_tr["INS_DOC_DT"]);
            _pick.Tus_doc_no = Convert.ToString(_tr["INS_DOC_NO"]);
            _pick.Tus_exist_grncom = Convert.ToString(_tr["INS_EXIST_GRNCOM"]);//not sure
            _pick.Tus_exist_grndt = Convert.ToDateTime(_tr["INS_EXIST_GRNDT"]);//not sure
            _pick.Tus_exist_grnno = Convert.ToString(_tr["INS_EXIST_GRNNO"]);
            _pick.Tus_exist_supp = Convert.ToString(_tr["INS_EXIST_SUPP"]);//TODO : GET SUPPLIER
            _pick.Tus_itm_cd = Convert.ToString(_tr["INS_ITM_CD"]);
            _pick.Tus_itm_line = Convert.ToInt32(_tr["INS_ITM_LINE"]);
            _pick.Tus_itm_stus = Convert.ToString(_tr["INS_ITM_STUS"]);//or ddl selected status?
            _pick.Tus_loc = Convert.ToString(_tr["INS_LOC"]);//not sure
            _pick.Tus_orig_grncom = Convert.ToString(_tr["INS_ORIG_GRNCOM"]);
            _pick.Tus_orig_grndt = Convert.ToDateTime(_tr["INS_ORIG_GRNDT"]);
            _pick.Tus_orig_grnno = Convert.ToString(_tr["INS_ORIG_GRNNO"]);
            _pick.Tus_orig_supp = Convert.ToString(_tr["INS_ORIG_SUPP"]);//TODO : GET SUPPLIER
            _pick.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure
            _pick.Tus_seq_no = Convert.ToInt32(_tr["INS_SEQ_NO"]);
            _pick.Tus_ser_1 = Convert.ToString(_tr["INS_SER_1"]);
            _pick.Tus_ser_2 = Convert.ToString(_tr["INS_SER_2"]);
            _pick.Tus_ser_3 = Convert.ToString(_tr["INS_SER_3"]);
            _pick.Tus_ser_4 = Convert.ToString(_tr["INS_SER_4"]);
            _pick.Tus_ser_id = Convert.ToInt32(_tr["INS_SER_ID"]);
            _pick.Tus_ser_line = Convert.ToInt32(_tr["INS_SER_LINE"]);
            // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
            _pick.Tus_unit_cost = Convert.ToDecimal(_tr["INS_UNIT_COST"]);
            _pick.Tus_unit_price = Convert.ToDecimal(_tr["INS_UNIT_PRICE"]);
            //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
            _pick.Tus_warr_no = Convert.ToString(_tr["INS_WARR_NO"]);
            _pick.Tus_warr_period = Convert.ToInt32(_tr["INS_WARR_PERIOD"]);
            _pick.Tus_new_status = Convert.ToString(_tr["INS_AVAILABLE"]) == "-1" ? "1" : Convert.ToString(_tr["INS_AVAILABLE"]);
            if (string.IsNullOrEmpty(_tr["INS_AGELOC"].ToString()))
            { _pick.Tus_ageloc = _pick.Tus_loc; }
            else
            { _pick.Tus_ageloc = _tr["INS_AGELOC"].ToString(); }
            if (string.IsNullOrEmpty(_tr["INS_AGELOC_DT"].ToString()))
            { _pick.Tus_ageloc_dt = _pick.Tus_doc_dt; }
            else
            { _pick.Tus_ageloc_dt = Convert.ToDateTime(_tr["INS_AGELOC_DT"].ToString()).Date; }

            if (string.IsNullOrEmpty(_tr["INS_ISOWNMRN"].ToString()))
            { _pick.Tus_isownmrn = 0; }
            else
            { _pick.Tus_isownmrn = Convert.ToInt32(_tr["INS_ISOWNMRN"].ToString()); }

            //Added Prabhath on 11/08/2012
            //MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);      //comented by kapila+chamal 18/7/2016
            //if (_item != null) // Tharka 2015-09-24
            //{
            //    _pick.Tus_itm_desc = _item.Mi_longdesc;
            //    _pick.Tus_itm_model = _item.Mi_model;
            //    _pick.Tus_itm_brand = _item.Mi_brand;
            //}

            return _pick;
        }

        //hw by prabhath on 14 05 2012
        public List<ReptPickSerials> GetNonSerializedItemInTopOrder(string _company, string _location, string _bin, string _item, string _status, decimal _qty)
        {
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblSerial = new DataTable();
            _tblSerial = QueryDataTable("tblSerial", "sp_getnonserialitem_top_order", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in _tblSerial.Rows) _list.Add(SetReptPickSerials(tr));
            return _list;
        }

        public List<string> GetBinCodesforInventoryInward(string company, string location)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_bins", "sp_getbincodes_for_inv_inward", CommandType.StoredProcedure, false, param);

            List<string> bin_list = new List<string>();
            bin_list.Add("--Select--");
            foreach (DataRow r in _dtResults.Rows)
            {
                // Get the value of the wanted column and cast it to string
                string st = (string)r["IBL_BIN_CD"];
                bin_list.Add(st);
            }

            return bin_list;
        }

        public List<InventoryRequest> GetAllMaterialRequestsList(InventoryRequest _inventoryRequest)
        {
            List<InventoryRequest> _inventoryRequestList = null;
            OracleParameter[] param = new OracleParameter[8];
            //(param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            //edit by Chamal (add Itr_issue_com) 18-08-2012
            //edit by Chamal (add PDA) 28-08-2014
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[5] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[6] = new OracleParameter("p_reqby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_inventoryRequest.Itr_tp == "PDA")
            {
                _dtResults = QueryDataTable("tblReq", "sp_pdascanbatchs", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0) _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterPDA);
            }
            else
            {
                _dtResults = QueryDataTable("tblReq", "sp_getallmaterialrequests", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0) _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter);
            }
            return _inventoryRequestList;
        }


        public DataTable GetAllMaterialRequestsTable(InventoryRequest _inventoryRequest)
        {
            OracleParameter[] param = new OracleParameter[6];
            //(param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            //edit by chamal de silva (add Itr_issue_com) 18-08-2012
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_getallmaterialrequests", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public InventorySerialMaster GetSerialMasterDetailBySerialID(Int32 _serialID)
        {
            InventorySerialMaster _list = new InventorySerialMaster();

            //p_id in NVARCHAR2
            //sp_getserialreceivecompany
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_getserialreceivecompany", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialMaster>(_dtResults, InventorySerialMaster.ConvertTotal)[0];
            }
            return _list;
        }

        #region Purchase Order - By. Darshana 15-05-2012

        public List<PurchaseOrderDelivery> GetPODelItems(PurchaseOrderDelivery _paramPODelItems)
        {
            List<PurchaseOrderDelivery> _PODelItemList = null;
            PurchaseOrderDelivery _PODelItems = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _paramPODelItems.Podi_seq_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblPODelItems", "sp_getpodelitems", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _PODelItemList = new List<PurchaseOrderDelivery>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _PODelItems = new PurchaseOrderDelivery();

                    _PODelItems.Podi_seq_no = (_dtResults.Rows[i]["podi_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["podi_seq_no"]);
                    _PODelItems.Podi_line_no = (_dtResults.Rows[i]["podi_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["podi_line_no"]);
                    _PODelItems.Podi_del_line_no = (_dtResults.Rows[i]["podi_del_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["podi_del_line_no"]);
                    _PODelItems.Podi_loca = (_dtResults.Rows[i]["podi_loca"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["podi_loca"].ToString();
                    _PODelItems.Podi_itm_cd = (_dtResults.Rows[i]["podi_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["podi_itm_cd"].ToString();
                    _PODelItems.Podi_itm_stus = (_dtResults.Rows[i]["podi_itm_stus"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["podi_itm_stus"].ToString();
                    _PODelItems.Podi_qty = (_dtResults.Rows[i]["podi_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["podi_qty"]);
                    _PODelItems.Podi_bal_qty = (_dtResults.Rows[i]["podi_bal_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["podi_bal_qty"]);
                    _PODelItems.Podi_remarks = (_dtResults.Rows[i]["podi_remarks"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["podi_remarks"].ToString();
                    _PODelItemList.Add(_PODelItems);
                }
            }

            return _PODelItemList;
        }

        public DataTable GetPOAlocItems(string _po)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_po", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _po;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblPODelItems", "sp_getpoalocitems", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public List<PurchaseOrderDetail> GetPOItemsList(string _poNo)
        {
            List<PurchaseOrderDetail> _POItemList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPOItems", "sp_getpoitemslist", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    _POItemList = new List<PurchaseOrderDetail>();

                    for (int i = 0; i < _dtResults.Rows.Count; i++)
                    {
                        PurchaseOrderDetail _POItems = new PurchaseOrderDetail();

                        _POItems.Pod_seq_no = (_dtResults.Rows[i]["pod_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["pod_seq_no"]);
                        _POItems.Pod_line_no = (_dtResults.Rows[i]["pod_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["pod_line_no"]);
                        _POItems.Pod_itm_cd = (_dtResults.Rows[i]["pod_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_itm_cd"].ToString();
                        _POItems.Pod_itm_stus = (_dtResults.Rows[i]["Pod_itm_stus"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Pod_itm_stus"].ToString();
                        _POItems.Pod_itm_tp = (_dtResults.Rows[i]["pod_itm_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_itm_tp"].ToString();
                        _POItems.Pod_qty = (_dtResults.Rows[i]["pod_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_qty"]);
                        _POItems.Pod_uom = (_dtResults.Rows[i]["pod_uom"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_uom"].ToString();
                        _POItems.Pod_unit_price = (_dtResults.Rows[i]["pod_unit_price"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_unit_price"]);
                        _POItems.Pod_line_val = (_dtResults.Rows[i]["pod_line_val"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_line_val"]);
                        _POItems.Pod_dis_rt = (_dtResults.Rows[i]["pod_dis_rt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_dis_rt"]);
                        _POItems.Pod_dis_amt = (_dtResults.Rows[i]["pod_dis_amt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_dis_amt"]);
                        _POItems.Pod_line_tax = (_dtResults.Rows[i]["pod_line_tax"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_line_tax"]);
                        _POItems.Pod_line_amt = (_dtResults.Rows[i]["pod_line_amt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_line_amt"]);
                        _POItems.Pod_pi_bal = (_dtResults.Rows[i]["pod_pi_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_pi_bal"]);
                        _POItems.Pod_lc_bal = (_dtResults.Rows[i]["pod_lc_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_lc_bal"]);
                        _POItems.Pod_si_bal = (_dtResults.Rows[i]["pod_si_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_si_bal"]);
                        _POItems.Pod_grn_bal = (_dtResults.Rows[i]["pod_grn_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_grn_bal"]);
                        _POItems.Pod_ref_no = (_dtResults.Rows[i]["pod_ref_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_ref_no"].ToString();
                        _POItems.Pod_act_unit_price = (_dtResults.Rows[i]["pod_act_unit_price"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_act_unit_price"]);
                        _POItems.Pod_item_desc = (_dtResults.Rows[i]["pod_item_desc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_item_desc"].ToString();
                        _POItems.Pod_kit_line_no = (_dtResults.Rows[i]["pod_kit_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["pod_kit_line_no"]);
                        _POItems.Pod_kit_itm_cd = (_dtResults.Rows[i]["pod_kit_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_kit_itm_cd"].ToString();
                        _POItems.Pod_vat = (_dtResults.Rows[i]["pod_vat"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_vat"]);
                        _POItems.Pod_nbt = (_dtResults.Rows[i]["pod_nbt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_nbt"]);
                        _POItems.Pod_vat_before = (_dtResults.Rows[i]["pod_vat_before"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_vat_before"]);
                        _POItems.Pod_nbt_before = (_dtResults.Rows[i]["pod_nbt_before"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_nbt_before"]);
                        _POItems.Pod_tot_tax_before = (_dtResults.Rows[i]["pod_tot_tax_before"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_tot_tax_before"]);
                        _POItemList.Add(_POItems);
                    }
                }
            }

            return _POItemList;
        }

        public List<PurchaseOrderDetail> GetPOItems(PurchaseOrderDetail _paramPOItems)
        {
            List<PurchaseOrderDetail> _POItemList = null;
            PurchaseOrderDetail _POItems = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _paramPOItems.Pod_seq_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblPOItems", "sp_getpoitems", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _POItemList = new List<PurchaseOrderDetail>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _POItems = new PurchaseOrderDetail();

                    _POItems.Pod_seq_no = (_dtResults.Rows[i]["pod_seq_no"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["pod_seq_no"]);
                    _POItems.Pod_line_no = (_dtResults.Rows[i]["pod_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["pod_line_no"]);
                    _POItems.Pod_itm_cd = (_dtResults.Rows[i]["pod_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_itm_cd"].ToString();
                    _POItems.Pod_itm_stus = (_dtResults.Rows[i]["Pod_itm_stus"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Pod_itm_stus"].ToString();
                    _POItems.Pod_itm_tp = (_dtResults.Rows[i]["pod_itm_tp"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_itm_tp"].ToString();
                    _POItems.Pod_qty = (_dtResults.Rows[i]["pod_qty"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_qty"]);
                    _POItems.Pod_uom = (_dtResults.Rows[i]["pod_uom"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_uom"].ToString();
                    _POItems.Pod_unit_price = (_dtResults.Rows[i]["pod_unit_price"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_unit_price"]);
                    _POItems.Pod_line_val = (_dtResults.Rows[i]["pod_line_val"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_line_val"]);
                    _POItems.Pod_dis_rt = (_dtResults.Rows[i]["pod_dis_rt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_dis_rt"]);
                    _POItems.Pod_dis_amt = (_dtResults.Rows[i]["pod_dis_amt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_dis_amt"]);
                    _POItems.Pod_line_tax = (_dtResults.Rows[i]["pod_line_tax"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_line_tax"]);
                    _POItems.Pod_line_amt = (_dtResults.Rows[i]["pod_line_amt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_line_amt"]);
                    _POItems.Pod_pi_bal = (_dtResults.Rows[i]["pod_pi_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_pi_bal"]);
                    _POItems.Pod_lc_bal = (_dtResults.Rows[i]["pod_lc_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_lc_bal"]);
                    _POItems.Pod_si_bal = (_dtResults.Rows[i]["pod_si_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_si_bal"]);
                    _POItems.Pod_grn_bal = (_dtResults.Rows[i]["pod_grn_bal"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_grn_bal"]);
                    _POItems.Pod_ref_no = (_dtResults.Rows[i]["pod_ref_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_ref_no"].ToString();
                    _POItems.Pod_act_unit_price = (_dtResults.Rows[i]["pod_act_unit_price"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_act_unit_price"]);
                    _POItems.Pod_item_desc = (_dtResults.Rows[i]["pod_item_desc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_item_desc"].ToString();
                    _POItems.Pod_kit_line_no = (_dtResults.Rows[i]["pod_kit_line_no"] == DBNull.Value) ? 0 : Convert.ToInt16(_dtResults.Rows[i]["pod_kit_line_no"]);
                    _POItems.Pod_kit_itm_cd = (_dtResults.Rows[i]["pod_kit_itm_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_kit_itm_cd"].ToString();
                    _POItems.Pod_vat = (_dtResults.Rows[i]["pod_vat"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_vat"]);
                    _POItems.Pod_nbt = (_dtResults.Rows[i]["pod_nbt"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_nbt"]);
                    _POItems.Pod_vat_before = (_dtResults.Rows[i]["pod_vat_before"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_vat_before"]);
                    _POItems.Pod_nbt_before = (_dtResults.Rows[i]["pod_nbt_before"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_nbt_before"]);
                    _POItems.Pod_tot_tax_before = (_dtResults.Rows[i]["pod_tot_tax_before"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["pod_tot_tax_before"]);
                    _POItems.Pod_warr_per = (_dtResults.Rows[i]["pod_warr_per"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_warr_per"].ToString();
                    _POItems.Pod_warr_rmk = (_dtResults.Rows[i]["pod_warr_rmk"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["pod_warr_rmk"].ToString();
                    _POItemList.Add(_POItems);
                }
            }

            return _POItemList;
        }

        public PurchaseOrder GetPOHeader(string _com, string _PONo, string _type)
        {
            PurchaseOrder _POList = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblPOHeader", "sp_getpoheader", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _POList = DataTableExtensions.ToGenericList<PurchaseOrder>(_dtResults, PurchaseOrder.ConvertTotal)[0];
            }
            return _POList;
        }

        public List<MasterItemTax> GetItemTax(string _company, string _item, string _status, string _taxCode, string _taxRateCode)
        {
            //sp_getitemtax   (p_com in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2 , p_taxcode in NVARCHAR2,p_taxratecode in NVARCHAR2, c_data  OUT sys_refcursor)
            List<MasterItemTax> _list = new List<MasterItemTax>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_taxcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxCode;
            (param[4] = new OracleParameter("p_taxratecode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _taxRateCode;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getitemtax", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemTax>(_tblData, MasterItemTax.ConvertTotal);
            }

            return _list;
        }

        public bool IsValidSupplier(string _company, string _supplier, Int16 _active, string _type)
        {
            OracleParameter[] param = new OracleParameter[5];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _active;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblvalidsupplier = QueryDataTable("tblvalidsupplier", "sp_checkvalidsupplier", CommandType.StoredProcedure, false, param);
            if (_tblvalidsupplier.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }

        public bool IsValidItemStatus(String _ItmStatus)
        {
            OracleParameter[] param = new OracleParameter[2];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItmStatus;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblvalidsupplier = QueryDataTable("tblvaliditmstatus", "sp_CheckValiditmstatus", CommandType.StoredProcedure, false, param);
            if (_tblvalidsupplier.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }

        public bool IsValidCompanyItem(string _company, string _item, Int16 _active)
        {
            OracleParameter[] param = new OracleParameter[4];
            bool _isValid = false;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _active;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblcompanyitem = QueryDataTable("tblvalidcompanyitem", "sp_checkvalidcompanyitem", CommandType.StoredProcedure, false, param);
            if (_tblcompanyitem.Rows.Count <= 0)
                _isValid = false;
            else _isValid = true;
            return _isValid;
        }

        //Darshana - 06/06/2012
        public List<QoutationDetails> GetSupplierQuotation(string _com, string _sup, string _type, string _subtype, DateTime _date, decimal _qty, string _status, string _item)
        {
            List<QoutationDetails> _list = new List<QoutationDetails>();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sup;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tblsupplierquotation", "sp_get_supplier_quotation", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<QoutationDetails>(_tblData, QoutationDetails.convertforquotation);
            }
            return _list;

            ////Query Data base.
            //DataTable _dtResults = QueryDataTable("tblsupplierquotation", "sp_get_supplier_quotation", CommandType.StoredProcedure, false, param);

            //if (_dtResults.Rows.Count > 0)
            //{
            //    _QuotationDetailList = new List<QoutationDetails>();

            //    for (int i = 0; i < _dtResults.Rows.Count; i++)
            //    {
            //        _QuotationDetail = new QoutationDetails();
            //        _QuotationDetail.Qd_frm_qty = (_dtResults.Rows[i]["Qd_frm_qty"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Qd_frm_qty"]);
            //        _QuotationDetail.Qd_to_qty = (_dtResults.Rows[i]["Qd_to_qty"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Qd_to_qty"]);
            //        _QuotationDetail.Qd_unit_price = (_dtResults.Rows[i]["Qd_unit_price"] == DBNull.Value) ? 0 : Convert.ToInt32(_dtResults.Rows[i]["Qd_unit_price"]);

            //        _QuotationDetailList.Add(_QuotationDetail);
            //    }

            //}

            //return _QuotationDetailList;
        }

        public Int32 DeletePODel(Int32 _SeqNo)
        {
            //delete all quataion lines from the QUO_DET table which are belong to this quotation No.
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SeqNo;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_delete_pur_del", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 DeletePODet(Int32 _SeqNo)
        {
            //delete all quataion lines from the QUO_DET table which are belong to this quotation No.
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SeqNo;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_delete_pur_det", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 SaveNewPODel(PurchaseOrderDelivery _NewPODel)
        {
            Int16 rows_affected = 0;
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_podi_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPODel.Podi_seq_no;
            (param[1] = new OracleParameter("p_podi_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NewPODel.Podi_line_no;
            (param[2] = new OracleParameter("p_podi_del_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NewPODel.Podi_del_line_no;
            (param[3] = new OracleParameter("p_podi_loca", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPODel.Podi_loca;
            (param[4] = new OracleParameter("p_podi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPODel.Podi_itm_cd;
            (param[5] = new OracleParameter("p_podi_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPODel.Podi_itm_stus;
            (param[6] = new OracleParameter("p_podi_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPODel.Podi_qty;
            (param[7] = new OracleParameter("p_podi_bal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPODel.Podi_bal_qty;
            (param[8] = new OracleParameter("p_podi_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPODel.Podi_remarks;
            (param[9] = new OracleParameter("p_podi_ex_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _NewPODel.Podi_ex_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = (Int16)this.UpdateRecords("sp_savepodel", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //kapila
        public Int16 SaveNewPOAloc(PurchaseOrderAlloc _NewPOAloc)
        {
            Int16 rows_affected = 0;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_poal_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_seq_no;
            (param[1] = new OracleParameter("p_poal_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_line_no;
            (param[2] = new OracleParameter("p_poal_del_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_del_line_no;
            (param[3] = new OracleParameter("p_poal_loca", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_loca;
            (param[4] = new OracleParameter("p_poal_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_itm_cd;
            (param[5] = new OracleParameter("p_poal_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_itm_stus;
            (param[6] = new OracleParameter("p_poal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_qty;
            (param[7] = new OracleParameter("p_poal_bal_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_bal_qty;
            (param[8] = new OracleParameter("p_poal_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOAloc.poal_remarks;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = (Int16)this.UpdateRecords("sp_savepoaloc", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        public Int16 SaveNewPOItem(PurchaseOrderDetail _NewPOItem)
        {
            Int16 rows_affected = 0;
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("p_pod_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_seq_no;
            (param[1] = new OracleParameter("p_pod_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_line_no;
            (param[2] = new OracleParameter("p_pod_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_itm_cd;
            (param[3] = new OracleParameter("p_pod_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_itm_stus;
            (param[4] = new OracleParameter("p_pod_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_itm_tp;
            (param[5] = new OracleParameter("p_pod_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_qty;
            (param[6] = new OracleParameter("p_pod_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_uom;
            (param[7] = new OracleParameter("p_pod_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_unit_price;
            (param[8] = new OracleParameter("p_pod_line_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_line_val;
            (param[9] = new OracleParameter("p_pod_dis_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_dis_rt;
            (param[10] = new OracleParameter("p_pod_dis_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_dis_amt;
            (param[11] = new OracleParameter("p_pod_line_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_line_tax;
            (param[12] = new OracleParameter("p_pod_line_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_line_amt;
            (param[13] = new OracleParameter("p_pod_pi_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_pi_bal;
            (param[14] = new OracleParameter("p_pod_lc_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_lc_bal;
            (param[15] = new OracleParameter("p_pod_si_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_si_bal;
            (param[16] = new OracleParameter("p_pod_grn_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_grn_bal;
            (param[17] = new OracleParameter("p_pod_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_ref_no;
            (param[18] = new OracleParameter("p_pod_act_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_act_unit_price;
            (param[19] = new OracleParameter("p_pod_item_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_item_desc;
            (param[20] = new OracleParameter("p_pod_kit_line_no", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_kit_line_no;
            (param[21] = new OracleParameter("p_pod_kit_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_kit_itm_cd;
            (param[22] = new OracleParameter("p_pod_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_vat;
            (param[23] = new OracleParameter("p_pod_nbt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_nbt;
            (param[24] = new OracleParameter("p_pod_vat_before", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_vat_before;
            (param[25] = new OracleParameter("p_pod_nbt_before", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_nbt_before;
            (param[26] = new OracleParameter("p_pod_tot_tax_before", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_tot_tax_before;
            (param[27] = new OracleParameter("P_POD_QT_SUP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_qt_supp;
            (param[28] = new OracleParameter("P_POD_QT_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_qt_price;
            (param[29] = new OracleParameter("P_pod_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_req_no;
            (param[30] = new OracleParameter("P_pod_warr_per", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_warr_per;
            (param[31] = new OracleParameter("P_pod_warr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPOItem.Pod_warr_rmk;
            param[32] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = (Int16)this.UpdateRecords("sp_savepoitems", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        public Int16 SaveNewPO(PurchaseOrder _NewPO)
        {
            Int16 rows_affected = 0;
            OracleParameter[] param = new OracleParameter[40];
            (param[0] = new OracleParameter("p_poh_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_seq_no;
            (param[1] = new OracleParameter("p_poh_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_tp;
            (param[2] = new OracleParameter("p_poh_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_sub_tp;
            (param[3] = new OracleParameter("p_poh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_doc_no;
            (param[4] = new OracleParameter("p_poh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_com;
            (param[5] = new OracleParameter("p_poh_ope", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_ope;
            (param[6] = new OracleParameter("p_poh_profit_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_profit_cd;
            (param[7] = new OracleParameter("p_poh_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _NewPO.Poh_dt;
            (param[8] = new OracleParameter("p_poh_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_ref;
            (param[9] = new OracleParameter("p_poh_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_job_no;
            (param[10] = new OracleParameter("p_poh_pay_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_pay_term;
            (param[11] = new OracleParameter("p_poh_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_supp;
            (param[12] = new OracleParameter("p_poh_cur_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_cur_cd;
            (param[13] = new OracleParameter("p_poh_ex_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_ex_rt;
            (param[14] = new OracleParameter("p_poh_trans_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_trans_term;
            (param[15] = new OracleParameter("p_poh_port_of_orig", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_port_of_orig;
            (param[16] = new OracleParameter("p_poh_cre_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_cre_period;
            (param[17] = new OracleParameter("p_poh_frm_yer", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_frm_yer;
            (param[18] = new OracleParameter("p_poh_frm_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_frm_mon;
            (param[19] = new OracleParameter("p_poh_to_yer", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_to_yer;
            (param[20] = new OracleParameter("p_poh_to_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_to_mon;
            (param[21] = new OracleParameter("p_poh_preferd_eta", OracleDbType.Date, null, ParameterDirection.Input)).Value = _NewPO.Poh_preferd_eta;
            (param[22] = new OracleParameter("p_poh_contain_kit", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_contain_kit;
            (param[23] = new OracleParameter("p_poh_sent_to_vendor", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_sent_to_vendor;
            (param[24] = new OracleParameter("p_poh_sent_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_sent_by;
            (param[25] = new OracleParameter("p_poh_sent_via", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_sent_via;
            (param[26] = new OracleParameter("p_poh_sent_add", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_sent_add;
            (param[27] = new OracleParameter("p_poh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_stus;
            (param[28] = new OracleParameter("p_poh_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_remarks;
            (param[29] = new OracleParameter("p_poh_sub_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_sub_tot;
            (param[30] = new OracleParameter("p_poh_tax_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_tax_tot;
            (param[31] = new OracleParameter("p_poh_dis_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_dis_rt;
            (param[32] = new OracleParameter("p_poh_dis_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_dis_amt;
            (param[33] = new OracleParameter("p_poh_oth_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_oth_tot;
            (param[34] = new OracleParameter("p_poh_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _NewPO.Poh_tot;
            (param[35] = new OracleParameter("p_poh_reprint", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_reprint;
            (param[36] = new OracleParameter("p_poh_tax_chg", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.Poh_tax_chg;
            (param[37] = new OracleParameter("p_poh_is_conspo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _NewPO.poh_is_conspo;
            (param[38] = new OracleParameter("p_poh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NewPO.Poh_cre_by;
            param[39] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = (Int16)this.UpdateRecords("sp_savepoheader", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        public Int16 UpdatePOStatus(string _pono, string _status, string _com, Int32 _seqno)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_po_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pono;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_updatepo_HDR_status", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdatePOStatusNew(string _pono, string _status, string _com, Int32 _seqno, string _modBy)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_po_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pono;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modBy;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_updatepo_HDR_status", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdatePODocNo(Int32 _seqno, string _docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_pono", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateGRNPODocNo(Int32 _seqno, string _poNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqno;
            (param[1] = new OracleParameter("p_po_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_grnpono", CommandType.StoredProcedure, param);
            return effects;
        }

        #region InventoryInwardEntry

        //Chamal 27/05/2012
        public String GetDefaultBinCode(String _com, String _loc)
        {
            String _defBin = "";
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldefbin", "sp_getdefbin", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    _defBin = (string)tr["ibl_bin_cd"];
                }
            }

            return _defBin;
        }

        //Chamal 06/05/2013
        public string GetGITCorrectLocation(string _com)
        {
            String _loc = "";
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldefbin", "sp_getgitcorrectloc", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    _loc = (string)tr["RAC_LOC"];
                }
            }
            return _loc;
        }

        //Chamal 24/05/2012
        public DataTable GetAllPendingInventoryOutwardsTable(InventoryHeader _inventoryRequest)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_doc_tp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_getallpendingoutwards", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow dr in _dtResults.Rows)
                {
                    if (dr["ITH_SUB_TP"].ToString() == "SERVICE")
                        dr.Delete();//Chamal 17-04-2015 Remove RCC AODs
                }
            }
            return _dtResults;
        }

        //Chamal 18/07/2012 (Load SCM and POS pending Outwards documents)
        public DataTable GetAllPendingInventoryOutwardsSCMTable(InventoryHeader _inventoryRequest)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_doc_tp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_getallpendingoutwardsscm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<ReptPickSerials> GetOutwardItem(string _reqNo)
        {
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getinventoryrequestitemdata", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    ReptPickSerials _pick = new ReptPickSerials();

                    _pick.Tus_itm_cd = (string)tr["itri_itm_cd"];
                    _pick.Tus_itm_desc = (string)tr["mi_longdesc"];
                    _pick.Tus_itm_model = (string)tr["mi_model"];
                    _pick.Tus_itm_stus = (string)tr["itri_itm_stus"];
                    _pick.Tus_qty = Convert.ToDecimal(tr["itri_app_qty"]);
                    _pick.Tus_base_doc_no = _reqNo;
                    _pick.Tus_base_itm_line = (Int32)tr["itri_line_no"];
                    _list.Add(_pick);
                }
            }

            return _list;
        }

        public List<ReptPickSerials> GetOutwarditems1(string _reqNo)
        {
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblIntSer", "sp_getintserbydocno", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    ReptPickSerials _pick = new ReptPickSerials();
                    //ITS_SEQ_NO
                    //ITS_ITM_LINE//
                    //ITS_BATCH_LINE//
                    //ITS_SER_LINE
                    //ITS_DIRECT
                    //ITS_DOC_NO//
                    //ITS_DOC_DT
                    //ITS_COM
                    //ITS_LOC
                    //ITS_BIN//
                    //ITS_ITM_CD
                    //ITS_ITM_STUS
                    //ITS_UNIT_COST
                    //ITS_SER_ID
                    //ITS_SER_1
                    //ITS_SER_2
                    //ITS_SER_3
                    //ITS_SER_4
                    //ITS_WARR_NO
                    //ITS_WARR_PERIOD
                    //ITS_ORIG_GRNCOM
                    //ITS_ORIG_GRNNO
                    //ITS_ORIG_GRNDT
                    //ITS_ORIG_SUPP
                    //ITS_EXIST_GRNCOM
                    //ITS_EXIST_GRNNO
                    //ITS_EXIST_GRNDT
                    //ITS_EXIST_SUPP
                    //ITS_CROSS_SEQNO
                    //ITS_CROSS_ITMLINE
                    //ITS_CROSS_BATCHLINE
                    //ITS_CROSS_SERLINE
                    //ITS_ISSUE_DT
                    //ITS_PICK

                    _pick.Tus_base_doc_no = (string)tr["ITS_DOC_NO"];
                    _pick.Tus_base_itm_line = (Int16)tr["ITS_ITM_LINE"];
                    _pick.Tus_batch_line = (Int16)tr["ITS_BATCH_LINE"];
                    _pick.Tus_bin = (string)tr["ITS_BIN"];
                    //_pick.Tus_com =(string)

                    _pick.Tus_itm_cd = (string)tr["itri_itm_cd"];
                    _pick.Tus_itm_desc = (string)tr["mi_longdesc"];
                    _pick.Tus_itm_model = (string)tr["mi_model"];
                    _pick.Tus_itm_stus = (string)tr["itri_itm_stus"];
                    _pick.Tus_qty = Convert.ToDecimal(tr["itri_app_qty"]);
                    _pick.Tus_base_doc_no = _reqNo;
                    _pick.Tus_base_itm_line = (Int32)tr["itri_line_no"];
                    _list.Add(_pick);
                }
            }

            return _list;
        }

        //Chamal 28/05/2012
        public DataTable GetIntSerDetails(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntSer", "sp_getintserbydocno", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 18/07/2012 (Get SCM/POS Outward details)
        public DataTable GetScmSerDetails(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntSer", "sp_getscmserbydocno", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 28/05/2012
        public DataTable GetIntBatchDetailsDecimal(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntBatch", "sp_getintbatchdecimalitmbydocn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 18/07/2012
        public DataTable GetScmBatchDetailsDecimal(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntBatch", "sp_getscmbatchdecimalitmbydocn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #endregion
        #endregion

        //kapila 12/6/2012
        public InventorySerialRefN GetAvailableWarranty(string _comp, string _Loc, string _Item, string _Serial)
        {
            InventorySerialRefN _AvailableList = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtItemStatus = QueryDataTable("tblWarranty", "sp_get_available_warr", CommandType.StoredProcedure, false, param);

            if (_dtItemStatus.Rows.Count > 0)
            {
                _AvailableList = DataTableExtensions.ToGenericList<InventorySerialRefN>(_dtItemStatus, InventorySerialRefN.Converter)[0];
            }
            return _AvailableList;
        }

        //kapila 13/6/2012
        public DataTable GetIssuedWarranty(Int32 _seq, Int32 _itmLine, Int32 _batchLine, Int32 _serLine)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_its_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_its_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmLine;
            (param[2] = new OracleParameter("p_its_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batchLine;
            (param[3] = new OracleParameter("p_its_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serLine;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblWarranty", "sp_get_iss_warr", CommandType.StoredProcedure, false, param);

            return _dtResult;
        }

        //kapila 14/6/2012
        public DataTable GetIssuedWarrantyOth(string _comp, string _Loc, string _Item, string _Serial)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResult = QueryDataTable("tblWarranty", "sp_get_iss_warr_oth", CommandType.StoredProcedure, false, param);

            return _dtResult;
        }

        //created by shani 14-06-2012
        public string Get_default_binCD(string company, string location)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query inr_bin_loc.
            DataTable _dtResults = QueryDataTable("tblBin_loc", "sp_getdefbin", CommandType.StoredProcedure, false, param);
            string binCD = null;
            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    binCD = Convert.ToString(tr["ibl_bin_cd"]);
                }
            }

            return binCD;
        }

        //kapila 22/6/2012
        public Boolean IsRccSerialFound(string _Item, string _Serial)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (_para[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean IsRccSerialFound = QueryDataTable("tbl", "sp_check_serial_rcc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return IsRccSerialFound;
        }

        public List<InventoryBatchN> GetDeliveryOrderDetail(string _company, string _invoice, int _line)
        {
            // sp_getdofrominvoice( p_com in NVARCHAR2,  p_invoice in NVARCHAR2,p_line in NUMBER,c_data out sys_refcursor)
            List<InventoryBatchN> _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getdofrominvoice", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryBatchN>(_tblData, InventoryBatchN.Converter);
            }
            return _list;
        }

        public DataTable GetDODetByInvItem(string _company, string _invoice, string _item)
        {
            // sp_getdofrominvoice( p_com in NVARCHAR2,  p_invoice in NVARCHAR2,p_line in NUMBER,c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getdofrominvitem", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public DataTable GetDeliveryOrderDetailDt(string _company, string _invoice, int _line)
        {
            // Nadeeka 01-01-13

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_getdofrominvoice", CommandType.StoredProcedure, false, param);

            return _tblData;
        }

        public BusinessObjects.MasterItem GetItemByModel(string _model)
        {
            MasterItem _itemList = null;
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _itemTable = QueryDataTable("tblItem", "sp_get_item_by_model", CommandType.StoredProcedure, false, _para);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal)[0];
            }
            return _itemList;
        }

        /// <summary>
        /// added by DULANGA 2016-1-23
        /// </summary>
        /// <param name="_model"></param>
        /// <returns></returns>
        public List<BusinessObjects.MasterItem> GetAllItemByModel(string _model)
        {
            List<MasterItem> _itemList = null;
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _itemTable = QueryDataTable("tblItem", "sp_get_item_by_model", CommandType.StoredProcedure, false, _para);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal);
            }
            return _itemList;
        }



        //Chamal 30-04-2014
        public DataTable GetItemCostSerialSCM(string _doNo, string _item, string _itemstatus, string _serial, int _isSer)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_do", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[4] = new OracleParameter("p_is_ser", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSer;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_getunitcostserscm", CommandType.StoredProcedure, false, param);
        }

        public List<ReptPickSerials> GetInvoiceSerial(string _company, string _location, string _user, string _session, string _defBin, string _invoice, int _baseRefline)
        {
            //sp_getdoserialdetail(p_com in NVARCHAR2, p_invoiceno in NVARCHAR2,p_base_refline in NUMBER, c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _baseRefline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetail", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = Convert.ToDateTime(_row["ITS_DOC_DT"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_doc_dt = Convert.ToDateTime(_row["ITS_DOC_DT"]);
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }

        public List<InventoryRequestItem> GetMaterialRequestItemByRequestNoList(string _reqNo)
        {
            List<InventoryRequestItem> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblItem", "sp_getinventoryrequestitemdata", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterForCommonOut_3);
            }
            else
            {
                param = new OracleParameter[2];
                _dtResults = new DataTable();
                (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _dtResults = QueryDataTable("tblItem", "sp_getpdascanitems", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterForCommonOut);
                }
            }

            return _list;
        }

        public DataTable GetMaterialRequestItemByRequestNoTable(string _reqNo)
        {
            List<InventoryRequest> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getinventoryrequestitemdata", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public HpRevertHeader GetRevertHeaderfromAccountnoForRelease(string _company, string _profitcenter, string _accountno, Int16 _revertstatus)
        {
            HpRevertHeader _header = null;
            //PROCEDURE sp_getrvnofromaccountforrelese(p_com in NVARCHAR2,p_profit in NVARCHAR2,p_account in NVARCHAR2,p_revertstatus in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[3] = new OracleParameter("p_revertstatus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _revertstatus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getrvnofromaccountforrelese", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                _header = DataTableExtensions.ToGenericList<HpRevertHeader>(_dtResults, HpRevertHeader.Converter)[0];

            return _header;
        }

        public List<ReptPickSerials> GetAdjustmentDetailFromRevertNo(string _company, string _accountno, string _revertno)
        {
            //PROCEDURE sp_getadjustmentfromrevertno (p_com in NVARCHAR2,p_account in NVARCHAR2,p_revertno in NVARCHAR2,c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[2] = new OracleParameter("p_revertno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getadjustmentfromrevertno", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    ReptPickSerials _serial = SetReptPickSerials(tr);
                    _list.Add(_serial);
                }
            }
            return _list;
        }

        //kapila 24/8/2012
        public DataTable GetRCCSerialSearchData(string _com, string _loc, int _isSameLoc, int _isStockItem, string _searchText, string _searchCriteria)
        {
            DataTable _dtResults = null;
            string _warranty = null;
            string _item = null;
            string _serial = null;
            string _docNo = null;

            if (!string.IsNullOrEmpty(_searchCriteria))
            {
                switch (_searchCriteria)
                {
                    case "WARRANTY":
                        _warranty = _searchText;
                        break;

                    case "ITEM":
                        _item = _searchText;
                        break;

                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    case "DOCUMENT":
                        _docNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _warranty = (_warranty != null) ? (_warranty + "%") : null;
            _item = (_item != null) ? (_item.ToUpper() + "%") : null;
            _serial = (_serial != null) ? (_serial + "%") : null;
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[4] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_is_same_loc", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isSameLoc;
            (param[7] = new OracleParameter("p_is_stock_item", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isStockItem;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_rcc_srch_serial", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sachith
        public DataTable GetLocationByType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[5];

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _locationCode = null;
            string _locationDesc = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _locationCode = _searchText;
                        break;

                    case "DESCRIPTION":
                        _locationDesc = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _locationCode = (_locationCode != null) ? (_locationCode.ToUpper() + "%") : "%";
            _locationDesc = (_locationDesc != null) ? (_locationDesc.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "WH";
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (param[3] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationDesc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_getlocbytype", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInventorySerialbyId(string _serId, string _loc)
        {//Nadeeka 10-01-2013
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serId;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_serialbyId", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Written By Prabhath on 01/09/2012
        public List<InventorySerialN> GetDeliveredSerialDetail(string _company, string _invoiceno)
        {
            //sp_getdeliveredserialdetail(p_com in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            List<InventorySerialN> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getdeliveredserialdetail", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterTotalNEW1);

            return _list;
        }

        #region FixAsset Or Adhoc Request And Approve

        public Int32 Save_Adhocheader(InventoryAdhocHeader adhocheader)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adhocheader.Iadh_seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_loc;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_pc;
            (param[4] = new OracleParameter("p_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_ref_no;
            (param[5] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adhocheader.Iadh_tp;
            (param[6] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adhocheader.Iadh_dt;
            (param[7] = new OracleParameter("p_req_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_req_by;
            (param[8] = new OracleParameter("p_req_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adhocheader.Iadh_req_dt;
            (param[9] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adhocheader.Iadh_stus;
            (param[10] = new OracleParameter("p_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_app_by;
            (param[11] = new OracleParameter("p_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adhocheader.Iadh_app_dt;
            (param[12] = new OracleParameter("p_coll_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_coll_by;
            (param[13] = new OracleParameter("p_coll_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = adhocheader.Iadh_coll_dt;
            (param[14] = new OracleParameter("p_adj_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_adj_no;
            (param[15] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_anal1;
            (param[16] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_anal2;
            (param[17] = new OracleParameter("p_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_anal3;
            (param[18] = new OracleParameter("p_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_anal4;
            (param[19] = new OracleParameter("p_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocheader.Iadh_anal5;

            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //returns the generated sequence
            effects = (Int32)UpdateRecords("sp_save_adhocHdr", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Save_AdhocDetail(InventoryAdhocDetail adhocDet)
        {
            OracleParameter[] param = new OracleParameter[25];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adhocDet.Iadd_seq;
            (param[1] = new OracleParameter("p_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_ref_no;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adhocDet.Iadd_line;
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adhocDet.Iadd_stus;
            (param[4] = new OracleParameter("p_claim_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_claim_itm;
            (param[5] = new OracleParameter("p_claim_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_claim_pb;
            (param[6] = new OracleParameter("p_claim_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_claim_pb_lvl;
            (param[7] = new OracleParameter("p_claim_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adhocDet.Iadd_claim_val;
            (param[8] = new OracleParameter("p_app_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_app_itm;
            (param[9] = new OracleParameter("p_app_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_app_pb;
            (param[10] = new OracleParameter("p_app_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_app_pb_lvl;
            (param[11] = new OracleParameter("p_app_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adhocDet.Iadd_app_val;
            (param[12] = new OracleParameter("p_coll_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_itm;
            (param[13] = new OracleParameter("p_coll_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_pb;
            (param[14] = new OracleParameter("p_coll_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_pb_lvl;
            (param[15] = new OracleParameter("p_coll_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_val;
            (param[16] = new OracleParameter("p_coll_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_ser1;
            (param[17] = new OracleParameter("p_coll_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_ser2;
            (param[18] = new OracleParameter("p_coll_ser3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_coll_ser3;
            (param[19] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_anal1;
            (param[20] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_anal2;
            (param[21] = new OracleParameter("p_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_anal3;
            (param[22] = new OracleParameter("p_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_anal4;
            (param[23] = new OracleParameter("p_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adhocDet.Iadd_anal5;

            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_saveadhocDet", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetAdhochdrTable(string _ref)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_adhoc_hdr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetAdhocdetTable(string _ref)
        {   // Nadeeka 09-01-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_adhoc_det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<ReptPickSerials> GET_ser_FOR_STATUS(string company, string location, string itemCode, string ItmStatus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_itemStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItmStatus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_ser_from_INR_SER", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            if (dt != null && dt.Rows.Count > 0)
            {
                foreach (DataRow tr in dt.Rows)
                {
                    serial_list.Add(SetReptPickSerials(tr));
                }
            }
            return serial_list;
        }

        public List<InventoryAdhocDetail> GET_adhocDET_byRefNo(string company, string location, Int32 type_, string RefNo, Int32 status, out InventoryAdhocHeader adhocHDR)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = RefNo;
            (param[3] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type_;
            (param[4] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            //query
            dt = QueryDataTable("tbl_serials", "sp_get_adhocDET_byRefNo", CommandType.StoredProcedure, false, param);

            List<InventoryAdhocDetail> _list = null;
            InventoryAdhocHeader _header = null;
            if (dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryAdhocDetail>(dt, InventoryAdhocDetail.Converter);

                _header = DataTableExtensions.ToGenericList<InventoryAdhocHeader>(dt, InventoryAdhocHeader.Converter)[0];
            }

            adhocHDR = _header;
            return _list;
        }

        public Int32 Get_last_AdhocDet_LineNo(Int32 Seq, string refNo)
        {
            //p_seqNo in NUMBER,p_refNo in NVARCHAR2,c_max OUT NUMBER

            OracleParameter[] param = new OracleParameter[2];
            Int32 MaxLine = 0;
            (param[0] = new OracleParameter("p_seqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refNo;
            OracleParameter _outParam = new OracleParameter("c_max", OracleDbType.Int32, null, ParameterDirection.Output);

            MaxLine = Convert.ToInt32(ReturnSP_SingleValue("sp_Get_last_AdhocDet_LineNo", CommandType.StoredProcedure, _outParam, param));
            return MaxLine;
        }

        public int Update_Adhoc_Header(Int32 seqNo, Int32 status, string approvedBy, DateTime approvedDate, string collectedBy, DateTime collectedDate, string adj_no)
        {
            int rows_affected = 0;

            //  p_seqNo in NUMBER,p_status in NUMBER,p_apprBy in NVARCHAR2,p_apprDate in DATE,
            //p_coll_by in NVARCHAR2, p_coll_dt in DATE,iadh_adj_no in NVARCHAR2 ,o_effect out NUMBER
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_seqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNo;
            (param[1] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[2] = new OracleParameter("p_apprBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = approvedBy;
            (param[3] = new OracleParameter("p_apprDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = approvedDate;
            (param[4] = new OracleParameter("p_coll_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = collectedBy;
            (param[5] = new OracleParameter("p_coll_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = collectedDate;
            (param[6] = new OracleParameter("p_adj_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adj_no;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            rows_affected = UpdateRecords("sp_Update_Adhoc_HDR", CommandType.StoredProcedure, param);

            return rows_affected;
        }

        #endregion FixAsset Or Adhoc Request And Approve

        public MasterItemBlock GetBlockedItem(string _company, string _profit, string _item)
        {
            //sp_getblockeditem(p_com in NVARCHAR2 ,p_profitcenter in NVARCHAR2,p_item in NVARCHAR2,c_data out sys_refcursor)

            MasterItemBlock _list = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getblockeditem", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<MasterItemBlock>(_dtResults, MasterItemBlock.Converter)[0];

            return _list;
        }

        //Written By darshana on 12/09/2012
        public InventorySerialN GetDeliveredSerialForItem(string _company, string _invoiceno, string _item, string _serial)
        {
            //sp_getdeliveredserialdetail(p_com in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            InventorySerialN _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getdelserialforitem", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterTotal)[0];

            return _list;
        }

        public Int32 CheckAvailableSerial(string _company, string _location, string _item, string _description, string _brand, string _model, string _serial, string _warranty)
        {
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[7] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_avlbleserial4invoice", CommandType.StoredProcedure, false, param);

            return _dtResults.Rows.Count;
        }

        public DataTable GetAvailableSerialShortDetail(string _company, string _location, string _item, string _description, string _brand, string _model, string _serial, string _warranty)
        {
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[7] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_avlbleserial4invoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetMRNItem(string _company, string _loc, string _itm)
        {
            //sp_getdeliveredserialdetail(p_com in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            DataTable _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _list = QueryDataTable("tbl", "sp_mrnlocitem", CommandType.StoredProcedure, false, param);

            return _list;
        }

        public List<ReptPickSerials> GetNonSerializedItemRandomly(string _company, string _location, string _item, string _status, decimal _qty)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "sp_getnonserialdetail", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(SetReptPickSerials(tr));
            }
            return _reptPickSerials;
        }

        public MasterItemWarrantyPeriod GetItemWarrantyDetail(string _item, string _status)
        {
            //sp_getitemwarrantyperiod(p_item in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            MasterItemWarrantyPeriod _list = new MasterItemWarrantyPeriod();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getitemwarrantyperiod", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<MasterItemWarrantyPeriod>(_dtResults, MasterItemWarrantyPeriod.Converter)[0];

            return _list;
        }

        public DataTable GetCompeleteItemfromAssambleItem(string _item)
        {
            //PROCEDURE sp_getComItemfromComponent(p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getComItemfromComponent", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetItemfromAssambleItem(string _item)
        {
            // Nadeeka 10-11-2015
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getComComponent", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public Int32 UpdateRequestItem(string _requestno, string _item, decimal _qty)
        {
            // sp_updaterequestqty(p_reqno in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterequestqty", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateRequestItem2(string _requestno, decimal _qty, Int32 _lineno)
        {
            // sp_updaterequestqty(p_reqno in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[10];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[8] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_req_itm_sts", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdateRequestItem2(string _requestno, string _item, decimal _qty, Int32 _lineno)
        {
            // sp_updaterequestqty(p_reqno in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[3] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterequestqty2", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable GetModuleStatus(string _module)
        {
            DataTable _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _list = QueryDataTable("tbl", "sp_getmodulestatus", CommandType.StoredProcedure, false, param);
            return _list;
        }

        public DataTable GetDINList(string _type, string _com, string _loc)
        {
            DataTable _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _list = QueryDataTable("tbl", "sp_getdin", CommandType.StoredProcedure, false, param);
            return _list;
        }

        public DataTable GetItemByAll(string _brand, string _cat1, string _cat2, string _cat3)
        {
            DataTable _list = null;
            OracleParameter[] param = new OracleParameter[5];

            _brand = (!string.IsNullOrEmpty(_brand)) ? (_brand.ToUpper()) : "%";
            _cat1 = (!string.IsNullOrEmpty(_cat1)) ? (_cat1.ToUpper()) : "%";
            _cat2 = (!string.IsNullOrEmpty(_cat2)) ? (_cat2.ToUpper()) : "%";
            _cat3 = (!string.IsNullOrEmpty(_cat3)) ? (_cat3.ToUpper()) : "%";

            (param[0] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[1] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[2] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[3] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _list = QueryDataTable("tbl", "get_itm_details", CommandType.StoredProcedure, false, param);
            return _list;
        }

        public DataTable GetSerialByItem(string _brand, string _cat1, string _cat2, string _cat3, string _itm)
        {
            DataTable _list = null;
            OracleParameter[] param = new OracleParameter[6];

            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : "%";
            _cat1 = (_cat1 != null) ? (_cat1.ToUpper() + "%") : "%";
            _cat2 = (_cat2 != null) ? (_cat2.ToUpper() + "%") : "%";
            _cat3 = (_cat3 != null) ? (_cat3.ToUpper() + "%") : "%";
            _itm = (_itm != null) ? (_itm.ToUpper() + "%") : "%";

            (param[0] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[1] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[2] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[3] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _list = QueryDataTable("tbl", "sp_get_serial_byitem", CommandType.StoredProcedure, false, param);
            return _list;
        }

        public DataTable GetItemBalanceAvg(string _company, string _category, string _item, string _status)
        {
            // sp_getavgcostforbalance(p_com in NVARCHAR2,p_catcode in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getavgcostforbalance", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public MasterCompany GetCompanyByCode(string _CompCode)
        {
            MasterCompany _userList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblcomp", "SP_GET_COMP_BY_CODE", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<MasterCompany>(_dtResults, MasterCompany.Converter)[0];
            }
            return _userList;
        }

        public Int32 UpdateAvgCost(string _company, string _location, string _category, string _item, string _status, string _user, decimal _avgcost)
        {
            Int32 _effect = 0;
            //sp_updateavgcost(p_com in NVARCHAR2,p_location in NVARCHAR2,p_catcode in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2,p_avgcost in NUMBER,p_user in NVARCHAR2,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _category;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_avgcost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _avgcost;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_updateavgcost", CommandType.StoredProcedure, param);

            return _effect;
        }

        public DataTable GetItemStatusMaster(string _scm2status, string _scmstatus)
        {
            // sp_getitemstatus(p_scm2status in NVARCHAR2,p_scmstatus in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_scm2status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scm2status;
            (param[1] = new OracleParameter("p_scmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmstatus;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_getitemstatus", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetStockBalance(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
            string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, DateTime _asatdate, Int16 _serialrep, Int16 _discontinue)
        {
            //Sanjeewa 2013-03-01
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[13] = new OracleParameter("in_discon_items", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _discontinue;

            DataTable _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetOtherShopDO(DateTime _fromDate, DateTime _toDate, string _Cust, string _brand, string _model, string _itemcode,
            string _itemcat1, string _itemcat2, string _itemcat3, string _User, string _InvNo, Int16 _isExport)
        {
            //Sanjeewa 2013-10-14
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("IN_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cust;
            (param[5] = new OracleParameter("IN_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InvNo;
            (param[6] = new OracleParameter("IN_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("IN_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("IN_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("IN_ITEMCAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[10] = new OracleParameter("IN_ITEMCAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[11] = new OracleParameter("IN_ITEMCAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[12] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExport;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_othershopsales", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetFATDetails(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            //Sanjeewa 2014-02-03
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_User", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_fat_rep", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetFATDetails1(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc, string _docType)
        {
            //Sanjeewa 2014-02-03
            //Edit by Chamal 17-02-2014 as new function with _docType
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            return QueryDataTable("tbData", "sp_get_fat_rep1", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetExchangeDetails(string _DocNo)
        {
            //Sanjeewa 2013-10-07
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("inDocNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_exchange_report", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetStockBalanceWithCost(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
          string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, DateTime _asatdate, Int16 _serialrep, Int16 _status, string _Loc, string _Com, string _color, string _size)
        {
            //Sanjeewa 2013-03-01
            //Change the pkg_inv_bal.PROC_INVENTORY_BALANCE -->pkg_inv_bal.PROC_INVENTORY_BALANCE_NEW by Nadeeka - opening balance getting from the opening balance table.
            OracleParameter[] param = new OracleParameter[18];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[13] = new OracleParameter("in_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            (param[14] = new OracleParameter("IN_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[15] = new OracleParameter("IN_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[16] = new OracleParameter("in_color", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _color;
            (param[17] = new OracleParameter("in_size", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _size;
            DataTable _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_ASAT", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetStockBalanceWithSerial(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
            string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, DateTime _asatdate, Int16 _serialrep, Int16 _status)
        {
            //Sanjeewa 2013-03-01
            //Change the pkg_inv_bal.PROC_INVENTORY_BALANCE -->pkg_inv_bal.PROC_INVENTORY_BALANCE_NEW by Nadeeka - opening balance getting from the opening balance table.
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[13] = new OracleParameter("in_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;

            DataTable _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_NEW1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetStockBalanceWithSerial_Asat(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
            string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, DateTime _asatdate, Int16 _serialrep, Int16 _status, string _Loc, string _Com)
        {
            //Sanjeewa 2013-03-01
            //Change the pkg_inv_bal.PROC_INVENTORY_BALANCE -->pkg_inv_bal.PROC_INVENTORY_BALANCE_NEW by Nadeeka - opening balance getting from the opening balance table.
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[13] = new OracleParameter("in_status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _status;
            (param[14] = new OracleParameter("IN_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[15] = new OracleParameter("IN_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            //DataTable _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_SERIAL", CommandType.StoredProcedure, false, param);
            DataTable _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INV_BALANCE_SER_ASAT_SCM", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public string getItemDescription(string _itemcode)
        {
            string _ItemDescription = null;

            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            DataTable _tblData = QueryDataTable("tbData", "sp_get_item_desc", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow tr in _tblData.Rows)
                {
                    _ItemDescription = Convert.ToString(tr["mi_longdesc"]);
                }
            }

            return _ItemDescription;
        }

        public DataTable GetFIFONotFollowedDetails(string _user, string _brand, string _model, string _itemcode, string _Itemstatus,
            string _itemcat1, string _itemcat2, string _itemcat3, DateTime _asatdate, string _com, string _loc)
        {
            //Sanjeewa 2013-03-01
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[6] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[7] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[9] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[10] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[11] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_fifo_not_followed1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetFIFONotFollowedDetails1(string _user, string _brand, string _model, string _itemcode, string _Itemstatus,
            string _itemcat1, string _itemcat2, string _itemcat3, DateTime _asatdate, string _com, string _loc, DateTime _fromDate, DateTime _toDate, Int16 _fifo)
        {
            //Sanjeewa 2013-03-01
            //Readd Chamal 17-Feb-2014
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[6] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[7] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[8] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[9] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[10] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[11] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[12] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[13] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[14] = new OracleParameter("in_fifo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _fifo;
            return QueryDataTable("tbData", "sp_get_fifo_not_followed4", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetStockBalanceCurrent(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
          string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, Int16 _serialrep, string _com, string _loc, string _withGIT, string _withRCC, string _withJob, Int16 _discontinue)
        {
            //Sanjeewa 2013-03-01
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[12] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[13] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[14] = new OracleParameter("in_withRCC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _withRCC;
            (param[15] = new OracleParameter("in_discon_items", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _discontinue;

            DataTable _tblData = new DataTable();
            if (_withGIT == "Y")
            {
                if (_withJob == "Y")
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BAL_CURR_GIT_J", CommandType.StoredProcedure, false, param);// NADEEKA 01-06-2015
                }
                else
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BAL_CURR_GIT", CommandType.StoredProcedure, false, param);
                }


            }
            else
            {
                if (_withJob == "Y")
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_JOB", CommandType.StoredProcedure, false, param); // NADEEKA 01-06-2015
                }
                else
                {
                    _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_CURR2", CommandType.StoredProcedure, false, param);
                }
            };
            return _tblData;
        }


        public DataTable GetStockBalanceCurrent_Expiry(string _user, string _channel, string _brand, string _model, string _itemcode, string _Itemstatus,
         string _itemcat1, string _itemcat2, string _itemcat3, Int16 _withcost, Int16 _serialrep, string _com, string _loc, string _withGIT, string _withRCC, string _withJob, Int16 _discontinue)
        {
            //Wimal 25/04/2017
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemstatus;
            (param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[10] = new OracleParameter("in_WithCost", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _withcost;
            (param[11] = new OracleParameter("in_With_Serial", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _serialrep;
            (param[12] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[13] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[14] = new OracleParameter("in_withRCC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _withRCC;
            (param[15] = new OracleParameter("in_discon_items", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _discontinue;

            DataTable _tblData = new DataTable();
            _tblData = QueryDataTable("tbData", "pkg_inv_bal.PROC_INVENTORY_BALANCE_CURR2", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        public DataTable GetSGRANDetails(string _user, DateTime _fromDate, DateTime _toDate, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _doctype, string _reptpdesc)
        {
            //Sanjeewa 2013-03-25
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[8] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[9] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[10] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[11] = new OracleParameter("in_reptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptpdesc;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_gran_details", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetSIntrDetails(string _user, DateTime _fromDate, DateTime _toDate, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _doctype, string _reptpdesc, string _com, string _loc)
        {
            //Sanjeewa 2013-08-23
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[8] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[9] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[10] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[11] = new OracleParameter("in_reptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptpdesc;
            (param[12] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[13] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_intr_details", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetReservedSerialDetails(DateTime _fromDate, DateTime _toDate, string _user, string _com, string _pc)
        {
            //Sanjeewa 2013-12-11
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_reserved_serial", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetSerialBalance_Curr(string _com, string _loc, string _item, string _itemstatus, string _withRCC)
        {
            //Sanjeewa 2013-03-03
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("in_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("in_withRCC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _withRCC;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_inv_bal_serial_curr", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetSerialBalance()
        {
            //Sanjeewa 2013-03-03
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_inv_bal_serial", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable GetSerialBalance_Asat(DateTime _asatDate)
        {
            //Sanjeewa 2013-03-03
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_inv_bal_serial1", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Shani
        //2012/11/01
        public DataTable GetLOC_from_Hierachy(string com, string channel, string subChannel, string area, string region, string zone, string pc_code)
        {
            //p_com in NVARCHAR2,p_cha in NVARCHAR2,p_subcha in NVARCHAR2,p_area in NVARCHAR2,p_region in NVARCHAR2,p_zone in NVARCHAR2,p_code IN NVARCHAR2,c_data out SYS_REFCURSOR

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[2] = new OracleParameter("p_subcha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subChannel;
            (param[3] = new OracleParameter("p_area", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = area;
            (param[4] = new OracleParameter("p_region", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = region;
            (param[5] = new OracleParameter("p_zone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = zone;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc_code;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_LOC_onHierachy", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateRequestStatus(string _request, string _company, string _location, string _item, string _itemstatus, decimal _qty, string _docstatus, string _user)
        {
            //sp_updaterequeststatus(p_reqno in NVARCHAR2,p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_itmstatus in NVARCHAR2,p_qty in NUMBER,p_status in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docstatus;
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_updaterequeststatus", CommandType.StoredProcedure, param);

            return _effect;
        }
        public Int32 UpdateRequestStatusNew(string _request, string _company, string _location, string _item, string _itemstatus, decimal _qty, string _docstatus, string _user, Int32 _lineNo)
        {
            //sp_updaterequeststatus(p_reqno in NVARCHAR2,p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_itmstatus in NVARCHAR2,p_qty in NUMBER,p_status in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docstatus;
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[8] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_updaterequeststatus_New", CommandType.StoredProcedure, param);

            return _effect;
        }
        public Int32 UpdateRequestStatusBOND(string _request, string _company, string _location, string _item, string _itemstatus, decimal _qty, string _docstatus, string _user, Int32 _lineNo)
        {
            //sp_updaterequeststatus(p_reqno in NVARCHAR2,p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_itmstatus in NVARCHAR2,p_qty in NUMBER,p_status in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docstatus;
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[8] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_update_bond_req_sts", CommandType.StoredProcedure, param);

            return _effect;
        }

        #region Invalid Transaction Correction

        public InventoryHeader Get_Int_Hdr(string docNo)
        {           //p_docNo in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_int_hdr_Det", CommandType.StoredProcedure, false, param);
            InventoryHeader HDR = null;
            if (_tblData.Rows.Count > 0)
            {
                HDR = DataTableExtensions.ToGenericList<InventoryHeader>(_tblData, InventoryHeader.Convert2)[0];
            }
            return HDR;
        }

        //Code by Chamal 15-03-2013
        public List<ReptPickSerials> Get_Int_Ser(string _docNo)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "sp_get_int_ser", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(Convert_INT_Sernew(tr));
            }
            return _reptPickSerials;
        }

        private ReptPickSerials Convert_INT_Ser(DataRow _tr)
        {
            ReptPickSerials _pick = new ReptPickSerials();
            _pick.Tus_batch_line = Convert.ToInt32(_tr["ITS_BATCH_LINE"]);
            _pick.Tus_bin = Convert.ToString(_tr["ITS_BIN"]);
            _pick.Tus_com = Convert.ToString(_tr["ITS_COM"]);
            _pick.Tus_cre_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_no = Convert.ToString(_tr["ITS_DOC_NO"]);
            _pick.Tus_exist_grncom = Convert.ToString(_tr["ITS_EXIST_GRNCOM"]);
            _pick.Tus_exist_grndt = Convert.ToDateTime(_tr["ITS_EXIST_GRNDT"]);
            _pick.Tus_exist_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_exist_supp = Convert.ToString(_tr["ITS_EXIST_SUPP"]);
            _pick.Tus_itm_cd = Convert.ToString(_tr["ITS_ITM_CD"]);
            _pick.Tus_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);
            _pick.Tus_itm_stus = Convert.ToString(_tr["ITS_ITM_STUS"]);
            _pick.Tus_loc = Convert.ToString(_tr["ITS_LOC"]);//not sure
            _pick.Tus_orig_grncom = Convert.ToString(_tr["ITS_ORIG_GRNCOM"]);
            _pick.Tus_orig_grndt = Convert.ToDateTime(_tr["ITS_ORIG_GRNDT"]);
            _pick.Tus_orig_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_orig_supp = Convert.ToString(_tr["ITS_ORIG_SUPP"]);
            _pick.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure
            _pick.Tus_seq_no = Convert.ToInt32(_tr["ITS_SEQ_NO"]);
            _pick.Tus_ser_1 = Convert.ToString(_tr["ITS_SER_1"]);
            _pick.Tus_ser_2 = Convert.ToString(_tr["ITS_SER_2"]);
            _pick.Tus_ser_3 = Convert.ToString(_tr["ITS_SER_3"]);
            _pick.Tus_ser_4 = Convert.ToString(_tr["ITS_SER_4"]);
            _pick.Tus_ser_id = Convert.ToInt32(_tr["ITS_SER_ID"]);
            _pick.Tus_ser_line = Convert.ToInt32(_tr["ITS_SER_LINE"]);
            // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
            _pick.Tus_unit_cost = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            _pick.Tus_unit_price = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
            _pick.Tus_warr_no = Convert.ToString(_tr["ITS_WARR_NO"]);
            _pick.Tus_warr_period = Convert.ToInt32(_tr["ITS_WARR_PERIOD"]);
            _pick.Tus_new_status = string.Empty;
            _pick.Tus_base_doc_no = Convert.ToString(_tr["ITB_BASE_REF_NO"]);
            _pick.Tus_base_itm_line = Convert.ToInt32(_tr["ITB_BASE_REFLINE"]);
            if (string.IsNullOrEmpty(_tr["ITS_AGELOC"].ToString()))
            { _pick.Tus_ageloc = _pick.Tus_loc; }
            else
            { _pick.Tus_ageloc = _tr["ITS_AGELOC"].ToString(); }
            if (string.IsNullOrEmpty(_tr["ITS_AGELOC_DT"].ToString()))
            { _pick.Tus_ageloc_dt = _pick.Tus_doc_dt; }
            else
            { _pick.Tus_ageloc_dt = Convert.ToDateTime(_tr["ITS_AGELOC_DT"].ToString()).Date; }

            if (string.IsNullOrEmpty(_tr["ITS_ISOWNMRN"].ToString()))
            { _pick.Tus_isownmrn = 0; }
            else
            { _pick.Tus_isownmrn = Convert.ToInt32(_tr["ITS_ISOWNMRN"].ToString()); }
            _pick.Mis_desc = Convert.ToString(_tr["mis_desc"]);//add rukshan 10/DEc/2015
            //Added Prabhath on 11/08/2012
            MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);
            _pick.Tus_itm_desc = _item.Mi_longdesc;
            _pick.Tus_itm_model = _item.Mi_model;
            _pick.Tus_itm_brand = _item.Mi_brand;

            return _pick;
        }

        public DataTable Get_Int_Itm(string docNo)
        {           //p_docNo in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_int_itm_Det", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public DataTable Get_Int_ItmStausBySerId(string _inv, Int32 _serid, string _serial, string _item)
        {   // Nadeeka 11-06-2015
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_serID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serid;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_status_by_SerID", CommandType.StoredProcedure, false, param);
            return _tblData;
        }


        public DataTable Get_SerialOfDoc(string docNo, string itemCode)
        {           //p_docNo in NVARCHAR2,p_itemCode in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            (param[1] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_serial_DetOfDoc", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        #endregion Invalid Transaction Correction

        public Int32 UpdateRequestHeader(string _request, string _user)
        {
            //sp_updaterequestheader(p_request in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_updaterequestheader", CommandType.StoredProcedure, param);

            return _effect;
        }


        public Int32 CancelOutwardDoc(string _doc, string _user)
        {

            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_cancel_inv_doc", CommandType.StoredProcedure, param);

            return _effect;
        }

        public Int32 CancelQuotationDoc(string _quo, string _doc, string _user)
        {// Nadeeka 19-11-2015

            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_quo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quo;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int16)UpdateRecords("sp_cancel_quo_doc", CommandType.StoredProcedure, param);

            return _effect;
        }



        public Int32 IsExistInWarrantyMaster(string _companyCode, string _warrantyno)
        {
            ConnectionOpen();
            //sp_isexist_in_warranty_master   (p_com In NVARCHAR2,    p_warranty In NVARCHAR2,    serial_id OUT NUMBER)
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _companyCode;
            (param[1] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrantyno;
            OracleParameter outParameter = new OracleParameter("serial_id", OracleDbType.Int32, null, ParameterDirection.Output);
            int _serial_id = ReturnSP_SingleValue("sp_isexist_in_warranty_master", CommandType.StoredProcedure, outParameter, param);
            ConnectionClose();
            return _serial_id;
        }

        public DataTable GetMultipleItemforOneSerial(string _company, string _location, string _item, string _serial, string _warranty)
        {
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.Empty;
            (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.Empty;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.Empty;
            (param[6] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[7] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "pkg_search.sp_search_avlbleserial4invoice", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //darshana 15-01-2013
        public Boolean Update_serial_status(string compny, string location, string itemCD, string ser_1, int availability, Int32 seqNo)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = compny;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[3] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_1;
            (param[4] = new OracleParameter("p_is_available", OracleDbType.Int32, null, ParameterDirection.Input)).Value = availability;
            (param[5] = new OracleParameter("p_ins_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNo;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //ConnectionOpen();
            effects = UpdateRecords("sp_update_serial_status", CommandType.StoredProcedure, param);

            return effects >= 1 ? true : false;
        }

        //sachith 2013/01/29
        public DataTable StockBalanceSearch(DateTime _from, DateTime _to, string _item, string _loc, string _com)
        {
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_stk_det_search", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MasterLocation> getAllLoc_WithSubLoc(string com, string main_Loc)
        {
            //p_com in NVARCHAR2,p_main_loc in NVARCHAR2,c_data OUT sys_refcursor
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_main_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = main_Loc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_getuser_allLoc", CommandType.StoredProcedure, false, param);

            List<MasterLocation> loc_list = new List<MasterLocation>();
            if (_dtResults.Rows.Count > 0)
            {
                loc_list = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal);
            }
            return loc_list;
        }

        public DataTable SerialBalanceSearch(DateTime _from, DateTime _to, string _item, string _loc, string _com)
        {
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_ser_det_search_1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //modified b kelum on 2016-May-11
        public DataTable SerialBalanceSearch1(DateTime _from, DateTime _to, string _item, string _loc, string _com, string _serial = null)
        {
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_serial))
            {
                _serial = null;
            }
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "sp_ser_det_search", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable get_CostUpdateDetails()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_costupdate_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Get_InrSer_NotAvailableItems(string _company, string _loc, string _itemCode)
        {
            //(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_itemCode in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblInrSer", "sp_getInrSer_NotAvailableItems", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 20/8/2014
        public DataTable GetSerialDetailsBySerial(string _com, string _loc, string _itemCode, string _serial)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblInrSer", "sp_get_serdet", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        // NADEEKA 10-03-2015
        public DataTable GetSerialDetailsBySerialCompany(string _com, string _itemCode, string _serial)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblInrSer", "sp_get_serdet_serCom", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        // NADEEKA 10-03-2015
        public DataTable GetSerialDetailsBySerialwithoutItem(string _com, string _loc, string _serial)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblInrSer", "sp_get_serdetwithoutItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetSerialDetailsBySerial1(string _com, string _loc, string _itemCode, string _serial)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblInrSer", "sp_get_serdet1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //modified by kelum 2016-May-11
        public DataTable StockBalanceSearch1(DateTime _from, DateTime _to, string _item, string _loc, string _com, bool isStatus, string _doctype = null)
        {
            DataTable _dtResults = new DataTable();

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_isstatus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isStatus;
            (param[6] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tbl", "stk_det_search1", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<InventoryAdhocDetail> GetAdhocdet_List(string _ref)
        {   // Shani 02-01-13
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_adhoc_det", CommandType.StoredProcedure, false, param);

            List<InventoryAdhocDetail> loc_list = new List<InventoryAdhocDetail>();
            if (_dtResults.Rows.Count > 0)
            {
                loc_list = DataTableExtensions.ToGenericList<InventoryAdhocDetail>(_dtResults, InventoryAdhocDetail.Converter);
            }
            return loc_list;
        }

        public List<ReptPickSerials> GetInventorySerialListById(string _serId, string _loc)
        {
            //Shani 07-02-2013

            List<ReptPickSerials> serialList = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serId;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_serialbyId", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                serialList = DataTableExtensions.ToGenericList<ReptPickSerials>(_dtResults, ReptPickSerials.ConvertTotal);
            }

            return serialList;
        }

        public Boolean CheckPreRequestAdhocSer(string company, string location, Int32 serID)
        {
            //p_com in NVARCHAR2,p_loc IN NVARCHAR2,p_serID in NVARCHAR2,c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_serID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serID;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tbl_serials", "sp_check_preReqAdhocSer", CommandType.StoredProcedure, false, param);

            List<InventoryAdhocHeader> _list = null;
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryAdhocHeader>(_dtResults, InventoryAdhocHeader.Converter);
            }

            if (_dtResults.Rows.Count > 0)
            {
                return true; //has alrady requested
            }
            else
            {
                return false;
            }
        }

        //Darshana on 07-02-2013
        public List<ReptPickSerials> GetRevReqSerial(string _company, string _location, string _user, string _session, string _defBin, string _invoice, string _reqNo)
        {
            #region new code
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _tblData = QueryDataTable("tbData", "sp_getreqrevserialsTest1", CommandType.StoredProcedure, false, param);
            DataTable _tblData = QueryDataTable("tbData", "sp_getreqrevserials", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = Convert.ToInt16(_row["ITB_BASE_REFLINE"]);
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);

                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"] == DBNull.Value ? 0 : _row["ITS_WARR_PERIOD"]);
                        _one.Tus_appstatus = _row["grad_anal8"] == DBNull.Value ? string.Empty : (String)_row["grad_anal8"];

                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = Convert.ToDateTime(_row["its_fifo_dt"]);

                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = Convert.ToInt16(_row["ITB_BASE_REFLINE"]);
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        //_one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_qty = Convert.ToDecimal(_row["gras_anal8"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = "N/A";
                        _one.Tus_ser_2 = "N/A";
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                        _one.Tus_appstatus = _row["grad_anal8"] == DBNull.Value ? string.Empty : (String)_row["grad_anal8"];
            #endregion

                        #region old code
                        //List<ReptPickSerials> _list = new List<ReptPickSerials>();
                        //OracleParameter[] param = new OracleParameter[3];
                        //(param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
                        //(param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
                        //param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                        //DataTable _tblData = QueryDataTable("tbData", "sp_getreqrevserials", CommandType.StoredProcedure, false, param);

                        //if (_tblData.Rows.Count > 0)
                        //{
                        //    foreach (DataRow _row in _tblData.Rows)
                        //    {
                        //        MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                        //        ReptPickSerials _one = new ReptPickSerials();
                        //        if (_item.Mi_is_ser1 != -1)
                        //        {
                        //            _one.Tus_base_doc_no = _invoice;
                        //            _one.Tus_base_itm_line = Convert.ToInt16(_row["ITB_BASE_REFLINE"]);
                        //            _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        //            _one.Tus_bin = _defBin;
                        //            _one.Tus_com = _company;
                        //            _one.Tus_cre_by = _user;
                        //            _one.Tus_cre_dt = System.DateTime.Now;
                        //            _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        //            _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        //            _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        //            _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);

                        //            _one.Tus_doc_dt = System.DateTime.Now.Date;
                        //            _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        //            _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        //            _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        //            _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        //            _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        //            _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        //            _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        //            _one.Tus_itm_brand = _item.Mi_brand;
                        //            _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        //            _one.Tus_itm_desc = _item.Mi_longdesc;
                        //            _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        //            _one.Tus_itm_model = _item.Mi_model;
                        //            _one.Tus_loc = _location;
                        //            _one.Tus_new_remarks = String.Empty;
                        //            _one.Tus_new_status = String.Empty;
                        //            _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        //            _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        //            _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        //            _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        //            _one.Tus_out_date = DateTime.Now.Date;
                        //            _one.Tus_qty = 1;
                        //            _one.Tus_seq_no = 0;
                        //            _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        //            _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        //            _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        //            _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        //            _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        //            _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        //            _one.Tus_serial_id = "1";
                        //            _one.Tus_session_id = _session;
                        //            _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        //            _one.Tus_usrseq_no = -1;
                        //            _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        //            _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                        //            _one.Tus_appstatus = _row["grad_anal8"] == DBNull.Value ? string.Empty : (String)_row["grad_anal8"];

                        //            //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //            //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //            //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //            //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //            //_one.Tus_fifo_dt = Convert.ToDateTime(_row["its_fifo_dt"]);

                        //        }
                        //        else
                        //        {
                        //            _one.Tus_base_doc_no = _invoice;
                        //            _one.Tus_base_itm_line = Convert.ToInt16(_row["ITB_BASE_REFLINE"]);
                        //            _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        //            _one.Tus_bin = _defBin;
                        //            _one.Tus_com = _company;
                        //            _one.Tus_cre_by = _user;
                        //            _one.Tus_cre_dt = System.DateTime.Now;
                        //            _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        //            _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        //            _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        //            _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        //            _one.Tus_exist_grncom = string.Empty;
                        //            _one.Tus_exist_grndt = DateTime.MaxValue;
                        //            _one.Tus_exist_grnno = string.Empty;
                        //            _one.Tus_exist_supp = string.Empty;
                        //            _one.Tus_itm_brand = _item.Mi_brand; ;
                        //            _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        //            _one.Tus_itm_desc = _item.Mi_longdesc;
                        //            _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        //            _one.Tus_itm_model = _item.Mi_model;
                        //            _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        //            _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        //            _one.Tus_new_remarks = string.Empty;
                        //            _one.Tus_new_status = string.Empty;
                        //            _one.Tus_orig_grncom = string.Empty;
                        //            _one.Tus_orig_grndt = DateTime.MaxValue;
                        //            _one.Tus_orig_grnno = string.Empty;
                        //            _one.Tus_orig_supp = string.Empty;
                        //            _one.Tus_out_date = DateTime.Now.Date;
                        //            _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        //            _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        //            _one.Tus_ser_1 = string.Empty;
                        //            _one.Tus_ser_2 = string.Empty;
                        //            _one.Tus_ser_3 = string.Empty;
                        //            _one.Tus_ser_4 = string.Empty;
                        //            _one.Tus_ser_id = -1;
                        //            _one.Tus_ser_line = -1;
                        //            _one.Tus_serial_id = "1";
                        //            _one.Tus_session_id = _session;
                        //            _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        //            _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        //            _one.Tus_usrseq_no = -1;
                        //            _one.Tus_warr_no = string.Empty;
                        //            _one.Tus_warr_period = 0;
                        //            _one.Tus_appstatus = _row["gras_anal8"] == DBNull.Value ? string.Empty : (String)_row["gras_anal8"];


                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = Convert.ToDateTime(_row["its_fifo_dt"]);
                        #endregion
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }

        public Int16 UpdateSerialRevStatus(string _doNo, string _itm, string _com, Int32 _serID, string _ser)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_serID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serID;
            (param[4] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_ser_rev", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdateSerialRevStatusCancel(string _doNo, string _itm, string _com, Int32 _serID, string _ser)
        {// Nadeeka 15-05-2015
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doNo;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_serID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serID;
            (param[4] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_ser_rev_cancel", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int16 UpdateRevStatusActive(string _inv, string _com, string _status)
        {// Nadeeka 15-05-2015
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_Inv_cancel", CommandType.StoredProcedure, param);
            return effects;
        }

        public Boolean IsPendingInvoice(string _inv)
        { //Nadeeka 16-05-2015
            Boolean _isAvb = false;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_Pending_Inv_items", CommandType.StoredProcedure, false, param);
            if (_tbl.Rows.Count > 0)
            {
                _isAvb = true;
            }
            else
            {
                _isAvb = false;
            }

            return _isAvb;
        }


        public DataTable GetNoOfPendingRCC(string _com, string _loc, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tbl", "sp_get_noof_pend_rcc", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public List<ReptPickSerials> GetInvoiceSerialForReversal(string _company, string _location, string _user, string _session, string _defBin, string _invoice, int _baseRefline)
        {
            //sp_getdoserialdetail(p_com in NVARCHAR2, p_invoiceno in NVARCHAR2,p_base_refline in NUMBER, c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _baseRefline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailforrev", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);

                        //updated by akila 2017/11/10
                        _one.Tus_exp_dt = _row["ITB_EXP_DT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITB_EXP_DT"];
                        _one.Tus_manufac_dt = _row["ITB_MANUFAC_DT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITB_MANUFAC_DT"];

                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = _row["its_fifo_dt"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["its_fifo_dt"];
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        if (_item.Mi_is_ser1 == -1)
                            _one.Tus_ser_id = 0;   //_one.Tus_serial_id = "-1";  kapila 18/9/2015
                        else
                            _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;

                        //updated by akila 2017/11/10
                        _one.Tus_exp_dt = _row["ITB_EXP_DT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITB_EXP_DT"];
                        _one.Tus_manufac_dt = _row["ITB_MANUFAC_DT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITB_MANUFAC_DT"];

                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = _row["its_fifo_dt"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["its_fifo_dt"];
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }

        public ReptPickSerials Get_all_details_on_doc(string company, string location, string itemCode, string doc, string serial)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[4] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_get_serial_detail_doc_ser", CommandType.StoredProcedure, false, param);
            ReptPickSerials _reptPickSerials = new ReptPickSerials();
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials = SetReptPickSerials(tr);
            }
            return _reptPickSerials;
        }

        public Boolean UpdateSerialIDAvailable(string compny, string location, string itemCD, Int32 ser_ID, int availability, int oldAvailable)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = compny;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[3] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_ID;
            (param[4] = new OracleParameter("p_is_available", OracleDbType.Int32, null, ParameterDirection.Input)).Value = availability;
            (param[5] = new OracleParameter("p_ol_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oldAvailable;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_ser_id", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }

        public ReptPickSerials GetReservedByserialID(string company, string location, string bin, string itemCode, int serial_ID)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[4] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serial_ID;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serial", "sp_getreservedserial_ID", CommandType.StoredProcedure, false, param);
            ReptPickSerials _reptPickSerials = new ReptPickSerials();
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials = SetReptPickSerials(tr);
            }
            return _reptPickSerials;
        }

        public DataTable GetSCM2SerialiItem(string _serialtype, string _company, string _serial, Int16 _isWholeWord)
        {
            //sp_getserialitem(p_serialtype in NVARCHAR2,  p_com in VARCHAR2, p_serial in NVARCHAR2,p_wholeword in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_serialtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialtype;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_wholeword", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isWholeWord;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getserialitem", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetSCM2CurrentLocation(string _serialType, string _company, string _serial, string _item)
        {
            //sp_getseriallocation(p_com in NVARCHAR2,p_item in NVARCHAR2,p_serial in NVARCHAR2,p_serialtype in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_serialtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialType;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getseriallocation", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetSCM2Movement(string _serialType, string _company, string _serial, string _item)
        {
            // sp_getMovement(p_com in NVARCHAR2, p_serial in NVARCHAR2,p_item in NVARCHAR2,p_serialtype in NVARCHAR2,c_data out sys_refcursor )
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serialtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialType;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getMovement", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetWarrantyClaimReqyest(string _company, string _profitcenter, string _type, int _isApproved, string _status, DateTime _fromDate, DateTime _toDate)
        {
            //sp_getwaraclaimrequest ( p_com    IN     NVARCHAR2,  p_pc     IN     NVARCHAR2,  p_type   IN     NVARCHAR2,p_isapproved in NUMBER,p_status in NVARCHAR2,p_fromdt in DATE,p_todt in DATE,    c_data      OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_isapproved", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isApproved;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_fromdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[6] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getwaraclaimrequest", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public List<RequestApprovalDetail> GetWarrantyClaimReqDetail(string _request)
        {
            //sp_getwaraclaimitem(p_request in NVARCHAR2,c_data out sys_refcursor)
            List<RequestApprovalDetail> _list = new List<RequestApprovalDetail>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getwaraclaimitem", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalDetail>(dt, RequestApprovalDetail.ConverterItem);
            }

            return _list;
        }

        public List<RequestApprovalDetail> GetWarrantyClaimInvoiceDuplicate(string _invoice, string _item, string _lineno)
        {
            //sp_getgenrequest(p_invoice in NVARCHAR2,p_item in NVARCHAR2,p_line in NVARCHAR2,c_data out sys_refcursor) IS
            List<RequestApprovalDetail> _list = new List<RequestApprovalDetail>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getgenrequest", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RequestApprovalDetail>(dt, RequestApprovalDetail.Converter);
            }

            return _list;
        }

        public int DeleteAppReqTable(string _request)
        {
            // sp_deletegenapptable(p_requestno in NVARCHAR2,o_effect out NUMBER)
            int effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_requestno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_deletegenapptable", CommandType.StoredProcedure, param);

            return effect;
        }

        public DataTable GetMoveSubTypeMainTable(string _subType, string _mainType)
        {   // sp_getMoveSubTypebymain (p_Type in NVARCHAR2,p_main in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subType;
            (param[1] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainType;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getMoveSubTypebymain", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Darshana - 28/03/2013
        public List<QuotationHeader> GetLatestValidQuotation(string _com, string _sup, string _type, string _subtype, DateTime _date, decimal _qty, string _status, string _item)
        {
            List<QuotationHeader> _list = new List<QuotationHeader>();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sup;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tblsupplierquotation", "sp_get_valid_quotation", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<QuotationHeader>(_tblData, QuotationHeader.ConvertQuotation);
            }
            return _list;
        }

        //Chamal 28/03/2013
        public List<MasterItemSimilar> GetSimilarItems(string _type, string _item, string _company, DateTime _date, string _ptytp, string _ptycd)
        {
            List<MasterItemSimilar> _similarItems = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[4] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptytp;
            (param[5] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptycd;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblItem = QueryDataTable("tblItemSimilar", "sp_getsimilaritem_new", CommandType.StoredProcedure, false, param);
            if (_tblItem.Rows.Count > 0) _similarItems = DataTableExtensions.ToGenericList<MasterItemSimilar>(_tblItem, MasterItemSimilar.Converter);
            return _similarItems;
        }

        //Chamal 28/05/2013
        public List<InventoryWarrantySubDetail> GetSubItemSerials(string _mItem, string _mSerial, int _mSerID)
        {
            List<InventoryWarrantySubDetail> _subItems = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mitem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mItem;
            (param[1] = new OracleParameter("p_mserial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mSerial;
            (param[2] = new OracleParameter("p_mserid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mSerID;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblItem = QueryDataTable("tblItemSub", "sp_getsubitemserials", CommandType.StoredProcedure, false, param);
            if (_tblItem.Rows.Count > 0) _subItems = DataTableExtensions.ToGenericList<InventoryWarrantySubDetail>(_tblItem, InventoryWarrantySubDetail.Converter);
            return _subItems;
        }

        //Chamal 02/04/2013
        public DataTable CheckIsAodReceived(string _document)
        {
            DataTable _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_aodno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _list = QueryDataTable("tbl", "sp_checkisaodreceived", CommandType.StoredProcedure, false, param);
            return _list;
        }

        public List<InventorySerialMaster> GetWarrantyDetails(string _invoice, string _acc, string _item, string _serial, string _warranty)
        {
            List<InventorySerialMaster> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[1] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[4] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblItemSimilar", "sp_getwarrantydetails", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialMaster>(_tblData, InventorySerialMaster.ConvertTotal);
            }
            return _list;
        }

        public DataTable GetInvoiceAccountNoFromItem(string _item, string _serial, string _warranty)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[2] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblItemSimilar", "sp_get_ser_war_det", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Chamal 11/05/2013
        public decimal Get_Cons_Quo_Price(string _com, string _supplier, DateTime _date, string _item, decimal _qty)
        {
            decimal _price = -1;
            DataTable _dt = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dt = QueryDataTable("tbl", "GET_CONS_QUO_PRICE", CommandType.StoredProcedure, false, param);
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    foreach (DataRow dr in _dt.Rows)
                    {
                        _price = Convert.ToDecimal(dr["QD_UNIT_PRICE"]);
                        break;
                    }
                }
            }

            return _price;
        }

        //Chamal 11/05/2013
        public InvoiceHeader GetInvoiceHeader(string _invoiceno)
        {
            InvoiceHeader _hdr = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblSalesDet", "sp_getinvoiceheader", CommandType.StoredProcedure, false, param);
            if (_dtResult.Rows.Count > 0) _hdr = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResult, InvoiceHeader.ConvertTotal)[0];
            return _hdr;
        }

        //Written by Prabhath on 14/05/2013 (Not expose to the client)
        public int UpdateDeliverVoucher(string _company, string _invoice, string _item, string _book, string _page, string _user)
        {
            //sp_update_do_voucher(p_com in NVARCHAR2,p_invoice in NVARCHAR2,p_item in NVARCHAR2,p_book in NUMBER,p_page in NUMBER,p_user in NVARCHAR2,o_effect out NUMBER)
            int effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_book", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _book;
            (param[4] = new OracleParameter("p_page", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _page;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effect = (Int16)UpdateRecords("sp_update_do_voucher", CommandType.StoredProcedure, param);

            return effect;
        }

        public DataTable GetInventoryBalanceByBatch(string _company, string _location, string _item, string _status)
        {
            //sp_getbatchbalance(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_status in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblGetBatchBalance", "sp_getbatchbalance", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public DataTable CheckSerialAvailability(string _serialtype, string _item, string _serial)
        {
            //sp_checkserialavailability(p_serialtype in NVARCHAR2, p_item in NVARCHAR2,p_serial in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_serialtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialtype;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblCheckserialavailability", "sp_checkserialavailability", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }
        public DataTable CheckSerialAvailabilityscm(string _item, string _serial)
        {
            //sp_checkserialavailability(p_serialtype in NVARCHAR2, p_item in NVARCHAR2,p_serial in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblCheckserialavailability", "sp_checkserialavailabilitySCM", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }


        //Duplicated by Prabhath (for Invoice) on 20/05/2013 Original function in GeneralDAL
        public Int32 SaveSMSOut(OutSMS _smsout)
        {
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_createtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Createtime;
            (param[1] = new OracleParameter("p_deletedtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Deletedtime;
            (param[2] = new OracleParameter("p_deliveredtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Deliveredtime;
            (param[3] = new OracleParameter("p_downloadtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Downloadtime;
            (param[4] = new OracleParameter("p_msg", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msg;
            (param[5] = new OracleParameter("p_msgid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msgid;
            (param[6] = new OracleParameter("p_msgstatus", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _smsout.Msgstatus;
            (param[7] = new OracleParameter("p_msgtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Msgtype;
            (param[8] = new OracleParameter("p_receivedtime", OracleDbType.Date, null, ParameterDirection.Input)).Value = _smsout.Receivedtime;
            (param[9] = new OracleParameter("p_receiver", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Receiver;
            (param[10] = new OracleParameter("p_receiverphno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Receiverphno;
            (param[11] = new OracleParameter("p_refdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Refdocno;
            (param[12] = new OracleParameter("p_sender", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Sender;
            (param[13] = new OracleParameter("p_senderphno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.Senderphno;
            (param[14] = new OracleParameter("p_seqno", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _smsout.Seqno;
            (param[15] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _smsout.comcode;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_savesmsout", CommandType.StoredProcedure, param);

            return _effect;
        }

        //Chamal 20-May-2013
        public int UpdateMovementDocDate(string _docNo, DateTime _docDt, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _docDt;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_correct_mov_date", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Prabhath on 21/05/2013 - Not expose to client
        public Int32 CancelInwardInventoryDocument(string _company, string _location, string _document, string _user)
        {
            //sp_cancelinwarddocument(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int effects = (int)UpdateRecords("sp_cancelinwarddocument", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetUserSearchDataT(string _company)
        {
            return QueryDataTable("tblSearch", _company, CommandType.Text, false);
        }

        public DataSet GetUserSearchDataS(string _company)
        {
            return QueryDataSet("tblSearch", _company, CommandType.Text, false);
        }

        public Int32 UpdateUserSearchData(string _company)
        {
            return UpdateRecords(_company, CommandType.Text);
        }

        public DataTable CheckInwardDocumentUseStatus(string _company, string _location, string _document)
        {
            //sp_checkinwarddocumentrefer(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_document in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblCheckinwarddocumentrefer", "sp_checkinwarddocumentrefer", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public DataTable GetBuyBackInventoryDocument(string _company, string _location, string _invoiceno)
        {
            //sp_buybackinentorydocument(p_com in NVARCHAR2,p_location in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblBuybackinentorydocument", "sp_buybackinentorydocument", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public DataTable GetConsginmentDocumentByInvoice(string _company, string _location, string _invoice)
        {
            // sp_inventorybyinvoice(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblSPInventorybyinvoice", "sp_inventorybyinvoice", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public DataTable GetChannelDetail(string _company, string _channel)
        {
            //sp_getchannel(p_com in NVARCHAR2,p_chnl in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblSpgetchannel", "sp_getchannel", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public DataTable GetToLocationPermission(string _fromcompany, string _fromlocation, string _tocompany, string _tocategory, string _module)
        {
            //sp_checktolocationpermission(p_frmcom in NVARCHAR2,p_frmloc in NVARCHAR2,p_tocom in NVARCHAR2,p_tocat in NVARCHAR2,p_module in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_frmcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromcompany;
            (param[1] = new OracleParameter("p_frmloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromlocation;
            (param[2] = new OracleParameter("p_tocom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tocompany;
            (param[3] = new OracleParameter("p_tocat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tocategory;
            (param[4] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblSpchecktolocationpermission", "sp_checktolocationpermission", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public List<ReptPickSerials> GetNonSerializedItemRandomlyByDate(string _company, string _location, string _item, string _status, decimal _qty, DateTime _date)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "sp_getnonserialdetailbydate", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(SetReptPickSerials(tr));
            }
            return _reptPickSerials;
        }

        public DataTable GetMRNRequest(string _mrn)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mrn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getreqbyref", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable GetWarehouse_Request(string _dipatchReq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dipatchReq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getwarehouseappbyreq", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable GetMovementbyreqapp(string _warehouseReq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_war_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehouseReq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getmovementbydispath", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public MasterItemBlock GetBlockedItemByPriceType(string _company, string _profit, string _item, int _pricetype, Int32 _line)
        {
            //sp_getblockeditembytype(p_com in NVARCHAR2 ,p_profitcenter in NVARCHAR2,p_item in NVARCHAR2,p_pricetype in NUMBER,c_data out sys_refcursor)

            MasterItemBlock _list = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_pricetype", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pricetype;
            (param[4] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getblockeditembytype_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<MasterItemBlock>(_dtResults, MasterItemBlock.Converter)[0];

            return _list;
        }

        public DataTable GetMRNTracking(string _loc, string _com, string _mrnNo, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_mrn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrnNo;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getmrn_tracking", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 UpdateRCCStatus(Int32 _is_app, Int32 _is_rej, string _user, DateTime _date, string _rccno)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_is_app", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_app;
            (param[1] = new OracleParameter("p_is_rej", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_rej;
            (param[2] = new OracleParameter("p_inr_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_inr_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_inr_rej_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_inr_rej_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_INR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccno;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_upd_rcc_app", CommandType.StoredProcedure, param);
            return effected;
        }

        //kapila
        public DataTable GetDocNoByJobNo(string _com, string _loc, string _jobno, out string _docno, Int32 _isExternal)
        {
            string docno = "";
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (_isExternal == 1)
            {
                _result = QueryDataTable("tbl", "sp_get_docno_by_jb", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _result = QueryDataTable("tbl", "sp_get_docno_by_jb_scm", CommandType.StoredProcedure, false, param);
            }

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                docno = Convert.ToString(_result.Rows[i]["ith_doc_no"]);
            }
            _docno = docno;
            return _result;
        }

        //kapila
        public DataTable GetOutDocNoByJobNo(string _com, string _loc, string _jobno, out string _docno, Int32 _isExternal)
        {
            string docno = "";
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_get_outdocbyjob", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                docno = Convert.ToString(_result.Rows[i]["ith_doc_no"]);
            }
            _docno = docno;
            return _result;
        }

        public DataTable SearchGranDin(string _com, string _loc, string _type, string _from, string _to, string _stus, string _cre, string _item, string _serial)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _to;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[6] = new OracleParameter("p_createdBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cre;
            (param[7] = new OracleParameter("P_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[8] = new OracleParameter("p_seraila", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_search_gran_din", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Boolean IsExternalServiceAgent(string _com, string _code)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isExternal = QueryDataTable("tbl", "sp_chk_ext_agt", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _isExternal;
        }

        public DataTable GetServiceLocation(string _com, string _code, out string _svcLoc)
        {
            string svc_loc = "";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_svc_loc", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                svc_loc = Convert.ToString(_result.Rows[i]["mbe_acc_cd"]);
            }
            _svcLoc = svc_loc;
            return _result;
        }

        public DataTable GetVirtualLocation(string _com, string _type, out string _vLoc)
        {
            string v_loc = "";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_vtual_loc", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                v_loc = Convert.ToString(_result.Rows[i]["rvlm_loc"]);
            }
            _vLoc = v_loc;
            return _result;
        }

        public DataTable GetFixAssetLocation(string _com, string _loc, out string _fLoc)
        {
            string f_loc = "";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_faset_loc", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                f_loc = Convert.ToString(_result.Rows[i]["ml_fx_loc"]);
            }
            _fLoc = f_loc;
            return _result;
        }

        public DataTable Search_RCC(string _com, string _loc, string _RCCno, DateTime _from, DateTime _to, string _stus, string _item, string _serial, string _warr)
        {
            //            (p_com in NVARCHAR2,p_loc in NVARCHAR2,p_rccNo in NVARCHAR2,
            //p_rccTp in NVARCHAR2,p_item IN NVARCHAR2,p_serial IN NVARCHAR2,p_warr IN NVARCHAR2,
            //p_fromDt in DATE,p_toDt in DATE, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_rccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RCCno;
            (param[3] = new OracleParameter("p_rccTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[6] = new OracleParameter("p_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warr;
            (param[7] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[8] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAll", "pkg_search.SP_SEARCH_rcc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable SEARCH_rccByDate(string _com, string _loc, string _stage, string _from, string _to, string isSR_AcceptPending)
        {
            //SP_SEARCH_rccByDate(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_stage in NVARCHAR2,p_fromDt in DATE,p_toDt in DATE, c_data out sys_refcursor)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stage;
            (param[3] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from == string.Empty ? DateTime.MinValue : Convert.ToDateTime(_from).Date;
            (param[4] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to == string.Empty ? DateTime.MaxValue : Convert.ToDateTime(_to).Date;
            (param[5] = new OracleParameter("p_srAccPend", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isSR_AcceptPending == string.Empty ? "0" : isSR_AcceptPending;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblAll", "SP_SEARCH_rccByDate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable Get_INT_RCC_STAGES_INFO(string _rccNo)
        {
            //get_INT_RCC_STAGES_INFO(p_rccNo in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblRCC", "get_INT_RCC_STAGES_INFO", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckAllocationItemRagistration(string _item)
        {
            //sp_checkregistrationallocation(p_item in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblItem", "sp_checkregistrationallocation", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable CheckItemSerialStatus(string _item)
        {
            // sp_itemserialstatus(p_item in string,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblItem", "sp_itemserialstatus", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        //kapila
        public DataTable getRCCbySerialWar(string _ser, string _war)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[1] = new OracleParameter("p_war", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _war;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblItem", "sp_get_rccbyser", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public RCC GetRCCbySerial(string _Item, string _Serial)
        {
            RCC _rcc = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[1] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_rcc_by_ser", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _rcc = DataTableExtensions.ToGenericList<RCC>(_dtResults, RCC.Converter)[0];
            }
            return _rcc;
        }

        public InventoryRequest GetPendingRequest(string _item, int _serial, string _docNo)
        {
            InventoryRequest _req = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_pend_gran_ser", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _req = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter)[0];
            }
            return _req;
        }

        public DataTable GetLocationCat3(string _company)
        {
            //sp_getlocationcat3(p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblcat3", "sp_getlocationcat3", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public DataTable GetLocationByCat3(string _cat3, string _company)
        {
            //sp_getlocationbycat3(p_cat3 in NVARCHAR2,p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblcat3", "sp_getlocationbycat3", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public int SaveTransactionCategory(string _fromcompany, string _fromlocation, string _tocompany, string _tocat3, int _allow, string _user)
        {
            //sp_savelocationtransaction(p_frmcom in NVARCHAR2,p_frmloc in NVARCHAR2,p_tocom in NVARCHAR2,p_tocat3 in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER) is
            int _effect = -1;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_frmcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromcompany;
            (param[1] = new OracleParameter("p_frmloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromlocation;
            (param[2] = new OracleParameter("p_tocom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tocompany;
            (param[3] = new OracleParameter("p_tocat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tocat3;
            (param[4] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _allow;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_savelocationtransaction", CommandType.StoredProcedure, param);
            return _effect;
        }

        public DataSet _scmDataset = new DataSet();

        public void GetInventoryDocument(string _document)
        {
            //sp_getinventoryheader(p_document in NVARCHAR2,c_data out  sys_refcursor)
            _scmDataset = new DataSet();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataSet tblDet = QueryDataSet("EMS_INT_HDR", "sp_getinventoryheader", CommandType.StoredProcedure, false, param);
            oAdapter.Fill(_scmDataset, "EMS_INT_HDR");
        }

        public void GetInventorySerial(string _document)
        {
            //sp_getserialdetail(p_document in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataSet tblDet = QueryDataSet("EMS_INT_SER", "sp_getserialdetail", CommandType.StoredProcedure, false, param);
            oAdapter.Fill(_scmDataset, "EMS_INT_SER");
        }

        public DataTable GetItemTaxData(string _com, string _cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBrand = QueryDataTable("tblrecdiv", "sp_get_itm_tax", CommandType.StoredProcedure, false, param);
            return _tblBrand;
        }

        public DataTable GetSerialCompanyLocationAge(string _user, string _com, string _locCode)
        {
            // Wimal 05/08/2013
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locCode;
            // (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_serialage", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int16 UpdateRCCReqRaise(string _docno)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_INR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_upd_rcc_req", CommandType.StoredProcedure, param);
            return effects;
        }


        public DataTable GetDirectOutType(string _company)
        {
            //sp_getdirecttype(p_com in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirtype = QueryDataTable("tbldirtype", "sp_getdirecttype", CommandType.StoredProcedure, false, param);
            return _tbldirtype;
        }

        public DataTable GetDirectStatus(string _company, string _type)
        {
            //sp_getdirectstatus(p_com in NVARCHAR2,p_dirtype in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_dirtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirstus = QueryDataTable("tbldirstus", "sp_getdirectstatus", CommandType.StoredProcedure, false, param);
            return _tbldirstus;
        }

        public DataTable GetSubLocation(string _company, string _location)
        {
            // sp_getsublocation(p_com in NVARCHAR2,p_loc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirstus = QueryDataTable("sp_getsublocation", "sp_getsublocation", CommandType.StoredProcedure, false, param);
            return _tbldirstus;
        }

        public DataTable GetLocationChannel(string _company, string _location)
        {
            //sp_getlocationchannel(p_com in NVARCHAR2,p_loc in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirstus = QueryDataTable("sp_getlocationcha", "sp_getlocationchannel", CommandType.StoredProcedure, false, param);
            return _tbldirstus;
        }

        public DataTable GetChannelPermission(string _maincd, string _cd, string _frmchnl, string _tochnl)
        {
            // sp_getchannelpermission(p_maincd in NVARCHAR2,p_cd in NVARCHAR2,p_frmchnl in NVARCHAR2,p_tochl in NVARCHAR2,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_maincd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maincd;
            (param[1] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            (param[2] = new OracleParameter("p_frmchnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _frmchnl;
            (param[3] = new OracleParameter("p_tochl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tochnl;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirstus = QueryDataTable("sp_getchannelperm", "sp_getchannelpermission", CommandType.StoredProcedure, false, param);
            return _tbldirstus;
        }

        public DataTable GetAllChannelForInventoryTracker(string _com, int _role)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_role", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _role;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirstus = QueryDataTable("sp_getchannelperm", "get_all_inv_channel", CommandType.StoredProcedure, false, param);
            return _tbldirstus;
        }

        public DataTable GetInventoryTrackerChannel(string _com, string _channel, int _role)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[2] = new OracleParameter("p_role", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _role;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbldirstus = QueryDataTable("sp_getchannelperm", "sp_get_inv_channel", CommandType.StoredProcedure, false, param);
            return _tbldirstus;
        }

        public DataTable CheckSerialByID(string _company, string _location, Int64 _serialid)
        {
            //sp_checkserialbyid(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_id in NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialid;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("sp_checkserialbyid", "sp_checkserialbyid", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public DataTable CheckSerialBySerial(string _company, string _location, string _item, string _serial)
        {
            //sp_checkserialbyserial(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_serial in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("sp_checkserialbyserial", "sp_checkserialbyserial", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public DataTable GetItemServiceSchedule(string _item)
        {
            //sp_checkserialbyserial(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_serial in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("sp_checkserialbyserial", "sp_get_itm_sev_det", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public Int32 DeleteRequestSerial(string _refno)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_delete_req_ser", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable Get_Reserved_Serials(string _company, string _location)//Chamal 12/09/2013
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_getreservedserials", CommandType.StoredProcedure, false, param); ;
        }

        public int Remove_Reserved_SerID(string _company, string _location, string _doc, int _serID)
        {
            //Chamal 13-Sep-2013
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[3] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serID;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_REMOVE_RES_SERID", CommandType.StoredProcedure, param);
        }

        public bool Check_Valid_Document(string _company, string _doc, string _docType)//Chamal 14/09/2013
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tbl", "SP_IS_VALID_DOC", CommandType.StoredProcedure, false, param);
            bool _isValid = false;
            if (_tbl != null)
            {
                if (_tbl.Rows.Count > 0)
                {
                    _isValid = true;
                }
            }

            return _isValid;
        }

        //darshana on 03-10-2013
        public DataTable Get_InterTrans_Req(string _company, string _user, string _reqTp, string _stus, DateTime _frmDt, DateTime _toDt, string _subTp)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_reqTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqTp;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt.Date;
            (param[5] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt.Date;
            (param[6] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subTp;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_searchintr_req", CommandType.StoredProcedure, false, param); ;
        }

        //darshana on 05-10-2013
        public int UpdateInventoryRequestStatusBulk(InventoryRequest _inventoryRequest)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            rows_effected = UpdateRecords("sp_update_intreqstatusbulk", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        public int UpdateWarrantyDetail(string _oldWarranty, string _newWarranty, DateTime _date, string _deliveryOrder)
        {
            //sp_updatewarrantydetail(p_oldwarranty in NVARCHAR2,p_do in NVARCHAR2,p_date in DATE,p_newwarranty in NVARCHAR2,o_effect out NUMBER) is
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_oldwarranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldWarranty;
            (param[1] = new OracleParameter("p_do", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _deliveryOrder;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_newwarranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newWarranty;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_updatewarrantydetail", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        //darshana on 09-10-2013
        public Int16 UpdateRCCCancelStatus(string _com, string _rccLoc, string _rccNo, string _stus, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccLoc;
            (param[2] = new OracleParameter("p_rccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccNo;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_rcccancel", CommandType.StoredProcedure, param);
            return effects;
        }

        public InventoryHeader GetRccAodOut(string _com, string _loc, string _docNo)
        {
            InventoryHeader _req = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getaodoutforrcc", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _req = DataTableExtensions.ToGenericList<InventoryHeader>(_dtResults, InventoryHeader.ConvertTotal)[0];
            }
            return _req;
        }

        public InventoryHeader GetRccAodIn(string _com, string _loc, string _Othdoc)
        {
            InventoryHeader _req = null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_othDoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Othdoc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_getaodinforrcc", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _req = DataTableExtensions.ToGenericList<InventoryHeader>(_dtResults, InventoryHeader.ConvertTotal)[0];
            }
            return _req;
        }

        public List<ReptPickSerials> GetInvoiceSerialForExchange(string _company, string _location, string _user, string _session, string _defBin, string _invoice, int _baseRefline)
        {
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _baseRefline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailforex_new", CommandType.StoredProcedure, false, param);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailforex", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);


                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = _row["its_fifo_dt"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["its_fifo_dt"];
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;


                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = _row["its_fifo_dt"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["its_fifo_dt"];
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }

        public DataTable CheckRequestAvailability(string _company, string _location, string _type, string _document)
        {
            //sp_checkrequest(p_com in NVARCHAR2,p_loc in NVARCHAR2, p_type in NVARCHAR2,p_document in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_checkrequest", CommandType.StoredProcedure, false, param);
        }

        public DataTable getDocDetByDocNo(string _company, string _location, string _docno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_get_detby_docno", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetExchangeInDocument(string _company, string _location, string _request)
        {
            // sp_getexchangereceivedoc(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_getexchangereceivedoc", CommandType.StoredProcedure, false, param);
        }

        public List<ReptPickSerials> GetLocationStockBalance(string _company, string _location)
        {
            List<ReptPickSerials> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_availble_stk_pc", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = new List<ReptPickSerials>();
                foreach (DataRow tr in _dtResults.Rows)
                {
                    _list.Add(SetReptPickSerials(tr));
                }
            }
            return _list;
        }

        public List<ReptPickSerials> GetLocationStockBalance(string _company, string _location, int _type)
        {
            List<ReptPickSerials> _list = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = 1;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_availble_stk_loc", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = new List<ReptPickSerials>();
                foreach (DataRow tr in _dtResults.Rows)
                {
                    _list.Add(SetReptPickSerials(tr));
                }
            }
            return _list;
        }

        public List<AuditStatus> GetAllAuditStstus(string _com)
        {
            List<AuditStatus> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_audit_stus", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditStatus>(_dtResults, AuditStatus.Converter);
            }
            return _list;
        }

        public List<AuditReportStatus> GetAllAuditReportStstus(string _com, string _mainCd)
        {
            List<AuditReportStatus> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainCd;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_rpt_stus", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditReportStatus>(_dtResults, AuditReportStatus.Converter);
            }
            return _list;
        }

        public Int16 SavePhysicalStockVerificationMain(PhsicalStockVerificationMain _main)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_ausm_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _main.Ausm_seq;
            (param[1] = new OracleParameter("p_ausm_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_job;
            (param[2] = new OracleParameter("p_ausm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_loc;
            (param[3] = new OracleParameter("p_ausm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Ausm_dt;
            (param[4] = new OracleParameter("p_ausm_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _main.Ausm_stus;
            (param[5] = new OracleParameter("p_ausm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_cre_by;
            (param[6] = new OracleParameter("p_ausm_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Ausm_cre_dt;
            (param[7] = new OracleParameter("p_ausm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_com;
            (param[8] = new OracleParameter("p_ausm_main_jb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_main_job;
            (param[9] = new OracleParameter("p_subjob_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_Subjob_Status;
            (param[10] = new OracleParameter("p_subjob_strdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Ausm_Subjob_Strdt;
            (param[11] = new OracleParameter("p_subjob_enddt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _main.Ausm_Subjob_Enddt;

            //Updated by akila 2017/04/28
            (param[12] = new OracleParameter("p_ausm_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_Mod_By;
            (param[13] = new OracleParameter("p_ausm_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _main.Ausm_Session_Id;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_aud_svr_main", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 SavePhysicalStockVerificationItem(PhysicalStockVerificationItem _item)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_ausi_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Ausi_seq;
            (param[1] = new OracleParameter("p_ausi_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Ausi_job;
            (param[2] = new OracleParameter("p_ausi_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Ausi_itm;
            (param[3] = new OracleParameter("p_ausi_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Ausi_stus;
            (param[4] = new OracleParameter("p_ausi_db_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Ausi_db_qty;
            (param[5] = new OracleParameter("p_ausi_ledger_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Ausi_ledger_qty;
            (param[6] = new OracleParameter("p_ausi_physical_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Ausi_physical_qty;
            (param[7] = new OracleParameter("p_ausi_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Ausi_cre_by;
            (param[8] = new OracleParameter("p_ausi_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.Ausi_cre_dt;
            (param[9] = new OracleParameter("p_ausi_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Ausi_desc;

            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_aud_svr_itm", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 SavePhysicalStockVerificationSerial(PhysicalStockVerificationSerial _serial)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_auss_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Auss_seq;
            (param[1] = new OracleParameter("p_auss_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_job;
            (param[2] = new OracleParameter("p_auss_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_item;
            (param[3] = new OracleParameter("p_auss_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_serial;
            (param[4] = new OracleParameter("p_auss_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_itm_stus;
            (param[5] = new OracleParameter("p_auss_in_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_in_doc;
            (param[6] = new OracleParameter("p_auss_in_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Auss_in_dt;
            (param[7] = new OracleParameter("p_auss_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_warranty;
            (param[8] = new OracleParameter("p_auss_ref_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_ref_stus;
            (param[9] = new OracleParameter("p_auss_rpt_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_rpt_type;
            (param[10] = new OracleParameter("p_auss_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_cre_by;
            (param[11] = new OracleParameter("p_auss_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Auss_cre_dt;
            (param[12] = new OracleParameter("p_auss_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_type;
            (param[13] = new OracleParameter("p_auss_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Auss_ser_id;
            (param[14] = new OracleParameter("p_auss_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Auss_rmk;
            (param[15] = new OracleParameter("p_auss_org_in_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.AUSS_ORG_IN_DT;

            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_aud_svr_serials", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdatePhysicalStockItem(PhysicalStockVerificationItem _itm)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ausi_job;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ausi_itm;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ausi_stus;
            (param[3] = new OracleParameter("p_led", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Ausi_ledger_qty;
            (param[4] = new OracleParameter("p_phy", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Ausi_physical_qty;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_aud_svr_itm", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 UpdatePhysicalStockItemNoStatus(PhysicalStockVerificationItem _itm)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ausi_job;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ausi_itm;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ausi_stus;
            (param[3] = new OracleParameter("p_led", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Ausi_ledger_qty;
            (param[4] = new OracleParameter("p_phy", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itm.Ausi_physical_qty;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_aud_svr_itm_nostatus", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<AuditRemark> GeatAuditRemarks(string _com, string _rptType)
        {
            List<AuditRemark> _list = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_rpt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rptType;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_rmk", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditRemark>(_dtResults, AuditRemark.Converter);
            }
            return _list;
        }

        public int SavePhysicalStockVerificationRemark(AuditRemarkValue _rmk)
        {
            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_ausv_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rmk.Ausv_id;
            (param[1] = new OracleParameter("p_ausv_job_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rmk.Ausv_job_seq;
            (param[2] = new OracleParameter("p_ausv_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_job;
            (param[3] = new OracleParameter("p_ausv_rpt_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_rpt_cd;
            (param[4] = new OracleParameter("p_ausv_val", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_val;
            (param[5] = new OracleParameter("p_ausv_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_cre_by;
            (param[6] = new OracleParameter("p_ausv_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rmk.Ausv_cre_dt;
            (param[7] = new OracleParameter("p_ausv_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_itm;
            (param[8] = new OracleParameter("p_ausv_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_itm_stus;
            (param[9] = new OracleParameter("p_ausv_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rmk.Ausv_line;
            (param[10] = new OracleParameter("P_ausv_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rmk.Ausv_ser_id;
            (param[11] = new OracleParameter("P_ausv_rpt_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_rpt_stus;

            //Add by Akila 2017/04/28
            (param[12] = new OracleParameter("p_ausv_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_Mod_By;
            (param[13] = new OracleParameter("p_ausv_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmk.Ausv_Session_Id;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_audit_rmk", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<PhysicalStockVerificationSerial> GetPhysicalLedgerSerials(string _com, string _loc, string _job, string _itm, string _stus, string _type)
        {
            List<PhysicalStockVerificationSerial> _list = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            (param[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;

            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[5] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_led_phy_ser", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PhysicalStockVerificationSerial>(_dtResults, PhysicalStockVerificationSerial.Converter);
            }
            return _list;
        }

        public List<PhysicalStockVerificationItem> GetPhysicalVerificationItems(string _jobNo)
        {
            List<PhysicalStockVerificationItem> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_stk_det", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PhysicalStockVerificationItem>(_dtResults, PhysicalStockVerificationItem.Converter);
            }
            return _list;
        }

        public List<PhysicalStockVerificationSerial> GetPhysicalVerificationSerials(string _jobNo)
        {
            List<PhysicalStockVerificationSerial> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_stk_ser", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PhysicalStockVerificationSerial>(_dtResults, PhysicalStockVerificationSerial.Converter);
            }
            return _list;
        }

        public DataTable GetWarrantySearch(string _company, string _serial1, string _serial2, string _warranty, string _invoice, string _acc)
        {
            //sp_getwarrantysearch(p_com in NVARCHAR2,p_serial1 in NVARCHAR2,p_serial2 in NVARCHAR2,p_warranty in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_serial1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[2] = new OracleParameter("p_serial2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[5] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getwarrantysearch", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetReservationDet(string _company, string _resNo, string _item, string _status)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_res", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resNo;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getReservation", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetDelivery(string _company, string _item, string _serial, string _warranty, string _invoice)
        {
            //sp_getdelvieryfromserial(p_com in NVARCHAR2, p_item in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[4] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getdelvieryfromserial", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public int UpdateWarrnanty(string _newwarra, string _oldwarra, int remain)
        {
            //sp_updatewaranty(p_newwarano in NVARCHAR2,p_oldwarano in NVARCHAR2,p_remainperd in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_newwarano", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newwarra;
            (param[1] = new OracleParameter("p_oldwarano", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldwarra;
            (param[2] = new OracleParameter("p_remainperd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = remain;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updatewaranty", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<ReptPickSerials> GetSerialsByDocument(Int32 _seqNo, string _docNo)
        {
            List<ReptPickSerials> _sers = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblMovSerials = QueryDataTable("tblMovSerials", "sp_getintser", CommandType.StoredProcedure, false, param);
            if (_tblMovSerials.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblMovSerials.Rows)
                {
                    ReptPickSerials _one = new ReptPickSerials();
                    _one.Tus_base_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                    _one.Tus_base_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                    _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                    _one.Tus_cre_dt = System.DateTime.Now;
                    _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                    _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                    _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                    _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                    _one.Tus_doc_dt = System.DateTime.Now.Date;
                    _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                    _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                    _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                    _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                    _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                    _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                    //  _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                    _one.Tus_unit_price = Convert.ToDecimal(_row["its_unit_cost"]);
                    _one.Tus_loc = (String)_row["its_loc"];
                    _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                    _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                    _one.Tus_new_remarks = String.Empty;
                    _one.Tus_new_status = String.Empty;
                    _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                    _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                    _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                    _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                    _one.Tus_out_date = DateTime.Now.Date;
                    _one.Tus_qty = 1;
                    _one.Tus_seq_no = 0;
                    _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                    _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                    _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                    _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                    _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                    _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                    _one.Tus_serial_id = "1";
                    _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                    _one.Tus_usrseq_no = -1;
                    _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                    _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                    if (string.IsNullOrEmpty(_row["ITS_AGELOC"].ToString()))
                    { _one.Tus_ageloc = _one.Tus_loc; }
                    else
                    { _one.Tus_ageloc = _row["ITS_AGELOC"].ToString(); }
                    if (string.IsNullOrEmpty(_row["ITS_AGELOC_DT"].ToString()))
                    { _one.Tus_ageloc_dt = _one.Tus_doc_dt; }
                    else
                    { _one.Tus_ageloc_dt = Convert.ToDateTime(_row["ITS_AGELOC_DT"].ToString()).Date; }

                    if (string.IsNullOrEmpty(_row["ITS_ISOWNMRN"].ToString()))
                    { _one.Tus_isownmrn = 0; }
                    else
                    { _one.Tus_isownmrn = Convert.ToInt32(_row["ITS_ISOWNMRN"].ToString()); }
                    _sers.Add(_one);
                    //_sers = DataTableExtensions.ToGenericList<ReptPickSerials>(_tblMovSerials, ReptPickSerials.ConvertTotal);
                }
            }

            return _sers;
        }

        public int PhysicalStockUpdateItemCount(string _job, string _itm, string _stus, int _type, int _qty)
        {
            //sp_updatewaranty(p_newwarano in NVARCHAR2,p_oldwarano in NVARCHAR2,p_remainperd in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[3] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("p_amo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _qty;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_aud_stk_qty", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetServiceRequest(string _company, string _warranty)
        {
            //sp_getservicedoc(p_com in NVARCHAR2, p_warranty in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "sp_getservicedoc", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public Int32 UpdateExchangeWarranty(string _warranty, string _docno, Int32 _period, string _invoice, DateTime _invdate, DateTime _start, string _status, string _customer, string _name, string _address, string _tel)
        {
            //sp_updateexchangewaranty(p_newwarranty in NVARCHAR2,p_adjno in NVARCHAR2,
            //p_remainperiod in NUMBER,p_invoice in NVARCHAR2,p_invdate in date, p_start in date,p_status in NVARCHAR2,
            //p_customer in NVARCHAR2,p_name in NVARCHAR2,p_address in NVARCHAR2,p_tel in NVARCHAR2,o_effect out NUMBER )

            int _effect = 0;
            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_newwarranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warranty;
            (param[1] = new OracleParameter("p_adjno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_remainperiod", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _period;
            (param[3] = new OracleParameter("p_invoice", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[4] = new OracleParameter("p_invdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _invdate.Date;
            (param[5] = new OracleParameter("p_start", OracleDbType.Date, null, ParameterDirection.Input)).Value = _start.Date;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[8] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _name;
            (param[9] = new OracleParameter("p_address", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _address;
            (param[10] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tel;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_updateexchangewaranty", CommandType.StoredProcedure, param);

            return _effect;
        }

        public DataTable GetExchangeWara(string _request)
        {
            //getexchangewara(p_reqno in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tbl", "getexchangewara", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetGRANQtySummary(string _com, string _loc, string _type, string _from, string _to, string _stus, string _cre, string _item, string _serial)
        {
            //sp_getgranqty( p_com IN NVARCHAR2, p_loc in NVARCHAR2, p_type in NVARCHAR2, p_fromDate in NVARCHAR2, p_toDate in NVARCHAR2, p_status in NVARCHAR2, p_createdBy in  NVARCHAR2, P_item in NVARCHAR2, p_seraila in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _to;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[6] = new OracleParameter("p_createdBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cre;
            (param[7] = new OracleParameter("P_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[8] = new OracleParameter("p_seraila", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("QtySummary", "sp_getgranqty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 UpdateAuditStockStus(string _job, int _stus)
        {
            //getexchangewara(p_reqno in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_update_aud_svr_main", CommandType.StoredProcedure, param);
        }

        public Int16 UpdateInventoryAutoNumber(InventoryHeader _inventoryMovementHeader, MasterAutoNumber _masterAutoNumber, String _locaSeparater, out string _docNo)
        {
            Int16 effect = 0;
        nx:
            Int32 _autoNo = GetAutoNumber(_masterAutoNumber.Aut_moduleid, _masterAutoNumber.Aut_direction, _masterAutoNumber.Aut_start_char, _masterAutoNumber.Aut_cate_tp, _masterAutoNumber.Aut_cate_cd, _masterAutoNumber.Aut_modify_dt, _masterAutoNumber.Aut_year).Aut_number;
            string _documentNo = _inventoryMovementHeader.Ith_loc + _locaSeparater + _masterAutoNumber.Aut_start_char + "-" + Convert.ToString(_inventoryMovementHeader.Ith_doc_date.Date.Year).Remove(0, 2) + "-" + _autoNo.ToString("00000", CultureInfo.InvariantCulture);
            effect = UpdateAutoNumber(_masterAutoNumber);

            if (CheckInventoryNo("sp_getmovno", "p_doc_no", _documentNo) == 1)
            {
                //Check Save Movement Document No :: Code by Chamal De Silva 31/01/2013
                goto nx;
            }

            effect = UpdateMovementDocNo(_inventoryMovementHeader.Ith_seq_no, _documentNo);
            _docNo = _documentNo;
            return effect;
        }

        public List<InventoryCostRate> GetInventoryCostRate(string _com, string _type, string _stus, int _pd, string _oriStus)
        {
            List<InventoryCostRate> _list = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[3] = new OracleParameter("p_ori_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oriStus;
            (param[4] = new OracleParameter("p_pd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pd;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblMovSerials = QueryDataTable("tblMovSerials", "sp_get_cost_rt", CommandType.StoredProcedure, false, param);
            if (_tblMovSerials.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryCostRate>(_tblMovSerials, InventoryCostRate.Converter);
            }

            return _list;
        }

        public DataTable IsUserEntryExist(string _company, string _item, string _type, string _value)
        {
            //sp_checkuserentry(p_com in NVARCHAR2,p_item in NVARCHAR2, p_type in NVARCHAR2,p_value in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _value;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("CHKUSERENTRY", "sp_checkuserentry", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateAcknowledgment(string _company, string _location, string _rcc, string _ackno)
        {
            // sp_updateaknowledgement(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_rcc in NVARCHAR2,p_ack in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_rcc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc;
            (param[3] = new OracleParameter("p_ack", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ackno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updateaknowledgement", CommandType.StoredProcedure, param);
        }

        private ReptPickSerials Convert_INT_SerwoBatch(DataRow _tr, string _rvtno, string _accno)
        {
            ReptPickSerials _pick = new ReptPickSerials();
            _pick.Tus_batch_line = Convert.ToInt32(_tr["ITS_BATCH_LINE"]);
            _pick.Tus_bin = Convert.ToString(_tr["ITS_BIN"]);
            _pick.Tus_com = Convert.ToString(_tr["ITS_COM"]);
            _pick.Tus_cre_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_no = Convert.ToString(_tr["ITS_DOC_NO"]);
            _pick.Tus_exist_grncom = Convert.ToString(_tr["ITS_EXIST_GRNCOM"]);
            _pick.Tus_exist_grndt = Convert.ToDateTime(_tr["ITS_EXIST_GRNDT"]);
            _pick.Tus_exist_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_exist_supp = Convert.ToString(_tr["ITS_EXIST_SUPP"]);
            _pick.Tus_itm_cd = Convert.ToString(_tr["ITS_ITM_CD"]);
            _pick.Tus_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);
            _pick.Tus_itm_stus = Convert.ToString(_tr["ITS_ITM_STUS"]);
            _pick.Tus_loc = Convert.ToString(_tr["ITS_LOC"]);//not sure
            _pick.Tus_orig_grncom = Convert.ToString(_tr["ITS_ORIG_GRNCOM"]);
            _pick.Tus_orig_grndt = Convert.ToDateTime(_tr["ITS_ORIG_GRNDT"]);
            _pick.Tus_orig_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_orig_supp = Convert.ToString(_tr["ITS_ORIG_SUPP"]);
            _pick.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure
            _pick.Tus_seq_no = Convert.ToInt32(_tr["ITS_SEQ_NO"]);
            _pick.Tus_ser_1 = Convert.ToString(_tr["ITS_SER_1"]);
            _pick.Tus_ser_2 = Convert.ToString(_tr["ITS_SER_2"]);
            _pick.Tus_ser_3 = Convert.ToString(_tr["ITS_SER_3"]);
            _pick.Tus_ser_4 = Convert.ToString(_tr["ITS_SER_4"]);
            _pick.Tus_ser_id = Convert.ToInt32(_tr["ITS_SER_ID"]);
            _pick.Tus_ser_line = Convert.ToInt32(_tr["ITS_SER_LINE"]);
            // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
            _pick.Tus_unit_cost = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            _pick.Tus_unit_price = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
            _pick.Tus_warr_no = Convert.ToString(_tr["ITS_WARR_NO"]);
            _pick.Tus_warr_period = Convert.ToInt32(_tr["ITS_WARR_PERIOD"]);
            _pick.Tus_new_status = string.Empty;
            _pick.Tus_base_doc_no = _rvtno;
            _pick.Tus_base_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);

            if (string.IsNullOrEmpty(_tr["ITS_AGELOC"].ToString()))
            { _pick.Tus_ageloc = _pick.Tus_loc; }
            else
            { _pick.Tus_ageloc = _tr["ITS_AGELOC"].ToString(); }
            if (string.IsNullOrEmpty(_tr["ITS_AGELOC_DT"].ToString()))
            { _pick.Tus_ageloc_dt = _pick.Tus_doc_dt; }
            else
            { _pick.Tus_ageloc_dt = Convert.ToDateTime(_tr["ITS_AGELOC_DT"].ToString()).Date; }

            if (string.IsNullOrEmpty(_tr["ITS_ISOWNMRN"].ToString()))
            { _pick.Tus_isownmrn = 0; }
            else
            { _pick.Tus_isownmrn = Convert.ToInt32(_tr["ITS_ISOWNMRN"].ToString()); }

            //Added Prabhath on 11/08/2012
            MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);
            _pick.Tus_itm_desc = _item.Mi_longdesc;
            _pick.Tus_itm_model = _item.Mi_model;
            _pick.Tus_itm_brand = _item.Mi_brand;

            return _pick;
        }

        public List<ReptPickSerials> GetAdjustmentDetailFromRvtintser(string _company, string _accountno, string _revertno)
        {
            //sp_getadjustmentfromret(p_com in NVARCHAR2,p_account in NVARCHAR2,p_revertno in NVARCHAR2,c_data out sys_refcursor) is
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accountno;
            (param[2] = new OracleParameter("p_revertno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revertno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblInventoryRequestItemData", "sp_getadjustmentfromret", CommandType.StoredProcedure, false, param);

            foreach (DataRow tr in _dtResults.Rows)
            {
                _list.Add(Convert_INT_SerwoBatch(tr, _revertno, _accountno));
            }

            return _list;
        }

        public List<AuditRemarkValue> GetPhicalStockRemark(string _jobNo)
        {
            List<AuditRemarkValue> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_stk_rmk", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<AuditRemarkValue>(_dtResults, AuditRemarkValue.Converter);
            }
            return _list;
        }

        public int PhyscilStockRemoveRmk(string _job, int _serialId, int _line)
        {
            //getexchangewara(p_reqno in NVARCHAR2, c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[1] = new OracleParameter("p_serId", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialId;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_del_aud_rmk", CommandType.StoredProcedure, param);
        }

        public DataTable CheckCompanyMulti(string _company)
        {
            //sp_checkmul(p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_checkmul", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2017-03-10
        public DataTable check_IsItemAvailable(string _item, string _serial)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("in_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            DataTable _dtResults = QueryDataTable("tbl", "sp_check_serial_available", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written by Darshana (transferred Darshana's PC to Prabhath PC and Checked-In)
        public Int32 UpdateLocationRes(string _company, string _location, string _item, string _stus, string _user, decimal _qty)
        {
            // sp_updateaknowledgement(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_rcc in NVARCHAR2,p_ack in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updatelocres", CommandType.StoredProcedure, param);
        }

        //Written by Prabhath on 12/12/2013
        public Int32 UpdateLocationResRevers(string _company, string _location, string _item, string _stus, string _user, decimal _qty)
        {
            // sp_updatelocresrev( p_com in NVARCHAR2,p_loc in NVARCHAR2,p_itm in NVARCHAR2,p_stus in NVARCHAR2,p_usr in NVARCHAR2,p_qty in DECIMAL,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updatelocresrev", CommandType.StoredProcedure, param);
        }

        //Written by Prabhath on 12/12/2013
        public DataTable CheckQuotation(string _no, string _com)
        {
            //sp_checkquotation(p_no in NVARCHAR2,p_com in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_checkquotation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdateInvoiceAutoNumber(MasterAutoNumber _auto)
        {
            //SP_UPDATEAUTOINVOICE(p_module in NVARCHAR2,p_direct in NUMBER,p_startchar in NVARCHAR2,p_cattp in NVARCHAR2,p_catcd in NVARCHAR2,p_year in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_moduleid;
            (param[1] = new OracleParameter("p_direct", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _auto.Aut_direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_start_char;
            (param[3] = new OracleParameter("p_cattp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_cate_tp;
            (param[4] = new OracleParameter("p_catcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auto.Aut_cate_cd;
            (param[5] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _auto.Aut_year;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _effect = 0;

            _effect = (Int32)UpdateRecords("SP_UPDATEAUTOINVOICE", CommandType.StoredProcedure, param);

            return _effect;
        }

        //SP - Written by Sachith
        //Function Written by Prabhath on 17/12/2013
        public decimal GetLatestCost(string _company, string _location, string _item, string _status)
        {
            //sp_get_dp_latest_cost   (p_com in NVARCHAR2, p_loc in  NVARCHAR2, p_itm in NVARCHAR2,   p_stus in NVARCHAR2,   p_cost out number   )
            OracleParameter[] param = new OracleParameter[4];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            OracleParameter _outParam = new OracleParameter("p_cost", OracleDbType.Decimal, null, ParameterDirection.Output);
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_get_dp_latest_cost", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        public DataTable GetPartyConnection(string _company, string _party)
        {
            //sp_getpartyconnection(p_com in NVARCHAR2,p_ptycode in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ptycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _party;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getpartyconnection", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<InventorySerialRefN> GetSerialByID(string _serId, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            List<InventorySerialRefN> _list = null;
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serId;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_serialbyId", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialRefN>(_dtResults, InventorySerialRefN.Converter);
            }
            return _list;
        }

        public DataTable GetAODItem(string _document)
        {
            //sp_getaoditem(p_document in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getaoditem", "sp_getaoditem", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int UpdateAODRequestItem(string _document, string _item, string _status, decimal _qty)
        {
            //sp_updaterequestitem(p_document in NVARCHAR2, p_item in NVARCHAR2,p_status in NVARCHAR2,p_qty in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_document", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updaterequestitem", CommandType.StoredProcedure, param);
        }

        public int UpdateAODOUTPickItem(string _document, Int32 _serialid)
        {
            //sp_updateaodinpick(p_docment in NVARCHAR2,p_serialid in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_docment", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[1] = new OracleParameter("p_serialid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialid;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updateaodinpick", CommandType.StoredProcedure, param);
        }

        public int UpdateAODOUT(string _company, string _document)
        {
            //sp_updateaodout(p_com in NVARCHAR2,p_doc in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updateaodout", CommandType.StoredProcedure, param);
        }

        public int UpdateAODInNoInJob(string _jobNo, string _aodOutNo, string _aodInNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[1] = new OracleParameter("p_aodout", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodOutNo;
            (param[2] = new OracleParameter("p_aodin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodInNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updateaodinjob", CommandType.StoredProcedure, param);
        }

        //Written By sachith on 02/Jan/2014
        public Int16 UpdateBatchRefDoc(string _docNo, string _invNo)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_update_batch_ref", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        //sachith 2014/01/13
        public DataTable GetMasterFactor(string _com, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getaoditem", "sp_get_fac", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 2014/01/24
        public DataTable Get_Item_Infor(string _itemCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl_item", "GET_ITEM_INFOR", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 2014/Feb/04
        public DataTable Get_Actual_FIFO_Serial(string _com, string _loc, string _item, string _itemstatus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_serial", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetOnlinePayment(string _com, string _status, string _tp, DateTime _from, DateTime _to)
        {
            //sp_getonlinepayment(p_com in NVARCHAR2,p_status in NVARCHAR2,p_tp in NVARCHAR2,p_dtfrom in date,p_todt in date ,c_data out sys_refcursor) is
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            (param[3] = new OracleParameter("p_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from.Date;
            (param[4] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to.Date;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getonlinepayment", "sp_getonlinepayment", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetSerialIDByJob(string _job, string _item)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_get_serid_byjob", "sp_get_serid_byjob", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public Int32 UpdateOnlinePayment(string _com, string _pc, string _ref, string _status, string _user, string _recno)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[7];
            //sp_updateonlinestatus(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2,p_user in NVARCHAR2,p_recno,o_effect out NUMBER) is
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_updateonlinestatus", CommandType.StoredProcedure, param);
            return (Int32)effected;
        }

        //Chamal 2014/Feb/09
        public DataTable Get_Actual_FIFO_NonSerials(string _com, string _loc, string _item, string _itemstatus, string _jobno, int _jobline, Int16 _isExpDate, DateTime _expdate, string BIN)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_isexpdt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExpDate;
            (param[5] = new OracleParameter("p_expdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expdate.Date;
            (param[6] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;
            (param[7] = new OracleParameter("p_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobline;
            (param[8] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BIN; // THaraka 2015-12-16
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_nonserial", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_nonserialnew", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Check_Batch_Balance(int _p_val)
        {
            //Chamal 03-Sep-2015
            int effected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _p_val;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_chk_batch_stock", CommandType.StoredProcedure, param);
            return (Int32)effected;
        }

        public DataTable GetAOACollection(string _com, string _pc, DateTime _frmDt, DateTime _toDt)
        {
            //sp_getaoacollection(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_frmdt in date,p_todt in date,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt.Date;
            (param[3] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt.Date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getaoacollection", "sp_getaoacollection", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetLocationTransaction(string _com, string _loc)
        {
            //sp_getlocationtrans(p_frmcom in NVARCHAR2,p_fromloc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_frmcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getlocationtrans", "sp_getlocationtrans", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetDocument()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getintcdocument", "sp_getintcdocument", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int InserLogLocaTrans(string _fromcom, string _fromloc, string _tocom, string _tocat, int _allow, string _user)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[7];
            //p_frm_com in NVARCHAR2 , p_frm_loc  in NVARCHAR2, p_to_com  in NVARCHAR2, p_to_cat  in NVARCHAR2, p_allow  in NUMBER, p_cre_by  in NVARCHAR2,o_effect out number
            (param[0] = new OracleParameter("p_frm_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromcom;
            (param[1] = new OracleParameter("p_frm_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[2] = new OracleParameter("p_to_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tocom;
            (param[3] = new OracleParameter("p_to_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tocat;
            (param[4] = new OracleParameter("p_allow", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _allow;
            (param[5] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_insertlogloctrans", CommandType.StoredProcedure, param);
            return (Int32)effected;
        }

        public DataTable GetAccountStatus(string _company, string _profitcenter, string _account)
        {
            //sp_checkaccclose(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_acc in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_checkaccclose", "sp_checkaccclose", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        #region New Company Transfer Process :: 18-Mar-2014 :: Chamal De Silva

        public DataTable GetPriceBookLevel(string _com, string _pbook, string _itemstatus)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            (param[2] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblLoc", "sp_getpblvlcode", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetTransferLocs(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblLoc", "sp_gettransferlocs", CommandType.StoredProcedure, false, param);
        }

        public List<ReptPickSerials> GetTransferSerials(string _com, string _loc, Int16 _isCons, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_is_cons", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isCons;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSer", "sp_gettransserials", CommandType.StoredProcedure, false, param);

            int _lineNo = 0;
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();

            foreach (DataRow dtRow in dt.Rows)
            {
                ReptPickSerials _reptSerial = new ReptPickSerials();
                DateTime _date = Convert.ToDateTime(DateTime.Now.Date).Date;
                _lineNo = _lineNo + 1;

                _reptSerial.Tus_cre_by = _user;
                _reptSerial.Tus_usrseq_no = 1;
                _reptSerial.Tus_cre_by = _user;
                _reptSerial.Tus_base_doc_no = _loc + "-0000001";
                _reptSerial.Tus_base_itm_line = _lineNo;
                _reptSerial.Tus_itm_desc = Convert.ToString(dtRow["MI_LONGDESC"]);
                _reptSerial.Tus_itm_model = Convert.ToString(dtRow["MI_MODEL"]);
                _reptSerial.Tus_itm_brand = Convert.ToString(dtRow["MI_BRAND"]);
                _reptSerial.Tus_batch_line = Convert.ToInt32(dtRow["INS_BATCH_LINE"]);
                _reptSerial.Tus_new_remarks = Convert.ToString(dtRow["MI_ITM_UOM"]);
                _reptSerial.Tus_bin = Convert.ToString(dtRow["INS_BIN"]);
                _reptSerial.Tus_com = Convert.ToString(dtRow["INS_COM"]);
                _reptSerial.Tus_cre_dt = _date;
                _reptSerial.Tus_doc_dt = Convert.ToDateTime(dtRow["INS_DOC_DT"]);
                _reptSerial.Tus_doc_no = Convert.ToString(dtRow["INS_DOC_NO"]);
                _reptSerial.Tus_exist_grncom = Convert.ToString(dtRow["INS_EXIST_GRNCOM"]);
                _reptSerial.Tus_exist_grndt = Convert.ToDateTime(dtRow["INS_EXIST_GRNDT"]).Date;
                _reptSerial.Tus_exist_grnno = Convert.ToString(dtRow["INS_EXIST_GRNNO"]);
                _reptSerial.Tus_exist_supp = Convert.ToString(dtRow["INS_EXIST_SUPP"]);
                _reptSerial.Tus_itm_cd = Convert.ToString(dtRow["INS_ITM_CD"]);
                _reptSerial.Tus_itm_line = Convert.ToInt32(dtRow["INS_ITM_LINE"]);
                _reptSerial.Tus_itm_stus = Convert.ToString(dtRow["INS_ITM_STUS"]);
                _reptSerial.Tus_loc = Convert.ToString(dtRow["INS_LOC"]);
                _reptSerial.Tus_orig_grncom = Convert.ToString(dtRow["INS_ORIG_GRNCOM"]);
                _reptSerial.Tus_orig_grndt = Convert.ToDateTime(dtRow["INS_ORIG_GRNDT"]);
                _reptSerial.Tus_orig_grnno = Convert.ToString(dtRow["INS_ORIG_GRNNO"]);
                _reptSerial.Tus_orig_supp = Convert.ToString(dtRow["INS_ORIG_SUPP"]);
                _reptSerial.Tus_qty = 1;
                _reptSerial.Tus_seq_no = Convert.ToInt32(dtRow["INS_SEQ_NO"]);
                _reptSerial.Tus_ser_1 = Convert.ToString(dtRow["INS_SER_1"]);
                _reptSerial.Tus_ser_2 = Convert.ToString(dtRow["INS_SER_2"]);
                _reptSerial.Tus_ser_3 = Convert.ToString(dtRow["INS_SER_3"]);
                _reptSerial.Tus_ser_4 = Convert.ToString(dtRow["INS_SER_4"]);
                _reptSerial.Tus_ser_id = Convert.ToInt32(dtRow["INS_SER_ID"]);
                _reptSerial.Tus_ser_line = Convert.ToInt32(dtRow["INS_SER_LINE"]);
                _reptSerial.Tus_session_id = Convert.ToString(dtRow["MI_IS_SER1"]);//Serialized-1, Non-Serialized-0, Decimal-(-1)
                _reptSerial.Tus_unit_cost = Convert.ToDecimal(dtRow["INS_UNIT_COST"]);
                _reptSerial.Tus_unit_price = Convert.ToDecimal(dtRow["INS_UNIT_PRICE"]);
                _reptSerial.Tus_warr_no = Convert.ToString(dtRow["INS_WARR_NO"]);
                _reptSerial.Tus_warr_period = Convert.ToInt32(dtRow["INS_WARR_PERIOD"]);

                if (string.IsNullOrEmpty(dtRow["INS_AGELOC"].ToString()))
                { _reptSerial.Tus_ageloc = _reptSerial.Tus_loc; }
                else
                { _reptSerial.Tus_ageloc = dtRow["INS_AGELOC"].ToString(); }
                if (string.IsNullOrEmpty(dtRow["INS_AGELOC_DT"].ToString()))
                { _reptSerial.Tus_ageloc_dt = _reptSerial.Tus_doc_dt; }
                else
                { _reptSerial.Tus_ageloc_dt = Convert.ToDateTime(dtRow["INS_AGELOC_DT"].ToString()).Date; }

                if (string.IsNullOrEmpty(dtRow["INS_ISOWNMRN"].ToString()))
                { _reptSerial.Tus_isownmrn = 0; }
                else
                { _reptSerial.Tus_isownmrn = Convert.ToInt32(dtRow["INS_ISOWNMRN"].ToString()); }

                _reptPickSerials.Add(_reptSerial);
            }
            return _reptPickSerials;
        }

        public int SaveTransferNoPriceLog(string _com, string _loc, string _item, string _serial, string _itemStatus, decimal _unitCost)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[4] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemStatus;
            (param[5] = new OracleParameter("p_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _unitCost;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_insert_trns_itm_no_price", CommandType.StoredProcedure, param);
        }

        public int SaveTransferLocStatusLog(string _com, string _loc, int _invc, int _do, int _po, int _grn)
        {
            ConnectionOpen();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_invoice_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invc;
            (param[3] = new OracleParameter("p_do_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _do;
            (param[4] = new OracleParameter("p_po_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _po;
            (param[5] = new OracleParameter("p_grn_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _grn;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int _eff = UpdateRecords("sp_update_trns_loc_log", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        #endregion

        public DataTable GetSupplier(string _company, string _supplier)
        {
            //sp_getsupplier(p_com in NVARCHAR2,p_code in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getsupplier", "sp_getsupplier", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetPOLine(string _company, string _location, string _doc, Int32 _sid)
        {
            //sp_getBatch(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_doc in NVARCHAR2,p_sid IN NUMBER,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[3] = new OracleParameter("p_sid", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _sid;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getBatch", "sp_getBatch", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetInvoiceDet(string _company, string _do)
        {
            //sp_getinvoicedet(p_com in NVARCHAR2,p_do in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_do", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _do;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getinvoicedet", "sp_getinvoicedet", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal  29-04-2014
        public DataTable GetSCMInvoiceDet(string _company, string _do)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_do", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _do;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getscminvoicedet", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetFinishGoodCost(string _item)
        {
            //sp_getfinishgoodcost (p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sp_getfinishgoodcost", "sp_getfinishgoodcost", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 23-May-2014
        public bool IsChangeGRNDate(string _DOCom, string _GRNCom)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOCom;
            (param[1] = new OracleParameter("p_tcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _GRNCom;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_chk_grn_dt_reset", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            { return true; }
            else
            { return false; }
        }

        //Chamal 27-May-2013
        public bool Is_Serial_Can_Remove(string _company, string _doc, string _docType, string _item, string _serial1)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docType;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tbl", "sp_chk_serial_remove", CommandType.StoredProcedure, false, param);
            bool _isValid = true;
            if (_tbl != null)
            {
                if (_tbl.Rows.Count > 0) _isValid = false;
            }
            return _isValid;
        }

        #region SCM Movment Table Inserts :: Chamal 19-Jul-2014

        public int Save_Mov_Hdr(ScmMovHeader _scmMovHdr)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[29];
            (param[0] = new OracleParameter("p_yearseqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Year_seq_no;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Loca;
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Doc_no;
            (param[3] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovHdr.Year;
            (param[4] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Doc_type;
            (param[5] = new OracleParameter("p_otherdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Other_doc_no;
            (param[6] = new OracleParameter("p_docdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scmMovHdr.Doc_date.Date;
            (param[7] = new OracleParameter("p_otherloca", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Other_loca;
            (param[8] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Entry_no;
            (param[9] = new OracleParameter("p_docstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Doc_status;
            (param[10] = new OracleParameter("p_Appby1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.App_by_1;
            (param[11] = new OracleParameter("p_Appby2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.App_by_2;
            (param[12] = new OracleParameter("p_Appby3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.App_by_3;
            (param[13] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.User;
            (param[14] = new OracleParameter("p_manualrefno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Manual_ref_no;
            (param[15] = new OracleParameter("p_docsubtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Doc_sub_type;
            (param[16] = new OracleParameter("p_entrytype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Entry_type;
            (param[17] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Company;
            (param[18] = new OracleParameter("p_suppcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Supplier_code;
            (param[19] = new OracleParameter("p_currencycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Currency_code;
            (param[20] = new OracleParameter("p_exchangerate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovHdr.Exchange_rate;
            (param[21] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Remarks;
            (param[22] = new OracleParameter("p_vehicleno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Vehicle_no;
            (param[23] = new OracleParameter("p_invdirection", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Inv_direction;
            (param[24] = new OracleParameter("p_channelcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Channel_code;
            (param[25] = new OracleParameter("p_costprofitcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Cost_profit_code;
            (param[26] = new OracleParameter("p_deladd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Del_add1;
            (param[27] = new OracleParameter("p_deladd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovHdr.Del_add2;
            param[28] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_save_scm_mhdr", CommandType.StoredProcedure, param);
            return (int)effected;
        }

        public int Save_Mov_Itm(ScmMovItem _scmMovItm)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_yearseqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Year_seq_no;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Loca;
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Doc_no;
            (param[3] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovItm.Line;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Item_code;
            (param[5] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Item_status;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovItm.Qty;
            (param[7] = new OracleParameter("p_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Uom;
            (param[8] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.User;
            (param[9] = new OracleParameter("p_unitprice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovItm.Unit_price;
            (param[10] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Cate1;
            (param[11] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Cate2;
            (param[12] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Cate3;
            (param[13] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Brand;
            (param[14] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovItm.Model;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_save_scm_mitm", CommandType.StoredProcedure, param);
            return (int)effected;
        }

        public int Save_Mov_Cost(ScmMovCost _scmMovCost)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[28];
            (param[0] = new OracleParameter("p_yearseqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Year_seq_no;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Loca;
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Doc_no;
            (param[3] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovCost.Line;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Item_code;
            (param[5] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Item_status;
            (param[6] = new OracleParameter("p_unitcost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovCost.Unit_cost;
            (param[7] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovCost.Qty;
            (param[8] = new OracleParameter("p_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Uom;
            (param[9] = new OracleParameter("p_scmdocinno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Scmdocinno;
            (param[10] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Entryno;
            (param[11] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.User;
            (param[12] = new OracleParameter("p_docindate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scmMovCost.Docindate;
            (param[13] = new OracleParameter("p_scminlineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovCost.Scminlineno;
            (param[14] = new OracleParameter("p_docitemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovCost.Docitemline;
            (param[15] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Company;
            (param[16] = new OracleParameter("p_tobonditemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Tobonditemcode;
            (param[17] = new OracleParameter("p_unitamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovCost.Qty * _scmMovCost.Unit_cost;
            (param[18] = new OracleParameter("p_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Cate1;
            (param[19] = new OracleParameter("p_cate2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Cate2;
            (param[20] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Cate3;
            (param[21] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Brand;
            (param[22] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Model;
            (param[23] = new OracleParameter("p_itemcodeorig", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovCost.Itemcodeorig;
            (param[24] = new OracleParameter("p_initmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovCost.Initmline;
            (param[25] = new OracleParameter("p_inbatchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovCost.Inbatchline;
            (param[26] = new OracleParameter("p_docbatchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovCost.Docbatchline;
            param[27] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_save_scm_mcost", CommandType.StoredProcedure, param);
            return (int)effected;
        }

        public int Save_Mov_Ser(ScmMovSerial _scmMovSer)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[22];
            (param[0] = new OracleParameter("p_yearseqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Year_seq_no;
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Loca;
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Doc_no;
            (param[3] = new OracleParameter("p_docdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scmMovSer.Docdate.Date;
            (param[4] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Bin;
            (param[5] = new OracleParameter("p_mcostlineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovSer.Mcostlineno;
            (param[6] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Item_code;
            (param[7] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Item_status;
            (param[8] = new OracleParameter("p_serialseqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovSer.Serialseqno;
            (param[9] = new OracleParameter("p_serno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Serno;
            (param[10] = new OracleParameter("p_chassisno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Chassisno;
            (param[11] = new OracleParameter("p_warrno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Warrno;
            (param[12] = new OracleParameter("p_unitcost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovSer.Unitcost;
            (param[13] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scmMovSer.Qty;
            (param[14] = new OracleParameter("p_docrefno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Docrefno;
            (param[15] = new OracleParameter("p_updatelineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovSer.Updatelineno;
            (param[16] = new OracleParameter("p_comindate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scmMovSer.Comindate.Date;
            (param[17] = new OracleParameter("p_cominno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Cominno;
            (param[18] = new OracleParameter("p_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Mfc;
            (param[19] = new OracleParameter("p_grna", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scmMovSer.Grna;
            (param[20] = new OracleParameter("p_doclineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scmMovSer.Doclineno;
            param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_save_scm_mser", CommandType.StoredProcedure, param);
            return (int)effected;
        }

        public string Get_SCM_LocAutoNo(string _loc, string _mod, DateTime _date, out int _number)
        {
            string _autoNo = string.Empty;
            int _num = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_auto_num_loc", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    foreach (DataRow _row in _dtResults.Rows)
                    {
                        //2014-DPS32-AOD-IN-L00001
                        //2014-RIT1-AOD-OUT-L04113
                        _autoNo = _date.Date.Year.ToString() + "-" + _row["LOCATION_CODE"].ToString() + "-" + _row["START_CHAR"].ToString() + _row["NUMBER_N"].ToString().PadLeft(5, '0');
                        _num = Convert.ToInt32(_row["NUMBER_N"].ToString());
                    }
                }
            }
            _number = _num;
            return _autoNo;
        }

        public int Update_SCM_LocAutoNo(string _loc, string _mod, int _number)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_number", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _number;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_update_auto_num_loc", CommandType.StoredProcedure, param);
            return (int)effected;
        }

        #endregion

        //Code by Chamal 22/Jul/2014
        public int Update_RCC_Cancel_BackDate(string _com, string _aod, string _rcc, string _job)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aod;
            (param[2] = new OracleParameter("p_rcc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc;
            (param[3] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_updaterccaodout", CommandType.StoredProcedure, param);
            return (int)effected;
        }

        //kapila 25/7/2014
        public Boolean IsValidServiceAgent(string _com, string _loc, string _agent)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (_para[2] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agent;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_chk_isvalid_agent", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }

        //Chamal - 28/07/2014
        public int UpdateGRANSerialsFIFOOrder(InventoryRequestSerials _inventoryRequestSerials)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_itrs_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_seq_no;
            (param[1] = new OracleParameter("p_itrs_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_line_no;
            (param[2] = new OracleParameter("p_itrs_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_line;
            (param[3] = new OracleParameter("p_itrs_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_itm_cd;
            (param[4] = new OracleParameter("p_itrs_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_itm_stus;
            (param[5] = new OracleParameter("p_itrs_in_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_seqno;
            (param[6] = new OracleParameter("p_itrs_in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_docno;
            (param[7] = new OracleParameter("p_itrs_in_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_itmline;
            (param[8] = new OracleParameter("p_itrs_in_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_batchline;
            (param[9] = new OracleParameter("p_itrs_in_serline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_serline;
            (param[10] = new OracleParameter("p_itrs_in_docdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_in_docdt;
            (param[11] = new OracleParameter("p_itrs_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestSerials.Itrs_ser_id;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_updategranfifo", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Add By Chamal
        public int UpdateGRANSerials(string _com, string _requestno, string _item, int _serID)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serID;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updategrnserials", CommandType.StoredProcedure, param);
        }

        //Chamal  21-08-2014
        public DataTable GetBOCScanSummary(string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbl", "sp_getbocbatsumm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<ReptPickSerials> GetBOCScanSerials(string _com, string _loc, List<string> _batchList, string _user, int _userSeqNo, string _invcNo)
        {
            DataTable dt = new DataTable();
            List<ReptPickSerials> _reptPickSerialsList = new List<ReptPickSerials>();

            foreach (string batchno in _batchList)
            {
                DataTable dt1 = new DataTable();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
                (param[2] = new OracleParameter("p_batchno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = batchno;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                dt1 = QueryDataTable("tbl_serial", "sp_get_boc_serials", CommandType.StoredProcedure, false, param);
                dt.Merge(dt1);
            }

            if (dt.Rows.Count > 0)
            {
                foreach (DataRow tr in dt.Rows)
                {
                    ReptPickSerials _reptPickSerials = new ReptPickSerials();
                    _reptPickSerials = SetReptPickSerials(tr);
                    _reptPickSerials.Tus_cre_by = _user;
                    _reptPickSerials.Tus_usrseq_no = _userSeqNo;
                    _reptPickSerials.Tus_base_doc_no = _invcNo;
                    _reptPickSerials.Tus_new_remarks = Convert.ToString(tr["BATCHNO"]);
                    _reptPickSerialsList.Add(_reptPickSerials);
                }
            }
            return _reptPickSerialsList;
        }

        //Add By Chamal 22-Aug-2014
        public int UpdateBOCSerialPick(string _com, string _loc, string _batch, string _item, string itemstatus, string _serial1, string _user, int _flag)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batch;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemstatus;
            (param[5] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("p_flag", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _flag;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_updategrnserials", CommandType.StoredProcedure, param);
        }

        // Tharaka on 2014-08-19
        public List<InventoryAdhocHeader> Get_fixedAssetTransfer_approval(string user, string com)
        {
            List<InventoryAdhocHeader> _list = new List<InventoryAdhocHeader>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_UserID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[1] = new OracleParameter("P_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_FIXEDASSET_APPROVAL", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryAdhocHeader>(_dtResults, InventoryAdhocHeader.Converter);

                for (int i = 0; i < _list.Count; i++)
                {
                    _list[i].Iadh_anal5 = (1 + i).ToString();
                }
            }
            return _list;
        }

        //Tharaka 2014-08-20
        public string GetNextSerialNum(string company, string location, string itemCOde, string status)
        {
            string serialNum = string.Empty;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("P_ITEMCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCOde;
            //(param[3] = new OracleParameter("P_ITEMSTATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_NXT_SERIALNO", CommandType.StoredProcedure, false, param);
            serialNum = _dtResults.Rows[0]["ins_ser_id"].ToString();
            return serialNum;
        }

        public MasterBusinessEntity GetBusinessCompanyDetail(string _company, string _businessCompanyCode, string _nic, string _mobile, string _businessType)
        {
            MasterBusinessEntity _masterBusinessCompany = new MasterBusinessEntity();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessCompanyCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _businessType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompany = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter)[0];
            }
            return _masterBusinessCompany;
        }

        //Chamal 26-08-2014
        public MasterItemTaxClaim GetTaxClaimDet(string _company, string _item, string _claimCd)
        {
            MasterItemTaxClaim _userList = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_claimCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _claimCd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblHPacc", "sp_getitm_tax_claim", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0) _userList = DataTableExtensions.ToGenericList<MasterItemTaxClaim>(_dtResults, MasterItemTaxClaim.Converter)[0];
            return _userList;
        }

        //Chamal  10-10-2014
        public DataTable GetPerviousAODInfor(string _com, string _loc, string _item, string _serialno, int _serid)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialno;
            (param[4] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serid;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbl", "SP_GETPREVIOUSAODINFOR", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetEntryDtl(string _entryno)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbl", "sp_get_cusdec_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2014-11-25
        public DataTable CheckSerialAvailabilityWithLocation(string _serialtype, string _item, string _serial, string Loc)
        {
            //sp_checkserialavailability(p_serialtype in NVARCHAR2, p_item in NVARCHAR2,p_serial in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_serialtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialtype;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResult = QueryDataTable("tblCheckserialavailability", "SP_CHKSERIALAVAILABILITYLOC", CommandType.StoredProcedure, false, param);
            return _dtResult;
        }

        public int SAVE_LOG_INTREQITM(InventoryRequest _inventoryRequest, String LogType, String User)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("P_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("P_ITRI_LOG_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = LogType;
            (param[4] = new OracleParameter("P_ITRI_LOGUSER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_SAVE_LOG_INTREQITM", CommandType.StoredProcedure, param);
            return effects;
        }

        public int SAVE_LOG_INTREQSER(InventoryRequest _inventoryRequest, String LogType, String User)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("P_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("P_ITRI_LOG_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = LogType;
            (param[4] = new OracleParameter("P_ITRI_LOGUSER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_SAVE_LOG_INTREQSER", CommandType.StoredProcedure, param);
            return effects;
        }
        //Darshana 19-12-2014
        public DataTable GetAllPendingServicePurchaseOrderDataTable(PurchaseOrder _paramPurchaseOrder)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterLocation.Ml_loc_cd;
            (param[2] = new OracleParameter("p_orderStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_stus;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterBusinessEntity.Mbe_tp;
            (param[4] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.FromDate;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.ToDate;
            (param[6] = new OracleParameter("p_suppCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_supp;
            (param[7] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_doc_no;
            (param[8] = new OracleParameter("p_subtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_sub_tp;
            (param[9] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_job_no;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "sp_get_pending_ser_po", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Add Darshana 19/12/2014
        public DataTable GetSerPOItemsDataTable(string _comCode, string _poNo, string _loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_pono", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "sp_getserpogrnpendingitems", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Darshana 23-02-2015
        public DataTable GetGVAlwCom(string _comCode, string _itm, Int32 _act)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _act;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "sp_getredalwcom", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 16-07-2015
        public List<Warr_Replacement_Det> GetWarrReplDetails(string _soldItem, string _soldSerial, string _replType)
        {
            List<Warr_Replacement_Det> _List = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_solditm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _soldItem;
            (param[1] = new OracleParameter("p_soldSer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _soldSerial;
            (param[2] = new OracleParameter("p_reptp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _replType;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblList", "sp_get_repdet_forsoldserial", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0) _List = DataTableExtensions.ToGenericList<Warr_Replacement_Det>(_dtResults, Warr_Replacement_Det.Converter);
            return _List;
        }

        //Rukshan 18/07/2015
        public DataTable GetRequestItems(string _Com, string _ReqType, string _ProCenter, string _Supplier, DateTime _FromDate, DateTime _ToDate, string _status, string _QType, string _QSubType, string _dateSelector)
        {
            //sp_getfinishgoodcost (p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqType;
            (param[2] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ProCenter;
            (param[3] = new OracleParameter("p_Supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;
            (param[4] = new OracleParameter("p_Fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[5] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[6] = new OracleParameter("p_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("p_QType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QType;
            (param[8] = new OracleParameter("p_QSubType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _QSubType;
            (param[9] = new OracleParameter("p_dateSelector", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dateSelector;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblReqitem", "pkg_search_imp.sp_Search_REQ_ITM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan 21/07/2015
        public DataTable GetItemsQuotation(string _Com, string _ReqType, string _SubType, string _Supplier, string _Item, string _status)
        {
            //sp_getfinishgoodcost (p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqType;
            (param[2] = new OracleParameter("p_SubTyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SubType;
            (param[3] = new OracleParameter("p_Supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;
            (param[4] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[5] = new OracleParameter("p_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblitemQ", "pkg_search_imp.sp_Search_ITM_Quotation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan 21/07/2015
        public DataTable GetSupplierData(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _code = null;
            string _description = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;

                    case "NAME":
                        _description = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _description = (_description != null) ? (_description.ToUpper() + "%") : null;
            //_description = (_description != null) ? (_description + "%") : null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _description;
            (param[3] = new OracleParameter("p_subType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblsupplier", "pkg_search_imp.sp_searchsupplier", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Rukshan 21/07/2015
        public DataTable GetOrderStatus(string _Type)
        {
            //sp_getfinishgoodcost (p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbstatus", "pkg_search_imp.sp_searchOrderstatus", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan 21/07/2015
        public DataTable GetOrderQutation(string _Cus, string _Type, string _Suppier)
        {
            //sp_getfinishgoodcost (p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_Cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cus;
            (param[1] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Type;
            (param[2] = new OracleParameter("p_suppier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Suppier;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbstatus", "pkg_search_imp.sp_searchOrderQot", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan 21/07/2015
        public DataTable GetSuppierItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _itemNo = null;
            string _modelNo = null;
            string _brand = null;
            string _part = null;
            string _desc = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _itemNo = _searchText;
                        break;
                    case "CODE":
                        _itemNo = _searchText;
                        break;

                    case "MODEL":
                        _modelNo = _searchText;
                        break;

                    case "BRAND":
                        _brand = _searchText;
                        break;

                    case "PART #":
                        _part = _searchText;
                        break;
                    case "DESCRIPTION":
                        _desc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _itemNo = (_itemNo != null) ? (_itemNo.ToUpper() + "%") : null;
            _modelNo = (_modelNo != null) ? (_modelNo.ToUpper() + "%") : null;
            _brand = (_brand != null) ? (_brand.ToUpper() + "%") : null;
            _part = (_part != null) ? (_part.ToUpper() + "%") : null;
            _desc = (_desc != null) ? (_desc.ToUpper() + "%") : null;

            if (_desc != null)
            {
                _modelNo = _desc;
            }

            //sp_getfinishgoodcost (p_item in NVARCHAR2,c_data out sys_refcursor)
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_suppier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ItemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemNo;
            (param[2] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modelNo;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("p_part", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _part;
            (param[5] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_desc==null)
            {
                 _dtResults = QueryDataTable("tbstatus", "pkg_search_imp.sp_searchSupplierItem", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tbstatus", "sp_searchsuppitemdesc", CommandType.StoredProcedure, false, param);
            }
           
            return _dtResults;
        }

        //Rukshan 2015-08-13
        public DataTable GetBarcodeItemByDoc(string _docNo, string _com, string _Item, string _loc)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "SP_GetBarcodePrintItem", CommandType.StoredProcedure, false, param);
            //SP_ADHOC_BAR_PRINT
            //SP_GetBarcodePrintItem
            return _tblItem;
        }
        //Rukshan 2015-08-13
        public DataTable GetPurDocNo(string _initialSearchParams, DateTime _from, DateTime _To, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _doc = null;
            string _ref = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT NO":
                        _doc = _searchText;
                        break;

                    case "REF NO":
                        _ref = _searchText;
                        break;
                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_From", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            (param[4] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "pkg_search_inv.sp_searchPurDocNo", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }

        //Rukshan 2015-08-13
        public DataTable GetGRNDocNo(string _initialSearchParams, DateTime _from, DateTime _To, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _doc = null;
            string _Supplier = null;
            string _Order = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT NO":
                        _doc = _searchText;
                        break;
                    case "SUPPLIER":
                        _Supplier = _searchText;
                        break;
                    case "ORDER #":
                        _Order = _searchText;
                        break;
                    default:
                        break;
                }
            }

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[4] = new OracleParameter("p_From", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[5] = new OracleParameter("p_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            (param[6] = new OracleParameter("p_BusE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;
            (param[7] = new OracleParameter("p_Order", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Order;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblGRN", "pkg_search_inv.sp_searchGRNDocNo", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }
        //Rukshan 2015-08-13
        public DataTable GetGRNItem(string _docNo, string _item, string _model, string _Order)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[3] = new OracleParameter("p_Order", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Order;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblGRNItem", "pkg_search_inv.SP_Search_GRNItem", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }
        //Rukshan 2015-08-13
        public DataTable GetPOItem(string _docNo, string _item, string _model)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblPoItem", "pkg_search_inv.SP_Search_POItem", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }

        //Rukshan 2015-08-13
        public Int32 SaveStockAllocate(MasterItemAllocate _MasterItemAllocate)
        {
            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("p_ISA_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_seq;
            (param[1] = new OracleParameter("p_ISA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_dt;
            (param[2] = new OracleParameter("p_ISA_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_com;
            (param[3] = new OracleParameter("p_ISA_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_chnl;
            (param[4] = new OracleParameter("p_ISA_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_loc;
            (param[5] = new OracleParameter("p_ISA_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_tp;
            (param[6] = new OracleParameter("p_ISA_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_doc_tp;
            (param[7] = new OracleParameter("p_ISA_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_doc_no;
            (param[8] = new OracleParameter("p_ISA_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_doc_dt;
            (param[9] = new OracleParameter("p_ISA_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_itm_cd;
            (param[10] = new OracleParameter("p_ISA_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_itm_stus;
            (param[11] = new OracleParameter("p_ISA_ALOC_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_aloc_qty;
            (param[12] = new OracleParameter("p_ISA_ALOC_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_aloc_bqty;
            (param[13] = new OracleParameter("p_ISA_ITM_CHANGED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_itm_changed;
            (param[14] = new OracleParameter("p_ISA_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_ref_no;
            (param[15] = new OracleParameter("p_ISA_REQ_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_req_qty;
            (param[16] = new OracleParameter("p_ISA_REQ_BQTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_req_bqty;
            (param[17] = new OracleParameter("p_ISA_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_act;
            (param[18] = new OracleParameter("p_ISA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cre_by;
            (param[19] = new OracleParameter("p_ISA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cre_dt;
            (param[20] = new OracleParameter("p_ISA_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_session_id;
            (param[21] = new OracleParameter("p_ISA_CNL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_by;
            (param[22] = new OracleParameter("p_ISA_CNL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_dt;
            (param[23] = new OracleParameter("p_ISA_CNL_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_session_id;
            param[24] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_inventory.SP_Save_stock_aloc", CommandType.StoredProcedure, param);
            return result;
        }
        //Rukshan 2015-08-13
        public List<MasterItemAllocate> GetStockAllocate(string _Doc, string _ICode)
        {

            List<MasterItemAllocate> _MasterItemAllocate = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Doc;
            (param[1] = new OracleParameter("p_ICode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ICode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblItem", "pkg_search_inv.SP_Search_StockAllocate", CommandType.StoredProcedure, false, param);

            _MasterItemAllocate = DataTableExtensions.ToGenericList<MasterItemAllocate>(dt, MasterItemAllocate.Converter);

            return _MasterItemAllocate;
        }
        //Rukshan 2015-08-13
        public Int32 DeleteStockAllocate(MasterItemAllocate _MasterItemAllocate)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_ISA_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_seq;
            (param[1] = new OracleParameter("p_ISA_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_act;
            (param[2] = new OracleParameter("p_ISA_CNL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_by;
            (param[3] = new OracleParameter("p_ISA_CNL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_dt;
            (param[4] = new OracleParameter("p_ISA_CNL_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_session_id;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_inventory.SP_DeleteStockitem", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-08-13
        public DataTable GET_ITMSTATUS_BY_LOC_ITM(string _com, string _loc, string _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbl", "SP_GET_ITMSTATUS_BY_LOC_ITM", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-08-12
        public Int32 UPDATE_ITM_STUS(string _invoiceNo, int _lineNo, string _itemCode, string _newStatus)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            (param[2] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[3] = new OracleParameter("p_similarcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newStatus;
            param[4] = new OracleParameter("P_NEW_STATUS", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATE_ITM_STUS", CommandType.StoredProcedure, param);
            return effects;
        }

        #region PDA Sahan

        //Sahan 25/Aug/2015
        public DataTable GetTempPickDocTypes(Int32 p_tdt_direct)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tdt_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tdt_direct;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_doctp@scmrep", "pkg_pda.sp_search_temp_doc_type", CommandType.StoredProcedure, false, param);
        }

        //Sahan 25/Aug/2015
        public DataTable LoadBinCode(string p_ibn_com_cd, string p_ibn_loc_cd,string itemcode=null)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_tdt_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ibn_com_cd;
            (param[1] = new OracleParameter("p_ibn_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ibn_loc_cd;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = new DataTable();
            result = QueryDataTable("inr_bin@scm2", "pkg_pda.sp_load_bin_code", CommandType.StoredProcedure, false, param);
            return result;
        }
        //Sahan 25/Aug/2015
        public DataTable GetItemData(string p_mi_cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mi_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_itm", "pkg_pda.sp_load_itm_data", CommandType.StoredProcedure, false, param);
        }

        //Sahan 25/Aug/2015
        public DataTable GetItemSerialAvailability(string p_ins_itm_cd, string p_ins_ser_1)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ins_itm_cd;
            (param[1] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ins_ser_1;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_ser@scm2", "pkg_pda.sp_check_serial_availability", CommandType.StoredProcedure, false, param);
        }

        //Sahan 25/Aug/2015
        public DataTable IsItemUOMDecimalAllow(string p_msu_cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_msu_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_msu_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_uom@scm2", "pkg_pda.sp_check_decimal_allow", CommandType.StoredProcedure, false, param);
        }

        //Sahan 26/Aug/2015
        public DataTable IsDocAvailable(string p_tuh_usr_com, string p_tuh_doc_no, string p_tuh_usr_loc, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;
            (param[1] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_doc_no;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_loc;
            (param[3] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[4] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[5] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_pda.sp_check_doc_availability", CommandType.StoredProcedure, false, param);
        }

        //Sahan 26/Aug/2015

        public Int32 SavePickedItemSerialsPDA(ReptPickSerials _scanserNew,string doctp =null)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[53];
                (param[0] = new OracleParameter("p_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_usrseq_no;
                (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_doc_no;
                (param[2] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_seq_no;
                (param[3] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_line;
                (param[4] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_batch_line;
                (param[5] = new OracleParameter("p_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_line;
                (param[6] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_doc_dt.Date;
                (param[7] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_com;
                (param[8] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_loc;
                (param[9] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_bin;
                (param[10] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_cd;
                (param[11] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_stus;
                (param[12] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_unit_cost;
                (param[13] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_qty;
                (param[14] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_id;
                (param[15] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (!String.IsNullOrEmpty(_scanserNew.Tus_ser_1)) ? _scanserNew.Tus_ser_1 : "N/A";
                (param[16] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_2;
                (param[17] = new OracleParameter("p_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_3;
                (param[18] = new OracleParameter("p_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_4;
                (param[19] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_warr_no;
                (param[20] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_warr_period;
                (param[21] = new OracleParameter("p_orig_grncom ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_grncom;
                (param[22] = new OracleParameter("p_orig_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_grnno;
                (param[23] = new OracleParameter("p_orig_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_grndt;
                (param[24] = new OracleParameter("p_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_supp;
                (param[25] = new OracleParameter("p_exist_grncom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_grncom;
                (param[26] = new OracleParameter("p_exist_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_grnno;
                (param[27] = new OracleParameter("p_exist_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_grndt;
                (param[28] = new OracleParameter("p_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_supp;
                (param[29] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_cre_by;
                (param[30] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_session_id;
                (param[31] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_unit_price;
                (param[32] = new OracleParameter("p_new_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_new_status;
                (param[33] = new OracleParameter("p_base_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_base_doc_no;
                (param[34] = new OracleParameter("p_base_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_base_itm_line;
                (param[35] = new OracleParameter("p_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_desc;
                (param[36] = new OracleParameter("p_itm_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_model;
                (param[37] = new OracleParameter("p_itm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_brand;
                (param[38] = new OracleParameter("p_ser_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_remarks;
                (param[39] = new OracleParameter("p_resqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_resqty;
                (param[40] = new OracleParameter("p_ageloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ageloc;
                (param[41] = new OracleParameter("p_ageloc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ageloc_dt.Date;
                (param[42] = new OracleParameter("p_isownmrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_isownmrn;

                (param[43] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_job_no;//Chamal 20-Jan-2015
                (param[44] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_job_line;//Chamal 20-Jan-2015
                (param[45] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_res_no;//Chamal 20-Jan-2015
                (param[46] = new OracleParameter("p_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_res_line;//Chamal 20-Jan-2015

                (param[47] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_batch_no;//kapila 4/7/2015
                (param[48] = new OracleParameter("p_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exp_dt.Date;
                (param[49] = new OracleParameter("p_manufac_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_manufac_dt.Date;   //kapila 20/7/2015
                (param[50] = new OracleParameter("p_tus_new_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_new_itm_cd;   //kapila 20/7/2015
                (param[51] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;   //nuwan 2018.02.15

                param[52] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);


                Int32 _eff = UpdateRecords("pkg_pda.sp_picksernewnewPDA", CommandType.StoredProcedure, param);
                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Sahan 26/Aug/2015
        public DataTable IsSavedSerialAvailable(string p_tus_itm_cd, string p_tus_ser_1, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay,string userid=null,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_cd;
            (param[1] = new OracleParameter("p_tus_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_ser_1;
            (param[2] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[3] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[4] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;
            (param[5] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[6] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_pda.sp_check_saved_ser_avail", CommandType.StoredProcedure, false, param);
        }

        //Sahan 26/Aug/2015
        public DataTable LoadSavedSerials(string p_tus_doc_no, string p_tus_com, string p_tus_loc, string p_tus_itm_cd, string p_tus_bin, string p_tus_itm_stus, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_tus_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_doc_no;
            (param[1] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_com;
            (param[2] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_loc;
            (param[3] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_cd;
            (param[4] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_bin;
            (param[5] = new OracleParameter("p_tus_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_stus;
            (param[6] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[7] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[8] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_pda.load_saved_serials", CommandType.StoredProcedure, false, param);
        }

        //Randima 2016-11-30
        public List<ReptPickSerials> LoadSavedSerialsList(string p_tus_doc_no, string p_tus_com, string p_tus_loc, string p_tus_itm_cd, string p_tus_bin, string p_tus_itm_stus, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            List<ReptPickSerials> list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_tus_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_doc_no;
            (param[1] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_com;
            (param[2] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_loc;
            (param[3] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_cd;
            (param[4] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_bin;
            (param[5] = new OracleParameter("p_tus_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_stus;
            (param[6] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[7] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[8] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("temp_pick_ser@scmrep", "load_saved_serialsNew", CommandType.StoredProcedure, false, param);
            list = DataTableExtensions.ToGenericList<ReptPickSerials>(dt, ReptPickSerials.ConverterNew);
            return list;
        }

        //Sahan 27/Aug/2015
        public Int32 DeleteItemsWIthSerials(ReptPickSerials _serials)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_tus_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_doc_no;
            (param[1] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_com;
            (param[2] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_loc;
            (param[3] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_itm_cd;
            (param[4] = new OracleParameter("p_tus_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_ser_1;
            (param[5] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_bin;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_pda.delete_item_with_ser", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 27/Aug/2015
        public Int32 UpdatePickItem(ReptPickItems _items)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _items.Tui_usrseq_no;
            (param[1] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_cd;
            (param[2] = new OracleParameter("p_tui_req_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_stus;
            (param[3] = new OracleParameter("p_tui_req_itm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_qty;
            (param[4] = new OracleParameter("p_tui_pic_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_cd;
            (param[5] = new OracleParameter("p_tui_pic_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_stus;
            (param[6] = new OracleParameter("p_tui_pic_itm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_qty;
            (param[7] = new OracleParameter("p_tui_grn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_grn;
            (param[8] = new OracleParameter("p_tui_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_batch;
            (param[9] = new OracleParameter("p_tui_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_sup;
            (param[10] = new OracleParameter("p_tui_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _items.Tui_grn_dt;
            (param[11] = new OracleParameter("p_tui_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _items.Tui_exp_dt;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_pda.sp_update_pick_items", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Nuwan 23/Aug/2016
        public Int32 UpdatePickItemStockInOut(ReptPickItems _items)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _items.Tui_usrseq_no;
            (param[1] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_cd;
            (param[2] = new OracleParameter("p_tui_req_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_stus;
            (param[3] = new OracleParameter("p_tui_req_itm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_qty;
            (param[4] = new OracleParameter("p_tui_pic_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_cd;
            (param[5] = new OracleParameter("p_tui_pic_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_stus;
            (param[6] = new OracleParameter("p_tui_pic_itm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_qty;
            (param[7] = new OracleParameter("p_tui_grn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_grn;
            (param[8] = new OracleParameter("p_tui_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_batch;
            (param[9] = new OracleParameter("p_tui_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_sup;
            (param[10] = new OracleParameter("p_tui_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _items.Tui_grn_dt;
            (param[11] = new OracleParameter("p_tui_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _items.Tui_exp_dt;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_pda.sp_update_pick_items_stkinOut", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }
        //Sahan 27/Aug/2015
        public DataTable LoadCurrentRowNumber(Int32 p_tui_usrseq_no, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tui_usrseq_no;
            (param[1] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[2] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[3] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_itm@scmrep", "pkg_pda.sp_check_rownum", CommandType.StoredProcedure, false, param);
        }

        //Sahan 28/Aug/2015
        public Int32 UpdatePickItemLine(ReptPickItems _itemsLines,string userid=null,string doctp=null)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_tui_pic_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsLines.Tui_pic_itm_cd;
            (param[1] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemsLines.Tui_usrseq_no;
            (param[2] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsLines.Tui_req_itm_cd;
            (param[3] = new OracleParameter("p_tui_req_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsLines.Tui_req_itm_stus;
            (param[4] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[5] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_pda.update_temp_pick_itm_line", CommandType.StoredProcedure, param);
            return _eff;
        }

        //Sahan 28/Aug/2015
        public DataTable GetItemQty(Int32 p_tui_usrseq_no, string p_tus_doc_no, string p_tus_itm_cd, string p_tus_itm_stus, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay,string userid=null,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tui_usrseq_no;
            (param[1] = new OracleParameter("p_tus_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_doc_no;
            (param[2] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_cd;
            (param[3] = new OracleParameter("p_tus_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_stus;
            (param[4] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[5] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[6] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;
            (param[7] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[8] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_pda.sp_check_qty", CommandType.StoredProcedure, false, param);
        }

        //Sahan 28/Aug/2015
        public Int32 UpdateQty(ReptPickItems _itemsqty)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_tui_pic_itm_qty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsqty.Tui_pic_itm_qty;
            (param[1] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemsqty.Tui_usrseq_no;
            (param[2] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsqty.Tui_req_itm_cd;
            (param[3] = new OracleParameter("p_tui_req_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsqty.Tui_req_itm_stus;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_pda.update_qty", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 31/Aug/2015
        public DataTable GetItemTotalQty(Int32 p_tui_usrseq_no, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tui_usrseq_no;
            (param[1] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[2] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[3] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_itm@scmrep", "pkg_pda.sp_load_itm_qty", CommandType.StoredProcedure, false, param);
        }

        //Sahan 01/Sep/2015
        public Int32 UpdateSerializedItemsQty(ReptPickSerials _serialsQty)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_tus_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serialsQty.Tus_qty;
            (param[1] = new OracleParameter("p_tus_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_seq_no;
            (param[2] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_com;
            (param[3] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_loc;
            (param[4] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_bin;
            (param[5] = new OracleParameter("p_tus_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_itm_stus;
            (param[6] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_itm_cd;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_pda.update_serialized_itm_qty", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 02/Sep/2015
        public DataTable LoadCurrentJobs(string p_tuh_usr_com, string p_tuh_usr_loc, string p_tuh_usr_id, string p_tuh_doc_tp, Int32 p_tuh_direct, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;
            (param[1] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_loc;
            (param[2] = new OracleParameter("p_tuh_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_id;
            (param[3] = new OracleParameter("p_tuh_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_doc_tp;
            (param[4] = new OracleParameter("p_tuh_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_direct;
            (param[5] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[6] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[7] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable DT = new DataTable();
            DT = QueryDataTable("temp_pick_hdr@scmrep", "pkg_pda.sp_load_current_jobs", CommandType.StoredProcedure, false, param);
            return DT;
        }


        //Sahan 03/Sep/2015
        public DataTable CheckCurrentStockBalance(string p_inl_com, string p_inl_loc, string p_inl_itm_cd)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_com;
            (param[1] = new OracleParameter("p_inl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_loc;
            (param[2] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inl_itm_cd;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_loc", "pkg_pda.check_current_stock", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Sep/2015
        public DataTable LoadDistinctBins(string _company, string _location, string _itemcode)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("inr_batch", "pkg_pda.sp_loadbins", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 04/Sep/2015
        public DataTable LoadItemStatusOfBins(string _company, string _location, string _itemcode, string _bin, string docno = null, string doctp = null)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[3] = new OracleParameter("_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[4] = new OracleParameter("_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[5] = new OracleParameter("_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_batch", "pkg_pda.sp_loaditem_status_of_bin", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Sep/2015
        public DataTable LoadItemQtyOfBins(string _company, string _location, string _itemcode, string _bin, string _itemstatus)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[3] = new OracleParameter("_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[4] = new OracleParameter("_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_batch", "pkg_pda.sp_loaditem_qty_of_bin", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Sep/2015
        public DataTable CheckItemHasExpiryDate(string _itemcode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_itm", "pkg_pda.sp_check_is_contain_exp_date", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Sep/2015
        public DataTable LoadItemExpDate(string _company, string _location, string _itemcode, string _bin)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[3] = new OracleParameter("_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_batch", "pkg_pda.sp_loaditem_exp_date", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Sep/2015
        public DataTable LoadAllSerials(string _company, string _location, string _bin, string _Itemcode, string _itemstatus, string _serial)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[3] = new OracleParameter("_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemcode;
            (param[4] = new OracleParameter("_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_pda.sp_load_all_serials", CommandType.StoredProcedure, false, param);
        }

        //Sahan 07/Sep/2015
        public DataTable CalculateScannedQty(string _itemcode, string _itemstatus, string _company, string _location, string _bin, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay, string docno)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[1] = new OracleParameter("_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[2] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[4] = new OracleParameter("_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[5] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[6] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[7] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;
            (param[8] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep a", "pkg_pda.sp_count_scanned_out_items", CommandType.StoredProcedure, false, param);
        }

        #endregion

        //Rukshan 25/Aug/2015
        public DataTable GetAllPendingPOrder(PurchaseOrder _paramPurchaseOrder)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterLocation.Ml_loc_cd;
            (param[2] = new OracleParameter("p_orderStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_stus;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterBusinessEntity.Mbe_tp;
            (param[4] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.FromDateNew;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.ToDateNew;
            (param[6] = new OracleParameter("p_suppCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_supp;
            (param[7] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_ref;
            (param[8] = new OracleParameter("p_subtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_sub_tp;
            (param[9] = new OracleParameter("p_PNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_doc_no;
            (param[10] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_job_no;
            (param[11] = new OracleParameter("p_blref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_remarks;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblPendingConsRequests", "pkg_search_inv.sp_get_pending_Pu_requests", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetAllPendingPOrderBank(PurchaseOrder _paramPurchaseOrder)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterLocation.Ml_loc_cd;
            (param[2] = new OracleParameter("p_orderStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_stus;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.MasterBusinessEntity.Mbe_tp;
            (param[4] = new OracleParameter("p_fromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.FromDateNew;
            (param[5] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.ToDateNew;
            (param[6] = new OracleParameter("p_suppCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_supp;
            (param[7] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_ref;
            (param[8] = new OracleParameter("p_subtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_sub_tp;
            (param[9] = new OracleParameter("p_PNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_doc_no;
            (param[10] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_job_no;
            (param[11] = new OracleParameter("p_blref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paramPurchaseOrder.Poh_remarks;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pending_pu_requestsbank", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan 25/Aug/2015
        public DataTable GetPurchaseOrdersByType(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _job = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PO NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;
                    case "JOB NO":
                        _job = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            _job = (_job != null) ? (_job.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_docRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[3] = new OracleParameter("p_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[4] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2]);
            (param[5] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3]);
            (param[6] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.sp_searchPurchaseOrderByType", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Rukshan 31/Aug/2015
        public DataTable getSubitemComponent(string _item)
        {
            List<MasterItemComponent> _ListItems = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_get_SubItem", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Rukshan 1/Sep/2015
        public DataTable CheckitemPreFix(string _item)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_CheckItemPreFix", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Rukshan 1/Sep/2015
        public DataTable GetitemPreFix(string _item, string _Com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_get_ItemPreFix", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Rukshan 02/Sep/2015
        public string Get_defaultBinCDWeb(string company, string location)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query inr_bin_loc.
            DataTable _dtResults = QueryDataTable("tblBin_loc", "pkg_search_imp.sp_searchDefBin", CommandType.StoredProcedure, false, param);
            string binCD = null;
            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow tr in _dtResults.Rows)
                {
                    binCD = Convert.ToString(tr["ibn_bin_cd"]);
                }
            }

            return binCD;
        }


        //Nadeeka 2014-12-31
        public DataTable GetApprovalLine(string _ref)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getApprovalLine", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Rukshan 2015-02-12
        public int SAVE_INR_SERMSTSUB(InventoryWarrantySubDetail oItem)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0; ;
            (param[0] = new OracleParameter("P_SER_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsms_ser_id;
            (param[1] = new OracleParameter("P_SER_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsms_ser_line;
            (param[2] = new OracleParameter("P_WARR_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_warr_no;
            (param[3] = new OracleParameter("P_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_itm_cd;
            (param[4] = new OracleParameter("P_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_itm_stus;
            (param[5] = new OracleParameter("P_SUB_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_sub_ser;
            (param[6] = new OracleParameter("P_MFC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_mfc;
            (param[7] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_tp;
            (param[8] = new OracleParameter("P_WARR_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsms_warr_period;
            (param[9] = new OracleParameter("P_WARR_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsms_warr_rem;
            (param[10] = new OracleParameter("P_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsms_act;
            (param[11] = new OracleParameter("P_IRSMS_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItem.Irsms_qty;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_save_inr_sermstsub", CommandType.StoredProcedure, param);
            return effects;
        }
        //Rukshan 09/sep/2015
        public DataTable GetSupplierSerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _ICode = null;
            string _SerialI = null;
            string _Po = null;
            string _GRN = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _ICode = _searchText;
                        break;

                    case "SERIAL":
                        _SerialI = _searchText;
                        break;
                    case "PO #":
                        _Po = _searchText;
                        break;
                    case "GRN #":
                        _GRN = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            // _ICode = (_ICode != null) ? (_ICode.ToUpper() + "%") : null;
            // _SerialI = (_SerialI != null) ? (_SerialI.ToUpper() + "%") : null;
            // _Po = (_Po != null) ? (_Po.ToUpper() + "%") : null;
            // _GRN = (_GRN != null) ? (_GRN.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ICode;
            (param[1] = new OracleParameter("p_Seial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SerialI;
            (param[2] = new OracleParameter("p_Po", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Po;
            (param[3] = new OracleParameter("p_GRN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _GRN;
            (param[4] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[6] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[7] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (searchParams[4] == "Serial")
            {
                _dtResults = QueryDataTable("tblPurchaseOrder", "SP_GET_SERIALSFORCON", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.sp_get_Supplier_serial", CommandType.StoredProcedure, false, param);
            }
            //Query Data base.


            return _dtResults;
        }

        //Pemil 11/Sep/2015
        public DataTable GET_INR_SER(string com, string loc, string bin, string itm_cd, string itm_stus, string ser)
        {
            if (string.IsNullOrEmpty(itm_cd))
            {
                itm_cd = null;
            }
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
            (param[3] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm_cd;
            (param[4] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm_stus;
            (param[5] = new OracleParameter("SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_inventory.SP_GET_INR_SER", CommandType.StoredProcedure, false, param);
        }

        //Code by Rukshan 12-sep-2015
        public List<ReptPickSerials> Get_Int_Ser_Temp(string _docNo)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "sp_get_int_ser_temp", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(Convert_INT_Ser(tr));
            }
            return _reptPickSerials;
        }

        //Code by Rukshan 12-sep-2015
        public InventoryHeader Get_Int_Hdr_Temp(string docNo)
        {           //p_docNo in NVARCHAR2, c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_int_hdr_Det_Temp", CommandType.StoredProcedure, false, param);
            InventoryHeader HDR = null;
            if (_tblData.Rows.Count > 0)
            {
                HDR = DataTableExtensions.ToGenericList<InventoryHeader>(_tblData, InventoryHeader.ConvertTotal)[0];
            }
            return HDR;
        }

        //Rukshan 15/sep/2015
        public Int16 UpdateINT_TempObjs(string _docno)
        {
            Int16 rows_affected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int16, null, ParameterDirection.Output);

            rows_affected = (Int16)this.UpdateRecords("SP_Update_INT_TEMP", CommandType.StoredProcedure, param);
            return rows_affected;
        }


        //Sahan 18/Sep/2015
        public DataTable GetAllPendingInventoryOutwardsWeb(InventoryHeader _inventoryRequest)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_doc_tp;
            (param[5] = new OracleParameter("p_loc2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_loc;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "pkg_inventory.sp_getallpendingoutwardsweb", CommandType.StoredProcedure, false, param);
            /* if (_dtResults.Rows.Count > 0)
             {
                 foreach (DataRow dr in _dtResults.Rows)
                 {
                     if (dr["ITH_SUB_TP"].ToString() == "SERVICE")
                         dr.Delete(); dr.AcceptChanges();
                 }
             }*/
            return _dtResults;
        }

        //Sahan 18/Sep/2015
        public DataTable GetAllPendingInventoryOutwardsSCMWeb(InventoryHeader _inventoryRequest)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_oth_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_doc_tp;
            (param[5] = new OracleParameter("p_loc2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Ith_loc;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "pkg_inventory.sp_getallpendingoutwardsscmweb", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 19/Sep/2015

        public Int32 UpdateStockInStatus(InventoryHeader InvHdr)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[5];
            try
            {
                (param[0] = new OracleParameter("p_ith_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvHdr.Ith_stus;
                (param[1] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvHdr.Ith_doc_no;
                (param[2] = new OracleParameter("p_ith_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvHdr.Ith_mod_by;
                (param[3] = new OracleParameter("p_ith_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = InvHdr.Ith_mod_when;

                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_inventory.sp_update_stock_in_status", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }





        //Sahan 22/Sep/2015
        public DataTable GetTempDocHeaderData(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("int_hdr_temp", "pkg_inventory.sp_load_temp_doc_header", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 22/Sep/2015
        public DataTable GetDocHeaderData(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("int_hdr_temp", "pkg_inventory.sp_load_doc_header", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Darshana 22-sep-2015
        public DataTable Get_Sup_Forcons(string _com, string _item, string _itemstatus)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;


            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "sp_get_sup_forcons", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-09-24
        public List<ReptPickSerials> GetNonSerializedItemRandomlyByDateByDoc(string _company, string _location, string _item, string _status, decimal _qty, DateTime _date, String _docNum)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[6] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNum;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "SP_GETNONSERIALDETAILBYDATENEW", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(SetReptPickSerials(tr));
            }
            return _reptPickSerials;
        }

        //kapila 26/9/2015
        public List<ReptPickSerials> GetNonSerializedItemRandomlyByByDoc(string _company, string _location, string _item, string _status, decimal _qty, DateTime _date, String _docNum, Int32 _batchLine, Int32 _itmLine)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[6] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNum;
            (param[7] = new OracleParameter("P_batchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batchLine;
            (param[8] = new OracleParameter("P_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmLine;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "SP_GETNONSERIALDETAILBYNEW_NEW", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(SetReptPickSerials(tr));
            }
            return _reptPickSerials;
        }
        //Rukshan 29/9/2015
        public int SAVE_PurchaseOrderRequest(PurchaseReq _PurchaseReq)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_POR_SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_seq_no;
            (param[1] = new OracleParameter("p_POR_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_req_no;
            (param[2] = new OracleParameter("p_POR_REQ_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_req_line;
            (param[3] = new OracleParameter("p_POR_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_itm_cd;
            (param[4] = new OracleParameter("p_POR_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_itm_stus;
            (param[5] = new OracleParameter("p_POR_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_qty;
            (param[6] = new OracleParameter("p_POR_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_act;
            (param[7] = new OracleParameter("p_POR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_cre_by;
            (param[8] = new OracleParameter("p_POR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PurchaseReq.Por_cre_dt;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.sp_save_PoReqLog", CommandType.StoredProcedure, param);
            return effects;
        }
        //Rukshan 29/9/2015
        public int Update_PORequestBalanceQty(InventoryRequestItem _Request)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_POR_REQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Request.Itri_res_no;
            (param[1] = new OracleParameter("p_POR_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Request.Itri_bqty;
            (param[2] = new OracleParameter("p_POR_PickQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Request.Itri_po_qty;
            (param[3] = new OracleParameter("p_POR_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Request.Itri_itm_cd;
            (param[4] = new OracleParameter("p_POR_STAUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Request.Itri_itm_stus;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.sp_Update_PoReq", CommandType.StoredProcedure, param);
            return effects;
        }
        //Rukshan 30/9/2015
        public List<PurchaseReq> GetPoReqLogDetails(int _PO)
        {
            List<PurchaseReq> _PurchaseReq = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PO;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "pkg_search_inv.sp_GetPoReqLog", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _PurchaseReq = DataTableExtensions.ToGenericList<PurchaseReq>(dt, PurchaseReq.Converter);
            }

            return _PurchaseReq;
        }
        //Rukshan 30/9/2015
        public DataTable GetPurchaseOrdersByDate(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docNo = null;
            string _refNo = null;
            string _status = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "PO NO":
                        _docNo = _searchText;
                        break;

                    case "REF NO":
                        _refNo = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;
                    //case "PO NO":
                    //    _status = _searchText;
                    //    break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _docNo = (_docNo != null) ? (_docNo.ToUpper() + "%") : null;
            _refNo = (_refNo != null) ? (_refNo.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_docRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refNo;
            (param[3] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[4] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[5] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.sp_searchPurchaseOrderByDate", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Code by  Rukshan 2 Oct 2015
        public List<InventoryBatchN> Get_Int_Batch_Temp(string _seqNo)
        {
            List<InventoryBatchN> _reptPickBatch = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "sp_get_int_Batch_temp", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter);
            }


            return _reptPickBatch;
        }
        //Code by  Rukshan 2 Oct 2015
        public List<InventoryBatchN> Get_Int_Batch(string _doc)
        {
            List<InventoryBatchN> _reptPickBatch = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "pkg_search_inv.sp_get_int_Batch", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter);
            }


            return _reptPickBatch;
        }
        //Code by  Rukshan 2 Oct 2015
        public DataTable GetPoQty(string _PONo, int _lineNo)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_PoNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PONo;
            (param[1] = new OracleParameter("p_LineNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_GetPoQty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Code by  Rukshan 5 Oct 2015
        public DataTable CheckItemTo_PRN(string _Com, string _Loc, string _Item, string _status, string _Doc, string _Supplier)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_Icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("p_Status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_DocType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Doc;
            (param[5] = new OracleParameter("p_Supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Supplier;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_CheckItemto_PRN", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 05/Oct/2015
        public DataTable CheckReqUseInPO(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_por_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("pur_req", "pkg_inventory.sp_check_use_in_po", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Rukshan 2015-10-05
        public DataTable Get_A_F_PoReq(string _Com, string _Loc, string _Reqno, DateTime _From, DateTime _To)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[2] = new OracleParameter("p_Rcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Reqno;
            (param[3] = new OracleParameter("p_Fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _From;
            (param[4] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblItem = QueryDataTable("tblItem", "pkg_search_inv.sp_GetApprovalPoReq", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }


        //Written by Rukshan 08/oct/2015
        public Int32 UpdatePoRequest_Iss(string _Com, string _Rno, int _ItemLine, string _icode, decimal _qty)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_RNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Rno;
            (param[2] = new OracleParameter("p_ItemLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_ICode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _icode;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_UpdatePoReq_Iss", CommandType.StoredProcedure, param);
            return effects;

        }

        //Tharaka 2015-10-13
        public List<ComboBoxObject> GET_REQ_TYPES(Int32 option, Int32 value)
        {
            List<ComboBoxObject> result = new List<ComboBoxObject>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_OPTION", OracleDbType.Int32, null, ParameterDirection.Input)).Value = option;
            (param[1] = new OracleParameter("P_value", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tblSerial", "SP_GET_REQ_TYPES", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    ComboBoxObject oCom = new ComboBoxObject();
                    oCom.Value = _dtResults.Rows[i]["rrt_tp"].ToString();
                    oCom.Text = _dtResults.Rows[i]["rrt_desc"].ToString();
                    result.Add(oCom);
                }
            }
            return result;
        }

        //Tharaka 2015-10-13
        public List<InventoryRequest> GET_REQUEST_FOR_DISPATCH(String Com, String Route, String MainCate, String Item, String ReqType, String Loc, String SubCate, String Model, DateTime Date, DateTime ToDate, int type)
        {
            Int32 isItemSearch = 0;
            if (!string.IsNullOrEmpty(MainCate) || !string.IsNullOrEmpty(Item) || !string.IsNullOrEmpty(SubCate) || !string.IsNullOrEmpty(Model))
            {
                isItemSearch = 1;
            }

            List<InventoryRequest> result = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ROUTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Route;
            (param[2] = new OracleParameter("P_MAINCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MainCate;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[4] = new OracleParameter("P_REQTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqType;
            (param[5] = new OracleParameter("P_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[6] = new OracleParameter("P_SUBCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SubCate;
            (param[7] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[8] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            (param[9] = new OracleParameter("P_ISITEMSEARCH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isItemSearch;
            (param[10] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[11] = new OracleParameter("P_TYPE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;
            param[12] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tblSerial", "SP_GET_REQUEST_FOR_DISPATCH", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterDispatch);
            int count = _dtResults.Rows.Count;
            return result;
        }

        public List<InventoryRequest> GET_REQUEST_FOR_DISPATCHNEW(String Com, String Route, String MainCate, String Item, String ReqType, String Loc, String SubCate, String Model, DateTime Date, DateTime ToDate, int type)
        {
            Int32 isItemSearch = 0;
            if (!string.IsNullOrEmpty(MainCate) || !string.IsNullOrEmpty(Item) || !string.IsNullOrEmpty(SubCate) || !string.IsNullOrEmpty(Model))
            {
                isItemSearch = 1;
            }

            List<InventoryRequest> result = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ROUTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Route;
            (param[2] = new OracleParameter("P_MAINCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MainCate;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[4] = new OracleParameter("P_REQTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqType;
            (param[5] = new OracleParameter("P_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[6] = new OracleParameter("P_SUBCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SubCate;
            (param[7] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[8] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            (param[9] = new OracleParameter("P_ISITEMSEARCH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isItemSearch;
            (param[10] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[11] = new OracleParameter("P_TYPE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;
            param[12] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tblSerial", "SP_GET_REQUEST_FOR_DISPATCH2", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterDispatch);
            if (result.Count > 0)
            {
                result = result.OrderBy(d => d.Itr_req_no).ToList();
            }
            return result;
        }

        //Tharaka 2015-10-13
        public List<InventoryRequestItem> GET_INT_REQ_ITM_BY_SEQ(Int32 seq)
        {
            List<InventoryRequestItem> result = new List<InventoryRequestItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "SP_GET_INT_REQ_ITM_BY_SEQ", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                //result = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterDispatchPlan);
                //added by dilshan on 30/08/2018
                result = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterDispatchPlanNew);
            return result;
        }

        //Tharaka 2015-10-13
        public List<InventoryLocation> GET_LOC_ITEMS_FOR_DISPATCH(String Com, String UserID, String Item, String Stus)
        {
            List<InventoryLocation> result = new List<InventoryLocation>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = UserID;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[3] = new OracleParameter("P_ITMSTUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "SP_GET_LOC_ITEMS_FOR_DISPATCH", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryLocation>(_dtResults, InventoryLocation.ConverterDispatch);
            return result;
        }

        //Sahan 16/Oct/2015

        public Int32 UpdatePRNQty(InventoryRequestItem _item)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];
            try
            {
                (param[0] = new OracleParameter("p_itri_app_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Itri_app_qty;
                (param[1] = new OracleParameter("p_itri_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Itri_bqty;
                (param[2] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Itri_seq_no;
                (param[3] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Itri_itm_cd;
                (param[4] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Itri_itm_stus;

                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_inventory.sp_update_prn_qty", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }
        public DataTable GetInvDocType(string _DocNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DocNo;

            DataTable _tblItem = QueryDataTable("tblItem", "sp_get_inventory_doc_tp", CommandType.StoredProcedure, false, param);
            return _tblItem;
        }

        //Written by Rukshan 16/oct/2015
        public List<InventoryRequest> GetMRN_Req(string _IssuesFrom, string _reTo, DateTime _Fdate, DateTime _Todate, string _type, string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[8];
            List<InventoryRequest> _list = null;
            (param[0] = new OracleParameter("p_IssuesFrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _IssuesFrom;
            (param[1] = new OracleParameter("p_recto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reTo;
            (param[2] = new OracleParameter("p_Fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Fdate;
            (param[3] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Todate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_GetMRN_req", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter);
            }
            return _list;
        }
        //Written by Rukshan 17/oct/2015
        public List<InventoryRequestItem> GetMRN_Req_item(string _reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<InventoryRequestItem> result = new List<InventoryRequestItem>();
            (param[0] = new OracleParameter("p_Reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_GetMRN_req_Item", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.MRNConverter);
            return result;

        }
        //Darshana 20-10-2015
        public DataTable GetIntSerTempDetails(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntSer", "sp_getintsertempbydocno", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Darshana 20-10-2015
        public DataTable GetIntBatchTempDetailsDecimal(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntBatch", "sp_getintbatchtempdecitmbydocn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 21/Oct/2015
        public DataTable CheckINBIssueQty(string _company, string _loc, string _doc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_inb_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_inventory.sp_check_inb_issue_qty", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 21/Oct/2015
        public Int32 UpdateCRNStatus(InventoryHeader header)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[7];
            try
            {
                (param[0] = new OracleParameter("p_ith_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_stus;
                (param[1] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_com;
                (param[2] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_loc;
                (param[3] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_doc_no;
                (param[4] = new OracleParameter("p_ith_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_mod_by;
                (param[5] = new OracleParameter("p_ith_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = header.Ith_mod_when;

                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_inventory.sp_update_crn_request", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }



        //Written by Rukshan 22/oct/2015
        public Int32 Change_MRNReq_status(string _Com, string _Rno)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Rno;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updateMRNReq", CommandType.StoredProcedure, param);
            return effects;

        }


        //Written by Rukshan 22/oct/2015
        public Int32 Update_MRN_Bqty(Int32 _seq, string _ItemCode, int _ItemLine, decimal _qty, string _status)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updateMRNReq_Item", CommandType.StoredProcedure, param);
            return effects;
        }
        //Written by Rukshan 22/oct/2015
        public DataTable GetMRNApprov_doc(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromdate, DateTime _todate)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _doc = null;
            string _manualdoc = null;
            string _type = null;
            string _subtype = null;

            string exdate = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT":
                        _doc = _searchText;
                        break;

                    case "BASE DOCUMENT":
                        _manualdoc = _searchText;
                        break;
                    case "PREFER LOCATION":
                        _type = _searchText;
                        break;
                    case "REQUEST SUB TYPE":
                        _subtype = _searchText;
                        break;
                    case "DELIVERY DATE":
                        exdate = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _doc = (_doc != null) ? (_doc.ToUpper() + "%") : null;
            _manualdoc = (_manualdoc != null) ? (_manualdoc.ToUpper() + "%") : null;
            _type = (_type != null) ? (_type.ToUpper() + "%") : null;
            _subtype = (_subtype != null) ? (_subtype.ToUpper() + "%") : null;

            if (string.IsNullOrEmpty(exdate))
            {
                // sp_searchinttrnsreq(p_com in NVARCHAR2,p_user in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2, c_data out SYS_REFCURSOR)
                OracleParameter[] param = new OracleParameter[9];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
                (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
                (param[2] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manualdoc;
                (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
                (param[4] = new OracleParameter("p_subtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
                (param[5] = new OracleParameter("p_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
                (param[6] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
                (param[7] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
                param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                //Query Data base.
                _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.sp_GetMRNApp_Doc", CommandType.StoredProcedure, false, param);
            }
            else
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
                (param[1] = new OracleParameter("p_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
                (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
                (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
                (param[4] = new OracleParameter("p_exdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(exdate);
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                //Query Data base.
                _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.sp_getmrnapp_deliver", CommandType.StoredProcedure, false, param);
            }
            return _dtResults;
        }

        //Sahan 26/Oct/2015
        public DataTable SearchCRNDoc(string _company, string _loc, string _doc, DateTime _fromdate, DateTime _todate, string _suppler)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[3] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[4] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[5] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _suppler;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_search_inv.sp_search_crn_doc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Written by Rukshan 28/oct/2015
        public DataTable GetBufferQty(string _company, string _showroom, string _Item, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _showroom;
            (param[2] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_search_inv.sp_GetBufferQty", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Written by Rukshan 28/oct/2015
        public DataTable GetShopQty(string _company, string _showroom, string _Item)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _showroom;
            (param[2] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_search_inv.sp_GetShopQty", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Written by Rukshan 28/oct/2015
        public DataTable GetSimilarItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _SimilarItem = null;
            string _ItemDes = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _SimilarItem = _searchText;
                        break;

                    case "DESCRIPTION":
                        _ItemDes = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _SimilarItem = (_SimilarItem != null) ? (_SimilarItem.ToUpper() + "%") : null;
            _ItemDes = (_ItemDes != null) ? (_ItemDes.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_sitem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SimilarItem;
            (param[4] = new OracleParameter("p_sdes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemDes;
            (param[5] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("inr", "pkg_search_inv.sp_GetSimilarItem", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written by Rukshan 28/oct/2015
        public DataTable GetReplaceItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _ReplaceItem = null;
            string _ItemDes = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _ReplaceItem = _searchText;
                        break;

                    case "DESCRIPTION":
                        _ItemDes = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _ReplaceItem = (_ReplaceItem != null) ? (_ReplaceItem.ToUpper() + "%") : null;
            _ItemDes = (_ItemDes != null) ? (_ItemDes.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_SItem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReplaceItem;
            (param[4] = new OracleParameter("p_SDes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemDes;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblreplace", "pkg_search_inv.sp_GetReplaceItem", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan 29/ Oct/2015
        public decimal GetForwardsale(string _showroom, string _Item, string _com)
        {
            decimal functionReturnValue = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _showroom;
            (param[2] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_search_inv.sp_GetForwardsaleQty", CommandType.StoredProcedure, false, param);
            if ((_dtResults != null) && (_dtResults.Rows.Count > 0))
            {
                string value = _dtResults.Rows[0]["fwsqty"].ToString();
                if (!string.IsNullOrEmpty(value))
                {
                    functionReturnValue = Convert.ToDecimal(_dtResults.Rows[0]["fwsqty"].ToString());
                }


            }
            return functionReturnValue;

        }

        //Tharaka 2015-10-13
        public DataTable GET_SUPP_FOR_PO_IN_AOD(String LogingCom, String Rec_com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_LOGINCOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = LogingCom;
            (param[1] = new OracleParameter("P_REC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Rec_com;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "SP_GET_SUPP_FOR_PO_IN_AOD", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-11-03
        public WarehouseBin GET_BIN_BY_CODE(string com, string loc, string binCode)
        {
            WarehouseBin result = new WarehouseBin();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("P_BINCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = binCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbl", "SP_GET_BIN_BY_CODE", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<WarehouseBin>(_dtResults, WarehouseBin.Converter)[0];
            return result;
        }

        //Tharaka 2015-11-05
        public List<ReptPickSerials> GET_SERIAL_FOR_ITM_WITH_BIN(string company, string location, string itemCode, string pbook, string pblvl, string BIN)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbook;
            (param[4] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblvl;
            (param[5] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BIN;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_SERIAL_FOR_ITM_WITH_BIN", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }


        //Written by Rukshan 05/Noc/2015
        public List<InventoryRequest> GetCusdecEntryRequest(string _profit, string _Customer, DateTime _From, DateTime _To, string _type, string _status, string _loc)
        {
            OracleParameter[] param = new OracleParameter[8];
            List<InventoryRequest> _list = null;
            (param[0] = new OracleParameter("p_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[1] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Customer;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _From;
            (param[3] = new OracleParameter("c_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            (param[4] = new OracleParameter("c_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("c_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_GetCusdecEntryRequest", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterCusdecEntryRequest);
            }
            return _list;
        }

        //Written By Rukshan on 07 Nov 2015
        public DataTable GET_GetTobond_BL(string _initialSearchParams, string _searchCatergory, string _searchText)
        {

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _tobond = null;
            string _bl = null;
            string _DOC = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC #":
                        _DOC = _searchText;

                        break;
                    case "BL #":
                        _bl = _searchText;

                        break;

                    case "TO-BOND":
                        _tobond = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _tobond = (_tobond != null) ? (_tobond.ToUpper() + "%") : null;
            _bl = (_bl != null) ? (_bl.ToUpper() + "%") : null;
            DateTime _from = new DateTime();
            DateTime _to = new DateTime();
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            //(param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[4] = new OracleParameter("p_Cusdec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            (param[7] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            (param[8] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[9] = new OracleParameter("P_To", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[10] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5].ToString();
            param[11] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();

            int Iscudec = Convert.ToInt32(searchParams[2].ToString());
            string item = searchParams[3].ToString();
            _dtResults = QueryDataTable("tblSerial", "pkg_search_inv.sp_GetTobond_BL", CommandType.StoredProcedure, false, param);
            if (Iscudec == 1)
            {
                if (!string.IsNullOrEmpty(item))
                {
                    bool _isstatus = false;
                    DataColumnCollection columns = _dtResults.Columns;
                    if (columns.Contains("STATUS"))
                    {
                        _isstatus = true;
                    }
                    foreach (DataRow _row in _dtResults.Rows)
                    {
                        string bond = _row[2].ToString();
                        string sino = _row[0].ToString();

                        List<ImportsBLItems> _blitem = GET_GetTobond_BL_Itm("", sino, searchParams[3].ToString());
                        if (_blitem != null)
                        {
                            if (_blitem.Count > 0)
                            {
                                var sum = _blitem.Sum(a => a.Ibi_qty - a.Ibi_req_qty);
                                _row[10] = sum;
                                _row[8] = _blitem.Sum(a => a.Ibi_qty);
                            }
                        }
                        string _item_status = "";
                        if (_isstatus == true)
                        {
                            _item_status = _row[14].ToString();
                        }
                        // string _loc =_row[0].ToString();
                        // string itemstatus=
                        DataTable _result;
                        // bool _loc=false;
                        string _locvalue = string.Empty;
                        if (_item_status == "")
                        {
                            _result = CHECK_TOBOND_GRN(searchParams[0].ToString(), bond, item);
                        }
                        else
                        {
                            _result = CHECK_TOBOND_GRN2(searchParams[0].ToString(), bond, item, _item_status);
                        }

                        if (_result != null)
                        {
                            if (_result.Rows.Count > 0)
                            {
                                _locvalue = _result.Rows[0][0].ToString();
                            }

                        }
                        decimal value = 0;
                        if (_item_status == "")
                        {
                            value = GetPendingno(searchParams[0].ToString(), bond, item);
                        }
                        else
                        {
                            value = GetPendingno2(searchParams[0].ToString(), bond, item, _item_status);
                        }

                        // _row[12] = value.ToString();

                        decimal _grnfree = Convert.ToDecimal(_row[12].ToString());
                        decimal balnce = _grnfree - value;
                        // _row[13] = balnce.ToString();

                        decimal _PendingReservation = GetPendingReservation(searchParams[0].ToString(), bond, sino, item, _locvalue);

                        _row[12] = balnce - _PendingReservation;
                        _row[13] = _PendingReservation;

                    }
                }
            }

            //_dtResults = QueryDataTable("tblSerial", "sp_GetTobond_BL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Written by Rukshan 05/Noc/2015
        public List<ImportsBLItems> GET_GetTobond_BL_Itm(string _tobond, string _bl, string _item)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<ImportsBLItems> _list = null;
            (param[0] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_GetTobond_BL_Item", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ImportsBLItems>(_dtResults, ImportsBLItems.ConverterCusdec);
            }
            return _list;
        }
        //subodana
        public List<ImportsBLItems> GET_GetTobond_BL_Itm_new(string _tobond, string _bl, string _item, Int32 _line)
        {
            OracleParameter[] param = new OracleParameter[5];
            List<ImportsBLItems> _list = null;
            (param[0] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_gettobond_bl_item_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ImportsBLItems>(_dtResults, ImportsBLItems.ConverterCusdec);
            }
            return _list;
        }
        public List<ImportsBLItems> GET_GetTobond_BL_Itm_latest(string _tobond, string _bl, Int32 _itemline)
        {
            OracleParameter[] param = new OracleParameter[4];
            List<ImportsBLItems> _list = null;
            (param[0] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_gettobond_bl_itnw", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ImportsBLItems>(_dtResults, ImportsBLItems.ConverterCusdec);
            }
            return _list;
        }
        //Written by Rukshan 09/Nov/2015
        public Int32 Update_BI_Rqty(Int32 _number, string _ItemCode, int _ItemLine, decimal _qty, int _type)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _number;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updateBL_Item", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Rukshan 09/Nov/2015
        public Int32 Change_CusdecReq_status(string _Rno)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Rno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updatecusdecreq_status", CommandType.StoredProcedure, param);
            return effects;

        }

        //Sahan 10/Nov/2015
        public DataTable CheckWareHouseAvailability(string _company, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("mst_loc", "pkg_inventory.check_warehouse_avalablility", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 10/Nov/2015
        public DataTable LoadLoadingBays(string _company, string _loc, string resourse)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_mws_res_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = resourse;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("mst_wh_reso", "pkg_inventory.load_loading_bays", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 11/Nov/2015
        public DataTable LoadUserLoadingBays(string _user, string _company, string _loc, string _warehcom, string _warehloccode)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_selb_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_selb_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_selb_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_selb_lbcom_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehcom;
            (param[4] = new OracleParameter("p_selb_lbloc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warehloccode;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("sec_user_lb", "pkg_pda.load_user_loading_bays", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written by Rukshan 11/Nov/2015
        public Int32 Update_Cusdec_Bqty(string _rno, string _ItemCode, int _ItemLine, decimal _qty)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_Rno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rno;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updateCusdec_bqty", CommandType.StoredProcedure, param);
            return effects;
        }

        //Written by Rukshan 12/Nov/2015
        public DataTable GetSearchRequest(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _mrn = null;
            string _manual = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CUSDEC NO":
                        _mrn = _searchText;
                        break;

                    case "MANUAL REF.":
                        _manual = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _mrn = (_mrn != null) ? (_mrn.ToUpper() + "%") : null;
            _manual = (_manual != null) ? (_manual.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            // sp_searchmrn(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();

            (param[2] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[3] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manual;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[6] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.sp_searchreq", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 13 Nov/2015
        public DataTable IsDocNoAvailable(string p_tuh_doc_no, string p_tuh_doc_tp, Int32 p_tuh_direct, string p_tuh_usr_com)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_doc_no;
            (param[1] = new OracleParameter("p_tuh_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_doc_tp;
            (param[2] = new OracleParameter("p_tuh_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tuh_direct;
            (param[3] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_inventory.sp_check_doc_no", CommandType.StoredProcedure, false, param);
        }

        //Sahan 13 Nov/2015
        public Int32 UpdatePickHeader(ReptPickHeader header)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[11];
            try
            {
                (param[0] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_doc_no;
                (param[1] = new OracleParameter("p_tuh_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_doc_tp;
                (param[2] = new OracleParameter("p_tuh_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Tuh_direct;
                (param[3] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_usr_com;
                (param[4] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_usr_loc;
                (param[5] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_wh_com;
                (param[6] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_wh_loc;
                (param[7] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_load_bay;
                (param[8] = new OracleParameter("p_tuh_res", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.Tuh_is_take_res;
                (param[9] = new OracleParameter("p_tuh_base_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Tuh_base_doc;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_inventory.sp_update_pick_header", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        //Sahan 13 Nov/2015
        public DataTable CheckItemsScannedStatus(Int32 p_tui_usrseq_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tui_usrseq_no;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_itm@scmrep", "pkg_inventory.sp_check_items_scanned", CommandType.StoredProcedure, false, param);
        }

        //Sahan 17 Nov/2015
        public DataTable GetSearchInterTransferRequestWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _mrn = null;
            string _manual = null;
            string _status = null;
            string _reqfrom = null;
            string _reqdate = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "INTER-TRANSFER NO":
                        _mrn = _searchText;
                        break;

                    case "MANUAL REF.":
                        _manual = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "REQUEST FROM":
                        _reqfrom = _searchText;
                        break;
                    case "DATE":
                        _reqdate = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _mrn = (_mrn != null) ? (_mrn.ToUpper()) : null;
            _manual = (_manual != null) ? (_manual.ToUpper()) : null;
            _status = (_status != null) ? (_status.ToUpper()) : null;
            _reqfrom = (_reqfrom != null) ? (_reqfrom.ToUpper()) : null;
            _reqdate = (_reqdate != null) ? (_reqdate.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _manual;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("p_request_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqfrom;
            (param[7] = new OracleParameter("p_requestdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqdate;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblInvoiceSearchWeb", "pkg_inventory.sp_searchinttrnsreqweb", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //18 Nov/2015 Sahan
        public DataTable LoadProductConditionUpdateDocs()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_tp", "pkg_inventory.loaddoctypepcue", CommandType.StoredProcedure, false, param);
        }

        //18 Nov/2015 Sahan
        public DataTable LoadHeaderPCUpdateDocWareHouseUser(string type, DateTime fromdate, DateTime todate, string company, string cat1, string cat2, string cat3)
        {
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;

            (param[4] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[5] = new OracleParameter("p_mi_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[6] = new OracleParameter("p_mi_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "pkg_inventory.load_header_warehouse_user", CommandType.StoredProcedure, false, param);
        }

        //18 Nov/2015 Sahan
        public DataTable LoadHeaderPCUpdateDocHeadOfficeUser(string type, DateTime fromdate, DateTime todate, string company, string cat1, string cat2, string cat3)
        {
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[4] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[5] = new OracleParameter("p_mi_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[6] = new OracleParameter("p_mi_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "pkg_inventory.load_header_head_office_user", CommandType.StoredProcedure, false, param);
        }

        //18 Nov/2015 Sahan
        public DataTable LoadProductConditionPopUp(string _initialSearchParams, string _searchCatergory, string _searchText, string filter)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _doc = null;
            string _othdoc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _doc = _searchText;
                        break;

                    case "OTHER DOC NO":
                        _othdoc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _doc = (_doc != null) ? (_doc.ToUpper()) : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            string spname = string.Empty;

            if (filter == "WH")
            {
                spname = "pkg_inventory.load_header_warehouse_poup";
            }
            else
            {
                spname = "pkg_inventory.load_header_head_office_popup";
            }
            _dtResults = QueryDataTable("int_hdr", spname, CommandType.StoredProcedure, false, param);
            //if (_dtResults.Rows.Count > 0)
            //{
            //    DataView dv = _dtResults.DefaultView;
            //    dv.Sort = "ith_doc_date DESC";
            //    _dtResults = dv.ToTable();
            //}
            return _dtResults;
        }
        public DataTable LoadProductConditionNew(string _initialSearchParams, string _searchCatergory, string _searchText, string filter)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _doc = null;
            string _othdoc = null;
            string _outloc = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _doc = _searchText;
                        break;

                    case "OTHER DOC NO":
                        _othdoc = _searchText;
                        break;
                    case "OUTWARD LOCATION":
                        _outloc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _doc = (_doc != null) ? (_doc.ToUpper()) : null;
            _othdoc = (_othdoc != null) ? (_othdoc.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            (param[3] = new OracleParameter("p_outloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _outloc;
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[5] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[2].ToString());
            (param[6] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[3].ToString());

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            string spname = string.Empty;
            spname = "load_header_head_office_new";
            _dtResults = QueryDataTable("int_hdr", spname, CommandType.StoredProcedure, false, param);
            //if (_dtResults.Rows.Count > 0)
            //{
            //    DataView dv = _dtResults.DefaultView;
            //    dv.Sort = "ith_doc_date DESC";
            //    _dtResults = dv.ToTable();
            //}
            return _dtResults;
        }

        //19 Nov/2015 Sahan
        public DataTable LoadDocumnetItems(string docno, Int32 is_serial, string serial)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_is_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = is_serial;
            (param[2] = new OracleParameter("p_serialno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_inventory.load_document_items", CommandType.StoredProcedure, false, param);
        }

        //20 Nov/2015 Sahan
        public DataTable LoadItemConditions(string serial, string cate)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_serialid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("ref_cond_tp", "pkg_inventory.load_item_conditions", CommandType.StoredProcedure, false, param);
        }

        //20 Nov/2015 Sahan
        public DataTable LoadConditionsForCategory(string company, string cate, string itemcate)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_rct_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;
            (param[2] = new OracleParameter("p_itm_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcate;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("ref_cond_tp", "pkg_inventory.load_all_conditions_for_cate", CommandType.StoredProcedure, false, param);
        }

        //20 Nov/2015 Sahan
        public DataTable LoadConditionsForAllCategory(string company, string cate)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_rct_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("ref_cond_tp", "pkg_inventory.load_all_conditions_for_all", CommandType.StoredProcedure, false, param);
        }

        //Sahan 20 Nov 2015
        public Int32 SaveItemConditions(ItemConditionSetup _itemconditions)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[16];
                (param[0] = new OracleParameter("p_irsc_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemconditions.irsc_ser_id;
                (param[1] = new OracleParameter("p_irsc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_com;
                (param[2] = new OracleParameter("p_irsc_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_loc;
                (param[3] = new OracleParameter("p_irsc_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_cat;
                (param[4] = new OracleParameter("p_irsc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_tp;
                (param[5] = new OracleParameter("p_irsc_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_rmk;
                (param[6] = new OracleParameter("p_irsc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_cre_by;
                (param[7] = new OracleParameter("p_irsc_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemconditions.irsc_cre_dt;
                (param[8] = new OracleParameter("p_irsc_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_stus;
                (param[9] = new OracleParameter("p_irsc_add_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_add_loc;
                (param[10] = new OracleParameter("p_irsc_cnl_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_cnl_by;
                (param[11] = new OracleParameter("p_irsc_cnl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _itemconditions.p_irsc_cnl_dt;
                (param[12] = new OracleParameter("p_irsc_cha", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itemconditions.irsc_cha;
                (param[13] = new OracleParameter("p_irsc_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_doc;
                (param[14] = new OracleParameter("p_irsc_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemconditions.irsc_othloc;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 _eff = UpdateRecords("pkg_inventory.sp_save_itm_conditions", CommandType.StoredProcedure, param);

                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Sahan 23 Nov 2015
        public Int32 UpdateItsPick(Int32 its_pick, string docno, string com, string loc, string item, Int32 serial)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_its_pick", OracleDbType.Int32, null, ParameterDirection.Input)).Value = its_pick;
                (param[1] = new OracleParameter("p_its_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
                (param[2] = new OracleParameter("p_its_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[3] = new OracleParameter("p_its_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
                (param[4] = new OracleParameter("p_its_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
                (param[5] = new OracleParameter("p_its_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serial;

                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 _eff = UpdateRecords("pkg_inventory.sp_Update_its_pick", CommandType.StoredProcedure, param);
                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //23 Nov/2015 Sahan
        public DataTable LoadDocSerials(string p_doc)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_doc;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_inventory.load_doc_serials", CommandType.StoredProcedure, false, param);
        }
        //Dulaj 2018-Mar-14
        public DataTable GetIntSarByDoc(string doc_no)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_its_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_no;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "get_int_itm_by_doc_no", CommandType.StoredProcedure, false, param);
        }
        //23 Nov/2015 Sahan
        public DataTable LoadItemConditionsPerItem(Int32 serial, string cat)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_sermst_cond", "pkg_inventory.load_item_conditions_per_item", CommandType.StoredProcedure, false, param);
        }

        //Sahan 23 Nov 2015
        public Int32 UpdateAnal4(InventoryHeader header)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_ith_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_anal_4;
                (param[1] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_com;
                (param[2] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_loc;
                (param[3] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.Ith_doc_no;

                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 _eff = UpdateRecords("pkg_inventory.sp_update_anal4", CommandType.StoredProcedure, param);
                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Tharaka 2015-11-24
        public Int32 Save_Disposal_Header(DisposalHeader oDisposalHeader, out Int32 GenSeqNum)
        {
            GenSeqNum = 0;
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[29];
            (param[0] = new OracleParameter("P_DH_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_seq;
            (param[1] = new OracleParameter("P_DH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_com;
            (param[2] = new OracleParameter("P_DH_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_pc;
            (param[3] = new OracleParameter("P_DH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_doc_no;
            (param[4] = new OracleParameter("P_DH_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_doc_dt;
            (param[5] = new OracleParameter("P_DH_FRM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_frm_dt;
            (param[6] = new OracleParameter("P_DH_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_to_dt;
            (param[7] = new OracleParameter("P_DH_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_ref_no;
            (param[8] = new OracleParameter("P_DH_MAX_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_max_val;
            (param[9] = new OracleParameter("P_DH_CHK_MAX_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_chk_max_val;
            (param[10] = new OracleParameter("P_DH_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_chg;
            (param[11] = new OracleParameter("P_DH_PAY_MTD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_pay_mtd;
            (param[12] = new OracleParameter("P_DH_RECIPT_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_recipt_no;
            (param[13] = new OracleParameter("P_DH_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_rmk;
            (param[14] = new OracleParameter("P_DH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_stus;
            (param[15] = new OracleParameter("P_DH_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_anal_1;
            (param[16] = new OracleParameter("P_DH_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_anal_2;
            (param[17] = new OracleParameter("P_DH_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_anal_3;
            (param[18] = new OracleParameter("P_DH_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_anal_4;
            (param[19] = new OracleParameter("P_DH_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_anal_5;
            (param[20] = new OracleParameter("P_DH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_cre_by;
            (param[21] = new OracleParameter("P_DH_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_cre_dt;
            (param[22] = new OracleParameter("P_DH_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_cre_session;
            (param[23] = new OracleParameter("P_DH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_mod_by;
            (param[24] = new OracleParameter("P_DH_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_mod_dt;
            (param[25] = new OracleParameter("P_DH_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_mod_session;
            (param[26] = new OracleParameter("P_DH_CUS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalHeader.Dh_cus_cd;
            param[27] = new OracleParameter("O_GEBSEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[28] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_DISPOSAL_HEADER", CommandType.StoredProcedure, param);

            if (result > 0)
            {
                GenSeqNum = Convert.ToInt32(param[27].Value.ToString());
            }
            return result;
        }

        //Tharaka 2015-11-24
        public Int32 Save_Disposal_Locations(DisposalLocation oDisposalLocation)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_DL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_seq;
            (param[1] = new OracleParameter("P_DL_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_doc_no;
            (param[2] = new OracleParameter("P_DL_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_loc;
            (param[3] = new OracleParameter("P_DL_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_act;
            (param[4] = new OracleParameter("P_DL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_cre_by;
            (param[5] = new OracleParameter("P_DL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_cre_dt;
            (param[6] = new OracleParameter("P_DL_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oDisposalLocation.Dl_cre_session;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_DISPOSAL_LOCATIONS", CommandType.StoredProcedure, param);
            return result;
        }

        //Randima 2016-10-31
        public Int32 Save_Disposal_Curr_Locations(DispCurrentLocation oStockAtLocations)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_IDC_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_seq;
            (param[1] = new OracleParameter("P_IDC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_doc_no;
            (param[2] = new OracleParameter("P_IDC_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_loc;
            (param[3] = new OracleParameter("P_IDC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_act;
            (param[4] = new OracleParameter("P_IDC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_cre_by;
            (param[5] = new OracleParameter("P_IDC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_cre_dt;
            (param[6] = new OracleParameter("P_IDC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_mod_by;
            (param[7] = new OracleParameter("P_IDC_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oStockAtLocations.Idc_mod_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_DISP_CURR_LOC", CommandType.StoredProcedure, param);
            return result;
        }


        //Randima 2016-10-31
        public Int32 Save_Disposal_Curr_Stus(DisposalCurrStatus oStockStatus)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_IDS_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oStockStatus.Ids_seq;
            (param[1] = new OracleParameter("P_IDS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockStatus.Ids_doc_no;
            (param[2] = new OracleParameter("P_IDS_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockStatus.Ids_stus;
            (param[3] = new OracleParameter("P_IDS_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oStockStatus.Ids_act;
            (param[4] = new OracleParameter("P_IDS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockStatus.Ids_cre_by;
            (param[5] = new OracleParameter("P_IDS_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oStockStatus.Ids_cre_dt;
            (param[6] = new OracleParameter("P_IDS_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oStockStatus.Ids_mod_by;
            (param[7] = new OracleParameter("P_IDS_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oStockStatus.Ids_mod_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_DISP_CURR_STUS", CommandType.StoredProcedure, param);
            return result;
        }

        //Randima 2016-10-31
        public List<DispCurrentLocation> GET_DISPOSAL_CURR_LOC_LIST(int _seqNo, string _docNo)
        {
            List<DispCurrentLocation> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_IDC_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("P_IDC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISP_CURR_LOC", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DispCurrentLocation>(dt, DispCurrentLocation.Converter);

            return oResult;
        }

        //Randima 2016-10-31
        public List<DisposalCurrStatus> GET_DISPOSAL_CURR_STUS_LIST(int _seqNo, string _docNo)
        {
            List<DisposalCurrStatus> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_IDS_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("P_IDS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISP_CURR_STUS", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalCurrStatus>(dt, DisposalCurrStatus.Converter);

            return oResult;
        }

        //Randima 2016-10-31
        public List<DisposalLocation> GET_DISPOSAL_LOC_LIST(int _seqNo, string _docNo)
        {
            List<DisposalLocation> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("P_DL_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISP_LOC", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalLocation>(dt, DisposalLocation.Converter);

            return oResult;
        }

        //Randima 2016-11-03
        public Int32 Save_Disposal_Items(DisposalItem dispItm, bool isupdate)
        {
            Int32 result = 0;
            Int32 up = 0;
            if (isupdate == true)
            {
                up = 1;
            }
            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("P_IDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_seq;
            (param[1] = new OracleParameter("P_IDD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_line;
            (param[2] = new OracleParameter("P_IDD_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_job_no;
            (param[3] = new OracleParameter("P_IDD_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_itm_cd;
            (param[4] = new OracleParameter("P_IDD_SER_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_id;
            (param[5] = new OracleParameter("P_IDD_SER_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_1;
            (param[6] = new OracleParameter("P_IDD_SER_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_2;
            (param[7] = new OracleParameter("P_IDD_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_stus;
            (param[8] = new OracleParameter("P_IDD_CUR_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_cur_loc;
            (param[9] = new OracleParameter("P_IDD_DISP_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_disp_loc;
            (param[10] = new OracleParameter("P_IDD_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_act;
            (param[11] = new OracleParameter("P_IDD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_cre_by;
            (param[12] = new OracleParameter("P_IDD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = dispItm.Idd_cre_dt;
            (param[13] = new OracleParameter("P_IDD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_mod_by;
            (param[14] = new OracleParameter("P_IDD_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = dispItm.Idd_mod_dt;
            (param[15] = new OracleParameter("P_IDD_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_qty;
            (param[16] = new OracleParameter("P_IDD_BIN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_bin_cd;
            (param[17] = new OracleParameter("P_IDD_BASE_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_base_Seq;
            (param[18] = new OracleParameter("P_ISUPDATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = up;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_DISP_ITM", CommandType.StoredProcedure, param);
            return result;
        }

        //Randima 2016-11-03
        public List<DisposalItem> GET_DISPOSAL_ITM_LIST(int _seqNo, string _docNo, bool istextchange)
        {
            List<DisposalItem> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_IDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("P_IDD_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            if (istextchange)
            {
                dt = QueryDataTable("tbl_serials", "SP_GET_DISP_ITM2", CommandType.StoredProcedure, false, param);
            }
            else
            {
                dt = QueryDataTable("tbl_serials", "SP_GET_DISP_ITM", CommandType.StoredProcedure, false, param);
            }



            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalItem>(dt, DisposalItem.Converter);

            return oResult;

        }

        //Randima 2016-11-04
        public Int32 GET_DISPOSALITM_LINE(int _seqNo)
        {
            int result = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_IDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISPITM_LINE", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                result = Convert.ToInt32(dt.Rows[0]["LINE_NO"].ToString());
            //result =Convert.ToInt32(dt.Rows[0].;

            return result;

        }

        //Tharaka 2015-11-24
        public DisposalHeader GET_DISPOSAL_JOB_HEADER(string COM, string PC, string DocNum, string status)
        {
            DisposalHeader oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            (param[2] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocNum;
            (param[3] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISPOSAL_JOB_HEADER", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalHeader>(dt, DisposalHeader.Converter)[0];

            return oResult;
        }

        //Tharaka 2015-11-24
        public List<DisposalLocation> GET_DISPOSAL_LOCATIONS(Int32 Seq)
        {
            List<DisposalLocation> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISPOSAL_LOCATIONS", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalLocation>(dt, DisposalLocation.Converter);

            return oResult;
        }

        //Tharaka 2015-11-24
        public Int32 UPDATE_DISPOSAL_LOC_STATUS(Int32 Seq, String Loc)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("p_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_UPDATE_DISPOSAL_LOC_STATUS", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-11-24
        public List<DisposalHeader> GET_DISPOSAL_JOBS(DisposalHeader oFilter)
        {
            Int32 isDateSearch = (oFilter.Dh_doc_no == "") ? 0 : 1;
            List<DisposalHeader> oResult = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_pc;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_stus;
            (param[3] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_doc_no;
            (param[4] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = oFilter.Dh_frm_dt;
            (param[5] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = oFilter.Dh_to_dt;
            (param[6] = new OracleParameter("P_ISDATESEARCH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDateSearch;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_DISPOSAL_JOBS", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalHeader>(dt, DisposalHeader.Converter);

            return oResult;
        }
        //Lakshan 24/11/2015
        public DataTable GetContainerBlDetails(string p_container, string p_bl, string p_date_range, string p_from, string p_to, string p_agent,
            string p_container_tp, string p_compmany, string _option)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_container", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bl;
            (param[2] = new OracleParameter("p_date_range", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_date_range;
            (param[3] = new OracleParameter("p_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_from;
            (param[4] = new OracleParameter("p_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_to;
            (param[5] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_agent;
            (param[6] = new OracleParameter("p_container_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container_tp;
            (param[7] = new OracleParameter("p_compmany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_compmany;
            (param[8] = new OracleParameter("P_OPTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _option;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblAgent", "pkg_imports_Enquiry.SP_GET_CONTAINER_BL_DETAILS", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Lakshan 24/11/2015
        public DataTable GetContainerDetails(string p_container, string p_bl, string p_date_range, string p_from, string p_to, string p_agent,
            string p_container_tp, string p_compmany)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_container", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bl;
            (param[2] = new OracleParameter("p_date_range", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_date_range;
            (param[3] = new OracleParameter("p_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_from;
            (param[4] = new OracleParameter("p_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_to;
            (param[5] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_agent;
            (param[6] = new OracleParameter("p_container_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container_tp;
            (param[7] = new OracleParameter("p_compmany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_compmany;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblAgent", "pkg_imports_Enquiry.SP_GET_CONTAINER_DETAILS", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Lakshan 24/11/2015
        public DataTable GetContainerSummary(string p_container, string p_bl, string p_date_range, string p_from, string p_to, string p_agent,
           string p_container_tp, string p_compmany)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_container", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bl;
            (param[2] = new OracleParameter("p_date_range", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_date_range;
            (param[3] = new OracleParameter("p_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_from;
            (param[4] = new OracleParameter("p_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_to;
            (param[5] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_agent;
            (param[6] = new OracleParameter("p_container_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container_tp;
            (param[7] = new OracleParameter("p_compmany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_compmany;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblAgent", "pkg_imports_Enquiry.SP_GET_CONTAINER_SUMMARY", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Lakshan 24/11/2015
        public DataTable GetContainerBlList(string p_container, string p_bl, string p_date_range, string p_from, string p_to, string p_agent, string p_container_tp, string p_compmany)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_container", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bl;
            (param[2] = new OracleParameter("p_date_range", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_date_range;
            (param[3] = new OracleParameter("p_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_from;
            (param[4] = new OracleParameter("p_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_to;
            (param[5] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_agent;
            (param[6] = new OracleParameter("p_container_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_container_tp;
            (param[7] = new OracleParameter("p_compmany", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_compmany;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblAgent", "pkg_imports_Enquiry.SP_GET_CONTAINER_BL_LIST", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 28 Nov 2015
        public DataTable GetSearchMRNWeb(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _mrn = null;
            string _status = null;
            string _reqestfrom = null;
            string _reqestdate = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MRN NO":
                        _mrn = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "REQUEST FROM":
                        _reqestfrom = _searchText;
                        break;

                    case "DATE":
                        _reqestdate = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _mrn = (_mrn != null) ? (_mrn.ToUpper()) : null;
            _status = (_status != null) ? ("%" + _status.ToUpper() + "%") : null;
            _reqestfrom = (_reqestfrom != null) ? (_reqestfrom.ToUpper()) : null;


            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[3] = new OracleParameter("p_request_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqestfrom;
            (param[4] = new OracleParameter("p_requestdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqestdate;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("int_req", "pkg_inventory.sp_searchmrn_web", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //
        //fazan  03 dec 2015
        public DataTable GetCompany(string company)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tbld", "pkg_imports_Enquiry.SP_company_search_new", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 2015-12-15
        public DataTable GetLocationDetails(string company, string location)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblqry", "pkg_imports_Enquiry.sp_SearchLocation_Mst", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 2015-12-07
        public DataTable LoacationType()
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbllocation", "pkg_imports_enquiry.sp_location_type", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 2015-12-07
        public DataTable GetCategeryType()
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblcategery", "pkg_imports_enquiry.sp_categery_type", CommandType.StoredProcedure, false, param);
            return dt;



        }

        public DataTable Get_Grade_types()
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblgrade", "pkg_imports_enquiry.sp_Grade_types", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 2015-12-07
        public Int32 UpdateLocationDetails(string company, string location, string opearation, string channel, string subchanel, string reference, string address1, string address2, string tel, string mobile, string fax, string contactperson, string country, string province, string district,
            string Email, string location_N, string town, string web, string categery, string p_grade, int sublocation, string mainLocationcd, int online, string managercd,
            int forwardQty, int suspended, int act, string createdby, DateTime createdate, string modifyby, DateTime modifydate, string sessionId, string anal1, string anal2, decimal ana13, decimal anal4, string anal5, DateTime anal6, string locationtype, int allowbin, string defpc, string sev_chnl, string p_auto_ain, string p_fx_loc, DateTime p_scm2_st, int p_chk_man, DateTime p_commencedon, decimal p_approvedstockvalue, int p_bankGrantvalue, string p_wh_com, string p_wh_cd, int p_serial, int pda)
        {
            //  DataTable dt = null;
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[55];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_operation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opearation;
            (param[3] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[4] = new OracleParameter("p_subchanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subchanel;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reference;
            (param[6] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = address1;
            (param[7] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = address2;
            (param[8] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tel;
            (param[9] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobile;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fax;
            (param[11] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = contactperson;
            (param[12] = new OracleParameter("p_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[13] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[14] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;
            (param[15] = new OracleParameter("p_Email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Email;
            (param[16] = new OracleParameter("p_locationName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location_N;
            (param[17] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;
            (param[18] = new OracleParameter("p_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = web;
            (param[19] = new OracleParameter("p_categery", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = categery;
            (param[20] = new OracleParameter("p_grade", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_grade;
            (param[21] = new OracleParameter("p_sublocation", OracleDbType.Int32, null, ParameterDirection.Input)).Value = sublocation;
            (param[22] = new OracleParameter("p_mainlocationcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mainLocationcd;
            (param[23] = new OracleParameter("p_online", OracleDbType.Int32, null, ParameterDirection.Input)).Value = online;
            (param[24] = new OracleParameter("p_manegerCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = managercd;
            (param[25] = new OracleParameter("p_forwardsale", OracleDbType.Int32, null, ParameterDirection.Input)).Value = forwardQty;
            (param[26] = new OracleParameter("p_suspended", OracleDbType.Int32, null, ParameterDirection.Input)).Value = suspended;
            (param[27] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = act;
            (param[28] = new OracleParameter("p_createby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createdby;
            (param[29] = new OracleParameter("p_createdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = createdate;
            (param[30] = new OracleParameter("p_modifyby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifyby;
            (param[31] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = modifydate;

            (param[32] = new OracleParameter("p_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
            (param[33] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = anal1;
            (param[34] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = anal2;

            (param[35] = new OracleParameter("p_anal3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ana13;
            (param[36] = new OracleParameter("p_anal4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = anal4;

            (param[37] = new OracleParameter("p_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = anal5;
            (param[38] = new OracleParameter("p_anal6", OracleDbType.Date, null, ParameterDirection.Input)).Value = anal6;

            (param[39] = new OracleParameter("p_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locationtype;
            (param[40] = new OracleParameter("p_allow_bin", OracleDbType.Int32, null, ParameterDirection.Input)).Value = allowbin;
            (param[41] = new OracleParameter("p_def_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = defpc;
            (param[42] = new OracleParameter("p_sev_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sev_chnl;
            (param[43] = new OracleParameter("p_auto_ain", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_auto_ain;
            (param[44] = new OracleParameter("p_fx_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_fx_loc;
            (param[45] = new OracleParameter("p_scm2_st", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_scm2_st;
            (param[46] = new OracleParameter("p_chk_man", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_chk_man;
            (param[47] = new OracleParameter("p_commencedon", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_commencedon;

            (param[48] = new OracleParameter("p_approvedstockvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_approvedstockvalue;

            (param[49] = new OracleParameter("p_bankGrantvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_bankGrantvalue;

            (param[50] = new OracleParameter("p_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_wh_com;
            (param[51] = new OracleParameter("p_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_wh_cd;
            (param[52] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_serial;


            (param[53] = new OracleParameter("pda", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pda;

            param[54] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //   UpdateRecords("pkg_imports_enquiry.sp_update_locationDetails", CommandType.StoredProcedure);
            effects = (Int16)UpdateRecords("pkg_imports_enquiry.sp_update_locationDetails", CommandType.StoredProcedure, param);
            return effects;


        }

        //fazan 2015-12-09
        public Int32 UpdateLog_Details(string company, string location, string opearation, string channel, string subchanel, string reference, string address1, string address2, string tel, string mobile, string fax, string contactperson, string country, string province, string district,
            string Email, string location_N, string town, string web, string categery, string p_grade, int sublocation, string mainLocationcd, int online, string managercd,
            int forwardQty, int suspended, int act, string createdby, DateTime createdate, string modifyby, DateTime modifydate, string sessionId, string anal1, string anal2, decimal ana13, decimal anal4, string anal5, DateTime anal6, string locationtype, int allowbin, string defpc, string sev_chnl, string p_auto_ain, string p_fx_loc, DateTime p_scm2_st, int p_chk_man, DateTime p_commencedon, decimal p_approvedstockvalue, int p_bankGrantvalue, string p_wh_com, string p_wh_cd, int p_serial, string logby, DateTime logdate, string logsession)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[57];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_operation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opearation;
            (param[3] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = channel;
            (param[4] = new OracleParameter("p_subchanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subchanel;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reference;
            (param[6] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = address1;
            (param[7] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = address2;
            (param[8] = new OracleParameter("p_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tel;
            (param[9] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobile;
            (param[10] = new OracleParameter("p_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fax;
            (param[11] = new OracleParameter("p_contact", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = contactperson;
            (param[12] = new OracleParameter("p_country", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[13] = new OracleParameter("p_province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[14] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;
            (param[15] = new OracleParameter("p_Email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Email;
            (param[16] = new OracleParameter("p_locationName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location_N;
            (param[17] = new OracleParameter("p_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = town;
            (param[18] = new OracleParameter("p_web", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = web;
            (param[19] = new OracleParameter("p_categery", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = categery;
            (param[20] = new OracleParameter("p_grade", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_grade;
            (param[21] = new OracleParameter("p_sublocation", OracleDbType.Int32, null, ParameterDirection.Input)).Value = sublocation;
            (param[22] = new OracleParameter("p_mainlocationcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mainLocationcd;
            (param[23] = new OracleParameter("p_online", OracleDbType.Int32, null, ParameterDirection.Input)).Value = online;
            (param[24] = new OracleParameter("p_manegerCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = managercd;
            (param[25] = new OracleParameter("p_forwardsale", OracleDbType.Int32, null, ParameterDirection.Input)).Value = forwardQty;
            (param[26] = new OracleParameter("p_suspended", OracleDbType.Int32, null, ParameterDirection.Input)).Value = suspended;
            (param[27] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = act;
            (param[28] = new OracleParameter("p_createby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createdby;
            (param[29] = new OracleParameter("p_createdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = createdate;
            (param[30] = new OracleParameter("p_modifyby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifyby;
            (param[31] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = modifydate;

            (param[32] = new OracleParameter("p_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
            (param[33] = new OracleParameter("p_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = anal1;
            (param[34] = new OracleParameter("p_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = anal2;

            (param[35] = new OracleParameter("p_anal3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ana13;
            (param[36] = new OracleParameter("p_anal4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = anal4;

            (param[37] = new OracleParameter("p_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = anal5;
            (param[38] = new OracleParameter("p_anal6", OracleDbType.Date, null, ParameterDirection.Input)).Value = anal6;

            (param[39] = new OracleParameter("p_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locationtype;
            (param[40] = new OracleParameter("p_allow_bin", OracleDbType.Int32, null, ParameterDirection.Input)).Value = allowbin;
            (param[41] = new OracleParameter("p_def_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = defpc;
            (param[42] = new OracleParameter("p_sev_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sev_chnl;
            (param[43] = new OracleParameter("p_auto_ain", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_auto_ain;
            (param[44] = new OracleParameter("p_fx_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_fx_loc;
            (param[45] = new OracleParameter("p_scm2_st", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_scm2_st;
            (param[46] = new OracleParameter("p_chk_man", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_chk_man;
            (param[47] = new OracleParameter("p_commencedon", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_commencedon;

            (param[48] = new OracleParameter("p_approvedstockvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_approvedstockvalue;

            (param[49] = new OracleParameter("p_bankGrantvalue", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_bankGrantvalue;

            (param[50] = new OracleParameter("p_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_wh_com;
            (param[51] = new OracleParameter("p_wh_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_wh_cd;
            (param[52] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_serial;
            (param[53] = new OracleParameter("p_logby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = logby;
            (param[54] = new OracleParameter("p_logdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = logdate;
            (param[55] = new OracleParameter("p_log_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = logsession;

            param[56] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //   UpdateRecords("pkg_imports_enquiry.sp_update_locationDetails", CommandType.StoredProcedure);
            effects = (Int16)UpdateRecords("pkg_imports_enquiry.sp_Insert_LogDetails", CommandType.StoredProcedure, param);
            return effects;



        }


        //fazan 2015-12-09
        public DataTable getDistrictDetails(string p_code)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbldistrict", "pkg_imports_enquiry.sp_province", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //fazan 2015-12-09
        public DataTable getTownDetails(string country, string province, string district)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("c_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[2] = new OracleParameter("d_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = district;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbltown", "pkg_imports_enquiry.sp_Town", CommandType.StoredProcedure, false, param);
            return dt;

        }

        //fazan 2015-12-09
        public DataTable SortBLDetails(string BL_NO, string Doc_No, string Ref_No, string Entry_No)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("BL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL_NO;
            (param[1] = new OracleParameter("Doc_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc_No;
            (param[2] = new OracleParameter("Ref_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Ref_No;
            (param[3] = new OracleParameter("Entry_No", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Entry_No;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblbl", "pkg_imports_Enquiry.SP_BL_NO_search", CommandType.StoredProcedure, false, param);
            return dt;

        }

        //fazan 2015-12-09
        public DataTable invoiceInfo()
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblinvoice", "pkg_imports_Enquiry.SP_INVOICE_INFO", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 2015-12-11
        public DataTable InvoiceWarranty_INFO(string serialno, string warrantyno, string invoice, string dono)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("serial_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serialno;
            (param[1] = new OracleParameter("warranty_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = warrantyno;
            (param[2] = new OracleParameter("invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoice;
            (param[3] = new OracleParameter("do_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dono;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblsearchinv", "pkg_imports_Enquiry.SP_InvoiceWarranty_INFO", CommandType.StoredProcedure, false, param);
            return dt;

        }

        //fazan 2015-12-11
        public Int32 Inventorysmst_Update(int warranty_period, string Remarks, string customer, string Details, DateTime warrentyDt, int serialid)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[7];
            int effects = 0;
            (param[0] = new OracleParameter("warranty_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = warranty_period;
            (param[1] = new OracleParameter("Remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Remarks;
            (param[2] = new OracleParameter("customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
            (param[3] = new OracleParameter("Details", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details;
            (param[4] = new OracleParameter("warrentyDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = warrentyDt;
            (param[5] = new OracleParameter("serialid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialid;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("pkg_imports_enquiry.SP_Inventorysmst_Update", CommandType.StoredProcedure, param);

            return effects;
        }





        //Tharaka 2015-12-10
        public DataTable GET_INTBATCH_BY_DOC(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntBatch", "SP_GET_INTBATCH_BY_DOC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2015-12-10
        public DataTable GET_SCM_BATCH_BY_DOC(string _docNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblIntBatch", "SP_GET_SCM_BATCH_BY_DOC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 14/Dec/2105
        public DataTable CheckDocIsInRepDB(string company, string request)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_inventory.sp_search_is_in_rpt_db", CommandType.StoredProcedure, false, param);
        }


        public Int32 warranty_amend_insert(string request_by, DateTime request_dt, string req_session, int req_serid, string status, string app_by, DateTime app_date, string app_session, int war_period, string war_remarks, DateTime warranty_stdt, string customer)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effect;
            (param[0] = new OracleParameter("request_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = request_by;
            (param[1] = new OracleParameter("request_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = request_dt;
            (param[2] = new OracleParameter("req_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = req_session;
            (param[3] = new OracleParameter("req_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = req_serid;
            (param[4] = new OracleParameter("status", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = status;
            (param[5] = new OracleParameter("app_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = app_by;
            (param[6] = new OracleParameter("app_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = app_date;
            (param[7] = new OracleParameter("app_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = app_session;
            (param[8] = new OracleParameter("RWR_WARR_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = war_period;
            (param[9] = new OracleParameter("RWR_WARR_RMK", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = war_remarks;

            (param[10] = new OracleParameter("RWR_ST_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = warranty_stdt;
            (param[11] = new OracleParameter("RWR_CUST_CD", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = customer;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effect = (Int16)UpdateRecords("pkg_imports_enquiry.sp_insert_warranty_amend", CommandType.StoredProcedure, param);

            return effect;
            // param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


        }

        //fazan 2015-12-16
        public DataTable get_warrenty_ammendData()
        {
            DataTable dt = null;

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblwarranty", "pkg_imports_enquiry.sp_get_warrantyamend_data", CommandType.StoredProcedure, false, param);
            return dt;


        }

        //fazan 2015-12-16
        public DataTable filter_warranty_approve(string war_from, string war_to)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("wa_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war_from;
            (param[1] = new OracleParameter("wa_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = war_to;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tbldtfltr", "pkg_imports_enquiry.sp_warranty_amend_app_Search", CommandType.StoredProcedure, false, param);
            return dt;


        }

        //Sahan 17/Dec/2105
        public DataTable CheckIsPDALoc(string company, string loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ml_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_inventory.sp_is_pda_loc", CommandType.StoredProcedure, false, param);
        }

        public DataTable getOperationCode()
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tblopcd", "pkg_imports_enquiry.SP_GET_operationCode", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //fazan 2015-12-16
        public DataTable searchtowndata(string countrycd, string description, string province, string district, string towncd)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("countrycd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = countrycd;
            (param[1] = new OracleParameter("description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = description;
            (param[2] = new OracleParameter("province", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[3] = new OracleParameter("district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province;
            (param[4] = new OracleParameter("towncd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = towncd;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tbldata", "pkg_imports_enquiry.sp_search_towndetails", CommandType.StoredProcedure, false, param);

            return dt;
        }

        //fazan  2015-12-17
        public DataTable s_districtDetails(string districtcd, string description, string provincecd)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("districtcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = districtcd;
            (param[1] = new OracleParameter("description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = description;
            (param[2] = new OracleParameter("provincecd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = provincecd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tbldstr", "pkg_imports_enquiry.sp_search_District_details", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Sahan 17/Dec/2105
        public DataTable CheckHasLoadingBay(string company, string doc, string loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_inventory.sp_check_is_no_loadbay", CommandType.StoredProcedure, false, param);
        }

        //Sahan 17/Dec/2105
        public Int32 DeleteRepSerials(Int32 seqno, string doc)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_tus_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqno;
            (param[1] = new OracleParameter("p_tus_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_inventory.sp_delete_temp_serial", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 17/Dec/2015
        public List<ReptPickSerials> GetTempPickSerialBySeqNo(Int32 seqno, string _docNo, string company, string loc)
        {
            List<ReptPickSerials> _scanList = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_tus_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqno;
            (param[1] = new OracleParameter("p_tus_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[3] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("temp_pick_ser@scmrep", "pkg_inventory.sp_load_serials", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                _scanList = DataTableExtensions.ToGenericList<ReptPickSerials>(_tblScan, ReptPickSerials.ConvertTotal);
            }

            return _scanList;
        }

        public DataTable getGrn_details(string doc_no)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tbgrn", "pkg_imports_enquiry.sp_grn_details", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable warehouse_company(string p_mw_com)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_mw_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mw_com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tblwarehouse", "pkg_imports_enquiry.sp_warehouse_details", CommandType.StoredProcedure, false, param);
            return dt;

        }

        public DataTable GetOperationCode(string com_cd, string loc_cd)
        {
            DataTable dt = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com_cd;
            (param[1] = new OracleParameter("loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc_cd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt = QueryDataTable("tbloperationcd", "pkg_imports_enquiry.sp_operation_cd", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharaka 2015-12-23
        public DataTable GetItemBalanceForBIN(string _company, string _location, string _item, string _status, String BIN)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BIN;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "SP_INVBALANCESTUS_BIN", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        public DataTable getchaneldescription(string company, string code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblchnl = QueryDataTable("tblchn", "pkg_imports_enquiry.sp_get_channel", CommandType.StoredProcedure, false, param);
            return _tblchnl;
        }

        public DataTable getdistrictDetails(string province_cd, string districtcd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = province_cd;
            (param[1] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = districtcd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbldistrict = QueryDataTable("tbldistrict", "pkg_imports_enquiry.sp_province_details", CommandType.StoredProcedure, false, param);
            return _tbldistrict;

        }

        //fazan 2015-12-29
        public DataTable getunitCost(string itemcode, string serial)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[1] = new OracleParameter("serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable cost = QueryDataTable("tblcost", "pkg_imports_enquiry.sp_get_unitcost", CommandType.StoredProcedure, false, param);
            return cost;



        }


        public DataTable getStorageDetails(string itemcode, string serial)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[1] = new OracleParameter("serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tblstorage", "pkg_imports_enquiry.sp_get_storagedetails", CommandType.StoredProcedure, false, param);
            return dt;

        }

        //Tharaka 2015-12-28
        public List<MST_COM_LOGI_COST> GET_LOGI_COST(String com, String ItemCType, String BINType, Int32 Derection)
        {
            List<MST_COM_LOGI_COST> _scanList = null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITM_C_TY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ItemCType;
            (param[2] = new OracleParameter("P_BIN_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BINType;
            (param[3] = new OracleParameter("P_DIREC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Derection;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("MST_COM_LOGI_COST", "SP_GET_LOGI_COST", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                _scanList = DataTableExtensions.ToGenericList<MST_COM_LOGI_COST>(_tblScan, MST_COM_LOGI_COST.Converter);
            }
            return _scanList;
        }


        //Tharaka 2015-12-29
        public Int32 SaveIntBatchLogiCost(INT_BATCHLOGICOST oBatchCost)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[32];
            (param[0] = new OracleParameter("P_ITBC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_seq_no;
            (param[1] = new OracleParameter("P_ITBC_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_itm_line;
            (param[2] = new OracleParameter("P_ITBC_BATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_batch_line;
            (param[3] = new OracleParameter("P_ITBC_COST_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cost_line;
            (param[4] = new OracleParameter("P_ITBC_BATCH_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_batch_no;
            (param[5] = new OracleParameter("P_ITBC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_doc_no;
            (param[6] = new OracleParameter("P_ITBC_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_doc_dt;
            (param[7] = new OracleParameter("P_ITBC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_com;
            (param[8] = new OracleParameter("P_ITBC_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_sbu;
            (param[9] = new OracleParameter("P_ITBC_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_channel;
            (param[10] = new OracleParameter("P_ITBC_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_loc;
            (param[11] = new OracleParameter("P_ITBC_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_bin;
            (param[12] = new OracleParameter("P_ITBC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_itm_cd;
            (param[13] = new OracleParameter("P_ITBC_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_itm_stus;
            (param[14] = new OracleParameter("P_ITBC_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_qty;
            (param[15] = new OracleParameter("P_ITBC_UNIT_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_unit_cost;
            (param[16] = new OracleParameter("P_ITBC_COST_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cost_cat;
            (param[17] = new OracleParameter("P_ITBC_COST_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cost_tp;
            (param[18] = new OracleParameter("P_ITBC_COST_ELE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cost_ele;
            (param[19] = new OracleParameter("P_ITBC_LOGI_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_logi_cost;
            (param[20] = new OracleParameter("P_ITBC_DIRECT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_direct;
            (param[21] = new OracleParameter("P_ITBC_NO_OF", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_no_of;
            (param[22] = new OracleParameter("P_ITBC_INDOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_indoc_no;
            (param[23] = new OracleParameter("P_ITBC_INDOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_indoc_dt;
            (param[24] = new OracleParameter("P_ITBC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_act;
            (param[25] = new OracleParameter("P_ITBC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cre_by;
            (param[26] = new OracleParameter("P_ITBC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cre_dt;
            (param[27] = new OracleParameter("P_ITBC_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_cre_session;
            (param[28] = new OracleParameter("P_ITBC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_mod_by;
            (param[29] = new OracleParameter("P_ITBC_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_mod_dt;
            (param[30] = new OracleParameter("P_ITBC_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oBatchCost.Itbc_mod_session;
            param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_INT_BATCHLOGICOST", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-12-29
        public Int32 SaveInrSermstCost(INR_SERMSTCOST oItem)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[24];
            (param[0] = new OracleParameter("P_IRSMC_SER_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsmc_ser_id;
            (param[1] = new OracleParameter("P_IRSMC_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_com;
            (param[2] = new OracleParameter("P_IRSMC_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_sbu;
            (param[3] = new OracleParameter("P_IRSMC_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_channel;
            (param[4] = new OracleParameter("P_IRSMC_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_loc;
            (param[5] = new OracleParameter("P_IRSMC_COST_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_cost_cat;
            (param[6] = new OracleParameter("P_IRSMC_COST_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_cost_tp;
            (param[7] = new OracleParameter("P_IRSMC_COST_ELE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_cost_ele;
            (param[8] = new OracleParameter("P_IRSMC_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItem.Irsmc_cost;
            (param[9] = new OracleParameter("P_IRSMC_DIRECT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsmc_direct;
            (param[10] = new OracleParameter("P_IRSMC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_doc_no;
            (param[11] = new OracleParameter("P_IRSMC_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Irsmc_doc_dt;
            (param[12] = new OracleParameter("P_IRSMC_UNIT_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItem.Irsmc_unit_cost;
            (param[13] = new OracleParameter("P_IRSMC_NO_OF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsmc_no_of;
            (param[14] = new OracleParameter("P_IRSMC_INDOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_indoc_no;
            (param[15] = new OracleParameter("P_IRSMC_INDOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Irsmc_indoc_dt;
            (param[16] = new OracleParameter("P_IRSMC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItem.Irsmc_act;
            (param[17] = new OracleParameter("P_IRSMC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_cre_by;
            (param[18] = new OracleParameter("P_IRSMC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Irsmc_cre_dt;
            (param[19] = new OracleParameter("P_IRSMC_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_cre_session;
            (param[20] = new OracleParameter("P_IRSMC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_mod_by;
            (param[21] = new OracleParameter("P_IRSMC_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItem.Irsmc_mod_dt;
            (param[22] = new OracleParameter("P_IRSMC_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItem.Irsmc_mod_session;
            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("SP_SAVE_INR_SERMSTCOST", CommandType.StoredProcedure, param);
            return result;
        }
        public DataTable get_noofdays(string itemcode, string serial)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[1] = new OracleParameter("serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable ds = QueryDataTable("tbldays", "pkg_imports_enquiry.sp_get_noofdays", CommandType.StoredProcedure, false, param);
            return ds;
        }

        //fazan 2015-12-31
        public DataTable WarehouseDeatils(string towncode, string countrycode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("towncode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = towncode;
            (param[1] = new OracleParameter("countrycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = countrycode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tblwarehouse", "pkg_imports_enquiry.sp_get_T_details", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable Loc_Details()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tbllocd", "pkg_imports_enquiry.sp_get_location_D", CommandType.StoredProcedure, false, param);
            return dt;

        }

        public DataTable Total_unit_handled(string company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tblunithandle", "pkg_imports_enquiry.sp_get_total_unit_handed", CommandType.StoredProcedure, false, param);
            return dt;

        }

        public DataTable Total_document_handled(string company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("tbldocumenthnd", "pkg_imports_enquiry.sp_get_total_document_handed", CommandType.StoredProcedure, false, param);
            return dt;
        }
        //Written by Rukshan 24/Dec/2015
        public DataTable GETSEARCHRESERVATION(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _res = null;
            string _type = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "RESERVATION NO":
                        _res = _searchText;
                        break;

                    case "TYPE":
                        _type = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _res = (_res != null) ? (_res.ToUpper() + "%") : null;
            _type = (_type != null) ? (_type.ToUpper() + "%") : null;


            // sp_searchmrn(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_request in NVARCHAR2,p_ref in NVARCHAR2,p_status in NVARCHAR2, c_data out SYS_REFCURSOR)
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_CUST", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("P_Res", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _res;
            (param[4] = new OracleParameter("P_Type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblInvoiceSearch", "pkg_search_inv.SP_RESERVATION_Cus", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Rukshan 30/Dec/2015
        public DataTable GetItemInventoryBalancechanel(string _company, string _Item, string _status, string _DFDP)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("P_DFDP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DFDP;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_imp.SP_GETSTOCK_BAL_CNL", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        //Sahan 14/Jan/2015
        public DataTable LoadItemsBySerial(string item, string serial)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[1] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_ser", "pkg_inventory.sp_load_items_by_ser", CommandType.StoredProcedure, false, param);
        }

        //Sahan 14/Jan/2015
        public DataTable CheckAbilityMainItemSplit(string item)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_itm", "pkg_inventory.sp_check_main_itm_split", CommandType.StoredProcedure, false, param);
        }

        //Sahan 18/Jan/2015
        public List<InventorySubSerialMaster> GetAvailablesubSerilsMainWeb(String _ItemCode)
        {
            List<InventorySubSerialMaster> _sersWeb = new List<InventorySubSerialMaster>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_micp_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblMovSerialsWeb = QueryDataTable("mst_itm_component", "pkg_inventory.sp_load_main_split_sub_serials", CommandType.StoredProcedure, false, param);
            if (_tblMovSerialsWeb.Rows.Count > 0)
            {
                _sersWeb = DataTableExtensions.ToGenericList<InventorySubSerialMaster>(_tblMovSerialsWeb, InventorySubSerialMaster.ConvertSelected);
            }

            return _sersWeb;
        }

        //Rukshan 20/Jan/2016
        public DataTable GETREQ_TRACKER_DATA_BY_CUSTEMER(string _customer, string _reqno, string _proftcenter, string _Loc, DateTime _ReqDateFrom, DateTime _ReqDateTo)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[2] = new OracleParameter("p_ProC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _proftcenter;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[4] = new OracleParameter("p_ReqDateFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ReqDateFrom;
            (param[5] = new OracleParameter("p_ReqDateTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ReqDateTo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblTracker", "pkg_imports_Enquiry.SP_GET_REQ_TRACKER_DATA_BY_CU", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        //Rukshan 20/Jan/2016
        public DataTable GETREQ_TRACKER_DATA_BY_REQNO(string _reqno, string _entryno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[1] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblTracker", "pkg_imports_Enquiry.SP_GET_REQ_TRACKER_DATA_BY_REQ", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        //Rukshan 20/Jan/2016
        public DataTable GETREQ_TRACKER_DATA_BY_ENTRYNO(string _entryno, int _IsSumQty, string _item, DateTime _ReqDateFrom, DateTime _ReqDateTo, string _cat1)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[1] = new OracleParameter("p_IsqtySum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _IsSumQty;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_Cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[4] = new OracleParameter("p_ReqDateFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ReqDateFrom;
            (param[5] = new OracleParameter("p_ReqDateTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ReqDateTo;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblTracker", "pkg_imports_Enquiry.SP_GET_REQ_TRACKER_DATA_BY_EN", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        //Rukshan 20/Jan/2016
        public DataTable GETREQ_TRACKER_DATA_BY_ENTRYNO_DO(string _entryno, int _IsSumQty)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[1] = new OracleParameter("p_IsqtySum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _IsSumQty;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblTracker", "pkg_imports_Enquiry.SP_GET_REQ_TRACKER_DATA_BY_EN2", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        public DataTable GETREQ_TRACKER_DATA_BY_ENTRYNO_DO_NEW(string _entryno, int _IsSumQty, int _derction)
        {
            DataTable _tblBalance;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[1] = new OracleParameter("p_IsqtySum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _IsSumQty;
            (param[2] = new OracleParameter("p_ith_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _derction;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (_derction == 99)
            {
                _tblBalance = QueryDataTable("_tblTracker", "SP_GE_RE_TRAC_DATA_BY_RAB", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _tblBalance = QueryDataTable("_tblTracker", "pkg_imports_Enquiry.SP_GE_RE_TRAC_DATA_BY_EN2_new", CommandType.StoredProcedure, false, param);
            }

            return _tblBalance;
        }

        //Rukshan 21/Jan/2016
        public DataTable GETREQ_TRACKER_DATA_BY_DATE(DateTime _ReqDateFrom, DateTime _ReqDateTo, DateTime _ExpectedFrom, DateTime ExpectedTo, int _dateoption, string _sts = null)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ReqDateFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ReqDateFrom;
            (param[1] = new OracleParameter("p_ReqDateTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ReqDateTo;
            (param[2] = new OracleParameter("p_ExpectedFrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ExpectedFrom;
            (param[3] = new OracleParameter("p_ExpectedTo", OracleDbType.Date, null, ParameterDirection.Input)).Value = ExpectedTo;
            (param[4] = new OracleParameter("p_dateoption", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _dateoption;
            (param[5] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sts;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblTracker", "pkg_imports_Enquiry.SP_GET_REQ_TRACKER__BY_DATE", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        public decimal GET_PREVIOUS_SALES_QTY(string _com, string _loc, DateTime _fromdate, DateTime _Todate, string _item, string _doctype)
        {
            decimal _qty = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_Fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[3] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Todate;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("_tblTracker", "pkg_search_inv.sp_get_Prev_Sale_qty", CommandType.StoredProcedure, false, param);
            if ((_tblBalance != null) && (_tblBalance.Rows.Count > 0))
            {
                _qty = Convert.ToDecimal(_tblBalance.Rows[0][1].ToString());
                return _qty;
            }
            return _qty;
        }
        //Sahan 25 Jan 2016
        public DataTable LoadDistinctDates(string company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_itm", "pkg_inventory.sp_load_distinct_dates", CommandType.StoredProcedure, false, param);

        }

        //Sahan 25 Jan 2016
        public DataTable GetSlowMovingInventoryDetails(string company, DateTime fromdate, DateTime todate, DateTime selecteddate, string item, string model, string brand, string cat)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("pfromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("ptodate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_selecteddate", OracleDbType.Date, null, ParameterDirection.Input)).Value = selecteddate;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[7] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("glb_slow_moving_inventory", "sp_slow_moving_new", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Sahan 25 Jan 2016
        public DataTable LoadAgeSlots(string company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("ref_age_slot", "pkg_inventory.sp_load_age_slots", CommandType.StoredProcedure, false, param);
        }
        // Tharaka 2016-01-21
        public DataTable GET_DISPOSAL_ITMS(String Disposaljob)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_JOBP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Disposaljob;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblMovSerialsWeb = QueryDataTable("mst_itm_component", "SP_GET_DISPOSAL_ITMS", CommandType.StoredProcedure, false, param);
            return _tblMovSerialsWeb;
        }

        // Tharaka 2016-01-21
        public DataTable GET_DISPOSAL_SERIALS(String Disposaljob)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Disposaljob;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblMovSerialsWeb = QueryDataTable("mst_itm_component", "SP_GET_DISPOSAL_SERIALS", CommandType.StoredProcedure, false, param);
            return _tblMovSerialsWeb;
        }

        //Sahan 26 Jan 2016
        public DataTable LoadInventoryByExpiryDate(string company, string item, string isordbyloc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("p_ordbyloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isordbyloc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_batch", "pkg_inventory.sp_get_inv_by_exp_date", CommandType.StoredProcedure, false, param);
        }



        public Int16 UpdateSerialAvailability(string company, string location, string _item, string _ser)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_serilaAvailability", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable Get_GIT_Details(DateTime _asat, string _com, string _loc, string in_Itemcode, string in_Brand, string in_Model, string in_Itemcat1,
            string in_Itemcat2, string in_Itemcat3, string in_Itemcat4, string in_Itemcat5, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[13];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asat;
            (param[4] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Itemcat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            _dtResults = QueryDataTable("tbl", "sp_get_git", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 8 Feb 2016
        public DataTable LoadBinCodeItem(string company, string location)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_ser", "pkg_inventory.sp_load_bin_code_itm", CommandType.StoredProcedure, false, param);
        }

        //Sahan 8 Feb 2016
        public List<InventorySubSerialMaster> LoadItemCompoData(string item)
        {
            List<InventorySubSerialMaster> _sers = new List<InventorySubSerialMaster>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblMovSerialsComponents = QueryDataTable("mst_itm_kit_component", "pkg_inventory.sp_load_item_compo_data", CommandType.StoredProcedure, false, param);


            if (_tblMovSerialsComponents.Rows.Count > 0)
            {
                _sers = DataTableExtensions.ToGenericList<InventorySubSerialMaster>(_tblMovSerialsComponents, InventorySubSerialMaster.ConvertSelected);
            }

            return _sers;
        }

        //Sahan 9 Feb 2016
        public DataTable SearchSerialByItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL":
                        _serial = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _serial = (_serial != null) ? (_serial.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("inr_ser", "pkg_inventory.sp_load_serial_by_item", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 10 Feb 2016
        public DataTable LoadLocationAndStatusMainItem(string item, string company, string location)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_ser", "pkg_inventory.sp_load_itm_loc_and_stus", CommandType.StoredProcedure, false, param);
        }

        //Tharaka 2015-12-28
        public InventoryHeader GetINTHDRByOthDoc(String Com, String Type, String OthDoc)
        {
            InventoryHeader oResult = new InventoryHeader();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            (param[2] = new OracleParameter("P_OTH_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OthDoc;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("MST_COM_LOGI_COST", "SP_GET_DOC_BY_OTH_DOC", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<InventoryHeader>(_tblScan, InventoryHeader.ConvertTotal)[0];
            }
            return oResult;
        }
        //kapila
        public DataTable Get_INTHDRByOthDoc(String Com, String Type, String OthDoc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            (param[2] = new OracleParameter("P_OTH_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OthDoc;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("MST_COM_LOGI_COST", "SP_GET_DOC_BY_OTH_DOC", CommandType.StoredProcedure, false, param);

            return _tblScan;
        }

        //Randima 2016/11/29
        public List<InventoryHeader> GetINTHDRByDispDoc(String Com, String jobNo)
        {
            List<InventoryHeader> oResult = new List<InventoryHeader>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("int_hdr", "SP_GET_DOCNO_BY_DISPJOB", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<InventoryHeader>(_tblScan, InventoryHeader.ConvertTotal);
            }
            return oResult;
        }
        //SUBODANA
        public InventoryHeader GetINTHDRByDocnO(String Com, String Type, String OthDoc)
        {
            InventoryHeader oResult = new InventoryHeader();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            (param[2] = new OracleParameter("P_OTH_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OthDoc;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("MST_COM_LOGI_COST", "SP_GET_DOC_BY_DOC_NO", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<InventoryHeader>(_tblScan, InventoryHeader.ConvertTotal)[0];
            }
            return oResult;
        }
        //Sahan 11 Feb 2016
        public DataTable CheckIsItemDiscontinue(string item)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_itm_replace", "pkg_inventory.sp_check_is_discontinue", CommandType.StoredProcedure, false, param);
        }

        //Rukshan 11/Feb/2016
        public int CANCEL_MRN(string _com, string _loc, string _reqno, string _status, string _modby, DateTime _moddate)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[7];
            //p_frm_com in NVARCHAR2 , p_frm_loc  in NVARCHAR2, p_to_com  in NVARCHAR2, p_to_cat  in NVARCHAR2, p_allow  in NUMBER, p_cre_by  in NVARCHAR2,o_effect out number
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modby;
            (param[5] = new OracleParameter("p_mod_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _moddate;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("pkg_inventory.sp_cancel_MRN", CommandType.StoredProcedure, param);
            return (Int32)effected;
        }

        //Sahan 15 Feb 2016
        public DataTable LoadSerialStatus(string company, string location, string itemcode, string serial1, string serial2, string serial3, Int32 serialstus)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[3] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial1;
            (param[4] = new OracleParameter("p_ins_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial2;
            (param[5] = new OracleParameter("p_ins_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial3;
            (param[6] = new OracleParameter("p_serialstus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialstus;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_ser", "pkg_pda.sp_load_serial_data", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Rukshan 2016-2-15
        public Int32 Update_ResHeaderStatus(string STATUS, string USER, string COM, string MRN)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = STATUS;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = USER;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[3] = new OracleParameter("P_MRN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MRN;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.SP_UPDATE_INT_RES_STUS", CommandType.StoredProcedure, param);
            return effects;
        }

        public decimal GetLatestCost_Loc(string _company, string _location)
        {
            //sp_get_dp_latest_cost 
            OracleParameter[] param = new OracleParameter[3];
            Decimal effects = 0;
            DataTable _reult = new DataTable();
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            // OracleParameter _outParam = new OracleParameter("c_data", OracleDbType.Decimal, null, ParameterDirection.Output);
            //_reult = Convert.ToDecimal(ReturnSP_Single_DecimalValue("pkg_search_inv.SP_CURRENT_COST_LOC", CommandType.StoredProcedure, _outParam, param));
            _reult = QueryDataTable("inr_ser", "pkg_search_inv.SP_CURRENT_COST_LOC", CommandType.StoredProcedure, false, param);

            if (_reult != null)
            {
                if (_reult.Rows.Count > 0)
                {
                    string value = _reult.Rows[0][0].ToString();
                    if (!string.IsNullOrEmpty(value))
                    {
                        effects = Convert.ToDecimal(_reult.Rows[0][0].ToString());
                    }

                }

            }
            return effects;
        }

        //Rukshan 2016-2-19
        public decimal GET_INSVALUE_BYLOC(string _company, string _location)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            OracleParameter _outParam = new OracleParameter("c_data", OracleDbType.Decimal, null, ParameterDirection.Output);
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("pkg_search_inv.SP_GET_INS_BY_LOC", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        //Sahan 23/Feb/2015
        public Int32 UpdateLoadingBay(ReptPickHeader _Header)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Header.Tuh_load_bay;
            (param[1] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Header.Tuh_usr_com;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Header.Tuh_usr_loc;
            (param[3] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Header.Tuh_wh_com;
            (param[4] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Header.Tuh_wh_loc;
            (param[5] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Header.Tuh_doc_no;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_pda.sp_update_loadingbay", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Sahan 23 Feb 2016
        public DataTable LoadBLData(string doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("imp_bl_hdr", "pkg_inventory.sp_get_bl_data", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 23 Feb 2016
        public DataTable LoadFinDataNumber(string doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("imp_bl_itm", "pkg_inventory.sp_get_fin_data", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 23 Feb 2016
        public DataTable LoadFinData(string doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("imp_fin_hdr", "pkg_inventory.sp_get_fin_data_all", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 23 Feb 2016
        public DataTable LoadSerialId(string company, string location, string serial, Int32 type)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[3] = new OracleParameter("p_is_ser_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_ser", "pkg_inventory.sp_load_serial_id", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 23 Feb 2016
        public DataTable LoadSerialEnquiryData(Int32 serialid)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_irsm_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialid;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_sermst", "pkg_inventory.sp_load_serial_enq_data", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetINV_BAL_STUS_LPAND_IMP(string _company, string _location, string _item, string _status)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.SP_INV_BAL_STUS_LPAND_IMP", CommandType.StoredProcedure, false, param);

            return _tblBalance;

        }

        //Sahan 2/Mar/2016
        public DataTable GetDocQty(Int32 seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sequencenumber", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_pda.sp_count_doc_qty", CommandType.StoredProcedure, false, param);
        }

        /*Lakshan 02-Mar-2016*/
        public List<InventorySerialMaster> GetSerialMasterData(InventorySerialMaster _ser)
        {
            List<InventorySerialMaster> _list = new List<InventorySerialMaster>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_irsm_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Irsm_itm_cd;
            (param[1] = new OracleParameter("p_IRSM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Irsm_com;
            (param[2] = new OracleParameter("p_IRSM_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Irsm_loc;
            (param[3] = new OracleParameter("p_irsm_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Irsm_ser_id;
            (param[4] = new OracleParameter("p_IRSM_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Irsm_doc_no;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAllInventoryRequestData", "pkg_inventory.sp_get_inr_ser_mst_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialMaster>(_dtResults, InventorySerialMaster.ConvertTotal);
            }
            return _list;
        }

        /*Lakshan 03-Mar-2016*/
        public Int32 GetBlItmMaxSeqNo(ImportsBLItems _itm)
        {
            Int32 seqNo = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ibi_fin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm.Ibi_fin_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblBlItm.", "pkg_imports.sp_get_bl_itm_max_seq_no", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_dtResults.Rows[0]["MaxSeq"].ToString()))
                {
                    if ((Int32.TryParse(_dtResults.Rows[0]["MaxSeq"].ToString(), out seqNo)))
                    {
                        seqNo = Convert.ToInt32(_dtResults.Rows[0]["MaxSeq"].ToString());
                    }
                }
            }
            return seqNo;
        }

        /*Lakshan 03-Mar-2016*/
        public DataTable getImpPiHdrTps(string _piNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ifp_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _piNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblBlItm.", "pkg_imports.sp_get_imp_pi_hdr_ip_tp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan 2016-3-4
        public decimal GET_SUM_USE_BL(string _bl, string _itm)
        {
            OracleParameter[] param = new OracleParameter[2];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[1] = new OracleParameter("p_bl_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            OracleParameter _outParam = new OracleParameter("c_data", OracleDbType.Decimal, null, ParameterDirection.Output);
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("pkg_search_inv.SP_SUM_USEBL", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }


        //2016-Mar-05 Lakshan
        public List<ItemKitComponent> GetItemKitComponentSplit(ItemKitComponent _obj)
        {
            List<ItemKitComponent> _sers = new List<ItemKitComponent>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mikc_itm_code_main", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.MIKC_ITM_CODE_MAIN;
            (param[1] = new OracleParameter("p_mikc_itm_code_component", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.MIKC_ITM_CODE_COMPONENT;
            (param[2] = new OracleParameter("p_mikc_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.MIKC_ACTIVE;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblMovSerialsComponents = new DataTable();
            if (string.IsNullOrEmpty(_obj.MIKC_ITM_CODE_MAIN) && string.IsNullOrEmpty(_obj.MIKC_ITM_CODE_COMPONENT))
            {
                return _sers;
            }
            else
            {
                _tblMovSerialsComponents = QueryDataTable("mst_itm_kit_component", "pkg_inventory.sp_get_mi_itm_cd_comp_split", CommandType.StoredProcedure, false, param);
                if (_tblMovSerialsComponents.Rows.Count > 0)
                {
                    _sers = DataTableExtensions.ToGenericList<ItemKitComponent>(_tblMovSerialsComponents, ItemKitComponent.ConverterSplit);
                }
            }
            return _sers;
        }

        //Code By Rukshan on 09/03/2016
        public int UpdatePOBalanceQty(int _seq_no, int _line_no, string _item_cd, decimal _act_qty)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq_no;
            (param[1] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line_no;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item_cd;
            (param[3] = new OracleParameter("p_act_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _act_qty;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Open the connection and call the stored procedure.
            //ConnectionOpen(); Edit (Comment) by Chamal 15-05-2012
            rows_affected = UpdateRecords("pkg_inventory.sp_update_po_itm_balqty", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Sahan 10 Mar 2016
        public Int32 UpdateSerialMaster(SerialMasterLog SerialMaster)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];
            try
            {
                (param[0] = new OracleParameter("p_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SerialMaster.Irsm_orig_grn_no;
                (param[1] = new OracleParameter("p_grn_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = SerialMaster.Irsm_doc_dt;
                (param[2] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SerialMaster.Irsm_com;
                (param[3] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SerialMaster.Irsm_loc;
                (param[4] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SerialMaster.Irsm_doc_no;

                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();
                rows_affected = UpdateRecords("pkg_inventory.update_ser_master", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }
            finally
            {
                ConnectionClose();
            }
            return rows_affected;
        }

        //Lakshan 14 Mar 2016
        public List<QuotationHeader> GetLatestValidQuotationData(string _com, string _sup, string _type, string _subtype, DateTime _date, decimal _qty, string _status, string _item)
        {
            List<QuotationHeader> _list = new List<QuotationHeader>();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sup;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tblsupplierquotation", "pkg_inventory.sp_get_valid_quot_data", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<QuotationHeader>(_tblData, QuotationHeader.ConvertQuotData);
            }
            return _list;
        }

        //15 Mar/2015 Sahan
        public DataTable LoadItemDataBySerial(string serial, string company, string location, string cat1, string cat2, string cat3)
        {
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[3] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[4] = new OracleParameter("p_mi_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[5] = new OracleParameter("p_mi_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_inventory.sp_get_item_data_by_serial", CommandType.StoredProcedure, false, param);
        }

        //Rukshan 16/Mar/2016
        public DataTable GET_TEMP_DOC(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _from, DateTime _To)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC #":
                        doc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[6] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_search_inv.SP_GET_TEMP_DOC", CommandType.StoredProcedure, false, param);
        }


        //Rukshan 2016-3-16
        public Int32 Update_Cost_hdr_grn(string doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.update_cost_grn_status", CommandType.StoredProcedure, param);
            return effects;
        }

        //Rukshan 16/Mar/2016
        public DataTable GET_TEMP_ITM(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string itm = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM CODE":
                        itm = _searchText;
                        break;
                    default:
                        break;
                }
            }

            itm = (itm != null) ? (itm.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_search_inv.SP_GET_TEMP_ITM", CommandType.StoredProcedure, false, param);
        }


        public DataTable GetItemTotalScanedQty(string docnum)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_docnum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docnum;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_pda.SP_GET_SCANEDQTY", CommandType.StoredProcedure, false, param);
        }
        public DataTable GetItemTotalDocumentQty(string docnum)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_docnum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docnum;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_pda.SP_GET_DOCUMENTQTY", CommandType.StoredProcedure, false, param);
        }

        public DataTable loadDocumentItems(string docnum)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_docnum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docnum;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_pda.SP_GET_DOCUMENTITEMS", CommandType.StoredProcedure, false, param);
        }

        //Rukshan 21/Mar/2016
        public DataTable Get_Root_Loc(string _company, string _root, string _loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_root", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _root;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_search_inv.SP_GET_ROOT_LOC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshan 23/Mar/2016
        public List<ReptPickSerials> GET_ReptPickSerials(ReptPickSerials _obj)
        {
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tus_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Tus_ser_id;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_inventory.sp_get_temp_pick_ser", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ReptPickSerials>(_dtResults, ReptPickSerials.ConvertSelect);
            }
            return _list;
        }
        //kapila
        public Boolean IsRccSerialFoundJob(string _Item, string _Serial, string _job)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (_para[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Serial;
            (_para[2] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean IsRccSerialFound = QueryDataTable("tbl", "sp_check_serial_jobrcc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return IsRccSerialFound;
        }

        //Rukshan 24/Mar/2016
        public DataTable Check_bl_GRN(string _loc, string _job, int lineno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[2] = new OracleParameter("p_lineno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lineno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("inr_batch", "pkg_search_inv.CHECK_BL_GRN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        /*Lakshan 29-Mar-2016*/
        public List<InventorySerialN> Get_INR_SER_DATA(InventorySerialN _ser)
        {
            List<InventorySerialN> _list = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_com;
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_loc;
            (param[2] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_cd;
            (param[3] = new OracleParameter("p_ins_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_stus;
            (param[4] = new OracleParameter("p_ins_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ser.Ins_ser_id;
            (param[5] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_ser_1;
            (param[6] = new OracleParameter("p_ins_available", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_available;
            (param[7] = new OracleParameter("p_ser_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ser.Ser_tp;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_ser.Ins_com) && string.IsNullOrEmpty(_ser.Ins_loc) && string.IsNullOrEmpty(_ser.Ins_itm_cd) && _ser.Ins_ser_id == 0 && string.IsNullOrEmpty(_ser.Ins_ser_1))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("INR_SER", "pkg_inventory.sp_get_inr_ser_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterNew);
                }
            }
            return _list;
        }

        /*Lakshan 30-Mar-2016*/
        public List<MasterItemComponent> Get_MST_ITM_COMPONENT(MasterItemComponent _ser)
        {
            List<MasterItemComponent> _list = new List<MasterItemComponent>();
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("p_micp_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Micp_itm_cd;
            (param[1] = new OracleParameter("p_micp_comp_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Micp_comp_itm_cd;
            (param[2] = new OracleParameter("p_micp_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Micp_itm_tp;
            (param[3] = new OracleParameter("p_micp_isprice", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ser.Micp_isprice;
            (param[4] = new OracleParameter("p_micp_cost_percentage", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ser.Micp_cost_percentage;
            (param[5] = new OracleParameter("p_micp_must_scan", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ser.Micp_must_scan;
            (param[6] = new OracleParameter("p_micp_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ser.Micp_qty;
            (param[7] = new OracleParameter("p_micp_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_ser.Micp_act);
            (param[8] = new OracleParameter("p_micp_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Micp_cate;
            (param[9] = new OracleParameter("p_mci_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Mci_com;
            (param[10] = new OracleParameter("p_mi_is_scansub", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Mi_is_scansub;
            (param[11] = new OracleParameter("p_mi_itm_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Mi_itm_tp;
            (param[12] = new OracleParameter("p_mi_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Mi_act;
            param[13] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_ser.Micp_itm_cd) && string.IsNullOrEmpty(_ser.Micp_comp_itm_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("tblAllInventoryRequestData", "pkg_inventory.sp_get_itm_comp_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<MasterItemComponent>(_dtResults, MasterItemComponent.Converter);
                }
            }
            return _list;
        }

        public DataTable getCurrentAgeDetails(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcat4, string _itemcat5,
            string _itemcode, string _brand, string _model, string _supplier, string _user, string _brndMan,Int16 isAgeMonitor)
        {
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat4;
            (param[7] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat5;
            (param[8] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[9] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("in_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[13] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[14] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;


            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_curr_age", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Randima 03 Oct 2016
        public DataTable getCurrentComAgeDetails(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan, int isAgeMonitor, string _user)
        {
            OracleParameter[] param = new OracleParameter[11];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "SP_GET_COM_CURR_AGE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonCurrAge(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user)
        {
            OracleParameter[] param = new OracleParameter[11];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_curr_age", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int getNearestSeqNo(string comp, DateTime fromdate, DateTime todate)
        {
            try
            {
                Int32 seq = -1;
                //DateTime endOfMonth = new DateTime(rundate.Year,
                //                     rundate.Month,
                //                     DateTime.DaysInMonth(rundate.Year,
                //                                          rundate.Month));
                DateTime frmDate = fromdate.AddDays(-1);
                OracleParameter[] param = new OracleParameter[3];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comp;
                (param[2] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDate.Date;
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_BALANCEDTSEQ", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    seq = (_dtResults.Rows[0]["PRD_SEQ_NO"] != DBNull.Value) ? Convert.ToInt32(_dtResults.Rows[0]["PRD_SEQ_NO"].ToString()) : -1;
                }
                return seq;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonCurrAgeLoc(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user)
        {
            OracleParameter[] param = new OracleParameter[11];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_curr_age_loc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonCurrAgeGIT(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, DateTime _astatdate)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _astatdate.Date;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_curr_git", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonAsatAgeSumm(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, int _seq)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_seq", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _seq;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_asat_age_sum", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonAsatAgeSummBal(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, int _seq)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_seq", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _seq;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_asat_age_bal", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonAsatAgeSummLoc(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, int _seq)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_seq", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _seq;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_asat_agesumloc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonAsatAgeSummLocBal(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, int _seq)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_seq", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _seq;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_asat_ageballoc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonAsatAgeSummLocGit(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, int _seq)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_seq", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _seq;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_asat_agegitloc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonAsatAgeSummLocGitBal(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, int _seq)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_seq", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _seq;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_asat_balgitloc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sanjeewa 2018-10-10
        public DataTable getAgeMonCurrAgeGITLoc(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcat3, string _itemcode, string _brand, string _model, int isAgeMonitor, string _user, DateTime _astatdate)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;
            (param[10] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[11] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _astatdate.Date;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_age_mon_curr_git_loc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getMigrationInvoiceDetails()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_mig_invoice", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int16 UpdateMigrationInvoiceDetails(string _invno, int _invline, decimal _tax, decimal _tot)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("in_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("in_invline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _invline;
            (param[2] = new OracleParameter("in_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tax;
            (param[3] = new OracleParameter("in_tot", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _tot;            
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_mig_invoice", CommandType.StoredProcedure, param);
            return effects;
        }
        //Wimal
        public DataTable getConsignmentStockWithValue(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan, bool IsAsat, DateTime _AsatDate)
        {
            OracleParameter[] param = new OracleParameter[10];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[9] = new OracleParameter("in_asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _AsatDate;
            DataTable _dtResults;
            if (IsAsat == true)
            {
                _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_cons_asat_stock", CommandType.StoredProcedure, false, param);
            }
            else
            {

                _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_cons_stock", CommandType.StoredProcedure, false, param);
            }
            return _dtResults;
        }

        public DataTable getCurrentComAgeDetails_serials(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan)
        {
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;


            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_curr_age_serial", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Randima 06 Oct 2016
        public DataTable getCurrentComAgeGIT(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan, DateTime _inDt, int isAgeMonitor)
        {
            OracleParameter[] param = new OracleParameter[11];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[9] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inDt;
            (param[10] = new OracleParameter("in_isAgeMonitor", OracleDbType.Int16, null, ParameterDirection.Input)).Value = isAgeMonitor;

            //DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_cur_age_git", CommandType.StoredProcedure, false, param)
            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_curr_age_git", CommandType.StoredProcedure, false, param);



            return _dtResults;
        }

        public DataTable getCurrentComAgeGIT_serial(string _com, string _loc, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan, DateTime _inDt)
        {
            OracleParameter[] param = new OracleParameter[10];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[4] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[5] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[7] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[8] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[9] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inDt;

            //DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_cur_age_git", CommandType.StoredProcedure, false, param)
            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_curr_age_git_serial", CommandType.StoredProcedure, false, param);



            return _dtResults;
        }

        //Lakshan 01 Apr 2016
        public List<ReptPickItems> GET_ReptPickItems(ReptPickItems _obj)
        {
            List<ReptPickItems> _list = new List<ReptPickItems>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Tui_req_itm_cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Tui_req_itm_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("tmpItm", "pkg_inventory.sp_get_temp_pick_itm", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<ReptPickItems>(_dtResults, ReptPickItems.Converter);
                }
            }
            return _list;
        }
        //Lakshan April 8 2016
        public List<InventorySubSerialMaster> GET_INR_SERMSTSUB(InventorySubSerialMaster _obj)
        {
            List<InventorySubSerialMaster> _list = new List<InventorySubSerialMaster>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_irsms_sub_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Irsms_sub_ser;
            (param[1] = new OracleParameter("p_irsms_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Irsms_itm_cd;
            (param[2] = new OracleParameter("p_irsms_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Irsms_ser_id;
            (param[3] = new OracleParameter("p_irsms_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Irsms_tp;
            (param[4] = new OracleParameter("p_irsms_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_obj.Irsms_act);
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Irsms_sub_ser) && string.IsNullOrEmpty(_obj.Irsms_itm_cd) && _obj.Irsms_ser_id == 0)
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("tbData", "pkg_inventory.sp_get_inr_sermstsub", CommandType.StoredProcedure, false, param);
                List<InventorySubSerialMaster> bizEnt = new List<InventorySubSerialMaster>();
                if (_dtResults.Rows.Count > 0)
                {
                    bizEnt = DataTableExtensions.ToGenericList<InventorySubSerialMaster>(_dtResults, InventorySubSerialMaster.ConvertTotal);
                }
            }
            return _list;
        }

        //Lakshan 09 Apr 2016
        public List<ImpAstHeader> GET_IMP_AST_HDR(ImpAstHeader _obj)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.ISTH_DOC_NO;
            (param[1] = new OracleParameter("p_isth_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.ISTH_STUS;
            (param[2] = new OracleParameter("p_isth_is_stl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_obj.ISTH_IS_STL);
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "pkg_inventory.sp_get_imp_ast_hdr", CommandType.StoredProcedure, false, param);
            List<ImpAstHeader> bizEnt = new List<ImpAstHeader>();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<ImpAstHeader>(_dtResults, ImpAstHeader.Converter);
            }
            return bizEnt;
        }
        public List<ImpAstDet> GET_Entry_no_Ammend(string _docNo, string _entryNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_ISTD_ENTRY_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "pkg_inventory.sp_get_entry_no_ammend", CommandType.StoredProcedure, false, param);
            List<ImpAstDet> bizEnt = new List<ImpAstDet>();
            if (_dtResults.Rows.Count > 0)
            {
                bizEnt = DataTableExtensions.ToGenericList<ImpAstDet>(_dtResults, ImpAstDet.Converter);
            }
            return bizEnt;
        }

        //subodana
        public DataTable getItemSerials(string doc)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("c_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_ITEMSERIALS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Written by Rukshan 
        public Int32 ROLLBACKLocationRes(string _company, string _location, string _item, string _stus, string _user, decimal _qty)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("pkg_inventory.SP_ROLLBACKLOCRES", CommandType.StoredProcedure, param);
        }
        //Written by Rukshan 
        public Int32 SaveBufferLevel(MasterBufferChannel _MasterBufferChannel)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_COM;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_CHNL;
            (param[2] = new OracleParameter("p_grad", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_GRADE;
            (param[3] = new OracleParameter("p_season", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_SEASON;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_ITM_CD;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_ITM_STUS;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_QTY;
            (param[7] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_ACT;
            (param[8] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_CRE_BY;
            (param[9] = new OracleParameter("p_cresession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_CRE_SESSION;
            (param[10] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_MOD_BY;
            (param[11] = new OracleParameter("p_modsession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_MOD_SESSION;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_inventory.sp_save_BufferLevel", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 26 Apr 2016
        public DataTable GetSupplierItemSerial(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string ser1 = null;
            string ser2 = null;
            string ser3 = null;
            string grn = null;
            string po = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL 1":
                        ser1 = _searchText;
                        break;

                    case "SERIAL 2":
                        ser2 = _searchText;
                        break;
                    case "SERIAL 3":
                        ser3 = _searchText;
                        break;
                    case "GRN #":
                        grn = _searchText;
                        break;
                    case "PO #":
                        po = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            // _ICode = (_ICode != null) ? (_ICode.ToUpper() + "%") : null;
            ser1 = (ser1 != null) ? (ser1.ToUpper() + "%") : null;
            ser2 = (ser2 != null) ? (ser2.ToUpper() + "%") : null;
            ser3 = (ser3 != null) ? (ser3.ToUpper() + "%") : null;
            grn = (grn != null) ? (grn.ToUpper() + "%") : null;
            po = (po != null) ? (po.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("p_ins_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[3] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            (param[4] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser1;
            (param[5] = new OracleParameter("p_ins_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser2;
            (param[6] = new OracleParameter("p_ins_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser3;
            (param[7] = new OracleParameter("p_grn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = grn;
            (param[8] = new OracleParameter("p_po", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = po;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.sp_search_sup_itm_ser", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Lakshan 27 Apr 2016
        public DataTable GetBLDetailsByModel(ImportsBLItems _impBlItm, MasterItem _item)
        {
            DataTable _dvResult = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_Ibi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _impBlItm.Ibi_itm_cd;
            (param[1] = new OracleParameter("p_Mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_model;
            (param[2] = new OracleParameter("p_mi_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_brand;
            (param[3] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_1;
            (param[4] = new OracleParameter("p_mi_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_2;
            (param[5] = new OracleParameter("p_mi_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Mi_cate_3;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //_dvResult = QueryDataTable("tblblsearch", "pkg_search_imp.sp_se_bl_hdr_by_model", CommandType.StoredProcedure, false, param);
            _dvResult = QueryDataTable("tblblsearch", "pkg_search_imp.sp_se_bl_hdr_by_model", CommandType.StoredProcedure, false, param);
            return _dvResult;
        }

        //Rukshan - 28/04/2016
        public int saveInrLocation(InventoryLocation _inventoryloc)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_loc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_itm_cd;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_itm_stus;
            (param[4] = new OracleParameter("p_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_bl_qty;
            (param[5] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_mod_by;
            (param[6] = new OracleParameter("p_inl_ro_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryloc.Inl_ro_qty;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_update_blLevel", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        /*Lakshan 29 Apr 2016*/
        public List<InventorySerialN> Get_INT_SER_DATA(InventorySerialN _ser)
        {
            List<InventorySerialN> _list = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_its_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_cd;
            (param[1] = new OracleParameter("p_its_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_ser_1;
            (param[2] = new OracleParameter("p_its_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_doc_no;
            (param[3] = new OracleParameter("p_its_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_com;
            (param[4] = new OracleParameter("p_its_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_loc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_ser.Ins_itm_cd) && string.IsNullOrEmpty(_ser.Ins_ser_1) && string.IsNullOrEmpty(_ser.Ins_doc_no) && string.IsNullOrEmpty(_ser.Ins_com) && string.IsNullOrEmpty(_ser.Ins_loc))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("INT_SER", "pkg_inventory.SP_GET_INT_SER_DATA", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterIntSer);
                }
            }
            return _list;
        }

        // Subodana 2016-05-05

        public List<InventoryAllocateDetails> getAllocationDet(DateTime fromdate, DateTime todate)
        {
            List<InventoryAllocateDetails> rec = new List<InventoryAllocateDetails>();
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("P_FRMDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (_para[1] = new OracleParameter("P_TODT", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            _para[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblJobs", "SP_GET_AllocDet", CommandType.StoredProcedure, false, _para);
            if (_dtResults.Rows.Count > 0)
            {
                rec = DataTableExtensions.ToGenericList<InventoryAllocateDetails>(_dtResults, InventoryAllocateDetails.Converter);
            }
            return rec;
        }

        // Lakshan 2016 May 06
        public List<InventoryAdhocHeader> GET_INT_ADHOC_HDR(InventoryAdhocHeader _obj)
        {
            List<InventoryAdhocHeader> _ListItems = new List<InventoryAdhocHeader>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_iadh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iadh_com;
            (param[1] = new OracleParameter("p_iadh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iadh_loc;
            (param[2] = new OracleParameter("p_iadh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iadh_loc;
            (param[3] = new OracleParameter("p_iadh_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iadh_ref_no;
            (param[4] = new OracleParameter("p_iadh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iadh_stus;
            (param[5] = new OracleParameter("p_iadh_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iadh_tp;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Iadh_com) && string.IsNullOrEmpty(_obj.Iadh_loc) && string.IsNullOrEmpty(_obj.Iadh_loc) && string.IsNullOrEmpty(_obj.Iadh_ref_no))
            {
                return _ListItems;
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "pkg_inventory.sp_get_int_adhoc_hdr", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _ListItems = DataTableExtensions.ToGenericList<InventoryAdhocHeader>(_dtResults, InventoryAdhocHeader.Converter);
                }
            }
            return _ListItems;
        }
        //Rukshan 06 May 2016
        public List<MasterBufferChannel> GetBufferQty_Season(string _item, string _com, string _loc, string _ses, int option)
        {
            List<MasterBufferChannel> _ListItems = new List<MasterBufferChannel>();
            DataTable _dvResult = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[3] = new OracleParameter("p_season", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ses;
            (param[4] = new OracleParameter("p_option", OracleDbType.Int32, null, ParameterDirection.Input)).Value = option;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //_dvResult = QueryDataTable("tblblsearch", "pkg_search_imp.sp_se_bl_hdr_by_model", CommandType.StoredProcedure, false, param);
            _dvResult = QueryDataTable("tblblsearch", "pkg_search_inv.sp_searchseasbuffer", CommandType.StoredProcedure, false, param);
            if (_dvResult.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<MasterBufferChannel>(_dvResult, MasterBufferChannel.Converter);
            }
            return _ListItems;
        }

        public DataTable getpurchaseOrderPrint_HDR_new(string _com, string _doc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_po_lopHdr_new", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //subodana 2016-05-17
        public DataTable getLocationDetails(string _com, string _channel, string _loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_FILTER_LOC_DET", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //subodana 2016-05-19
        public DataTable GET_ITEM_PROFILE_DETAILS(string _com, string cat1, string cat2, string cat3, string cat4, string cat5, string code, string brand, string model)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[2] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[3] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;
            (param[4] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat4;
            (param[5] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat5;
            (param[6] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[7] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[8] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_ITEMS_PROFILES", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana 2016-05-31
        public DataTable getRequestItemDetails(string _com, string _reqNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_ReqItmDet", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Written by Rukshan 16/oct/2015
        public List<MasterLocation> GetLoactionBychannel(string _channel)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<MasterLocation> _list = null;
            (param[0] = new OracleParameter("p_cnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_getloc_byloc", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.converter);
            }
            return _list;
        }

        //Written by Rukshan 03/Jun/2016
        public List<INT_REQ> GETREQBY_REF(string _DOC, string _COM, string _TYPE, string _ITM, int _LINE)
        {
            OracleParameter[] param = new OracleParameter[6];
            List<INT_REQ> _list = null;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TYPE;
            (param[3] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ITM;
            (param[4] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _LINE;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_getreqby_ref", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INT_REQ>(_dtResults, INT_REQ.Converter);
            }
            return _list;
        }
        //subodana 2016-06-03
        public DataTable getExistingSerial(string _serial, string _code, string docno, string status)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "pkg_pda.SP_GET_EXIS_SERIAL", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Int32 UpdateExistingSerialRecived(string _docno, Int32 serialno, Int32 reserved)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[1] = new OracleParameter("p_reserved", OracleDbType.Int32, null, ParameterDirection.Input)).Value = reserved;
            (param[2] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialno;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            ConnectionOpen();
            _eff = (Int32)UpdateRecords("pkg_pda.SP_UPDATE_USED_SERIAL", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _eff;
        }

        //Lakshan 04 Jun 2016
        public List<RepConditionType> GET_REF_COND_TP(RepConditionType _obj)
        {
            List<RepConditionType> _list = new List<RepConditionType>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_rct_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rct_com;
            (param[1] = new OracleParameter("p_rct_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rct_cate;
            (param[2] = new OracleParameter("p_rct_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rct_tp;
            (param[3] = new OracleParameter("p_rct_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Rct_act;
            (param[4] = new OracleParameter("p_rct_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rct_cat1;
            (param[5] = new OracleParameter("p_rct_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rct_cat2;
            (param[6] = new OracleParameter("p_rct_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Rct_cat3;
            (param[7] = new OracleParameter("p_rct_ini", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Rct_ini;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Rct_com) && string.IsNullOrEmpty(_obj.Rct_cate) && string.IsNullOrEmpty(_obj.Rct_tp))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "pkg_inventory.sp_get_ref_cond_tp", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<RepConditionType>(_dtResults, RepConditionType.Converter);
                }
            }
            return _list;
        }
        //subodana 2016-06-06
        public DataTable getINRSerial(string _serial, string _code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_InrSerialdata", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana 2016-06-06
        public DataTable GetTepItems(Int32 seq, string _code, string status = null,string userid=null,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[4] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_TemppickItems", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public MasterItemBlock GetBlockedItmByCatTp(string _company, string _profit, string _item, int _pricetype, string _catTp)
        {
            //sp_getblockeditembytype(p_com in NVARCHAR2 ,p_profitcenter in NVARCHAR2,p_item in NVARCHAR2,p_pricetype in NUMBER,c_data out sys_refcursor)

            MasterItemBlock _list = null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_pricetype", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pricetype;
            (param[4] = new OracleParameter("p_cattp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catTp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getblockeditmbycattp", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<MasterItemBlock>(_dtResults, MasterItemBlock.Converter)[0];

            return _list;
        }
        //public Int32 UpdateInrSerial(string _docno, Int32 serialno)
        //{
        //    int _eff = 0;
        //    OracleParameter[] param = new OracleParameter[3];

        //    (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
        //    (param[1] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialno;

        //    param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

        //    ConnectionOpen();
        //    _eff = (Int32)UpdateRecords("SP_UPDATE_USED_SERIAL", CommandType.StoredProcedure, param);
        //    ConnectionClose();
        //    return _eff;
        //}


        public DataTable GetTempPickLocations(string locationCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locationCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "pkg_pda.sp_search_temp_location", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getWarrantyPrintDetails(string _warrno, int _page, string _docno)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_warrno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrno;
            (param[2] = new OracleParameter("in_pageno", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _page;
            (param[3] = new OracleParameter("in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            DataTable _result = QueryDataTable("tbl", "sp_get_warranty_print_new", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getWarrantyPrintMobDetails(string _com, string _seqno, string _item, string _serial, int _page)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqno;
            (param[3] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("in_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("in_pageno", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _page;

            DataTable _result = QueryDataTable("tbl", "sp_get_warranty_print_new_mob", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Rukshan - 14/06/2016
        public List<QuotationHeader> GetLatestAllValidQuotation(string _com, string _sup, string _type, string _subtype, DateTime _date, decimal _qty, string _status, string _item)
        {
            List<QuotationHeader> _list = new List<QuotationHeader>();

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sup;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("p_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[7] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tblsupplierquotation", "pkg_inventory.sp_get_Allvalid_quot", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<QuotationHeader>(_tblData, QuotationHeader.ConvertQuotation2);
            }
            return _list;
        }
        //HW
        public List<InventoryLocation> GETWH_INV_BALANCE(string _company, string _location, string _item, string _status)
        {
            List<InventoryLocation> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.sp_WHInvbalance", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_tblBalance, InventoryLocation.ConvertTotal);
            }
            return _list;
        }
        //Lakshan 16 Jun 2016
        public DataTable SearchSerialsInr(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _available = string.IsNullOrEmpty(searchParams[1].ToString()) ? null : searchParams[1].ToString();
            string _serial1 = null;
            string _item = null;
            string _docNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        _serial1 = _searchText;
                        break;

                    case "ITEM CODE":
                        _item = _searchText;
                        break;
                    case "DOC #":
                        _docNo = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial1 = (_serial1 != null) ? (_serial1 + "%") : null;
            _item = (_item != null) ? (_item + "%") : null;
            _docNo = (_docNo != null) ? (_docNo + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ins_available", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[4] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_ins_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_ser_inr_ser", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Lakshan 16 Jun 2016
        public DataTable SearchSerialsIntByItem(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _serial1 = null;
            string _serial2 = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL 1":
                        _serial1 = _searchText;
                        break;
                    case "SERIAL 2":
                        _serial1 = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial1 = (_serial1 != null) ? (_serial1 + "%") : null;
            _serial2 = (_serial2 != null) ? (_serial2 + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_its_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_its_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_its_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_its_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[4] = new OracleParameter("p_its_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial2;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_ser_int_ser", CommandType.StoredProcedure, false, param);
            //DataTable _dtResults = QueryDataTable("tbl", "sp_ser_int_ser", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        //Add by Lakshan 20 Jun 2016
        public List<InventoryHeader> GET_INT_HDR_DATA(InventoryHeader _obj)
        {
            List<InventoryHeader> _list = new List<InventoryHeader>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_com;
            (param[1] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_loc;
            (param[2] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_doc_no;
            (param[3] = new OracleParameter("p_ith_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_oth_docno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = new DataTable();
            if (string.IsNullOrEmpty(_obj.Ith_com) && string.IsNullOrEmpty(_obj.Ith_loc) && string.IsNullOrEmpty(_obj.Ith_doc_no) && string.IsNullOrEmpty(_obj.Ith_oth_docno))
            {
                return _list;
            }
            else
            {
                _tblBalance = QueryDataTable("_tblBalance", "pkg_inventory.sp_get_int_hdr_data", CommandType.StoredProcedure, false, param);
                if (_tblBalance.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryHeader>(_tblBalance, InventoryHeader.ConvertTotal);
                }
            }
            return _list;
        }

        public DataTable GetItemInventoryBalanceStatus_RES(string _company, string _location, string _item, string _status)
        {
            //sp_invbalancestatus(p_com in NVARCHAR2,p_loc in NVARCHAR2 ,p_item in NVARCHAR2,p_status in NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.sp_Resinvbalancestatus", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        public List<InventoryHeader> GetIntHdrDatByDateRange(InventoryHeader obj, DateTime from, DateTime to, Int32 isDateRange)
        {
            List<InventoryHeader> _req = new List<InventoryHeader>();

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Ith_com;
            (param[1] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Ith_loc;
            (param[2] = new OracleParameter("p_ith_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = obj.Ith_entry_tp;
            (param[3] = new OracleParameter("p_is_date", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isDateRange;
            (param[4] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[5] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[6] = new OracleParameter("p_ith_isprinted", OracleDbType.Int32, null, ParameterDirection.Input)).Value = obj.Ith_isprinted;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("intHdr", "pkg_inventory.sp_get_int_hdr_warranty", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _req = DataTableExtensions.ToGenericList<InventoryHeader>(_dtResults, InventoryHeader.ConvertTotal);
            }
            return _req;
        }

        public DataTable getCurrentDocumentDetails(string p_tuh_usr_com, string p_tuh_doc_no, string p_tuh_usr_loc, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;
            (param[1] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_doc_no;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_loc;
            (param[3] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[4] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[5] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_pda.sp_get_doc_details", CommandType.StoredProcedure, false, param);
        }

        //Rukshan 2016-Jun-24
        public Int32 Update_req_hdr_grn(string _loc, string _modby, string _com, string _sino, string _tobond)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modby;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sino;
            (param[4] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.update_reqhddr_grn", CommandType.StoredProcedure, param);
            return effects;
        }

        //Add by Rukshan 27 Jun 2016
        public DataTable CHECK_TOBOND_GRN(string _com, string _doc, string _itm)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.SP_CHKTOBND_GRN", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        public DataTable CHECK_TOBOND_GRN_LTST(string _com, string _doc, string _itm)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "SP_CHKTOBND_GRNLATEST", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        public DataTable CHECK_TOBOND_GRN2(string _com, string _doc, string _itm, string _status)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "SP_CHKTOBND_GRN2", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        //Rukshan 2016-Jun-30
        public Int32 Update_Cusdec_bal(string _doc, decimal _qty, string _ITM, int jobline)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ITM;
            (param[3] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = jobline;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_inventory.update_cusdecBal", CommandType.StoredProcedure, param);
            return effects;
        }

        //Add By Lakshan 2016/Jun/2016
        public DataTable SearchSplitReCall(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime dtFrom, DateTime dtTo)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string subDoc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT #":
                        subDoc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            subDoc = (subDoc != null) ? (subDoc + "%") : null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ith_cate_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtFrom;
            (param[4] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtTo;
            (param[5] = new OracleParameter("p_ith_sub_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subDoc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.sp_ser_int_hdr_split", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                DataView dv = _tblBalance.DefaultView;
                dv.Sort = "Document # DESC";
                _tblBalance = dv.ToTable();
            }

            return _tblBalance;
        }


        //SUBODANA 2016-07-02
        public Int32 UpdateRequestItemFORSO(string _requestno, string _item, decimal _qty)
        {
            // sp_updaterequestqty(p_reqno in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATEREQUESTQTYFORSO", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdateRequestItemFORSONEW(string _requestno, string _item, decimal _qty, Int32 _lineno)
        {
            // sp_updaterequestqty(p_reqno in NVARCHAR2,p_item in NVARCHAR2,p_qty in NUMBER,o_effect out NUMBER)

            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _requestno;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[3] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATEREQUESTQTYFORSONEW", CommandType.StoredProcedure, param);
            return effects;
        }
        //Rukshan 2016-Jul-06
        public InventoryBatchN GET_INVENTBATCH_JOB(string _doc, string _itm)
        {
            InventoryBatchN oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "pkg_search_inv.sp_getBatch_byjob", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter)[0];

            return oResult;
        }
        public Int32 UpdateLocation_Batch_Res(string _company, string _location, string _item, string _stus, string _user, decimal _qty, string _doc)
        {
            // sp_updateaknowledgement(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_rcc in NVARCHAR2,p_ack in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("pkg_inventory.sp_uplocres_bres", CommandType.StoredProcedure, param);
        }


        //Add by Rukshan 27 Jun 2016
        public ImportsBLHeader GET_BLHDD_DOC(string _com, string _doc)
        {
            ImportsBLHeader oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_imp.SP_GET_BL_BY_DOC", CommandType.StoredProcedure, false, param);

            if (_tblBalance.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<ImportsBLHeader>(_tblBalance, ImportsBLHeader.Converter)[0];

            return oResult;
        }

        //Add by Rukshan 27 Jun 2016
        public List<INR_RES_DET> GET_RES_DOC(string _com, string _doc)
        {
            List<INR_RES_DET> oResult = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_imp.SP_GET_RES_BY_BL", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<INR_RES_DET>(_tblBalance, INR_RES_DET.ConverterNew);
            }

            return oResult;
        }


        //Add by Rukshan 12 Jul 2016
        public string GET_BOOKMAX_SERIAL(string _com, string _itm, out int _latpage)
        {
            string serial = string.Empty;
            _latpage = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.sp_getmaxbookser", CommandType.StoredProcedure, false, param);

            if (_tblBalance.Rows.Count > 0)
            {
                serial = _tblBalance.Rows[0][0].ToString();
                _latpage = Convert.ToInt32(_tblBalance.Rows[0][1].ToString());
            }


            return serial;
        }

        //Lakshan 14 Jul 2016
        public List<InventoryBatchRefN> Get_Inr_Batch(InventoryBatchRefN _obj)
        {
            List<InventoryBatchRefN> _reptPickBatch = new List<InventoryBatchRefN>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inb_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_job_no;
            (param[1] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_cd;
            (param[2] = new OracleParameter("p_Inb_base_refline", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_base_refline;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Inb_job_no) && string.IsNullOrEmpty(_obj.Inb_itm_cd))
            {
                return _reptPickBatch;
            }
            else
            {
                _dtResults = QueryDataTable("tblSerial", "pkg_inventory.sp_get_inr_batch", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    _reptPickBatch = DataTableExtensions.ToGenericList<InventoryBatchRefN>(_dtResults, InventoryBatchRefN.Converter);
                }
            }
            return _reptPickBatch;
        }
        public DataTable GetAodItem(string _docNo, string _item, string _model)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_iti_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_iti_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_mi_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //DataTable _tblItem = QueryDataTable("tblPoItem", "pkg_search_inv.SP_Search_POItem", CommandType.StoredProcedure, false, param);
            DataTable _tblItem = QueryDataTable("tblPoItem", "sp_ser_aod_itm_allo", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }

        //Add by Rukshan 12 Jul 2016
        public string GET_TEMPBOOKMAX_SERIAL(string _com, string _itm, int _seq, out int _latpage)
        {
            string serial = string.Empty;
            _latpage = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_itmcd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.sp_getrepmaxbookser", CommandType.StoredProcedure, false, param);

            if (_tblBalance.Rows.Count > 0)
            {
                serial = _tblBalance.Rows[0][0].ToString();
                _latpage = Convert.ToInt32(_tblBalance.Rows[0][1].ToString());
            }


            return serial;
        }


        public Int32 UpdateInvseri(InventorySerialN _seri)
        {
            // sp_updateaknowledgement(p_com in NVARCHAR2,p_loc in NVARCHAR2,p_rcc in NVARCHAR2,p_ack in NVARCHAR2,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seri.Ins_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seri.Ins_loc;
            (param[2] = new OracleParameter("p_sid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seri.Ins_ser_id;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seri.Ins_res_code;
            (param[4] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seri.Ins_res_remark;
            (param[5] = new OracleParameter("p_exdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _seri.Ins_res_exdate;
            (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seri.Ins_itm_cd;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("pkg_inventory.update_inv_seri", CommandType.StoredProcedure, param);
        }

        //Add By Rukshan 2016/Jun/2016
        public DataTable SearchInrBatch(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _dtFrom, DateTime _dtTo)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string Doc = null;
            string BNo = null;
            string desc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT #":
                        Doc = _searchText;
                        break;
                    case "BATCH #":
                        BNo = _searchText;
                        break;
                    case "ITEM":
                        searchParams[2] = _searchText + "%";
                        break;
                    case "DESCRIPTION":
                        desc = _searchText + "%";
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            Doc = (Doc != null) ? (Doc + "%") : null;
            BNo = (BNo != null) ? (BNo + "%") : null;
            desc = (desc != null) ? (desc + "%") : null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_inb_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[3] = new OracleParameter("p_inb_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BNo;
            (param[4] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[5] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            (param[6] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[7] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.sp_get_inr_batch_no", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }


        public DataTable SearchSerialsInr_Batchno(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _available = string.IsNullOrEmpty(searchParams[1].ToString()) ? null : searchParams[1].ToString();
            string _serial1 = null;
            string _item = null;
            string _docNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        _serial1 = _searchText;
                        break;

                    case "ITEM CODE":
                        _item = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial1 = (_serial1 != null) ? (_serial1 + "%") : null;
            _item = (_item != null) ? (_item + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ins_available", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[4] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_ser_inr_ser_batch", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable chekInr_batchno(string _docNo, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //DataTable _tblItem = QueryDataTable("tblPoItem", "pkg_search_inv.SP_Search_POItem", CommandType.StoredProcedure, false, param);
            DataTable _tblItem = QueryDataTable("tblPoItem", "pkg_search_inv.sp_checkBno", CommandType.StoredProcedure, false, param);

            return _tblItem;
        }
        public DataTable GetResavationQty(string doc, string code)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbt", "sp_GetResItmQTY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2016-08-01
        public Int32 UPDATE_RES_BQTYNew(String resNum, Int32 lineNum, decimal Qty)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_RES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = resNum;
            (param[1] = new OracleParameter("P_LINENUM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNum;
            (param[2] = new OracleParameter("P_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Qty;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_RES_BQTY", CommandType.StoredProcedure, param);
            return result;
        }
        //Rukshan 02-08-2016
        public DataTable GetLocTypes(string _type)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = new DataTable();
            _dt = QueryDataTable("tbl1", "sp_get_loc_type", CommandType.StoredProcedure, false, param);
            return _dt;

        }

        public DataTable GetComItem(string _item)
        {
            // rukshan 03-08-2016
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_getComComponent", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public decimal GetPendingno(string _com, string _Eno, string _itm)
        {
            // rukshan 03-08-2016
            decimal _value = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Eno;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ChecknoaodoutNEW", CommandType.StoredProcedure, false, param);
            string result = _dtResults.Rows[0][0].ToString();
            if (!string.IsNullOrEmpty(result))
            {
                _value = Convert.ToDecimal(result);
            }
            return _value;
        }
        public decimal GetPendingno2(string _com, string _Eno, string _itm, string _status)
        {
            // rukshan 03-08-2016
            decimal _value = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Eno;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_checknoaodoutnew2", CommandType.StoredProcedure, false, param);
            string result = _dtResults.Rows[0][0].ToString();
            if (!string.IsNullOrEmpty(result))
            {
                _value = Convert.ToDecimal(result);
            }
            return _value;
        }

        //subodana 2016-08-05
        public List<AODTrackerHDRdata> Get_AOD_Trackerdata(string com, string fromloc, string toloc, DateTime fromdate, DateTime todate, string inval, string outval)
        {
            List<AODTrackerHDRdata> _reptPickBatch = new List<AODTrackerHDRdata>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = fromloc;
            (param[2] = new OracleParameter("p_toloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = toloc;
            (param[3] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[4] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[5] = new OracleParameter("p_in", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inval;
            (param[6] = new OracleParameter("p_out", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = outval;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_searchAOD", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<AODTrackerHDRdata>(dt, AODTrackerHDRdata.Converter);
            }
            return _reptPickBatch;
        }
        public DataTable CHECKRESQTY(string COM, string LOC, string ITM, string STATUS, string USER, decimal QTY)
        {
            //SUBODANA
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = LOC;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ITM;
            (param[3] = new OracleParameter("P_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = STATUS;
            (param[4] = new OracleParameter("P_USR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = USER;
            (param[5] = new OracleParameter("P_QTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = QTY;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_CHECKRESQTY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GETTRANSDETAILS(string COM, string DOC)
        {
            //SUBODANA
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOC;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_AODTRANSDETAILS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2016-08-06
        public List<AODTrackerHDRdata> Get_AOD_TrackerdataByDoc(string com, string doc)
        {
            List<AODTrackerHDRdata> _reptPickBatch = new List<AODTrackerHDRdata>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "SP_GET_AODHDRBYDOC", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<AODTrackerHDRdata>(dt, AODTrackerHDRdata.Converter);
            }
            return _reptPickBatch;
        }
        //subodana 2016-08-06
        public List<AODTrackerHDRdata> Get_AOD_TrackerdataByTRNS(string com, string method, string party, string refno)
        {
            List<AODTrackerHDRdata> _reptPickBatch = new List<AODTrackerHDRdata>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = method;
            (param[2] = new OracleParameter("p_party", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = party;
            (param[3] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_searchAODByTRNS", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<AODTrackerHDRdata>(dt, AODTrackerHDRdata.Converter);
            }
            return _reptPickBatch;
        }
        public DataTable GETAODITEMS(string DOC)
        {
            //SUBODANA
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOC;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_AODITEMS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GETAODSERIAL(string COM, string DOC)
        {
            //SUBODANA
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOC;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_AODSERIALDET", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }

        /// <summary>
        /// create by Rukshan
        /// </summary>
        /// <param name="com"></param>
        /// <param name="method"></param>
        /// <param name="party"></param>
        /// <param name="refno"></param>
        /// <returns></returns>
        public List<ModelCatAndTypes> Get_Model_cat_Type(string model)
        {
            List<ModelCatAndTypes> _modelDetails = new List<ModelCatAndTypes>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "pkg_search_inv.sp_getModelCat_types", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _modelDetails = DataTableExtensions.ToGenericList<ModelCatAndTypes>(dt, ModelCatAndTypes.Converter);
            }
            return _modelDetails;
        }
        /*Lakshan 10 Aug 2016*/
        public List<InventorySerialN> GetDerWarrantyPrintSerial(string _docNo, int _rePrint)
        {
            List<InventorySerialN> _list = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_its_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_is_re_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rePrint;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("INT_SER", "sp_ser_der_war_pri_ser_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterIntSer);
            }
            return _list;
        }
        //Lakshan 2016 Aug 10
        public Int32 UpdateDerectWarantyPrint(Int32 _serId)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_irsm_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            (param[1] = new OracleParameter("p_is_re_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_update_irsm_war_print", CommandType.StoredProcedure, param);
            return effects;
        }
        //Rukshan 2016 Aug 10
        public List<InventoryBatchN> GETInventorybatch(string com, string seq)
        {
            List<InventoryBatchN> _modelDetails = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getintbatch_seq", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _modelDetails = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter);
            }
            return _modelDetails;
        }

        public DataTable DispatchReqSummaryReport(DateTime _fromdate, DateTime _todate, string in_Company, string _loc, string _otherLoc, string in_user_id, string _route_det, string in_status, DateTime frm, DateTime to, int printMark, int ExDteWise)
        {
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_other_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherLoc;
            (param[6] = new OracleParameter("in_route_det", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route_det;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[8] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_status;
            (param[9] = new OracleParameter("in_frmTime", OracleDbType.Date, null, ParameterDirection.Input)).Value = frm;
            (param[10] = new OracleParameter("in_toTime", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[11] = new OracleParameter("p_printMark", OracleDbType.Int16, null, ParameterDirection.Input)).Value = printMark;
            (param[12] = new OracleParameter("p_ExDteWise", OracleDbType.Int16, null, ParameterDirection.Input)).Value = ExDteWise;
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_DISPATCH_SUMMARY_RPT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable DispatchRequestDtlReport(DateTime _fromdate, DateTime _todate, string in_Company, string _loc, string _otherLoc, string in_user_id, string _route_det, string in_status, DateTime frm, DateTime to, int printMark, int ExDteWise)
        {
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_other_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherLoc;
            (param[6] = new OracleParameter("in_route_det", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route_det;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[8] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_status;
            (param[9] = new OracleParameter("in_frmTime", OracleDbType.Date, null, ParameterDirection.Input)).Value = frm;
            (param[10] = new OracleParameter("in_toTime", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[11] = new OracleParameter("p_printMark", OracleDbType.Int16, null, ParameterDirection.Input)).Value = printMark;
            (param[12] = new OracleParameter("p_ExDteWise", OracleDbType.Int16, null, ParameterDirection.Input)).Value = ExDteWise;
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_DISPATCH_REQ_DETAIL_RPT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 SaveModelClsDef(ModelClsDef _ModelClsDef)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_modelcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_MODEL_CD;
            (param[1] = new OracleParameter("p_clscat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_CLS_CAT;
            (param[2] = new OracleParameter("p_clstp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_CLS_TP;
            (param[3] = new OracleParameter("p_def", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_DEF;
            (param[4] = new OracleParameter("p_ord", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_CAT_ORD;
            (param[5] = new OracleParameter("p_tpord", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_TP_ORD;
            (param[6] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_CRE_BY;
            (param[7] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ModelClsDef.MCD_MOD_BY;


            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_inventory.sp_save_modelclsdef", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2016-08-18
        public List<ReservationItemsrep> GetReservationItemsDet(string com, DateTime fromdate, DateTime todate, string docno, string itemcode, string status, string dispatchloc, string custormer, string type, string adminTeam)
        {
            List<ReservationItemsrep> _reptPickBatch = new List<ReservationItemsrep>();
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[6] = new OracleParameter("p_dispatchloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispatchloc;
            (param[7] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = custormer;
            (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[9] = new OracleParameter("p_adminTeam", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = adminTeam;
            param[10] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_represitems", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<ReservationItemsrep>(dt, ReservationItemsrep.Converter);

                _reptPickBatch.Where(t => t.sub_tp == "EX" || t.sub_tp == "RE" || t.sub_tp == "BOI" || t.sub_tp == "EXP");
            }
            return _reptPickBatch;
        }



        public Int32 SaveModelPic(ModelPic _Modelpic)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_MODEL;
            (param[1] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_LINE;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_TP;
            (param[3] = new OracleParameter("p_path", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_PATH;
            (param[4] = new OracleParameter("p_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_ACT;
            (param[5] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_CRE_BY;
            (param[6] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_MOD_BY;
            (param[7] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Modelpic.MMP_RMK;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_inventory.sp_save_modelpic", CommandType.StoredProcedure, param);
            return effects;
        }


        public List<InventorySerialN> Get_Reserved_SerialsNew(string _company, string _location)//Rukshan 18/Aug/2016
        {
            List<InventorySerialN> _serial = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getreservedserials", CommandType.StoredProcedure, false, param);


            if (dt.Rows.Count > 0)
            {
                _serial = DataTableExtensions.ToGenericList<InventorySerialN>(dt, InventorySerialN.ConverterIntSerPickRemove);
            }
            return _serial;

        }
        public DataTable ItemDispatchDtlReport(DateTime _fromdate, DateTime _todate, string in_user_id)
        {
            //SP_GET_ITEM_DISPATCH_DETAILS
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_RETAIL_SR", CommandType.StoredProcedure, false, param);

            OracleParameter[] param1 = new OracleParameter[4];
            param1[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param1[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param1[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param1[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults1 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_ELITE_SR", CommandType.StoredProcedure, false, param1);

            OracleParameter[] param2 = new OracleParameter[4];
            param2[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param2[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param2[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param2[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults2 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_DEALER", CommandType.StoredProcedure, false, param2);

            OracleParameter[] param3 = new OracleParameter[4];
            param3[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param3[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param3[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param3[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults3 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_DF_SR", CommandType.StoredProcedure, false, param3);

            OracleParameter[] param4 = new OracleParameter[4];
            param4[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param4[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param4[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param4[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults4 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_DF_DEL", CommandType.StoredProcedure, false, param4);

            OracleParameter[] param5 = new OracleParameter[4];
            param5[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param5[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param5[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param5[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults5 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_AZ_SR", CommandType.StoredProcedure, false, param5);

            //Balance SPs

            OracleParameter[] param6 = new OracleParameter[4];
            param6[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param6[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param6[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param6[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults6 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_BAL_BOND", CommandType.StoredProcedure, false, param6);

            OracleParameter[] param7 = new OracleParameter[4];
            param7[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param7[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param7[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param7[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults7 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_BAL_DPS32", CommandType.StoredProcedure, false, param7);

            OracleParameter[] param8 = new OracleParameter[4];
            param8[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param8[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param8[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param8[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults8 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_BAL_AZKK", CommandType.StoredProcedure, false, param8);

            OracleParameter[] param9 = new OracleParameter[4];
            param9[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param9[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param9[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param9[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults9 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_BAL_AEL", CommandType.StoredProcedure, false, param9);

            //DPS45       ------------------------
            OracleParameter[] param10 = new OracleParameter[4];
            param10[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param10[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param10[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param10[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults10 = QueryDataTable("tbl", "SP_GET_ITEM_DISPATCH_BAL_DPS45", CommandType.StoredProcedure, false, param10);

            //RDPS32

            OracleParameter[] param11 = new OracleParameter[4];
            param11[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param11[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param11[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param11[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults11 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_RDPS32", CommandType.StoredProcedure, false, param11);

            //RDPS45
            OracleParameter[] param12 = new OracleParameter[4];
            param12[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param12[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param12[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param12[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults12 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_RDPS45", CommandType.StoredProcedure, false, param12);

            //DPS51
            OracleParameter[] param13 = new OracleParameter[4];
            param13[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param13[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param13[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param13[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults13 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_DPS51", CommandType.StoredProcedure, false, param13);

            //RDPS51
            OracleParameter[] param14 = new OracleParameter[4];
            param14[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param14[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param14[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param14[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults14 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_RDPS51", CommandType.StoredProcedure, false, param14);

            //RWHGL
            OracleParameter[] param15 = new OracleParameter[4];
            param15[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param15[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param15[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param15[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults15 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_RWHGL", CommandType.StoredProcedure, false, param15);

            //VWHGL
            OracleParameter[] param16 = new OracleParameter[4];
            param16[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param16[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param16[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param16[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults16 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_VWHGL", CommandType.StoredProcedure, false, param16);

            //DPS57
            OracleParameter[] param17 = new OracleParameter[4];
            param17[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param17[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param17[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param17[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults17 = QueryDataTable("tbl", "SP_GET_ITEM_DISP_BAL_DPS57", CommandType.StoredProcedure, false, param17);

            //------------------------------------------

            //  _dtResults.Merge(_dtResults1);
            //  _dtResults.Merge(_dtResults2);
            //  _dtResults.Merge(_dtResults3);
            //  _dtResults.Merge(_dtResults4);
            //  _dtResults.Merge(_dtResults5);

            //_dtResults.Columns.Add("ELITE_SR_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults1.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[i]["MI_CD"] == _dtResults1.Rows[j]["MI_CD"])
            //        {
            //            _dtResults.Rows[i]["ELITE_SR_QTY"] = _dtResults1.Rows[j]["ELITE_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults1.Rows[i]["RETAIL_SR_QTY"].ToString());
            //        }
            //    }

            //}

            //ELITE_SR_QTY-----------------------------------------------------START
            _dtResults.Columns.Add("ELITE_SR_QTY", typeof(Int32));
            int itemIndex = 0;
            bool existingItem = false;
            foreach (DataRow elite_sr_item in _dtResults1.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (elite_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["ELITE_SR_QTY"] = elite_sr_item["ELITE_SR_QTY"] == "" ? 0 : Convert.ToInt32(elite_sr_item["ELITE_SR_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = elite_sr_item["MI_CD"];
                    row["MI_CATE_1"] = elite_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = elite_sr_item["MI_SHORTDESC"];
                    row["ELITE_SR_QTY"] = elite_sr_item["ELITE_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(elite_sr_item["ELITE_SR_QTY"].ToString());
                    _dtResults.Rows.Add(row);

                }


            }
            //for (int i = 0; i < _dtResults1.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[j]["MI_CD"] == _dtResults1.Rows[i]["MI_CD"])
            //        {
            //            _dtResults.Rows[i]["ELITE_SR_QTY"] = _dtResults1.Rows[j]["ELITE_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults1.Rows[j]["ELITE_SR_QTY"].ToString());
            //            break;
            //        }
            //        else
            //        {
            //            _dtResults.Rows[i]["MI_CATE_1"] = _dtResults1.Rows[i]["MI_CATE_1"].ToString() == "" ? "" : _dtResults1.Rows[i]["MI_CATE_1"].ToString();
            //            _dtResults.Rows[i]["MI_CD"] = _dtResults1.Rows[i]["MI_CD"].ToString() == "" ? "" : _dtResults1.Rows[i]["MI_CD"].ToString();
            //            _dtResults.Rows[i]["ELITE_SR_QTY"] = _dtResults1.Rows[i]["ELITE_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults1.Rows[i]["ELITE_SR_QTY"].ToString());

            //        }

            //    }


            //}

            // ELITE_SR_QTY ---------------------------------------------- END

            // DEALER_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("DEALER_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow dealer_item in _dtResults2.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (dealer_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["DEALER_QTY"] = dealer_item["DEALER_QTY"].ToString() == "" ? 0 : Convert.ToInt32(dealer_item["DEALER_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = dealer_item["MI_CD"];
                    row["MI_CATE_1"] = dealer_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = dealer_item["MI_SHORTDESC"];
                    row["DEALER_QTY"] = dealer_item["DEALER_QTY"].ToString() == "" ? 0 : Convert.ToInt32(dealer_item["DEALER_QTY"].ToString());
                    _dtResults.Rows.Add(row);

                }


            }


            //_dtResults.Columns.Add("DEALER_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults2.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[i]["MI_CD"] == _dtResults2.Rows[j]["MI_CD"])
            //        {
            //            _dtResults.Rows[i]["DEALER_QTY"] = _dtResults2.Rows[j]["DEALER_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults2.Rows[i]["RETAIL_SR_QTY"].ToString());
            //        }
            //    }

            //}

            // DEALER_QTY ---------------------------------------------- END

            // DF_SR_QTY ---------------------------------------------- START


            _dtResults.Columns.Add("DF_SR_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults3.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["DF_SR_QTY"] = df_sr_item["DF_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["DF_SR_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["MI_CD"];
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    row["DF_SR_QTY"] = df_sr_item["DF_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["DF_SR_QTY"].ToString());
                    _dtResults.Rows.Add(row);

                }


            }

            //_dtResults.Columns.Add("DF_SR_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults3.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[i]["MI_CD"] == _dtResults3.Rows[j]["MI_CD"])
            //        {
            //            _dtResults.Rows[i]["DF_SR_QTY"] = _dtResults3.Rows[j]["DF_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults3.Rows[i]["DF_SR_QTY"].ToString());
            //        }
            //    }

            //}

            // DF_SR_QTY ---------------------------------------------- END

            // DF_DEL_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("DF_DEL_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults4.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["DF_DEL_QTY"] = df_sr_item["DF_DEL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["DF_DEL_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["MI_CD"];
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    row["DF_DEL_QTY"] = df_sr_item["DF_DEL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["DF_DEL_QTY"].ToString());
                    _dtResults.Rows.Add(row);

                }


            }



            //_dtResults.Columns.Add("DF_DEL_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults4.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[i]["MI_CD"] == _dtResults4.Rows[j]["MI_CD"])
            //        {
            //            _dtResults.Rows[i]["DF_DEL_QTY"] = _dtResults4.Rows[j]["DF_DEL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults4.Rows[i]["DF_DEL_QTY"].ToString());
            //        }
            //    }

            //}

            // DF_DEL_QTY ---------------------------------------------- END

            // AZ_SR_QTY ---------------------------------------------- START


            _dtResults.Columns.Add("AZ_SR_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults5.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["AZ_SR_QTY"] = df_sr_item["AZ_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["AZ_SR_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["MI_CD"];
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    row["AZ_SR_QTY"] = df_sr_item["AZ_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["AZ_SR_QTY"].ToString());
                    _dtResults.Rows.Add(row);

                }


            }

            //_dtResults.Columns.Add("AZ_SR_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults5.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[i]["MI_CD"] == _dtResults5.Rows[j]["MI_CD"])
            //        {
            //            _dtResults.Rows[i]["AZ_SR_QTY"] = _dtResults5.Rows[j]["AZ_SR_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults5.Rows[i]["AZ_SR_QTY"].ToString());
            //        }
            //    }

            //}

            // AZ_SR_QTY ---------------------------------------------- END

            //------------------------------------------------------------------------
            //Balance

            // BAL_BOND_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_BOND_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults6.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_BOND_QTY"] = df_sr_item["BAL_BOND_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_BOND_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_BOND_QTY"] = df_sr_item["BAL_BOND_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_BOND_QTY"].ToString());
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    _dtResults.Rows.Add(row);

                }


            }

            //_dtResults.Columns.Add("BAL_BOND_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults6.Rows.Count; j++)
            //    {
            //        if (_dtResults.Rows[i]["MI_CD"] == _dtResults6.Rows[j]["INL_ITM_CD"])
            //        {
            //            _dtResults.Rows[i]["BAL_BOND_QTY"] = _dtResults6.Rows[j]["BAL_BOND_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults6.Rows[i]["BAL_BOND_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_BOND_QTY ---------------------------------------------- END

            // BAL_DPS32_QTY ---------------------------------------------- START


            _dtResults.Columns.Add("BAL_DPS32_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults7.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_DPS32_QTY"] = df_sr_item["BAL_DPS32_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS32_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_DPS32_QTY"] = df_sr_item["BAL_DPS32_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS32_QTY"].ToString());
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    _dtResults.Rows.Add(row);

                }


            }

            //_dtResults.Columns.Add("BAL_DPS32_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults7.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults7.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults7.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_DPS32_QTY"] = _dtResults7.Rows[j]["BAL_DPS32_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults7.Rows[j]["BAL_DPS32_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_DPS32_QTY ---------------------------------------------- END

            // BAL_AZKK_QTY ---------------------------------------------- START


            _dtResults.Columns.Add("BAL_AZKK_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults8.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_AZKK_QTY"] = df_sr_item["BAL_AZKK_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_AZKK_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_AZKK_QTY"] = df_sr_item["BAL_AZKK_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_AZKK_QTY"].ToString());
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    _dtResults.Rows.Add(row);

                }


            }

            //_dtResults.Columns.Add("BAL_AZKK_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults8.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults8.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults8.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_AZKK_QTY"] = _dtResults8.Rows[j]["BAL_AZKK_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults8.Rows[j]["BAL_AZKK_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_AZKK_QTY ---------------------------------------------- END

            // BAL_AEL_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_AEL_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults9.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_AEL_QTY"] = df_sr_item["BAL_AEL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_AEL_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_AEL_QTY"] = df_sr_item["BAL_AEL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_AEL_QTY"].ToString());
                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];
                    _dtResults.Rows.Add(row);

                }


            }

            //_dtResults.Columns.Add("BAL_AEL_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults9.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults9.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults9.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_AEL_QTY"] = _dtResults9.Rows[j]["BAL_AEL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults9.Rows[j]["BAL_AEL_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_AEL_QTY ---------------------------------------------- END

            //////////////////////////////////////////////////////////////-------------------

            // BAL_DPS45_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_DPS45_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults10.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_DPS45_QTY"] = df_sr_item["BAL_DPS45_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS45_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_DPS45_QTY"] = df_sr_item["BAL_DPS45_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS45_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }

            //_dtResults.Columns.Add("BAL_DPS45_QTY", typeof(Int32));
            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults10.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults10.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults10.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_DPS45_QTY"] = _dtResults10.Rows[j]["BAL_DPS45_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults10.Rows[j]["BAL_DPS45_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_DPS45_QTY ---------------------------------------------- END

            // BAL_RDPS32_QTY ---------------------------------------------- START


            _dtResults.Columns.Add("BAL_RDPS32_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults11.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_RDPS32_QTY"] = df_sr_item["BAL_RDPS32_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RDPS32_QTY"].ToString());

                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_RDPS32_QTY"] = df_sr_item["BAL_RDPS32_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RDPS32_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];


                    _dtResults.Rows.Add(row);


                }

            }

            //_dtResults.Columns.Add("BAL_RDPS32_QTY", typeof(Int32));
            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults11.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults11.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults11.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_RDPS32_QTY"] = _dtResults11.Rows[j]["BAL_RDPS32_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults11.Rows[j]["BAL_RDPS32_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_RDPS32_QTY ---------------------------------------------- END

            // BAL_RDPS45_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_RDPS45_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults12.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_RDPS45_QTY"] = df_sr_item["BAL_RDPS45_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RDPS45_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_RDPS45_QTY"] = df_sr_item["BAL_RDPS45_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RDPS45_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }

            //_dtResults.Columns.Add("BAL_RDPS45_QTY", typeof(Int32));
            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults12.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults12.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults12.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_RDPS45_QTY"] = _dtResults12.Rows[j]["BAL_RDPS45_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults12.Rows[j]["BAL_RDPS45_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_RDPS45_QTY ---------------------------------------------- END

            // BAL_DPS51_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_DPS51_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults13.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_DPS51_QTY"] = df_sr_item["BAL_DPS51_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS51_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_DPS51_QTY"] = df_sr_item["BAL_DPS51_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS51_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }

            //_dtResults.Columns.Add("BAL_DPS51_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults13.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults13.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults13.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_DPS51_QTY"] = _dtResults13.Rows[j]["BAL_DPS51_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults13.Rows[j]["BAL_DPS51_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_DPS51_QTY ---------------------------------------------- END

            // BAL_RDPS51_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_RDPS51_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults14.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_RDPS51_QTY"] = df_sr_item["BAL_RDPS51_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RDPS51_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_RDPS51_QTY"] = df_sr_item["BAL_RDPS51_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RDPS51_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }

            //_dtResults.Columns.Add("BAL_RDPS51_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults14.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults14.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults14.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_RDPS51_QTY"] = _dtResults14.Rows[j]["BAL_RDPS51_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults14.Rows[j]["BAL_RDPS51_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_RDPS51_QTY ---------------------------------------------- END

            // BAL_RWHGL_QTY ---------------------------------------------- START

            _dtResults.Columns.Add("BAL_RWHGL_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults15.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_RWHGL_QTY"] = df_sr_item["BAL_RWHGL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RWHGL_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_RDPS51_QTY"] = df_sr_item["BAL_RWHGL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_RWHGL_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }

            //_dtResults.Columns.Add("BAL_RWHGL_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults15.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults15.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults15.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_RWHGL_QTY"] = _dtResults15.Rows[j]["BAL_RWHGL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults15.Rows[j]["BAL_RWHGL_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_RWHGL_QTY ---------------------------------------------- END

            // BAL_VWHGL_QTY ---------------------------------------------- START


            _dtResults.Columns.Add("BAL_VWHGL_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults16.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_VWHGL_QTY"] = df_sr_item["BAL_VWHGL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_VWHGL_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_VWHGL_QTY"] = df_sr_item["BAL_VWHGL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_VWHGL_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }
            _dtResults.Columns.Add("BAL_DPS57_QTY", typeof(Int32));
            itemIndex = 0;
            existingItem = false;
            foreach (DataRow df_sr_item in _dtResults17.Rows)
            {
                itemIndex = 0;
                foreach (DataRow res_item in _dtResults.Rows)
                {
                    if (df_sr_item.ItemArray[0].ToString() == res_item.ItemArray[0].ToString())
                    {
                        existingItem = true;
                        break;
                    }

                    itemIndex++;
                }
                // itemIndex++;

                if (existingItem)
                {
                    _dtResults.Rows[itemIndex]["BAL_DPS57_QTY"] = df_sr_item["BAL_DPS57_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS57_QTY"].ToString());
                    existingItem = false;
                }
                else
                {
                    var row = _dtResults.NewRow();
                    row["MI_CD"] = df_sr_item["INL_ITM_CD"];
                    row["BAL_DPS57_QTY"] = df_sr_item["BAL_DPS57_QTY"].ToString() == "" ? 0 : Convert.ToInt32(df_sr_item["BAL_DPS57_QTY"].ToString());

                    row["MI_CATE_1"] = df_sr_item["MI_CATE_1"];
                    row["MI_SHORTDESC"] = df_sr_item["MI_SHORTDESC"];

                    _dtResults.Rows.Add(row);


                }

            }
            //_dtResults.Columns.Add("BAL_VWHGL_QTY", typeof(Int32));

            //for (int i = 0; i < _dtResults.Rows.Count; i++)
            //{
            //    for (int j = 0; j < _dtResults16.Rows.Count; j++)
            //    {
            //        string aa = _dtResults.Rows[i]["MI_CD"].ToString();
            //        string bb = _dtResults16.Rows[j]["INL_ITM_CD"].ToString();
            //        if (_dtResults.Rows[i]["MI_CD"].ToString() == _dtResults16.Rows[j]["INL_ITM_CD"].ToString())
            //        {
            //            _dtResults.Rows[i]["BAL_VWHGL_QTY"] = _dtResults16.Rows[j]["BAL_VWHGL_QTY"].ToString() == "" ? 0 : Convert.ToInt32(_dtResults16.Rows[j]["BAL_VWHGL_QTY"].ToString());
            //        }
            //    }

            //}

            // BAL_VWHGL_QTY ---------------------------------------------- END

            //////////////////////////////////////////////////////////////////////////////////

            return _dtResults;

        }

        public List<ModelPic> Get_Modelpic(string model)
        {
            List<ModelPic> _modelDetails = new List<ModelPic>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "pkg_search_inv.sp_getModelPic", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _modelDetails = DataTableExtensions.ToGenericList<ModelPic>(dt, ModelPic.Converter);
            }
            return _modelDetails;
        }


        //subodana 2016-08-19
        public List<CatwithItems> GetItemsDetWithCat(string cat)
        {
            List<CatwithItems> _reptPickBatch = new List<CatwithItems>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "SP_GETITEMS_CAT", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<CatwithItems>(dt, CatwithItems.Converter);
            }
            return _reptPickBatch;
        }
        //subodana 2016-08-19
        public DataTable CheckINTReqBond(string COM, string REFNO)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_REFNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = REFNO;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_CHECKREQBOND", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 2016-08-20
        public List<InventoryItem> GET_INT_ITM_DATA(InventoryItem _obj)
        {
            List<InventoryItem> _reptPickBatch = new List<InventoryItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_iti_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iti_doc_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("int_itm", "pkg_search_imp.sp_get_int_itm_data", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<InventoryItem>(dt, InventoryItem.ConvertTotal);
            }
            return _reptPickBatch;
        }
        //Lakshan 20 Aug 2016
        private ReptPickSerials Convert_INT_SER_NEW(DataRow _tr)
        {
            ReptPickSerials _pick = new ReptPickSerials();
            _pick.Tus_batch_line = Convert.ToInt32(_tr["ITS_BATCH_LINE"]);
            _pick.Tus_bin = Convert.ToString(_tr["ITS_BIN"]);
            _pick.Tus_com = Convert.ToString(_tr["ITS_COM"]);
            _pick.Tus_cre_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
            _pick.Tus_doc_no = Convert.ToString(_tr["ITS_DOC_NO"]);
            _pick.Tus_exist_grncom = Convert.ToString(_tr["ITS_EXIST_GRNCOM"]);
            _pick.Tus_exist_grndt = Convert.ToDateTime(_tr["ITS_EXIST_GRNDT"]);
            _pick.Tus_exist_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_exist_supp = Convert.ToString(_tr["ITS_EXIST_SUPP"]);
            _pick.Tus_itm_cd = Convert.ToString(_tr["ITS_ITM_CD"]);
            _pick.Tus_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);
            _pick.Tus_itm_stus = Convert.ToString(_tr["ITS_ITM_STUS"]);
            _pick.Tus_loc = Convert.ToString(_tr["ITS_LOC"]);//not sure
            _pick.Tus_orig_grncom = Convert.ToString(_tr["ITS_ORIG_GRNCOM"]);
            _pick.Tus_orig_grndt = Convert.ToDateTime(_tr["ITS_ORIG_GRNDT"]);
            _pick.Tus_orig_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
            _pick.Tus_orig_supp = Convert.ToString(_tr["ITS_ORIG_SUPP"]);
            _pick.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure
            _pick.Tus_seq_no = Convert.ToInt32(_tr["ITS_SEQ_NO"]);
            _pick.Tus_ser_1 = Convert.ToString(_tr["ITS_SER_1"]);
            _pick.Tus_ser_2 = Convert.ToString(_tr["ITS_SER_2"]);
            _pick.Tus_ser_3 = Convert.ToString(_tr["ITS_SER_3"]);
            _pick.Tus_ser_4 = Convert.ToString(_tr["ITS_SER_4"]);
            _pick.Tus_ser_id = Convert.ToInt32(_tr["ITS_SER_ID"]);
            _pick.Tus_ser_line = Convert.ToInt32(_tr["ITS_SER_LINE"]);
            // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
            _pick.Tus_unit_cost = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            _pick.Tus_unit_price = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
            //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
            _pick.Tus_warr_no = Convert.ToString(_tr["ITS_WARR_NO"]);
            _pick.Tus_warr_period = Convert.ToInt32(_tr["ITS_WARR_PERIOD"]);
            _pick.Tus_new_status = string.Empty;
            _pick.Tus_base_doc_no = Convert.ToString(_tr["ITB_BASE_REF_NO"]);
            _pick.Tus_base_itm_line = Convert.ToInt32(_tr["ITB_BASE_REFLINE"]);
            if (string.IsNullOrEmpty(_tr["ITS_AGELOC"].ToString()))
            { _pick.Tus_ageloc = _pick.Tus_loc; }
            else
            { _pick.Tus_ageloc = _tr["ITS_AGELOC"].ToString(); }
            if (string.IsNullOrEmpty(_tr["ITS_AGELOC_DT"].ToString()))
            { _pick.Tus_ageloc_dt = _pick.Tus_doc_dt; }
            else
            { _pick.Tus_ageloc_dt = Convert.ToDateTime(_tr["ITS_AGELOC_DT"].ToString()).Date; }

            if (string.IsNullOrEmpty(_tr["ITS_ISOWNMRN"].ToString()))
            { _pick.Tus_isownmrn = 0; }
            else
            { _pick.Tus_isownmrn = Convert.ToInt32(_tr["ITS_ISOWNMRN"].ToString()); }
            _pick.Mis_desc = Convert.ToString(_tr["mis_desc"]);
            //add rukshan 10/DEc/2015
            //Added Prabhath on 11/08/2012
            MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);
            _pick.Tus_itm_desc = _item.Mi_longdesc;
            _pick.Tus_itm_model = _item.Mi_model;
            _pick.Tus_itm_brand = _item.Mi_brand;
            Int32 _tmpPick = 0;
            _tmpPick = Int32.TryParse(_tr["its_pick"].ToString(), out _tmpPick) ? Convert.ToInt32(_tr["its_pick"].ToString()) : 0;
            _pick.Tus_ins_pick = _tmpPick;
            return _pick;
        }
        //Lakshan 2016 Aug 20
        public List<ReptPickSerials> GET_TEMP_PICK_SER_BY_INT_SER(InventorySerialN _obj)
        {
            List<ReptPickSerials> _reptPickSerials = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_its_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ins_itm_cd;
            (param[1] = new OracleParameter("p_its_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ins_doc_no;
            (param[2] = new OracleParameter("p_iti_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ins_itm_stus;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "pkg_search_imp.sp_get_int_ser_by_itm", CommandType.StoredProcedure, false, param);
            foreach (DataRow tr in dt.Rows)
            {
                _reptPickSerials.Add(Convert_INT_SER_NEW(tr));
            }
            return _reptPickSerials;
        }
        //subodana 2016-08-20
        public List<BLtracker> GetBlTrackerData(string com, DateTime fromdate, DateTime todate, string blno, string itemcode, string bondno, string model)
        {
            List<BLtracker> _reptPickBatch = new List<BLtracker>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[5] = new OracleParameter("p_bondno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bondno;
            (param[6] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_getblitemswithbond", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<BLtracker>(dt, BLtracker.Converter);
            }
            string bno = "";
            string sino = "";
            string item = "";

            if (_reptPickBatch.Count > 0)
            {
                foreach (var datalist in _reptPickBatch)
                {
                    bno = datalist.ib_ref_no.ToString();
                    sino = datalist.ib_doc_no.ToString();
                    item = datalist.ibi_itm_cd.ToString();
                    decimal value = GetPendingno(com, bno, item);
                    decimal _grnfree = Convert.ToDecimal(datalist.GrnfreeQty);
                    decimal balnce = _grnfree - value;
                    if (balnce < 0)
                    {
                        balnce = 0;
                    }
                    decimal _PendingReservation = GetPendingReservation(com, bno, sino, item, null);
                    datalist.GrnfreeQty = Convert.ToInt32(balnce - _PendingReservation);
                    datalist.GrnResQty = Convert.ToInt32(_PendingReservation);

                }
            }

            return _reptPickBatch;

        }


        public DataTable GetItemDataInTempPickItem(string itmCode, string docNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCode;
            (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblItm", "pkg_pda.sp_check_itm_availability", CommandType.StoredProcedure, false, param);

            return dt;
        }


        public InvoiceHeader GetInvoiceHeaderDetails(string _invoiceNo)
        {
            InvoiceHeader _invoiceHeader = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "sp_get_all_invoice_details", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_invoiceDT, InvoiceHeader.ConvertTotal)[0];
            }
            return _invoiceHeader;
        }

        public List<InventoryRequest> GET_REQUEST_FOR_DISPATCH_NO(String Com, String Route, String MainCate, String Item, String ReqType, String Loc, String SubCate, String Model, DateTime Date, DateTime ToDate, int type, string _ReqNo)
        {
            Int32 isItemSearch = 0;
            if (!string.IsNullOrEmpty(MainCate) || !string.IsNullOrEmpty(Item) || !string.IsNullOrEmpty(SubCate) || !string.IsNullOrEmpty(Model))
            {
                isItemSearch = 1;
            }

            List<InventoryRequest> result = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ROUTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Route;
            (param[2] = new OracleParameter("P_MAINCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MainCate;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[4] = new OracleParameter("P_REQTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqType;
            (param[5] = new OracleParameter("P_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[6] = new OracleParameter("P_SUBCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SubCate;
            (param[7] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[8] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            (param[9] = new OracleParameter("P_ISITEMSEARCH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isItemSearch;
            (param[10] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[11] = new OracleParameter("P_TYPE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;
            (param[12] = new OracleParameter("P_REQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqNo;
            param[13] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tblSerial", "SP_GET_REQUEST_FOR_DISPATCH_NO", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterDispatch);

            return result;
        }

        public DataTable GetShippingDetailReport(string in_Company, string in_doc_no)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[2] = new OracleParameter("in_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_doc_no;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SHIPPING_INVOICE_RPT", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }

        public DataTable GetCostDetailsShipInvReport(string in_doc_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_doc_no;

            DataTable _dtResults = QueryDataTable("tblCharges", "SP_GET_COST_FOR_SHIP_INV_RPT", CommandType.StoredProcedure, false, param);
            return _dtResults;

        }

        //rUKSHAN 2016-08-24
        public bool checkBatch_ser(int seriaid)
        {
            bool result = true;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seriaid;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_checkBatch_Serial", CommandType.StoredProcedure, false, param);
            //DataTable _dtResults = QueryDataTable("tbl", "sp_checkBatch_Serial", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    int _count = Convert.ToInt32(_dtResults.Rows[0][0].ToString());
                    if (_count > 0)
                    {
                        result = false;
                    }
                }
            }
            return result;
        }


        public InvoiceHeader GetInvoiceHeaderDetailsBySeq(string _seq)
        {
            InvoiceHeader _invoiceHeader = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _invoiceDT = QueryDataTable("tblInvoiceDT", "pkg_search_inv.sp_inv_hdrbyseq", CommandType.StoredProcedure, false, param);

            if (_invoiceDT.Rows.Count > 0)
            {
                _invoiceHeader = DataTableExtensions.ToGenericList<InvoiceHeader>(_invoiceDT, InvoiceHeader.ConvertTotal)[0];
            }
            return _invoiceHeader;
        }

        //Randima 2016-08-25
        public DataTable GetItemReservationDet(string _com, string _loc, string _itm, string _status)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[5];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "SP_GET_ITM_RESERVATION", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Randima 2016-08-29
        public DataTable GetItemReservationDetail2(string _com, string _loc, string _itm, string _status)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[5];
            //(param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "SP_GET_ITM_RESERVATION_RES", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodaba 2016-11-03
        public DataTable GetResBalQty(string resno, string itmcode, string loc)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_RESNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = resno;
            (param[1] = new OracleParameter("P_ITMCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcode;
            (param[2] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItem", "SP_GETRESBALQRY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getTempPickHdrDoc(string seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("doc", "pkg_pda.sp_gettemppickdoc", CommandType.StoredProcedure, false, param);

        }
        //Add by Lakshan
        public DataTable GetActualRateAodIn(string _docNo, Int32 _lineNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_ici_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_get_ici_actl_rt_aod", CommandType.StoredProcedure, false, param);
            return _dt;

        }

        //Lakshika 2016-09-03
        public DataTable GetGRNDetailsByReqNo(string _seq_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_imports_Enquiry.SP_GET_GRN_HEADER_BY_REQNO", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Lakshika 2016-09-05
        public DataTable Get_INR_SER_DATA_ADVANCED(InventorySerialN _ser)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_com;
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_loc;
            (param[2] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_cd;
            (param[3] = new OracleParameter("p_ins_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_stus;
            (param[4] = new OracleParameter("p_ins_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ser.Ins_ser_id;
            (param[5] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_ser_1;
            // (param[6] = new OracleParameter("p_ins_available", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_available;
            (param[6] = new OracleParameter("p_ser_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ser.Ser_tp;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("INR_SER_ADV", "pkg_inventory.sp_get_inr_ser_data_advanced", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //RUKSHAN
        public DataTable CHECKBONDNO(string _COM, string _BOND)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
            (param[1] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BOND;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_check_valid_bond", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Lakshan 06 Sep 2016
        public bool check_int_itm(int seriaid)
        {
            bool result = true;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seriaid;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_check_int_itm", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    int _count = Convert.ToInt32(_dtResults.Rows[0][0].ToString());
                    if (_count > 0)
                    {
                        result = false;
                    }
                }
            }
            return result;
        }

        //Rukshan 2016-Sep-06
        public Int32 Update_Cusdec_status(string _doc, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("update_cusdecBal", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshika 2016-09-06
        public DataTable GetGRNItemsDetailsBySeqNo(string _seq_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_imports_Enquiry.SP_GET_GRN_ITEM_BY_SEQNO", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //subodana 2016-09-07
        public List<AdjesmentDet> StockAdjDetails(string com, string chnal, DateTime fromdate, DateTime todate)
        {
            List<AdjesmentDet> oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_chnal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chnal;
            (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("boireq", "SP_StockAdjDetails", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<AdjesmentDet>(dt, AdjesmentDet.Converter);
            return oResult;
        }
        //Add by lakshan 08/Sep/2016
        public Int32 UpdateRequestItemBalance(string _request, string _company, string _location, string _item, string _itemstatus, decimal _qty, string _docstatus, string _user, Int32 _lineNo)
        {
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docstatus;
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[8] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_update_req_itm_sts", CommandType.StoredProcedure, param);
            return _effect;
        }
        //Add by lakshan 08/Sep/2016
        public Int32 UpdateRequestItemBalanceBond(string _request, string _company, string _location, string _item, string _itemstatus, decimal _qty, string _docstatus, string _user, Int32 _lineNo)
        {
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docstatus;
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[8] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_update_req_itm_sts_bond", CommandType.StoredProcedure, param);
            return _effect;
        }

        public decimal getItemBatchBalance(string itemcode, string company, string location, string bincode, string itmstatus)
        {
            try
            {
                decimal oResult = 0;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
                (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_bincode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bincode;
                (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmstatus;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable dt = QueryDataTable("tbl", "pkg_pda.sp_get_itmbatchbalance", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    if (dt.Rows[0]["QTY"] != DBNull.Value)
                        oResult = Convert.ToDecimal(dt.Rows[0]["QTY"].ToString());
                }
                return oResult;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public decimal getTempPickSerQty(string itemcode, string company, string location, string bincode, string itmstatus)
        {
            try
            {
                decimal oResult = 0;
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
                (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_bincode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bincode;
                (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmstatus;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable dt = QueryDataTable("tbl", "pkg_pda.sp_get_totaltmppkserqty", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    if (dt.Rows[0]["QTY"] != DBNull.Value)
                        oResult = Convert.ToDecimal(dt.Rows[0]["QTY"].ToString());
                }
                return oResult;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int32 deleteTempDocument(string seqno)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                Int16 effects = 0;
                (param[0] = new OracleParameter("p_usrseq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqno;
                param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("pkg_pda.sp_delete_tempdoc", CommandType.StoredProcedure, param);
                return effects;

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Lakshan 08 Sep 2016
        public decimal GetIntReqBalanceAvailableByTempPickSeq(Int32 _seqNo)
        {
            decimal result = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_tuh_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_req_itm_balance", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    decimal _count = 0;
                    result = decimal.TryParse(_dtResults.Rows[0][0].ToString(), out _count) ? Convert.ToDecimal(_dtResults.Rows[0][0].ToString()) : 0;
                }
            }
            return result;
        }

        public Int32 UpdateRequestBalance(string _request, string _company, string _item, string _itemstatus, decimal _qty, string _user, Int32 _lineNo)
        {
            //sp_updaterequeststatus(p_reqno in NVARCHAR2,p_com in NVARCHAR2,p_loc in NVARCHAR2,p_item in NVARCHAR2,p_itmstatus in NVARCHAR2,p_qty in NUMBER,p_status in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER)
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _effect = (Int32)UpdateRecords("sp_update_req_itm", CommandType.StoredProcedure, param);

            return _effect;
        }

        public MasterLocation GetLocationByLocCode(string _CompCode, string _LocCode)
        {
            MasterLocation _locList = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //_locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.converter)[0];
                //Edit by Chamal 29/06/2012
                _locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal)[0];
            }
            return _locList;
        }
        //subodana 2016-09-08
        public DataTable SP_GETENTRYREQDATA(string com, string Sino)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_Sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Sino;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETENTRYREQDATA", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        //Rukshan 2016-3-16
        public Int32 Update_Cost_hdr_DO(string doc, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("update_cost_do_status", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshika 2016-09-12
        public DataTable updateWarrentryIsPrint(string _docno)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("in_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "pkg_inventory.sp_update_warranty_isPrint", CommandType.StoredProcedure, false, param);
            return _result;

        }

        //subodana 2016-09-12
        public DataTable SP_GETRESQTYMRN(string com, string loc, string itmcode, string status)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcode;
            (param[3] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "CHECKMRNRESQTY", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //SUBODANA
        public Int32 UpdateReqUser(string com, string reqno, string user)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updaterequser", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshan 13 Sep 2016
        public DataTable GetAODInDataForExcelReport(DateTime _dtFrom, DateTime _dtTo)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (_para[1] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("int_hdr", "sp_get_aod_in_bal_for_rep", CommandType.StoredProcedure, false, _para);
            return _result;
        }
        //Lakshan 13 Sep 2016
        public DataTable GetAODOutDataForExcelReport(DateTime _dtFrom, DateTime _dtTo)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (_para[1] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("int_hdr", "sp_get_aod_out_bal_for_rep", CommandType.StoredProcedure, false, _para);
            return _result;
        }
        //Lakshan 13 Sep 2016
        public DataTable GetBusEntityDataByAccCode(string _com, string _accCode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mbe_acc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_mst_busentity_by_acc", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public Int32 updateDocumentFinishStatus(string docno, string doctyp, Int32 status)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
                (param[1] = new OracleParameter("p_doctyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctyp;
                (param[2] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
                param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int32)UpdateRecords("pkg_pda.sp_update_docstus", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable chechIsAvailableSerial(string itmcode, string serial)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_itmcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcode;
            (_para[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("int_hdr", "pkg_pda.sp_check_serialdetails", CommandType.StoredProcedure, false, _para);
            return _result;
        }
        //SUBODANA
        public DataTable SP_GETUPDATEUSER(string com, string reqno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_REQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETUPDATEUSER", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //dilshan
        public DataTable SP_GETINVAMT(string com, string invno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETINVAMOUNT", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Lakshan 13 Sep 2016
        public List<InventoryBatchN> GET_INT_BATCH_DATA(InventoryBatchN _obj)
        {
            List<InventoryBatchN> _list = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itb_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_seq_no;
            (param[1] = new OracleParameter("p_itb_itm_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_line;
            (param[2] = new OracleParameter("p_itb_batch_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_batch_line;
            (param[3] = new OracleParameter("p_itb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_batch_no;
            (param[4] = new OracleParameter("p_itb_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_doc_no;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            if (string.IsNullOrEmpty(_obj.Inb_doc_no))
            {
                return _list;
            }
            else
            {
                dt = QueryDataTable("int_batch", "sp_get_int_batch_data", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.ConverterNew);
                }
            }
            return _list;
        }

        //SUBODANA 2016-09-14
        public DataTable SP_CHECKTEMPSER(string com, string docno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "CHECKTEMPTICSER", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //SUBODANA 2016-09-14
        public DataTable SP_CHECKTEMPSERNW(string com, string docno, Int32 line)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[2] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "CHECKTEMPTICSERNW", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        //Lakshika 2016-09-14
        public DataTable CheckISCM2(string com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("com", "SP_CHECK_IS_SCM2", CommandType.StoredProcedure, false, param);
            return _dt;

        }

        public DataTable LoadFinishedCurrentJobs(string p_tuh_usr_com, string p_tuh_usr_loc, string p_tuh_usr_id, string p_tuh_doc_tp, Int32 p_tuh_direct, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;
            (param[1] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_loc;
            (param[2] = new OracleParameter("p_tuh_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_id;
            (param[3] = new OracleParameter("p_tuh_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_doc_tp;
            (param[4] = new OracleParameter("p_tuh_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_direct;
            (param[5] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[6] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[7] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable DT = new DataTable();
            DT = QueryDataTable("temp_pick_hdr@scmrep", "pkg_pda.sp_load_finished_jobs", CommandType.StoredProcedure, false, param);
            return DT;
        }

        public Int32 reopenTempDocument(string seqno, string doctp)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_usrseq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqno;
            (param[1] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_pda.sp_updatedocfinstus", CommandType.StoredProcedure, param);
            return effects;
        }

        //Lakshika 2016-09-15
        public DataTable GetBalanceQtyForResItmRpt(string com, string req_no, string item_cd, int line_no)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            (param[2] = new OracleParameter("p_item_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item_cd;
            (param[3] = new OracleParameter("p_line_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line_no;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_RES_ITEMS_BAL_QTY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GetBalanceQtyForResItmRpt2(string com, string req_no, int line_no)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req_no;
            (param[2] = new OracleParameter("p_line_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line_no;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_RES_ITEMS_BAL_QTY2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getExistsItemDocument(string itemcode, string company, string location, string bincode, string itmstatus)
        {
            try
            {
                DataTable dt = new DataTable("tbl");
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
                (param[1] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[3] = new OracleParameter("p_bincode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bincode;
                (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmstatus;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                dt = QueryDataTable("tbl", "pkg_pda.sp_get_existsitmdoc", CommandType.StoredProcedure, false, param);
                return dt;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public decimal getDocumentSerialCount(string docno)
        {
            decimal count = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "pkg_pda.sp_getaodsercount", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                count = Convert.ToDecimal(dt.Rows[0]["CNT"].ToString());
            }
            return count;
        }
        public Int16 UpdateIntSerReserved(InventorySerialN _ser)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_its_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_seq_no;
            (param[1] = new OracleParameter("p_its_itm_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_line;
            (param[2] = new OracleParameter("p_its_batch_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_batch_line;
            (param[3] = new OracleParameter("p_its_ser_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_ser_line;
            (param[4] = new OracleParameter("p_its_reversed", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_reversed;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_dispatchreqstatus", CommandType.StoredProcedure, param);
            return effects;
        }

        public string GET_INR_BATCH_ITM(string _GRN, string _itm, string _com)
        {
            string _baseitm = string.Empty;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_grn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _GRN;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("int_batch", "sp_getgrnitem", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _baseitm = dt.Rows[0][0].ToString();
            }
            return _baseitm;
        }
        public string GET_INR_BATCH_ITMforJob(string _job, Int32 _itmline, string _com)
        {
            string _baseitm = string.Empty;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_bond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _job;
            (param[1] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmline;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("int_batch", "sp_getgrnitemforjob", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                _baseitm = dt.Rows[0][0].ToString();
            }
            return _baseitm;
        }
        public Int32 UpdateExistingSerialRecivedNew(string _docno, Int32 serialno, Int32 reserved)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[1] = new OracleParameter("p_reserved", OracleDbType.Int32, null, ParameterDirection.Input)).Value = reserved;
            (param[2] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serialno;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_pda.SP_UPDATE_USED_SERIAL", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Nuwan 2016.09.17
        public Int32 UpdateQtyNew(ReptPickItems _itemsqty,string userid,string doctp)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_tui_pic_itm_qty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsqty.Tui_pic_itm_qty;
            (param[1] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itemsqty.Tui_usrseq_no;
            (param[2] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsqty.Tui_req_itm_cd;
            (param[3] = new OracleParameter("p_tui_req_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemsqty.Tui_req_itm_stus;
            (param[4] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[5] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
                      
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_pda.update_qty", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Nuwan 2016.09.17
        public Int32 DeleteItemsWIthSerialsNew(ReptPickSerials _serials,string userid=null,string doctp=null)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_tus_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serials.Tus_usrseq_no;
            (param[1] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_com;
            (param[2] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_loc;
            (param[3] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_itm_cd;
            (param[4] = new OracleParameter("p_tus_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_ser_1;
            (param[5] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serials.Tus_bin;
            (param[6] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[7] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;


            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_pda.delete_item_with_ser", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Nuwan 2016.09.17
        //this method is for non-serial items
        public Boolean Update_serialID_INS_AVAILABLENew(string compny, string location, string itemCD, Int32 ser_ID, int availability)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = compny;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCD;
            (param[3] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser_ID;
            (param[4] = new OracleParameter("availability", OracleDbType.Int32, null, ParameterDirection.Input)).Value = availability;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = UpdateRecords("sp_update_ser_id_INS_AVAILABLE", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }
        //Sahan 01/Sep/2015
        public Int32 UpdateSerializedItemsQtyNew(ReptPickSerials _serialsQty,string userid=null,string doctp=null)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_tus_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serialsQty.Tus_qty;
            (param[1] = new OracleParameter("p_tus_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialsQty.Tus_seq_no;
            (param[2] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_com;
            (param[3] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_loc;
            (param[4] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_bin;
            (param[5] = new OracleParameter("p_tus_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_itm_stus;
            (param[6] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialsQty.Tus_itm_cd;
            (param[7] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[8] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_pda.update_serialized_itm_qty", CommandType.StoredProcedure, param);
            return _eff;
        }

        public List<ReptPickSerials> GetInvoiceSerialForReversalBYITM(string _company,
            string _invoice, int _baseRefline, string _itm, int _qty)
        {
            //sp_getdoserialdetail(p_com in NVARCHAR2, p_invoiceno in NVARCHAR2,p_base_refline in NUMBER, c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _baseRefline;
            (param[3] = new OracleParameter("p_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _qty;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailBYITM", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);

                        _one.Tus_com = _company;

                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;

                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";

                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);

                        _one.Tus_com = _company;

                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        if (_item.Mi_is_ser1 == -1)
                            _one.Tus_ser_id = 0;   //_one.Tus_serial_id = "-1";  kapila 18/9/2015
                        else
                            _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";

                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }

        //Nuwan 2016.09.17
        public Int32 UpdatePickItemStockInOutNew(ReptPickItems _items,string userid=null,string doctp =null)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[15];

            (param[0] = new OracleParameter("p_tui_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _items.Tui_usrseq_no;
            (param[1] = new OracleParameter("p_tui_req_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_cd;
            (param[2] = new OracleParameter("p_tui_req_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_stus;
            (param[3] = new OracleParameter("p_tui_req_itm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _items.Tui_req_itm_qty;
            (param[4] = new OracleParameter("p_tui_pic_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_cd;
            (param[5] = new OracleParameter("p_tui_pic_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_stus;
            (param[6] = new OracleParameter("p_tui_pic_itm_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _items.Tui_pic_itm_qty;
            (param[7] = new OracleParameter("p_tui_grn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_grn;
            (param[8] = new OracleParameter("p_tui_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_batch;
            (param[9] = new OracleParameter("p_tui_sup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _items.Tui_sup;
            (param[10] = new OracleParameter("p_tui_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _items.Tui_grn_dt;
            (param[11] = new OracleParameter("p_tui_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _items.Tui_exp_dt;
            (param[12] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[13] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            _eff = (Int32)UpdateRecords("pkg_pda.sp_update_pick_items_stkinOut", CommandType.StoredProcedure, param);

            return _eff;
        }

        //Lakshika 2016-09-03
        public DataTable GetSINumberByReqNo(string _req_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _req_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GET_SI_BY_REQNO", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public DataTable getINTSerial(string serial, string itmcd, string docno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            (param[2] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_pda.sp_get_intserdata", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public DataTable GetGITSerials(string _com, string _docNo, int _itemline, int _batchline)
        {  // Lakshika 2016-09-21
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("in_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("in_item_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemline;
            (param[3] = new OracleParameter("in_batch_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _batchline;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_GIT_SERIALS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Lakshan 2016 Sep 23
        public List<InventoryRequest> GET_INT_REQ_DATA(InventoryRequest _obj)
        {
            List<InventoryRequest> _list = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_req_no;
            (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_com;
            (param[2] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_tp;
            (param[3] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_int_req_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter);
            }
            return _list;
        }
        //Lakshan 2016 Sep 23
        public List<InventoryRequestItem> GET_INT_REQ_ITM_DATA(InventoryRequestItem _obj)
        {
            List<InventoryRequestItem> _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itri_seq_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_int_req_itm_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterNew);
            }
            return _list;
        }
        #region Add temp meth
        //Add by Lakshan 20 Jun 2016
        public List<InventoryHeader> GET_INT_HDR_DATA_BY_RANGE(InventoryHeader _obj, DateTime _dtFrom, DateTime _dtTo)
        {
            List<InventoryHeader> _list = new List<InventoryHeader>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_com;
            (param[1] = new OracleParameter("p_ith_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_doc_tp;
            (param[2] = new OracleParameter("p_ith_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Ith_direct;
            (param[3] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtFrom;
            (param[4] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dtTo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("int_hdr", "tmp_sp_get_int_hdr_data_dt", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryHeader>(_tblBalance, InventoryHeader.ConvertTotal);
            }
            return _list;
        }
        #endregion
        //Lakshan 24 Sep 2016
        public List<INR_RES> GET_INR_RES_DATA(INR_RES _obj)
        {
            List<INR_RES> _list = new List<INR_RES>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_irs_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_COM;
            (param[1] = new OracleParameter("p_irs_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_RES_NO;
            (param[2] = new OracleParameter("p_irs_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_ANAL_2;
            (param[3] = new OracleParameter("p_irs_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_STUS;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_inr_res_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES>(_dtResults, INR_RES.ConverterNew);
            }
            return _list;
        }

        //Rukshan 25-sep-2016
        public List<ReptPickSerials> GetInvoiceSerialForReversalBYSerial(string _company, string _location, string _user, string _session, string _defBin,
          string _invoice, string _serial)
        {
            //sp_getdoserialdetail(p_com in NVARCHAR2, p_invoiceno in NVARCHAR2,p_base_refline in NUMBER, c_data out sys_refcursor)
            List<ReptPickSerials> _list = new List<ReptPickSerials>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailBYSer", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = Convert.ToInt16(_row["ITB_BASE_REFLINE"]);
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_loc = _location;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;

                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";

                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        _one.Tus_base_itm_line = Convert.ToInt16(_row["ITB_BASE_REFLINE"]);
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);

                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_loc = _location;

                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        if (_item.Mi_is_ser1 == -1)
                            _one.Tus_ser_id = 0;   //_one.Tus_serial_id = "-1";  kapila 18/9/2015
                        else
                            _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";

                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }
        public Int32 Is_OptionPerimitted(string userCompany, string userId, Int32 optionCode)
        {
            try
            {
                int _effect = 0;
                OracleParameter[] param = new OracleParameter[3];

                //sp_Is_OptionPerimitted(p_userCom in NVARCHAR2, p_userid in NVARCHAR2,p_optionCode in NUMBER,c_result OUT NUMBER)
                (param[0] = new OracleParameter("p_userCom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userCompany;
                (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                (param[2] = new OracleParameter("p_optionCode", OracleDbType.Int32, null, ParameterDirection.Input)).Value = optionCode;

                OracleParameter orP = new OracleParameter("c_result", OracleDbType.Int32, null, ParameterDirection.Output);
                _effect = ReturnSP_SingleValue("sp_Is_OptionPerimitted", CommandType.StoredProcedure, orP, param);
                return _effect;
            }
            catch (Exception) { return -1; }
        }
        //Lakshan 28 Sep 2016
        public List<InventorySerialN> Get_INT_SER_NOT_RES_SERIAL_ID(InventorySerialN _ser)
        {
            List<InventorySerialN> _list = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_its_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_doc_no;
            (param[1] = new OracleParameter("p_its_itm_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_itm_line;
            (param[2] = new OracleParameter("p_its_batch_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser.Ins_batch_line;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("INT_SER", "sp_get_int_ser_serid", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterIntSer);
            }
            return _list;
        }

        //Lakshan 28 Sep 2016
        public int UpdateAodOutReservedSerialId(string _document, Int32 _serialid, string _com)
        {
            //sp_updateaodinpick(p_docment in NVARCHAR2,p_serialid in NUMBER,o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_docment", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _document;
            (param[1] = new OracleParameter("p_serialid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serialid;
            (param[2] = new OracleParameter("p_ITS_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            int res = UpdateRecords("sp_update_aodout_res", CommandType.StoredProcedure, param);
            return res;
        }

        public DataTable GetGIT_ReconcilationByGIT_AsAt(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _User)
        {  //Lakshika 2016-09-28
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            //(param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;            

            DataTable _result = QueryDataTable("tbl", "SP_GIT_RECONCI_BY_GIT_ASAT", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetAOD_ReconcilationDetails(DateTime _fromDate, DateTime _toDate, string _com, string _loc, string _admin_tm, string _channel, string _user)
        {  //Lakshika 2016-09-28
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_admin_tm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _admin_tm;
            (param[6] = new OracleParameter("in_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_aod_reconcilation_sum", CommandType.StoredProcedure, false, param);//New sp added (SP_GET_AOD_RECONCILATION) Sanjeewa 2017-10-23
            return _result;
        }
        //Modify by Lakshan 01 Oct 2016
        public DataTable GetItemComponentTableNew(string _mainItemCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_main_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainItemCode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblName", "sp_get_mst_itm_compo_new", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        // RUKSHAN 01 Oct 2016
        public decimal GetTotalreqQty(string _doc, string _com, string _itm, int _line)
        {
            decimal reqqty = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("P_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblName", "SP_CHECKBLQTYEXCEED", CommandType.StoredProcedure, false, param);
            if (_resultDT != null)
            {
                if (_resultDT.Rows.Count > 0)
                {
                    if (_resultDT.Rows[0][0].ToString() == "") _resultDT.Rows[0][0] = "0";
                    reqqty = Convert.ToDecimal(_resultDT.Rows[0][0].ToString());

                }
            }
            return reqqty;
        }

        // RUKSHAN 01 Oct 2016
        public ImportsBLItems GET_BL_ITMBYITMLINE(string _docNo, Int32 _line)
        {
            ImportsBLItems oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "sp_get_blitmdet", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLItems>(dtTemp, ImportsBLItems.Converter)[0];
            }
            return oResult;
        }
        //Lakshan 03 Oct 2016
        public DataTable GetInventoryBalanceAsAt(
            string _userr, string _chnl, string _brand, string _model, string _item, bool _itemSts, string _itmCat1, string _itmCat2, string _itmCat3,
            Int32 _withCost, DateTime _asAtDate, Int32 _withSer, Int32 _status, string _com, string _loc)
        {

            DataTable _dtOpenBalance = new DataTable();
            OracleParameter[] _param = new OracleParameter[16];
            _param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (_param[1] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userr;
            (_param[2] = new OracleParameter("in_Channel_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;// _chnl;
            (_param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (_param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (_param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (_param[6] = new OracleParameter("in_Itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;// _itemSts;
            (_param[7] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCat1;
            (_param[8] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCat2;
            (_param[9] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCat3;
            (_param[10] = new OracleParameter("in_WithCost", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withCost;
            (_param[11] = new OracleParameter("in_As_At_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.ToString("dd/MMM/yyyy");
            (_param[12] = new OracleParameter("in_With_Serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withSer;
            (_param[13] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (_param[14] = new OracleParameter("IN_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_param[15] = new OracleParameter("IN_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            _dtOpenBalance = QueryDataTable("tbl", "sp_get_inventory_balance_asat", CommandType.StoredProcedure, false, _param);
            return _dtOpenBalance;
        }
        //subodana
        public DataTable GetPriceBookLvl(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblName", "sp_getplvlpb", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        //subodana
        public DataTable GetItemPrice(string pb, string pl, string itm, DateTime dt)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pb;
            (param[1] = new OracleParameter("p_pl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pl;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
            (param[3] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = dt;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("tblName", "sp_getitemprice", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        public DataTable GetPurchaseReturnDetails(DateTime _fromDate, DateTime _toDate, string _com, string _loc, string _channel, string _supplier, string _user)
        {  //Lakshika 2016-10-04

            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("in_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[6] = new OracleParameter("in_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[7] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "SP_GET_PURCHASE_RETURNS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //modified by Lakshan 05 Oct 2016
        public DataTable StockBalanceSearchNew(DateTime _from, DateTime _to, string _item, string _loc, string _com, bool isStatus, string _doctype = null)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_isstatus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isStatus;
            (param[6] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            _dtResults = QueryDataTable("tbl", "stk_det_search_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "doc_Date,seq_no";
                _dtResults = dv.ToTable();
            }
            return _dtResults;
        }
        public List<InventoryRequestItem> GetMRN_Req_pickitm(string _reqNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<InventoryRequestItem> result = new List<InventoryRequestItem>();
            (param[0] = new OracleParameter("p_Reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_getmrn_req_pickitm", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.MRNConverter);
            return result;
        }
        public List<WarehouseBin> GET_INR_BIN_DATA(WarehouseBin _bin)
        {
            List<WarehouseBin> result = new List<WarehouseBin>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ibn_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin.Ibn_com_cd;
            (param[1] = new OracleParameter("p_ibn_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin.Ibn_loc_cd;
            (param[2] = new OracleParameter("p_ibn_bin_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin.Ibn_bin_cd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tbl", "sp_get_inr_bin_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<WarehouseBin>(_dtResults, WarehouseBin.Converter);
            return result;
        }
        public int SaveInventoryRequestforApproval(InventoryRequest _inventoryRequest)
        {
            int seqno = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[2] = new OracleParameter("p_itr_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exp_dt;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            seqno = UpdateRecords("sp_updateinventoryreqmrn", CommandType.StoredProcedure, param);
            _inventoryRequest.Itr_seq_no = seqno;
            return seqno;
        }

        public Int32 getItemBinScanQty(string itemCode, string bincode, string docNo)
        {
            Int32 sum = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[1] = new OracleParameter("p_bincd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bincode;
            (param[2] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = new DataTable();
            result = QueryDataTable("tbl", "pkg_pda.sp_get_totalbinqty", CommandType.StoredProcedure, false, param);
            if (result.Rows.Count > 0 && result.Rows[0]["TOTAL"] != DBNull.Value)
            {
                sum = Convert.ToInt32(result.Rows[0]["TOTAL"].ToString());
            }
            return sum;
        }

        public decimal getTotalStockQty(string itemcd, string company, string location)
        {
            decimal inrloc = 0;
            decimal temppkser = 0;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcd;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = new DataTable();
            result = QueryDataTable("tbl", "pkg_pda.sp_get_totalstockqty", CommandType.StoredProcedure, false, param);
            if (result.Rows.Count > 0 && result.Rows[0]["TOTAL"] != DBNull.Value)
            {
                inrloc = Convert.ToInt32(result.Rows[0]["TOTAL"].ToString());
            }

            OracleParameter[] param1 = new OracleParameter[4];
            (param1[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcd;
            (param1[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param1[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            param1[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable resultA = new DataTable();
            resultA = QueryDataTable("tbl", "pkg_pda.sp_get_totalscanqty", CommandType.StoredProcedure, false, param1);
            if (resultA.Rows.Count > 0 && resultA.Rows[0]["TOTAL"] != DBNull.Value)
            {
                temppkser = Convert.ToInt32(resultA.Rows[0]["TOTAL"].ToString());
            }


            return inrloc - temppkser;
        }

        public DataTable GetReportParam(string com, string _user)
        {  //Lakshika 2016-09-28
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;

            DataTable _result = QueryDataTable("tbl", "SP_GET_REPORT_PARAM", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Add by Lakshan 11 Oct 2016
        public Int16 UpdateSubDocNoIntHdr(Int32 _seqNo, string _docNo, string _subDocNo)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_ith_sub_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subDocNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_update_int_hdr_sub_docno", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }
        public DataTable SearchSplitReCallNew(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime dtFrom, DateTime dtTo)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string subDoc = null;
            string othDoc = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT #":
                        subDoc = _searchText;
                        break;
                    case "OTHER DOC #":
                        othDoc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            subDoc = (subDoc != null) ? (subDoc + "%") : null;
            othDoc = (othDoc != null) ? (othDoc + "%") : null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ith_cate_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtFrom;
            (param[4] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtTo;
            (param[5] = new OracleParameter("p_ith_sub_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subDoc;
            (param[6] = new OracleParameter("p_ith_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = othDoc;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_ser_int_hdr_split_new", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                DataView dv = _tblBalance.DefaultView;
                dv.Sort = "Document # DESC";
                _tblBalance = dv.ToTable();
            }

            return _tblBalance;
        }
        //subodana 2016-10-11
        public List<InventoryLocation> GETWH_INV_BALANCENew(string _company, string _location, string _item, string _status)
        {
            List<InventoryLocation> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_WHInvbalanceNew", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_tblBalance, InventoryLocation.ConvertTotal);
            }
            return _list;
        }

        //Randima 13/Oct/2016
        public ReptPickSerials getSerialDet_INTSER(int _seqNo, int _itmLine, int _batchLine, int _serLine)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _itmLine;
            (param[2] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _batchLine;
            (param[3] = new OracleParameter("p_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serLine;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblSer = QueryDataTable("_tblBalance", "sp_get_int_ser_det", CommandType.StoredProcedure, false, param);
            ReptPickSerials _reptPickSerials = new ReptPickSerials();
            foreach (DataRow tr in _tblSer.Rows)
            {
                _reptPickSerials = SetReptPickSerials(tr);
            }
            return _reptPickSerials;
        }

        public decimal GetPendingReservation(string _com, string _Bno, string _SIno, string _itm, string _loc)
        {
            // rukshan 03-08-2016
            decimal _value = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bno;
            (param[2] = new OracleParameter("p_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SIno;
            (param[3] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[4] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_PENING_RESERVATION", CommandType.StoredProcedure, false, param);
            string result = _dtResults.Rows[0][0].ToString();
            if (!string.IsNullOrEmpty(result))
            {
                _value = Convert.ToDecimal(result);
            }
            return _value;
        }
        //Lakshan 17 Oct 2016 Modify add ref no
        public List<InventoryRequest> GetAllMaterialRequestsListNew(InventoryRequest _inventoryRequest)
        {
            List<InventoryRequest> _inventoryRequestList = null;
            OracleParameter[] param = new OracleParameter[9];
            //edit by Chamal (add Itr_issue_com) 18-08-2012
            //edit by Chamal (add PDA) 28-08-2014
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[5] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[6] = new OracleParameter("p_reqby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            (param[7] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_ref;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_inventoryRequest.Itr_tp == "PDA")
            {
                _dtResults = QueryDataTable("tblReq", "sp_pdascanbatchs_new", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0) _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterPDA);
            }
            else
            {
                _dtResults = QueryDataTable("tblReq", "sp_ser_aod_in_pending_docs", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0) _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter5);
            }
            if (_inventoryRequestList != null)
            {
                if (_inventoryRequestList.Count > 0)
                {
                    _inventoryRequestList = _inventoryRequestList.OrderBy(c => c.Itr_req_no).ToList();
                }
            }
            return _inventoryRequestList;
        }

        public MST_ITM Get_iteminformation(string itmcd)
        {
            MST_ITM item = new MST_ITM();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl_item", "GET_ITEM_INFORMATIONS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                item = DataTableExtensions.ToGenericList<MST_ITM>(_dtResults, MST_ITM.Converter)[0];
            }
            return item;
        }

        //Lakshan 17 Oct 2016 
        public List<INR_RES_LOG> GET_INR_RES_LOG_DATA(INR_RES_LOG _resLog)
        {
            List<INR_RES_LOG> _list = new List<INR_RES_LOG>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_NO;
            (param[1] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_CD;
            (param[2] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_STUS;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("inr_res", "sp_get_inr_res_log_data", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_LOG>(_tblBalance, INR_RES_LOG.ConverterNew);
            }
            return _list;
        }
        //Lakshan 17 Oct 2016
        public Int32 UPDATE_INR_RES_LOG_DATA_CURR(INR_RES_LOG _resLog)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_COM;
            (param[1] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_LOC;
            (param[2] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_NO;
            (param[3] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_CD;
            (param[4] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_STUS;
            (param[5] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.Temp_IRL_MOD_BY;
            (param[6] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _resLog.IRL_MOD_DT;
            (param[7] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_MOD_SESSION;
            (param[8] = new OracleParameter("p_irl_res_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_BQTY;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_log_curr", CommandType.StoredProcedure, param);
            return result;
        }
        //Lakshan 28 Oct 2016
        public Int32 UPDATE_INR_RES_LOG_DATA(INR_RES_LOG _resLog)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_COM;
            (param[1] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_LOC;
            (param[2] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_NO;
            (param[3] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_CD;
            (param[4] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_STUS;
            (param[5] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.Temp_IRL_MOD_BY;
            (param[6] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _resLog.IRL_MOD_DT;
            (param[7] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_MOD_SESSION;
            (param[8] = new OracleParameter("p_irl_res_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_BQTY;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_log_bal", CommandType.StoredProcedure, param);
            return result;
        }

        //Lakshan 24 Oct 2016
        public Int32 UPDATE_INR_RES_DET_AOD_IN(INR_RES_DET _obj)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_ird_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_STUS;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRD_RES_BQTY;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_det_in", CommandType.StoredProcedure, param);
            return result;
        }

        //Lakshan 28 Oct 2016
        public Int32 UPDATE_INR_RES_DET_BAL(INR_RES_DET _obj)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_IRD_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_STUS;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRD_RES_BQTY;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_det_bal", CommandType.StoredProcedure, param);
            return result;
        }
        //Lakshan 24 Oct 2016
        public Int32 UPDATE_INR_RES_AOD_IN(INR_RES _obj)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irs_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_RES_NO;
            (param[1] = new OracleParameter("p_irs_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_ANAL_2;
            (param[2] = new OracleParameter("p_irs_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_STUS;
            (param[3] = new OracleParameter("p_irs_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_MOD_BY;
            (param[4] = new OracleParameter("p_irs_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRS_MOD_DT;
            (param[5] = new OracleParameter("p_irs_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_MOD_SESSION;
            param[6] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_aod_in", CommandType.StoredProcedure, param);
            return result;
        }


        public List<InvoiceItem> getInvoiceItems(string _invoice)
        {//Rukshan 2016-010-17           
            List<InvoiceItem> _list = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tblData", "sp_getinvoicepc_items", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InvoiceItem>(_tblData, InvoiceItem.ConvertTotalPC);
            }
            return _list;
        }


        //Written By Rukshan on 17/10/2016
        public MasterProfitCenter GetProfitCenter(string _company, string _profitCenter)
        {
            MasterProfitCenter _masterProfitCenter = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblPc", "sp_getprofitcenterdetail", CommandType.StoredProcedure, false, param);

            if (_tblProfitCenter.Rows.Count > 0)
            {
                _masterProfitCenter = DataTableExtensions.ToGenericList<MasterProfitCenter>(_tblProfitCenter, MasterProfitCenter.ConvertTotal)[0];
            }

            return _masterProfitCenter;
        }

        //subodana 2016-10-18
        public DataTable SP_GETENTRYRESDATA(string Sino, string Bno, string Itm)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_Sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Sino;
            (param[1] = new OracleParameter("p_Bno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Bno;
            (param[2] = new OracleParameter("p_Itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Itm;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETENTRYRESDATA", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public DataTable GetTepItemsInOtherStatus(Int32 _userSeqNo, string itmcd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userSeqNo;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_pda.sp_getitmdetails", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        //subodana 2016-10-21
        public DataTable GetEntryProgDetails(string entryno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ENTRYNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "GetEntryProgDetails", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //subodana 2016-10-21
        public DataTable GetEntryProgGRN(string entryno, string item, string aodno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_ENTRYNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("P_AODNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = aodno;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "GetEntryGRNDetails", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public DataTable getScanedSerialInDO(string invoiceno, string itemcode, string serial)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceno;
                (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
                (param[2] = new OracleParameter("p_itemcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
                param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dt = QueryDataTable("doc", "pkg_pda.SP_GET_INVDOSERIAL", CommandType.StoredProcedure, false, param);
                return _dt;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getScanedItemInDO(string invoiceno, string itemcode)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceno;
                (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
                param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dt = QueryDataTable("doc", "pkg_pda.SP_GET_INVDOITM", CommandType.StoredProcedure, false, param);
                return _dt;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Lakshan 25 Oct 2016
        public List<MasterBusinessEntity> GET_MST_BUSENTITY_DATA(string _com, string _busCd, string _tp = "")
        {
            List<MasterBusinessEntity> _busEntity = new List<MasterBusinessEntity>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mbe_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mbe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _busCd;
            (param[2] = new OracleParameter("p_mbe_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_mst_busentity_data", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _busEntity = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblData, MasterBusinessEntity.Converter2);
            }
            return _busEntity;
        }
        //Lakshan 2016  Oct 26
        public List<InventoryRequestItem> GET_INT_REQ_DATA_BY_REQ_NO(string _itr_req_no)
        {
            List<InventoryRequestItem> _list = new List<InventoryRequestItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itr_req_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_int_req_itm_by_reqno", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.Converter);
            }
            return _list;
        }
        //Lakshan 2016  Oct 26
        public SalesOrderHeader GET_SAO_HDR_DATA(string _soNo)
        {
            SalesOrderHeader _list = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_soh_so_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _soNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("sao_hdr", "sp_get_sao_hdr_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SalesOrderHeader>(_dtResults, SalesOrderHeader.Converter)[0];
            }
            return _list;
        }
        //Lakshan 2016  Oct 28
        public List<INR_RES_DET> GET_INR_RES_DET_DATA(INR_RES_DET _resDet)
        {
            List<INR_RES_DET> _list = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_ird_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_ITM_STUS;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_res_det_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_DET>(_dtResults, INR_RES_DET.ConverterNew);
            }
            return _list;
        }

        public DataTable IsDocAvailableWithSeq(string p_tuh_usr_com, Int32 p_docseq, string p_tuh_usr_loc, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;
            (param[1] = new OracleParameter("p_tuh_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_docseq;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_loc;
            (param[3] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[4] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[5] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;
            (param[6] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_pda.sp_check_doc_availawithseq", CommandType.StoredProcedure, false, param);

        }

        public DataTable GetItemDataInTempPickItemWithSeq(string itmCode, Int32 docseqNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCode;
            (param[1] = new OracleParameter("p_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docseqNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblItm", "pkg_pda.sp_check_itm_availabilityseq", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public DataTable CalculateScannedQtyWithSeq(string _itemcode, string _itemstatus, string _company, string _location, string _bin, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay, Int32 docseq)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[1] = new OracleParameter("_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[2] = new OracleParameter("_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[3] = new OracleParameter("_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[4] = new OracleParameter("_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bin;
            (param[5] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[6] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[7] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;
            (param[8] = new OracleParameter("p_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docseq;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep a", "pkg_pda.sp_count_scanned_out_itemsseq", CommandType.StoredProcedure, false, param);

        }

        public DataTable getCurrentDocumentDetailsSeq(string p_tuh_usr_com, Int32 p_tuh_doc_seq, string p_tuh_usr_loc, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_tuh_usr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_com;
            (param[1] = new OracleParameter("p_tuh_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tuh_doc_seq;
            (param[2] = new OracleParameter("p_tuh_usr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_usr_loc;
            (param[3] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[4] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[5] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "pkg_pda.sp_get_doc_detailswitseq", CommandType.StoredProcedure, false, param);

        }

        public Int32 updateDocumentFinishStatusSeq(Int32 docseq, string doctyp, int status, DateTime nowdt,string userid=null,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_docseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docseq;
            (param[1] = new OracleParameter("p_doctyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctyp;
            (param[2] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = nowdt;
            (param[4] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[5] = new OracleParameter("p_spdoctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[6] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_pda.sp_update_docstusseq", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetItemTotalScanedQtySeq(Int32 seqno)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_docseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqno;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_pda.SP_GET_SCANEDQTYSEQ", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetItemTotalDocumentQtySeq(Int32 docseq)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_docseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docseq;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_pda.SP_GET_DOCUMENTQTYSEQ", CommandType.StoredProcedure, false, param);

        }

        public DataTable loadDocumentItemsSeq(Int32 docseq,string userid=null,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_docseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docseq;
            (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[2] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_ser", "pkg_pda.SP_GET_DOCUMENTITEMSSEQ", CommandType.StoredProcedure, false, param);

        }

        public DataTable LoadSavedSerialsSeq(Int32 p_tus_doc_seq, string p_tus_com, string p_tus_loc, string p_tus_itm_cd, string p_tus_bin, string p_tus_itm_stus, string p_tuh_wh_com, string p_tuh_wh_loc, string p_tuh_load_bay,string userid=null,string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_tus_doc_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_tus_doc_seq;
            (param[1] = new OracleParameter("p_tus_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_com;
            (param[2] = new OracleParameter("p_tus_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_loc;
            (param[3] = new OracleParameter("p_tus_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_cd;
            (param[4] = new OracleParameter("p_tus_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_bin;
            (param[5] = new OracleParameter("p_tus_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tus_itm_stus;
            (param[6] = new OracleParameter("p_tuh_wh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_com;
            (param[7] = new OracleParameter("p_tuh_wh_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_wh_loc;
            (param[8] = new OracleParameter("p_tuh_load_bay", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tuh_load_bay;
            (param[9] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[10] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;

            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_ser@scmrep", "pkg_pda.load_saved_serialsseq", CommandType.StoredProcedure, false, param);

        }

        public Int32 getItemBinScanQtySeq(string itemCode, string bincode, Int32 docseq)
        {
            Int32 sum = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[1] = new OracleParameter("p_bincd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bincode;
            (param[2] = new OracleParameter("p_docseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docseq;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable result = new DataTable();
            result = QueryDataTable("tbl", "pkg_pda.sp_get_totalbinqty", CommandType.StoredProcedure, false, param);
            if (result.Rows.Count > 0 && result.Rows[0]["TOTAL"] != DBNull.Value)
            {
                sum = Convert.ToInt32(result.Rows[0]["TOTAL"].ToString());
            }
            return sum;

        }
        //Lakshan 28 Oct 2016
        public Int32 UPDATE_INR_RES_HDR_STS(INR_RES _obj)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_irs_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_RES_NO;
            (param[1] = new OracleParameter("p_irs_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_STUS;
            (param[2] = new OracleParameter("p_irs_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_MOD_BY;
            (param[3] = new OracleParameter("p_irs_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRS_MOD_DT;
            (param[4] = new OracleParameter("p_irs_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_MOD_SESSION;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_hdr_sts", CommandType.StoredProcedure, param);
            return result;
        }
        //Lakshan 2016  Oct 31
        public List<InventoryAllocateDetails> GET_INR_STOCK_ALOC_DATA(InventoryAllocateDetails _obj)
        {
            List<InventoryAllocateDetails> _list = new List<InventoryAllocateDetails>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_isa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_com;
            (param[1] = new OracleParameter("p_isa_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_chnl;
            (param[2] = new OracleParameter("p_isa_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_loc;
            (param[3] = new OracleParameter("p_isa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_tp;
            (param[4] = new OracleParameter("p_isa_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_doc_tp;
            (param[5] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_cd;
            (param[6] = new OracleParameter("p_isa_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_stus;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Isa_itm_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_stock_aloc_data", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryAllocateDetails>(_dtResults, InventoryAllocateDetails.ConverterNew);
                }
            }
            return _list;
        }


        //Written By Rukshan on 07 Nov 2015
        public DataTable GET_EnquiryBond(string _com, string _sbu, string _tobond, string _bl, int cusdec, string _item, string _DOC, string _loc)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sbu;
            (param[2] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[4] = new OracleParameter("p_Cusdec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = cusdec;
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            (param[7] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[8] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();

            int Iscudec = 1;
            string item = _item;
            _dtResults = QueryDataTable("tblSerial", "sp_bondbalance", CommandType.StoredProcedure, false, param);
            if (Iscudec == 1)
            {
                if (!string.IsNullOrEmpty(item))
                {
                    foreach (DataRow _row in _dtResults.Rows)
                    {
                        string bond = _row[2].ToString();
                        string sino = _row[0].ToString();
                        // string _locvalue = _row[0].ToString();
                        decimal value = GetPendingno(_com, bond, item);
                        // _row[12] = value.ToString();
                        DataTable _result;
                        string _locvalue = string.Empty;
                        _result = CHECK_TOBOND_GRN(_com, bond, item);
                        if (_result != null)
                        {
                            if (_result.Rows.Count > 0)
                            {
                                _locvalue = _result.Rows[0][0].ToString();
                            }

                        }
                        decimal _grnfree = Convert.ToDecimal(_row[11].ToString());
                        decimal balnce = _grnfree - value;
                        // _row[13] = balnce.ToString();

                        decimal _PendingReservation = GetPendingReservation(_com, bond, sino, item, _locvalue);

                        _row[11] = balnce - _PendingReservation;
                        _row[12] = _PendingReservation;

                    }
                }
            }
            return _dtResults;
        }




        public DataTable getScanedSerialDataInDO(string docno, string itemcd, string serial)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[2] = new OracleParameter("p_itemcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcd;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_pda.SP_GET_INVDOSERIALDETAIL", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public Int32 UpdateExistingSerialRecivedINDo(string existsdocno, Int32 existseialno, Int32 reserved)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = existsdocno;
            (param[1] = new OracleParameter("p_reserved", OracleDbType.Int32, null, ParameterDirection.Input)).Value = reserved;
            (param[2] = new OracleParameter("p_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = existseialno;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("pkg_pda.SP_UPDATE_USED_SERIALINDO", CommandType.StoredProcedure, param);
            return _eff;
        }

        public DataTable getINTSerialdo(string docno, string item, string serial)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
            (param[2] = new OracleParameter("p_itemcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_pda.SP_GET_INVDOSERIALDATA", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Lakshan 31 Oct 2016
        public decimal GET_INR_LOC_BAL_DATA(InventoryLocation _obj)
        {
            decimal _freetotal = 0;
            InventoryLocation _list = new InventoryLocation();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_com;
            (param[1] = new OracleParameter("p_inl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_loc;
            (param[2] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_cd;
            (param[3] = new OracleParameter("p_inl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_loc", "sp_get_inr_loc_itm_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                decimal _tmp = 0;
                _freetotal = decimal.TryParse(_dtResults.Rows[0]["inl_qty"].ToString(), out _tmp) ? Convert.ToDecimal(_dtResults.Rows[0]["inl_qty"].ToString()) : 0;
            }
            return _freetotal;
        }

        //Lakshan 04 Nov 2016
        public Int32 UpdateItemAllocationData(InventoryAllocateDetails _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_isa_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Isa_seq;
            (param[1] = new OracleParameter("p_isa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_com;
            (param[2] = new OracleParameter("p_isa_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_chnl;
            (param[3] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_cd;
            (param[4] = new OracleParameter("p_isa_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_stus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Isa_aloc_bqty;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_update_inr_stock_aloc", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Lakshan 04 Nov 2016
        public Int32 InrResLogDataSave(INR_RES_LOG _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("p_irl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_SEQ;
            (param[1] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_RES_NO;
            (param[2] = new OracleParameter("p_irl_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_LINE;
            (param[3] = new OracleParameter("p_irl_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_LINE;
            (param[4] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_CD;
            (param[5] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_STUS;
            (param[6] = new OracleParameter("p_irl_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_QTY;
            (param[7] = new OracleParameter("p_irl_res_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_BQTY;
            (param[8] = new OracleParameter("p_irl_res_iqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_IQTY;
            (param[9] = new OracleParameter("p_irl_orig_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_TP;
            (param[10] = new OracleParameter("p_irl_orig_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_NO;
            (param[11] = new OracleParameter("p_irl_orig_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_DT;
            (param[12] = new OracleParameter("p_irl_orig_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_ITM_LINE;
            (param[13] = new OracleParameter("p_irl_orig_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_BATCH_LINE;
            (param[14] = new OracleParameter("p_irl_orig_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_COM;
            (param[15] = new OracleParameter("p_irl_orig_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_LOC;
            (param[16] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_TP;
            (param[17] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_NO;
            (param[18] = new OracleParameter("p_irl_curt_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_DT;
            (param[19] = new OracleParameter("p_irl_curt_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_ITM_LINE;
            (param[20] = new OracleParameter("p_irl_curt_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_BATCH_LINE;
            (param[21] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_COM;
            (param[22] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_LOC;
            (param[23] = new OracleParameter("p_irl_base_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_BASE_LINE;
            (param[24] = new OracleParameter("p_irl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ACT;
            (param[25] = new OracleParameter("p_irl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_BY;
            (param[26] = new OracleParameter("p_irl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_DT;
            (param[27] = new OracleParameter("p_irl_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_SESSION;
            (param[28] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_BY_NEW;
            (param[29] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_DT;
            (param[30] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_SESSION;
            (param[31] = new OracleParameter("p_irl_res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_WP;
            param[32] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_save_inr_inr_res_log", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Lakshan 04 Nov 2016
        public Int32 InrResLogDataUpdate(INR_RES_LOG _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[1] = new OracleParameter("p_irl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_SEQ;
            (param[2] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_RES_NO;
            (param[3] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_CD;
            (param[4] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_STUS;
            (param[5] = new OracleParameter("p_irl_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_QTY;
            (param[6] = new OracleParameter("p_irl_res_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_BQTY;
            (param[7] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_COM;
            (param[8] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_LOC;
            (param[9] = new OracleParameter("p_irl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ACT;
            (param[10] = new OracleParameter("p_irl_mod_by", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_BY_NEW;
            (param[11] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_DT;
            (param[12] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_SESSION;
            (param[13] = new OracleParameter("p_irl_res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_WP;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_update_inr_inr_res_log", CommandType.StoredProcedure, param);
            return _eff;
        }
        public Int32 InrResLogDataUpdateIssue(INR_RES_LOG _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_irl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_SEQ;
            (param[1] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_RES_NO;
            (param[2] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_CD;
            (param[3] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_STUS;
            (param[4] = new OracleParameter("p_irl_res_iqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_IQTY;
            (param[5] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_COM;
            (param[6] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_LOC;
            (param[7] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_TP;
            (param[8] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_NO;
            (param[9] = new OracleParameter("p_irl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ACT;
            (param[10] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_BY_NEW;
            (param[11] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_DT;
            (param[12] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_SESSION;
            (param[13] = new OracleParameter("p_IRL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_LINE;
            (param[14] = new OracleParameter("p_irl_res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_WP;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_upd_inr_res_log_issue_new", CommandType.StoredProcedure, param);
            return _eff;
        }
        public List<INR_RES_LOG> GET_INR_RES_LOG_DATA_NEW(INR_RES_LOG _resLog)
        {
            List<INR_RES_LOG> _list = new List<INR_RES_LOG>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_NO;
            (param[1] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_CD;
            (param[2] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_STUS;
            (param[3] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_COM;
            (param[4] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_LOC;
            (param[5] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_DOC_TP;
            (param[6] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_DOC_NO;
            (param[7] = new OracleParameter("p_irl_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ACT;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("inr_res", "sp_get_inr_res_log_data_new", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_LOG>(_tblBalance, INR_RES_LOG.ConvertAllData);
            }
            return _list;
        }
        //Lakshan 2016  Oct 28
        public List<INR_RES_DET> GET_INR_RES_DET_DATA_BY_RES_NO(string _resNo)
        {
            List<INR_RES_DET> _list = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_res_det_by_res", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_DET>(_dtResults, INR_RES_DET.ConverterNew);
            }
            return _list;
        }
        //subodana 2016-11-04
        public DataTable CusEnqCusdecData(DateTime fromdate, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[1] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETCUSENQCUSDATA", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //subodana 2016-11-04
        public DataTable CusEnqEntryData(DateTime fromdate, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[1] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETCUSENQENTYDATA", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Lakshan 2016  Oct 28
        public List<INR_RES_DET> GET_INR_RES_DET_DATA_NEW(INR_RES_DET _resDet)
        {
            List<INR_RES_DET> _list = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_ird_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_ITM_STUS;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_res_det_data_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_DET>(_dtResults, INR_RES_DET.Converter2);
                foreach (var item in _list)
                {
                    item.IRD_MRN_AVA_BAL = item.IRD_RES_QTY - item.IRD_RES_CQTY - item.Ird_so_mrn_bqty;
                }
            }
            return _list;
        }
        //Lakshan 07 Nov 2016
        public Int32 UPDATE_INR_RES_DET_SO_MRN(INR_RES_DET _obj)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_IRD_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_STUS;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRD_RES_BQTY;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_so_mrn_bal", CommandType.StoredProcedure, param);
            return result;
        }
        //LAkshan 09 Nov 2016
        public int UpdateInventoryRequestStatusWithNote(InventoryRequest _inventoryRequest)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[6] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by;
            (param[7] = new OracleParameter("p_itr_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_note;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_int_req_stus_note", CommandType.StoredProcedure, param);
            return rows_effected;
        }
        //LAkshan 09 Nov 2016
        public int UpdateInventoryRequestItemWithNote(InventoryRequestItem _invReqItm)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[5];
            _invReqItm.Itri_note = string.IsNullOrEmpty(_invReqItm.Tmp_Itri_app_rem) ? _invReqItm.Itri_note : _invReqItm.Itri_note + ";" + _invReqItm.Tmp_Itri_app_rem;
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_seq_no;
            (param[1] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_itm_cd;
            (param[2] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_itm_stus;
            (param[3] = new OracleParameter("p_itri_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_note;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_int_req_itm_rem", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        //LAkshan 19 Dec 2016
        public int UpdateInventoryRequestItemWithNoteNew(InventoryRequestItem _invReqItm)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[9];
            _invReqItm.Itri_note = string.IsNullOrEmpty(_invReqItm.Tmp_Itri_app_rem) ? _invReqItm.Itri_note : _invReqItm.Itri_note + ";" + _invReqItm.Tmp_Itri_app_rem;
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_seq_no;
            (param[1] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_itm_cd;
            (param[2] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_itm_stus;
            (param[3] = new OracleParameter("p_itri_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReqItm.Itri_note;
            (param[4] = new OracleParameter("p_itri_app_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invReqItm.Itri_app_qty;
            (param[5] = new OracleParameter("p_itri_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invReqItm.Itri_bqty;
            (param[6] = new OracleParameter("p_itri_cncl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invReqItm.Itri_cncl_qty;
            (param[7] = new OracleParameter("p_itri_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _invReqItm.Itri_qty;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_int_req_itm_rem_new", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        //Lakshan 10 Nov 2016
        public InventoryLocation GET_INR_LOC_BALANCE(InventoryLocation _obj)
        {
            InventoryLocation _list = new InventoryLocation();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_com;
            (param[1] = new OracleParameter("p_inl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_loc;
            (param[2] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_cd;
            (param[3] = new OracleParameter("p_inl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_loc", "sp_get_inr_loc_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_dtResults, InventoryLocation.Converter)[0];
            }
            return _list;
        }

        //Lakshan 11 Nov 2016
        public int UpdateIntReqProcessData(InventoryRequest _invReq)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_itr_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReq.Itr_seq_no;
            (param[1] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReq.Itr_req_no;
            (param[2] = new OracleParameter("p_itr_req_wp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReq.Itr_req_wp;
            (param[3] = new OracleParameter("p_itr_req_wp_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invReq.Itr_req_wp_usr;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_int_req_process", CommandType.StoredProcedure, param);
            return rows_effected;
        }
        //Lakshan 2016 Sep 23
        public List<InventoryRequest> GET_INT_REQ_DATA_NEW(InventoryRequest _obj)
        {
            List<InventoryRequest> _list = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_req_no;
            (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_com;
            (param[2] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_tp;
            (param[3] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_int_req_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterNew);
            }
            return _list;
        }
        //Lakshan 12 Nov 2016 
        /*
         *copy and modify GET_REQUEST_FOR_DISPATCH_NO 
         *modyfy sp duplicate dealer name
          */
        public List<InventoryRequest> GET_REQ_FOR_DISPATCH_BYNO(String Com, String Route, String MainCate, String Item, String ReqType, String Loc, String SubCate, String Model, DateTime Date, DateTime ToDate, int type, string _ReqNo)
        {
            Int32 isItemSearch = 0;
            if (!string.IsNullOrEmpty(MainCate) || !string.IsNullOrEmpty(Item) || !string.IsNullOrEmpty(SubCate) || !string.IsNullOrEmpty(Model))
            {
                isItemSearch = 1;
            }

            List<InventoryRequest> result = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ROUTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Route;
            (param[2] = new OracleParameter("P_MAINCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MainCate;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[4] = new OracleParameter("P_REQTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqType;
            (param[5] = new OracleParameter("P_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[6] = new OracleParameter("P_SUBCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SubCate;
            (param[7] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[8] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            (param[9] = new OracleParameter("P_ISITEMSEARCH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isItemSearch;
            (param[10] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[11] = new OracleParameter("P_TYPE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;
            (param[12] = new OracleParameter("P_REQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReqNo;
            param[13] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tblSerial", "SP_GET_REQ_FOR_DISPATCH_BY_NO", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterDispatch);

            return result;
        }
        //Lakshan 12 Nov 2016 
        /*
         *copy and modify GET_REQUEST_FOR_DISPATCH_NO 
         *modyfy sp duplicate dealer name
          */
        public List<InventoryRequest> GET_REQUEST_FOR_DISPATCH_EXP_DT(String Com, String Route, String MainCate, String Item, String ReqType, String Loc, String SubCate, String Model, DateTime Date, DateTime ToDate, int type)
        {
            Int32 isItemSearch = 0;
            if (!string.IsNullOrEmpty(MainCate) || !string.IsNullOrEmpty(Item) || !string.IsNullOrEmpty(SubCate) || !string.IsNullOrEmpty(Model))
            {
                isItemSearch = 1;
            }

            List<InventoryRequest> result = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ROUTE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Route;
            (param[2] = new OracleParameter("P_MAINCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MainCate;
            (param[3] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[4] = new OracleParameter("P_REQTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqType;
            (param[5] = new OracleParameter("P_LOCATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            (param[6] = new OracleParameter("P_SUBCATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SubCate;
            (param[7] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Model;
            (param[8] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            (param[9] = new OracleParameter("P_ISITEMSEARCH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isItemSearch;
            (param[10] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = ToDate;
            (param[11] = new OracleParameter("P_TYPE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = type;
            param[12] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("tblSerial", "SP_GET_REQ_FOR_DISPATCH_EXDT", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterDispatch);
            int count = _dtResults.Rows.Count;
            if (result.Count > 0)
            {
                result = result.OrderBy(c => c.Itr_req_no).ToList();
            }
            return result;
        }
        //Written by Rukshan 14/Jul/2016
        public Int32 Update_SoA_status(string _com, string _so)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_Soa", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _so;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_sales.SP_UPDATESOA", CommandType.StoredProcedure, param);
            return effects;
        }



        //Lakshan 15 Nov 2016 
        public ImpCusdecItm GET_AOD_OUT_MAIN_ITM_CD(string _docNo, Int32 _lineNo)
        {
            ImpCusdecItm _list = new ImpCusdecItm();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cui_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_cui_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_aod_out_main_itm", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ImpCusdecItm>(_dtResults, ImpCusdecItm.Converter)[0];
            }
            return _list;
        }
        //Lakshan 16 Nov 2016
        public Int32 SaveWarrantyAuthorization(int_war_print_auth _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_iwa_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_doc_no;
            (param[1] = new OracleParameter("p_iwa_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iwa_line;
            (param[2] = new OracleParameter("p_iwa_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_id;
            (param[3] = new OracleParameter("p_iwa_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_1;
            (param[4] = new OracleParameter("p_iwa_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_2;
            (param[5] = new OracleParameter("p_iwa_print_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_print_usr;
            (param[6] = new OracleParameter("p_iwa_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_cre_by;
            (param[7] = new OracleParameter("p_iwa_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iwa_cre_dt;
            (param[8] = new OracleParameter("p_iwa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_mod_by;
            (param[9] = new OracleParameter("p_iwa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iwa_mod_dt;
            (param[10] = new OracleParameter("p_iwa_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iwa_act;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_save_int_war_print_auth", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Lakshan 16 Nov 2016
        public List<int_war_print_auth> GET_INT_WAR_PRINT_AUTH(int_war_print_auth _obj)
        {
            List<int_war_print_auth> _list = new List<int_war_print_auth>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_iwa_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_doc_no;
            (param[1] = new OracleParameter("p_iwa_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_id;
            (param[2] = new OracleParameter("p_iwa_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_1;
            (param[3] = new OracleParameter("p_iwa_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_2;
            (param[4] = new OracleParameter("p_iwa_print_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_print_usr;
            (param[5] = new OracleParameter("p_iwa_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iwa_act;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Iwa_doc_no) && _obj.Iwa_ser_id == 0)
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("int_req", "sp_get_int_war_print_auth", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<int_war_print_auth>(_dtResults, int_war_print_auth.Converter);
                }
            }
            return _list;
        }
        public MasterLocation GetLocationInfor(string _CompCode, string _LocCode)
        {
            MasterLocation _locList = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompCode;
            (param[1] = new OracleParameter("p_loc_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblloc", "sp_get_location_by_code", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _locList = DataTableExtensions.ToGenericList<MasterLocation>(_dtResults, MasterLocation.ConverterTotal)[0];
            }
            return _locList;
        }
        //Add by Lakshan 17 Nov 2016
        public Int32 UpdateWarrantyAuthorization(int_war_print_auth _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_iwa_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_ser_id;
            (param[1] = new OracleParameter("p_iwa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iwa_mod_by;
            (param[2] = new OracleParameter("p_iwa_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iwa_mod_dt;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_update_int_war_print_auth", CommandType.StoredProcedure, param);
            return _eff;
        }

        //Rukshan 2016 Nov 17
        public List<ProductionLine> GET_PRODUCTLINE(ProductionLine _obj)
        {
            List<ProductionLine> _list = new List<ProductionLine>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.MPL_COM;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.MPL_LOC;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "pkg_search_inv.SP_GETPRODUCT_LINE", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ProductionLine>(_dtResults, ProductionLine.Converter);
            }
            return _list;
        }

        //subodana 2016-11-19
        public DataTable Barcodeserdata(string com, string doc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_GETBARCDSERIAL", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        public decimal GET_INR_BATCH_BALANCE_BY_BATCH_NO(InventoryBatchN _obj)
        {
            decimal _bal = 0;
            decimal _tmpBal = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_inb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_batch_no;
            (param[1] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_com;
            (param[2] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_loc;
            (param[3] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_cd;
            (param[4] = new OracleParameter("p_inb_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_stus;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_chk_inr_batch_bal_by_bch_no", CommandType.StoredProcedure, false, param);
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    _bal = decimal.TryParse(_dt.Rows[0][0].ToString(), out _tmpBal) ? Convert.ToDecimal(_dt.Rows[0]["BAL"].ToString()) : 0;
                }
            }
            return _bal;
        }


        public DataTable getReservationRequiredItems(Int32 userseq, string reserve)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_userseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userseq;
                (param[1] = new OracleParameter("p_reserve", OracleDbType.Int32, null, ParameterDirection.Input)).Value = reserve;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dt = QueryDataTable("doc", "pkg_pda.SP_GETRESERREQITEMS", CommandType.StoredProcedure, false, param);
                return _dt;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public DataTable getInrLocItemDetails(string itemCd, string itmStus, string company, string location)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCd;
                (param[1] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmStus;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dt = QueryDataTable("loc", "pkg_pda.SP_GETINRLOCDETAILS", CommandType.StoredProcedure, false, param);
                return _dt;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int32 updateReservationQuantity(string itmcd, string itmstus, string company, string location, Int32 itmqty, Int32 userseq, string lineno)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[8];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
                (param[1] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmstus;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[4] = new OracleParameter("p_itmqty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmqty;
                (param[5] = new OracleParameter("p_userseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userseq;
                (param[6] = new OracleParameter("p_lineno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lineno;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int32)UpdateRecords("pkg_pda.SP_UPDATERESERVATIONQTY", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getItemDetWithStatus(Int32 userseq, string status, string itmcd)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_userseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userseq;
            (param[1] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("loc", "pkg_pda.SP_GETTEMPPICKITM", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public DataTable getTemporyDocument(Int32 userseq, string company)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_userseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userseq;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dt = QueryDataTable("loc", "pkg_pda.SP_GETTEMPPICKDOCBYSEQ", CommandType.StoredProcedure, false, param);
                return _dt;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //RUKSHAN 2016-11-23
        public DataTable GETCUSTOMERENTRY(string com, DateTime _fromdate, DateTime _todate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_getcustomerentry", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //RUKSHAN 2016-11-23
        public DataTable CHECKSERILA_COM(string com, string _itm, string _serial)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("P_SERIAL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_CHECKSERIALINCOM", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //RUKSHAN 2016-11-23
        public List<InventoryBatchN> GETBASEITEMBY_TOBOND(string _doc, string _com, string _itm)
        {
            List<InventoryBatchN> _list = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_getbaseitembytobond", CommandType.StoredProcedure, false, param);
            if (_dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryBatchN>(_dt, InventoryBatchN.Converternew2);
            }
            return _list;
        }
        // Lakshan 30 Dec 2016
        public List<InventorySerialN> GET_INT_SER_DATA_BY_SEQNO(Int32 _seqNo)
        {
            List<InventorySerialN> _list = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_its_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_seqNo == 0)
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("INT_SER", "sp_get_int_ser_by_seq_no", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterIntSer);
                }
            }
            return _list;
        }

        // Lakshan 30 Dec 2016
        public List<InventorySerialN> GET_INR_SER_DATA_BY_SEQNO(Int32 _seqNo)
        {
            List<InventorySerialN> _list = new List<InventorySerialN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ins_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_seqNo == 0)
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("INR_SER", "sp_get_inr_ser_by_seq_no", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventorySerialN>(_dtResults, InventorySerialN.ConverterNew);
                }
            }
            return _list;
        }

        // Lakshan 30 Dec 2016
        public List<InventoryBatchN> GET_INT_BATCH_BY_SEQNO(Int32 _seqNo)
        {
            List<InventoryBatchN> _list = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itb_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            if (_seqNo == 0)
            {
                return _list;
            }
            else
            {
                dt = QueryDataTable("INR_SER", "sp_get_int_batch_by_seq_no", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.ConverterForValidate);
                }
            }
            return _list;
        }
        // Lakshan 06 Dec 2016
        public List<InventoryBatchRefN> GET_INR_BATCH_BY_SEQNO(Int32 _seqNo)
        {
            List<InventoryBatchRefN> _list = new List<InventoryBatchRefN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itb_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            if (_seqNo == 0)
            {
                return _list;
            }
            else
            {
                dt = QueryDataTable("INR_BATCH", "sp_get_inr_batch_by_seq_no", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryBatchRefN>(dt, InventoryBatchRefN.Converter);
                }
            }
            return _list;
        }
        // Lakshan 06 Dec 2016
        public List<UnitConvert> GET_UNIT_CONVERTER_DATA(UnitConvert _obj)
        {
            List<UnitConvert> _list = new List<UnitConvert>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mmu_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.mmu_model;
            (param[1] = new OracleParameter("p_mmu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.mmu_com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            if (string.IsNullOrEmpty(_obj.mmu_com) && string.IsNullOrEmpty(_obj.mmu_model))
            {
                return _list;
            }
            else
            {
                dt = QueryDataTable("mst_model_unit", "sp_get_mst_model_unit_con_data", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<UnitConvert>(dt, UnitConvert.Converter);
                }
            }
            return _list;
        }
        //Lakshan 2016  Oct 26
        public List<InventoryRequestItem> GET_INT_REQ_ITM_DATA_BY_REQ_NO(string _itr_req_no)
        {
            List<InventoryRequestItem> _list = new List<InventoryRequestItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itr_req_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_int_req_itm_by_reqno", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterNew);
            }
            return _list;
        }
        //Lakshan 2016  08 dec
        public List<MasterItemSimilar> GET_MST_ITM_SIMILER_DATA(MasterItemSimilar _obj)
        {
            List<MasterItemSimilar> _list = new List<MasterItemSimilar>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_misi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Misi_itm_cd;
            (param[1] = new OracleParameter("p_misi_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Misi_com;
            (param[2] = new OracleParameter("P_misi_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Misi_pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("mst_similer_itm", "sp_get_mst_itm_similar_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterItemSimilar>(_dtResults, MasterItemSimilar.ConverterSimilar);
            }
            return _list;
        }

        //Lakshan 08 dec 2016
        public List<InventoryLocation> GET_INR_LOC_BALANCE_ALL_STUS(InventoryLocation _obj)
        {
            List<InventoryLocation> _list = new List<InventoryLocation>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_com;
            (param[1] = new OracleParameter("p_inl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_loc;
            (param[2] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_cd;
            (param[3] = new OracleParameter("p_inl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_loc", "sp_get_inr_loc_bal_by_itm", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_dtResults, InventoryLocation.Converter);
            }
            return _list;
        }
        //Lakshan 13 Sep 2016 different converter
        public List<InventoryBatchN> GET_INT_BATCH_DATA_NEW(InventoryBatchN _obj)
        {
            List<InventoryBatchN> _list = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itb_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_seq_no;
            (param[1] = new OracleParameter("p_itb_itm_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_line;
            (param[2] = new OracleParameter("p_itb_batch_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_batch_line;
            (param[3] = new OracleParameter("p_itb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_batch_no;
            (param[4] = new OracleParameter("p_itb_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_doc_no;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            if (string.IsNullOrEmpty(_obj.Inb_doc_no) && string.IsNullOrEmpty(_obj.Inb_batch_no))
            {
                return _list;
            }
            else
            {
                dt = QueryDataTable("int_batch", "sp_get_int_batch_data", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter3);
                }
            }
            return _list;
        }

        //RUKSHAN 2016-11-23
        public DataTable GETINRBATCH(string com, string seq)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_getinrbatch_seq", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //RUKSHAN 2016-11-23
        public DataTable GETMODELCLS_DEF(string MODEL)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MODEL;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_search_inv.SP_GETMODELCLS_DEF", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Add funtion as per the wimal
        public DataTable Get_Actual_FIFO_NonSerialsFORProduction(string _com, string _loc, string _item, string _itemstatus, string inb_batch_no, int _jobline, Int16 _isExpDate, DateTime _expdate, string BIN)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_isexpdt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExpDate;
            (param[5] = new OracleParameter("p_expdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expdate.Date;
            (param[6] = new OracleParameter("p_inb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inb_batch_no;
            (param[7] = new OracleParameter("p_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobline;
            (param[8] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BIN; // THaraka 2015-12-16
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_nonserial", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_nonserial_batchPI", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //lAKSHAN 2014/Feb/09
        public DataTable Get_Actual_FIFO_NonSerialsFORBATCH(string _com, string _loc, string _item, string _itemstatus, string inb_batch_no, int _jobline, Int16 _isExpDate, DateTime _expdate, string BIN)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itemstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[4] = new OracleParameter("p_isexpdt", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isExpDate;
            (param[5] = new OracleParameter("p_expdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expdate.Date;
            (param[6] = new OracleParameter("p_inb_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inb_batch_no;
            (param[7] = new OracleParameter("p_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobline;
            (param[8] = new OracleParameter("P_BIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BIN; // THaraka 2015-12-16
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_nonserial", CommandType.StoredProcedure, false, param);
            DataTable _dtResults = QueryDataTable("tblFifo", "sp_get_fifo_nonserial_batch", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Sanjeewa 2016-12-16
        public DataTable check_AOD_Recieved(string _docno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("in_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_check_aod_recd", CommandType.StoredProcedure, false, param);
            return _dt;

        }

        //RUKSHAN 2016-11-23
        public bool CheckAOD_AlreadyIn(string _aodno, string _com, out string loc)
        {
            bool found = false;
            loc = string.Empty;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_aod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aodno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "pkg_search_inv.SP_CheckAOD_AlreadyIn", CommandType.StoredProcedure, false, param);
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    loc = _dt.Rows[0][0].ToString();
                    found = true;
                }
            }
            return found;
        }


        public DataTable GetItemInventoryBalanceQty(string _company, string _location, string _item, string _status)
        {
            //sp_invbalancestatus(p_com in NVARCHAR2,p_loc in NVARCHAR2 ,p_item in NVARCHAR2,p_status in NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "SP_GETLOCQTY", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        //Wimal 2016-12-16
        public DataTable GETSELL_OUT_REPORT(DateTime _fromdate, DateTime _todate, string _user_id, string _Brand, string _Model, string _Itemcode, string _Itemcat1, string _Itemcat2, string _Itemcat3, string _Promotor, string _Customer, string _SalesExc)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("in_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate.Date;
            (param[1] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate.Date;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemcode;
            (param[6] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemcat1;
            (param[7] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemcat2;
            (param[8] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Itemcat3;
            (param[9] = new OracleParameter("in_Promotor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[10] = new OracleParameter("in_Customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Customer;
            (param[11] = new OracleParameter("in_SalesExc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SalesExc;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_sellout_report", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Tharaka 2015-10-13 copy by lakshan
        public List<InventoryLocation> GET_LOC_ITEMS_FOR_DISPATCH_NEW(String Com, String UserID, String Item, String Stus)
        {
            List<InventoryLocation> result = new List<InventoryLocation>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = UserID;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[3] = new OracleParameter("P_ITMSTUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "SP_GET_LOC_ITEM_FOR_DISP_NEW", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryLocation>(_dtResults, InventoryLocation.ConverterDispatch);
            return result;
        }

        //subodana 2016-12-17
        public Int32 UpdateSerQtyForDispatch(string doc, string item, string status, int qty, string line)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = qty;
            (param[4] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("Update_ser_qty_dispatch", CommandType.StoredProcedure, param);
            return _eff;
        }

        //Written By Rukshan on 07 Nov 2015
        public DataTable GET_GetTobond_BL_Date(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _from, DateTime _to)
        {

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _tobond = null;
            string _bl = null;
            string _DOC = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC #":
                        _DOC = _searchText;

                        break;
                    case "BL #":
                        _bl = _searchText;

                        break;

                    case "TO-BOND":
                        _tobond = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _tobond = (_tobond != null) ? (_tobond.ToUpper() + "%") : null;
            _bl = (_bl != null) ? (_bl.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            //(param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[4] = new OracleParameter("p_Cusdec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            (param[7] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            (param[8] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[9] = new OracleParameter("P_To", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[10] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5].ToString();
            param[11] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();

            int Iscudec = Convert.ToInt32(searchParams[2].ToString());
            string item = searchParams[3].ToString();
            if (!string.IsNullOrEmpty(item))
            {
                _dtResults = QueryDataTable("tblSerial", "pkg_search_inv.sp_gettobond_bl", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tblSerial", "pkg_search_inv.sp_gettobondDate_bl", CommandType.StoredProcedure, false, param);
            }
            if (Iscudec == 1)
            {
                if (!string.IsNullOrEmpty(item))
                {
                    foreach (DataRow _row in _dtResults.Rows)
                    {
                        string bond = _row[2].ToString();
                        string sino = _row[0].ToString();
                        // string _loc =_row[0].ToString();
                        DataTable _result;
                        // bool _loc=false;
                        string _locvalue = string.Empty;
                        _result = CHECK_TOBOND_GRN(searchParams[0].ToString(), bond, item);
                        if (_result != null)
                        {
                            if (_result.Rows.Count > 0)
                            {
                                _locvalue = _result.Rows[0][0].ToString();
                            }

                        }


                        decimal value = GetPendingno(searchParams[0].ToString(), bond, item);
                        // _row[12] = value.ToString();

                        decimal _grnfree = Convert.ToDecimal(_row[12].ToString());
                        decimal balnce = _grnfree - value;
                        // _row[13] = balnce.ToString();

                        decimal _PendingReservation = GetPendingReservation(searchParams[0].ToString(), bond, sino, item, _locvalue);

                        _row[12] = balnce - _PendingReservation;
                        _row[13] = _PendingReservation;

                    }
                }
            }

            //_dtResults = QueryDataTable("tblSerial", "sp_GetTobond_BL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GET_PREV_ITEM_COST_FOR_COSTSHEET(string _item, string _comp)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_get_itm_lts_cost", CommandType.StoredProcedure, false, param);
            return _dt;
        }

        public Int32 SavePhysicalStockVerificationHdr(PhysicalStockVerificationHdr _hdr)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_aush_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_SEQ;
            (param[1] = new OracleParameter("p_aush_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_COM;
            (param[2] = new OracleParameter("p_aush_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_JOB;
            (param[3] = new OracleParameter("p_aush_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_LOC;
            (param[4] = new OracleParameter("p_aush_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.AUSH_DT;
            (param[5] = new OracleParameter("p_aush_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_REM;
            (param[6] = new OracleParameter("p_aush_frm_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.AUSH_FRM_DT;
            (param[7] = new OracleParameter("p_aush_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.AUSH_TO_DT;
            (param[8] = new OracleParameter("p_aush_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_STUS;
            (param[9] = new OracleParameter("p_aush_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_CRE_BY;
            (param[10] = new OracleParameter("p_aush_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.AUSH_CRE_DT;
            (param[11] = new OracleParameter("p_aush_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_MOD_BY;
            (param[12] = new OracleParameter("p_aush_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.AUSH_MOD_DT;
            (param[13] = new OracleParameter("p_aush_supvis_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_SUPVIS_BY;
            (param[14] = new OracleParameter("p_aush_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_SESSION_ID;
            (param[15] = new OracleParameter("p_aush_dipartment", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_DIPARTMENT;
            (param[16] = new OracleParameter("p_aush_resion", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_REASON;

            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //effects = (Int32)UpdateRecords("pkg_inventory.sp_savePhy_StockVer_Hdr", CommandType.StoredProcedure, param);
            effects = (Int32)UpdateRecords("sp_savePhy_StockVer_Hdr", CommandType.StoredProcedure, param);
            return effects;
        }


        //Written By Rukshan on 07 Nov 2015
        public DataTable SEARCH_STOCKVERF_HDR(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _from, DateTime _to)
        {

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _tobond = null;
            string _bl = null;
            string _DOC = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC #":
                        _DOC = _searchText;

                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _DOC = (_DOC != null) ? (_DOC.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "pkg_search_inv.sp_getPhyStockVer_Hdr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Written By Rukshan on 30 DEC 2015
        public PhysicalStockVerificationHdr GET_STOCKVERF_HDR(String _doc)
        {
            PhysicalStockVerificationHdr result = new PhysicalStockVerificationHdr();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("HDR", "GET_STOCKVERF_HDR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<PhysicalStockVerificationHdr>(_dtResults, PhysicalStockVerificationHdr.Converter)[0];
            return result;
        }
        public List<PhsicalStockVerificationMain> GET_STOCKVERF_MAIN(String _doc)
        {
            List<PhsicalStockVerificationMain> result = new List<PhsicalStockVerificationMain>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("HDR", "GET_STOCKVERF_MAIN", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<PhsicalStockVerificationMain>(_dtResults, PhsicalStockVerificationMain.Converter);
            return result;
        }
        //Written By Rukshan on 07 Nov 2015
        public DataTable GET_GetTobond_BL_RES(string _initialSearchParams, string _searchCatergory, string _searchText)
        {

            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _tobond = null;
            string _bl = null;
            string _DOC = null;
            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC #":
                        _DOC = _searchText;

                        break;
                    case "BL #":
                        _bl = _searchText;

                        break;

                    case "TO-BOND":
                        _tobond = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _tobond = (_tobond != null) ? (_tobond.ToUpper() + "%") : null;
            _bl = (_bl != null) ? (_bl.ToUpper() + "%") : null;
            DateTime _from = new DateTime();
            DateTime _to = new DateTime();
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_tobond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobond;
            (param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            //(param[3] = new OracleParameter("p_bl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bl;
            (param[4] = new OracleParameter("p_Cusdec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[5] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[6] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DOC;
            (param[7] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();
            (param[8] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[9] = new OracleParameter("P_To", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[10] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[5].ToString();
            param[11] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();

            int Iscudec = Convert.ToInt32(searchParams[2].ToString());
            string item = searchParams[3].ToString();
            _dtResults = QueryDataTable("tblSerial", "pkg_search_inv.sp_gettobond_bl_res", CommandType.StoredProcedure, false, param);
            if (Iscudec == 1)
            {
                if (!string.IsNullOrEmpty(item))
                {
                    foreach (DataRow _row in _dtResults.Rows)
                    {
                        string bond = _row[2].ToString();
                        string sino = _row[0].ToString();
                        // string _loc =_row[0].ToString();
                        DataTable _result;
                        // bool _loc=false;
                        string _locvalue = string.Empty;
                        _result = CHECK_TOBOND_GRN(searchParams[0].ToString(), bond, item);
                        if (_result != null)
                        {
                            if (_result.Rows.Count > 0)
                            {
                                _locvalue = _result.Rows[0][0].ToString();
                            }

                        }


                        decimal value = GetPendingno(searchParams[0].ToString(), bond, item);
                        // _row[12] = value.ToString();

                        decimal _grnfree = Convert.ToDecimal(_row[12].ToString());
                        decimal balnce = _grnfree - value;
                        // _row[13] = balnce.ToString();

                        decimal _PendingReservation = GetPendingReservation(searchParams[0].ToString(), bond, sino, item, _locvalue);

                        _row[12] = balnce - _PendingReservation;
                        _row[13] = _PendingReservation;

                    }
                }
            }

            //_dtResults = QueryDataTable("tblSerial", "sp_GetTobond_BL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int16 UpdatePhysicalStockHdr(PhysicalStockVerificationHdr _hdr)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_JOB;
            (param[1] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_COM;
            (param[2] = new OracleParameter("p_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_MOD_BY;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.AUSH_STUS;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_aud_svr_HDR", CommandType.StoredProcedure, param);
            return effects;
        }

        //RUKSHAN 2017-01-03
        public List<InventoryAllocateDetails> GET_STOCK_ALOC_DATA_TRCK(InventoryAllocateDetails _obj)
        {
            List<InventoryAllocateDetails> _list = new List<InventoryAllocateDetails>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_isa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_com;
            (param[1] = new OracleParameter("p_isa_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_chnl;
            (param[2] = new OracleParameter("p_isa_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_loc;
            (param[3] = new OracleParameter("p_isa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_tp;
            (param[4] = new OracleParameter("p_isa_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_doc_tp;
            (param[5] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_cd;
            (param[6] = new OracleParameter("p_isa_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_stus;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();

            _dtResults = QueryDataTable("int_req_itm", "get_stock_aloc_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryAllocateDetails>(_dtResults, InventoryAllocateDetails.ConverterNew);
            }

            return _list;
        }
        //Lakshan 06/Jan/2017 
        //copy of SaveInventoryRequestDispach
        //Remove the update part
        public int SaveInventoryRequestDispachPlan(InventoryRequest _inventoryRequest)
        {
            int seqno = 0;
            OracleParameter[] param = new OracleParameter[39];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[2] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[3] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_sub_tp;
            (param[4] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[5] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_ref;
            (param[6] = new OracleParameter("p_itr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_dt;
            (param[7] = new OracleParameter("p_itr_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exp_dt;
            (param[8] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[9] = new OracleParameter("p_itr_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_no;
            (param[10] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_bus_code;
            (param[11] = new OracleParameter("p_itr_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_note;
            (param[12] = new OracleParameter("p_itr_issue_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_from;
            (param[13] = new OracleParameter("p_itr_rec_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_rec_to;
            (param[14] = new OracleParameter("p_itr_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_direct;
            (param[15] = new OracleParameter("p_itr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_country_cd;
            (param[16] = new OracleParameter("p_itr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_town_cd;
            (param[17] = new OracleParameter("p_itr_cur_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cur_code;
            (param[18] = new OracleParameter("p_itr_exg_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exg_rate;
            (param[19] = new OracleParameter("p_itr_collector_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_id;
            (param[20] = new OracleParameter("p_itr_collector_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_name;
            (param[21] = new OracleParameter("p_itr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_act;
            (param[22] = new OracleParameter("p_itr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            (param[23] = new OracleParameter("p_itr_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[24] = new OracleParameter("p_itr_issue_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com; //add chamal 17-08-2012
            (param[25] = new OracleParameter("p_itr_gran_opt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt1; //add chamal 17-08-2012
            (param[26] = new OracleParameter("p_itr_gran_opt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt2; //add chamal 17-08-2012
            (param[27] = new OracleParameter("p_itr_gran_opt3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt3; //add chamal 17-08-2012
            (param[28] = new OracleParameter("p_itr_gran_opt4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt4; //add chamal 17-08-2012
            (param[29] = new OracleParameter("p_itr_gran_nstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_nstus; //add chamal 17-08-2012
            (param[30] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by; //add chamal 17-08-2012
            (param[31] = new OracleParameter("p_itr_gran_narrt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_narrt; //add chamal 17-08-2012
            (param[32] = new OracleParameter("p_itr_gran_app_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_note; //add chamal 17-08-2012
            (param[33] = new OracleParameter("p_itr_gran_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_stus; //add chamal 17-08-2012
            (param[34] = new OracleParameter("p_itr_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal1; //add scahith 2012/11/3
            (param[35] = new OracleParameter("p_itr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal2; //add scahith 2013/02/15
            (param[36] = new OracleParameter("p_itr_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_seq_no; //add Prabhath 2013/02/23
            (param[37] = new OracleParameter("P_itr_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_line; //add tharaka 2014-10-30
            param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            seqno = UpdateRecords("sp_save_int_request_disp", CommandType.StoredProcedure, param);
            _inventoryRequest.Itr_seq_no = seqno;
            return seqno;
        }

        public int GET_PSI_REPT1(string COM, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PSI_REP", CommandType.StoredProcedure, param);

            return effects;
        }
        public DataTable GET_PSI_REPT_GIT(string COM, string _itm)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_PSI_REP_GIT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Add by Rukshan 
        public DataTable CHECK_TOBOND_GRN_status(string _com, string _doc, string _itm, string _status)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_search_inv.SP_CHKTOBND_GRN_STATUS", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }

        public Int16 GET_PSI_REPT_IN_DATE(string COM, string _itm)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PSIREP_IN_DT", CommandType.StoredProcedure, param);

            return effects;
        }
        public DataTable GET_PSI_REPT_MAX_DATE(string COM, DateTime FROMDATE)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = FROMDATE;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_PSIREP_GIT_DT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GET_PSI_REPT_OUT_DATE(string COM, string _itm)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_PSIREP_OUT_DT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GET_PSI_REPT(string user)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_PSIREP_GRN_DT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GET_PSI_REPTAFTERGIT(string user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_PSIREP_AFGIT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int16 GET_SAVEGIT(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _User, int _export)
        {  //Sanjeewa 2016-09-17

            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;
            param[0] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[14] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _export;
            //(param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;            


            effects = (Int16)UpdateRecords("sp_get_git_asat_psi", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int16 GET_SAVEGIT2(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _User, int _export)
        {  //Sanjeewa 2016-09-17

            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;
            param[0] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[14] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _export;
            //(param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;            


            effects = (Int16)UpdateRecords("sp_get_git_asat_psi2", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int16 GET_SAVEGIT3(DateTime _asatDate, string _com, string _toloc, string _fromloc, string _itemcode, string _brand, string _model, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _User, int _export)
        {  //Sanjeewa 2016-09-17

            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;
            param[0] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[12] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[13] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[14] = new OracleParameter("in_export", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _export;
            //(param[3] = new OracleParameter("fromloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;            


            effects = (Int16)UpdateRecords("sp_get_git_asat_psinew", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int16 SAVEPSI_REPORT(string COM, string _user, DateTime _from, DateTime _todate, DateTime _openmaxdate, string _maxno,
           string _model, string _brand, string _cat1, string _cat2, string _cat3, int _intcom, string _itm)
        {

            OracleParameter[] param = new OracleParameter[14];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("P_MAXDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _openmaxdate;
            (param[5] = new OracleParameter("P_MAXNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maxno;
            (param[6] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[9] = new OracleParameter("P_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[10] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[11] = new OracleParameter("P_INTCOM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intcom;
            (param[12] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PSIREP_OPEN_DT", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int16 SAVEPSI_REPORT2(string COM, string _user, DateTime _from, DateTime _todate, DateTime _openmaxdate, string _maxno,
          string _model, string _brand, string _cat1, string _cat2, string _cat3, int _intcom, string _itm, string Opcodes)
        {

            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("P_MAXDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _openmaxdate;
            (param[5] = new OracleParameter("P_MAXNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maxno;
            (param[6] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[9] = new OracleParameter("P_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[10] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[11] = new OracleParameter("P_INTCOM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intcom;
            (param[12] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[13] = new OracleParameter("P_OPCODES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Opcodes;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PSIREP_OPEN_DT2", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 UPDATE_INR_RES_DET_SO_MRN_MINUS(INR_RES_DET _obj)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_IRD_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_ITM_STUS;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRD_RES_BQTY;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_so_mrn_bal", CommandType.StoredProcedure, param);
            return result;
        }
        public Int32 DeletePsiTbl(string user)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_delete_psitbl", CommandType.StoredProcedure, param);
            return result;
        }

        //Add by Akila 2017/01/10
        public DataTable GetItemStatusDefinition_byLocation(string comCode, string locationCode)
        {
            DataTable _resultTable = new DataTable();

            try
            {
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
                (param[1] = new OracleParameter("p_locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locationCode;

                param[2] = new OracleParameter("o_itemStatus", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _resultTable = QueryDataTable("ItemStatusByLocation", "SP_GET_ITEMSTSBYLOC", CommandType.StoredProcedure, false, param);
                return _resultTable;
            }
            catch (Exception)
            {
                throw;
            }
        }

        public DataTable GET_ITM_PSI(string _model, string _brand, string _cat1, string _cat2, string _cat3)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[1] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[2] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[3] = new OracleParameter("P_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[4] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_itm_bytype", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable GET_BRANDMNG_PSI(string _MANG)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_MNG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MANG;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_brand_byMAN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan 2017  Jan 17
        public List<InventoryAllocateDetails> GET_ALLINR_STOCK_ALOC_DATA(InventoryAllocateDetails _obj)
        {
            List<InventoryAllocateDetails> _list = new List<InventoryAllocateDetails>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_isa_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_com;
            (param[1] = new OracleParameter("p_isa_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_chnl;
            (param[2] = new OracleParameter("p_isa_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_loc;
            (param[3] = new OracleParameter("p_isa_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_tp;
            (param[4] = new OracleParameter("p_isa_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_doc_tp;
            (param[5] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_cd;
            (param[6] = new OracleParameter("p_isa_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Isa_itm_stus;
            (param[7] = new OracleParameter("p_PO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.isa_doc_no;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (string.IsNullOrEmpty(_obj.Isa_itm_cd))
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_stockaloc_dataGRN", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryAllocateDetails>(_dtResults, InventoryAllocateDetails.ConverterNew);
                }
            }
            return _list;
        }


        public Int16 UPDATEALLOCATION_BALANCE_GRN(MasterItemAllocate _list)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[8];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_isa_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _list.Isa_ref_no;
            (param[1] = new OracleParameter("p_isa_aloc_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _list.Isa_aloc_bqty;
            (param[2] = new OracleParameter("p_isa_cnl_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _list.Isa_cnl_by;
            (param[3] = new OracleParameter("p_isa_cnl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _list.Isa_cnl_dt;
            (param[4] = new OracleParameter("p_isa_cnl_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _list.Isa_cnl_session_id;
            (param[5] = new OracleParameter("p_isa_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _list.Isa_itm_cd;
            (param[6] = new OracleParameter("p_isa_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _list.Isa_seq;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.SP_UPDATEALLOCATION", CommandType.StoredProcedure, param);

            return effects;
        }
        //Add by lakshan 17 Jan 2017
        public decimal GET_PREV_ITEM_COST_FOR_ITEM_MASTER(string _item, string _comp, string _stus)
        {
            decimal _costAmt = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_get_itm_lts_cost_with_stus", CommandType.StoredProcedure, false, param);
            decimal _dpsCost = 0, _dfsCost = 0, _tmp = 0; string _dfsDocNo = "", _dpsDocNo = "", _docNo = ""; DateTime _dpsDt = DateTime.MinValue, _dfsDt = DateTime.MinValue, _tmpDt = DateTime.MinValue;
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    _dpsCost = decimal.TryParse(_dt.Rows[0]["DPS_COST"].ToString(), out _tmp) ? Convert.ToDecimal(_dt.Rows[0]["DPS_COST"].ToString()) : 0;
                    _dfsCost = decimal.TryParse(_dt.Rows[0]["DFS_COST"].ToString(), out _tmp) ? Convert.ToDecimal(_dt.Rows[0]["DFS_COST"].ToString()) : 0;
                    _dpsDocNo = _dt.Rows[0]["DPS_DOC"].ToString();
                    _dfsDocNo = _dt.Rows[0]["DFS_DOC"].ToString();
                    _dpsDt = DateTime.TryParse(_dt.Rows[0]["DPS_DT"].ToString(), out _tmpDt) ? Convert.ToDateTime(_dt.Rows[0]["DPS_DT"].ToString()) : DateTime.MinValue;
                    _dfsDt = DateTime.TryParse(_dt.Rows[0]["DFS_DT"].ToString(), out _tmpDt) ? Convert.ToDateTime(_dt.Rows[0]["DFS_DT"].ToString()) : DateTime.MinValue;
                    _costAmt = _dpsCost == 0 ? _dfsCost : _dpsCost;
                }
            }
            return _costAmt;
        }
        //Add by lakshan 17 Jan 2017
        public mst_itm_com_reorder GET_ITEM_MIN_MAX_COST_FOR_ITEM_MASTER(string _item, string _comp, string _stus)
        {
            mst_itm_com_reorder _reOrder = new mst_itm_com_reorder();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_inb_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_get_itm_max_and_min_cost", CommandType.StoredProcedure, false, param);
            decimal _maxCost = 0, _minCost = 0, _tmp = 0;
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    _maxCost = decimal.TryParse(_dt.Rows[0]["maxval"].ToString(), out _tmp) ? Convert.ToDecimal(_dt.Rows[0]["maxval"].ToString()) : 0;
                    _minCost = decimal.TryParse(_dt.Rows[0]["minval"].ToString(), out _tmp) ? Convert.ToDecimal(_dt.Rows[0]["minval"].ToString()) : 0;
                    _reOrder = new mst_itm_com_reorder();
                    _reOrder.Icr_max_cost = _maxCost;
                    _reOrder.Icr_min_cost = _minCost;
                }
            }
            return _reOrder;

        }

        public Master_Employee GetMasterEmployee(String Com, String emp)
        {
            Master_Employee _ListItems = new Master_Employee();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("p_empCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_inv_Emp", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _ListItems = DataTableExtensions.ToGenericList<Master_Employee>(_dtResults, Master_Employee.Converter)[0];
            }
            return _ListItems;
        }
        public List<mst_itm_com_reorder> GetItemMasterMaxMinCostDataByItem(string _item)
        {
            List<mst_itm_com_reorder> _list = new List<mst_itm_com_reorder>();
            mst_itm_com_reorder _reOrder = new mst_itm_com_reorder();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_get_mst_itm_cost", CommandType.StoredProcedure, false, param);
            decimal _maxCost = 0, _minCost = 0;
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    foreach (DataRow dataRow in _dt.Rows)
                    {
                        _reOrder = new mst_itm_com_reorder();
                        _reOrder.Icr_com_code = dataRow["inb_com"].ToString();
                        _reOrder.Icr_itm_code = _item;
                        _reOrder.Icr_itm_sts = dataRow["inb_itm_stus"].ToString();
                        _reOrder.Icr_max_cost = decimal.TryParse(dataRow["maxCost"].ToString(), out _maxCost) ? Convert.ToDecimal(dataRow["maxCost"].ToString()) : 0;
                        _reOrder.Icr_min_cost = decimal.TryParse(dataRow["minCost"].ToString(), out _minCost) ? Convert.ToDecimal(dataRow["minCost"].ToString()) : 0;
                        _list.Add(_reOrder);
                    }
                }
            }
            return _list;
        }
        public List<mst_itm_com_reorder> GetItemMasterCurrentCostDataByItem(string _item)
        {
            List<mst_itm_com_reorder> _list = new List<mst_itm_com_reorder>();
            mst_itm_com_reorder _reOrder = new mst_itm_com_reorder();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "sp_get_mst_itm_cost_curr", CommandType.StoredProcedure, false, param);
            decimal _maxCost = 0, _minCost = 0;
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    foreach (DataRow dataRow in _dt.Rows)
                    {
                        _reOrder = new mst_itm_com_reorder();
                        _reOrder.Icr_com_code = dataRow["inb_com"].ToString();
                        _reOrder.Icr_itm_code = _item;
                        _reOrder.Icr_itm_sts = dataRow["inb_itm_stus"].ToString();
                        _reOrder.Icr_curr_cost = decimal.TryParse(dataRow["maxCost"].ToString(), out _maxCost) ? Convert.ToDecimal(dataRow["maxCost"].ToString()) : 0;
                        //_reOrder.Icr_min_cost = decimal.TryParse(dataRow["minCost"].ToString(), out _minCost) ? Convert.ToDecimal(dataRow["minCost"].ToString()) : 0;
                        _list.Add(_reOrder);
                    }
                }
            }
            return _list;
        }


        public Int16 SAVEPSI_REPORT_itm(string COM, string _user, DateTime _from, DateTime _todate, DateTime _openmaxdate, string _maxno,
     string _model, string _brand, string _cat1, string _cat2, string _cat3, int _intcom, string _itm)
        {

            OracleParameter[] param = new OracleParameter[14];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("P_MAXDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _openmaxdate;
            (param[5] = new OracleParameter("P_MAXNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maxno;
            (param[6] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[9] = new OracleParameter("P_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[10] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[11] = new OracleParameter("P_INTCOM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intcom;
            (param[12] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PSIREP_OPEN_DT_ITM", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int16 SAVEPSI_REPORT_itm2(string COM, string _user, DateTime _from, DateTime _todate, DateTime _openmaxdate, string _maxno,
   string _model, string _brand, string _cat1, string _cat2, string _cat3, int _intcom, string _itm, string Opcode)
        {

            OracleParameter[] param = new OracleParameter[15];
            Int16 effects = 0;
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("P_MAXDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _openmaxdate;
            (param[5] = new OracleParameter("P_MAXNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maxno;
            (param[6] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[9] = new OracleParameter("P_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[10] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[11] = new OracleParameter("P_INTCOM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _intcom;
            (param[12] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[13] = new OracleParameter("P_OPCODES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Opcode;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_PSIREP_OPEN_DT_ITM2", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int16 UPDATETEMP_DATA(string _doc, string _invoice)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_tuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_INVOICE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.SP_UPDATETEMP", CommandType.StoredProcedure, param);

            return effects;
        }
        //Lakshan 31 Oct 2016
        public decimal GET_INR_LOC_BALANCE_BY_COM(InventoryLocation _obj)
        {
            decimal _freetotal = 0;
            InventoryLocation _list = new InventoryLocation();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_com;
            (param[1] = new OracleParameter("p_inl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_loc;
            (param[2] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_cd;
            (param[3] = new OracleParameter("p_inl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inl_itm_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_loc", "sp_get_inr_bal_by_com", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                decimal _tmp = 0;
                _freetotal = decimal.TryParse(_dtResults.Rows[0]["Balance"].ToString(), out _tmp) ? Convert.ToDecimal(_dtResults.Rows[0]["Balance"].ToString()) : 0;
            }
            return _freetotal;
        }
        //Lakshan 06 Feb 2017
        public DataTable SearchSerialsByProductionNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _available = string.IsNullOrEmpty(searchParams[1].ToString()) ? null : searchParams[1].ToString();
            string _serial1 = null;
            string _item = null;
            string _docNo = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SERIAL #":
                        _serial1 = _searchText;
                        break;

                    case "ITEM CODE":
                        _item = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _serial1 = (_serial1 != null) ? (_serial1 + "%") : null;
            _item = (_item != null) ? (_item + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_ins_available", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(searchParams[2].ToString());
            (param[3] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial1;
            (param[4] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("p_batch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_ser_inr_ser_by_prod_no", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Rukshan
        public DataTable GetChanelOnPC(string _company, string _pc, string _code)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable tblDet = QueryDataTable("tblchnl", "sp_get_pc_chnl", CommandType.StoredProcedure, false, param);
            return tblDet;
        }

        public List<InventoryRequest> GET_INT_REQ(InventoryRequest _OBJ)
        {
            List<InventoryRequest> _list = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_com;
            (param[1] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_sub_tp;
            (param[2] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_sub_tp;
            (param[3] = new OracleParameter("p_itr_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OBJ.Itr_dt;
            (param[4] = new OracleParameter("p_itr_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OBJ.Itr_exp_dt;
            (param[5] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_loc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "SP_GETREQ_HDDR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterNew);
            }
            return _list;
        }
        public List<InventoryRequest> GET_INT_REQPRISSUE(InventoryRequest _OBJ)
        {
            List<InventoryRequest> _list = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_com;
            (param[1] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_sub_tp;
            (param[2] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_sub_tp;
            (param[3] = new OracleParameter("p_itr_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OBJ.Itr_dt;
            (param[4] = new OracleParameter("p_itr_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OBJ.Itr_exp_dt;
            (param[5] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OBJ.Itr_loc;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "SP_GETREQPROISS_HDDR", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterNew);
            }
            return _list;
        }
        public Int16 UPDATE_PROJECT(string _doc, string _status)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.SP_UPDATEPROJ_STATUS", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int16 UPDATE_PROJECT_BYISSUE(string _doc, string _ITM, decimal _qty, string _MRN)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ITM;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[3] = new OracleParameter("p_MRN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MRN;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.SP_UPDATEPROJ_BYISSU", CommandType.StoredProcedure, param);

            return effects;
        }
        public DataTable CHECK_BATCH_SERIAL(Int32 seq, Int32 itmline, Int32 batchline)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("P_ITMLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmline;
            (param[2] = new OracleParameter("P_BATCHLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = batchline;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _resultDT = QueryDataTable("count", "CHECKBATCHLINE", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }

        //Akila 2017/02/13
        public DataTable GetAuditMembers(string _comCode, string _jobNo)
        {
            DataTable _auditMembers = new DataTable();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_UserId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[2] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            param[3] = new OracleParameter("o_auditMemebers", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _auditMembers = QueryDataTable("tblAuditMemebers", "SP_GETAUDITMEMBERS", CommandType.StoredProcedure, false, param);
            return _auditMembers;
        }

        //Akila 2017/02/14
        public DataTable SearchAuditMembers(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _userId = null;
            string _userName = null;

            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ID":
                        _userId = _searchText;
                        break;

                    case "NAME":
                        _userName = _searchText;
                        break;

                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _userId = (_userId != null) ? (_userId.ToUpper() + "%") : null;
            _userName = (_userName != null) ? (_userName.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userName;
            param[3] = new OracleParameter("o_auditMemebers", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _auditMembers = new DataTable();
            _auditMembers = QueryDataTable("tblAuditMemebers", "SP_GETAUDITMEMBERS", CommandType.StoredProcedure, false, param);
            return _auditMembers;
        }

        //Akila 2017/02/14
        public int InterTransferCancel(InventoryRequest _inventoryRequest)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            rows_effected = UpdateRecords("sp_update_intreqstatusbulk", CommandType.StoredProcedure, param);
            return rows_effected;
        }

        //Akila 2017/02/15
        public DataTable SearchAuditJobs(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime? _from, DateTime? _to)
        {
            //Split for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Split for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _jobNo = null;
            string _status = null;

            //Set relevant parameters according to the,search category.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "JOB #":
                        _jobNo = _searchText;
                        break;
                    case "STATUS":
                        _status = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            _jobNo = (_jobNo != null) ? (_jobNo.ToUpper() + "%") : null;
            _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblAuditJobs", "pkg_search_inv.SP_SEARCHAUDITJOBS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //By Akila 201/02/15
        public DataTable GetAuditJobDetails(string _companyCode, string _locationCode, string _jobNo)
        {
            DataTable _jobDetails = new DataTable();

            OracleParameter[] _oraParameters = new OracleParameter[4];
            (_oraParameters[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _companyCode;
            (_oraParameters[1] = new OracleParameter("p_locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _locationCode;
            (_oraParameters[2] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            _oraParameters[3] = new OracleParameter("o_jobDetails", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _jobDetails = QueryDataTable("tbl_AuditJobDetails", "SP_GET_AUDITJOBDETAILS", CommandType.StoredProcedure, false, _oraParameters);
            return _jobDetails;
        }
        //Add by Lakshan 15 Feb 2017
        public int CancelIntertransferDocument(InventoryRequest _inventoryRequest)
        {
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_mod_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[6] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_cancel_intr_transfer", CommandType.StoredProcedure, param);
            return rows_effected;
        }
        public InventoryHeader GET_INT_HDR_DATA_BY_OTH_DOC_NO(string _docTp, string _othDocNo)
        {
            InventoryHeader _list = new InventoryHeader();
            //Lakshan 5 Feb 2017
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ith_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docTp;
            (param[1] = new OracleParameter("p_ith_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDocNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_int_hdr_by_oth_doc_no", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryHeader>(_dtResults, InventoryHeader.ConvertTotal)[0];
            }
            return _list;
        }

        //Akila 2017/02/17
        public int SaveAuditMemebers(AuditMemebers _auditMemebers)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ajm_seq_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[1] = new OracleParameter("p_ajm_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auditMemebers.Ajm_Job_no;
            (param[2] = new OracleParameter("p_ajm_mem_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auditMemebers.Ajm_Mem_Id;
            (param[3] = new OracleParameter("p_ajm_mem_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auditMemebers.Ajm_Mem_Nic;
            (param[4] = new OracleParameter("p_ajm_mem_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auditMemebers.Ajm_Mem_Name;
            (param[5] = new OracleParameter("p_ajm_mem_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auditMemebers.Ajm_Mem_type;
            (param[6] = new OracleParameter("p_ajm_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _auditMemebers.Ajm_Cre_by;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = (int)this.UpdateRecords("SP_SAVE_AUDPROJMEMBERS", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //Lakshan 21 Feb 21
        public List<InventoryRequest> GET_SOA_REQ_DATA_FOR_INVOICE(string _invNo)
        {
            List<InventoryRequest> _list = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sah_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_soa_data_for_inv", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterNew);
            }
            return _list;
        }

        //By Akila 2017/02/23
        public List<AuditJobSerial> GetSerialDocDetailsByLocation(string _company, string _location)
        {
            List<AuditJobSerial> _serailList = new List<AuditJobSerial>();

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_LocCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[2] = new OracleParameter("o_SerialDetails", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_SerailDetails", "SP_GET_SERIALDET_BYLOC", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow _dataRow in _dtResults.Rows)
                {
                    AuditJobSerial _serails = new AuditJobSerial();
                    _serails.Audjs_InDocNo = _dataRow["Do_No"] == DBNull.Value ? string.Empty : _dataRow["Do_No"].ToString();
                    _serails.Audjs_DocInDate = _dataRow["Doc_In_Date"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(_dataRow["Doc_In_Date"].ToString());
                    _serails.Audjs_ItemCode = _dataRow["Item_Code"] == DBNull.Value ? string.Empty : _dataRow["Item_Code"].ToString();
                    _serails.Audjs_ItemStatus = _dataRow["Item_Status"] == DBNull.Value ? string.Empty : _dataRow["Item_Status"].ToString();
                    _serails.Audjs_WarrantyNo = _dataRow["Warranty_No"] == DBNull.Value ? string.Empty : _dataRow["Warranty_No"].ToString();
                    _serails.Audjs_SerialNo = _dataRow["Serial_No"] == DBNull.Value ? string.Empty : _dataRow["Serial_No"].ToString();
                    _serails.Audjs_SerialId = _dataRow["Serial_Id"] == DBNull.Value ? 0 : Convert.ToInt32(_dataRow["Serial_Id"].ToString());
                    _serails.Audjs_OriginelInDate = _dataRow["Doc_Original_InDt"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(_dataRow["Doc_Original_InDt"].ToString());
                    _serailList.Add(_serails);
                }
            }


            //dECIMAL iTEMS ADD BY THARANGA 2018/01/28
            OracleParameter[] param1 = new OracleParameter[3];
            (param1[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param1[1] = new OracleParameter("p_LocCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param1[2] = new OracleParameter("o_SerialDetails", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResultsdecimal = QueryDataTable("tbl_SerailDetails", "SP_GET_DECIMALDET_BYLOC", CommandType.StoredProcedure, false, param1);

            if (_dtResultsdecimal.Rows.Count > 0)
            {
                foreach (DataRow _dataRow in _dtResultsdecimal.Rows)
                {
                    decimal qty = 0;
                    decimal.TryParse(_dataRow["Qty"].ToString(), out qty);
                    int _qty = int.Parse(Math.Round(qty).ToString());
                    for (int i = 0; i < _qty; i++)
                    {

                        AuditJobSerial _serails = new AuditJobSerial();
                        _serails.Audjs_InDocNo = _dataRow["Do_No"] == DBNull.Value ? string.Empty : _dataRow["Do_No"].ToString();
                        _serails.Audjs_DocInDate = _dataRow["Doc_In_Date"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(_dataRow["Doc_In_Date"].ToString());
                        _serails.Audjs_ItemCode = _dataRow["Item_Code"] == DBNull.Value ? string.Empty : _dataRow["Item_Code"].ToString();
                        _serails.Audjs_ItemStatus = _dataRow["Item_Status"] == DBNull.Value ? string.Empty : _dataRow["Item_Status"].ToString();
                        _serails.Audjs_WarrantyNo = _dataRow["Warranty_No"] == DBNull.Value ? string.Empty : _dataRow["Warranty_No"].ToString();
                        _serails.Audjs_SerialNo = _dataRow["Serial_No"] == DBNull.Value ? string.Empty : _dataRow["Serial_No"].ToString();
                        _serails.Audjs_SerialId = GetSerialIDfor_audit();
                        _serails.Audjs_OriginelInDate = _dataRow["Doc_Original_InDt"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(_dataRow["Doc_Original_InDt"].ToString());
                        _serailList.Add(_serails);
                    }
                }
            }

            return _serailList;

        }

        //By Akila 2017/02/24
        public Int16 SaveAuditJobItems(AuditJobItem _item)
        {
            OracleParameter[] param = new OracleParameter[10];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_audji_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.Audji_seq;
            (param[1] = new OracleParameter("p_audji_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Audji_job;
            (param[2] = new OracleParameter("p_audji_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Audji_itm;
            (param[3] = new OracleParameter("p_audji_itmst", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Audji_stus;
            (param[4] = new OracleParameter("p_audji_db_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Audji_db_qty;
            (param[5] = new OracleParameter("p_audji_ledger_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Audji_ledger_qty;
            (param[6] = new OracleParameter("p_audji_physic_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.Audji_physical_qty;
            (param[7] = new OracleParameter("p_audji_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Audji_cre_by;

            //Akila 2017/04/028
            (param[8] = new OracleParameter("p_audji_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Audji_session_id;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_AUDJOBITEM", CommandType.StoredProcedure, param);
            return effects;
        }

        //By Akila 2017/02/24
        public Int16 SaveAuditJobSerails(AuditJobSerial _serial)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_audjs_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Audjs_Seq;
            (param[1] = new OracleParameter("p_audjs_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_JobNo;
            (param[2] = new OracleParameter("p_audjs_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_ItemCode;
            (param[3] = new OracleParameter("p_audjs_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_SerialNo;
            (param[4] = new OracleParameter("p_audjs_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_ItemStatus;
            (param[5] = new OracleParameter("p_audjs_in_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_InDocNo;
            (param[6] = new OracleParameter("p_audjs_in_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Audjs_DocInDate;
            (param[7] = new OracleParameter("p_audjs_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_WarrantyNo;
            (param[8] = new OracleParameter("p_audjs_ref_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_RefStatus;
            (param[9] = new OracleParameter("p_audjs_rpt_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_RptType;
            (param[10] = new OracleParameter("p_audjs_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_Type;
            (param[11] = new OracleParameter("p_audjs_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Audjs_SerialId;
            (param[12] = new OracleParameter("p_audjs_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_Remark;
            (param[13] = new OracleParameter("p_audjs_org_in_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Audjs_OriginelInDate;
            (param[14] = new OracleParameter("p_audjs_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_CreatedBy;
            (param[15] = new OracleParameter("p_audjs_sub_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[16] = new OracleParameter("p_audjs_phy_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_PhysicallyAvailableSerial;

            //Akila 2017/04/28
            (param[17] = new OracleParameter("p_audjs_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_ModBy;
            (param[18] = new OracleParameter("p_audjs_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_SessionId;

            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_AUDJOBSERIAL", CommandType.StoredProcedure, param);
            return effects;
        }

        //SUBODANA
        public DataTable GET_CUSDEC_ITEM(string DOC, string ITEM)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DOC;
            (param[1] = new OracleParameter("P_ITEMCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ITEM;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _resultDT = QueryDataTable("TBL", "SP_GET_CUSDECITEM", CommandType.StoredProcedure, false, param);
            return _resultDT;
        }
        //Lakshan 04 Nov 2016
        public Int32 SaveInrResLogDataCancel(INR_RES_LOG _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("p_irl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_SEQ;
            (param[1] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_RES_NO;
            (param[2] = new OracleParameter("p_irl_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_LINE;
            (param[3] = new OracleParameter("p_irl_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_LINE;
            (param[4] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_CD;
            (param[5] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_STUS;
            (param[6] = new OracleParameter("p_irl_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_QTY;
            (param[7] = new OracleParameter("p_irl_res_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_BQTY;
            (param[8] = new OracleParameter("p_irl_res_iqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_IQTY;
            (param[9] = new OracleParameter("p_irl_orig_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_TP;
            (param[10] = new OracleParameter("p_irl_orig_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_NO;
            (param[11] = new OracleParameter("p_irl_orig_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_DT;
            (param[12] = new OracleParameter("p_irl_orig_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_ITM_LINE;
            (param[13] = new OracleParameter("p_irl_orig_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_BATCH_LINE;
            (param[14] = new OracleParameter("p_irl_orig_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_COM;
            (param[15] = new OracleParameter("p_irl_orig_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_LOC;
            (param[16] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_TP;
            (param[17] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_NO;
            (param[18] = new OracleParameter("p_irl_curt_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_DT;
            (param[19] = new OracleParameter("p_irl_curt_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_ITM_LINE;
            (param[20] = new OracleParameter("p_irl_curt_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_BATCH_LINE;
            (param[21] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_COM;
            (param[22] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_LOC;
            (param[23] = new OracleParameter("p_irl_base_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_BASE_LINE;
            (param[24] = new OracleParameter("p_irl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ACT;
            (param[25] = new OracleParameter("p_irl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_BY;
            (param[26] = new OracleParameter("p_irl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_DT;
            (param[27] = new OracleParameter("p_irl_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_SESSION;
            (param[28] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_BY_NEW;
            (param[29] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_DT;
            (param[30] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_SESSION;
            (param[31] = new OracleParameter("p_irl_res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_WP;
            param[32] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_save_inr_res_log_cancl", CommandType.StoredProcedure, param);
            return _eff;
        }
        public Int32 SAVE_PSI_AFT_GIT(string user, string item, Int32 opbal, Int32 grn, Int32 deliver, Int32 clbal, Int32 adj, Int32 srn, Int32 prn, Int32 otherplus, Int32 adjmin, Int32 othermin, string desc, string model)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[15];
                (param[0] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
                (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
                (param[2] = new OracleParameter("P_OPBAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = opbal;
                (param[3] = new OracleParameter("P_GRN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = grn;
                (param[4] = new OracleParameter("P_DELIV", OracleDbType.Int32, null, ParameterDirection.Input)).Value = deliver;
                (param[5] = new OracleParameter("P_CLBAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = clbal;
                (param[6] = new OracleParameter("P_ADJ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adj;
                (param[7] = new OracleParameter("P_SRN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = srn;
                (param[8] = new OracleParameter("P_PRN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = prn;
                (param[9] = new OracleParameter("P_OTHPLUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = otherplus;
                (param[10] = new OracleParameter("P_ADJMIN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = adjmin;
                (param[11] = new OracleParameter("P_OTHMIN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = othermin;
                (param[12] = new OracleParameter("P_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
                (param[13] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
                param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_SAVE_PSIDATA", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //subodana 2017-03-18
        public List<Model_Specific> Get_Model_Specific_Data(string model)
        {
            List<Model_Specific> _modelDetails = new List<Model_Specific>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_get_model_spcfic", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                _modelDetails = DataTableExtensions.ToGenericList<Model_Specific>(dt, Model_Specific.Converter);
            }
            return _modelDetails;
        }

        //By Akila 2017/02/27
        public Int16 UpdatePhysicallyAvailableSerials(string _serialNo, string _jobNo, string _userId, string _sessionId)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_audjs_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[1] = new OracleParameter("p_audjs_phy_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo;

            //Akila 2017/04/28
            (param[1] = new OracleParameter("p_audjs_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[1] = new OracleParameter("p_audjs_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessionId;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int16, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_AUDJS_PHYSICALSER", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<AuditJobSerial> GetSerialDocDetailsBySerial(string _company, string _location, string _serialNo)
        {
            List<AuditJobSerial> _serialList = new List<AuditJobSerial>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_LocCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_SerialNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo;
            param[3] = new OracleParameter("o_SerialDetails", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_SerailDocDetails", "SP_GET_SERIALDET_BYSER", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                foreach (DataRow _dataRow in _dtResults.Rows)
                {
                    AuditJobSerial _serials = new AuditJobSerial();
                    _serials.Audjs_InDocNo = _dataRow["Do_No"] == DBNull.Value ? string.Empty : _dataRow["Do_No"].ToString();
                    _serials.Audjs_DocInDate = _dataRow["Doc_In_Date"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(_dataRow["Doc_In_Date"].ToString());
                    _serials.Audjs_ItemCode = _dataRow["Item_Code"] == DBNull.Value ? string.Empty : _dataRow["Item_Code"].ToString();
                    _serials.Audjs_ItemStatus = _dataRow["Item_Status"] == DBNull.Value ? string.Empty : _dataRow["Item_Status"].ToString();
                    _serials.Audjs_WarrantyNo = _dataRow["Warranty_No"] == DBNull.Value ? string.Empty : _dataRow["Warranty_No"].ToString();
                    _serials.Audjs_SerialNo = _dataRow["Serial_No"] == DBNull.Value ? string.Empty : _dataRow["Serial_No"].ToString();
                    _serials.Audjs_SerialId = _dataRow["Serial_Id"] == DBNull.Value ? 0 : Convert.ToInt32(_dataRow["Serial_Id"].ToString());
                    _serials.Audjs_OriginelInDate = _dataRow["Doc_Original_InDt"] == DBNull.Value ? DateTime.MinValue : Convert.ToDateTime(_dataRow["Doc_Original_InDt"].ToString());
                    _serialList.Add(_serials);
                }
            }
            return _serialList;

        }

        //By Akila 2017/03/6
        public List<AuditJobItem> GetProcessedJobItems(string _subJobNo, Int32 _startIndex, Int32 _endIndex)
        {
            List<AuditJobItem> _processedJobItems = new List<AuditJobItem>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_SubJobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJobNo;
            (param[1] = new OracleParameter("p_startIndex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _startIndex;
            (param[2] = new OracleParameter("p_endIndex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _endIndex;
            param[3] = new OracleParameter("o_ProcessedJobItems", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_ProcessedAuditItems", "SP_GET_PROCESSED_AUDJOBITM", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _processedJobItems = DataTableExtensions.ToGenericList<AuditJobItem>(_dtResults, AuditJobItem.Converter);
            }
            return _processedJobItems;
        }

        //By Akila 2017/03/6
        public List<AuditJobSerial> GetProcessedJobSerials(string _subJobNo, Int32 _startIndex, Int32 _endIndex, Int32 _status)
        {
            List<AuditJobSerial> _processedJobSerials = new List<AuditJobSerial>();

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_SubJobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJobNo;
            (param[1] = new OracleParameter("p_startIndex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _startIndex;
            (param[2] = new OracleParameter("p_endIndex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _endIndex;
            (param[3] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("o_ProcessedJobSerial", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_ProcessedAuditItems", "SP_GET_PROCESSED_AUDJOBSERIALS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _processedJobSerials = DataTableExtensions.ToGenericList<AuditJobSerial>(_dtResults, AuditJobSerial.Converter);
            }
            return _processedJobSerials;
        }

        public Int32 UpdateAuditHeader(string _company, string _location, string _jobNo, string _userId, Int32 _jobStatus, string _sessionId)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobStatus;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            (param[5] = new OracleParameter("p_sessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessionId;
            param[6] = new OracleParameter("o_effects", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = UpdateRecords("SP_UPDATE_AUDITHDRDETAILS", CommandType.StoredProcedure, param);
            return effects;
        }

        //Akila 2017/03/21
        public DataTable GetAuditItemSummery(string _subJobNo)
        {
            DataTable _summery = new DataTable();
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_SubJobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJobNo;
            param[1] = new OracleParameter("o_Summery", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _summery = QueryDataTable("tbl_AuditSummery", "SP_GET_AUDITITEMTOTAL", CommandType.StoredProcedure, false, param);

            return _summery;
        }

        public ReptPickHeader getTemporyHeaderDoument(string docno, string doctype, string company)
        {
            try
            {
                ReptPickHeader _list = new ReptPickHeader();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
                (param[1] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("int_req", "pkg_pda.sp_get_temppickhdrdata", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<ReptPickHeader>(_dtResults, ReptPickHeader.Converter3)[0];
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<ReptPickSerials> getScannedSerial(int seqNo)
        {
            try
            {
                List<ReptPickSerials> _list = new List<ReptPickSerials>();
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_seqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNo;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("int_req", "pkg_pda.sp_get_temppickserdata", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<ReptPickSerials>(_dtResults, ReptPickSerials.ConvertTempSer);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<ReptPickItems> getScanedItems(int seqNo)
        {
            try
            {
                List<ReptPickItems> _list = new List<ReptPickItems>();
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_seqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNo;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("int_req", "pkg_pda.sp_get_temppickitmdata", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<ReptPickItems>(_dtResults, ReptPickItems.Converter);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public InventoryHeader getIntHdrData(string docno, string location, string company)
        {
            try
            {
                InventoryHeader _list = new InventoryHeader();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("int_req", "pkg_pda.sp_get_inthdrdata", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryHeader>(_dtResults, InventoryHeader.ConvertTotal)[0];
                }
                return _list;

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Akila 2017/03/25
        public List<AuditJobSerial> GetAuditSerialDetails(string _subJobNo, int _searchOption, string _serialNo)
        {
            List<AuditJobSerial> _searchResult = new List<AuditJobSerial>();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_subJob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJobNo;
            (param[1] = new OracleParameter("p_serialNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo;
            (param[2] = new OracleParameter("p_searchOption", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _searchOption;
            param[3] = new OracleParameter("o_searchResult", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblSearchSerials", "SP_GET_AUDITSERDETAILS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _searchResult = DataTableExtensions.ToGenericList<AuditJobSerial>(_dtResults, AuditJobSerial.Converter);
            }
            return _searchResult;
        }

        //Akila 2017/03/27
        public List<AuditJobSerial> GetRemarkedSerials(string _subJobNo)
        {
            List<AuditJobSerial> _remarkedSerials = new List<AuditJobSerial>();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_subJobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJobNo;
            param[1] = new OracleParameter("o_serials", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRemarkedSerials", "SP_GET_REMARKEDSERIALS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _remarkedSerials = DataTableExtensions.ToGenericList<AuditJobSerial>(_dtResults, AuditJobSerial.Converter);
            }
            return _remarkedSerials;
        }
        //Lakshan 23 Mar 2017
        public List<RefPrdMt> GET_REF_PRD_MT_DATA(RefPrdMt _obj)
        {
            List<RefPrdMt> _list = new List<RefPrdMt>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_prd_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Prd_com_cd;
            (param[1] = new OracleParameter("p_prd_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Prd_from;
            (param[2] = new OracleParameter("p_prd_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Prd_to;
            (param[3] = new OracleParameter("p_prd_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Prd_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("ref_prd_mt", "sp_get_ref_prd_mt_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<RefPrdMt>(_dtResults, RefPrdMt.Converter);
            }
            return _list;
        }
        //Add by lakshan 29 Mar 2017
        public DataTable GET_DISTRIBUTION_DOC_DATA_FOR_PRINT(string _reqNo)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("int_req", "sp_rpt_get_req_data_by_doc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public DataTable GET_AGE_DETAILS(string com, string item, DateTime fdate, DateTime tdate, Int32 mindate, Int32 maxdate, string type)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[3] = new OracleParameter("P_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            (param[4] = new OracleParameter("P_MIN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = mindate;
            (param[5] = new OracleParameter("P_MAX", OracleDbType.Int32, null, ParameterDirection.Input)).Value = maxdate;
            param[6] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (type == "AVG")
            {
                _dtResults = QueryDataTable("tbl", "SP_GETAGINGBYITEMAVG", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tbl", "SP_GETAGINGBYITEM", CommandType.StoredProcedure, false, param);
            }


            return _dtResults;
        }
        public DataTable GetTechAllocationDetails(string com, string allocation, string modelNo, string itemNo, string jobNo, string chassisNo, string engineNo, string dateFrom, string dateTo, string aodNo, string locCode, string profitCenter)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("allocation", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = allocation;
            (param[2] = new OracleParameter("modelNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modelNo;
            (param[3] = new OracleParameter("itemNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemNo;
            (param[4] = new OracleParameter("jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo;
            (param[5] = new OracleParameter("chassisNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chassisNo;
            (param[6] = new OracleParameter("engineNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = engineNo;
            (param[7] = new OracleParameter("dateFrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dateFrom;
            (param[8] = new OracleParameter("dateTo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dateTo;
            (param[9] = new OracleParameter("aodNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = aodNo;
            (param[10] = new OracleParameter("locCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locCode;
            (param[11] = new OracleParameter("profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profitCenter;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblTechAllocation", "sp_GetTechJobAllocation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Udaya 31/03/2017
        public Int32 saveUpdate_TechnicianAllocation(TechAllocation _TechAllocation)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("JobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.JobNo;
            (param[1] = new OracleParameter("FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TechAllocation.FromDate;
            (param[2] = new OracleParameter("ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TechAllocation.ToDate;
            (param[3] = new OracleParameter("Status", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _TechAllocation.Status;
            (param[4] = new OracleParameter("CompanyCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.Company;
            (param[5] = new OracleParameter("LocCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.Location;
            (param[6] = new OracleParameter("LineNo", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _TechAllocation.LineNo;

            (param[7] = new OracleParameter("sessionCreateBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.sessionCreateBy;
            (param[8] = new OracleParameter("sessionCreateDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TechAllocation.sessionCreateDate;
            (param[9] = new OracleParameter("sessionModBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.sessionModBy;
            (param[10] = new OracleParameter("sessionModDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TechAllocation.sessionModDate;
            (param[11] = new OracleParameter("sessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.SessionId;
            (param[12] = new OracleParameter("TechCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.TechCode;
            (param[13] = new OracleParameter("STH_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.STH_TP;
            (param[14] = new OracleParameter("AlcoNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.AlcoNo;
            (param[15] = new OracleParameter("TownNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _TechAllocation.TownNo;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("SaveUpdateTechAllocation", CommandType.StoredProcedure, param);

            return _eff;
        }

        //Udaya 03/04/2017
        public DataTable TechAlloSeqNo(string modid, string locid, string catid)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("modId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modid;
            (param[1] = new OracleParameter("locId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locid;
            (param[2] = new OracleParameter("catId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = catid;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblAllTech", "sp_GetTechAlocNo", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int16 UpdateTechAlocAutoNumber(MasterAutoNumber _masterAutoNumber)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_moduleid;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_start_char;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_tp;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_cd;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_modify_dt;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_year;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_updateTechAlocautonumber", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }

        //Akila 2017/04/06
        public DataTable GetDamageAuditItemDetails(string _company, string _Location, string _serial, string _item)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_LocCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Location;
            (param[2] = new OracleParameter("p_ItemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_SerialNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;

            param[4] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("AudDmgItm_Details", "SP_GET_AUDDMGITM_DETAILS", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetExcessItems(string _serialNo, string _company, string _location, string _item)
        {
            DataTable _excessItems = new DataTable();
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[3] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serialNo;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _excessItems = QueryDataTable("Excess_Items", "sp_get_serial_detail", CommandType.StoredProcedure, false, param);
            return _excessItems;
        }
        //Lakshan 07 Apr 2017 modify
        public List<InventoryRequest> GetAllMaterialRequestsListAodScmWeb(InventoryRequest _inventoryRequest)
        {
            List<InventoryRequest> _inventoryRequestList = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[8];
            //(param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            //edit by Chamal (add Itr_issue_com) 18-08-2012
            //edit by Chamal (add PDA) 28-08-2014
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[2] = new OracleParameter("p_fromDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.FromDate;
            (param[3] = new OracleParameter("p_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.ToDate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[5] = new OracleParameter("p_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[6] = new OracleParameter("p_reqby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_inventoryRequest.Itr_tp == "PDA")
            {
                _dtResults = QueryDataTable("tblReq", "sp_pdascanbatchs", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0) _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterPDA);
            }
            else
            {
                _dtResults = QueryDataTable("tblReq", "sp_getallmaterialrequestsweb", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0) _inventoryRequestList = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter5);
            }
            return _inventoryRequestList;
        }
        //Add by Rukshan 09/sep/2015 modify by Lakshan
        public List<TempPopup> GetSupplierSerialForConsignmentReturn(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            List<TempPopup> _list = new List<TempPopup>();
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _ICode = null;
            string _SerialI = null;
            string _Po = null;
            string _GRN = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _ICode = _searchText;
                        break;

                    case "SERIAL":
                        _SerialI = _searchText;
                        break;
                    case "PO #":
                        _Po = _searchText;
                        break;
                    case "GRN #":
                        _GRN = _searchText;
                        break;
                    default:
                        break;
                }
            }
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ICode;
            (param[1] = new OracleParameter("p_Seial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SerialI;
            (param[2] = new OracleParameter("p_Po", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Po;
            (param[3] = new OracleParameter("p_GRN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _GRN;
            (param[4] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[6] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[7] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3];
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (searchParams[4] == "Serial")
            {
                _dtResults = QueryDataTable("tblPurchaseOrder", "SP_GET_SERIALSFORCON", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.sp_get_Supplier_serial", CommandType.StoredProcedure, false, param);
            }
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<TempPopup>(_dtResults, TempPopup.Converter1);
                _list = _list.Where(c => c.ItemStus == "CONS").ToList();
            }
            return _list;
        }
        //Add by lakshan 18 Apr 2017
        public Int32 UpdateRequestHeaderAodOut(string _request, string _user)
        {
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_update_request_header_aod", CommandType.StoredProcedure, param);
            return _effect;
        }
        // Add by by Lakshan  copy Search_serials_for_itemCD2 20 Apr 2017
        public List<ReptPickSerials> Search_serial_for_consignment(string company, string location, string itemCode, string status, string supplier, string _serial)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[4] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
            (param[5] = new OracleParameter("p_ins_Ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_search_serial_for_itemCD2", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }

        //Akila 2017/04/20
        public DataTable GetRccDetails(string _company, string _location, string _serial, string _item)
        {
            DataTable _result = new DataTable();
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_Serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[4] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("RccDetails", "SP_GET_RCCDETAILS", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Akila 2017/04/24
        public DataTable GetInvNotDeliveredDetails(string _company, string _location, string _serial, string _item)
        {
            DataTable _result = new DataTable();
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_Location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_Serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[3] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[4] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("InvNotDelivered", "SP_GET_INVNOTDELIVERED", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getItemDetBycode(string itemcd, int seqno,string userid=null,string doctp=null)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqno;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcd;
            (param[2] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            (param[3] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_pda.SP_GET_TEMPITEM", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable getAutoPrintAodDocumentDtls(string aodNo, string doctp)
        {
            DataTable _dtResults = new DataTable("tbl");
            List<DocumentOutItmModel> _list = new List<DocumentOutItmModel>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = aodNo;
            (param[1] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_get_documentitmdtl", CommandType.StoredProcedure, false, param);

            //if (_dtResults.Rows.Count > 0)
            //{
            //    _list = DataTableExtensions.ToGenericList<DocumentOutItmModel>(_dtResults, DocumentOutItmModel.Converter);
            //}
            return _dtResults;
        }
        public DataTable getItemExpStatus(string itemcd)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_pda.SP_GET_ITEMEXPDET", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana 2017-04-25
        public DataTable GetFreqtyForLocation(string _company, string _location, string status, string _item, string document, string serialid)
        {
            DataTable _result = new DataTable();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[4] = new OracleParameter("P_SERID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(serialid);
            (param[5] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;

            param[6] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("dt", "SP_GET_LOC_BAL_FOR_ITEM", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana 2017-04-25
        public DataTable GetFreeoriginalqtyForLocation(string _company, string _location, string status, string _item)
        {
            DataTable _result = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("dt", "SP_GET_LOC_FREE_FOR_ITEM", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Int32 addDocumentPrint(string printdoc, string userId, string doctype, string sessionId, string loadingpoint)
        {
            ConnectionOpen();
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = printdoc;
            (param[1] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[2] = new OracleParameter("p_lp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loadingpoint;
            (param[3] = new OracleParameter("p_sesid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
            (param[4] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
            (param[5] = new OracleParameter("p_credt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int32)UpdateRecords("pkg_pda.SP_UPDATE_DOCPRINTSTATUS", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _effect;
        }


        public DataTable GetPendingPrintDocuments(string lp)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_lp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_get_pendingprintdocs", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetPendingPrintDocumentsNew(string lp, string loc, string doctp = null)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_lp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = lp;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_get_pendingprintdocs_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 updatePrintedDocument(string docno)
        {
            ConnectionOpen();
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int32)UpdateRecords("sp_update_pendingprintdocs", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _effect;
        }

        //ISURU 2017/04/26
        public List<PurchseOrderPrint> GetPurReqByDocnO(String Com, String Type, String OthDoc, string loc)
        {
            List<PurchseOrderPrint> oResult = new List<PurchseOrderPrint>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            (param[2] = new OracleParameter("P_OTH_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OthDoc;
            (param[3] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("MST_COM_LOGI_COST", "SP_PUR_REQ_BY_DOC_NO", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<PurchseOrderPrint>(_tblScan, PurchseOrderPrint.Converter);
            }
            return oResult;
        }

        // Isuru 2017/04/26
        public ITM_PLU Get_iteminformationwithPlu(string itmcd)
        {
            ITM_PLU item = new ITM_PLU();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl_item", "GET_PLUITEM_INFORMATIONS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                item = DataTableExtensions.ToGenericList<ITM_PLU>(_dtResults, ITM_PLU.Converter)[0];
            }
            return item;
        }
        //Rukshan 2016-Jun-30 copy by lakshan 26 Apr 2017
        public Int32 Update_Cusdec_bal_New(string _doc, decimal _qty, string _ITM, int jobline)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ITM;
            (param[3] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = jobline;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("update_cusdec_bal_when_do", CommandType.StoredProcedure, param);
            return effects;
        }
        //Add by Lakshan get copy from UpdateJobHeader dal 04 MAy 2017
        public Int32 Save_Job_Header(Service_JOB_HDR _jobHdr)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[68];
            (param[0] = new OracleParameter("p_SJB_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobHdr.SJB_SEQ_NO;
            (param[1] = new OracleParameter("p_SJB_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_JOBNO;
            (param[2] = new OracleParameter("p_SJB_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobHdr.SJB_DT;
            (param[3] = new OracleParameter("p_SJB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_COM;
            (param[4] = new OracleParameter("p_SJB_JOBCAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_JOBCAT;
            (param[5] = new OracleParameter("p_SJB_JOBTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_JOBTP;
            (param[6] = new OracleParameter("p_SJB_JOBSTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_JOBSTP;
            (param[7] = new OracleParameter("p_SJB_MANUALREF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_MANUALREF;
            (param[8] = new OracleParameter("p_SJB_OTHERREF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_OTHERREF;
            (param[9] = new OracleParameter("p_SJB_REQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_REQNO;
            (param[10] = new OracleParameter("p_SJB_JOBSTAGE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _jobHdr.SJB_JOBSTAGE;
            (param[11] = new OracleParameter("p_SJB_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_RMK;
            (param[12] = new OracleParameter("p_SJB_PRORITY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_PRORITY;
            (param[13] = new OracleParameter("p_SJB_ST_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobHdr.SJB_ST_DT;
            (param[14] = new OracleParameter("p_SJB_ED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobHdr.SJB_ED_DT;
            (param[15] = new OracleParameter("p_SJB_NOOFPRINT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobHdr.SJB_NOOFPRINT;
            (param[16] = new OracleParameter("p_SJB_LASTPRINTBY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_LASTPRINTBY;
            (param[17] = new OracleParameter("p_SJB_ORDERNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_ORDERNO;
            (param[18] = new OracleParameter("p_SJB_CUSTEXPTDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CUSTEXPTDT;
            (param[19] = new OracleParameter("p_SJB_SUBSTAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_SUBSTAGE;
            (param[20] = new OracleParameter("p_SJB_CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CUST_CD;
            (param[21] = new OracleParameter("p_SJB_CUST_TIT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CUST_TIT;
            (param[22] = new OracleParameter("p_SJB_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CUST_NAME;
            (param[23] = new OracleParameter("p_SJB_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_NIC;
            (param[24] = new OracleParameter("p_SJB_DL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_DL;
            (param[25] = new OracleParameter("p_SJB_PP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_PP;
            (param[26] = new OracleParameter("p_SJB_MOBINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_MOBINO;
            (param[27] = new OracleParameter("p_SJB_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_ADD1;
            (param[28] = new OracleParameter("p_SJB_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_ADD2;
            (param[29] = new OracleParameter("p_SJB_ADD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_ADD3;
            (param[30] = new OracleParameter("p_SJB_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_TOWN;
            (param[31] = new OracleParameter("p_SJB_PHNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_PHNO;
            (param[32] = new OracleParameter("p_SJB_FAXNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_FAXNO;
            (param[33] = new OracleParameter("p_SJB_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_EMAIL;
            (param[34] = new OracleParameter("p_SJB_CNT_PERSON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CNT_PERSON;
            (param[35] = new OracleParameter("p_SJB_CNT_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CNT_ADD1;
            (param[36] = new OracleParameter("p_SJB_CNT_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CNT_ADD2;
            (param[37] = new OracleParameter("p_SJB_CNT_PHNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CNT_PHNO;
            (param[38] = new OracleParameter("p_SJB_JOB_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_JOB_RMK;
            (param[39] = new OracleParameter("p_SJB_TECH_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_TECH_RMK;
            (param[40] = new OracleParameter("p_SJB_B_CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_CUST_CD;
            (param[41] = new OracleParameter("p_SJB_B_CUST_TIT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_CUST_TIT;
            (param[42] = new OracleParameter("p_SJB_B_CUST_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_CUST_NAME;
            (param[43] = new OracleParameter("p_SJB_B_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_NIC;
            (param[44] = new OracleParameter("p_SJB_B_DL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_DL;
            (param[45] = new OracleParameter("p_SJB_B_PP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_PP;
            (param[46] = new OracleParameter("p_SJB_B_MOBINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_MOBINO;
            (param[47] = new OracleParameter("p_SJB_B_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_ADD1;
            (param[48] = new OracleParameter("p_SJB_B_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_ADD2;
            (param[49] = new OracleParameter("p_SJB_B_ADD3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_ADD3;
            (param[50] = new OracleParameter("p_SJB_B_TOWN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_TOWN;
            (param[51] = new OracleParameter("p_SJB_B_PHNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_PHNO;
            (param[52] = new OracleParameter("p_SJB_B_FAX", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_FAX;
            (param[53] = new OracleParameter("p_SJB_B_EMAIL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_B_EMAIL;
            (param[54] = new OracleParameter("p_SJB_INFM_PERSON", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_INFM_PERSON;
            (param[55] = new OracleParameter("p_SJB_INFM_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_INFM_ADD1;
            (param[56] = new OracleParameter("p_SJB_INFM_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_INFM_ADD2;
            (param[57] = new OracleParameter("p_SJB_INFM_PHNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_INFM_PHNO;
            (param[58] = new OracleParameter("p_SJB_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_STUS;
            (param[59] = new OracleParameter("p_SJB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CRE_BY;
            (param[60] = new OracleParameter("p_SJB_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CRE_DT;
            (param[61] = new OracleParameter("p_SJB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_MOD_BY;
            (param[62] = new OracleParameter("p_SJB_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobHdr.SJB_MOD_DT;
            (param[63] = new OracleParameter("SJB_CHG_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CHG_CD;
            (param[64] = new OracleParameter("SJB_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _jobHdr.SJB_CHG;
            (param[65] = new OracleParameter("p_sjb_pod_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_POD_NO;
            (param[66] = new OracleParameter("p_sjb_rec_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobHdr.SJB_REC_LOC;
            param[67] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_save_scv_job_hdr_web", CommandType.StoredProcedure, param);
            return effects;
        }
        //Add by Lakshan get copy from UpdateJobDetail 04 MAy 2017
        public Int32 UpdateJobDetailWeb(Service_job_Det _jobDet)
        {
            OracleParameter[] param = new OracleParameter[107];
            (param[0] = new OracleParameter("p_jbd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_seq_no;
            (param[1] = new OracleParameter("p_jbd_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_jobno;
            (param[2] = new OracleParameter("p_jbd_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_jobline;
            (param[3] = new OracleParameter("p_jbd_sjobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_sjobno;
            (param[4] = new OracleParameter("p_jbd_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_loc;
            (param[5] = new OracleParameter("p_jbd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_pc;
            (param[6] = new OracleParameter("p_jbd_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_itm_cd;
            (param[7] = new OracleParameter("p_jbd_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_itm_stus;
            (param[8] = new OracleParameter("p_jbd_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_itm_desc;
            (param[9] = new OracleParameter("p_jbd_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_brand;
            (param[10] = new OracleParameter("p_jbd_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_model;
            (param[11] = new OracleParameter("p_jbd_itm_cost", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_itm_cost;
            (param[12] = new OracleParameter("p_jbd_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_ser1;
            (param[13] = new OracleParameter("p_jbd_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_ser2;
            (param[14] = new OracleParameter("p_jbd_warr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_warr;
            (param[15] = new OracleParameter("p_jbd_regno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_regno;
            (param[16] = new OracleParameter("p_jbd_milage", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _jobDet.Jbd_milage;
            (param[17] = new OracleParameter("p_jbd_warr_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_warr_stus;
            (param[18] = new OracleParameter("p_jbd_onloan", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_onloan;
            (param[19] = new OracleParameter("p_jbd_chg_warr_stdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_chg_warr_stdt;
            (param[20] = new OracleParameter("p_jbd_chg_warr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_chg_warr_rmk;
            (param[21] = new OracleParameter("p_jbd_isinsurance", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_isinsurance;
            (param[22] = new OracleParameter("p_jbd_cate1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_cate1;
            (param[23] = new OracleParameter("p_jbd_ser_term", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_ser_term;
            (param[24] = new OracleParameter("p_jbd_lastwarr_stdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_lastwarr_stdt;
            (param[25] = new OracleParameter("p_jbd_issued", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_issued;
            (param[26] = new OracleParameter("p_jbd_mainitmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainitmcd;
            (param[27] = new OracleParameter("p_jbd_mainitmser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainitmser;
            (param[28] = new OracleParameter("p_jbd_mainitmwarr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainitmwarr;
            (param[29] = new OracleParameter("p_jbd_itmmfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_itmmfc;
            (param[30] = new OracleParameter("p_jbd_mainitmmfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainitmmfc;
            (param[31] = new OracleParameter("p_jbd_availabilty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_availabilty;
            (param[32] = new OracleParameter("p_jbd_usejob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_usejob;
            (param[33] = new OracleParameter("p_jbd_msnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_msnno;
            (param[34] = new OracleParameter("p_jbd_itmtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_itmtp;
            (param[35] = new OracleParameter("p_jbd_serlocchr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_serlocchr;
            (param[36] = new OracleParameter("p_jbd_custnotes", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_custnotes;
            (param[37] = new OracleParameter("p_jbd_mainreqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainreqno;
            (param[38] = new OracleParameter("p_jbd_mainreqloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainreqloc;
            (param[39] = new OracleParameter("p_jbd_mainjobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_mainjobno;
            (param[40] = new OracleParameter("p_jbd_reqitmtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_reqitmtp;
            (param[41] = new OracleParameter("p_jbd_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_reqno;
            (param[42] = new OracleParameter("p_jbd_reqline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_reqline;
            (param[43] = new OracleParameter("p_jbd_isstockupdate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_isstockupdate;
            (param[44] = new OracleParameter("p_jbd_isgatepass", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_isgatepass;
            (param[45] = new OracleParameter("p_jbd_iswrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_iswrn;
            (param[46] = new OracleParameter("p_jbd_warrperiod", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_warrperiod;
            (param[47] = new OracleParameter("p_jbd_warrrmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_warrrmk;
            (param[48] = new OracleParameter("p_jbd_warrstartdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_warrstartdt;
            (param[49] = new OracleParameter("p_jbd_warrreplace", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_warrreplace;
            (param[50] = new OracleParameter("p_jbd_date_pur", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_date_pur;
            (param[51] = new OracleParameter("p_jbd_invc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_invc_no;
            (param[52] = new OracleParameter("p_jbd_waraamd_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_waraamd_seq;
            (param[53] = new OracleParameter("p_jbd_waraamd_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_waraamd_by;
            (param[54] = new OracleParameter("p_jbd_waraamd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_waraamd_dt;
            (param[55] = new OracleParameter("p_jbd_invc_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_invc_showroom;
            (param[56] = new OracleParameter("p_jbd_aodissueloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_aodissueloc;
            (param[57] = new OracleParameter("p_jbd_aodissuedt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_aodissuedt;
            (param[58] = new OracleParameter("p_jbd_aodissueno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_aodissueno;
            (param[59] = new OracleParameter("p_jbd_aodrecno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_aodrecno;
            (param[60] = new OracleParameter("p_jbd_techst_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_techst_dt;
            (param[61] = new OracleParameter("p_jbd_techfin_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_techfin_dt;
            (param[62] = new OracleParameter("p_jbd_msn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_msn_no;
            (param[63] = new OracleParameter("p_jbd_isexternalitm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_isexternalitm;
            (param[64] = new OracleParameter("p_jbd_conf_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_conf_dt;
            (param[65] = new OracleParameter("p_jbd_conf_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_conf_cd;
            (param[66] = new OracleParameter("p_jbd_conf_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_conf_desc;
            (param[67] = new OracleParameter("p_jbd_conf_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_conf_rmk;
            (param[68] = new OracleParameter("p_jbd_tranf_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_tranf_by;
            (param[69] = new OracleParameter("p_jbd_tranf_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_tranf_dt;
            (param[70] = new OracleParameter("p_jbd_do_invoice", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_do_invoice;
            (param[71] = new OracleParameter("p_jbd_insu_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_insu_com;
            (param[72] = new OracleParameter("p_jbd_agreeno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_agreeno;
            (param[73] = new OracleParameter("p_jbd_issrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_issrn;
            (param[74] = new OracleParameter("p_jbd_isagreement", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_isagreement;
            (param[75] = new OracleParameter("p_jbd_cust_agreeno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_cust_agreeno;
            (param[76] = new OracleParameter("p_jbd_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_quo_no;
            (param[77] = new OracleParameter("p_jbd_stage", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _jobDet.Jbd_stage;
            (param[78] = new OracleParameter("p_jbd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_com;
            (param[79] = new OracleParameter("p_jbd_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_ser_id;
            (param[80] = new OracleParameter("p_jbd_techst_dt_man", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_techst_dt_man;
            (param[81] = new OracleParameter("p_jbd_techfin_dt_man", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_techfin_dt_man;
            (param[82] = new OracleParameter("p_jbd_reqwcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_reqwcn;
            (param[83] = new OracleParameter("p_jbd_reqwcndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_reqwcnsysdt;
            (param[84] = new OracleParameter("p_jbd_reqwcnsysdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_reqwcnsysdt;
            (param[85] = new OracleParameter("p_jbd_sentwcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_sentwcn;
            (param[86] = new OracleParameter("p_jbd_recwcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_recwcn;
            (param[87] = new OracleParameter("p_jbd_takewcn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_takewcn;
            (param[88] = new OracleParameter("p_jbd_takewcndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_takewcndt;
            (param[89] = new OracleParameter("p_jbd_takewcnsysdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.Jbd_takewcnsysdt;
            (param[90] = new OracleParameter("p_jbd_supp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_supp_cd;
            (param[91] = new OracleParameter("p_jbd_part_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_part_cd;
            (param[92] = new OracleParameter("p_jbd_oem_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_oem_no;
            (param[93] = new OracleParameter("p_jbd_case_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_case_id;
            (param[94] = new OracleParameter("p_jbd_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_act;
            (param[95] = new OracleParameter("p_jbd_oldjobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_oldjobline;
            (param[96] = new OracleParameter("p_jbd_tech_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_tech_rmk;
            (param[97] = new OracleParameter("p_jbd_tech_custrmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_tech_custrmk;
            (param[98] = new OracleParameter("p_jbd_tech_cls_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_tech_cls_tp;
            (param[99] = new OracleParameter("P_jbd_tech_cls_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.Jbd_tech_cls_rmk;
            (param[100] = new OracleParameter("P_JBD_IS_FGAP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.Jbd_is_fgap;
            (param[101] = new OracleParameter("P_JBD_REP_PERC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _jobDet.Jbd_rep_perc;
            (param[102] = new OracleParameter("P_JBD_SW_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDet.jbd_sw_stus;
            (param[103] = new OracleParameter("P_JBD_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.jbd_pb;
            (param[104] = new OracleParameter("P_JBD_PBLVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDet.jbd_pblvl;
            (param[105] = new OracleParameter("P_JBD_DEL_SALE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _jobDet.jbd_del_sale_dt;
            param[106] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_cust_job_det", CommandType.StoredProcedure, param);
            return effects;
        }
        //Copy From Cust Service dal Lakshan 09 Jun 2017
        //THARAKA 2014-10-03
        public Int32 Save_ServiceJobStageLog(Service_Job_StageLog oHeader)
        {
            OracleParameter[] param = new OracleParameter[13];
            Int32 effects = 0; ;
            (param[0] = new OracleParameter("P_sjl_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_REQNO;
            (param[1] = new OracleParameter("P_sjl_reqline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.SJL_REQLINE;
            (param[2] = new OracleParameter("P_sjl_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_JOBNO;
            (param[3] = new OracleParameter("P_sjl_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.SJL_JOBLINE;
            (param[4] = new OracleParameter("P_sjl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_COM;
            (param[5] = new OracleParameter("P_sjl_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_LOC;
            (param[6] = new OracleParameter("P_sjl_otherdocno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_OTHERDOCNO;
            (param[7] = new OracleParameter("P_sjl_jobstage", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oHeader.SJL_JOBSTAGE;
            (param[8] = new OracleParameter("P_sjl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_CRE_BY;
            (param[9] = new OracleParameter("P_sjl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.SJL_CRE_DT;
            (param[10] = new OracleParameter("P_sjl_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.SJL_SESSION_ID;
            (param[11] = new OracleParameter("P_sjl_infsup ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.SJL_INFSUP;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("SP_SAVE_JOBSTAGELOG", CommandType.StoredProcedure, param);
            return effects;
        }
        //Copy From Cust Service dal Lakshan 09 Jun 2017
        //kapila, Edit by Chamal 01-Dec-2014
        public Int32 UpdateJobDefects(Service_Job_Defects _jobDef)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_srd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDef.SRD_SEQ_NO;
            (param[1] = new OracleParameter("p_srd_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SRD_JOB_NO;
            (param[2] = new OracleParameter("p_srd_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDef.SRD_JOB_LINE;
            (param[3] = new OracleParameter("p_srd_stage", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SRD_STAGE;
            (param[4] = new OracleParameter("p_srd_def_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDef.SRD_DEF_LINE;
            (param[5] = new OracleParameter("p_srd_def_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SRD_DEF_TP;
            (param[6] = new OracleParameter("p_srd_def_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SRD_DEF_RMK;
            (param[7] = new OracleParameter("p_srd_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDef.SRD_ACT;
            (param[8] = new OracleParameter("p_srd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SRD_CRE_BY;
            (param[9] = new OracleParameter("p_srd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SRD_MOD_BY;
            (param[10] = new OracleParameter("p_srd_is_main_def", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobDef.SRD_IS_MAIN_DEF;
            (param[11] = new OracleParameter("p_srd_deff_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobDef.SDT_DESC;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_cust_job_def", CommandType.StoredProcedure, param);
            return effects;
        }
        //SUBODANA 2017-05-04
        public DataTable GetComponetUnit(string finishitem, string comitem)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_FINISHCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = finishitem;
            (param[1] = new OracleParameter("P_COMITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comitem;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_GET_COMP_UNIT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Akila 2017/05/18
        public int IsItemActive(string _item)
        {
            int isActive = 0;
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            isActive = UpdateRecords("SP_CHECK_ITEM_ACTIVE", CommandType.StoredProcedure, param);

            return isActive;
        }

        //ISURU 2017/05/23
        public DataTable getpanaltystatesdetails(string invno)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_panalty_details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharanga 2017/May/24
        public int SaveInventory_update_RequestItem(int seq_no, int line_no, InventoryRequestItem _inventoryRequestItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            (param[1] = new OracleParameter("p_itri_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line_no;
            if (_inventoryRequestItem.MasterItem != null)
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.MasterItem.Mi_cd;
            }
            else
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            }

            (param[3] = new OracleParameter("p_itri_app_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_app_qty;
            (param[4] = new OracleParameter("p_itri_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_bqty;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_update_inv_req_app_item", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        //Tharanga 2017/May/24
        public DataTable getLtr_seq_n(InventoryRequest _inventoryRequest)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "GET_ltr_seq_no", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int32 addDocumentPrintNew(string printdoc, string userId, string doctype, string sessionId, string loadingpoint, string wareloc)
        {
            ConnectionOpen();
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = printdoc;
            (param[1] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[2] = new OracleParameter("p_lp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loadingpoint;
            (param[3] = new OracleParameter("p_sesid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
            (param[4] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
            (param[5] = new OracleParameter("p_credt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = wareloc;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int32)UpdateRecords("pkg_pda.SP_UPDATE_DOCPRINTSTATUSNEW", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _effect;
        }
        //Add by Lakshan Copy From cust Service
        public Int32 GetJobSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getjobserialid", CommandType.StoredProcedure, param);
            return effects;

        }
        //Tharanga 2017/06/02
        public DataTable checkIntser(string comcd, string itmCd, string intSer)
        {
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comcd;
            (param[1] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
            (param[2] = new OracleParameter("p_itm_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = intSer;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_check_itm_ser", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int32 DispatchRecordUpdate(DataTable dispatch, string comCode, string userID, string sessionId, DateTime modiDate, int chk)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            foreach (DataRow drow in dispatch.Rows)
            {
                (param[0] = new OracleParameter("p_ITR_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = drow["ITR_REQ_NO"];
                (param[1] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
                (param[2] = new OracleParameter("p_userId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userID;
                (param[3] = new OracleParameter("p_sessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
                (param[4] = new OracleParameter("p_modiDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = modiDate;
                (param[5] = new OracleParameter("p_chk", OracleDbType.Int16, null, ParameterDirection.Input)).Value = chk;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int32)UpdateRecords("sp_updateDispatchSummaryRecord", CommandType.StoredProcedure, param);
            }
            return effects;
        }
        //subodana 2017-06-13
        public DataTable Barcodepludocdata(string com, string doc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("doc", "SP_PLU_DOC_DATA", CommandType.StoredProcedure, false, param);
            return _dt;
        }
        //Lakshan 13 Sep 2016
        public List<InventoryBatchN> GET_INT_BATCH_DATA_BY_REF(string _baseRefDocNo, Int32 _baseRefLine)
        {
            List<InventoryBatchN> _list = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itb_base_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseRefDocNo;
            (param[1] = new OracleParameter("p_itb_base_refline", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _baseRefLine;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("int_batch", "sp_get_int_batch_data_by_ref", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.ConverterNew);
            }
            return _list;
        }

        //Rukshan 09/sep/2015 modyfy by lakshan 26 Jun 2017
        public DataTable GetSupplierSerialWEB(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            //Spliit for Search control type.
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            //Spliit for Search SP parameters.
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _ICode = null;
            string _SerialI = null;
            string _Po = null;
            string _GRN = null;
            //Set relavant parameters according to the,search catergory.
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ITEM":
                        _ICode = _searchText;
                        break;

                    case "SERIAL":
                        _SerialI = _searchText;
                        break;
                    case "PO #":
                        _Po = _searchText;
                        break;
                    case "GRN #":
                        _GRN = _searchText;
                        break;
                    default:
                        break;
                }
            }

            //Modify parameter values for LIKE search.
            // _ICode = (_ICode != null) ? (_ICode.ToUpper() + "%") : null;
            // _SerialI = (_SerialI != null) ? (_SerialI.ToUpper() + "%") : null;
            // _Po = (_Po != null) ? (_Po.ToUpper() + "%") : null;
            // _GRN = (_GRN != null) ? (_GRN.ToUpper() + "%") : null;
            // _status = (_status != null) ? (_status.ToUpper() + "%") : null;

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ICode;
            (param[1] = new OracleParameter("p_Seial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SerialI;
            (param[2] = new OracleParameter("p_Po", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Po;
            (param[3] = new OracleParameter("p_GRN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _GRN;
            (param[4] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            (param[5] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[6] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblPurchaseOrder", "pkg_search_inv.sp_get_Supplier_serial", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Add  by lakshan copy from general Dal
        public MasterItem GetItemMaster(string _item)
        {// Nadeeka
            MasterItem _itemList = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _itemTable = QueryDataTable("tblItem", "get_itemMaster", CommandType.StoredProcedure, false, param);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal)[0];
            }
            return _itemList;
        }

        //udaya 28.06.2017
        public DataTable LoadInventoryDataByExpiryDate(string company, string item, string isordbyloc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("p_ordbyloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isordbyloc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("inr_batchData", "sp_get_invData_by_exp_date", CommandType.StoredProcedure, false, param);
        }
        //Lakshan 30 Jun 2017
        public List<InventoryRequestItem> GetSOAItemDataByInvoice(string _invoice)
        {
            List<InventoryRequestItem> _list = new List<InventoryRequestItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_soa_itm_data_by_inv", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterNew);
            }
            return _list;
        }
        //Udaya 03.07.2017
        public DataTable Collect_ItemReservationDtl(string _com, string _loc, string _itm, string _status)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tblItemRes", "sp_get_itm_reservation_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //By akila 201/07/03
        public Int32 UpdateConfirmedSCVPO(string _poNo, string _jobNo, string _userCode)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;

            (param[0] = new OracleParameter("p_posa_po_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            (param[1] = new OracleParameter("p_posa_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[2] = new OracleParameter("p_posa_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userCode;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_PURSCVAPP", CommandType.StoredProcedure, param);
            return effects;
        }
        //Udaya 07.07.2017 
        public DataTable get_technicianAllocated_Details(string _com, string _loc, string jobNo)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbltechDtls", "sp_get_techAlocated_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Add By Lakshan 04Jul2017
        public INR_AVG_COST GET_INR_AVG_COST_DATA(INR_AVG_COST _obj)
        {
            INR_AVG_COST _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_iac_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_com;
            (param[1] = new OracleParameter("p_iac_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_loc_tp;
            (param[2] = new OracleParameter("p_iac_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_itm_cd;
            (param[3] = new OracleParameter("p_iac_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_itm_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("INR_AVG_COST", "sp_get_inr_avg_cost_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_AVG_COST>(_dtResults, INR_AVG_COST.Converter)[0];
            }
            return _list;
        }
        // Add by Lakshan 04Jul2017
        public Int32 UpdateInrCostData(INR_AVG_COST _obj)
        {
            OracleParameter[] param = new OracleParameter[22];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_iac_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_com;
            (param[1] = new OracleParameter("p_iac_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_loc_tp;
            (param[2] = new OracleParameter("p_iac_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_itm_cd;
            (param[3] = new OracleParameter("p_iac_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_itm_stus;
            (param[4] = new OracleParameter("p_iac_avg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iac_avg_dt;
            (param[5] = new OracleParameter("p_iac_avg_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iac_avg_cost;
            (param[6] = new OracleParameter("p_iac_avg_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iac_avg_qty;
            (param[7] = new OracleParameter("p_iac_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_cre_by;
            (param[8] = new OracleParameter("p_iac_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iac_cre_dt;
            (param[9] = new OracleParameter("p_iac_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_mod_by;
            (param[10] = new OracleParameter("p_iac_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iac_mod_dt;
            (param[11] = new OracleParameter("p_iac_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_anal_1;
            (param[12] = new OracleParameter("p_iac_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_anal_2;
            (param[13] = new OracleParameter("p_iac_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_anal_3;
            (param[14] = new OracleParameter("p_iac_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_anal_4;
            (param[15] = new OracleParameter("p_iac_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_anal_5;
            (param[16] = new OracleParameter("p_iac_costofsale", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iac_costofsale;
            (param[17] = new OracleParameter("p_iac_tot_inv_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iac_tot_inv_rate;
            (param[18] = new OracleParameter("p_iac_sold_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iac_sold_qty;
            (param[19] = new OracleParameter("p_iac_sold_qty_intr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iac_sold_qty_intr_com;
            (param[20] = new OracleParameter("p_iac_avg_inv_days", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iac_avg_inv_days;
            param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inr_avg_cost", CommandType.StoredProcedure, param);
            return effects;
        }
        //Lakshan 10 Nov 2016
        public decimal GetInrBalanceForAvgCost(string _com, string _itm, string _itmStus, string _mlCat1)
        {
            decimal _balance = 0, tmp = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_inl_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_inl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_inl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStus;
            (param[3] = new OracleParameter("p_ML_CATE_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mlCat1;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_loc", "sp_get_inv_bal_for_cst", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _balance = decimal.TryParse(_dtResults.Rows[0][0].ToString(), out tmp) ? Convert.ToDecimal(_dtResults.Rows[0][0].ToString()) : 0;
            }
            return _balance;
        }
        //Lakshan 10 Nov 2016
        public decimal GetInrAvgCostMthDataAva(DateTime _dt)
        {
            decimal _balance = 0, tmp = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_iac_avg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_loc", "sp_get_inr_mth_cost_ava", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _balance = decimal.TryParse(_dtResults.Rows[0][0].ToString(), out tmp) ? Convert.ToDecimal(_dtResults.Rows[0][0].ToString()) : 0;
            }
            return _balance;
        }
        public Int32 UpdateInrMnthlyCostData(string _creBy)
        {
            OracleParameter[] param = new OracleParameter[2];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_iac_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creBy;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inr_avg_cost_mth", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable GetSearchMRNWebByJobNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _mrn = null;
            string _status = null;
            string _reqestfrom = null;
            string _reqestdate = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "MRN NO":
                        _mrn = _searchText;
                        break;

                    case "STATUS":
                        _status = _searchText;
                        break;

                    case "REQUEST FROM":
                        _reqestfrom = _searchText;
                        break;

                    case "DATE":
                        _reqestdate = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _mrn = (_mrn != null) ? (_mrn.ToUpper()) : null;
            _status = (_status != null) ? ("%" + _status.ToUpper() + "%") : null;
            _reqestfrom = (_reqestfrom != null) ? (_reqestfrom.ToUpper()) : null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_request", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrn;
            (param[3] = new OracleParameter("p_request_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqestfrom;
            (param[4] = new OracleParameter("p_requestdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqestdate;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString(); ;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("int_req", "sp_searchmrn_web_byjob", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharanga 2017/07/11
        public DataTable Get_Spare_parts_Movement_Report(string _com, string _item, DateTime _frmdate, DateTime _todate, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_frmdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmdate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_Spare_arts_Movement_Report", CommandType.StoredProcedure, false, param);

            return dt;
        }
        //Add by lakshan 11Jul2017
        public List<InventoryBatchRefN> GET_INR_BATCH_BY_JOB_NO(string _JobNo, Int32 _jobLine)
        {
            List<InventoryBatchRefN> _list = new List<InventoryBatchRefN>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inb_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _JobNo;
            (param[1] = new OracleParameter("p_inb_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobLine;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            if (string.IsNullOrEmpty(_JobNo))
            {
                return _list;
            }
            else
            {
                dt = QueryDataTable("INR_BATCH", "sp_get_inr_batch_by_job_no", CommandType.StoredProcedure, false, param);
                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryBatchRefN>(dt, InventoryBatchRefN.Converter);
                }
            }
            return _list;
        }
        //Tharanga 2017/07/12

        public DataTable Get_Spare_parts_Movement(string _com, string _item, DateTime _frmdate, DateTime _todate, string _pc, Int32 p_permission)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_frmdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmdate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_permission", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_permission;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl", "sp_Spare_parts_Movement", CommandType.StoredProcedure, false, param);

            return dt;
        }

        //Add By Lakshan 04Jul2017
        public INR_AVG_COST GET_INR_AVG_COST_FOR_OUT(string _com, string _itm, string _stus, string _loc)
        {
            INR_AVG_COST _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_iac_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_iac_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_iac_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[3] = new OracleParameter("p_ml_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("INR_AVG_COST", "sp_get_inr_avg_cost_for_out", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_AVG_COST>(_dtResults, INR_AVG_COST.Converter)[0];
            }
            return _list;
        }
        //Add By Lakshan 04Jul2017
        public INR_AVG_COST_GIT GET_INR_AVG_GIT_BY_LOC_TP(INR_AVG_COST_GIT _obj)
        {
            INR_AVG_COST_GIT _list = null; decimal _avgQty = 0, _avgcst = 0, _tmp = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_iacg_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_com;
            (param[1] = new OracleParameter("p_iacg_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_loc_tp;
            (param[2] = new OracleParameter("p_iacg_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_itm_cd;
            (param[3] = new OracleParameter("p_iacg_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_itm_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("INR_AVG_COST_GIT", "sp_avgcst_git_bal_by_loc_tp", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _avgcst = decimal.TryParse(_dtResults.Rows[0]["iacg_avg_cost"].ToString(), out _tmp) ? Convert.ToDecimal(_dtResults.Rows[0]["iacg_avg_cost"].ToString()) : 0;
                _avgQty = decimal.TryParse(_dtResults.Rows[0]["iacg_avg_qty"].ToString(), out _tmp) ? Convert.ToDecimal(_dtResults.Rows[0]["iacg_avg_qty"].ToString()) : 0;
                _list = new INR_AVG_COST_GIT();
                _list.Iacg_avg_cost = _avgcst;
                _list.Iacg_avg_qty = _avgQty;
            }
            return _list;
        }

        // Add by Lakshan 04Jul2017
        public Int32 UpdateInrCostDataGit(INR_AVG_COST_GIT _obj)
        {
            OracleParameter[] param = new OracleParameter[17];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_iac_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_com;
            (param[1] = new OracleParameter("p_iac_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_loc;
            (param[2] = new OracleParameter("p_iac_loc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_loc_tp;
            (param[3] = new OracleParameter("p_iac_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_itm_cd;
            (param[4] = new OracleParameter("p_iac_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_itm_stus;
            (param[5] = new OracleParameter("p_iac_avg_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iacg_avg_dt;
            (param[6] = new OracleParameter("p_iac_avg_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iacg_avg_cost;
            (param[7] = new OracleParameter("p_iac_avg_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iacg_avg_qty;
            (param[8] = new OracleParameter("p_iac_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_cre_by;
            (param[9] = new OracleParameter("p_iac_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iacg_cre_dt;
            (param[10] = new OracleParameter("p_iac_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_mod_by;
            (param[11] = new OracleParameter("p_iac_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Iacg_mod_dt;
            (param[12] = new OracleParameter("p_iac_mod_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Iacg_mod_doc;
            (param[13] = new OracleParameter("p_iacg_out_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iacg_out_qty;
            (param[14] = new OracleParameter("p_iacg_in_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.Iacg_in_qty;
            (param[15] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Iacg_direction;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inr_avg_cost_git", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Check_ava_cost_available(int _p_val)
        {
            //Chamal 03-Sep-2015
            int effected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _p_val;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_chk_avg_cst_ava", CommandType.StoredProcedure, param);
            return (Int32)effected;
        }

        //Added by kapila on 15/Jul/2017
        public List<InventoryLocation> GetItemInventoryBalance_New(string _company, string _location, string _item, string _pbook, string _pblvl)
        {
            List<InventoryLocation> _list = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            (param[4] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_inventorybalance_new", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_tblBalance, InventoryLocation.ConvertTotal);
            }
            return _list;
        }
        //Add by Lakshan 05 Aug 2017
        public List<ReptPickSerials> GetSerialDataForDisposalEntry(string _com, string _loc, string _itm, string _itmStus, string _serial, string _supplier, Int32 _serId)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_ins_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStus;
            (param[4] = new OracleParameter("p_ins_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
            (param[5] = new OracleParameter("p_ins_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[6] = new OracleParameter("p_ins_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("inr_ser", "sp_ser_serial_for_disposal", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }
        public DataTable MRN_Approved_Report(DateTime _fromdate, DateTime _todate, string in_Company, string _loc, string in_user_id, string _rpt_Type, string _route, int _allRoute)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[1] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[3] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[5] = new OracleParameter("in_rpttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rpt_Type;
            (param[6] = new OracleParameter("in_route", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _route;
            (param[7] = new OracleParameter("in_chkrouteall", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _allRoute;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblAppMRN", "sp_get_approved_mrn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable sp_get_inv_war_det(string _warrNo)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_warrno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _warrNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbData", "sp_get_inv_war_det", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        //Modify by Lakshan 10Aug2017 get Copy From GET_DISPOSAL_ITM_LIST
        public List<DisposalItem> GET_DISPOSAL_ITM_LIST_WEB(int _seqNo, string _docNo, bool istextchange)
        {
            List<DisposalItem> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_IDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            (param[1] = new OracleParameter("P_IDD_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[2] = new OracleParameter("p_idd_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = istextchange ? 1 : 0;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_disp_itm_new", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<DisposalItem>(dt, DisposalItem.Converter3);
            }
            return oResult;
        }
        public DataTable RequirmentsDetails(DateTime _frmDate, DateTime _toDate, string _comCode, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDate;
            (param[1] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl_REQUIRMENTS", "SP_ITEM_DEPT_REQUIRMENTS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Add by Lakshan 20Aug2017
        public Int32 UpdateBowMrnQty(string _doc, Int32 _lineNo, decimal _mrnQty)
        {
            //RUKSHAN
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_spd_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_spd_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            (param[2] = new OracleParameter("p_mrn_qty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mrnQty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_sat_pro_det_mrn_bal", CommandType.StoredProcedure, param);

            return effects;
        }
        //Add by Lakshan 20 Aug 2017
        public List<SatProjectDetails> GET_SAT_PRO_DET_DATA(SatProjectDetails _obj)
        {
            List<SatProjectDetails> _list = new List<SatProjectDetails>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_spd_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.SPD_NO;
            (param[1] = new OracleParameter("p_spd_actve", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.SPD_ACTVE;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "sp_get_sat_pro_det_data", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SatProjectDetails>(_tblData, SatProjectDetails.Converter2);
            }
            return _list;
        }
        public SatProjectHeader GET_SAT_PRO_HDR_DATA(string com, string doc)
        {
            List<SatProjectHeader> _list = new List<SatProjectHeader>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblData = QueryDataTable("tbData", "SP_GET_PROHDR", CommandType.StoredProcedure, false, param);
            if (_tblData.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<SatProjectHeader>(_tblData, SatProjectHeader.Converter);
            }
            return _list[0];
        }
        //Udaya 21.08.2017 Supplier Pricess Report
        public DataTable SupplierPricess_Details(DateTime _frmDate, DateTime _toDate, string _comCode, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDate;
            (param[1] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl_SupplierPricess", "SP_ITEM_SUPP_PRICESS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Written by Rukshan 16/oct/2015 modify by lakshan add new converter
        public List<InventoryRequest> GetMRN_ReqWEB(string _IssuesFrom, string _reTo, DateTime _Fdate, DateTime _Todate, string _type, string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[8];
            List<InventoryRequest> _list = null;
            (param[0] = new OracleParameter("p_IssuesFrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _IssuesFrom;
            (param[1] = new OracleParameter("p_recto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reTo;
            (param[2] = new OracleParameter("p_Fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Fdate;
            (param[3] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Todate;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "pkg_search_inv.sp_GetMRN_req", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter);
            }
            return _list;
        }
        //Rukshan 29/ Oct/2015
        public decimal GetForwardsaleNew(string _showroom, string _Item, string _com, string _pc)
        {
            //Add pc column by lakshan 22 Aug 2017 copy from GetForwardsale
            decimal functionReturnValue = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_showroom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _showroom;
            (param[2] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Item;
            (param[3] = new OracleParameter("p_sah_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_batch", "sp_getforwardsaleqty_new", CommandType.StoredProcedure, false, param);
            if ((_dtResults != null) && (_dtResults.Rows.Count > 0))
            {
                string value = _dtResults.Rows[0]["fwsqty"].ToString();
                if (!string.IsNullOrEmpty(value))
                {
                    functionReturnValue = Convert.ToDecimal(_dtResults.Rows[0]["fwsqty"].ToString());
                }
            }
            return functionReturnValue;
        }
        // add by tharanga 2017/08/23
        public Int32 Update_sat_hdr_d_cust(InventoryHeader _obj)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_d_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_del_code;
            (param[1] = new OracleParameter("p_d_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_del_cust_name;
            (param[2] = new OracleParameter("p_d_cust_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_del_add1;
            (param[3] = new OracleParameter("p_d_cust_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_del_add2;
            (param[4] = new OracleParameter("p_sah_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ith_entry_no;


            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_Del_cus_det", CommandType.StoredProcedure, param);
            return effects;
        }
        //add by tharanga 2017/08/28
        public Int32 Save_InventoryDoShedule(InventoryDoShedule _obj)
        {
            OracleParameter[] param = new OracleParameter[20];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sid_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sid_seq_no;
            (param[1] = new OracleParameter("p_sid_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sid_itm_line;
            (param[2] = new OracleParameter("p_sid_del_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sid_del_line;
            (param[3] = new OracleParameter("p_sid_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_inv_no;
            (param[4] = new OracleParameter("p_sid_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_itm_cd;
            (param[5] = new OracleParameter("p_sid_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_itm_stus;
            (param[6] = new OracleParameter("p_sid_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sid_qty;
            (param[7] = new OracleParameter("p_sid_do_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sid_do_qty;
            (param[8] = new OracleParameter("p_sid_del_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_del_com;
            (param[9] = new OracleParameter("p_sid_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_del_loc;
            (param[10] = new OracleParameter("p_sid_d_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_d_cust_cd;
            (param[11] = new OracleParameter("p_sid_d_cust_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_d_cust_tp;
            (param[12] = new OracleParameter("p_sid_d_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_d_cust_name;
            (param[13] = new OracleParameter("p_sid_d_cust_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_d_cust_add1;
            (param[14] = new OracleParameter("p_sid_d_cust_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_d_cust_add2;
            (param[15] = new OracleParameter("p_sid_d_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_d_town;
            (param[16] = new OracleParameter("p_sid_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.sid_act;
            (param[17] = new OracleParameter("p_sid_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_cre_by;
            (param[18] = new OracleParameter("p_sid_cre_ses", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.sid_cre_session;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int16, null, ParameterDirection.Output);

            effects = UpdateRecords("SP_SAVE_InventoryDoShedule", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 GET_MAX_LINE_DO_SHEDULE(Int32 p_sid_seq_no, Int32 p_sid_itm_line, string p_sid_inv_no, string p_sid_itm_cd)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 functionReturnValue = 0;
            (param[0] = new OracleParameter("p_sid_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_sid_seq_no;
            (param[1] = new OracleParameter("p_sid_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_sid_itm_line;
            (param[2] = new OracleParameter("p_sid_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sid_inv_no;
            (param[3] = new OracleParameter("p_sid_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sid_itm_cd;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //effects = UpdateRecords("sp_get_max_del_line", CommandType.StoredProcedure, param);
            //return effects;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_max_del_line", CommandType.StoredProcedure, false, param);

            if ((_dtResults != null) && (_dtResults.Rows.Count > 0))
            {
                string value = _dtResults.Rows[0]["MAXNLINE"].ToString();
                if (!string.IsNullOrEmpty(value))
                {
                    functionReturnValue = Convert.ToInt32(_dtResults.Rows[0]["MAXNLINE"].ToString());
                }
            }
            return functionReturnValue;
        }


        //Added By Udaya 26.08.2017 SOA Cancellation collect data
        public List<InvoiceItem> SOA_Cancellation(string reqNo, string Com)
        {
            List<InvoiceItem> result = new List<InvoiceItem>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_reqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqNo;
            (param[1] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSOACancel", "SP_SOA_CANCELATION", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem);//ConvertTotal
            return result;
        }
        //Added By Udaya 26.08.2017 SOA Cancellation Update
        public Int32 UpdateSOACancellation(string _item, Int32 _lineno, string _invNo)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineno;
            (param[2] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_updateSOACancellation", CommandType.StoredProcedure, param);
            return effects;
        }
        //Add by Lakshan 29Aug2017
        public Int32 UpdateMrnItemCode(InventoryRequestItem _obj)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itr_req_no;
            (param[1] = new OracleParameter("p_itri_line_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itri_line_no;
            (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itri_itm_cd;
            (param[3] = new OracleParameter("p_itri_old_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itri_old_itm_cd;
            (param[4] = new OracleParameter("p_itri_itm_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itri_itm_mod_by;
            (param[5] = new OracleParameter("p_itri_itm_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Itri_itm_mod_dt;
            (param[6] = new OracleParameter("p_itri_itm_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itri_itm_mod_session;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_int_req_itm_itmcd", CommandType.StoredProcedure, param);

            return effects;
        }
        //Added By Udaya GRN qty update with different location 30.08.2017
        public int Update_GRN_BalQty_WithNonLocations(int _seq_no, int _line_no, int _delLineNo, string _itmCd, decimal _act_qty)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq_no;
            (param[1] = new OracleParameter("p_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line_no;
            (param[2] = new OracleParameter("p_del_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _delLineNo;
            (param[3] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCd;
            (param[4] = new OracleParameter("p_act_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _act_qty;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_update_po_nonLoc_balqty", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //Added By Udaya GET PUR_DEL details for GRN QTY update process 01.09.2017
        public List<PurchaseOrderDelivery> Collect_PODetails(Int32 seqNo, Int32 lineNo)
        {
            List<PurchaseOrderDelivery> result = new List<PurchaseOrderDelivery>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seqNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNo;
            (param[1] = new OracleParameter("p_lineNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblPODtl", "SP_GET_PUR_DEL_GRN", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<PurchaseOrderDelivery>(_dtResults, PurchaseOrderDelivery.ConverterPOGRN);
            return result;
        }

        public int emptyTempSerialItemsansSerials(int SeqNo)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seqno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SeqNo;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effected = UpdateRecords("sp_delete_tempitmser", CommandType.StoredProcedure, param);
            return (Int32)effected;
        }

        public DataTable getConditionDetails(string seriaid)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_serid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seriaid;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_batch", "SP_GET_PRODUCTCONDET", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //18 Nov/2015 Sahan
        public DataTable LoadHeaderPCUpdateDocHeadOfficeUserNew(string type, DateTime fromdate, DateTime todate, string location, Int32 isUpdated, string cat1, string cat2, string cat3, string document)
        {
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[4] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[5] = new OracleParameter("p_mi_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[6] = new OracleParameter("p_mi_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;
            (param[7] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;
            (param[8] = new OracleParameter("p_updated", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isUpdated;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("int_hdr", "load_header_head_office_user", CommandType.StoredProcedure, false, param);
        }
        public DataTable LoadHeaderPCUpdateDocWareHouseUserNew(string type, DateTime fromdate, DateTime todate, string location, Int32 isUpdated, string cat1, string cat2, string cat3, string document)
        {
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[3] = new OracleParameter("p_ith_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;

            (param[4] = new OracleParameter("p_mi_cate_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[5] = new OracleParameter("p_mi_cate_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[6] = new OracleParameter("p_mi_cate_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;
            (param[7] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = document;
            (param[8] = new OracleParameter("p_updated", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isUpdated;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "load_header_warehouse_user", CommandType.StoredProcedure, false, param);
        }

        public RequestApprovalHeader getApprovedRequestDetails(string invNo)
        {
            try
            {
                RequestApprovalHeader _list = new RequestApprovalHeader();

                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblData = QueryDataTable("tbData", "SP_GET_INVSRNREQDTL", CommandType.StoredProcedure, false, param);

                if (_tblData.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<RequestApprovalHeader>(_tblData, RequestApprovalHeader.ConverterPda)[0];
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<RequestApprovalDetail> getApprovedRequestItemDetails(string reqno)
        {
            try
            {
                List<RequestApprovalDetail> _list = new List<RequestApprovalDetail>();
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable dt = new DataTable();
                dt = QueryDataTable("tbl", "SP_GET_INVSRNREQITEMDTL", CommandType.StoredProcedure, false, param);

                if (dt.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<RequestApprovalDetail>(dt, RequestApprovalDetail.Converter);
                }

                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int32 update_InventoryDoShedule(InventoryDoShedule _InventoryDoShedule)
        {
            OracleParameter[] param = new OracleParameter[9];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_sid_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_inv_no;
            (param[1] = new OracleParameter("p_sid_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_itm_cd;


            (param[2] = new OracleParameter("p_sid_do_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_do_qty;
            (param[3] = new OracleParameter("p_sid_del_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_del_com;
            (param[4] = new OracleParameter("p_sid_del_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_del_loc;

            (param[5] = new OracleParameter("p_sid_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_cre_by;
            (param[6] = new OracleParameter("p_sid_cre_ses", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_cre_session;
            (param[7] = new OracleParameter("p_sid_del_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _InventoryDoShedule.sid_del_line;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int16, null, ParameterDirection.Output);
            effects = UpdateRecords("SP_update_InventoryDoShedule", CommandType.StoredProcedure, param);

            return effects;
        }
        //ADDD BY THARANGA 2017/09/09
        public int Update_Approve_MRN(InventoryRequestItem _inventoryRequestItem, Int32 seq_no)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[31];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq_no;
            (param[1] = new OracleParameter("p_itri_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_line_no;
            if (_inventoryRequestItem.MasterItem != null)
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.MasterItem.Mi_cd;
            }
            else
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            }

            (param[3] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_itm_stus;
            (param[4] = new OracleParameter("p_itri_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_qty;
            (param[5] = new OracleParameter("p_itri_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_unit_price;
            (param[6] = new OracleParameter("p_itri_app_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_app_qty;
            (param[7] = new OracleParameter("p_itri_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_no;
            (param[8] = new OracleParameter("p_itri_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_note;
            (param[9] = new OracleParameter("p_itri_mitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            (param[10] = new OracleParameter("p_itri_mitm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_stus;
            (param[11] = new OracleParameter("p_itri_mqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mqty;
            (param[12] = new OracleParameter("p_itri_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_bqty;
            (param[13] = new OracleParameter("p_itri_itm_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.ITRI_ITM_COND;
            (param[14] = new OracleParameter("P_itri_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_job_no;//Add by Suneth 20-11-2014
            (param[15] = new OracleParameter("P_itri_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_job_line;//Add by Suneth 20-11-2014
            (param[16] = new OracleParameter("P_itri_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_com;
            (param[17] = new OracleParameter("P_itri_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_loc;
            (param[18] = new OracleParameter("P_itri_po_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_po_qty;
            (param[19] = new OracleParameter("P_itri_iss_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_issue_qty;
            (param[20] = new OracleParameter("P_itri_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_qty;
            (param[21] = new OracleParameter("P_itri_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_line;
            (param[22] = new OracleParameter("P_itri_cncl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_cncl_qty;
            (param[23] = new OracleParameter("P_itri_shop_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_shop_qty;
            (param[24] = new OracleParameter("P_itri_fd_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_fd_qty;
            (param[25] = new OracleParameter("P_itri_git_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_git_qty;
            (param[26] = new OracleParameter("P_itri_buffer", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_buffer;
            (param[27] = new OracleParameter("P_itri_advan_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_advan_qty;
            (param[28] = new OracleParameter("P_itri_base_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_base_req_no;//Add by Rukshan 19-12-2015
            (param[29] = new OracleParameter("P_itri_base_req_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_base_req_line;//Add by Rukshan 19-12-2015
            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_updateMRNrequestitem", CommandType.StoredProcedure, param);
            return rows_affected;
        }

        public DataTable Get_MRN_Ref(string _ref)
        {
            //(p_ref in NVARCHAR2,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[2];
            DataTable _dtResults = null;
            (param[0] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "sp_get_int_seq_no", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Add by lakshan 31Aug2017
        public InventoryRequestItem GetImpIntReqItmForDo(string _docNo, string _othDocNo, Int32 _othDocLine)
        {
            InventoryRequestItem _obj = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_itri_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othDocNo;
            (param[2] = new OracleParameter("p_itri_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _othDocLine;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_int_req_itm_for_do", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _obj = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.ConverterNew)[0];
            }
            return _obj;
        }
        //Udaya Collect Item vice max serial no for Barcode print
        public Int32 getItemMaxSerial(mst_itm_max_serNo serDtl)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_itm_cd;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_com_cd;
            (param[2] = new OracleParameter("p_lstNo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = serDtl.mims_ser_inc_no;
            (param[3] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_prefix;
            (param[4] = new OracleParameter("p_creBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_cre_by;
            (param[5] = new OracleParameter("p_creDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = serDtl.mims_cre_dt;
            (param[6] = new OracleParameter("p_ModBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_mod_by;
            (param[7] = new OracleParameter("p_ModDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = serDtl.mims_mod_dt;
            (param[8] = new OracleParameter("p_creSessId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_cre_session_id;
            (param[9] = new OracleParameter("p_modSessId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serDtl.mims_mod_session_id;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("PICK_ITEM_SER_UPDATE", CommandType.StoredProcedure, param);
            return effects;
        }
        public mst_itm_max_serNo ItemSerialNo(string itmCd, string comCd)
        {
            mst_itm_max_serNo _obj = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
            (param[1] = new OracleParameter("p_comCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCd;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_ItemSerial", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _obj = DataTableExtensions.ToGenericList<mst_itm_max_serNo>(_dtResults, mst_itm_max_serNo.Converter)[0];
            }
            return _obj;
        }

        //by akila 2017/09/16
        public DataTable SerialAgeReport_AdminTeamAllLocation(DateTime in_AsatDate, string in_user_id, string in_Company, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_model, string in_itemsStatus, Int32 in_fromage, Int32 in_toage, Int32 in_iscomage)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asAtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_AsatDate;
            (param[2] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[3] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
            (param[9] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
            (param[10] = new OracleParameter("in_itemsStatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_itemsStatus;
            //(param[11] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
            (param[11] = new OracleParameter("in_fromage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_fromage;
            (param[12] = new OracleParameter("in_toage", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_toage;
            (param[13] = new OracleParameter("in_is_com_age", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_iscomage;

            DataTable _dtResults = QueryDataTable("tbl", "pkg_inv_reports.PROC_SER_AGE_RPT_ADMIN_ALLLOC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCurrentComAgeDetails_SerialsAllLoc(string _com, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan)
        {
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[3] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[5] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_curr_age_ser_AllLoc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //by akila 2017/09/18
        public DataTable GetCurrentComAgeGIT_SerialAllLoc(string _com, string _itemcat1, string _itemcat2, string _itemcode, string _brand, string _model, string _brndMan, DateTime _inDt)
        {
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[3] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[5] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("in_brnd_man", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brndMan;
            (param[8] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inDt;

            DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_get_com_agegit_serAllLoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Add by Lakshan 18Sep2017
        public DataTable GetItemInventoryBalanceStatus_RESNew(string _company, string _location, string _item, string _status)
        {
            //sp_invbalancestatus(p_com in NVARCHAR2,p_loc in NVARCHAR2 ,p_item in NVARCHAR2,p_status in NVARCHAR2,c_data OUT sys_refcursor)

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_resinvbalancestatusweb", CommandType.StoredProcedure, false, param);

            return _tblBalance;
        }
        //Add by Lakshan 19Sep2017
        public List<InventoryBatchN> Get_Scm_Int_Batch(string _doc)
        {
            List<InventoryBatchN> _reptPickBatch = new List<InventoryBatchN>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tblSerial", "SP_GET_SCM_BATCH_BY_DOC", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                _reptPickBatch = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter);
            }
            return _reptPickBatch;
        }
        //Added By Udaya 21.09.2017
        public List<InventoryRequest> GET_SOA_REQ_DATA_FOR_DO(string _com, string _type, string _do)//GET_SOA_REQ_DATA_FOR_INVOICE
        {
            List<InventoryRequest> _list = new List<InventoryRequest>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("P_DONO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _do;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl_int_req", "SP_GET_SOA_DATA_FOR_DO", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.ConverterDO);
            }
            return _list;
        }

        //by akila 2017/09/20
        public DataTable GetRootSchedules(string _comCode, string locCode, DateTime _schDate)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_Com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_Loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = locCode;
            (param[2] = new OracleParameter("p_SchDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _schDate.Date;

            param[3] = new OracleParameter("o_Date", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tmpRepSer", "SP_GET_ROOT_SCHED", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Added By Udaya 23.09.2017
        public DataTable GetBOQDetails(string _boqNo, DateTime p_from_date, DateTime p_to_date, string p_proCnt, string p_customer, string p_subContractor, string p_com)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_boqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _boqNo;
            (param[1] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from_date;
            (param[2] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to_date;
            (param[3] = new OracleParameter("p_proCnt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_proCnt;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_customer;
            (param[5] = new OracleParameter("p_subContractor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_subContractor;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblBOQ", "SP_GET_BOQ_DATA", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GetBOQDetails_Temp(string _boqNo, DateTime p_from_date, DateTime p_to_date, string p_proCnt, string p_customer, string p_subContractor, string p_com)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_boqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _boqNo;
            (param[1] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from_date;
            (param[2] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to_date;
            (param[3] = new OracleParameter("p_proCnt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_proCnt;
            (param[4] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_customer;
            (param[5] = new OracleParameter("p_subContractor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_subContractor;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblBOQ", "SP_GET_BOQ_DATA_TEMP", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public InvoiceHeader GetInvoiceDetailForPdaSrn(string invoiceNo, string pc, string com)
        {
            try
            {
                InvoiceHeader invHed = new InvoiceHeader();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;

                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _dtResults = QueryDataTable("hdr", "SP_GET_INVOICEDETFORSRNPDA", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    invHed = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResults, InvoiceHeader.ConvertTotal)[0];
                }
                return invHed;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public List<InvoiceItem> GetInvoiceItemDetailForPdaSrn(string invoiceNo, string pc, string com)
        {
            try
            {
                List<InvoiceItem> invDET = new List<InvoiceItem>();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;

                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _dtResults = QueryDataTable("itm", "SP_GET_INVOICEITEMFORSRNPDA", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    invDET = DataTableExtensions.ToGenericList<InvoiceItem>(_dtResults, InvoiceItem.ConvertInvoiceItem);
                }
                return invDET;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public InvoiceHeader GetInvoiceDetailForPdaDO(string invoiceNo, string com)
        {
            try
            {
                InvoiceHeader invHed = new InvoiceHeader();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;

                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _dtResults = QueryDataTable("hdr", "SP_GET_INVOICEDETFORDOPDA", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    invHed = DataTableExtensions.ToGenericList<InvoiceHeader>(_dtResults, InvoiceHeader.ConvertTotal)[0];
                }
                return invHed;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Add by lakshan 25Sep2017
        public List<InventoryLocation> GetItemInventoryBalanceRes(string _company, string _location, string _item, string _status)
        {
            List<InventoryLocation> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBalance = QueryDataTable("_tblBalance", "sp_inventorybalanceres", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryLocation>(_tblBalance, InventoryLocation.ConvertTotal);
            }
            return _list;
        }

        public DataTable getSRNItemLineno(int userseq, string itmCd, string stus)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_usrseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = userseq;
                (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
                (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
                DataTable _tblBalance = QueryDataTable("_tblBalance", "pkg_pda.SP_GET_SRNLINENUMBER", CommandType.StoredProcedure, false, param);

                return _tblBalance;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public DataTable GetBOQBaseAOD(string _jobNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_jobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblBOQBaseAOD", "SP_GET_BOQ_BASE_AOD", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Lakshan 12 APr 2016
        public Int32 Save_Int_Transport(Transport _obj)
        {

            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_itrn_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.Itrn_seq;
            (param[1] = new OracleParameter("p_itrn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_com;
            (param[2] = new OracleParameter("p_itrn_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_loc;
            (param[3] = new OracleParameter("p_itrn_trns_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_no;
            (param[4] = new OracleParameter("p_itrn_ref_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_ref_doc;
            (param[5] = new OracleParameter("p_itrn_trns_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_method;
            (param[6] = new OracleParameter("p_itrn_trns_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_pty_tp;
            (param[7] = new OracleParameter("p_itrn_trns_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_trns_pty_cd;
            (param[8] = new OracleParameter("p_itrn_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_ref_no;
            (param[9] = new OracleParameter("p_itrn_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_rmk;
            (param[10] = new OracleParameter("p_itrn_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_stus;
            (param[11] = new OracleParameter("p_itrn_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_cre_by;
            (param[12] = new OracleParameter("p_itrn_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Itrn_cre_dt;
            (param[13] = new OracleParameter("p_itrn_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_cre_session;
            (param[14] = new OracleParameter("p_itrn_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_mod_by;
            (param[15] = new OracleParameter("p_itrn_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Itrn_mod_dt;
            (param[16] = new OracleParameter("p_itrn_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_mod_session;
            (param[17] = new OracleParameter("p_itrn_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_anal1;
            (param[18] = new OracleParameter("p_itrn_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Itrn_anal2;
            (param[19] = new OracleParameter("p_itrn_isactive", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.itrn_isactive; // add by akila 2017/07/18
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_general.sp_save_int_transport", CommandType.StoredProcedure, param);

            return effects;
        }
        public DataTable Get_canibaliseData(string _docNo, string _comCode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblcanibaliseD", "GET_CANIBALISE", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable CourierDaillySummary(DateTime _fromdate, DateTime _todate, string in_Company, string _loc, string in_user_id, string _FromNo, string _ToNo, string _courCom)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_frmDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[1] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_userId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
            (param[5] = new OracleParameter("p_fromNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _FromNo;
            (param[6] = new OracleParameter("p_toNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ToNo;
            (param[7] = new OracleParameter("p_courCom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _courCom;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblCourierDaSum", "SP_GET_COURIER_DTL", CommandType.StoredProcedure, false, param);
          
            
            return _result;
        }
        public DataTable get_PickPlan_InrBatchData(string in_Company, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblinrBatch", "sp_getInrBatch", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Add by Lakshan 09Oct2017
        public List<MasterItem> GetItemListByModel(string _model)
        {
            List<MasterItem> _itemList = new List<MasterItem>();
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _itemTable = QueryDataTable("tblItem", "sp_get_item_by_model", CommandType.StoredProcedure, false, _para);
            if (_itemTable.Rows.Count > 0)
            {
                _itemList = DataTableExtensions.ToGenericList<MasterItem>(_itemTable, MasterItem.ConvertTotal);
            }
            return _itemList;
        }
        //Add by lakshan 11Oct2017
        public Int32 UpdateRequestItemBalanceByBaseLine(string _request, string _company, string _location, string _item, string _itemstatus, decimal _qty, string _docstatus, string _user, Int32 _lineNo)
        {
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _request;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _location;
            (param[3] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[4] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemstatus;
            (param[5] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[6] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docstatus;
            (param[7] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[8] = new OracleParameter("p_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lineNo;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_update_req_itm_by_base_line", CommandType.StoredProcedure, param);
            return _effect;
        }

        // THARANGA 2017/10/07
        public DataTable GetRCCbyNoTableNEW(string _rcc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcc;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRcc", "SP_GET_RCC_BY_NONEW", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getDocumentDetails(string docno, string doctp=null)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblinrBatch", "SP_GET_TEMPDOCUMTDETAILS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Add by Lakshan 19Oct2017
        public List<ReptPickSerials> SearchSerialForJobItemAOD(string _com, string _loc, string _itm, string _itmSts, string _jobNo, int _jobLine)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ins_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ins_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_ins_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[3] = new OracleParameter("p_ins_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmSts;
            (param[4] = new OracleParameter("p_inb_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobNo;
            (param[5] = new OracleParameter("p_inb_base_refline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _jobLine;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_search_serials_for_job_base", CommandType.StoredProcedure, false, param);
            List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
            foreach (DataRow tr in dt.Rows)
            {
                serial_list.Add(SetReptPickSerials(tr));
            }
            return serial_list;
        }
        //Written By P.Wijetunge on 02/04/2012
        public bool SaveWarrantyDetailWithWarrSts(InventoryWarrantyDetail _inventoryWarrantyDetail)
        {
            //Get the copy from SaveWarrantyDetailWithWarr by lakshan 26Oct2017
            #region add by lakshan 28jun2017
            MasterItem _itm = GetItemMaster(_inventoryWarrantyDetail.Irsm_itm_cd);
            if (_itm != null)
            {
                _inventoryWarrantyDetail.Irsm_itm_brand = _itm.Mi_brand;
                _inventoryWarrantyDetail.Irsm_itm_desc = _itm.Mi_shortdesc;
                _inventoryWarrantyDetail.Irsm_itm_model = _itm.Mi_model;
            }
            #endregion
            OracleParameter[] param = new OracleParameter[66];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_acc_no;
            (param[1] = new OracleParameter("p_anal_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_1;
            (param[2] = new OracleParameter("p_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_2;
            (param[3] = new OracleParameter("p_anal_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_3;
            (param[4] = new OracleParameter("p_anal_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_4;
            (param[5] = new OracleParameter("p_anal_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_anal_5;
            (param[6] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_channel;
            (param[7] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_com;
            (param[8] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cre_by;
            (param[9] = new OracleParameter("p_cre_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cre_when;
            (param[10] = new OracleParameter("p_cust_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_addr;
            (param[11] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_cd;
            (param[12] = new OracleParameter("p_cust_del_addr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_del_addr;
            (param[13] = new OracleParameter("p_cust_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_email;
            (param[14] = new OracleParameter("p_cust_fax", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_fax;
            (param[15] = new OracleParameter("p_cust_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_mobile;
            (param[16] = new OracleParameter("p_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_name;
            (param[17] = new OracleParameter("p_cust_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_prefix;
            (param[18] = new OracleParameter("p_cust_tel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_tel;
            (param[19] = new OracleParameter("p_cust_town", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_town;
            (param[20] = new OracleParameter("p_cust_vat_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_cust_vat_no;
            (param[21] = new OracleParameter("p_direct", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_direct;
            (param[22] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_doc_dt;
            (param[23] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_doc_no;
            (param[24] = new OracleParameter("p_doc_year", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_doc_year;
            (param[25] = new OracleParameter("p_exist_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_grn_com;
            (param[26] = new OracleParameter("p_exist_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_grn_dt;
            (param[27] = new OracleParameter("p_exist_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_grn_no;
            (param[28] = new OracleParameter("p_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_exist_supp;
            (param[29] = new OracleParameter("p_invoice_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_invoice_dt;
            (param[30] = new OracleParameter("p_invoice_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_invoice_no;
            (param[31] = new OracleParameter("p_itm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_brand;
            (param[32] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_cd;
            (param[33] = new OracleParameter("p_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_desc;
            (param[34] = new OracleParameter("p_itm_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_model;
            (param[35] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_itm_stus;
            (param[36] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_loc;
            (param[37] = new OracleParameter("p_loc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_loc_desc;
            (param[38] = new OracleParameter("p_mfc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_mfc;
            (param[39] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_mod_by;
            (param[40] = new OracleParameter("p_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_mod_when;
            (param[41] = new OracleParameter("p_orig_grn_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_grn_com;
            (param[42] = new OracleParameter("p_orig_grn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_grn_dt;
            (param[43] = new OracleParameter("p_orig_grn_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_grn_no;
            (param[44] = new OracleParameter("p_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_orig_supp;
            (param[45] = new OracleParameter("p_sbu", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_sbu;
            (param[46] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_1;
            (param[47] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_2;
            (param[48] = new OracleParameter("p_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_3;
            (param[49] = new OracleParameter("p_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_4;
            (param[50] = new OracleParameter("p_ser_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_ser_id;
            (param[51] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_session_id;
            (param[52] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_unit_cost;
            (param[53] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_unit_price;
            (param[54] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_no;
            (param[55] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_period;
            (param[56] = new OracleParameter("p_warr_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_rem;
            (param[57] = new OracleParameter("p_warr_start_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_start_dt;
            (param[58] = new OracleParameter("p_warr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.Irsm_warr_stus;

            //Sahan
            (param[59] = new OracleParameter("p_irsm_sys_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_SYS_BLNO;
            (param[60] = new OracleParameter("p_irsm_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_BLNO;
            (param[61] = new OracleParameter("p_irsm_bl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_BL_DT;
            (param[62] = new OracleParameter("p_irsm_sys_fin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_SYS_FIN_NO;
            (param[63] = new OracleParameter("p_irsm_fin_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_FIN_NO;
            (param[64] = new OracleParameter("p_irsm_fin_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryWarrantyDetail.IRSM_FIN_DT;

            param[65] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_update_inr_sermst_sts", CommandType.StoredProcedure, param);
            return effects >= 1 ? true : false;
        }
        //add by tharanga 2017/10/23
        public int Update_Warranty_sts(string p_itm, Decimal p_serid, string p_serial_no, string p_warr_status, string p_warr_no)
        {


            //sp_updatewarrantydetail(p_oldwarranty in NVARCHAR2,p_do in NVARCHAR2,p_date in DATE,p_newwarranty in NVARCHAR2,o_effect out NUMBER) is
            int rows_effected = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itm;
            (param[1] = new OracleParameter("p_serid", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = p_serid;
            (param[2] = new OracleParameter("p_serial_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_serial_no;
            (param[3] = new OracleParameter("p_warr_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_warr_status;
            (param[4] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_warr_no;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_effected = UpdateRecords("sp_update_war_stas", CommandType.StoredProcedure, param);
            return rows_effected;
        }
        //Udaya Get courier details 25.Oct.2017
        public InventoryHeader GetINTHDR_Details(String Com, String Doc, String Inv)
        {
            InventoryHeader oResult = new InventoryHeader();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[2] = new OracleParameter("P_INV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Inv;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblScan = QueryDataTable("tblINT_Hdr", "SP_GET_DOC_INV", CommandType.StoredProcedure, false, param);

            if (_tblScan.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<InventoryHeader>(_tblScan, InventoryHeader.ConvertTotal)[0];
            }
            return oResult;
        }
        public decimal get_buffer_qty(string p_itm, string p_chnl, string p_grade, Int32 p_date, Int32 p_mont)
        {
            decimal _price = -1;
            DataTable _dt = null;


            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itm;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_chnl;
            (param[2] = new OracleParameter("p_grade", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_grade;
            (param[3] = new OracleParameter("p_date", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_date;
            (param[4] = new OracleParameter("p_mont", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_mont;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dt = QueryDataTable("tbl", "SP_get_buffer_qty", CommandType.StoredProcedure, false, param);
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    foreach (DataRow dr in _dt.Rows)
                    {
                        _price = Convert.ToDecimal(dr["B_QTY"]);
                        break;
                    }
                }
            }

            return _price;
        }
        // add by tharanga 2017/10/30
        public DataTable GET_shpmnet_Hdr(string p_com, DateTime p_frmdate, DateTime P_todate, string p_type, string p_stus, string doc_no)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_frmdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_frmdate;
            (param[2] = new OracleParameter("P_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = P_todate;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
            (param[4] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_stus;
            (param[5] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_no;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblinrBatch", "SP_GET_shpmnet_Hdr", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GET_shpmnet_Detail(string p_doc_no)//add by tharanga 2017/10/30
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_doc_no;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblinrBatch", "SP_GET_shpmnet_detail", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public decimal GET_ICE_ACTL_RT(Int32 p_seq, Int32 p_ref_line)
        {
            decimal _price = -1;
            DataTable _dt = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_seq;
            (param[1] = new OracleParameter("p_ref_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ref_line;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dt = QueryDataTable("tbl", "GET_ICE_ACTL_RT", CommandType.StoredProcedure, false, param);
            if (_dt != null)
            {
                if (_dt.Rows.Count > 0)
                {
                    foreach (DataRow dr in _dt.Rows)
                    {
                        _price = Convert.ToDecimal(dr["ICE_ACTL_RT"]);
                        break;
                    }
                }
            }

            return _price;
        }
        //Add by lakshan 30Oct2017
        public List<DisposalHeader> GET_DISPOSAL_JOBS_DATA(DisposalHeader oFilter)
        {
            List<DisposalHeader> oResult = new List<DisposalHeader>();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_dh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_com;
            (param[1] = new OracleParameter("p_dh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_stus;
            (param[2] = new OracleParameter("p_dh_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_pc;
            (param[3] = new OracleParameter("p_dh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oFilter.Dh_doc_no;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = oFilter.Dh_frm_dt;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = oFilter.Dh_to_dt;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_get_disposal_jobs_data", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<DisposalHeader>(dt, DisposalHeader.Converter);
            return oResult;
        }

        //Add by Lakshan 31Oct2017
        public Int32 SAVE_DISPOSAL_ITEMS_WEB(DisposalItem dispItm)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("P_IDD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_seq;
            (param[1] = new OracleParameter("P_IDD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_line;
            (param[2] = new OracleParameter("P_IDD_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_job_no;
            (param[3] = new OracleParameter("P_IDD_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_itm_cd;
            (param[4] = new OracleParameter("P_IDD_SER_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_id;
            (param[5] = new OracleParameter("P_IDD_SER_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_1;
            (param[6] = new OracleParameter("P_IDD_SER_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_2;
            (param[7] = new OracleParameter("P_IDD_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_stus;
            (param[8] = new OracleParameter("P_IDD_CUR_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_cur_loc;
            (param[9] = new OracleParameter("P_IDD_DISP_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_disp_loc;
            (param[10] = new OracleParameter("P_IDD_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_act;
            (param[11] = new OracleParameter("P_IDD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_cre_by;
            (param[12] = new OracleParameter("P_IDD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = dispItm.Idd_cre_dt;
            (param[13] = new OracleParameter("P_IDD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_mod_by;
            (param[14] = new OracleParameter("P_IDD_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = dispItm.Idd_mod_dt;
            (param[15] = new OracleParameter("P_IDD_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dispItm.Idd_qty;
            (param[16] = new OracleParameter("P_IDD_BIN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_bin_cd;
            (param[17] = new OracleParameter("P_IDD_BASE_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dispItm.Idd_base_Seq;
            (param[18] = new OracleParameter("P_IDD_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dispItm.Idd_bqty;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("sp_save_disp_itm_web", CommandType.StoredProcedure, param);
            return result;
        }
        //Add by lakshan 06Nov2017
        public Int32 UPDATE_DISPOSAL_ITEMS_WEB(DisposalItem dispItm)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_IDD_JOB_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_job_no;
            (param[1] = new OracleParameter("P_IDD_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_itm_cd;
            (param[2] = new OracleParameter("P_IDD_SER_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_ser_1;
            (param[3] = new OracleParameter("P_IDD_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_stus;
            (param[4] = new OracleParameter("P_IDD_CUR_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_cur_loc;
            (param[5] = new OracleParameter("P_IDD_DISP_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_disp_loc;
            (param[6] = new OracleParameter("P_IDD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_mod_by;
            (param[7] = new OracleParameter("P_IDD_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = dispItm.Idd_mod_dt;
            (param[8] = new OracleParameter("P_IDD_BIN_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dispItm.Idd_bin_cd;
            (param[9] = new OracleParameter("P_DISP_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dispItm.TMP_idd_res_qty;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("sp_updat_disp_itm_web", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharindu 2017/11/11
        public DataTable GetSGRANDetails_Execl_Data(string _user, DateTime _fromDate, DateTime _toDate, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _doctype, string _reptpdesc, string _root)
        {
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("IN_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("IN_DOCTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            (param[5] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[7] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[8] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[9] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[10] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[11] = new OracleParameter("in_reptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reptpdesc;
            (param[12] = new OracleParameter("_root", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _root;

            DataTable _tblData = QueryDataTable("tbData", "sp_get_gran_details_execl", CommandType.StoredProcedure, false, param);
            return _tblData;
        }



       

        public DataTable GetWarrRangeRmk(string com, string item, string _sup)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("P_SUPPL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sup;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_GET_SUPITMWARR", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        //add by lakshan 06Nov2017
        public Int32 UpdateGrnIsInProgress(string _poNo, string _user, Int32 _isOnWp)
        {
            Int32 result = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_poh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _poNo;
            (param[1] = new OracleParameter("p_poh_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isOnWp;
            (param[2] = new OracleParameter("p_poh_wp_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            result = UpdateRecords("sp_updat_pur_hdr_wp", CommandType.StoredProcedure, param);
            return result;
        }
        //Add by lakshan 07Nov2017
        public PurchaseOrder GET_PUR_HDR_DATA(string _com, string _doc)
        {
            PurchaseOrder _dom = new PurchaseOrder();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_poh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_poh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("pur_hdr", "sp_get_pur_hdr_data", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                _dom = DataTableExtensions.ToGenericList<PurchaseOrder>(dt, PurchaseOrder.ConvertNew)[0];
            }
            return _dom;
        }
        public Int32 UPDATE_INR_RES_DET_WITHSI(INR_RES_DET _obj)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_RES_NO;
            (param[1] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRD_RES_BQTY;
            (param[2] = new OracleParameter("p_si_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRD_SI_NO;
            (param[3] = new OracleParameter("p_si_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRD_SI_LINE;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_inr_res_detsiline", CommandType.StoredProcedure, param);
            return result;
        }
        public List<GRAN_ALWSTUS> GET_GRAN_ALWSTUS(string p_com, string p_cat, string p_stus, string p_new_stus)//add by tharanga 2017/11/11
        {
            List<GRAN_ALWSTUS> oResult = new List<GRAN_ALWSTUS>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat;
            (param[2] = new OracleParameter("p_cur_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_stus;
            (param[3] = new OracleParameter("p_new_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_new_stus;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_GRAN_ALWSTUS", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<GRAN_ALWSTUS>(dt, GRAN_ALWSTUS.Converter);
            return oResult;
        }
        public DataTable SPGETLOCTMCAT(string mli_com, string mli_loc_cd, string mli_cat_1, string mli_itm_stus, string mli_tp, string _frmstus)
        {//Tharanga 2017/11/11
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("mli_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mli_com;
            (param[1] = new OracleParameter("mli_loc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mli_loc_cd;
            (param[2] = new OracleParameter("mli_cat_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mli_cat_1;
            (param[3] = new OracleParameter("mli_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mli_itm_stus;
            (param[4] = new OracleParameter("mli_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mli_tp;
            (param[5] = new OracleParameter("p_frmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _frmstus;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_LOC_ITMCAT", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //akila 2017/11/16
        public decimal GetSerialUnitCostForExchange(string _docNo, string _itemCode)
        {
            OracleParameter[] param = new OracleParameter[3];
            DataTable dt = new DataTable();
            decimal _cost = 0;

            (param[0] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            
            dt = QueryDataTable("tbl", "SP_GET_SERCOST_FOR_EXCHANGE", CommandType.StoredProcedure, false, param);

            if (dt.Rows.Count > 0)
            {
                decimal.TryParse(dt.Rows[0].Field<decimal>("unit_cost").ToString(), out _cost);
            }
            return _cost;
        }

        public DataTable Getser_inr_sermst(string _ser)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_GET_SER_DET", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }

        // Tharindu 2017-11-24
        public Int32 SaveWarehouseItem(List<WarehseItemSetup> _lstWarehouse)
        {
            Int32 effects = 0;
            foreach (WarehseItemSetup _item in _lstWarehouse)
            {
                OracleParameter[] param = new OracleParameter[12];

                (param[0] = new OracleParameter("p_mli_com,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.company;
                (param[1] = new OracleParameter("p_mli_loc_cd,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.location;
                (param[2] = new OracleParameter("p_mli_cat_1,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemCat1;
                (param[3] = new OracleParameter("p_mli_cat_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemCat2;
                (param[4] = new OracleParameter("p_mli_cat_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemCat3;
                (param[5] = new OracleParameter("P_mli_brd,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.brand;
                (param[6] = new OracleParameter("p_mli_act,", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.activeStatus;
                (param[7] = new OracleParameter("p_mli_cre_by,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.createuser;
                (param[8] = new OracleParameter("p_mli_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.tostatus;
                (param[9] = new OracleParameter("p_mli_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.definitionType;
                (param[10] = new OracleParameter("p_mli_frm_itmstus,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemStatus;
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_insert_wh_item_setup", CommandType.StoredProcedure, param);

            }

            return effects;
        }



        public DataTable Get_WarehouseItem(string profcenter, string loc, string itmcat1, string brand, string deftype)
        {
         
            DataTable dt_result = new DataTable();

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("P_prfitcenter,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profcenter;
            (param[1] = new OracleParameter("p_location,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("P_itemcat,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcat1;
            (param[3] = new OracleParameter("P_brand,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
            (param[4] = new OracleParameter("P_def_type,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = deftype;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt_result = QueryDataTable("dt", "sp_get_wh_items", CommandType.StoredProcedure, false, param);
            return dt_result;
        }

        // Tharindu 2017-12-05
        public DataTable Get_Description(string code)
        {
            DataTable dt_result = new DataTable();

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_execute_id,", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[1] = new OracleParameter("P_rct_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt_result = QueryDataTable("dt", "sp_ref_cond_tp", CommandType.StoredProcedure, false, param);
            return dt_result;
        }

        // Tharindu 2017-12-05
        public DataTable Get_Product_refernce(string code,string cat1,string cat2,string cat3,string profcenter,int id)
        {
            DataTable dt_result = new DataTable();

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_execute_id,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = id;
            (param[1] = new OracleParameter("P_rct_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("p_cat1,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[3] = new OracleParameter("p_cat2,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat2;
            (param[4] = new OracleParameter("p_cat3,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat3;
            (param[5] = new OracleParameter("prfitcnter,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = profcenter;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            dt_result = QueryDataTable("dt", "sp_ref_cond_tp", CommandType.StoredProcedure, false, param);
            return dt_result;
        }

        // Tharindu 2017-12-05
        public Int32 SaveProductRefernce(List<Production_ref> _lstProductref)
        {
            Int32 effects = 0;
            foreach (Production_ref _item in _lstProductref)
            {
                OracleParameter[] param = new OracleParameter[11];

                (param[0] = new OracleParameter("p_rct_com,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.company;
                (param[1] = new OracleParameter("p_rct_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.code;
                (param[2] = new OracleParameter("p_rct_desc,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.description;
                (param[3] = new OracleParameter("p_rct_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.isactive;
                (param[4] = new OracleParameter("p_rct_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.createuser;
                (param[5] = new OracleParameter("p_rct_cat1,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemCat1;
                (param[6] = new OracleParameter("p_rct_cat2,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemCat2;
                (param[7] = new OracleParameter("p_rct_cha,", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.charge;
                (param[8] = new OracleParameter("p_rct_ini", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.intialsetup;
                (param[9] = new OracleParameter("p_rct_cat3,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.itemCat3;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_insert_ref_cond", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        public DataTable Get_gp_report(string _com, string _pc, DateTime _frmDate, DateTime _todate, string _itm_cat1, string _itm_cat2, string _exec_cd, string _cust_cd, string _itm_cd, string _brand, string _model, string _itm_cat3, string _itm_cat4, string _itm_cat5)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_frmdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("p_itm_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cat1;
            (param[5] = new OracleParameter("p_itm_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cat2;
            (param[6] = new OracleParameter("p_exec_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _exec_cd;
            (param[7] = new OracleParameter("p_cust_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust_cd;
            (param[8] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cd;
            (param[9] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_itm_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cat3;
            (param[12] = new OracleParameter("p_itm_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cat4;
            (param[13] = new OracleParameter("p_itm_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cat5;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "sp_get_gp_report_win_new", CommandType.StoredProcedure, false, param);
            //_SlsCon = QueryDataTable("DT", "sp_get_gp_report_win", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        public DataTable Getser_int_ser(string _com, string _loc, string _itm_cd, string _itm_ser)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_cd;
            (param[3] = new OracleParameter("p_itm_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_ser;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "sp_get_itm_ser", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }

        public List<InventoryBatchRefN> getItemBalanceQty(string company, string location, string itmcode, string status)
        {
            List<InventoryBatchRefN> dta = new List<InventoryBatchRefN>();
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
            (param[2] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcode;
            (param[3] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "sp_get_item_stocqty", CommandType.StoredProcedure, false, param);
            if (_SlsCon.Rows.Count > 0)
            {
                dta = DataTableExtensions.ToGenericList<InventoryBatchRefN>(_SlsCon, InventoryBatchRefN.Converter);
            }
            return dta;
        }

        public Int32 SavePickedItemSerialsAdjExcel(ReptPickSerials _scanserNew)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[54];
                (param[0] = new OracleParameter("p_usrseq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_usrseq_no;
                (param[1] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_doc_no;
                (param[2] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_seq_no;
                (param[3] = new OracleParameter("p_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_line;
                (param[4] = new OracleParameter("p_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_batch_line;
                (param[5] = new OracleParameter("p_ser_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_line;
                (param[6] = new OracleParameter("p_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_doc_dt.Date;
                (param[7] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_com;
                (param[8] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_loc;
                (param[9] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_bin;
                (param[10] = new OracleParameter("p_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_cd;
                (param[11] = new OracleParameter("p_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_stus;
                (param[12] = new OracleParameter("p_unit_cost", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_unit_cost;
                (param[13] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_qty;
                (param[14] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_id;
                (param[15] = new OracleParameter("p_ser_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = (!String.IsNullOrEmpty(_scanserNew.Tus_ser_1)) ? _scanserNew.Tus_ser_1 : "N/A";
                (param[16] = new OracleParameter("p_ser_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_2;
                (param[17] = new OracleParameter("p_ser_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_3;
                (param[18] = new OracleParameter("p_ser_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_4;
                (param[19] = new OracleParameter("p_warr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_warr_no;
                (param[20] = new OracleParameter("p_warr_period", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_warr_period;
                (param[21] = new OracleParameter("p_orig_grncom ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_grncom;
                (param[22] = new OracleParameter("p_orig_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_grnno;
                (param[23] = new OracleParameter("p_orig_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_grndt;
                (param[24] = new OracleParameter("p_orig_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_orig_supp;
                (param[25] = new OracleParameter("p_exist_grncom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_grncom;
                (param[26] = new OracleParameter("p_exist_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_grnno;
                (param[27] = new OracleParameter("p_exist_grndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_grndt;
                (param[28] = new OracleParameter("p_exist_supp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exist_supp;
                (param[29] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_cre_by;
                (param[30] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_session_id;
                (param[31] = new OracleParameter("p_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_unit_price;
                (param[32] = new OracleParameter("p_new_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_new_status;
                (param[33] = new OracleParameter("p_base_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_base_doc_no;
                (param[34] = new OracleParameter("p_base_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_base_itm_line;
                (param[35] = new OracleParameter("p_itm_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_desc;
                (param[36] = new OracleParameter("p_itm_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_model;
                (param[37] = new OracleParameter("p_itm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_itm_brand;
                (param[38] = new OracleParameter("p_ser_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ser_remarks;
                (param[39] = new OracleParameter("p_resqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_resqty;
                (param[40] = new OracleParameter("p_ageloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ageloc;
                (param[41] = new OracleParameter("p_ageloc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_ageloc_dt.Date;
                (param[42] = new OracleParameter("p_isownmrn", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_isownmrn;

                (param[43] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_job_no;//Chamal 20-Jan-2015
                (param[44] = new OracleParameter("p_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_job_line;//Chamal 20-Jan-2015
                (param[45] = new OracleParameter("p_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_res_no;//Chamal 20-Jan-2015
                (param[46] = new OracleParameter("p_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _scanserNew.Tus_res_line;//Chamal 20-Jan-2015

                (param[47] = new OracleParameter("p_batch_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_batch_no;//kapila 4/7/2015
                (param[48] = new OracleParameter("p_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_exp_dt.Date;
                (param[49] = new OracleParameter("p_manufac_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _scanserNew.Tus_manufac_dt.Date;   //kapila 20/7/2015
                (param[50] = new OracleParameter("p_tus_new_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_new_itm_cd;   //kapila 20/7/2015
                (param[51] = new OracleParameter("p_tus_pkg_uom_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _scanserNew.Tus_pkg_uom_qty;   //kapila 20/7/2015
                (param[52] = new OracleParameter("p_tus_pkg_uom_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scanserNew.Tus_pkg_uom_tp;   //kapila 20/7/2015

                param[53] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 _eff = UpdateRecords("sp_picksernewnewAdjExl", CommandType.StoredProcedure, param);
                return _eff;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public MasterItemBlock GetBlockedItmBrand(string _company, string _profit, string _item_brand, int _pricetype, string _catTp, string _mib_cat1, string _mib_cat2)
        {
            //sp_getblockeditembytype(p_com in NVARCHAR2 ,p_profitcenter in NVARCHAR2,p_item in NVARCHAR2,p_pricetype in NUMBER,c_data out sys_refcursor)

            MasterItemBlock _list = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_profitcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profit;
            (param[2] = new OracleParameter("p_item_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item_brand;
            (param[3] = new OracleParameter("p_pricetype", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _pricetype;
            (param[4] = new OracleParameter("p_cattp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catTp;
            (param[5] = new OracleParameter("p_mib_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mib_cat1;
            (param[6] = new OracleParameter("p_mib_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mib_cat2;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getblocked_model", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
                _list = DataTableExtensions.ToGenericList<MasterItemBlock>(_dtResults, MasterItemBlock.Converter)[0];

            return _list;
        }
        public List<GRAN_ALWSTUS> GET_GRAN_ALWSTUS_MORE_CON(string p_com, string p_cat, string p_stus, string p_new_stus, string p_cat1, string p_cat2, string p_cat3)//add by tharanga 2018/01/04
        {
            List<GRAN_ALWSTUS> oResult = new List<GRAN_ALWSTUS>();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat;
            (param[2] = new OracleParameter("p_cur_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_stus;
            (param[3] = new OracleParameter("p_new_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_new_stus;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat3;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "SP_GET_GRAN_ALWSTUS_MORE_CON", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<GRAN_ALWSTUS>(dt, GRAN_ALWSTUS.Converter);
            return oResult;
        }
        //subodana
        public string GetCaniMainItem(string doc, string loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_CanibMainitem", CommandType.StoredProcedure, false, param);
            string ITEM = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                ITEM = _dtResults.Rows[0][0].ToString();
            }
            return ITEM;
        }
        //subodana
        public string GetCaniMainSer(string doc, string loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_CanibMainser", CommandType.StoredProcedure, false, param);
            string ser = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                ser = _dtResults.Rows[0][0].ToString();
            }
            return ser;
        }
        public bool check_qty_inv_balance(string p_job_no, string p_com, string p_loc, string p_pc)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_job_no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_check_sat_qty_inv_balance", CommandType.StoredProcedure, false, param);
            bool ser = false;
            decimal sad_qty = 0;
            decimal inb_qty = 0;

            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                if (_dtResults.Rows[0][0] != DBNull.Value && _dtResults.Rows[0][1] != DBNull.Value)
                {
                    sad_qty = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
                    inb_qty = Convert.ToDecimal(_dtResults.Rows[0][1].ToString());
                }
               
                if (sad_qty == inb_qty)
                {
                    ser = true;
                }
            }
            return ser;
        }

        public DataTable qty_inv_balance(string p_job_no, string p_com, string p_loc, string p_pc)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_job_no;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_check_sat_qty_inv_balance", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable dtServiceAgent(string _com, string _code)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_chk_ext_agt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //Lakshan 30Jan2018
        public List<InventoryBatchRefN> GET_INR_BATCH_BY_JOB_NO_PRO_ISSU(InventoryBatchRefN _obj)
        {
            List<InventoryBatchRefN> _list = new List<InventoryBatchRefN>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_com;
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_loc;
            (param[2] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_cd;
            (param[3] = new OracleParameter("p_inb_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_itm_stus;
            (param[4] = new OracleParameter("p_inb_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Inb_job_no;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("inr_batch", "sp_get_inr_batch_pro_issu", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<InventoryBatchRefN>(_dtResults, InventoryBatchRefN.Converter);
            }
            return _list;
        }

        //Tharindu 201-01-26
        public DataTable ImportScheduleReport_New(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_imp_schedule_hdr_New", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ImportScheduleGRNDtl_New(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_imp_schedule_grn_dt_New", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Get_ADD_Req_by_seq(string _company, string _user, string _reqTp, string _stus, DateTime _frmDt, DateTime _toDt, string _subTp, Int32 p_seq)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_reqTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqTp;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt.Date;
            (param[5] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt.Date;
            (param[6] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subTp;
            (param[7] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_seq;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_searcH_adjreq_by_seq", CommandType.StoredProcedure, false, param); ;
        }
        // Lakshan 02Feb2018
        public List<InventoryItem> GET_INT_ITM_DATA_BY_SEQNO(Int32 _seqNo)
        {
            List<InventoryItem> _list = new List<InventoryItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_its_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = new DataTable();
            if (_seqNo == 0)
            {
                return _list;
            }
            else
            {
                _dtResults = QueryDataTable("INT_ITM", "sp_get_int_itm_by_seq_no", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<InventoryItem>(_dtResults, InventoryItem.Convert2);
                }
            }
            return _list;
        }
        //Add by lakshan 06Feb2018
        public Int16 UpdateInrSerMstItemCode(Int32 _serId,string _itm,string _sessionId,string _modBy)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_irsm_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serId;
            (param[1] = new OracleParameter("p_irsm_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[2] = new OracleParameter("p_irsm_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessionId;
            (param[3] = new OracleParameter("p_irsm_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modBy;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_update_inr_sermst_itm", CommandType.StoredProcedure, param);
            return effects;
        }
        //add by tharanga 2018/02/07
        public List<ReptPickSerials> GetSerialForExchange(string _company, string _location, string _user, string _session, string _defBin, string _invoice, int _baseRefline)
        {
            List<ReptPickSerials> _list = new List<ReptPickSerials>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_invoiceno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //DataTable _tblData = QueryDataTable("tbData", "sp_getdoserialdetailforex_new", CommandType.StoredProcedure, false, param);
            DataTable _tblData = QueryDataTable("tbData", "GET_Cust_exchage_itm", CommandType.StoredProcedure, false, param);

            if (_tblData.Rows.Count > 0)
            {
                foreach (DataRow _row in _tblData.Rows)
                {
                    MasterItem _item = GetItem(_company, Convert.ToString(_row["ITB_ITM_CD"]));
                    ReptPickSerials _one = new ReptPickSerials();
                    if (_item.Mi_is_ser1 != -1)
                    {
                        _one.Tus_base_doc_no = _invoice;
                        if (_baseRefline == 0)
                        {
                            _one.Tus_base_itm_line = Convert.ToInt32(_row["itb_base_refline"]);
                        }
                        else
                        {
                            _one.Tus_base_itm_line = _baseRefline;
                        }
                        // _one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITS_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITS_SEQ_NO"]);
                        _one.Tus_cross_serline = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_doc_dt = System.DateTime.Now.Date;
                        _one.Tus_doc_no = Convert.ToString(_row["ITS_DOC_NO"]);
                        _one.Tus_exist_grncom = _row["ITS_EXIST_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNCOM"];
                        _one.Tus_exist_grnno = _row["ITS_EXIST_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_GRNNO"];
                        _one.Tus_exist_grndt = _row["ITS_EXIST_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_EXIST_GRNDT"];
                        _one.Tus_exist_supp = _row["ITS_EXIST_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_EXIST_SUPP"];
                        _one.Tus_itm_stus = (String)_row["ITS_ITM_STUS"];
                        //_one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_itm_brand = _item.Mi_brand;
                        _one.Tus_itm_cd = (String)_row["ITS_ITM_CD"];
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt16(_row["ITS_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_loc = _location;
                        _one.Tus_new_remarks = String.Empty;
                        _one.Tus_new_status = String.Empty;
                        _one.Tus_orig_grncom = _row["ITS_ORIG_GRNCOM"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNCOM"];
                        _one.Tus_orig_grndt = _row["ITS_ORIG_GRNDT"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["ITS_ORIG_GRNDT"];
                        _one.Tus_orig_grnno = _row["ITS_ORIG_GRNNO"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_GRNNO"];
                        _one.Tus_orig_supp = _row["ITS_ORIG_SUPP"] == DBNull.Value ? string.Empty : (String)_row["ITS_ORIG_SUPP"];
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = 1;
                        _one.Tus_seq_no = 0;
                        _one.Tus_ser_1 = _row["ITS_SER_1"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_1"];
                        _one.Tus_ser_2 = _row["ITS_SER_2"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_2"];
                        _one.Tus_ser_3 = _row["ITS_SER_3"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_3"];
                        _one.Tus_ser_4 = _row["ITS_SER_4"] == DBNull.Value ? string.Empty : (String)_row["ITS_SER_4"];
                        _one.Tus_ser_id = Convert.ToInt32(_row["ITS_SER_ID"]);
                        _one.Tus_ser_line = Convert.ToInt16(_row["ITS_SER_LINE"]);
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITS_UNIT_COST"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = _row["ITS_WARR_NO"] == DBNull.Value ? string.Empty : (String)_row["ITS_WARR_NO"];
                        _one.Tus_warr_period = Convert.ToInt16(_row["ITS_WARR_PERIOD"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["GRAD_VAL5"]);
                        _one.Tus_price_book = Convert.ToString(_row["grad_anal2"]);
                        _one.Tus_price_level = Convert.ToString(_row["grad_anal3"]);


                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = _row["its_fifo_dt"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["its_fifo_dt"];
                    }
                    else
                    {
                        _one.Tus_base_doc_no = _invoice;
                        if (_baseRefline == 0)
                        {
                            _one.Tus_base_itm_line = Convert.ToInt32(_row["itb_base_refline"]);
                        }
                        else
                        {
                            _one.Tus_base_itm_line = _baseRefline;
                        }

                        //_one.Tus_base_itm_line = _baseRefline;
                        _one.Tus_batch_line = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_bin = _defBin;
                        _one.Tus_com = _company;
                        _one.Tus_cre_by = _user;
                        _one.Tus_cre_dt = System.DateTime.Now;
                        _one.Tus_cross_batchline = Convert.ToInt16(_row["ITB_BATCH_LINE"]);
                        _one.Tus_cross_itemline = Convert.ToInt16(_row["ITB_ITM_LINE"]);
                        _one.Tus_cross_seqno = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_doc_no = Convert.ToString(_row["ITB_DOC_NO"]);
                        _one.Tus_exist_grncom = string.Empty;
                        _one.Tus_exist_grndt = DateTime.MaxValue;
                        _one.Tus_exist_grnno = string.Empty;
                        _one.Tus_exist_supp = string.Empty;
                        _one.Tus_itm_brand = _item.Mi_brand; ;
                        _one.Tus_itm_cd = Convert.ToString(_row["ITB_ITM_CD"]);
                        _one.Tus_itm_desc = _item.Mi_longdesc;
                        _one.Tus_itm_line = Convert.ToInt32(_row["ITB_ITM_LINE"]);
                        _one.Tus_itm_model = _item.Mi_model;
                        _one.Tus_itm_stus = Convert.ToString(_row["ITB_ITM_STUS"]);
                        _one.Tus_loc = Convert.ToString(_row["ITB_LOC"]);
                        _one.Tus_new_remarks = string.Empty;
                        _one.Tus_new_status = string.Empty;
                        _one.Tus_orig_grncom = string.Empty;
                        _one.Tus_orig_grndt = DateTime.MaxValue;
                        _one.Tus_orig_grnno = string.Empty;
                        _one.Tus_orig_supp = string.Empty;
                        _one.Tus_out_date = DateTime.Now.Date;
                        _one.Tus_qty = Convert.ToDecimal(_row["ITB_QTY"]);
                        _one.Tus_seq_no = Convert.ToInt32(_row["ITB_SEQ_NO"]);
                        _one.Tus_ser_1 = string.Empty;
                        _one.Tus_ser_2 = string.Empty;
                        _one.Tus_ser_3 = string.Empty;
                        _one.Tus_ser_4 = string.Empty;
                        _one.Tus_ser_id = -1;
                        _one.Tus_ser_line = -1;
                        _one.Tus_serial_id = "1";
                        _one.Tus_session_id = _session;
                        _one.Tus_unit_cost = Convert.ToDecimal(_row["ITB_UNIT_COST"]);
                        _one.Tus_unit_price = Convert.ToDecimal(_row["GRAD_VAL5"]);
                        //_one.Tus_unit_price = Convert.ToDecimal(_row["ITB_UNIT_PRICE"]);
                        _one.Tus_usrseq_no = -1;
                        _one.Tus_warr_no = string.Empty;
                        _one.Tus_warr_period = 0;
                        _one.Tus_price_book = Convert.ToString(_row["grad_anal2"]);
                        _one.Tus_price_level = Convert.ToString(_row["grad_anal3"]);


                        //_one.Tus_cross_docno = Convert.ToString(_row["its_cross_docno"]);
                        //_one.Tus_fifo_doc = Convert.ToString(_row["its_fifo_doc"]);
                        //_one.Tus_ageloc = Convert.ToString(_row["its_ageloc"]);
                        //_one.Tus_issue_dt = Convert.ToDateTime(_row["its_issue_dt"]);
                        //_one.Tus_fifo_dt = _row["its_fifo_dt"] == DBNull.Value ? DateTime.MinValue : (DateTime)_row["its_fifo_dt"];
                    }

                    _list.Add(_one);
                }
            }
            return _list;
        }
       
        //Nuwan 2018.02.08
        public DataTable getAllSerialDetails(string com,string loc,string ser1,string ser2,string ser3)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[6];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
                (param[3] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser1;
                (param[4] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser2;
                (param[5] = new OracleParameter("p_ser3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser3;

                DataTable _dtResults = QueryDataTable("tbl", "pkg_pda.SP_GET_ALLSERIALDETAILS", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getBondDocJobNo(string itmcd, string com, string stus, int lineno, string req, string docno)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[2] = new OracleParameter("p_jobline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
                (param[3] = new OracleParameter("p_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = req;
                (param[4] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
                (param[5] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
                (param[6] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;

                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SCANJOBBONDJOBNO", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Add by lakshan 14Feb2018
        public DataTable GET_TEMP_DOC_PARTIAL(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _from, DateTime _To)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string doc = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC #":
                        doc = _searchText;
                        break;
                    default:
                        break;
                }
            }

            doc = (doc != null) ? (doc.ToUpper() + "%") : null;


            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[3] = new OracleParameter("p_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[4] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[6] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _To;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("temp_pick_hdr@scmrep", "sp_get_temp_doc_partial", CommandType.StoredProcedure, false, param);
        }
        public List<AUD_CHARGES> get_AUD_CHARGES(string _aud_com_cd, string _aud_tp, string _aud_reason, string _aud_itm_stus, string _aud_remarks, string _aud_charge_base_on, string _aud_value, Decimal _aud_charge, string _aud_price_book, string _aud_p_level, DateTime _aud_valid_from, DateTime _aud_valid_to,
                                   String _aud_effect_to, Int32 _aud_charge_amend, string _aud_stock_adjuestment_type, string _aud_item_cd, string _aud_item_cat1, string _aud_item_brand)
        {
            List<AUD_CHARGES> _AUD_CHARGES = new List<AUD_CHARGES>();

            OracleParameter[] param = new OracleParameter[19];
            (param[0] = new OracleParameter("p_aud_com_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_com_cd;
            (param[1] = new OracleParameter("p_aud_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_tp;
            (param[2] = new OracleParameter("p_aud_reason", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_reason;
            (param[3] = new OracleParameter("p_aud_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_itm_stus;
            (param[4] = new OracleParameter("p_aud_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_remarks;
            (param[5] = new OracleParameter("p_aud_charge_base_on", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _aud_charge_base_on;
            (param[6] = new OracleParameter("p_aud_value", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _aud_value;
            (param[7] = new OracleParameter("p_aud_charge", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _aud_charge;
            (param[8] = new OracleParameter("p_aud_price_book", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _aud_price_book;
            (param[9] = new OracleParameter("p_aud_p_level", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _aud_p_level;
            (param[10] = new OracleParameter("p_aud_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _aud_valid_from;
            (param[11] = new OracleParameter("p_aud_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _aud_valid_to;
            (param[12] = new OracleParameter("p_aud_effect_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _aud_effect_to;
            (param[13] = new OracleParameter("p_aud_charge_amend", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_charge_amend;
            (param[14] = new OracleParameter("p_aud_stock_adjuestment_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_stock_adjuestment_type;
            (param[15] = new OracleParameter("p_aud_item_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_item_cd;
            (param[16] = new OracleParameter("p_aud_item_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_item_cat1;
            (param[17] = new OracleParameter("p_aud_item_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _aud_item_brand;
            param[18] = new OracleParameter("o_ProcessedJobSerial", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_ProcessedAuditItems", "SP_GET_aud_job_Charges", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _AUD_CHARGES = DataTableExtensions.ToGenericList<AUD_CHARGES>(_dtResults, AUD_CHARGES.Converter);
            }
            return _AUD_CHARGES;
        }

        public  DataTable getBinDetailsSerPic  (string company,string location, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Code":
                        searchFld = "IBL_BIN_CD";
                        break;
                    case "Description":
                        searchFld = "IBL_BIN_DES";
                        break;
                    default:
                        searchFld = "";
                        break;

                }
                OracleParameter[] param = new OracleParameter[7];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[2] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[3] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[4] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;

                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_LOCATIONBINCODES", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }


        public DataTable getSer1DetailsSerPic(string company, string location, string itemcd, string pgeNum, string pgeSize, string searchFld, string searchVal)
        {
            try
            {
                string search = (!string.IsNullOrEmpty(searchVal)) ? "%" + searchVal + "%" : "";
                switch (searchFld)
                {
                    case "Item Code":
                        searchFld = "INS_ITM_CD";
                        break;
                    case "Srial #1":
                        searchFld = "INS_SER_1";
                        break;
                    case "Status":
                        searchFld = "INS_ITM_STUS";
                        break;
                    default:
                        searchFld = "";
                        break;

                }
                OracleParameter[] param = new OracleParameter[8];
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                (param[1] = new OracleParameter("p_pgenum", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeNum;
                (param[2] = new OracleParameter("p_pagesize", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pgeSize;
                (param[3] = new OracleParameter("p_field", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[4] = new OracleParameter("p_search", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = search;
                (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[6] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
                (param[7] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcd;
                DataTable _dtResults = QueryDataTable("tbl", "SP_SEARCH_SERDETPIC", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int16 updateAuditJobSerails_charhes(AuditJobSerial _serial)
        {
            OracleParameter[] param = new OracleParameter[23];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_audjs_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Audjs_Seq;
            (param[1] = new OracleParameter("p_audjs_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_JobNo;
            (param[2] = new OracleParameter("p_audjs_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_ItemCode;
            (param[3] = new OracleParameter("p_audjs_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_SerialNo;
            (param[4] = new OracleParameter("p_audjs_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_ItemStatus;
            (param[5] = new OracleParameter("p_audjs_in_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_InDocNo;
            (param[6] = new OracleParameter("p_audjs_in_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Audjs_DocInDate;
            (param[7] = new OracleParameter("p_audjs_warranty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_WarrantyNo;
            (param[8] = new OracleParameter("p_audjs_ref_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_RefStatus;
            (param[9] = new OracleParameter("p_audjs_rpt_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_RptType;
            (param[10] = new OracleParameter("p_audjs_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_Type;
            (param[11] = new OracleParameter("p_audjs_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _serial.Audjs_SerialId;
            (param[12] = new OracleParameter("p_audjs_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_Remark;
            (param[13] = new OracleParameter("p_audjs_org_in_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _serial.Audjs_OriginelInDate;
            (param[14] = new OracleParameter("p_audjs_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_CreatedBy;
            (param[15] = new OracleParameter("p_audjs_sub_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[16] = new OracleParameter("p_audjs_phy_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_PhysicallyAvailableSerial;


            (param[17] = new OracleParameter("p_audjs_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_ModBy;
            (param[18] = new OracleParameter("p_audjs_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial.Audjs_SessionId;
            (param[19] = new OracleParameter("p_audjs_charges", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.Aud_charges;
            (param[20] = new OracleParameter("p_audjs_charges_user", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial.AUDJS_CHARGES_USER;
            (param[21] = new OracleParameter("p_is_user_charge_update", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _serial._IS_USER_charge_update;

            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATE_AUDJOBCHARGES", CommandType.StoredProcedure, param);
            return effects;
        }
        public DataTable get_audit_itm_charges_sum(string _audjs_job,string _com)
        {
            try
            {

                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_audjs_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _audjs_job;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults;
                _dtResults = QueryDataTable("tbl", "sp_get_aud_chrges_sum", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }


        public List<AuditJobSerial> GetProcessedJobSerials_all(string _subJobNo, Int32 _startIndex, Int32 _endIndex, Int32 _status, string _com)
        {
            List<AuditJobSerial> _processedJobSerials = new List<AuditJobSerial>();

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_SubJobNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subJobNo;
            (param[1] = new OracleParameter("p_startIndex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _startIndex;
            (param[2] = new OracleParameter("p_endIndex", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _endIndex;
            (param[3] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[5] = new OracleParameter("o_ProcessedJobSerial", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl_ProcessedAuditItems", "SP_GET_AUDJOBSERIALS_ALL", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _processedJobSerials = DataTableExtensions.ToGenericList<AuditJobSerial>(_dtResults, AuditJobSerial.Converternew);
            }
            return _processedJobSerials;
        }

        public Int16 Updatei_JOB_Hdr_appby(string _AUSH_JOB, string _AUSH_COM, string _AUSH_MOD_BY, Int32 _AUSH_STUS, Int32 _ADJ_REQ)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AUSH_JOB;
            (param[1] = new OracleParameter("p_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AUSH_COM;
            (param[2] = new OracleParameter("p_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _AUSH_MOD_BY;
            (param[3] = new OracleParameter("P_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _AUSH_STUS;
            (param[4] = new OracleParameter("P_ADJ_REQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ADJ_REQ;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATE_AUD_HDR_APP", CommandType.StoredProcedure, param);
            return effects;
        }
        //Add by lakshan 20Feb2018
        public decimal GetMrnShowroomStockValue(string _com, string _loc)
        {
            decimal _val = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mrn_tot_sh_value", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    _val = decimal.TryParse(_dtResults.Rows[0][0].ToString(), out _val) ? Convert.ToDecimal(_dtResults.Rows[0][0].ToString()) : 0;
                }
            }
            return _val;
        }
        //Add by lakshan 20Feb2018
        public decimal GetMrnApprovedStockValue(string _com, string _loc)
        {
            decimal _val = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mrn_tot_sh_value", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    _val = decimal.TryParse(_dtResults.Rows[0][0].ToString(), out _val) ? Convert.ToDecimal(_dtResults.Rows[0][0].ToString()) : 0;
                }
            }
            return _val;
        }
        public Int32 CheckItemUnitsIsDecimal(string mi_cd)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[1];
                (param[0] = new OracleParameter("p_mi_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mi_cd;
                OracleParameter orP = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                return ReturnSP_SingleValue("sp_check_item_units_isdcml", CommandType.StoredProcedure, orP, param);
            }
            catch (Exception) { return -1; }
        }

        public Decimal Get_def_price_from_pc(string _pbook, string _plevel, string _itmcd, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pbook", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbook;
            (param[1] = new OracleParameter("p_plevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _plevel;
            (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcd;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_def_price_from_pc", CommandType.StoredProcedure, false, param);
            Decimal ser = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                ser = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return ser;
        }
        //Add by lakshan 20Feb2018
        public List<InventoryRequestItem> GetApprovedMrnItemBalance(string _com, string _loc)
        {
            List<InventoryRequestItem> _reqItmList = new List<InventoryRequestItem>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_mrn_approved_value", CommandType.StoredProcedure, false, param);
            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    _reqItmList = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.Converter4);
                    _reqItmList = _reqItmList.OrderBy(c => c.Itri_itm_cd).ToList();
                }
            }
            return _reqItmList;
        }
        public string GetINTRNo(string doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GETINTRNO", CommandType.StoredProcedure, false, param);
            string _intr = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                _intr = _dtResults.Rows[0][0].ToString();
            }
            return _intr;
        }

        //Add by lakshan 18 Apr 2017
        public Int32 UpdateRequestHeaderSoaInvNo(string _soaNo, string _invNo)
        {
            Int32 _effect = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _soaNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = (Int16)UpdateRecords("sp_upd_int_req_soainvno", CommandType.StoredProcedure, param);
            return _effect;
        }

        public int reopenTempDocumentGRN(string seqno, string doctp, string userid)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_usrseq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqno;
            (param[1] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            (param[2] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_pda.sp_updatedocfinstusgrn", CommandType.StoredProcedure, param);
            return effects;
        
        }

        public DataTable getUserScanFinishedSerial(string seq, string userid)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_pda.sp_get_finishedscanserials", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Addd By Dulaj 2018-Mar-15
        public DataTable GetItemConditionsByDate(string _com, DateTime _from_date, DateTime _to_date, string _otherLoc, string _loc, string user)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_irsc_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_frm_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from_date.Date;
            (param[2] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to_date.Date;
            (param[3] = new OracleParameter("p_irsc_othr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherLoc;
            (param[4] = new OracleParameter("p_irsc_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[5] = new OracleParameter("p_irsc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;            
             param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_int_ser_cond", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
       //Addd By Dulaj 2018-Mar-21
       public Int32 CheckExessQty(string _tp, string _cd, DateTime _grnDate, string _pty_cd)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[4];
               (param[0] = new OracleParameter("p_hsy_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tp;
               (param[1] = new OracleParameter("p_hsy_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
               (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _grnDate;
               (param[3] = new OracleParameter("p_hsy_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_cd;
               OracleParameter orP = new OracleParameter("c_result", OracleDbType.Int32, null, ParameterDirection.Output);

               return ReturnSP_SingleValue("chk_exss_qty_grn", CommandType.StoredProcedure, orP, param);
           }
           catch (Exception) { return 0; }
       }

       public DataTable getSerialDetailsStatus(string com, string ser1, string ser2)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[4];
               (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
               (param[1] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser1;
               (param[2] = new OracleParameter("p_ser2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser2;
               param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               DataTable _dtResults;
               _dtResults = QueryDataTable("tbl", "SP_GET_INRSERDATA", CommandType.StoredProcedure, false, param);
               return _dtResults;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public DataTable Get_FinancialDocDetails(DateTime _fromdate, DateTime _todate, string in_Company, string _adminteam, string in_user_id, string in_lc, string in_pi, string in_bank, string in_acc, int in_IsSummary, int in_IsExpireDate, int in_IsInsurancePolicyDate, int in_IsFinanceDocDate)
       {
           //Wimal 24/03/2018
           OracleParameter[] param = new OracleParameter[14];
           param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
           (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
           (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
           (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
           (param[4] = new OracleParameter("in_opadmin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adminteam;
           (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;
           (param[6] = new OracleParameter("in_lc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_lc.Equals("") ? null : in_lc;
           (param[7] = new OracleParameter("in_pi", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_pi.Equals("") ? null : in_pi;
           (param[8] = new OracleParameter("in_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_bank.Equals("") ? null : in_bank;
           (param[9] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_acc;
           (param[10] = new OracleParameter("in_IsSummary", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_IsSummary;
           (param[11] = new OracleParameter("in_IsExpireDate", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_IsExpireDate;
           (param[12] = new OracleParameter("in_IsInsurancePolicyDate", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_IsInsurancePolicyDate;
           (param[13] = new OracleParameter("in_IsFinanceDocDate", OracleDbType.Int16, null, ParameterDirection.Input)).Value = in_IsFinanceDocDate;

           DataTable _dtResults = QueryDataTable("tbl", "sp_get_Financ_Doc_Details", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }

       public DataTable Get_GetAdjDetailsWDocCat(DateTime _fromdate, DateTime _todate, string _Company, string _LocCd, string in_user_id)
       {
           //Wimal 27/03/2018
           OracleParameter[] param = new OracleParameter[6];
           param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
           (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
           (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
           (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;
           (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _LocCd;
           (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user_id;

           DataTable _dtResults = QueryDataTable("tbl", "sp_get_AdjDetailsWDocCat", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
       public List<AuditRemarkValue> GetPhicalStockRemark_FILTER(string p_ausv_job, Int32 p_ausv_line, Int32 p_ausv_job_seq, string p_ausv_itm, string p_ausv_itm_stus, Int32 p_ausv_ser_id, string p_ausv_rpt_stus)
       {
           
           List<AuditRemarkValue> _list = null;
           OracleParameter[] param = new OracleParameter[8];
           (param[0] = new OracleParameter("p_ausv_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ausv_job;
           (param[1] = new OracleParameter("p_ausv_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ausv_line;
           (param[2] = new OracleParameter("p_ausv_job_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ausv_job_seq;
           (param[3] = new OracleParameter("p_ausv_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ausv_itm;
           (param[4] = new OracleParameter("p_ausv_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ausv_itm_stus;
           (param[5] = new OracleParameter("p_ausv_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ausv_ser_id;
           (param[6] = new OracleParameter("p_ausv_rpt_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ausv_rpt_stus;

           param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _dtResults = QueryDataTable("tbl", "sp_get_svr_rmk_", CommandType.StoredProcedure, false, param);

           if (_dtResults.Rows.Count > 0)
           {
               _list = DataTableExtensions.ToGenericList<AuditRemarkValue>(_dtResults, AuditRemarkValue.Converter);
           }
           return _list;
       }
       //Akila 2018/01/04
       public List<MasterItemSimilar> GetSimilerItemDetailsNew(string _itemCode, string _company, string _profitCenter, DateTime _date, string _price_book = null, string _price_level = null)
       {
           List<MasterItemSimilar> _list = new List<MasterItemSimilar>();
           OracleParameter[] param = new OracleParameter[7];

           (param[0] = new OracleParameter("p_misi_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
           (param[1] = new OracleParameter("P_misi_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
           (param[2] = new OracleParameter("p_misi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
           (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
           (param[4] = new OracleParameter("p_price_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _price_book;
           (param[5] = new OracleParameter("p_price_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _price_level;

           param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("mst_similer_itm", "SP_GET_SIMILER_ITMDET", CommandType.StoredProcedure, false, param);
           if (_dtResults.Rows.Count > 0)
           {
               _list = DataTableExtensions.ToGenericList<MasterItemSimilar>(_dtResults, MasterItemSimilar.ConverterSimilarNew);
           }
           return _list;
       }
    
    
       public DataTable Get_pending_DIN(string _in_item, string _in_serial, Int32 _in_ser_id)
       {
           //Wimal tharanga 2018/03/30
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _in_item;
           (param[1] = new OracleParameter("in_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _in_serial;
           (param[2] = new OracleParameter("in_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _in_ser_id;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pen_din", CommandType.StoredProcedure, false, param);
         
           return _dtResults;
       }
        //Dualj 2018/Mar/19
         public string GetBinCodeForNonSeralizeItem(string _itemCode, string _loc, string _com, string status)
       {
           string bin = "";
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_inb_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
           (param[1] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_inb_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[3] = new OracleParameter("p_inb_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _dtResults = QueryDataTable("tbl", "sp_get_inb_bin", CommandType.StoredProcedure, false, param);
            if(_dtResults.Rows.Count>0)
            {
                bin = _dtResults.Rows[0]["inb_bin"].ToString();
            }
           return bin;
       }


       //Tharindu 2018-03-22
       public DataTable GetCurrentAvailabilityBL(string _Com, DateTime _FromDate, DateTime _ToDate, string _sino, string _itemcode, string _model, string brand, string category,string category2,string category3,string brandmgr, string supplier, string userid)
       {   //Sanjeewa 2016-06-28
           OracleParameter[] param = new OracleParameter[14];
           (param[0] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
           (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
           (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
           (param[3] = new OracleParameter("sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sino;
           (param[4] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
           (param[5] = new OracleParameter("model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
           (param[6] = new OracleParameter("brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;
           (param[7] = new OracleParameter("category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category;
           (param[8] = new OracleParameter("category2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category2;
           (param[9] = new OracleParameter("category3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = category3;
           (param[10] = new OracleParameter("brandmgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brandmgr;
           (param[11] = new OracleParameter("supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
           (param[12] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
           param[13] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("tbl", "sp_get_cur_availability_bl", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
       public DataTable Get_alladj_Req(string _company, string _user, string _reqTp, string _stus, DateTime _frmDt, DateTime _toDt, string _subTp)
       {
           OracleParameter[] param = new OracleParameter[8];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
           (param[1] = new OracleParameter("p_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
           (param[2] = new OracleParameter("p_reqTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqTp;
           (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
           (param[4] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmDt.Date;
           (param[5] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDt.Date;
           (param[6] = new OracleParameter("p_subTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subTp;
           param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           return QueryDataTable("tbl", "sp_search_adj_req", CommandType.StoredProcedure, false, param); ;
       }




       // Rangika 2018-04-26
       public Int32 SaveItemStatusChangeDef(List<ItemStatus_Change_def> _ItemStatus_Change_def)
       {
           Int32 effects = 0;
           foreach (ItemStatus_Change_def _item in _ItemStatus_Change_def)
           {
               OracleParameter[] param = new OracleParameter[17];

               (param[0] = new OracleParameter("p_isp_com,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.company;
               (param[1] = new OracleParameter("p_isp_itm_cat1,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.mainCategory;
               (param[2] = new OracleParameter("p_isp_itm_cat2,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.category;
               (param[3] = new OracleParameter("p_isp_itm_cat3,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.subCategory;
               (param[4] = new OracleParameter("p_isp_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.brand;
               (param[5] = new OracleParameter("p_isp_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.model;
               (param[6] = new OracleParameter("p_isp_itm_cd,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.item;
               (param[7] = new OracleParameter("p_isp_pty_tp,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.pttype;
               (param[8] = new OracleParameter("p_isp_pty_cd,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.hierarchy;
               (param[9] = new OracleParameter("p_isp_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.status;
               (param[10] = new OracleParameter("p_isp_alw_qty,", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.alowQuantity;
               (param[11] = new OracleParameter("p_isp_alw_itm_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.alowItemQuantity;
               (param[12] = new OracleParameter("p_isp_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.createuser;

               (param[13] = new OracleParameter("p_isp_frm_stus,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.Fromstatus;       // Added by Udesh 22-Oct-2018
               (param[14] = new OracleParameter("p_isp_frm_dt,", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.FromDate;           // Added by Udesh 22-Oct-2018
               (param[15] = new OracleParameter("p_isp_to_dt,", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.ToDate;              // Added by Udesh 22-Oct-2018
               
               param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

               effects = effects + (Int16)UpdateRecords("sp_insert_Itm_chn_def", CommandType.StoredProcedure, param);

           }

           return effects;
       }

    //   Tharindu 2018-03-26
       public DataTable getChargeSheet(string _Com, string _Loc, string _Jobno, string _User)
       {
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
           (param[1] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Jobno;
           param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           return QueryDataTable("tbl", "sp_get_charge_sheet", CommandType.StoredProcedure, false, param);
           //return QueryDataTable("tbl", "sp_get_chargesheet_new", CommandType.StoredProcedure, false, param);
       }
       public List<ReptPickSerials> search_res_serials_for_do(string company, string location, string itemCode, string pbook, string pblvl, string supplier, bool ISsupplier, string ser1)
       {
           OracleParameter[] param = new OracleParameter[9];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
           (param[2] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
           (param[3] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pbook;
           (param[4] = new OracleParameter("p_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblvl;
           (param[5] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = supplier;
           (param[6] = new OracleParameter("p_issupplier", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(ISsupplier);
           (param[7] = new OracleParameter("p_ser1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser1;
           param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = new DataTable();
           dt = QueryDataTable("tbl_serials", "sp_search_res_serials_for_do", CommandType.StoredProcedure, false, param);
           List<ReptPickSerials> serial_list = new List<ReptPickSerials>();
           foreach (DataRow tr in dt.Rows)
           {
               serial_list.Add(SetReptPickSerials(tr));
           }
           return serial_list;
       }
       public DataTable Get_Delivery_det_by_ser(string _company, string _item, string _serial, string _loc, string _doc_tp)
       {
           //sp_getdelvieryfromserial(p_com in NVARCHAR2, p_item in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
           (param[1] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
           (param[2] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _serial;
           (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[4] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc_tp;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = QueryDataTable("tbl", "sp_get_del_det_serial", CommandType.StoredProcedure, false, param);
           return dt;
       }

       //Tharindu 2018-03-22
       public DataTable GetShipmentDetails(string userid)
       {
           OracleParameter[] param = new OracleParameter[2];

           param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           (param[1] = new OracleParameter("userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;

           DataTable dt = new DataTable();
           dt = QueryDataTable("tbl", "sp_get_pending_ship", CommandType.StoredProcedure, false, param);

           return dt;
       }
       public Int16 update_adj_req_itm_status(Int32 itri_seq_no, Int32 itri_line_no, string itri_itm_cd, string itri_itm_stus, string tri_note)
       {
           OracleParameter[] param = new OracleParameter[6];
           Int16 effects = 0;
           (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itri_seq_no;
           (param[1] = new OracleParameter("p_itri_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itri_line_no;
           (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itri_itm_cd;
           (param[3] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itri_itm_stus;
           (param[4] = new OracleParameter("p_itri_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tri_note;
           
           param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int16)UpdateRecords("sp_update_adj_req_itm_status", CommandType.StoredProcedure, param);
           return effects;

       }
       //Dulaj 2018/May/03
       public DataTable GetDepreciationMethods(string _company)
       {

           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = new DataTable();
           dt = QueryDataTable("deptbl", "sp_get_mst_dep_methods", CommandType.StoredProcedure, false, param);

           return dt;

       }
       public Int32 SaveMasterAssetPrameter(MasterAssetParameter Msp)
       {
           OracleParameter[] param = new OracleParameter[15];
           Int32 effects = 0;
           (param[0] = new OracleParameter("p_map_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_com;
           (param[1] = new OracleParameter("p_map_cat1", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_cat1;
           (param[2] = new OracleParameter("p_map_cat2", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_cat2;
           (param[3] = new OracleParameter("p_map_dep_mth", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_dep_mth;
           (param[4] = new OracleParameter("p_map_dep_val", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Msp.map_dep_val;
           (param[5] = new OracleParameter("p_map_dep_base", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_dep_base;
           (param[6] = new OracleParameter("p_map_cre_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_cre_by;
           (param[7] = new OracleParameter("p_map_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Msp.map_cre_dt;
           (param[8] = new OracleParameter("p_map_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_mod_by;
           (param[9] = new OracleParameter("p_map_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Msp.map_mod_dt;
           (param[10] = new OracleParameter("p_map_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Msp.map_act;
           (param[11] = new OracleParameter("p_map_stus", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_stus;
           (param[12] = new OracleParameter("p_map_dis", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Msp.map_dis;
           (param[13] = new OracleParameter("p_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_session;
           param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int16)UpdateRecords("sp_save_mst_asst_para", CommandType.StoredProcedure, param);
           return effects;
       }
       public Int32 UpdateMasterAssetPrameter(MasterAssetParameter Msp)
       {
           OracleParameter[] param = new OracleParameter[14];
           Int32 effects = 0;
           (param[0] = new OracleParameter("p_map_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_com;
           (param[1] = new OracleParameter("p_map_cat1", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_cat1;
           (param[2] = new OracleParameter("p_map_cat2", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_cat2;
           (param[3] = new OracleParameter("p_map_dep_mth", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_dep_mth;
           (param[4] = new OracleParameter("p_map_dep_val", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Msp.map_dep_val;
           (param[5] = new OracleParameter("p_map_dep_base", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_dep_base;
           (param[6] = new OracleParameter("p_map_cre_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_cre_by;
           (param[7] = new OracleParameter("p_map_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Msp.map_cre_dt;
           (param[8] = new OracleParameter("p_map_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_mod_by;
           (param[9] = new OracleParameter("p_map_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Msp.map_mod_dt;
           (param[10] = new OracleParameter("p_map_act", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Msp.map_act;
           (param[11] = new OracleParameter("p_map_stus", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = Msp.map_stus;
           (param[12] = new OracleParameter("p_map_dis", OracleDbType.Int16, null, ParameterDirection.Input)).Value = Msp.map_dis;
           param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int16)UpdateRecords("sp_update_mst_asst_para", CommandType.StoredProcedure, param);
           return effects;
       }
       
       public DataTable GetAssetParameters(string _com)
       {
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = new DataTable();
           dt = QueryDataTable("assetTable", "SP_GET_ASSET_PARAMS", CommandType.StoredProcedure, false, param);
           return dt;
       }

      


        //Rangika 2018-05-18

       public DataTable getExelUploadResig(string userId)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[2];
               (param[0] = new OracleParameter("p_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
               param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

               DataTable _dtResults = QueryDataTable("tbl", "SP_GET_EXEL_USERID", CommandType.StoredProcedure, false, param);
               return _dtResults;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }


       // Rangika 2018-05-24
       public Int32 Updateecxelbulk(List<User_Resign_Bulk> _User_Resign_Bulk)
       {
           Int32 effects = 0;
           foreach (User_Resign_Bulk _item in _User_Resign_Bulk)
           {
               OracleParameter[] param = new OracleParameter[4];

               (param[0] = new OracleParameter("p_user_id,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.userId;
               (param[1] = new OracleParameter("p_se_act,", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.seAct;
               (param[2] = new OracleParameter("p_se_mod_by,", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item.usercre;   
               param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

               effects = (Int16)UpdateRecords("SP_Update_EXEL_USERID", CommandType.StoredProcedure, param);

           }

           return effects;
       }
       public DataTable Get_get_fixed_asset(string _com, string _loc, string _pc, string _ser, string _itm)
       {
           //sp_getdelvieryfromserial(p_com in NVARCHAR2, p_item in NVARCHAR2,p_serial in NVARCHAR2,p_warranty in NVARCHAR2,p_invoice in NVARCHAR2,c_data out sys_refcursor)
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
           (param[3] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
           (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = QueryDataTable("tbl", "sp_get_fixed_asset", CommandType.StoredProcedure, false, param);
           return dt;
       }
       public DataTable GET_provisioning_AGE(string in_com, string in_loc, string in_user, DateTime in_date, string age)
       {
           //Wimal 27/03/2018
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_com;
           (param[1] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
           (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
           (param[3] = new OracleParameter("IN_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_date;
           (param[4] = new OracleParameter("IN_AGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = age;
           param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("tbl", "SP_GET_PROVISIONING_AGE", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }

       public DataTable GET_STATUS_WISE_AGEING(string in_com, string in_loc, string in_user, DateTime in_date)
       {

           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_com;
           (param[1] = new OracleParameter("IN_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_loc;
           (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
           (param[3] = new OracleParameter("IN_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_date;

           param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("tbl", "sp_get_status_age_org_cost", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
       public DataTable GET_disposal_summary(string in_com, DateTime from_date, DateTime to_date,string _loc)
       {

           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_com;
           (param[1] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = from_date;
           (param[2] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = to_date;
           (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
         

           param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("tbl", "sp_get_disposal_summary", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }
       public Int32 Updat_int_batch_hp_inv(string _itm, string _itm_sts, string _doc, Decimal _sad_rate)
       {
           OracleParameter[] param = new OracleParameter[5];
           Int32 effects = 0;

           (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
           (param[1] = new OracleParameter("p_itm_sts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm_sts;
           (param[2] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
           (param[3] = new OracleParameter("p_sad_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _sad_rate;
           param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int32)UpdateRecords("sp_upd_int_batch_hp_inv", CommandType.StoredProcedure, param);
           return effects;
       }
       public DataTable GetSalesHdr(string _invNo)
       {
           // Nadeeka 13-12-2012 
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_hdr", CommandType.StoredProcedure, false, param);
           return _tblData;

       }
       public DataTable GetSalesDet(string _invNo)
       {
           // Nadeeka 13-12-2012 
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invNo;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblData = QueryDataTable("tbl", "sp_get_inv_det", CommandType.StoredProcedure, false, param);
           return _tblData;

       }
       public DataTable Check_Already_savedMethods(string cat01, string cat02, string status)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_map_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat01;
           (param[1] = new OracleParameter("p_map_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat02;
           (param[2] = new OracleParameter("p_map_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
           (param[3] = new OracleParameter("p_map_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = new DataTable();
           dt = QueryDataTable("assetTable", "sp_check_already_savedcat", CommandType.StoredProcedure, false, param);

           return dt;
       }

       // Tharindu 2018-06-06
       public DataTable GetFixAssetLoc_NEW(string _com, string _pc)
       {
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
           param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable dt = new DataTable();
           dt = QueryDataTable("assetTable", "sp_get_fix_asset_loc", CommandType.StoredProcedure, false, param);

           return dt;
       }


       //Pasindu 2018/05/07
       public DataTable GetFixAssetLocation_Other(string _com, string _pc)
       {
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
           param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = new DataTable();
           dt = QueryDataTable("assetTable", "sp_get_fix_asset_loc", CommandType.StoredProcedure, false, param);
           return dt;

       }

       public DataTable GetFIXA_dtl_WithDepreciation(string _com, string _loc, DateTime in_FromDate, DateTime in_ToDate, string in_item, string in_Brand, string in_cat1, string in_cat2, string in_cat3, string in_cat4, string in_cat5, string in_model)
       {
           //Wimal 21/06/2018
           DataTable _dtResults = null;
           OracleParameter[] param = new OracleParameter[13];

           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_FromDate;
           (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_ToDate;
           (param[4] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Brand;
           (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_model;
           (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_item;
           (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat1;
           (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat2;
           (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat3;
           (param[10] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat4;
           (param[11] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_cat5;
           param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           _dtResults = QueryDataTable("tbl", "sp_FIXA_Dtl_With_Depreciation", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }

       public DataTable GetKIT_Component(string _KIT_itm)
       {
           //Wimal 21/06/2018
           DataTable _dtResults = null;
           OracleParameter[] param = new OracleParameter[2];

           (param[0] = new OracleParameter("p_kitcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _KIT_itm;          
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           _dtResults = QueryDataTable("tbl", "sp_get_KITComponent", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }

       public List<InventorySerialMaster> GetWarrantyDetails_by_serid(Int32 _SER_ID)
       {
           List<InventorySerialMaster> _list = null;
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("P_SER_ID", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _SER_ID;

           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _tblData = QueryDataTable("tblItemSimilar", "SP_GET_TEMPWARR_BY_SER_ID", CommandType.StoredProcedure, false, param);
           if (_tblData.Rows.Count > 0)
           {
               _list = DataTableExtensions.ToGenericList<InventorySerialMaster>(_tblData, InventorySerialMaster.ConvertTotal);
           }
           return _list;
       }

       public QuotationHeader Get_Quotation_HDR(string quotation_no)
       {
           //Query the QUO_DHR table
           QuotationHeader q_header;
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_quotaion_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = quotation_no;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblQout_HDR = QueryDataTable("tbl_HDR", "SP_Get_Qoutation_HDR", CommandType.StoredProcedure, false, param);

           if (_tblQout_HDR.Rows.Count > 0)
           {
               q_header = DataTableExtensions.ToGenericList<QuotationHeader>(_tblQout_HDR, QuotationHeader.ConvertTotal)[0];
           }
           else
           {
               return q_header = null;
           }
           return q_header;

       }
       public DataTable GetRevertReleaseAccountDetail(string _COM, string _PC, string _ACC, string _ITM)
       {
           //sp_getrevertreleasedetail(p_account in NVARCHAR2,c_data out sys_refcursor)
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
           (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PC;
           (param[2] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ACC;
           (param[3] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ITM;
           param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblData = QueryDataTable("tbData", "SP_GET_HPT_RVT_DET", CommandType.StoredProcedure, false, param);

           return _tblData;
       }
       public Int32 SAVE_REF_DATRERANGE(DateTime frm_date, DateTime todare, string user_id)
       {
           OracleParameter[] param = new OracleParameter[4];
           Int32 effects = 0;

           (param[0] = new OracleParameter("p_frmdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frm_date;
           (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todare;
           (param[2] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user_id;
           param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int32)UpdateRecords("SP_SAVE_REF_DATERANG", CommandType.StoredProcedure, param);
           return effects;
       }
       public Int32 delete_REF_DATRERANGE(string user_id)
       {
           OracleParameter[] param = new OracleParameter[2];
           Int32 effects = 0;


           (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user_id;
           param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int32)UpdateRecords("SP_DELET_REF_DATERANG", CommandType.StoredProcedure, param);
           return effects;
       }
       public List<InventoryBatchN> Get_Int_Batch_by_itm(string _doc,string _itmcd, string status)
       {
           List<InventoryBatchN> _reptPickBatch = new List<InventoryBatchN>();
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("P_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
           (param[1] = new OracleParameter("P_ITMCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcd;
           (param[2] = new OracleParameter("P_ITM_STS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
           param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dt = new DataTable();
           dt = QueryDataTable("tblSerial", "SP_GET_INTBATCH_BY_ITM", CommandType.StoredProcedure, false, param);

           if (dt.Rows.Count > 0)
           {
               _reptPickBatch = DataTableExtensions.ToGenericList<InventoryBatchN>(dt, InventoryBatchN.Converter);
           }


           return _reptPickBatch;
       }
        //subodana 2018-07-31
       public DataTable GetGrnCorrectItemsByDoc(string _Doc,string Com)
       {
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Doc;
           (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
           param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _tblData = QueryDataTable("tbData", "SP_GETGRNCORRBYDOC", CommandType.StoredProcedure, false, param);
           return _tblData;
       }
       public bool IsCorrectGrn(string ToBond, String Item, Int32 Line)
       {
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("P_JOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ToBond;
           (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
           (param[2] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Line;
           param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _tblData = QueryDataTable("tbData", "SP_ISCORRECTGRN", CommandType.StoredProcedure, false, param);
           bool istrue = false;
           if (_tblData != null && _tblData.Rows.Count > 0 && Convert.ToInt32(_tblData.Rows[0][0].ToString())>0)
           {
               istrue = true;
           }
           return istrue;
       }
       //Dulaj 2018-Jul-31
       public DataTable GetItemPriceWithPc(string pb, string pl, string itm, DateTime dt,string pc)
       {
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pb;
           (param[1] = new OracleParameter("p_pl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pl;
           (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
           (param[3] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = dt;
           (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _resultDT = QueryDataTable("tblName", "sp_getitemprice_pc", CommandType.StoredProcedure, false, param);
           return _resultDT;
       }
           //Dulaj 2018-Aug-01
       public DataTable GetItemsByBin(string com, string itemCode, string loc, string bin, string itemStatus)
       {
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("pcom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value =itemCode;
           (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
           (param[3] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
           (param[4] = new OracleParameter("p_itemStats", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemStatus;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _resultDT = QueryDataTable("tblName", "sp_getitemsByBin", CommandType.StoredProcedure, false, param);
           return _resultDT;
       }
       public DataTable GetItems_git_get(string com, string loc, Int32 ser_id, string itemStatus)
       {
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_ser_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ser_id;
           (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
           // (param[3] = new OracleParameter("p_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bin;
           // (param[4] = new OracleParameter("p_itemStats", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemStatus;
           param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _resultDT = QueryDataTable("tblName", "sp_getgit_det", CommandType.StoredProcedure, false, param);
           return _resultDT;
       }
       public DataTable getMstSysPara_new(string _com, string _pty_tp, string _pty_cd, string _rest_tp, string _dir_pry_cd)
       {
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_tp;
           (param[2] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pty_cd;
           (param[3] = new OracleParameter("p_rest_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rest_tp;
           (param[4] = new OracleParameter("p_dir_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dir_pry_cd;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "SP_Get_mst_sys_para_new", CommandType.StoredProcedure, false, param);
           return _result;
       }
       private ReptPickSerials Convert_INT_Sernew(DataRow _tr)
       {
           ReptPickSerials _pick = new ReptPickSerials();
           _pick.Tus_batch_line = Convert.ToInt32(_tr["ITS_BATCH_LINE"]);
           _pick.Tus_bin = Convert.ToString(_tr["ITS_BIN"]);
           _pick.Tus_com = Convert.ToString(_tr["ITS_COM"]);
           _pick.Tus_cre_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
           _pick.Tus_doc_dt = Convert.ToDateTime(_tr["ITS_DOC_DT"]).Date;
           _pick.Tus_doc_no = Convert.ToString(_tr["ITS_DOC_NO"]);
           _pick.Tus_exist_grncom = Convert.ToString(_tr["ITS_EXIST_GRNCOM"]);
           _pick.Tus_exist_grndt = Convert.ToDateTime(_tr["ITS_EXIST_GRNDT"]);
           _pick.Tus_exist_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
           _pick.Tus_exist_supp = Convert.ToString(_tr["ITS_EXIST_SUPP"]);
           _pick.Tus_itm_cd = Convert.ToString(_tr["ITS_ITM_CD"]);
           _pick.Tus_itm_line = Convert.ToInt32(_tr["ITS_ITM_LINE"]);
           _pick.Tus_itm_stus = Convert.ToString(_tr["ITS_ITM_STUS"]);
           _pick.Tus_loc = Convert.ToString(_tr["ITS_LOC"]);//not sure
           _pick.Tus_orig_grncom = Convert.ToString(_tr["ITS_ORIG_GRNCOM"]);
           _pick.Tus_orig_grndt = Convert.ToDateTime(_tr["ITS_ORIG_GRNDT"]);
           _pick.Tus_orig_grnno = Convert.ToString(_tr["ITS_EXIST_GRNNO"]);
           _pick.Tus_orig_supp = Convert.ToString(_tr["ITS_ORIG_SUPP"]);
           MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);
           if (_item.Mi_is_ser1 == -1)
           {
               _pick.Tus_qty = Convert.ToDecimal(_tr["itb_bal_qty1"]);// Convert.ToDecimal(txtQty.Text.Trim());//not sure

           }
           else
           {
               _pick.Tus_qty = 1;// Convert.ToDecimal(txtQty.Text.Trim());//not sure

           }

           _pick.Tus_seq_no = Convert.ToInt32(_tr["ITS_SEQ_NO"]);
           _pick.Tus_ser_1 = Convert.ToString(_tr["ITS_SER_1"]);
           _pick.Tus_ser_2 = Convert.ToString(_tr["ITS_SER_2"]);
           _pick.Tus_ser_3 = Convert.ToString(_tr["ITS_SER_3"]);
           _pick.Tus_ser_4 = Convert.ToString(_tr["ITS_SER_4"]);
           _pick.Tus_ser_id = Convert.ToInt32(_tr["ITS_SER_ID"]);
           _pick.Tus_ser_line = Convert.ToInt32(_tr["ITS_SER_LINE"]);
           // _reptPickSerials.Tus_session_id = GlbUserSessionID;//not sure
           _pick.Tus_unit_cost = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
           _pick.Tus_unit_price = Convert.ToDecimal(_tr["ITS_UNIT_COST"]);
           //   _reptPickSerials.Tus_usrseq_no = (int)generated_seq;//not sure
           _pick.Tus_warr_no = Convert.ToString(_tr["ITS_WARR_NO"]);
           _pick.Tus_warr_period = Convert.ToInt32(_tr["ITS_WARR_PERIOD"]);
           _pick.Tus_new_status = string.Empty;
           _pick.Tus_base_doc_no = Convert.ToString(_tr["ITB_BASE_REF_NO"]);
           _pick.Tus_base_itm_line = Convert.ToInt32(_tr["ITB_BASE_REFLINE"]);
           if (string.IsNullOrEmpty(_tr["ITS_AGELOC"].ToString()))
           { _pick.Tus_ageloc = _pick.Tus_loc; }
           else
           { _pick.Tus_ageloc = _tr["ITS_AGELOC"].ToString(); }
           if (string.IsNullOrEmpty(_tr["ITS_AGELOC_DT"].ToString()))
           { _pick.Tus_ageloc_dt = _pick.Tus_doc_dt; }
           else
           { _pick.Tus_ageloc_dt = Convert.ToDateTime(_tr["ITS_AGELOC_DT"].ToString()).Date; }

           if (string.IsNullOrEmpty(_tr["ITS_ISOWNMRN"].ToString()))
           { _pick.Tus_isownmrn = 0; }
           else
           { _pick.Tus_isownmrn = Convert.ToInt32(_tr["ITS_ISOWNMRN"].ToString()); }
           _pick.Mis_desc = Convert.ToString(_tr["mis_desc"]);//add rukshan 10/DEc/2015
           _pick.Tus_avl_qty = Convert.ToDecimal(_tr["itb_bal_qty1"]);
           //Added Prabhath on 11/08/2012
           // MasterItem _item = GetItem(_pick.Tus_com, _pick.Tus_itm_cd);
           _pick.Tus_itm_desc = _item.Mi_longdesc;
           _pick.Tus_itm_model = _item.Mi_model;
           _pick.Tus_itm_brand = _item.Mi_brand;

           return _pick;
       }
       //Dulaj 2018-Aug-03
       public DataTable GetItemCost(string com, string loc, string itemStatus, string itemCode)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
           (param[2] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
           (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemStatus;           
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _resultDT = QueryDataTable("tblName", "sp_get_dp_latest_cost", CommandType.StoredProcedure, false, param);
           return _resultDT;
       }
       //Dulaj 2018-Aug-13
       public Int32 SaveSatProjectKitDetails(SatProjectKitDetails satKit)
       {
           //sp_savelocationtransaction(p_frmcom in NVARCHAR2,p_frmloc in NVARCHAR2,p_tocom in NVARCHAR2,p_tocat3 in NVARCHAR2,p_user in NVARCHAR2,o_effect out NUMBER) is
           int _effect = -1;
           OracleParameter[] param = new OracleParameter[16];
           (param[0] = new OracleParameter("p_SPK_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = satKit.SPK_LINE;
           (param[1] = new OracleParameter("p_SPK_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_NO;
           (param[2] = new OracleParameter("p_SPK_KIT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_KIT_CD;
           (param[3] = new OracleParameter("p_SPK_KIT_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_KIT_DESC;
           (param[4] = new OracleParameter("p_SPK_KIT_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_KIT_MODEL;
           (param[5] = new OracleParameter("p_SPK_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = satKit.SPK_QTY;
           (param[6] = new OracleParameter("p_SPK_ACTIVE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = satKit.SPK_ACTIVE;
           (param[7] = new OracleParameter("p_SPK_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_CRE_BY;
           (param[8] = new OracleParameter("p_SPK_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_MOD_BY;
           (param[9] = new OracleParameter("p_SPK_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_SESSION;
           (param[10] = new OracleParameter("p_SPK_UNIT_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = satKit.SPK_UNIT_PRICE;
           (param[11] = new OracleParameter("p_SPK_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = satKit.SPK_COST;
           (param[12] = new OracleParameter("p_SPK_TOTAL_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = satKit.SPK_COST * satKit.SPK_QTY;
           (param[13] = new OracleParameter("p_SPK_TOTAL_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = satKit.SPK_UNIT_PRICE * satKit.SPK_QTY;
           (param[14] = new OracleParameter("p_SPK_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = satKit.SPK_RMK;
           param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           _effect = UpdateRecords("save_Sat_Pro_kit", CommandType.StoredProcedure, param);
           return _effect;
       }
        //Dulaj 2018/Aug/14
       public List<SatProjectKitDetails> GetSatKitItems(string boqno)
       {
           List<SatProjectKitDetails> kitDetails = new List<SatProjectKitDetails>();
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_spk_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = boqno;           
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _resultDT = QueryDataTable("tblName", "SP_Get_sat_kit_det", CommandType.StoredProcedure, false, param);
           if (_resultDT.Rows.Count > 0)
           {
               kitDetails = DataTableExtensions.ToGenericList<SatProjectKitDetails>(_resultDT, SatProjectKitDetails.Converter);
           }
           return kitDetails;
       }
       //Dulaj 2018/Aug/29
       public DataTable getItemCostByJobNo(string jobNo)
       {
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_jobno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobNo;           
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _resultDT = QueryDataTable("tblName", "sp_get_cost_by_job", CommandType.StoredProcedure, false, param);
           return _resultDT;
       }
       public int updateInventoryRequest(InventoryRequest _inventoryRequest)
       {
           int seqno = 0;
           OracleParameter[] param = new OracleParameter[39];
           (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
           (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
           (param[2] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
           (param[3] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_sub_tp;
           (param[4] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
           (param[5] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_ref;
           (param[6] = new OracleParameter("p_itr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_dt;
           (param[7] = new OracleParameter("p_itr_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exp_dt;
           (param[8] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
           (param[9] = new OracleParameter("p_itr_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_no;
           (param[10] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_bus_code;
           (param[11] = new OracleParameter("p_itr_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_note;
           (param[12] = new OracleParameter("p_itr_issue_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_from;
           (param[13] = new OracleParameter("p_itr_rec_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_rec_to;
           (param[14] = new OracleParameter("p_itr_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_direct;
           (param[15] = new OracleParameter("p_itr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_country_cd;
           (param[16] = new OracleParameter("p_itr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_town_cd;
           (param[17] = new OracleParameter("p_itr_cur_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cur_code;
           (param[18] = new OracleParameter("p_itr_exg_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exg_rate;
           (param[19] = new OracleParameter("p_itr_collector_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_id;
           (param[20] = new OracleParameter("p_itr_collector_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_name;
           (param[21] = new OracleParameter("p_itr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_act;
           (param[22] = new OracleParameter("p_itr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
           (param[23] = new OracleParameter("p_itr_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
           (param[24] = new OracleParameter("p_itr_issue_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com; //add chamal 17-08-2012
           (param[25] = new OracleParameter("p_itr_gran_opt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt1; //add chamal 17-08-2012
           (param[26] = new OracleParameter("p_itr_gran_opt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt2; //add chamal 17-08-2012
           (param[27] = new OracleParameter("p_itr_gran_opt3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt3; //add chamal 17-08-2012
           (param[28] = new OracleParameter("p_itr_gran_opt4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt4; //add chamal 17-08-2012
           (param[29] = new OracleParameter("p_itr_gran_nstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_nstus; //add chamal 17-08-2012
           (param[30] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by; //add chamal 17-08-2012
           (param[31] = new OracleParameter("p_itr_gran_narrt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_narrt; //add chamal 17-08-2012
           (param[32] = new OracleParameter("p_itr_gran_app_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_note; //add chamal 17-08-2012
           (param[33] = new OracleParameter("p_itr_gran_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_stus; //add chamal 17-08-2012
           (param[34] = new OracleParameter("p_itr_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal1; //add scahith 2012/11/3
           (param[35] = new OracleParameter("p_itr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal2; //add scahith 2013/02/15
           (param[36] = new OracleParameter("p_itr_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_seq_no; //add Prabhath 2013/02/23
           (param[37] = new OracleParameter("P_itr_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_line; //add tharaka 2014-10-30
           param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           seqno = UpdateRecords("sp_updateInventoryRequest ", CommandType.StoredProcedure, param);
           _inventoryRequest.Itr_seq_no = seqno;
           return seqno;
       }
       public DataTable Getmovsubtp(string _maintype)
       {
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_mmst_mct_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maintype;
           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable tblDet = QueryDataTable("tblchnl", "sp_getnbooknlevel", CommandType.StoredProcedure, false, param);
           return tblDet;
       }


       public Int32 validateItemAndSerial(Int32 seq, int itmline)
       {
           try
           {
               int vali = 0;
               OracleParameter[] param = new OracleParameter[3];
               (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
               (param[1] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmline;
               param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
               vali = UpdateRecords("SP_VALIDATE_TEMPITMANDSER", CommandType.StoredProcedure, param);
               return vali;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }
       //Dulaj 2018-Sep-04
       public DataTable LoadCusdecDatabyDoc(string doc)
       {
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;

           param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _dtResults = QueryDataTable("imp_cus_hdr", "getcusdatabysino", CommandType.StoredProcedure, false, param);
           return _dtResults;
       }

       public DataTable GetBinBalbyitm(string p_com, string p_itm_code, string p_inb_loc, string p_inb_bin)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
           (param[1] = new OracleParameter("p_itm_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itm_code;
           (param[2] = new OracleParameter("p_inb_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inb_loc;
           (param[3] = new OracleParameter("p_inb_bin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inb_bin;
           param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblData = QueryDataTable("tbData", "sp_check_bin_bal", CommandType.StoredProcedure, false, param);

           return _tblData;
       }
        //Dulaj 2018/Sep/17
       public Decimal GetBufferLevelInrLocation(string com, string itmCd, string loc)
       {
           decimal bufferlvl = 0;
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_itmCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
           (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
           param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblData = QueryDataTable("tbData", "GetBufferLevelInrLocation", CommandType.StoredProcedure, false, param);
           if (_tblData!=null)
           {
              bufferlvl = Convert.ToDecimal(_tblData.Rows[0]["BUFFER_QTY"].ToString());
           }
           return bufferlvl;
       }
      
       public DataTable BillCollection(DateTime _fromdate, DateTime _todate, string in_Company, string _pc, string in_user_id)
       {
           //Wimal 11/Sep/2018 Bill Collection Summery/Detail report
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
           (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
           (param[2] = new OracleParameter("p_frmDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
           (param[3] = new OracleParameter("p_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tblCourierDaSum", "sp_getBill_Coll", CommandType.StoredProcedure, false, param);


           return _result;
       }
       public Int32 update_frm_loc(string _loc, Int32 _seq, string _modby, string _itr_stus)
       {
           Int32 seqno = 0;
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_itr_issue_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[1] = new OracleParameter("p_itr_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
           (param[2] = new OracleParameter("p_itr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _modby;
           (param[3] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itr_stus;

           param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           seqno = UpdateRecords("sp_update_frm_loc", CommandType.StoredProcedure, param);

           return seqno;
       }       

       public DataTable get_age_monitoring(string _userId)
       {
           //Wimal 02/Sep/2018
           try
           {
               OracleParameter[] param = new OracleParameter[2];
               param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
               DataTable _dtResults = QueryDataTable("tbData", "sp_get_age_monitoring", CommandType.StoredProcedure, false, param);
               return _dtResults;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public Int32 delete_age_monitoring(string _userId)
       {
           //Wimal 02/Sep/2018
           try
           {
               OracleParameter[] param = new OracleParameter[2];
               (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
               param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
               Int32 seqno = UpdateRecords("sp_delete_age_monitoring", CommandType.StoredProcedure, param);
               return seqno;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public Int32 update_age_monitoring(string _userId, Int32 _isAsAt)
       {
           //Wimal 02/Sep/2018
           try
           {
               OracleParameter[] param = new OracleParameter[3];
               (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
               (param[1] = new OracleParameter("p_isAsat", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _isAsAt;
               param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
               Int32 seqno = UpdateRecords("sp_update_age_monitoring", CommandType.StoredProcedure, param);
               //DataTable _dtResults = QueryDataTable("tmpRepSer", "sp_update_age_monitoring", CommandType.StoredProcedure, false, param);
               //return _dtResults.Rows.Count;              
               return seqno;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }
      
       public DataTable getSlowMovingDetl(string p_company, string p_loc, DateTime p_fromdate, DateTime p_todate,
                                          string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode,
                                          decimal p_fromqty, decimal p_toqty)
       {
           try
           {
               //Wimal 05/Oct/2018
               OracleParameter[] param = new OracleParameter[15];
               (param[0] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_company;
               (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_loc;
               (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_fromdate;
               (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_todate;
               (param[4] = new OracleParameter("p_FromQty", OracleDbType.Int16, null, ParameterDirection.Input)).Value = p_fromqty;
               (param[5] = new OracleParameter("p_toQty", OracleDbType.Int16, null, ParameterDirection.Input)).Value = p_toqty;
               (param[6] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
               (param[7] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
               (param[8] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
               (param[9] = new OracleParameter("p_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
               (param[10] = new OracleParameter("p_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
               (param[11] = new OracleParameter("p_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
               (param[12] = new OracleParameter("p_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
               (param[13] = new OracleParameter("p_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
               param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               DataTable _dtResults = QueryDataTable("tblRef", "SP_GET_SLOW_MOVINGITM_DET", CommandType.StoredProcedure, false, param);
               return _dtResults;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }
      
       public Int32 update_age_slt(string _userId, Int32 _ageSlt01, Int32 _ageSlt02, Int32 _ageSlt03, Int32 _ageSlt04, Int32 _ageSlt05)
       {
           //Wimal 02/Sep/2018
           try
           {
               OracleParameter[] param = new OracleParameter[8];
               (param[0] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
               (param[1] = new OracleParameter("p_ageSlt01", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageSlt01;
               (param[2] = new OracleParameter("p_ageSlt02", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageSlt02;
               (param[3] = new OracleParameter("p_ageSlt03", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageSlt03;
               (param[4] = new OracleParameter("p_ageSlt04", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageSlt04;
               (param[5] = new OracleParameter("p_ageSlt05", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageSlt05;
               (param[6] = new OracleParameter("p_ageSlt06", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageSlt05;
               param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
               Int32 seqno = UpdateRecords("sp_update_age_slot", CommandType.StoredProcedure, param);
               return seqno;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public DataTable GetQRMethod(string com, Int32 method)
       {
           DataTable _tblData = new DataTable();
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_method", OracleDbType.Int32, null, ParameterDirection.Input)).Value = method;
           param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _tblData = QueryDataTable("tbData", "SP_GETQRMETHOD", CommandType.StoredProcedure, false, param);
            return _tblData;
       }
       public Int32 GetItemQrMethod(string itmCd)
       {           
           Int32 qrMethod = 0;
           OracleParameter[] param = new OracleParameter[2];
           (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;           
           param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _tblData = QueryDataTable("tbData", "SP_ITEMQRMETHOD", CommandType.StoredProcedure, false, param);
           if(_tblData!=null)
           {
                if(_tblData.Rows.Count>0)
                {
                    if(!(string.IsNullOrEmpty(_tblData.Rows[0]["MI_QR_METHOD"].ToString())))
                    {
                        qrMethod = Convert.ToInt32(_tblData.Rows[0]["MI_QR_METHOD"].ToString());
                    }
                }
           }
           return qrMethod;
       }
       public Int32 DeleteKitItemsBySeq(Int32 seq)
       {

           OracleParameter[] param = new OracleParameter[1];

           (param[0] = new OracleParameter("p_kit_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;                     
           OracleParameter outParameter = new OracleParameter("kit_seq_no", OracleDbType.Int32, null, ParameterDirection.Output);
           int kit_seq_no = ReturnSP_SingleValue("SP_DELTE_KIT_BY_SEQ", CommandType.StoredProcedure, outParameter, param);
           //ConnectionClose();
           return kit_seq_no;

       }
      

       public DataTable getCustomerInvoiceData(string company, string customer, string item, string model, string catgory, string invno)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[7];
               (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
               (param[1] = new OracleParameter("p_cuscd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
               (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
               (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
               (param[4] = new OracleParameter("p_catgory", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = catgory;
               (param[5] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno; 
               param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

               DataTable _result = QueryDataTable("tblCourierDaSum", "SP_GET_ADVANCEDCUSTOMERINVOICE", CommandType.StoredProcedure, false, param);
               return _result;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }
       public DataTable getCustomerJobHistoryData(string company, string customer, string item, string model, string catgory, string serial, string invno)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[8];
               (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
               (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
               (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
               (param[3] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
               (param[4] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customer;
               (param[5] = new OracleParameter("p_cate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = catgory;
               (param[6] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
               param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

               DataTable _result = QueryDataTable("tblCourierDaSum", "SP_GET_ADVANCEDSCVJOBDET", CommandType.StoredProcedure, false, param);
               return _result;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public DataTable getSerialDoDetails(string com, string serial)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[3];
               (param[0] = new OracleParameter("p_serial", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serial;
               (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com; 
               param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               DataTable _result = QueryDataTable("tblCourierDaSum", "SP_GET_SERIALDOCUSTOMER", CommandType.StoredProcedure, false, param);
               return _result;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public DataTable getInvoiceDetails(string com, string invno)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[3];
               (param[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
               (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
               param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               DataTable _result = QueryDataTable("tblCourierDaSum", "SP_GET_JOBINVCUSTOMER", CommandType.StoredProcedure, false, param);
               return _result;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }
       public List<InventoryHeader> GET_CREDT_N_ORD_DO(String Com, String OthDoc)
       {
           List<InventoryHeader> oResult = new List<InventoryHeader>();
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;

           (param[1] = new OracleParameter("P_OTH_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OthDoc;
           param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _tblScan = QueryDataTable("MST_COM_LOGI_COST", "SP_GET_CREDT_N_ORD_DO", CommandType.StoredProcedure, false, param);

           if (_tblScan.Rows.Count > 0)
           {
               //oResult = DataTableExtensions.ToGenericList<InventoryHeader>(_tblScan, InventoryHeader.ConvertTotal)[0];


               oResult = DataTableExtensions.ToGenericList<InventoryHeader>(_tblScan, InventoryHeader.ConvertTotal);


           }
           return oResult;
       }
       public Boolean IsExternalServiceAgent_AGENT(string _com, string _code)
       {
           OracleParameter[] _para = new OracleParameter[3];
           (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (_para[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

           _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           Boolean _isExternal = QueryDataTable("tbl", "sp_chk_ext_agt", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

           return _isExternal;
       }
     
       public List<BMT_INV_BAL_GIT> getBalanceGitData(string com, Int32 seq, string location, DateTime toDate)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[5];
               List<BMT_INV_BAL_GIT> git = new List<BMT_INV_BAL_GIT>();
               param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
               (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
               (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
               (param[4] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;

               DataTable _dtResults = QueryDataTable("tbl", "GET_BALANCE_GITDATA", CommandType.StoredProcedure, false, param);
               if (_dtResults.Rows.Count > 0)
               {
                   git = DataTableExtensions.ToGenericList<BMT_INV_BAL_GIT>(_dtResults, BMT_INV_BAL_GIT.Converter);
               }
               return git;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public int updateExistsGitData(BMT_INV_BAL_GIT bmtsaledata, DateTime toDt, DateTime fromDT)
       {
           try
           {
               string wedret = "";
               string chnl = "";
               string newadminteam = "";
               //Console.WriteLine("Start get location details " + bmtsaledata.BMI_OTH_LOC);
               ReptCommonDAL _reportDAL = new ReptCommonDAL();
               _reportDAL.ConnectionOpen();
               DataTable locdet = _reportDAL.getLocationDetails(bmtsaledata.BMI_OTH_LOC, bmtsaledata.BMI_COM_CD);
               if (locdet.Rows.Count > 0)
               {
                   chnl = (locdet.Rows[0]["CHNL"] != DBNull.Value) ? locdet.Rows[0]["CHNL"].ToString() : "";
                   newadminteam = (locdet.Rows[0]["ADMINTEAM"] != DBNull.Value) ? locdet.Rows[0]["ADMINTEAM"].ToString() : "";
                   if ((bmtsaledata.BMI_COM_CD == "ABL" || bmtsaledata.BMI_COM_CD == "LRP") && chnl != "")
                   {

                       if (chnl == "RRC1" || chnl == "RRE2" || chnl == "RSER" || chnl == "MRC1" || chnl == "MRE2" ||
                           chnl == "DGC" || chnl == "MRC4" || chnl == "VRC1" || chnl == "VRE2" || chnl == "VMC1" ||
                           chnl == "VME2" || chnl == "VDGC")
                       {
                           wedret = "RETAIL";
                       }
                       else
                       {
                           wedret = "WED";
                       }
                   }

               }
               //Console.WriteLine("End get location details " + bmtsaledata.BMI_OTH_LOC);
               //_reportDAL.ConnectionCloseEMS();

               OracleParameter[] param = new OracleParameter[8];
               Int32 res = 0;
               param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_DOC_NO;
               (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_ITM_CD;
               (param[3] = new OracleParameter("p_bseitmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_ITEM_LINE;
               (param[4] = new OracleParameter("p_bsebtchline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_BATCH_LINE;
               (param[5] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_OTH_LOC;
               (param[6] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt.Date;
               (param[7] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDT.Date;
               DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ALREADYINGITDATA", CommandType.StoredProcedure, false, param);
               if (_dtResults.Rows.Count > 0)
               {
                   decimal cnt = (_dtResults.Rows[0]["tot"] != DBNull.Value) ? Convert.ToDecimal(_dtResults.Rows[0]["tot"].ToString()) : 0;

                   if (bmtsaledata.BMI_AGE_QTY_T - cnt != 0)
                   {
                       bmtsaledata.BMI_AGE_COST_T = (bmtsaledata.BMI_AGE_COST_T / bmtsaledata.BMI_AGE_QTY_T) * (bmtsaledata.BMI_AGE_QTY_T - cnt);
                       bmtsaledata.BMI_AGE_QTY_T = bmtsaledata.BMI_AGE_QTY_T - cnt;
                       if (bmtsaledata.BMI_COM_CD == "ABL" || bmtsaledata.BMI_COM_CD == "LRP" || bmtsaledata.BMI_COM_CD == "SGL" || bmtsaledata.BMI_COM_CD == "SGD")
                       {
                           bmtsaledata.BMI_SEQ_NO = bmtsaledata.BMI_SEQ_NO + 2;
                       }
                       else
                       {
                           bmtsaledata.BMI_SEQ_NO = bmtsaledata.BMI_SEQ_NO + 1;
                       }
                       bmtsaledata.BMI_CHNL_CD = chnl;
                       bmtsaledata.BMI_ADMIN_TEAM = newadminteam;
                       bmtsaledata.BMI_GROUP = wedret;
                       res = updateBalanceItemToTempGit(bmtsaledata);
                       if (res < 0)
                       {
                           return 0;
                       }
                   }
               }
               return res;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public List<INT_HDR> getAllOutDocuments(DateTime frmDate, DateTime rundate, string comp, string location)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[5];
               List<INT_HDR> _list = new List<INT_HDR>();
               param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
               (param[1] = new OracleParameter("P_FRMDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDate.Date;
               (param[2] = new OracleParameter("P_TODT", OracleDbType.Date, null, ParameterDirection.Input)).Value = rundate.Date;
               (param[3] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comp;
               (param[4] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = location;
               DataTable _dtResults = QueryDataTable("tbl", "SP_GET_AODOUTDOC", CommandType.StoredProcedure, false, param);
               if (_dtResults.Rows.Count > 0)
               {
                   _list = DataTableExtensions.ToGenericList<INT_HDR>(_dtResults, INT_HDR.Converter);
               }
               return _list;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public Int32 updateAgingDetails(int seq, DateTime dat, string loc, string company, int ageSlt1, int ageSlt2, int ageSlt3, int ageSlt4, int ageSlt5)
       {
           try
           {
               OracleParameter[] param = new OracleParameter[10];
               List<INT_BATCH> _list = new List<INT_BATCH>();
               (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
               (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = dat.Date;
               (param[2] = new OracleParameter("p_location", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
               (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
               (param[4] = new OracleParameter("p_ageSlt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ageSlt1;
               (param[5] = new OracleParameter("p_ageSlt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ageSlt2;
               (param[6] = new OracleParameter("p_ageSlt3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ageSlt3;
               (param[7] = new OracleParameter("p_ageSlt4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ageSlt4;
               (param[8] = new OracleParameter("p_ageSlt5", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ageSlt5;
               param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
               Int32 eff = UpdateRecords("SP_UPDATE_GITAGELIVE1", CommandType.StoredProcedure, param);

               return eff;
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public void updateValidatedGitData(INT_HDR docs, string com, Int32 seq, DateTime rundate, DateTime frmDate)
       {
           try
           {
               string wedret = "";
               string chnl = "";
               string newadminteam = "";
               Console.WriteLine("Start get location details " + docs.ITH_OTH_LOC);
               ReptCommonDAL _reportDAL = new ReptCommonDAL();
               _reportDAL.ConnectionOpen();
               DataTable locdet = _reportDAL.getLocationDetails(docs.ITH_OTH_LOC, docs.ITH_COM);
               if (locdet.Rows.Count > 0)
               {
                   chnl = (locdet.Rows[0]["CHNL"] != DBNull.Value) ? locdet.Rows[0]["CHNL"].ToString() : "";
                   newadminteam = (locdet.Rows[0]["ADMINTEAM"] != DBNull.Value) ? locdet.Rows[0]["ADMINTEAM"].ToString() : "";
                   if ((docs.ITH_COM == "ABL" || docs.ITH_COM == "LRP") && chnl != "")
                   {

                       if (chnl == "RRC1" || chnl == "RRE2" || chnl == "RSER" || chnl == "MRC1" || chnl == "MRE2" ||
                           chnl == "DGC" || chnl == "MRC4" || chnl == "VRC1" || chnl == "VRE2" || chnl == "VMC1" ||
                           chnl == "VME2" || chnl == "VDGC")
                       {
                           wedret = "RETAIL";
                       }
                       else
                       {
                           wedret = "WED";
                       }
                   }

               }
               Console.WriteLine("End get location details " + docs.ITH_COM);
               _reportDAL.ConnectionClose();
               OracleParameter[] param = new OracleParameter[2];
               List<INT_BATCH> _list = new List<INT_BATCH>();
               param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
               (param[1] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = docs.ITH_SEQ_NO;
               DataTable _dtResults = QueryDataTable("tbl", "SP_GET_AODOUTDOCITEMS", CommandType.StoredProcedure, false, param);
               if (_dtResults.Rows.Count > 0)
               {
                   _list = DataTableExtensions.ToGenericList<INT_BATCH>(_dtResults, INT_BATCH.Converter);
                   foreach (INT_BATCH outdocbtch in _list)
                   {
                       OracleParameter[] inparam = new OracleParameter[9];
                       inparam[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                       (inparam[1] = new OracleParameter("P_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docs.ITH_DOC_NO;
                       (inparam[2] = new OracleParameter("P_ITMLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = outdocbtch.ITB_ITM_LINE;
                       (inparam[3] = new OracleParameter("P_BATCHLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = outdocbtch.ITB_BATCH_LINE;
                       (inparam[4] = new OracleParameter("P_ITMCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = outdocbtch.ITB_ITM_CD;
                       (inparam[5] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                       (inparam[6] = new OracleParameter("P_TODT", OracleDbType.Date, null, ParameterDirection.Input)).Value = rundate.Date;
                       (inparam[7] = new OracleParameter("P_FRMDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDate.Date;
                       (inparam[8] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docs.ITH_OTH_LOC;
                       DataTable _dtInDocResults = QueryDataTable("tbl", "SP_GET_OUTDOCINITEMQTYCNT", CommandType.StoredProcedure, false, inparam);
                       if (_dtInDocResults.Rows.Count > 0)
                       {
                           decimal totCnt = (_dtInDocResults.Rows[0]["inQty"] != DBNull.Value) ? Convert.ToDecimal(_dtInDocResults.Rows[0]["inQty"].ToString()) : 0;
                           decimal balance = outdocbtch.ITB_QTY - totCnt;

                           if (balance > 0)
                           {
                               BMT_INV_BAL_GIT bmtsaledata = new BMT_INV_BAL_GIT();
                               if (com == "ABL" || com == "LRP" || com == "SGL" || com == "SGD")
                               {
                                   bmtsaledata.BMI_SEQ_NO = seq + 2;
                               }
                               else
                               {
                                   bmtsaledata.BMI_SEQ_NO = seq + 1;
                               }

                               bmtsaledata.BMI_COM_CD = outdocbtch.ITB_COM;
                               bmtsaledata.BMI_LOC_CD = outdocbtch.ITB_LOC;
                               bmtsaledata.BMI_CHNL_CD = chnl;
                               bmtsaledata.BMI_ITM_CD = outdocbtch.ITB_ITM_CD;
                               bmtsaledata.BMI_ITM_STUS = outdocbtch.ITB_ITM_STUS;
                               bmtsaledata.BMI_AGE_QTY1 = 0;
                               bmtsaledata.BMI_AGE_COST1 = 0;
                               bmtsaledata.BMI_AVG_COST1 = 0;
                               bmtsaledata.BMI_AGE_QTY2 = 0;
                               bmtsaledata.BMI_AGE_COST2 = 0;
                               bmtsaledata.BMI_AVG_COST2 = 0;
                               bmtsaledata.BMI_AGE_QTY3 = 0;
                               bmtsaledata.BMI_AGE_COST3 = 0;
                               bmtsaledata.BMI_AVG_COST3 = 0;
                               bmtsaledata.BMI_AGE_QTY4 = 0;
                               bmtsaledata.BMI_AGE_COST4 = 0;
                               bmtsaledata.BMI_AVG_COST4 = 0;
                               bmtsaledata.BMI_AGE_QTY5 = 0;
                               bmtsaledata.BMI_AGE_COST5 = 0;
                               bmtsaledata.BMI_AVG_COST5 = 0;
                               bmtsaledata.BMI_AGE_QTY6 = 0;
                               bmtsaledata.BMI_AGE_COST6 = 0;
                               bmtsaledata.BMI_AVG_COST6 = 0;
                               bmtsaledata.BMI_AGE_QTY_T = balance;
                               bmtsaledata.BMI_AGE_COST_T = outdocbtch.ITB_UNIT_COST * balance;
                               bmtsaledata.BMI_AVG_COST_T = 0;
                               bmtsaledata.BMI_DOC_TP = "";
                               bmtsaledata.BMI_DOC_NO = docs.ITH_DOC_NO;
                               bmtsaledata.BMI_DOC_DT = docs.ITH_DOC_DATE;
                               bmtsaledata.BMI_ITEM_LINE = outdocbtch.ITB_ITM_LINE;
                               bmtsaledata.BMI_OTH_LOC = docs.ITH_OTH_LOC;
                               bmtsaledata.BMI_REF_DOC_NO = docs.ITH_DOC_NO;
                               bmtsaledata.BMI_LOG_SEQ = 0;
                               bmtsaledata.BMI_BATCH_LINE = outdocbtch.ITB_BATCH_LINE;
                               bmtsaledata.BMI_GIT_CLOSE = 0;
                               bmtsaledata.BMI_GIT_CLOSE_DT = DateTime.MinValue;
                               bmtsaledata.BMI_SCM_DOC = "";
                               bmtsaledata.BMI_ADMIN_TEAM = newadminteam;
                               bmtsaledata.BMI_GROUP = wedret;
                               Int32 res = updateBalanceItemToTempGit(bmtsaledata);

                           }
                       }
                   }
               }
           }
           catch (Exception ex)
           {
               throw ex;
           }
       }

       public Int32 updateBalanceItemToTempGit(BMT_INV_BAL_GIT bmtsaledata)
       {
           Int32 eff = 0;
           OracleParameter[] insparam = new OracleParameter[42];
           (insparam[0] = new OracleParameter("P_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_SEQ_NO;
           (insparam[1] = new OracleParameter("P_COM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_COM_CD;
           (insparam[2] = new OracleParameter("P_LOC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_LOC_CD;
           (insparam[3] = new OracleParameter("P_CHNL_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_CHNL_CD;
           (insparam[4] = new OracleParameter("P_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_ITM_CD;
           (insparam[5] = new OracleParameter("P_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_ITM_STUS;
           (insparam[6] = new OracleParameter("P_AGE_QTY1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY1;
           (insparam[7] = new OracleParameter("P_AGE_COST1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST1;
           (insparam[8] = new OracleParameter("P_AVG_COST1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST1;
           (insparam[9] = new OracleParameter("P_AGE_QTY2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY2;
           (insparam[10] = new OracleParameter("P_AGE_COST2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST2;
           (insparam[11] = new OracleParameter("P_AVG_COST2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST2;
           (insparam[12] = new OracleParameter("P_AGE_QTY3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY3;
           (insparam[13] = new OracleParameter("P_AGE_COST3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST3;
           (insparam[14] = new OracleParameter("P_AVG_COST3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST3;
           (insparam[15] = new OracleParameter("P_AGE_QTY4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY4;
           (insparam[16] = new OracleParameter("P_AGE_COST4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST4;
           (insparam[17] = new OracleParameter("P_AVG_COST4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST4;
           (insparam[18] = new OracleParameter("P_AGE_QTY5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY5;
           (insparam[19] = new OracleParameter("P_AGE_COST5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST5;
           (insparam[20] = new OracleParameter("P_AVG_COST5", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST5;
           (insparam[21] = new OracleParameter("P_AGE_QTY6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY6;
           (insparam[22] = new OracleParameter("P_AGE_COST6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST6;
           (insparam[23] = new OracleParameter("P_AVG_COST6", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST6;
           (insparam[24] = new OracleParameter("P_AGE_QTY_T", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_QTY_T;
           (insparam[25] = new OracleParameter("P_AGE_COST_T", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AGE_COST_T;
           (insparam[26] = new OracleParameter("P_AVG_COST_T", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_AVG_COST_T;
           (insparam[27] = new OracleParameter("P_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_DOC_TP;
           (insparam[28] = new OracleParameter("P_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_DOC_NO;
           (insparam[29] = new OracleParameter("P_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_DOC_DT;
           (insparam[30] = new OracleParameter("P_ITEM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_ITEM_LINE;
           (insparam[31] = new OracleParameter("P_OTH_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_OTH_LOC;
           (insparam[32] = new OracleParameter("P_REF_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_REF_DOC_NO;
           (insparam[33] = new OracleParameter("P_LOG_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_LOG_SEQ;
           (insparam[34] = new OracleParameter("P_BATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_BATCH_LINE;
           (insparam[35] = new OracleParameter("P_GIT_CLOSE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_GIT_CLOSE;
           (insparam[36] = new OracleParameter("P_GIT_CLOSE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_GIT_CLOSE_DT;
           (insparam[37] = new OracleParameter("P_SCM_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_SCM_DOC;
           (insparam[38] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_CHNL_CD;
           (insparam[39] = new OracleParameter("p_adminteam", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_ADMIN_TEAM;
           (insparam[40] = new OracleParameter("p_group", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bmtsaledata.BMI_GROUP;


           insparam[41] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

           eff = UpdateRecords("SP_UPDATE_TEMPGITDATA", CommandType.StoredProcedure, insparam);

           return eff;
       }
       public DataTable check_ser_in_by_srn(string com, string invno, string itm, string ser, string serid)//add by tharanga 2018/11/05
       {
         
               OracleParameter[] param = new OracleParameter[6];
               (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
               (param[1] = new OracleParameter("p_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
               (param[2] = new OracleParameter("p_itm_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm;
               (param[3] = new OracleParameter("p_ser_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ser;
               (param[4] = new OracleParameter("p_serid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = serid;
               param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
               DataTable _result = QueryDataTable("tblCourierDaSum", "sp_chk_ser_reseve_bysrn", CommandType.StoredProcedure, false, param);
               return _result;
         
       }
       public Mst_Movsubtp get_sub_type(string _maintype, string _subtype)
       {
           Mst_Movsubtp _list = new Mst_Movsubtp();
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("p_mmst_mct_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _maintype;
           (param[1] = new OracleParameter("p_mmst_mst_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subtype;
           param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _dtResults = QueryDataTable("tbl", "sp_get_sub_typenew", CommandType.StoredProcedure, false, param);
           if (_dtResults.Rows.Count > 0)
           {
               _list = DataTableExtensions.ToGenericList<Mst_Movsubtp>(_dtResults, Mst_Movsubtp.Converternew)[0];
           }
           return _list;
       }
       public Int16 UpdateCustDecHdr(string com, string _docno, string modBy, string session)
       {
           OracleParameter[] param = new OracleParameter[5];
           Int16 effects = 0;
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
           (param[2] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modBy;
           (param[3] = new OracleParameter("p_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = session;
           param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int16)UpdateRecords("SP_UPDATE_CusDec", CommandType.StoredProcedure, param);
           return effects;
       }
        //Dulaj 2018/Dec/13
       public DataTable GetAutoAODRestrictionDef(string _company, string _type, string _frmCd, string _toCd)
       {           
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
           (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
           (param[2] = new OracleParameter("p_from_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _frmCd;
           (param[3] = new OracleParameter("p_to_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toCd;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _tbl = QueryDataTable("ResTbl", "sp_get_auto_aod_restrict", CommandType.StoredProcedure, false, param);
           return _tbl;
       }

       public DataTable get_depreciation_PPNote(string _com, string _loc, DateTime _FDate, DateTime _TDate,
                                               string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode,
                                               string _user_id)
       {
           // Wimal @ 11/Oct/2018
           OracleParameter[] param = new OracleParameter[15];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_asatDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FDate.AddDays(-1);
           (param[3] = new OracleParameter("p_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FDate;
           (param[4] = new OracleParameter("p_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TDate;
           (param[5] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
           (param[6] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
           (param[7] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
           (param[8] = new OracleParameter("p_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
           (param[9] = new OracleParameter("p_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
           (param[10] = new OracleParameter("p_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
           (param[11] = new OracleParameter("p_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
           (param[12] = new OracleParameter("p_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
           (param[13] = new OracleParameter("p_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
           param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "sp_get_depre_ppnote", CommandType.StoredProcedure, false, param);
           return _result;
       }

       public DataTable get_depreciation_Disposal(string _com, string _loc, DateTime _FDate, DateTime _TDate, string _user_id)
       {
           // Wimal @ 11/Oct/2018
           OracleParameter[] param = new OracleParameter[6];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FDate;
           (param[3] = new OracleParameter("p_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _TDate;
           (param[4] = new OracleParameter("p_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
           param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "sp_get_depre_Disposal", CommandType.StoredProcedure, false, param);
           return _result;
       }

       public DataTable get_depreciation_Summery(string _com, string _loc, DateTime _asatDate,
        string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode,
        string _user_id)
       {
           // Wimal @ 11/Oct/2018
           OracleParameter[] param = new OracleParameter[13];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_asatDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
           (param[3] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
           (param[4] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
           (param[5] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
           (param[6] = new OracleParameter("p_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
           (param[7] = new OracleParameter("p_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
           (param[8] = new OracleParameter("p_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
           (param[9] = new OracleParameter("p_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
           (param[10] = new OracleParameter("p_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
           (param[11] = new OracleParameter("p_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
           param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "sp_get_depre_summery", CommandType.StoredProcedure, false, param);
           return _result;
       }
       //Dulaj 2019/Jan/24
       public DataTable GetSerialItmAge(string _com, string _itmCd, string _status, DateTime ageDt)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCd;
           (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
           (param[3] = new OracleParameter("p_ageDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = ageDt;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "SP_GET_SER_AGE", CommandType.StoredProcedure, false, param);
           return _result;
       }
       public DataTable GetSerialNonSerialItmAgeBatch(string _com, string _itmCd, string _status, DateTime age)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCd;
           (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
           (param[3] = new OracleParameter("p_age", OracleDbType.Date, null, ParameterDirection.Input)).Value = age;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "SP_GET_NON_SER_SER_AGE", CommandType.StoredProcedure, false, param);
           return _result;
       }
       public DataTable GetGITItmAge(string _com, string _itmCd, string _status, decimal age)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCd;
           (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
           (param[3] = new OracleParameter("p_age", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = age;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "SP_GET_GIT_AGE", CommandType.StoredProcedure, false, param);
           return _result;
       }
       public DataTable GetNonSerialItmAge(string _com, string _itmCd, string _status, DateTime age)
       {
           OracleParameter[] param = new OracleParameter[5];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmCd;
           (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
           (param[3] = new OracleParameter("p_age", OracleDbType.Date, null, ParameterDirection.Input)).Value = age;
           param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable _result = QueryDataTable("tbl", "SP_GET_NON_SER_AGE", CommandType.StoredProcedure, false, param);
           return _result;
       }
       public Int32 GetSerialIDfor_audit()
       {
           OracleParameter[] param = new OracleParameter[1];
           Int32 effects = 0;

           param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
           effects = (Int32)UpdateRecords("sp_get_aud_serialid", CommandType.StoredProcedure, param);
           return effects;
       }
       public List<InventoryRequest> Get_inr_Req(string com, string itr_tp, string itr_sub_tp, string itr_loc, DateTime itr_dt, string itr_job_no, string itr_anal2)
       {
           OracleParameter[] param = new OracleParameter[8];
           List<InventoryRequest> _list = null;
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           (param[1] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_tp;
           (param[2] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_sub_tp;
           (param[3] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_loc;
           (param[4] = new OracleParameter("p_itr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = itr_dt;
           (param[5] = new OracleParameter("p_itr_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_job_no;
           (param[6] = new OracleParameter("p_itr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itr_anal2;
           param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           //Query Data base.
           DataTable _dtResults = QueryDataTable("tbl", "sp_get_req_det", CommandType.StoredProcedure, false, param);

           if (_dtResults.Rows.Count > 0)
           {
               _list = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter);
           }
           return _list;
       }

       public int checkLocationWHType(string loctp)
       {
           OracleParameter[] param = new OracleParameter[2];
           Int32 res = 1;
           (param[0] = new OracleParameter("p_loctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loctp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output); 
           DataTable _dtResults = QueryDataTable("tbl", "sp_get_locationtypedet", CommandType.StoredProcedure, false, param);
           if (_dtResults.Rows.Count > 0)
           {
               if (_dtResults.Rows[0]["RLT_IS_WH"] != DBNull.Value)
               {
                   res = Convert.ToInt32(_dtResults.Rows[0]["RLT_IS_WH"].ToString());
               }
           }
           return res;
       }
       public List<FF.BusinessObjects.Financial.TobondItemQty> GetEntryQty_new(String docno, Int32 lineno, string com)
       {
           List<FF.BusinessObjects.Financial.TobondItemQty> oResult = null;
           OracleParameter[] param = new OracleParameter[4];
           (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
           (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
           (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
           param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_CHECKENTRYQTY", CommandType.StoredProcedure, false, param);
           if (dtTemp.Rows.Count > 0)
           {
               oResult = DataTableExtensions.ToGenericList<FF.BusinessObjects.Financial.TobondItemQty>(dtTemp, FF.BusinessObjects.Financial.TobondItemQty.Converter);
           }
           return oResult;
       }
       public List<TobondItemQty> GetTobondQty_new(String docno, Int32 lineno)
       {
           List<TobondItemQty> oResult = null;
           OracleParameter[] param = new OracleParameter[3];
           (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
           (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
           param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
           DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_CHECKTOBONDQTY", CommandType.StoredProcedure, false, param);

           if (dtTemp.Rows.Count > 0)
           {
               oResult = DataTableExtensions.ToGenericList<TobondItemQty>(dtTemp, TobondItemQty.Converter);
           }
           return oResult;
       }
       //public DataTable GetBankGrntAmt(string _com, string _loc)
       //{
       //    OracleParameter[] param = new OracleParameter[3];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "sp_getbankgrntamt", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       //public DataTable GetInvDoc(string _com, string _loc, string _invtyp, string _typ)
       //{
       //    OracleParameter[] param = new OracleParameter[5];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    (param[2] = new OracleParameter("p_invtyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invtyp;
       //    (param[3] = new OracleParameter("p_typ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _typ;
       //    param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "sp_get_inv_doc", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       // //dilshan 
       //public DataTable GetUnregOutstanding(string _com, string _loc, string _invtyp, string _typ)
       //{
       //    OracleParameter[] param = new OracleParameter[5];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    (param[2] = new OracleParameter("p_invtyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invtyp;
       //    (param[3] = new OracleParameter("p_typ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _typ;
       //    param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "SP_GET_UNREG_OUTSTANDING", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       //public DataTable GetGitBufferQty(string _com, string _loc, string _invtyp, string _typ)
       //{
       //    OracleParameter[] param = new OracleParameter[5];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    (param[2] = new OracleParameter("p_invtyp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invtyp;
       //    (param[3] = new OracleParameter("p_typ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _typ;
       //    param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "SP_GET_GIT_BUFFER_QTY", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       //public DataTable GetMRNAging(string _com, string _loc, string _itmcd, int _ageval, decimal _itmqty)
       //{
       //    OracleParameter[] param = new OracleParameter[6];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcd;
       //    (param[3] = new OracleParameter("p_age", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageval;
       //    (param[4] = new OracleParameter("p_itmqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itmqty;
       //    param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "sp_get_aging_qty", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       //public DataTable GetMRNAgingParam(string _com, string _loc, string _itmcd, string _typ)
       //{
       //    OracleParameter[] param = new OracleParameter[5];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcd;
       //    (param[3] = new OracleParameter("p_typ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _typ;
       //    param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "sp_get_aging_param", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       //public DataTable GetMRNBuffer(string _com, string _loc, string _itmcd, int _ageval, decimal _itmqty)
       //{
       //    OracleParameter[] param = new OracleParameter[6];
       //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
       //    (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
       //    (param[2] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcd;
       //    (param[3] = new OracleParameter("p_age", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ageval;
       //    (param[4] = new OracleParameter("p_itmqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _itmqty;
       //    param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "sp_get_locbuffer_qty", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
       //public DataTable GetCompItm(string _itmcd)
       //{
       //    OracleParameter[] param = new OracleParameter[2];
       //    (param[0] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcd;
       //    param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

       //    DataTable _resultDT = QueryDataTable("tblName", "sp_get_comp_itm", CommandType.StoredProcedure, false, param);
       //    return _resultDT;
       //}
        //dilshan on 11/02/2019
       public DataTable getpurchaseRegister(string _com, string _loc, string _purType, string _supplier, string _itemcode, string _cat1, string _cat2, DateTime _fromDate, DateTime _toDate, string doctype, string docno)
       {          
           OracleParameter[] param = new OracleParameter[12];
           (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
           (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
           (param[2] = new OracleParameter("p_purType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _purType;
           (param[3] = new OracleParameter("p_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
           (param[4] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
           (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
           (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
           (param[7] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
           (param[8] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
           (param[9] = new OracleParameter("doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
           (param[10] = new OracleParameter("docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
           param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

           DataTable _result = QueryDataTable("tbl", "SP_PURCHASEREGISTER_DET", CommandType.StoredProcedure, false, param);
           return _result;
       }
    }

}