using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using System.IO;
using Oracle.DataAccess.Client;
using FF.BusinessObjects;


using System.Net.Mail;
using FF.BusinessObjects.Financial;
using FF.BusinessObjects.BITool;
using FF.BusinessObjects.Commission;
using FF.BusinessObjects.Sales;
using FF.BusinessObjects.General;
using System.Text.RegularExpressions;
using FF.BusinessObjects.Account;

namespace FF.DataAccessLayer
{
    public class FinancialDAL : BaseDAL
    {
        //kapila 30/6/2017
        public Boolean check_overwriten_dayend(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (_para[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_check_day_end_ovrtn", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }
        public DataTable getValuationDetails_Insu(DateTime _fromtDate, DateTime _totDate, string _ItemClasif, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _Stktype, string _Com, string _Loc, string _User, Int32 _opseqno, Int32 _clsseqno, Int32 withsts)
        {
            OracleParameter[] param = new OracleParameter[19];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromtDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _totDate;
            (param[3] = new OracleParameter("in_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemClasif;
            (param[4] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[5] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[6] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[7] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[8] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[9] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[10] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[11] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[12] = new OracleParameter("in_stktype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Stktype;
            (param[13] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[14] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[15] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[16] = new OracleParameter("in_opseqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _opseqno;
            (param[17] = new OracleParameter("in_clsseqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _clsseqno;
            (param[18] = new OracleParameter("in_withsts", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = withsts;

            return QueryDataTable("int_hdr", "sp_get_valuation_dtl_insu", CommandType.StoredProcedure, false, param);
        }
        //kapila
        public DataTable GetSchPrd(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_sch_prd", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchInsu(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_insu", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchEcdDefn(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_ecd_defn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchGuaParm(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_gua_parm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchCCDefn(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_cc_defn", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchShed(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_sch_shed", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchOthChg(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_oth_chg", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchAddPara(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_add_para", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchSerChg(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_ser_chg", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchComm(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_hpr_sch_comm", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable GetSchDet(string _circ)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_sch_det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public Int32 UpdateExcsShortOthRem(string _ID, Int32 _week, string _sec, string _code, decimal _amt)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_esrd_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            (param[1] = new OracleParameter("p_ESRD_WEEK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[2] = new OracleParameter("p_ESRD_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[3] = new OracleParameter("p_ESRD_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_ESRD_set_Amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_sat_excs_set", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public int GetRemSumDetWOCurDt(string _com, DateTime _fromdate, DateTime _todate, DateTime _date, string _sec, string _code, string _pc, out Decimal _value, out Decimal _valueFinal)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[5] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[6] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_remit_WO_Date", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamtfinal"].ToString()))
                {
                    _valFinal = Convert.ToDecimal(_result.Rows[0]["totamtfinal"]);
                }
            }

            _value = _val;
            _valueFinal = _valFinal;
            return 1;
        }
        //kapila
        public DataTable GetCreditNoteDetails(DateTime _fromDate, DateTime _toDate, string _com, string _doctp, string _User)
        {
            //    
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_scm_reports.sp_print_crnote_details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable get_rem_sum_rep_recon(string _com, string _user, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_rem_sum_rep_recon", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public Decimal Get_Inr_sys_para(string _com, string _loc, string _item, string _itmstus, Int32 _qty)
        {
            OracleParameter[] param = new OracleParameter[5];
            Decimal effects = 0;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[3] = new OracleParameter("p_itmstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmstus;
            (param[4] = new OracleParameter("p_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _qty;

            OracleParameter _outParam = new OracleParameter("o_out_para", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_get_inr_sys_para", CommandType.StoredProcedure, _outParam, param));
            }
            catch
            {
                return effects;
            }
            return effects;
        }
        public DataTable GetAccVoucher(string _ref)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _tblData = QueryDataTable("tbl", "sp_gv_det", CommandType.StoredProcedure, false, param);

            return _tblData;
        }
        public DataTable GetCostByOthDoc(string _com, string _othdoc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_othdoc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othdoc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_cost_by_othdoc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAuditJobMain(string _mainjobno, string _jobno)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_mainjob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainjobno;
            (param[2] = new OracleParameter("in_subjob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_inv_main", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAuditJobMembers(string _jobno)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_subjob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_inv_member", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetCheckAnnualAuditJob(string _jobno)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_job", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults = QueryDataTable("tbl", "sp_check_annual_aud_job", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetForwardSalesAnnualAudit(string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_fwd_sale_audit", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetGITAnnualAudit(string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_unconf_aod_audit", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAuditJobDiffSerials(string _com, string _jobno)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_subjob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_inv_ser_diff", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetAuditJobRemarks(string _jobno)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_subjob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_aud_inv_remark", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //public int GetOriginalAccInsurance(string _com, string _revno, out decimal _value)
        public decimal GetOriginalAccInsurance(string _com, string _revno)
        {
            Decimal effects = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_revno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _revno;
            param[2] = new OracleParameter("o_val", OracleDbType.Decimal, null, ParameterDirection.Output);
            OracleParameter _outParam = new OracleParameter("o_out_para", OracleDbType.Decimal, null, ParameterDirection.Output);
            try
            {
                effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("sp_get_orig_ac_insu", CommandType.StoredProcedure, _outParam, param));
            }
            catch
            {
                return effects;
            }
            return effects;
        }
        public DataTable Get_credit_Outs_ByInv(string _com, string _pc, string _inv, string _user, Int32 _isOuts)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_outsonly", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isOuts;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);


            _dtResults = QueryDataTable("tbl", "pkg_outstanding.sp_get_outstanding", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Boolean isGVFound(string _ref, string _cust)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (_para[1] = new OracleParameter("p_custcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _fnd = QueryDataTable("tbl", "sp_check_gv_issue", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _fnd;
        }

        public DataTable getVouDetByCode(string _vou)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_voucd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_voudetbyvou", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getMyAbVouTypes()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_myab_voutp", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getVehRegComDetails(string _com, string _recno)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_sat_veh_reg_comp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable processIntroduComm(string _com, string _pc, DateTime _date, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;


            DataTable _tbl = QueryDataTable("tblPc", "SP_HP_PROMOT_COMM", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public Boolean IsChkVehRelease(string _inv)
        {
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;

            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _Found = QueryDataTable("tbl", "sp_chk_veh_release", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _Found;
        }
        public int UpdateCardMemberSerial(string _ser, string _cus, string _no, Int32 _isact)
        {

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_ser", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ser;
            (param[1] = new OracleParameter("p_cus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cus;
            (param[2] = new OracleParameter("p_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _no;
            (param[3] = new OracleParameter("p_isact", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isact;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updatecardmemberserial", CommandType.StoredProcedure, param);

            return result;

        }

        public int UpdatePromotCommHdr(string _circ, DateTime _todate, string _user)
        {

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_HPCH_CIRCULAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[1] = new OracleParameter("p_HPCH_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_upd_promocom_hdr", CommandType.StoredProcedure, param);

            return result;

        }

        public DataTable GetPromotCommDetails(Int32 _seq)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_promocommdetails", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public Int32 UpdateCashConvInv(string _accno, string _reqno)
        {

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqno;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_upd_CC_inv", CommandType.StoredProcedure, param);

            return result;
        }

        public int GetReversedCredVal(string _invno, decimal _revAmt, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[1] = new OracleParameter("p_revamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _revAmt;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_rev_crd_amt", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _value = _val;
            return 1;
        }
        public DataTable GetPromotCommHdr(string _com, string _circ)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_promocommHdr", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetPromotCommParty(Int32 _seq)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_promocommparty", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetPromotCommSaleTp(Int32 _seq)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_promocommsaletp", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable GetPromotCommSch(Int32 _seq)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_promocommsch", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetPromotCommDet(Int32 _seq)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_promocommdet", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<MasterInvoiceType> GetAllMainInvType()
        {
            List<MasterInvoiceType> _masterInvoiceType = new List<MasterInvoiceType>();
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblInvoiceType = QueryDataTable("tblInvoiceType", "sp_getallmaininvtype", CommandType.StoredProcedure, false, param);
            if (_tblInvoiceType.Rows.Count > 0)
            {
                _masterInvoiceType = DataTableExtensions.ToGenericList<MasterInvoiceType>(_tblInvoiceType, MasterInvoiceType.ConvertTotal);
            }

            return _masterInvoiceType;

        }

        public int SavePromotCommHdr(PromotComHdr _objHdr)
        {

            OracleParameter[] param = new OracleParameter[12];

            (param[0] = new OracleParameter("p_HPCH_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objHdr.Hpch_seq;
            (param[1] = new OracleParameter("p_HPCH_CIRCULAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objHdr.Hpch_circular;
            (param[2] = new OracleParameter("p_HPCH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objHdr.Hpch_com;
            (param[3] = new OracleParameter("p_HPCH_APP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objHdr.Hpch_app;
            (param[4] = new OracleParameter("p_HPCH_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objHdr.Hpch_act;
            (param[5] = new OracleParameter("p_HPCH_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _objHdr.Hpch_from_dt;
            (param[6] = new OracleParameter("p_HPCH_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _objHdr.Hpch_to_dt;
            (param[7] = new OracleParameter("p_HPCH_COM_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objHdr.Hpch_com_amt;
            (param[8] = new OracleParameter("p_HPCH_COM_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objHdr.Hpch_com_rt;
            (param[9] = new OracleParameter("p_HPCH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objHdr.Hpch_cre_by;
            (param[10] = new OracleParameter("p_HPCH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objHdr.Hpch_mod_by;
            param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_promocom_hdr", CommandType.StoredProcedure, param);

            return result;

        }
        public int SavePromotCommItem(PromotComItem _objItm)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_HPCI_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objItm.Hpci_seq;
            (param[1] = new OracleParameter("p_HPCI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objItm.Hpci_line;
            (param[2] = new OracleParameter("p_HPCI_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objItm.Hpci_tp;
            (param[3] = new OracleParameter("p_HPCI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objItm.Hpci_cd;
            (param[4] = new OracleParameter("p_HPCI_brnd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objItm.Hpci_brnd;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_promocom_item", CommandType.StoredProcedure, param);

            return result;

        }
        public int SavePromotCommSch(PromotComSch _objSch)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_HPCS_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSch.Hpcs_seq;
            (param[1] = new OracleParameter("p_HPCS_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSch.Hpcs_line;
            (param[2] = new OracleParameter("p_HPCS_SCH_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objSch.Hpcs_sch_cd;
            (param[3] = new OracleParameter("p_hpcd_from_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSch.Hpcs_from_qty;
            (param[4] = new OracleParameter("p_hpcd_to_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSch.Hpcs_to_qty;
            (param[5] = new OracleParameter("p_hpcd_com_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objSch.Hpcs_com_amt;
            (param[6] = new OracleParameter("p_hpcd_com_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objSch.Hpcs_com_rt;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_promocom_sch", CommandType.StoredProcedure, param);

            return result;

        }
        public int SavePromotCommParty(PromotComParty _objPty)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_HPCP_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objPty.Hpcp_seq;
            (param[1] = new OracleParameter("p_HPCP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objPty.Hpcp_line;
            (param[2] = new OracleParameter("p_HPCP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objPty.Hpcp_com;
            (param[3] = new OracleParameter("p_HPCP_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objPty.Hpcp_pty_tp;
            (param[4] = new OracleParameter("p_HPCP_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objPty.Hpcp_pty_cd;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_promocom_party", CommandType.StoredProcedure, param);

            return result;

        }
        public int SavePromotCommDet(PromotComDet _objSale)
        {

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_hpcd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSale.Hpcd_seq;
            (param[1] = new OracleParameter("p_hpcd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSale.Hpcd_line;
            (param[2] = new OracleParameter("p_hpcd_from_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSale.Hpcd_from_qty;
            (param[3] = new OracleParameter("p_hpcd_to_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _objSale.Hpcd_to_qty;
            (param[4] = new OracleParameter("p_hpcd_com_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objSale.Hpcd_com_amt;
            (param[5] = new OracleParameter("p_hpcd_com_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objSale.Hpcd_com_rt;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_promocom_det", CommandType.StoredProcedure, param);

            return result;

        }

        public Int32 GetSerialID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;

            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getpromcommserid", CommandType.StoredProcedure, param);
            return effects;
        }

        public int GetNonUtiRecTotal(string _com, string _pc, string _accno, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;


            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_non_uti_rec", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[i]["totamt"]);
                }
            }

            _value = _val;

            return 1;
        }

        public DataTable IsDoDaysExceed(string _com, string _pc, Int32 _val)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_val", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _val;


            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_chk_do_days", CommandType.StoredProcedure, false, _para);
            return _result;
        }

        public int GetTotSadQty(string _com, string _pc, out Decimal _totqty)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_tot_sad_qty", CommandType.StoredProcedure, false, param);


            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["totqty"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["totqty"]);
                }

            }

            _totqty = _val;
            return 1;
        }

        public DataTable GetAddRecDetails(string _recno)
        {
            // kapila   
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("P_RECNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_recadddet", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public DataTable GetConsignmentDetails(DateTime _fromDate, DateTime _toDate, string _com, string _PB, string _pblevel, string _doctp, string _User)
        {
            //    
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PB;
            (param[4] = new OracleParameter("in_pblevel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblevel;
            (param[5] = new OracleParameter("in_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_consignment_det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable GetVehRegPayTracker(string _com, string _pc, Int32 _withDtRange, DateTime _from, DateTime _to, string _invoice, string _engine, string _cust, string _chassis, string _reciept, string _vehNo, Int32 _stus)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_withdaterange", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withDtRange;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[5] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoice;
            (param[6] = new OracleParameter("p_eng", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[7] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[8] = new OracleParameter("p_cha", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chassis;
            (param[9] = new OracleParameter("p_rec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reciept;
            (param[10] = new OracleParameter("p_veh", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vehNo;
            (param[11] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tblInvoiceItem", "sp_get_reg_pay_tracker", CommandType.StoredProcedure, false, param);
        }
        //kapila
        public Boolean IsInvalidAccount(string _invno, DateTime _dt)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (_para[1] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;

            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsInvRev = QueryDataTable("tbl", "sp_chk_is_invalid_acc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsInvRev;
        }

        //kapila
        public int SaveInsuHistory(MasterInsuHistory _mstInsuHis)
        {

            OracleParameter[] param = new OracleParameter[10];


            (param[0] = new OracleParameter("p_MIH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_com;
            (param[1] = new OracleParameter("p_MIH_MLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_mloc;
            (param[2] = new OracleParameter("p_MIH_SLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_sloc;
            (param[3] = new OracleParameter("p_MIH_INS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_ins_dt;
            (param[4] = new OracleParameter("p_MIH_INS_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_ins_amt;
            (param[5] = new OracleParameter("p_MIH_INS_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_ins_ref;
            (param[6] = new OracleParameter("p_MIH_INS_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_ins_com;
            (param[7] = new OracleParameter("p_MIH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_cre_by;

            (param[8] = new OracleParameter("p_MIH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mstInsuHis.Mih_mod_by;


            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("SP_SAVE_INSU_HISTORY", CommandType.StoredProcedure, param);

            return result;

        }
        //kapila
        public DataTable GetInsuHistory(string Com, string _mloc, string _sloc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_MLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mloc;
            (param[2] = new OracleParameter("P_SLOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sloc;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_INSU_HISTORY", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //kapila
        public List<PromotionVoucherPara> getProVouPara(string _vouCd)
        {
            List<PromotionVoucherPara> _list = new List<PromotionVoucherPara>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vouCd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_1", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;
            DataTable _result = QueryDataTable("tbl", "sp_get_pro_vou_para", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<PromotionVoucherPara>(_result, PromotionVoucherPara.Converter);
            }
            return _list;
        }
        //kapila
        public Int32 UpdateVehRegDefin(Int32 _seq)
        {

            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_update_veh_reg_def", CommandType.StoredProcedure, param);

            return result;
        }
        //kapila
        public int GetQuotationTotal(string _qno, out Decimal _totamt)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _qno;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_quot_tot", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _totamt = _val;
            return 1;
        }

        //kapila
        public int GetQuotationDPTotal(string _qno, out Decimal _totamt)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_quo_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _qno;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_quot_DP_tot", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _totamt = _val;
            return 1;
        }

        //kapila 21/12/2015
        public DataTable ProcessSUNUpload_JAD(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_sun_upload.sp_process_sun_upload_JAD", CommandType.StoredProcedure, false, param);
            //   _result = QueryDataTable("tbl", "sp_proc_sun_upload", CommandType.StoredProcedure, false, param);


            return _result;
        }
        //kapila
        public int CalcAddiProdComm(string _com, string _pc, DateTime _from, DateTime _to)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_dayend.sp_proc_add_pro_comm", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila
        public int SaveDenominationSum(Int32 _seq, Int32 _line, string _cashier, string _pay_tp, decimal _phyAmt, decimal _sysAmt, string _cre_by, string _mod_by)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_gds_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_gds_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            (param[2] = new OracleParameter("p_gds_cashier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cashier;
            (param[3] = new OracleParameter("p_gds_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pay_tp;
            (param[4] = new OracleParameter("p_gds_phy_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _phyAmt;
            (param[5] = new OracleParameter("p_gds_sys_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _sysAmt;
            (param[6] = new OracleParameter("p_gds_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cre_by;
            (param[7] = new OracleParameter("p_gds_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod_by;


            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_denom_sum", CommandType.StoredProcedure, param);

            return result;

        }

        public int UpdateSignoffByDenom(Int32 _seq)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_upd_signoffby_deno", CommandType.StoredProcedure, param);

            return 1;
        }

        //kapila
        public int SaveDenominationDet(Int32 _seq, Int32 _sum_line, Int32 _det_line, string _pay_tp, string _pay_subtp, Int32 _unit, decimal _amt, string _cre_by, string _mod_by)
        {

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_gdd_sum_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sum_line;
            (param[2] = new OracleParameter("p_gdd_det_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _det_line;
            (param[3] = new OracleParameter("p_gdd_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pay_tp;
            (param[4] = new OracleParameter("p_gdd_pay_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pay_subtp;
            (param[5] = new OracleParameter("p_gdd_unit", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _unit;
            (param[6] = new OracleParameter("p_gdd_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[7] = new OracleParameter("p_gdd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cre_by;
            (param[8] = new OracleParameter("p_gdd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mod_by;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_denom_det", CommandType.StoredProcedure, param);

            return result;

        }
        //kapila
        public DataTable getDenominationDet(Int32 _seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_denom_det", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public DataTable get_pro_dis_def_by_seq(Int32 _seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_pro_dis_def_by_seq", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public DataTable getUserTotalSales(string _com, string _pc, DateTime _date, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_totsales", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public DataTable getDenominationSum(Int32 _seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_denom_sum", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public List<QoutationDetails> GetSupQoutation(string _com, string _pc, string _quot)
        {
            List<QoutationDetails> all_lines = new List<QoutationDetails>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_quot", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _quot;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblQout_lineDetail = QueryDataTable("tbl_lineDetail", "sp_get_sup_quot_det", CommandType.StoredProcedure, false, param);

            if (_tblQout_lineDetail.Rows.Count > 0)
            {
                all_lines = DataTableExtensions.ToGenericList<QoutationDetails>(_tblQout_lineDetail, QoutationDetails.ConvertTotalDO);
            }

            return all_lines;
        }

        //kapila
        public DataTable getPromotorTrans(string _cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_promo_trans", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //kapila
        public DataTable getPromotorRedeems(string _cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_promo_redeems", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public Int32 UpdateRedeemPromotor(string _mpr_cd, Decimal _mpr_red_pt, Decimal _mpr_red_cs, string _user, string _rem)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_mpr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mpr_cd;
            (param[1] = new OracleParameter("p_mpr_red_pt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _mpr_red_pt;
            (param[2] = new OracleParameter("p_mpr_red_cs", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _mpr_red_cs;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("SP_REDEEM_PROMOTOR", CommandType.StoredProcedure, param);

            return result;
        }
        //kapila
        public int GetCashRefundTot(DateTime _fromdate, DateTime _todate, string _pc, string _com, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_cashrefundtot", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila
        public int GetCreditNoteTot(DateTime _fromdate, DateTime _todate, string _pc, string _com, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_crednotetot", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _value = _val;
            return 1;
        }

        public DataTable getShortSetle(string _com, string _pc, DateTime _month, Int32 _week)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_short_setle_new", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public DataTable GetReceiptByRefNo(string _com, string _pc, DateTime _from, DateTime _to, string _ref)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_rec_by_ref", CommandType.StoredProcedure, false, param);

            return _result;
        }

        //kapila
        public Boolean checkDocrealized(string _com, string _pc, DateTime _dt, string _doctp, string _accno, string _ref)
        {
            OracleParameter[] _para = new OracleParameter[7];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (_para[3] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (_para[4] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (_para[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            _para[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _Found = QueryDataTable("tbl", "sp_chk_doc_realized", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _Found;
        }

        //kapila 20/4/2015
        public DataTable ProcessSUNUpload_BankCharges(DateTime _from, DateTime _to, string _com, string _user, string _chanel, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chanel;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_bnkchrg_upload", CommandType.StoredProcedure, false, param);


            return _result;
        }

        //kapila
        public Boolean checkDocBankState(string _pc, DateTime _dt, string _doctp, string _ref)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_bstd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[1] = new OracleParameter("p_bstd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (_para[2] = new OracleParameter("p_bstd_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (_para[3] = new OracleParameter("p_bstd_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _Found = QueryDataTable("tbl", "sp_chk_ref_bnkstate", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _Found;
        }

        //kapila 1/12/2014
        public Boolean isValidReqType(string _code)
        {
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_check_req_tp", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }

        //kapila
        public Int32 CancelApprovedRequest(string _ref, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_cancel_app_req", CommandType.StoredProcedure, param);
            return result;
        }

        //kapila
        public Boolean CheckAppReqCancelPerm(string _user, string _reqtp)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (_para[1] = new OracleParameter("p_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqtp;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _Found = QueryDataTable("tbl", "sp_chk_app_req_can_perm", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _Found;
        }

        //kapila
        public DataTable GetApprovedRequests(string _com, string _pc, DateTime _from, DateTime _to, Int32 _isAllDate, string _reqTp)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_alldate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAllDate;
            (param[5] = new OracleParameter("p_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reqTp;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "pkg_sun_upload.sp_get_app_req", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        //kapila
        public Int32 CancelExcessShortFinal(string _pc, DateTime _month, string _user)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_exces_short", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 deleteRedeemPoints(Int32 _seq, string _mgrCode)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_mgrcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mgrCode;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_red_points", CommandType.StoredProcedure, param);
            return effects;
        }


        //kapila
        public Int32 CancelCashControlFinal(string _com, string _pc, DateTime _month, string _user)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_cash_cntrl", CommandType.StoredProcedure, param);
            return effects;
        }

        public int UpdateIsSUNUpload(string _com, string _pc, DateTime _from, DateTime _to, Int32 _week)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_upd_sun_up_new", CommandType.StoredProcedure, param);

            return 1;
        }

        public int UpdateBankAdjPC(string _com, string _pc, DateTime _date, string _accno, string _adjtp, string _ref, string _newpc, Decimal _val, string _newrem)
        {

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_adjtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adjtp;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[6] = new OracleParameter("p_newpc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newpc;
            (param[7] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            (param[8] = new OracleParameter("p_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newrem;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_upd_adj_pc_new", CommandType.StoredProcedure, param);

            return result;
        }

        public DataTable CashControlCashPrint(string _user, string _com, string _pc, Int32 _year, Int32 _month, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[4] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[6] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_Cash_control_cash_rec", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 UpdateBankRealizationHdr(string _Bsth_com, DateTime _Bsth_dt, string _Bsth_accno, Decimal _Bsth_opbal, Decimal _Bsth_realizes, Decimal _Bsth_prv_realize, Decimal _Bsth_cc, Decimal _Bsth_adj, Decimal _Bsth_clbal, Decimal _Bsth_state_bal, string _Bsth_stus, string _Bsth_cre_by)
        {
            OracleParameter[] param = new OracleParameter[13];


            (param[0] = new OracleParameter("p_BSTH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_com;
            (param[1] = new OracleParameter("p_BSTH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Bsth_dt;
            (param[2] = new OracleParameter("p_BSTH_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_accno;
            (param[3] = new OracleParameter("p_BSTH_OPBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_opbal;
            (param[4] = new OracleParameter("p_BSTH_REALIZES", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_realizes;
            (param[5] = new OracleParameter("p_BSTH_PRV_REALIZE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_prv_realize;
            (param[6] = new OracleParameter("p_BSTH_CC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_cc;
            (param[7] = new OracleParameter("p_BSTH_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_adj;
            (param[8] = new OracleParameter("p_BSTH_CLBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_clbal;
            (param[9] = new OracleParameter("p_BSTH_STATE_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_state_bal;
            (param[10] = new OracleParameter("p_BSTH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_stus;
            (param[11] = new OracleParameter("p_BSTH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_cre_by;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_bnk_rls_hdr", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 FinalizeBankRealization(string _Bsth_com, DateTime _Bsth_dt, string _Bsth_accno, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];


            (param[0] = new OracleParameter("p_BSTH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_com;
            (param[1] = new OracleParameter("p_BSTH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Bsth_dt;
            (param[2] = new OracleParameter("p_BSTH_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_accno;
            (param[3] = new OracleParameter("p_bsth_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_fin_bnk_rls", CommandType.StoredProcedure, param);
            return effects;
        }


        public Boolean checkBankRealStatus(string _com, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _esdStus = QueryDataTable("tbl", "sp_chk_bnk_rls_stus", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _esdStus;
        }

        public DataTable getBankRlsHeader(string _com, DateTime _date, string _accno)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (_para[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_chk_bnk_rls_stus", CommandType.StoredProcedure, false, _para);

            return _dtResults;
        }
        public Int32 SaveBankRealizationDetails(BankRealDet _bnkRls)
        {
            OracleParameter[] param = new OracleParameter[23];

            (param[0] = new OracleParameter("p_BSTD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_com;
            (param[1] = new OracleParameter("p_BSTD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_pc;
            (param[2] = new OracleParameter("p_BSTD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_dt;
            (param[3] = new OracleParameter("p_BSTD_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_accno;
            (param[4] = new OracleParameter("p_BSTD_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_tp;
            (param[5] = new OracleParameter("p_BSTD_DOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_desc;
            (param[6] = new OracleParameter("p_BSTD_DOC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_ref;
            (param[7] = new OracleParameter("p_BSTD_SYS_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_sys_val;
            (param[8] = new OracleParameter("p_BSTD_IS_REALIZED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_realized;
            (param[9] = new OracleParameter("p_BSTD_REALIZED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_realized_dt;
            (param[10] = new OracleParameter("p_BSTD_DOC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_val;
            (param[11] = new OracleParameter("p_BSTD_DOC_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank;
            (param[12] = new OracleParameter("p_BSTD_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_rmk;
            (param[13] = new OracleParameter("p_BSTD_DEPOSIT_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_deposit_bank;
            (param[14] = new OracleParameter("p_BSTD_DOC_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank_cd;
            (param[15] = new OracleParameter("p_BSTD_DOC_BANK_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank_branch;
            (param[16] = new OracleParameter("p_BSTD_IS_NO_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_no_sun;
            (param[17] = new OracleParameter("p_BSTD_IS_NO_STATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_no_state;
            (param[18] = new OracleParameter("p_BSTD_IS_SCAN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_scan;
            (param[19] = new OracleParameter("p_BSTD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_by;
            //  (param[20] = new OracleParameter("p_BSTD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_dt;
            (param[20] = new OracleParameter("p_BSTD_IS_NEW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_new;
            (param[21] = new OracleParameter("p_bstd_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.bstd_is_extra;

            param[22] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_bank_rls", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateBankRealizationDetails(BankRealDet _bnkRls)
        {
            OracleParameter[] param = new OracleParameter[24];

            (param[0] = new OracleParameter("p_BSTD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_com;
            (param[1] = new OracleParameter("p_BSTD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_pc;
            (param[2] = new OracleParameter("p_BSTD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_dt;
            (param[3] = new OracleParameter("p_BSTD_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_accno;
            (param[4] = new OracleParameter("p_BSTD_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_tp;
            (param[5] = new OracleParameter("p_BSTD_DOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_desc;
            (param[6] = new OracleParameter("p_BSTD_DOC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_ref;
            (param[7] = new OracleParameter("p_BSTD_SYS_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_sys_val;
            (param[8] = new OracleParameter("p_BSTD_IS_REALIZED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_realized;
            (param[9] = new OracleParameter("p_BSTD_REALIZED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_realized_dt;
            (param[10] = new OracleParameter("p_BSTD_DOC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_val;
            (param[11] = new OracleParameter("p_BSTD_DOC_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank;
            (param[12] = new OracleParameter("p_BSTD_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_rmk;
            (param[13] = new OracleParameter("p_BSTD_DEPOSIT_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_deposit_bank;
            (param[14] = new OracleParameter("p_BSTD_DOC_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank_cd;
            (param[15] = new OracleParameter("p_BSTD_DOC_BANK_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank_branch;
            (param[16] = new OracleParameter("p_BSTD_IS_NO_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_no_sun;
            (param[17] = new OracleParameter("p_BSTD_IS_NO_STATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_no_state;
            (param[18] = new OracleParameter("p_BSTD_IS_SCAN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_scan;
            (param[19] = new OracleParameter("p_BSTD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_by;
            //  (param[20] = new OracleParameter("p_BSTD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_dt;
            (param[20] = new OracleParameter("p_BSTD_IS_NEW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_new;
            (param[21] = new OracleParameter("p_bstd_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.bstd_is_extra;
            (param[22] = new OracleParameter("p_bstd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_seq_no;

            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_bank_rls", CommandType.StoredProcedure, param);
            return effects;
        }

        #region remitance summary
        public List<RemSection> GetSection()
        {
            List<RemSection> _secList = null;

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRemSec", "sp_get_rem_section", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _secList = DataTableExtensions.ToGenericList<RemSection>(_dtResults, RemSection.Converter);
            }
            return _secList;

        }



        public Int32 SaveBankAdj(string _bsta_com, string _bsta_pc, DateTime _bsta_dt, string _bsta_accno, string _bsta_adj_tp, Decimal _bsta_amt, string _bsta_refno, string _bsta_rem, string _bsta_cre_by, string _mid)
        {
            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_bsta_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_com;
            (param[1] = new OracleParameter("p_bsta_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_pc;
            (param[2] = new OracleParameter("p_bsta_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bsta_dt;
            (param[3] = new OracleParameter("p_bsta_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_accno;
            (param[4] = new OracleParameter("p_bsta_adj_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_adj_tp;
            (param[5] = new OracleParameter("p_bsta_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bsta_amt;
            (param[6] = new OracleParameter("p_bsta_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_refno;
            (param[7] = new OracleParameter("p_bsta_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_rem;
            (param[8] = new OracleParameter("p_bsta_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_cre_by;
            (param[9] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_save_bank_adj", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveBankAdjDet(string _bsta_com, string _bsta_pc, DateTime _bsta_dt, string _bsta_accno, string _bsta_adj_tp, string _bsta_adj_tp_desc, string _bsta_refno, Decimal _bsta_amt, Int32 _is_realize, DateTime _is_realize_dt, Int32 _is_extra, string _user, DateTime _month, Int32 _week, string _bnk_id, string _bnk_cd, string _rem, string _mid, string _bstd_doc_bank_branch, string _bstd_sun)
        {
            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_bsta_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_com;
            (param[1] = new OracleParameter("p_bsta_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_pc;
            (param[2] = new OracleParameter("p_bsta_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bsta_dt;
            (param[3] = new OracleParameter("p_bsta_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_accno;
            (param[4] = new OracleParameter("p_bsta_adj_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_adj_tp;
            (param[5] = new OracleParameter("p_bsta_adj_tp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_adj_tp_desc;
            (param[6] = new OracleParameter("p_bsta_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_refno;
            (param[7] = new OracleParameter("p_bsta_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bsta_amt;
            (param[8] = new OracleParameter("p_is_realize", OracleDbType.Int32, 0, ParameterDirection.Input)).Value = _is_realize;
            (param[9] = new OracleParameter("p_is_realize_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _is_realize_dt;
            (param[10] = new OracleParameter("p_is_extra", OracleDbType.Int32, 0, ParameterDirection.Input)).Value = _is_extra;
            (param[11] = new OracleParameter("p_bsta_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[12] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[13] = new OracleParameter("p_week", OracleDbType.Int32, 0, ParameterDirection.Input)).Value = _week;
            (param[14] = new OracleParameter("p_bnk_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnk_id;
            (param[15] = new OracleParameter("p_bnk_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnk_cd;
            (param[16] = new OracleParameter("p_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;
            (param[17] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            (param[18] = new OracleParameter("p_bstd_doc_bank_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bstd_doc_bank_branch;
            (param[19] = new OracleParameter("p_bstd_sun_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bstd_sun;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_save_bank_adj_dt", CommandType.StoredProcedure, param);
            return effects;
        }

        public int GetIncSchPsnCatDesc(string _cd, out string _desc)
        {
            string desc = "";
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cd;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_get_inc_psn_cat_desc", CommandType.StoredProcedure, false, param);


            for (int i = 0; i < _result.Rows.Count; i++)
            {
                desc = Convert.ToString(_result.Rows[i]["inpc_desc"]);
            }
            _desc = desc;
            return 1;
        }

        public int GetCCRecTot(string _com, DateTime _date, string _accno, out decimal _val)
        {
            Decimal _value = 0;
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_getcc_rectot", CommandType.StoredProcedure, false, param);


            if (_result.Rows.Count > 0)
            {
                _value = Convert.ToDecimal(_result.Rows[0]["TOTCC"]);
            }
            _val = _value;
            return 1;
        }

        //kapila 17/6/2014
        public Boolean IsInvReversed(string _com, string _pc, string _invno)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;

            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsInvRev = QueryDataTable("tbl", "sp_chk_is_inv_rev", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsInvRev;
        }

        public DataTable Getrevertregistrationcharge(string _com, string _ptyTp, string _ptyCd, string _salesTp, string _itm, string _cat1, string _cat2, string _cat3, string _brand, string _fromPro, string _toPro, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ptyTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyTp;
            (param[2] = new OracleParameter("p_ptyCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptyCd;
            (param[3] = new OracleParameter("p_salesTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salesTp;
            (param[4] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[9] = new OracleParameter("p_from_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromPro;
            (param[10] = new OracleParameter("p_to_pro", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toPro;
            (param[11] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_get_revert_chg", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Boolean IsRevertAccount(string _com, string _pc, string _invno, DateTime _dt)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (_para[3] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;

            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsInvRev = QueryDataTable("tbl", "sp_chk_is_rvt_acc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsInvRev;
        }

        public DataTable GetRemSumHeadingBySec(string _section)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_section", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _section;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_get_rem_sum_heading_by_sec", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetBankStmntDetails(string _docTp, string _ref)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docTp;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_get_bnk_stmnt_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetBankAdj(string _com, DateTime _date, string _accno)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_get_bnk_adj", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public RemitanceSumHeading GetRemitanceData(string _sec, string _code)
        {

            RemitanceSumHeading _remsumhead = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            DataTable _DT = QueryDataTable("tbl", "sp_get_remitance_data", CommandType.StoredProcedure, false, param);
            if (_DT.Rows.Count > 0)
            {
                _remsumhead = DataTableExtensions.ToGenericList<RemitanceSumHeading>(_DT, RemitanceSumHeading.Converter)[0];
            }
            return _remsumhead;

        }

        //kapila 
        public int SaveRemSumHeading(RemitanceSumHeading _remsumheading)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[12];

                (param[0] = new OracleParameter("p_RSD_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_sec;
                (param[1] = new OracleParameter("p_RSD_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_cd;
                (param[2] = new OracleParameter("p_RSD_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_desc;
                (param[3] = new OracleParameter("p_RSD_FIXED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_fixed;
                (param[4] = new OracleParameter("p_RSD_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_acc;
                (param[5] = new OracleParameter("p_RSD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_cre_by;
                (param[6] = new OracleParameter("p_RSD_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_cre_when;
                (param[7] = new OracleParameter("p_RSD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_mod_by;
                (param[8] = new OracleParameter("p_RSD_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_mod_when;
                (param[9] = new OracleParameter("p_RSD_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumheading.Rsd_stus;
                (param[10] = new OracleParameter("p_RSD_IS_ONCE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumheading.RSD_IS_ONCE;
                param[11] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_save_rem_sum_head", CommandType.StoredProcedure, param);


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        //kapila
        public List<RemitanceSumHeading> get_rem_type_by_sec(string _sec, int p_fix)
        {
            List<RemitanceSumHeading> _List = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[1] = new OracleParameter("p_fix", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_fix;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "SP_GET_rem_tp_by_sec", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<RemitanceSumHeading>(tblDet, RemitanceSumHeading.Converter);
            }
            return _List;

        }

        public DataTable GetRemSumLimitations(string _type, string _code, string _sec, string _remcode)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[2] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[3] = new OracleParameter("p_remcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remcode;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_rem_limitations", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 
        public int SaveRemSumLimitations(RemSumDefinitions _remsumdef)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[13];
                (param[0] = new OracleParameter("p_RSMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_seq;
                (param[1] = new OracleParameter("p_RSMD_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_pty_tp;
                (param[2] = new OracleParameter("p_RSMD_PTY_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_pty_cd;
                (param[3] = new OracleParameter("p_RSMD_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_from_dt;
                (param[4] = new OracleParameter("p_RSMD_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_to_dt;
                (param[5] = new OracleParameter("p_RSMD_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_sec;
                (param[6] = new OracleParameter("p_RSMD_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_cd;
                (param[7] = new OracleParameter("p_RSMD_MAX_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_max_val;
                (param[8] = new OracleParameter("p_RSMD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_cre_by;
                (param[9] = new OracleParameter("p_RSMD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_cre_dt;
                (param[10] = new OracleParameter("p_RSMD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_mod_by;
                (param[11] = new OracleParameter("p_RSMD_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdef.Rsmd_mod_dt;
                param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_save_rem_sum_limit", CommandType.StoredProcedure, param);


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        public int SaveRemSummaryDetails(RemitanceSummaryDetail _remsumdet)
        {
            int rows_aff = 0;

            try
            {
                OracleParameter[] param = new OracleParameter[41];

                (param[0] = new OracleParameter("p_REM_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_com;
                (param[1] = new OracleParameter("p_REM_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_pc;
                (param[2] = new OracleParameter("p_REM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_dt;
                (param[3] = new OracleParameter("p_REM_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_sec;
                (param[4] = new OracleParameter("p_REM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cd;
                (param[5] = new OracleParameter("p_REM_SH_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_sh_desc;
                (param[6] = new OracleParameter("p_REM_LG_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_lg_desc;
                (param[7] = new OracleParameter("p_REM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val;
                (param[8] = new OracleParameter("p_REM_VAL_FINAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val_final;
                (param[9] = new OracleParameter("p_REM_WEEK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_week;
                (param[10] = new OracleParameter("p_REM_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ref_no;
                (param[11] = new OracleParameter("p_REM_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk;
                (param[12] = new OracleParameter("p_REM_CR_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cr_acc;
                (param[13] = new OracleParameter("p_REM_DB_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_db_acc;
                (param[14] = new OracleParameter("p_REM_DEL_ALW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_del_alw;
                (param[15] = new OracleParameter("p_REM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_by;
                (param[16] = new OracleParameter("p_REM_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_dt;
                (param[17] = new OracleParameter("p_REM_IS_SOS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_sos;
                (param[18] = new OracleParameter("p_REM_IS_DAYEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_dayend;
                (param[19] = new OracleParameter("p_REM_IS_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_sun;
                (param[20] = new OracleParameter("p_REM_CAT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cat;
                (param[21] = new OracleParameter("p_REM_ADD", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_add;
                (param[22] = new OracleParameter("p_REM_DED", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ded;
                (param[23] = new OracleParameter("p_REM_NET", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_net;
                (param[24] = new OracleParameter("p_REM_EPF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_epf;
                (param[25] = new OracleParameter("p_REM_ESD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_esd;
                (param[26] = new OracleParameter("p_REM_WHT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_wht;
                (param[27] = new OracleParameter("p_REM_ADD_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_add_fin;
                (param[28] = new OracleParameter("p_REM_DED_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ded_fin;
                (param[29] = new OracleParameter("p_REM_NET_FIN", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_net_fin;
                (param[30] = new OracleParameter("p_REM_RMK_FIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk_fin;
                (param[31] = new OracleParameter("p_REM_BNK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_bnk_cd;
                (param[32] = new OracleParameter("p_REM_IS_REM_SUM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remsumdet.Rem_is_rem_sum;
                (param[33] = new OracleParameter("p_rem_rem_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.REM_REM_MONTH;

                //8/8/2013
                (param[34] = new OracleParameter("p_REM_CHQNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_CHQNO;
                (param[35] = new OracleParameter("p_REM_CHQ_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_CHQ_BANK_CD;
                (param[36] = new OracleParameter("p_REM_CHQ_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_CHQ_BRANCH;
                (param[37] = new OracleParameter("p_REM_CHQ_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.REM_CHQ_DT;
                (param[38] = new OracleParameter("p_REM_DEPOSIT_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_DEPOSIT_BANK_CD;
                (param[39] = new OracleParameter("p_REM_DEPOSIT_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_DEPOSIT_BRANCH;

                param[40] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                if ((_remsumdet.Rem_sec == "05") && (_remsumdet.Rem_cd == "003") || (_remsumdet.Rem_sec == "05" && _remsumdet.Rem_cd == "002"))
                {
                    //include cheque number in update query
                    rows_aff = UpdateRecords("sp_save_rem_sum_chq", CommandType.StoredProcedure, param);

                }
                else if ((_remsumdet.Rem_sec == "05" && _remsumdet.Rem_cd == "001") || (_remsumdet.Rem_sec == "05" && _remsumdet.Rem_cd == "003") || (_remsumdet.Rem_sec == "02" && _remsumdet.Rem_cd == "013"))
                {
                    //include REM_RMK=p_REM_RMK in update query
                    rows_aff = UpdateRecords("sp_save_rem_sum_manual", CommandType.StoredProcedure, param);
                }
                else if (((_remsumdet.Rem_sec == "03") && (_remsumdet.Rem_cd == "024")) || ((_remsumdet.Rem_sec == "04") && (_remsumdet.Rem_cd == "035")) || ((_remsumdet.Rem_sec == "03") && (_remsumdet.Rem_cd == "018")) || ((_remsumdet.Rem_sec == "04") && (_remsumdet.Rem_cd == "009")) || ((_remsumdet.Rem_sec == "04") && (_remsumdet.Rem_cd == "010")))
                {
                    //update values (rem_val=rem_val+p_rem_val) (03-018,04-009,04-010,03-024,04-035)
                    rows_aff = UpdateRecords("sp_save_rem_sum_adj", CommandType.StoredProcedure, param);
                }
                else
                {
                    rows_aff = UpdateRecords("sp_save_rem_sum", CommandType.StoredProcedure, param);
                }


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        // tHARINDU 2018-04-19

        public int SaveInternalVoucherClaim(RemitanceSummaryDetail _remsumdet)
        {
            int rows_aff = 0;

            try
            {
                OracleParameter[] param = new OracleParameter[22];

                string Weekno = Regex.Match(_remsumdet.Rem_week, @"\d+").Value;

                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_com;
                (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_pc;
                (param[2] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_dt;
                (param[3] = new OracleParameter("p_week", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Weekno;
                (param[4] = new OracleParameter("p_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_ref_no;
                (param[5] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_by;
                (param[6] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_dt;
                (param[7] = new OracleParameter("p_sun_upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 0;
                (param[8] = new OracleParameter("p_doc_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_CHQ_BANK_CD;
                (param[9] = new OracleParameter("p_doc_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_DEPOSIT_BANK_CD;
                (param[10] = new OracleParameter("p_doc_bank_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.REM_DEPOSIT_BRANCH;
                (param[11] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_rmk;
                (param[12] = new OracleParameter("p_doc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_sh_desc;
                (param[13] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                (param[14] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
                (param[15] = new OracleParameter("p_sys_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val_final;
                (param[16] = new OracleParameter("p_scan_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
                (param[17] = new OracleParameter("p_doc_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
                (param[18] = new OracleParameter("p_doc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remsumdet.Rem_val_final;
                (param[19] = new OracleParameter("p_rcv_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remsumdet.Rem_cre_by;
                (param[20] = new OracleParameter("p_rcv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;

                param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                if ((_remsumdet.Rem_sec == "05") && (_remsumdet.Rem_cd == "003") || (_remsumdet.Rem_sec == "05" && _remsumdet.Rem_cd == "002"))
                {
                    rows_aff = UpdateRecords("sp_save_Gnt_rcv_dsk_doc_rem", CommandType.StoredProcedure, param);
                }


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }
            return rows_aff;
        }

        public DataTable GetRemitanceSumDet(DateTime _remDate, string _pc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remDate;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_rem_sum_det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public List<RemitanceSummaryDetail> GetRemitanceSumDetail(DateTime _remDate, string _pc)
        {
            List<RemitanceSummaryDetail> _List = null;
            RemitanceSummaryDetail _remsumdet = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remDate;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_rem_sum_dt", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _List = new List<RemitanceSummaryDetail>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _remsumdet = new RemitanceSummaryDetail();
                    _remsumdet.Rem_cd = (_dtResults.Rows[i]["Rem_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_cd"].ToString();
                    _remsumdet.RemSumDet = new RemitanceSumHeading()
                    {
                        Rsd_desc = (_dtResults.Rows[i]["Rsd_desc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rsd_desc"].ToString(),
                    };
                    _remsumdet.Rem_val = (_dtResults.Rows[i]["Rem_val"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Rem_val"]);
                    _remsumdet.Rem_dt = (_dtResults.Rows[i]["Rem_dt"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Rem_dt"]);
                    _remsumdet.Rem_pc = (_dtResults.Rows[i]["Rem_pc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_pc"].ToString();
                    _remsumdet.Rem_ref_no = (_dtResults.Rows[i]["Rem_ref_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_ref_no"].ToString();
                    _remsumdet.Rem_rmk = (_dtResults.Rows[i]["Rem_rmk"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_rmk"].ToString();
                    _remsumdet.Rem_sec = (_dtResults.Rows[i]["Rem_sec"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_sec"].ToString();

                    _List.Add(_remsumdet);
                }
            }
            return _List;

        }

        public DataTable GetBanks()
        {
            DataTable _dtResults = null;

            //Query Data base.         
            _dtResults = QueryDataTable("tblBanks", "sp_getbankdetails", CommandType.StoredProcedure, false,
                                                   new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output));

            return _dtResults;
        }

        public DataTable GetReturnCheques(string _loc, string _ref, string _bCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[2] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "get_return_cheque", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 UpdateReturnCheques(string _ref, string _oldRef, string _bCode, string _oldBcode, string _branch, DateTime _date)
        {

            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_oRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldRef;
            (param[2] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bCode;
            (param[3] = new OracleParameter("p_oBank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldBcode;
            (param[4] = new OracleParameter("p_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _branch;
            (param[5] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_updatereturncheque", CommandType.StoredProcedure, param);

            return result;
        }


        public DataTable GetReturnChequeCount(string _ref, string _bCode, string _loc)
        {

            OracleParameter[] param = new OracleParameter[4];
            DataTable _dtResults = null;
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bCode;
            (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "sp_getreturncheques", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public Int32 SaveReturnCheque(ChequeReturn _chequeReturn)
        {

            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_srcq_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _chequeReturn.Seq;
            (param[1] = new OracleParameter("p_srcq_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.RefNo;
            (param[2] = new OracleParameter("p_srcq_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Company;
            (param[3] = new OracleParameter("p_srcq_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Pc;
            (param[4] = new OracleParameter("p_srcq_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Bank;
            (param[5] = new OracleParameter("p_srcq_chq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Cheque_no;
            (param[6] = new OracleParameter("p_srcq_rtn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _chequeReturn.Returndate;
            (param[7] = new OracleParameter("p_srcq_sys_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Sys_value;
            (param[8] = new OracleParameter("p_srcq_act_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Act_value;
            (param[9] = new OracleParameter("p_srcq_intr", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Intrest;
            (param[10] = new OracleParameter("p_srcq_is_sett", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _chequeReturn.Is_set;
            (param[11] = new OracleParameter("p_srcq_set_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Settle_val;
            (param[12] = new OracleParameter("p_srcq_rtn_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Return_bank;
            (param[13] = new OracleParameter("p_srcq_banked_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _chequeReturn.Bank_type;
            (param[14] = new OracleParameter("p_srcq_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Create_by;
            (param[15] = new OracleParameter("p_srcq_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _chequeReturn.Create_Date;
            (param[16] = new OracleParameter("p_srcq_cap_set", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Srcq_cap_set;
            (param[17] = new OracleParameter("p_srcq_intr_set", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Srcq_intr_set;
            (param[18] = new OracleParameter("p_srcq_mgr_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _chequeReturn.Srcq_mgr_chg;
            (param[19] = new OracleParameter("p_srcq_chq_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chequeReturn.Srcq_chq_branch;

            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 rows_aff = UpdateRecords("sp_savereturncheque", CommandType.StoredProcedure, param);

            return rows_aff;
        }

        public DataTable GetReturnChequeDetails()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tblReturnChequeDetails", "sp_get_returncheque_details", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //kapila
        public DataTable GetRemSummaryReport(string _com, string _pc, DateTime _fromDate, DateTime _toDate, string _sec, out Decimal _totval, out Decimal _totvalFinal)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_remit_summ_new", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_val1"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["rem_val1"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_valfinal"].ToString()))
                {
                    _valFinal = _valFinal + Convert.ToDecimal(_result.Rows[i]["rem_valfinal"]);
                }
            }
            _totval = _val;
            _totvalFinal = _valFinal;
            return _result;
        }

        public DataTable GetRemSummaryReport_Win(string _com, string _pc, DateTime _fromDate, DateTime _toDate, string _sec, out Decimal _totval, out Decimal _totvalFinal)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_remit_summ_win_new", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_val"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["rem_val"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_valfinal"].ToString()))
                {
                    _valFinal = _valFinal + Convert.ToDecimal(_result.Rows[i]["rem_valfinal"]);
                }
            }
            _totval = _val;
            _totvalFinal = _valFinal;
            return _result;
        }

        //kapila
        public DataTable ProcessDayEnd(DateTime _date, string _com, string _pc, Int32 _week, string _user, string _insTp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_instype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insTp;

            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_dayend.sp_process_day_end", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public Boolean IsRemHeadFixed(string _sec, string _code)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (_para[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsRemHeadFixed = QueryDataTable("tbl", "sp_is_rem_head_fix", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsRemHeadFixed;
        }

        //kapila 8/8/2012
        public int SaveRemAdjustment(RemitanceAdjustment _remAdj, MasterAutoNumber _masterAutoNumber)
        {
            int rows_aff = 0;
            try
            {
                OracleParameter[] param = new OracleParameter[9];

                (param[0] = new OracleParameter("p_ADR_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remAdj.Adr_seq_no;
                (param[1] = new OracleParameter("p_ADR_ADJ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remAdj.Adr_adj_no;
                (param[2] = new OracleParameter("p_ADR_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remAdj.Adr_tp;
                (param[3] = new OracleParameter("p_ADR_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remAdj.Adr_pc;
                (param[4] = new OracleParameter("p_ADR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remAdj.Adr_dt;
                (param[5] = new OracleParameter("p_ADR_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remAdj.Adr_amt;
                (param[6] = new OracleParameter("p_ADR_BNK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remAdj.Adr_bnk;
                (param[7] = new OracleParameter("p_ADR_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remAdj.Adr_rem;
                param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_aff = UpdateRecords("sp_save_rem_adj", CommandType.StoredProcedure, param);


            }
            catch (Exception e)
            {
                rows_aff = -1;
            }
            finally
            {
            }

            return rows_aff;
        }

        //kapila
        public int GetTotRemitance(string _com, DateTime _from, DateTime _to, string _pc, out Decimal _totval)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_tot_remitance", CommandType.StoredProcedure, false, param);


            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["totamt"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["totamt"]);
                }

            }

            _totval = _val;
            return 1;
        }

        //kapila
        public int GetPrvDayExcess(DateTime _date, string _pc, string _com, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_prv_day_excess", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["REM_VAL"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["REM_VAL"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila 9/8/2012
        public int SaveDayEnd(DayEnd _dayEnd)
        {
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_UPD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dayEnd.Upd_com;
            (param[1] = new OracleParameter("p_UPD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dayEnd.Upd_pc;
            (param[2] = new OracleParameter("p_UPD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dayEnd.Upd_dt;
            (param[3] = new OracleParameter("p_UPD_OV_WRT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _dayEnd.Upd_ov_wrt;
            (param[4] = new OracleParameter("p_UPD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _dayEnd.Upd_cre_by;
            (param[5] = new OracleParameter("p_UPD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dayEnd.Upd_cre_dt;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            int rows_aff = UpdateRecords("sp_save_day_end", CommandType.StoredProcedure, param);
            return rows_aff;
        }

        //kapila 9/8/2012
        public Boolean IsInvalidDayEndDate_1(DateTime _date, string _pc)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_1", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;

            return _isInvalidDayEndDate;
        }

        //kapila 2/3/2013
        public DataTable getInvalidDate(DateTime _date, string _pc)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_1", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;
            DataTable _result = QueryDataTable("tbl", "sp_get_invalid_dt", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public Boolean IsInvalidDayEndDate_2(DateTime _date, string _pc)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_2", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;

            return _isInvalidDayEndDate;
        }
        public Boolean IsInvalidDayEndDate_3(DateTime _date, string _pc)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_3", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;

            return _isInvalidDayEndDate;
        }

        //kapila 10/8/2012
        public int GetRemSumDet(DateTime _fromdate, DateTime _todate, string _sec, string _code, string _pc, out Decimal _value, out Decimal _valueFinal)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_remitance", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamtfinal"].ToString()))
                {
                    _valFinal = Convert.ToDecimal(_result.Rows[0]["totamtfinal"]);
                }
            }

            _value = _val;
            _valueFinal = _valFinal;
            return 1;
        }

        public int GetRemSumDet_new(DateTime _fromdate, DateTime _todate, string _sec, string _code, string _pc, string _com, out Decimal _value, out Decimal _valueFinal)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[2] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_remitance_new", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamtfinal"].ToString()))
                {
                    _valFinal = Convert.ToDecimal(_result.Rows[0]["totamtfinal"]);
                }
            }

            _value = _val;
            _valueFinal = _valFinal;
            return 1;
        }

        //kapila 10/8/2012
        public int GetRemAdj(DateTime _from, DateTime _to, string _sec, string _code, string _pc, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_rem_adj", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila 11-8-2012
        //public List<RemAdjTypes> GetAdjTypes()
        //{
        //    List<RemAdjTypes> _secList = null;

        //    OracleParameter[] param = new OracleParameter[1];
        //    param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

        //    DataTable _dtResults = QueryDataTable("tblRemSec", "sp_get_rem_adj_tp", CommandType.StoredProcedure, false, param);

        //    if (_dtResults.Rows.Count > 0)
        //    {
        //        _secList = DataTableExtensions.ToGenericList<RemAdjTypes>(_dtResults, RemAdjTypes.Converter);
        //    }
        //    return _secList;

        //}

        //kapila 13-8-2012
        public List<MasterOutsideParty> GetBusCom(string _type)
        {
            List<MasterOutsideParty> _secList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRemSec", "sp_get_buscom_by_type", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _secList = DataTableExtensions.ToGenericList<MasterOutsideParty>(_dtResults, MasterOutsideParty.ConvertTotal);
            }
            return _secList;

        }

        //kapila
        public int GetTotDeductions(DateTime _from, DateTime _to, string _pc, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_tot_deduct", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila
        public Int32 DeleteRemSum(string _com, string _pc, DateTime _date, string _sec, string _code, string _refno)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _refno;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_rem_sum_stus", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 DeleteRemSummary(string _com, string _pc, DateTime _date, string _sec, string _code)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_rmsum_stus", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetRemSummaryReport_without_comm_withdraw_win(string _com, string _pc, DateTime _fromDate, DateTime _toDate, string _sec, out Decimal _totval, out Decimal _totvalFinal, Int32 _type)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[5] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_remit_sum_wocom_win_new", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_val"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["rem_val"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_valfinal"].ToString()))
                {
                    _valFinal = _valFinal + Convert.ToDecimal(_result.Rows[i]["rem_valfinal"]);
                }

            }
            _totval = _val;
            _totvalFinal = _valFinal;
            return _result;
        }
        //kapila
        public DataTable GetRemSummaryReport_without_comm_withdraw(string _com, string _pc, DateTime _fromDate, DateTime _toDate, string _sec, out Decimal _totval, out Decimal _totvalFinal, Int32 _type)
        {
            Decimal _val = 0;
            Decimal _valFinal = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[5] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_remit_sum_whout_com_new", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_val1"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["rem_val1"]);
                }
                if (!string.IsNullOrEmpty(_result.Rows[i]["rem_valfinal"].ToString()))
                {
                    _valFinal = _valFinal + Convert.ToDecimal(_result.Rows[i]["rem_valfinal"]);
                }

            }
            _totval = _val;
            _totvalFinal = _valFinal;
            return _result;
        }

        //kapila
        public DataTable ProcessSOS(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_process_sos", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 3/9/2012
        public int GetTotDisbForCalc_Excess(DateTime _from, DateTime _to, string _pc, out Decimal _value)
        {
            Decimal _val = 0;
            Decimal _valColBonus = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_TOT_DISB_EXCES", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["totamt"]);
                }
            }

            OracleParameter[] param1 = new OracleParameter[4];
            (param1[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param1[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param1[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param1[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result1 = QueryDataTable("tbl", "sp_get_tot_disb_col_bons", CommandType.StoredProcedure, false, param1);

            if (_result1.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result1.Rows[0]["totamt"].ToString()))
                {
                    _valColBonus = Convert.ToDecimal(_result1.Rows[0]["totamt"]);
                }
            }

            _value = _val + _valColBonus;
            return 1;
        }

        //kapila 10/9/2012
        public DataTable ProcessRemDetail(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_process_rem_detail", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 19/9/2012
        public int Get_prv_day_CIH(DateTime _date, string _com, string _pc, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_PRV_DAY_CIH_NEW", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["rem_val"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["rem_val"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila
        public DataTable ProcessSUNUpload(string _month, DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sun_user, string _file, string _insuTp)
        {
            DataTable _result = null;
            //using (System.IO.StreamWriter file = new System.IO.StreamWriter(_file))
            //{
            //    string _STR = string.Empty;

            //OracleParameter[] param = new OracleParameter[2];
            //(param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            //param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //DataTable _result = QueryDataTable("tbl", "SP_GET_TEMP_SOS", CommandType.StoredProcedure, false, param);
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_month", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[7] = new OracleParameter("p_sun_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sun_user;
            param[8] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (_insuTp == "DIRIYA")
                _result = QueryDataTable("tbl", "pkg_financial.sp_process_sun_upload", CommandType.StoredProcedure, false, param);
            else
                _result = QueryDataTable("tbl", "pkg_financial.sp_process_sun_upload_XYZ", CommandType.StoredProcedure, false, param);


            //for (int i = 0; i < _result.Rows.Count; i++)
            //{
            //    _STR = _result.Rows[i]["STR_01"].ToString() +
            //        _result.Rows[i]["STR_02"].ToString() + _result.Rows[i]["STR_03"].ToString() + _result.Rows[i]["STR_04"].ToString() +
            //        _result.Rows[i]["STR_05"].ToString() + _result.Rows[i]["STR_06"].ToString() + _result.Rows[i]["STR_07"].ToString() +
            //        _result.Rows[i]["STR_08"].ToString() + _result.Rows[i]["STR_09"].ToString() + _result.Rows[i]["STR_10"].ToString() +
            //        _result.Rows[i]["STR_11"].ToString() + _result.Rows[i]["STR_12"].ToString() + _result.Rows[i]["STR_13"].ToString() +
            //        _result.Rows[i]["STR_14"].ToString() + _result.Rows[i]["STR_15"].ToString() + _result.Rows[i]["STR_16"].ToString() +
            //        _result.Rows[i]["STR_17"].ToString() + _result.Rows[i]["STR_18"].ToString() + _result.Rows[i]["STR_19"].ToString() +
            //        _result.Rows[i]["STR_20"].ToString() + _result.Rows[i]["STR_21"].ToString() + _result.Rows[i]["STR_22"].ToString() +
            //        _result.Rows[i]["STR_23"].ToString() + _result.Rows[i]["STR_24"].ToString() + _result.Rows[i]["STR_25"].ToString() +
            //        _result.Rows[i]["STR_26"].ToString() + _result.Rows[i]["STR_27"].ToString() + _result.Rows[i]["STR_28"].ToString() +
            //        _result.Rows[i]["STR_29"].ToString() + _result.Rows[i]["STR_30"].ToString() + _result.Rows[i]["STR_31"].ToString() +
            //        _result.Rows[i]["STR_32"].ToString() + _result.Rows[i]["STR_33"].ToString() + _result.Rows[i]["STR_34"].ToString() +
            //        _result.Rows[i]["STR_35"].ToString() + _result.Rows[i]["STR_36"].ToString() + _result.Rows[i]["STR_37"].ToString() +
            //        _result.Rows[i]["STR_38"].ToString();
            //    file.WriteLine(_STR);
            //}

            //file.Close();
            //}
            return _result;
        }

        public DataTable EvaluationSUNUpload(string _month, DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sun_user, string _doctype)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_month", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[7] = new OracleParameter("p_sun_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sun_user;
            (param[8] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            param[9] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_get_valuation_upload_inv", CommandType.StoredProcedure, false, param);
            //if (_insuTp == "DIRIYA")
            //    _result = QueryDataTable("tbl", "pkg_financial.sp_process_sun_upload", CommandType.StoredProcedure, false, param);
            //else
            //    _result = QueryDataTable("tbl", "pkg_financial.sp_process_sun_upload_XYZ", CommandType.StoredProcedure, false, param);

            return _result;
        }

        //kapila 20/9/2012
        public int Generate_SOS_Text_File(string _month, DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sun_user, string _file)
        {
            DataTable _result = null;
            using (System.IO.StreamWriter file = new System.IO.StreamWriter(_file))
            {
                string _STR = string.Empty;

                //OracleParameter[] param = new OracleParameter[2];
                //(param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                //param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                //DataTable _result = QueryDataTable("tbl", "SP_GET_TEMP_SOS", CommandType.StoredProcedure, false, param);
                //OracleParameter[] param = new OracleParameter[8];
                //(param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
                //(param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
                //(param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                //(param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                //(param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                //(param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
                //(param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
                //param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                //_result = QueryDataTable("tbl", "pkg_financial.sp_process_receipt_upload", CommandType.StoredProcedure, false, param);


                for (int i = 0; i < _result.Rows.Count; i++)
                {
                    _STR = _result.Rows[i]["STR_01"].ToString() +
                        _result.Rows[i]["STR_02"].ToString() + _result.Rows[i]["STR_03"].ToString() + _result.Rows[i]["STR_04"].ToString() +
                        _result.Rows[i]["STR_05"].ToString() + _result.Rows[i]["STR_06"].ToString() + _result.Rows[i]["STR_07"].ToString() +
                        _result.Rows[i]["STR_08"].ToString() + _result.Rows[i]["STR_09"].ToString() + _result.Rows[i]["STR_10"].ToString() +
                        _result.Rows[i]["STR_11"].ToString() + _result.Rows[i]["STR_12"].ToString() + _result.Rows[i]["STR_13"].ToString() +
                        _result.Rows[i]["STR_14"].ToString() + _result.Rows[i]["STR_15"].ToString() + _result.Rows[i]["STR_16"].ToString() +
                        _result.Rows[i]["STR_17"].ToString() + _result.Rows[i]["STR_18"].ToString() + _result.Rows[i]["STR_19"].ToString() +
                        _result.Rows[i]["STR_20"].ToString() + _result.Rows[i]["STR_21"].ToString() + _result.Rows[i]["STR_22"].ToString() +
                        _result.Rows[i]["STR_23"].ToString() + _result.Rows[i]["STR_24"].ToString() + _result.Rows[i]["STR_25"].ToString() +
                        _result.Rows[i]["STR_26"].ToString() + _result.Rows[i]["STR_27"].ToString() + _result.Rows[i]["STR_28"].ToString() +
                        _result.Rows[i]["STR_29"].ToString() + _result.Rows[i]["STR_30"].ToString() + _result.Rows[i]["STR_31"].ToString() +
                        _result.Rows[i]["STR_32"].ToString() + _result.Rows[i]["STR_33"].ToString() + _result.Rows[i]["STR_34"].ToString() +
                        _result.Rows[i]["STR_35"].ToString() + _result.Rows[i]["STR_36"].ToString() + _result.Rows[i]["STR_37"].ToString() +
                        _result.Rows[i]["STR_38"].ToString();
                    file.WriteLine(_STR);
                }

                file.Close();
            }
            return 1;
        }


        //Darshana 07/9/2013
        public DataTable ProcessSUNUpload_RtnCheque(DateTime _from, DateTime _to, string _com, string _user, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;


            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[5] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_rtnChq_upload", CommandType.StoredProcedure, false, param);


            return _result;
        }

        //Darshana 09/9/2013
        public DataTable ProcessSUNUpload_RtnChequeSettlement(DateTime _from, DateTime _to, string _com, string _user, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;


            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[5] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_returnchq_settl", CommandType.StoredProcedure, false, param);


            return _result;
        }

        //kapila 21/9/2012
        public DataTable ProcessSUNUpload_Receipt(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;
            //using (System.IO.StreamWriter file = new System.IO.StreamWriter(_file))
            //{
            //string _STR = string.Empty;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_receipt_upload", CommandType.StoredProcedure, false, param);


            //for (int i = 0; i < _result.Rows.Count; i++)
            //{
            //    _STR = _result.Rows[i]["STR_01"].ToString() +
            //        _result.Rows[i]["STR_02"].ToString() + _result.Rows[i]["STR_03"].ToString() + _result.Rows[i]["STR_04"].ToString() +
            //        _result.Rows[i]["STR_05"].ToString() + _result.Rows[i]["STR_06"].ToString() + _result.Rows[i]["STR_07"].ToString() +
            //        _result.Rows[i]["STR_08"].ToString() + _result.Rows[i]["STR_09"].ToString() + _result.Rows[i]["STR_10"].ToString() +
            //        _result.Rows[i]["STR_11"].ToString() + _result.Rows[i]["STR_12"].ToString() + _result.Rows[i]["STR_13"].ToString() +
            //        _result.Rows[i]["STR_14"].ToString() + _result.Rows[i]["STR_15"].ToString() + _result.Rows[i]["STR_16"].ToString() +
            //        _result.Rows[i]["STR_17"].ToString() + _result.Rows[i]["STR_18"].ToString() + _result.Rows[i]["STR_19"].ToString() +
            //        _result.Rows[i]["STR_20"].ToString() + _result.Rows[i]["STR_21"].ToString() + _result.Rows[i]["STR_22"].ToString() +
            //        _result.Rows[i]["STR_23"].ToString() + _result.Rows[i]["STR_24"].ToString() + _result.Rows[i]["STR_25"].ToString() +
            //        _result.Rows[i]["STR_26"].ToString() + _result.Rows[i]["STR_27"].ToString() + _result.Rows[i]["STR_28"].ToString() +
            //        _result.Rows[i]["STR_29"].ToString() + _result.Rows[i]["STR_30"].ToString() + _result.Rows[i]["STR_31"].ToString() +
            //        _result.Rows[i]["STR_32"].ToString() + _result.Rows[i]["STR_33"].ToString() + _result.Rows[i]["STR_34"].ToString() +
            //        _result.Rows[i]["STR_35"].ToString() + _result.Rows[i]["STR_36"].ToString() + _result.Rows[i]["STR_37"].ToString() +
            //        _result.Rows[i]["STR_38"].ToString();
            //    file.WriteLine(_STR);
            //}

            //file.Close();
            //}
            return _result;
        }

        //kapila 24/9/2012
        public DataTable ProcessSUNUpload_Invoice(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, Int32 _is_dealer, string _sunID, string _file)
        {
            DataTable _result = null;
            //using (System.IO.StreamWriter file = new System.IO.StreamWriter(_file))
            //{
            //    string _STR = string.Empty;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_is_dealer", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_dealer;
            (param[7] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[8] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_invoice_upload", CommandType.StoredProcedure, false, param);

            return _result;
        }

        //kapila 5/11/2015
        public DataTable ProcessSUNUpload_Common(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _type, string _sbtype, string _sunID, string _file)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[7] = new OracleParameter("p_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sbtype;
            (param[8] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[9] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_sun_upload.sp_process_sun_upload", CommandType.StoredProcedure, false, param);

            return _result;
        }
        //kapila 27/9/2012
        public DataTable ProcessReceipt_Listing(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _recType)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_rec_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recType;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_receipt_listing", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessProductBonus(string _com, string _circ, string _ref, DateTime _from, DateTime _to, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            //(param[6] = new OracleParameter("p_sale_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "A007";
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_Process_Product_Bonus", CommandType.StoredProcedure, false, param);
            return _dtResults;

            //Process_Summary(vAllItem);

            //glob_Con_EMS.Execute("update GN_T_Incentive_Scheme set in_Processed='F', in_ModifiedDate = GetDate() where in_RefNo='" + v_Scheme + "'");

            //Interaction.MsgBox("Process Completed Successfuly.", MsgBoxStyle.Information);

            return _dtResults;
        }
        //kapila 27/3/2013
        public DataTable ProcessFinalReminder(string _accno, string _type, DateTime _due)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_duedate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _due;
            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_final_reminder_print", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila 27/3/2013
        public DataTable ProcessHPArrearsPrint(string _accno, string _type, DateTime _due)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_duedate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _due;
            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_arrears_print", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila 27/9/2012
        public DataTable ProcessReceipt_Listing_win(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _recType, string _prefix, string _payType, Int32 _iswithtime, DateTime _filterfromdt, DateTime _filtertodt)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[12];
            string _fromDate = _filterfromdt.ToString("dd-MMM-yyyy HH:mm");
            string _toDate = _filtertodt.ToString("dd-MMM-yyyy HH:mm");


            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_rec_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recType;
            (param[6] = new OracleParameter("p_prefix", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _prefix;
            (param[7] = new OracleParameter("p_pay_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _payType;
            (param[8] = new OracleParameter("with_time", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _iswithtime;
            (param[9] = new OracleParameter("p_filterfromdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromDate;
            (param[10] = new OracleParameter("p_filtertodt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toDate;
            //param[8] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            // _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_receipt_lst_win_new", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "sp_process_receipt_lst_win_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 1/10/2012
        public int Print_HP_Agreement(string _accNo)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_hp_agreement", CommandType.StoredProcedure, false, param);
            return 1;
        }

        //kapila 27/9/2012
        public DataTable Process_AgeOfDebtors_Arrears(DateTime _asatdate, string _com, string _pc, string _user, string _scheme)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;

            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_of_debt_arr", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 27/9/2012
        public DataTable Process_Debtor_Sales_Settlement(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _checkfromdt, string _cusdcd, Int32 _isOuts)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_outsonly", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isOuts;
            (param[6] = new OracleParameter("p_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdcd;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[8] = new OracleParameter("p_checkfdate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _checkfromdt;

            _dtResults = QueryDataTable("tbl", "pkg_outstanding.sp_process_Debt_Settlements", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 27/9/2012
        public Decimal Get_Arrears(string _pc, string _accNo, DateTime _arrDate, DateTime _supDate)
        {
            Decimal effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accNo;
            (param[2] = new OracleParameter("p_ars_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _arrDate;
            (param[3] = new OracleParameter("p_sup_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _supDate;

            OracleParameter _outParam = new OracleParameter("c_Arrears", OracleDbType.Decimal, null, ParameterDirection.Output);
            effects = Convert.ToDecimal(ReturnSP_Single_DecimalValue("pkg_fin_reports.sp_get_arrears", CommandType.StoredProcedure, _outParam, param));
            return effects;
        }

        //kapila 18/10/2012
        public DataTable Process_Age_Anal_Debt_Outstand(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _cust, Int32 _tp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[6] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_Age_Debt_Out_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Process_Age_Anal_Debt_OutstandDCN(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _cust, Int32 _tp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[6] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_Age_Debt_Out_DCN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        #endregion

        //kapila 15/8/2014
        public Int32 Process_bank_realization(string _com, string _pc, DateTime _date, string _accno, Int32 _isall, string _user, DateTime _month, Int32 _week)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isall;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[7] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_sun_upload.sp_proc_bank_realization", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable get_bank_realization_det(string _com, string _pc, DateTime _date, string _accno, string _doctp, Decimal _amtfrom, Decimal _amtto, Int32 _is_real_stus, Int32 _nt_in_state, Int32 _oth_bank, Int32 _withNIS, string _ref)
        {
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[5] = new OracleParameter("p_amt_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtfrom;
            (param[6] = new OracleParameter("p_amt_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtto;
            (param[7] = new OracleParameter("p_is_real_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_real_stus;
            (param[8] = new OracleParameter("p_nt_in_state", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _nt_in_state;
            (param[9] = new OracleParameter("p_oth_bnk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _oth_bank;
            (param[10] = new OracleParameter("p_withNIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withNIS;
            (param[11] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[12] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "pkg_sun_upload.sp_get_bank_rls_new", CommandType.StoredProcedure, false, param);
            return _tblData;


        }

        public DataTable get_bank_realization_Hdr(string _com, DateTime _date, string _accno)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;

            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_bnk_rls_hdr", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        public RemitanceSummaryDetail GetRemitanceAdjesmentDetails(string _com, string _pc, DateTime _date, string _section, string _code, string _ref)
        {
            RemitanceSummaryDetail _remList = null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _section;
            (param[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblRemSec", "sp_gnt_rem_getadj_new", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _remList = DataTableExtensions.ToGenericList<RemitanceSummaryDetail>(_dtResults, RemitanceSummaryDetail.Converter)[0];
            }
            return _remList;
        }

        public Int32 UpdateRemitanceAdjusment(RemitanceSummaryDetail _remSum)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_rem_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remSum.Rem_val;
            (param[1] = new OracleParameter("p_rem_val_final", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remSum.Rem_val_final;
            (param[2] = new OracleParameter("p_rem_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSum.Rem_rmk;
            (param[3] = new OracleParameter("p_rem_rmk_fin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSum.Rem_rmk_fin;
            (param[4] = new OracleParameter("p_rem_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSum.Rem_com;
            (param[5] = new OracleParameter("p_rem_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSum.Rem_pc;
            (param[6] = new OracleParameter("p_rem_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remSum.Rem_dt;
            (param[7] = new OracleParameter("p_rem_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSum.Rem_sec;
            (param[8] = new OracleParameter("p_rem_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSum.Rem_cd;

            (param[9] = new OracleParameter("p_rem_fin_net", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remSum.Rem_net_fin;
            (param[10] = new OracleParameter("p_rem_fin_add", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remSum.Rem_add_fin;
            (param[11] = new OracleParameter("p_rem_fin_ded", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _remSum.Rem_ded_fin;


            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_update_rem_adj", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<RemitanceSummaryDetail> GetRemitanceSumDetailAdjusment(DateTime _remDate, string _pc)
        {
            List<RemitanceSummaryDetail> _List = null;
            RemitanceSummaryDetail _remsumdet = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remDate;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_rem_sum_dtadj", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _List = new List<RemitanceSummaryDetail>();

                for (int i = 0; i < _dtResults.Rows.Count; i++)
                {
                    _remsumdet = new RemitanceSummaryDetail();
                    _remsumdet.Rem_cd = (_dtResults.Rows[i]["Rem_cd"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_cd"].ToString();
                    _remsumdet.RemSumDet = new RemitanceSumHeading()
                    {
                        Rsd_desc = (_dtResults.Rows[i]["Rsd_desc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rsd_desc"].ToString(),
                    };
                    _remsumdet.Rem_val = (_dtResults.Rows[i]["Rem_val"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["Rem_val"]);
                    _remsumdet.Rem_dt = (_dtResults.Rows[i]["Rem_dt"] == DBNull.Value) ? DateTime.Today : Convert.ToDateTime(_dtResults.Rows[i]["Rem_dt"]);
                    _remsumdet.Rem_pc = (_dtResults.Rows[i]["Rem_pc"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_pc"].ToString();
                    _remsumdet.Rem_ref_no = (_dtResults.Rows[i]["Rem_ref_no"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_ref_no"].ToString();
                    _remsumdet.Rem_rmk = (_dtResults.Rows[i]["Rem_rmk"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_rmk"].ToString();
                    _remsumdet.Rem_sec = (_dtResults.Rows[i]["Rem_sec"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["Rem_sec"].ToString();

                    _remsumdet.Rem_rmk_fin = (_dtResults.Rows[i]["REM_RMK_FIN"] == DBNull.Value) ? string.Empty : _dtResults.Rows[i]["REM_RMK_FIN"].ToString();
                    _remsumdet.Rem_val_final = (_dtResults.Rows[i]["REM_VAL_FINAL"] == DBNull.Value) ? 0 : Convert.ToDecimal(_dtResults.Rows[i]["REM_VAL_FINAL"]);

                    _List.Add(_remsumdet);
                }
            }
            return _List;

        }

        public Int32 SaveRemitanceStatus(RemitanceStatus _remSta)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_gpac_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remSta.Gpac_seq;
            (param[1] = new OracleParameter("p_gpac_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSta.Gpac_com;
            (param[2] = new OracleParameter("p_gpac_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSta.Gpac_pc;
            (param[3] = new OracleParameter("p_gpac_op_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remSta.Gpac_op_dt;
            (param[4] = new OracleParameter("p_gpac_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _remSta.Gpac_stus;
            (param[5] = new OracleParameter("p_gpac_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSta.Gpac_cre_by;
            (param[6] = new OracleParameter("p_gpac_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _remSta.Gpac_cre_dt;
            (param[7] = new OracleParameter("p_gpac_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _remSta.Gpac_tp;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_save_rem_fin", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 SaveExcessTrans(ExcessShortTrna _excsShortRem)
        {

            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_EXSS_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_com;
            (param[1] = new OracleParameter("p_EXSS_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_pc;
            (param[2] = new OracleParameter("p_EXSS_MNTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_mnth;
            (param[3] = new OracleParameter("p_EXSS_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_tp;
            (param[4] = new OracleParameter("p_EXSS_TXN_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_txn_dt;
            (param[5] = new OracleParameter("p_EXSS_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_desc;
            (param[6] = new OracleParameter("p_EXSS_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_amt;
            (param[7] = new OracleParameter("p_EXSS_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_user;
            (param[8] = new OracleParameter("p_EXSS_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_mod_when;
            (param[9] = new OracleParameter("p_EXSS_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortRem.Exss_rem;
            (param[10] = new OracleParameter("p_exss_is_memo", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortRem.EXSS_IS_MEMO;
            (param[11] = new OracleParameter("p_exss_is_claim", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortRem.EXSS_IS_CLAIM;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_excs_txn_new", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila
        public DataTable GetExcsSettlementDridData(string _pc, DateTime _mnth)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_mnth", OracleDbType.Date, null, ParameterDirection.Input)).Value = _mnth;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excs_set_dt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public Int32 DeleteExcsSettlement(string _com, string _pc, DateTime _month, DateTime _txnDate)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_exss_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_exss_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_exss_mnth", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_exss_txn_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _txnDate;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_excs_txn", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetExcsBalanceDridData(string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excs_bal_dt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetExcessBalance(string _com, string _pc, DateTime _month, out Decimal _totval)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_excs_bal", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                _val = _val + Convert.ToDecimal(_result.Rows[i]["BAL"]);

            }
            _totval = _val;
            return _result;
        }

        public List<ExcessRemitTypes> GetExcsShortRemitType(Int16 _isExcess)
        {
            List<ExcessRemitTypes> _userList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_is_exces", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isExcess;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excs_rem_tp", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _userList = DataTableExtensions.ToGenericList<ExcessRemitTypes>(_dtResults, ExcessRemitTypes.Converter);
            }
            return _userList;

        }

        //kapila
        public DataTable GetExcsStatus(string _pc, DateTime _month, out string _status, out string _id)
        {
            string _stus = "";
            string _eid = "";
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "SP_GET_EXCS_STUS", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                _stus = Convert.ToString(_result.Rows[i]["ESRH_STUS"]);
                _eid = Convert.ToString(_result.Rows[i]["ESRH_ID"]);

            }
            _status = _stus;
            _id = _eid;
            return _result;
        }

        //kapila
        public int ProcessExcessShort(string _com, string _pc, Int32 _year, Int32 _month, string _ID, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[3] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[4] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_process_excess_short", CommandType.StoredProcedure, false, param);
            return 1;
        }

        //kapila
        public int ConfirmExcessShort(string _com, string _pc, DateTime _month, DateTime _date, string _ID, string _desc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            (param[5] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _desc;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_confirm_excess_short", CommandType.StoredProcedure, false, param);
            return 1;
        }

        public Int32 SaveExcessHeader(ExcessShortHeader _excsShortHead)
        {

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_ESRH_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_id;
            (param[1] = new OracleParameter("p_ESRH_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_pc;
            (param[2] = new OracleParameter("p_ESRH_MNTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_mnth;
            (param[3] = new OracleParameter("p_ESRH_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_user;
            (param[4] = new OracleParameter("p_ESRH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_stus;
            (param[5] = new OracleParameter("p_ESRH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_cre_by;
            (param[6] = new OracleParameter("p_ESRH_CRE_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_cre_when;
            (param[7] = new OracleParameter("p_ESRH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_mod_by;
            (param[8] = new OracleParameter("p_ESRH_MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_mod_when;
            (param[9] = new OracleParameter("p_ESRH_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortHead.Esrh_session_id;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_excs_hdr", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 SaveExcessDetails(ExcessShortDet _excsShortDet)
        {

            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_ESRD_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_id;
            (param[1] = new OracleParameter("p_ESRD_WEEK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_week;
            (param[2] = new OracleParameter("p_ESRD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_line;
            (param[3] = new OracleParameter("p_ESRD_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_sec;
            (param[4] = new OracleParameter("p_ESRD_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_cd;
            (param[5] = new OracleParameter("p_ESRD_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_desc;
            (param[6] = new OracleParameter("p_ESRD_INVS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_invs;
            (param[7] = new OracleParameter("p_ESRD_EXCES", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_exces;
            (param[8] = new OracleParameter("p_ESRD_SHORT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_short;
            (param[9] = new OracleParameter("p_ESRD_FIXED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_fixed;
            (param[10] = new OracleParameter("p_ESRD_IS_MEMO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_is_memo;
            (param[11] = new OracleParameter("p_esrd_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_rem;
            (param[12] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _excsShortDet.Esrd_cre_by;
            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_excs_det_new_new1", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila
        public Int32 DeleteExcsShortDetail(string _ID)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_esrd_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_excs_det", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila
        public DataTable GetExcsShortGridData(string _com, string _pc, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excs_short_grid_data", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetcashControlAdj(string _com, string _pc, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_cash_adj", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetcashControl(string _com, string _pc, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_cash_control", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable GetSalesPromoterDet(string _com, string _pc, string _code)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_promoter_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //kapila
        public DataTable getVehInsReceipts(string _com, string _pc, DateTime _date, string _invno)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_veh_ins_rec", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable getVehInsReceipts4Payment(string _com, string _pc, DateTime _date, string _invno)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_vehins_rec4_pay", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //kapila
        public DataTable GetExcsShortOthRemGridData(string _ID)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.        
            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excs_short_rem_data", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public Int32 DeleteExcsShortOthRem(string _ID, Int32 _week, string _sec, string _code)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_esrd_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            (param[1] = new OracleParameter("p_ESRD_WEEK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[2] = new OracleParameter("p_ESRD_SEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[3] = new OracleParameter("p_ESRD_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_del_excs_oth_rem", CommandType.StoredProcedure, param);
            return effects;
        }

        //kapila 1/11/2012
        public Boolean IsDayEndDone(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (_para[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_check_day_end", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }

        //kapila 14/3/2013
        public Boolean IsOnceRemType(string _sec, string _code)
        {
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (_para[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;

            _para[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsOnceRemType = QueryDataTable("tbl", "sp_chk_is_once_rem_tp", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsOnceRemType;
        }

        //kapila 14/3/2013
        public Boolean IsOnceRemDataExist(string _com, string _pc, string _sec, string _code, DateTime _month)
        {
            OracleParameter[] _para = new OracleParameter[6];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (_para[3] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (_para[4] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            _para[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_chk_is_once_exist", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }

        //kapila 13/3/2013
        public Boolean IsTxnFoundAfterDayEnd(string _com, string _pc, DateTime _date, string _type)
        {
            Boolean _IsTxnFoundAfterDayEnd = false;
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (_type == "SALE")
            {
                _IsTxnFoundAfterDayEnd = QueryDataTable("tbl", "pkg_financial.sp_chk_sales_after_dayend", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            }
            else if (_type == "REC")
            {
                _IsTxnFoundAfterDayEnd = QueryDataTable("tbl", "pkg_financial.sp_chk_rec_after_dayend", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            }
            else if (_type == "RVT")
            {
                _IsTxnFoundAfterDayEnd = QueryDataTable("tbl", "pkg_financial.sp_chk_rvt_after_dayend", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            }
            return _IsTxnFoundAfterDayEnd;
        }

        public Boolean IsDayEndDone_Win(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (_para[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _dayEndFound = QueryDataTable("tbl", "sp_check_day_end_win", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _dayEndFound;
        }

        //kapila 1/11/2012
        public Boolean IsPrvDayTxnsFound(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _prvDayTxnsFound = QueryDataTable("tbl", "sp_check_prvday_txns", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _prvDayTxnsFound;
        }
        public Boolean IsPrvDayTxnsFound_DO(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _prvDayTxnsFound = QueryDataTable("tbl", "sp_check_prvday_txns_do", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _prvDayTxnsFound;
        }
        public Boolean IsPrvDayTxnsFound_Req(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _prvDayTxnsFound = QueryDataTable("tbl", "sp_check_prvday_txns_req", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _prvDayTxnsFound;
        }
        public Boolean IsPrvDayTxnsFound_Remit(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _prvDayTxnsFound = QueryDataTable("tbl", "sp_chk_prvday_rem", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _prvDayTxnsFound;
        }

        //kapila 1/3/2013
        public Boolean IsPrvDayTxnsFound_rec(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _prvDayTxnsFound = QueryDataTable("tbl", "sp_check_prvday_txns_rec", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _prvDayTxnsFound;
        }
        public Boolean IsPrvDayTxnsFound_rcc(string _com, string _loc, DateTime _date)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _prvDayTxnsFound = QueryDataTable("tbl", "sp_check_prvday_txns_rcc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _prvDayTxnsFound;
        }

        //kapila
        public Int32 ProcessFinalizeDayEnd(DateTime _date, string _com, string _pc)
        {

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_financial.sp_process_finalized_day_end", CommandType.StoredProcedure, param);

            return effects;
        }

        public DataTable GetExcessShortID(string _Com, string _pc, DateTime _date)
        {
            //Sanjeewa 2015-10-16
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[2] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("in_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_excess_short_id", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 3/11/2012
        public int PrintExcessShort(string _com, string _pc, string _ID, DateTime _date, string _status, string _user)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_excs_bal", CommandType.StoredProcedure, param);

            return 1;
        }

        //kapila 3/11/2012
        public int GetExcessShortPrvBalance(string _com, string _pc, DateTime _date, out Decimal _prvBal)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_excs_prv_bal", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["BAL"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["BAL"]);
                }

            }
            _prvBal = _val;
            return 1;
        }

        //kapila 3/11/2012
        public int GetExcessShortCurBalance(string _ID, out Decimal _curBal)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_excs_cur_bal", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["BAL"].ToString()))
                {
                    _val = _val + Convert.ToDecimal(_result.Rows[i]["BAL"]);
                }


            }
            _curBal = _val;
            return 1;
        }

        //kapila
        public int GetClosingBalance(DateTime _asAtDate, string _accno, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate;
            (param[1] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_acc_closin_bal", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["bal"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["bal"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila 9/11/2012
        public int Process_Excess_short_statement(DateTime _date, string _com, string _pc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_excs_short_statement", CommandType.StoredProcedure, false, param);
            return 1;
        }

        //kapila  13/11/2012
        public int GetFirstDayEndDate(string _com, string _pc, DateTime _from, DateTime _to, out DateTime _date)
        {
            DateTime _dt = _from;
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_1st_day_end_day", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["upd_dt"].ToString()))
                {
                    _dt = Convert.ToDateTime(_result.Rows[0]["upd_dt"]);
                }
            }

            _date = _dt;
            return 1;
        }

        public int GetLastDayEndDate(string _com, string _pc, DateTime _from, out DateTime _date)
        {
            DateTime _dt = _from;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_last_day_end", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["upd_dt"].ToString()))
                {
                    _dt = Convert.ToDateTime(_result.Rows[0]["upd_dt"]);
                }
            }

            _date = _dt;
            return 1;
        }

        //kapila 15/11/2012
        public int ProcessNoOfAccounts(DateTime _from, DateTime _to, DateTime _from1, string _com, string _user, Int32 _status)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_from_1", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from1;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _status;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_proc_no_of_create_acc", CommandType.StoredProcedure, false, param);
            return 1;
        }

        //kapila 21/11/2012
        public int Process_daily_trans_sum(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_financial.sp_process_daily_trans_sum", CommandType.StoredProcedure, false, param);
            return 1;
        }

        #region Scan/Physical Document
        //Shani 23-10-2012
        public DataTable GetWeeks_on_month(Int32 month, Int32 year, Int32 weekNo)
        {
            //if weekNo==(-1) then returns all records of the month.
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = month;
            (param[1] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = year;
            (param[2] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = weekNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_week_DAYS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable Get_GNT_RCV_DSK_DOC(string com, string pc, DateTime monthYear, Int32 week, string doc_tp, Int32 _isDocRec)
        {       //'monthYear' should be the first day of the month.
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_monthyr", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;
            (param[5] = new OracleParameter("p_is_doc_rec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isDocRec;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = null;
            _result = QueryDataTable("tbl", "get_GNT_RCV_DSK_DOC", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable Get_GNT_RCV_DSK_DOC_onDateRange(string com, string pc, DateTime fromDt, DateTime toDt, string doc_tp, Int32 _isDocRec)
        {       //'monthYear' should be the first day of the month.
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[3] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;
            (param[5] = new OracleParameter("p_is_doc_rec", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isDocRec;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = null;
            _result = QueryDataTable("tbl", "get_GNT_RCV_DSK_DOC_FORDate", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable Get_SunUploaded_gnt_rcv_dsk_doc(string com, string pc, DateTime monthYear, Int32 week, string doc_tp)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_monthyr", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = null;
            _result = QueryDataTable("tbl", "getSunUploaded_gnt_rcv_dsk_doc", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Int32 Update_GNT_RCV_DSK_DOC(ScanPhysicalDocReceiveDet _doc, Int32 isa_scanUpdate, Int32 isa_sunUpdate, Int32 isa_rcvUpdate)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[37];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_pc;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_month.Date;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_week;
            (param[5] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_dt.Date;
            (param[6] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_tp;
            (param[7] = new OracleParameter("p_doc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_desc;
            (param[8] = new OracleParameter("p_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_ref;
            (param[9] = new OracleParameter("p_sys_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Grdd_sys_val;
            (param[10] = new OracleParameter("p_scan_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_scan_rcv == true ? 1 : 0;
            (param[11] = new OracleParameter("p_is_realized", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_is_realized == true ? 1 : 0; ;
            (param[12] = new OracleParameter("p_realized_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_realized_dt;
            (param[13] = new OracleParameter("p_doc_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_rcv == true ? 1 : 0; ;
            (param[14] = new OracleParameter("p_doc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_val;
            (param[15] = new OracleParameter("p_doc_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank;
            (param[16] = new OracleParameter("p_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_is_extra == true ? 1 : 0; ;
            (param[17] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_rmk;
            (param[18] = new OracleParameter("p_deposit_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_deposit_bank;
            (param[19] = new OracleParameter("p_doc_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank_cd;
            (param[20] = new OracleParameter("p_doc_bank_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank_branch;
            (param[21] = new OracleParameter("p_sun_upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_sun_upload == true ? 1 : 0; ;
            (param[22] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_cre_by;
            (param[23] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_cre_dt;
            (param[24] = new OracleParameter("p_scan_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_scan_by;
            (param[25] = new OracleParameter("p_scan_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_scan_dt;
            (param[26] = new OracleParameter("p_sun_up_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_sun_up_by;
            (param[27] = new OracleParameter("p_sun_up_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_sun_up_dt;
            (param[28] = new OracleParameter("p_rcv_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_rcv_by;
            (param[29] = new OracleParameter("p_rcv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_rcv_dt;
            (param[30] = new OracleParameter("p_short_ref", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_short_ref;
            //p_short_ref
            (param[31] = new OracleParameter("p_isa_scanUpdate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isa_scanUpdate;
            (param[32] = new OracleParameter("p_isa_sunUpdate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isa_sunUpdate;
            (param[33] = new OracleParameter("p_isa_rcvUpdate", OracleDbType.Int32, null, ParameterDirection.Input)).Value = isa_rcvUpdate;
            (param[34] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_remarks;
            (param[35] = new OracleParameter("p_is_short_set", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.grdd_is_short_set;

            param[36] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int32)UpdateRecords("sp_update_GNT_RCV_DSK_DOC", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 Save_GNT_RCV_DSK_DOC(string createBy, DateTime createDt, string com, string pc, Int32 month, Int32 year, Int32 week, DateTime monthYear)
        {

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_creBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createBy;
            (param[1] = new OracleParameter("p_creDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = createDt;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = month;
            (param[5] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = year;
            (param[6] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            (param[7] = new OracleParameter("p_month_yr", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;

            param[8] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_Process_Docs", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila 30/7/2014
        public Int32 Save_Veh_Ins_Rent_Pay_Hdr(Int32 _seq, string _com, string _pc, string _accno, DateTime _dt, Decimal _amt, string _user)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[5] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_vinsrent_hdr", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila 30/9/2015
        public Int32 Save_Veh_Ins_Pay_Req_Hdr(Int32 _seq, string _com, string _pc, string _accno, DateTime _dt, Decimal _amt, string _user)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[5] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_veh_ins_renewal_req_hdr", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 savePromoterDetails(SalesPromotor _salePromot, string _pc)
        {

            OracleParameter[] param = new OracleParameter[23];

            (param[0] = new OracleParameter("p_MPP_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_com;
            (param[1] = new OracleParameter("p_MPP_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_MPP_PROMO_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_promo_cd;
            (param[3] = new OracleParameter("p_MPP_REF_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_ref_cd;
            (param[4] = new OracleParameter("p_MPP_PROMO_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_promo_name;
            (param[5] = new OracleParameter("p_MPP_PROMO_ADD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_promo_add1;
            (param[6] = new OracleParameter("p_MPP_PROMO_ADD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_promo_add2;
            (param[7] = new OracleParameter("p_MPP_PROMO_MOB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_promo_mob;
            (param[8] = new OracleParameter("p_MPP_PROMO_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_promo_nic;
            (param[9] = new OracleParameter("p_MPP_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _salePromot.Mpp_act;
            (param[10] = new OracleParameter("p_MPP_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal1;
            (param[11] = new OracleParameter("p_MPP_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal2;
            (param[12] = new OracleParameter("p_MPP_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal3;
            (param[13] = new OracleParameter("p_MPP_ANAL4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal4;
            (param[14] = new OracleParameter("p_MPP_ANAL5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal5;
            (param[15] = new OracleParameter("p_MPP_ANAL6", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal6;
            (param[16] = new OracleParameter("p_MPP_ANAL7", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _salePromot.Mpp_anal7;
            (param[17] = new OracleParameter("p_MPP_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_cre_by;
            (param[18] = new OracleParameter("p_MPP_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _salePromot.Mpp_cre_dt;
            (param[19] = new OracleParameter("p_MPP_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpp_mod_by;
            (param[20] = new OracleParameter("p_MPP_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _salePromot.Mpp_mod_dt;
            (param[21] = new OracleParameter("p_mpp_sup_code", OracleDbType.Date, null, ParameterDirection.Input)).Value = _salePromot.Mpp_sup_code;

            param[22] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_promoter", CommandType.StoredProcedure, param);

            return result;
        }


        public Int32 savePromoter(MST_PROMOTOR _salePromot)
        { //Nadeeka 11-05-2015

            OracleParameter[] param = new OracleParameter[23];

            (param[0] = new OracleParameter("p_mpr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_cd;
            (param[1] = new OracleParameter("p_mpr_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_name;
            (param[2] = new OracleParameter("p_mpr_add1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_add1;
            (param[3] = new OracleParameter("p_mpr_add2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_add2;
            (param[4] = new OracleParameter("p_mpr_nic", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_nic;
            (param[5] = new OracleParameter("p_mpr_mob", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_mob;
            (param[6] = new OracleParameter("p_mpr_email", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_email;
            (param[7] = new OracleParameter("p_mpr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _salePromot.Mpr_act;
            (param[8] = new OracleParameter("p_mpr_earn_cs", OracleDbType.Double, null, ParameterDirection.Input)).Value = _salePromot.Mpr_earn_cs;
            (param[9] = new OracleParameter("p_mpr_earn_pt", OracleDbType.Double, null, ParameterDirection.Input)).Value = _salePromot.Mpr_red_cs;
            (param[10] = new OracleParameter("p_mpr_red_cs", OracleDbType.Double, null, ParameterDirection.Input)).Value = _salePromot.Mpr_earn_pt;
            (param[11] = new OracleParameter("p_mpr_red_pt", OracleDbType.Double, null, ParameterDirection.Input)).Value = _salePromot.Mpr_red_pt;
            (param[12] = new OracleParameter("p_mpr_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal1;
            (param[13] = new OracleParameter("p_mpr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal2;
            (param[14] = new OracleParameter("p_mpr_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal3;
            (param[15] = new OracleParameter("p_mpr_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal4;
            (param[16] = new OracleParameter("p_mpr_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal5;
            (param[17] = new OracleParameter("p_mpr_anal6", OracleDbType.Date, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal6;
            (param[18] = new OracleParameter("p_mpr_anal7", OracleDbType.Double, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal7;
            (param[19] = new OracleParameter("p_mpr_anal8", OracleDbType.Double, null, ParameterDirection.Input)).Value = _salePromot.Mpr_anal8;
            (param[20] = new OracleParameter("p_mpr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_cre_by;
            (param[21] = new OracleParameter("p_mpr_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _salePromot.Mpr_mod_by;

            param[22] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_promoterDet", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila 30/7/2014
        public Int32 Save_Veh_Ins_Rent_Pay_Det(Int32 _seq, string _recno, string _chqno, string _chqbank, string _chqbranch, DateTime _chqdate, string _depbank, string _depbranch, Decimal _amt)
        {

            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[2] = new OracleParameter("p_chqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqno;
            (param[3] = new OracleParameter("p_chqbank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqbank;
            (param[4] = new OracleParameter("p_chqbranch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqbranch;
            (param[5] = new OracleParameter("p_chqdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _chqdate;
            (param[6] = new OracleParameter("p_depbank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _depbank;
            (param[7] = new OracleParameter("p_depbranch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _depbranch;
            (param[8] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amt;
            param[9] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_vinsrent_det", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila 30/9/2015
        public Int32 Save_Veh_Ins_Pay_Req_Det(Int32 _seq, string _recno, DateTime _recdt, Decimal _recamt, Decimal _paidamt)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_virnd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_virnd_rec_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[2] = new OracleParameter("p_virnd_rec_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _recdt;
            (param[3] = new OracleParameter("p_virnd_rec_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _recamt;
            (param[4] = new OracleParameter("p_virnd_paid", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _paidamt;
            param[5] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_veh_ins_renewal_req_dt", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 UpdateReceiptByVehInsRentPay(string _com, string _pc, string _recno, Decimal _balAmt, Decimal _payAmt)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;
            (param[3] = new OracleParameter("p_balamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _balAmt;
            (param[4] = new OracleParameter("p_payamt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _payAmt;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_recby_vinsrnt_pay", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 UpdateInsReqHdrStatus(string _com, string _pc, string _accno, string _stus)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;


            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_ins_req_hdr", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 UpdateRecByVehInsPayReq(string _com, string _pc, string _recno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_recno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _recno;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_recby_vins_pay_req", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 UpdateCashControl(string _com, string _pc, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_cash_control", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 new_Save_GNT_RCV_DSK_DOC(string createBy, DateTime createDt, string com, string pc, Int32 WEEK, DateTime frmDt, DateTime toDt, string _type, DateTime _month)
        {
            //           p_creBy in NVARCHAR2,
            //  p_creDate in DATE,
            //  p_com in NVARCHAR2,
            //  p_pc in NVARCHAR2,
            // p_week in NUMBER,
            //  p_frmDt out Date, -- **
            //  p_toDt out Date,---**
            //  effect OUT NUMBER

            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_creBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createBy;
            (param[1] = new OracleParameter("p_creDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = createDt;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = WEEK;
            (param[5] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt;
            (param[6] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[7] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[8] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            param[9] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_Process_Docs", CommandType.StoredProcedure, param);

            return result;
        }
        public Int32 Delete_GNT_RCV_DSK_DOC_new(string _com, string _pc, DateTime fromDt, DateTime toDt)
        {
            //SP_Delete_GNT_RCV_DSK_DOC_NEW(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_fromDt in DATE,p_toDt in DATE,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_fromDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromDt;
            (param[3] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int32)UpdateRecords("SP_Delete_GNT_RCV_DSK_DOC_NEW", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Delete_GNT_RCV_DSK_DOC(string _com, string _pc, DateTime monthYear, Int32 week)
        {
            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_monthYear in DATE,p_week in NUMBER,o_effect OUT NUMBER)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_monthYear", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int32)UpdateRecords("SP_Delete_GNT_RCV_DSK_DOC", CommandType.StoredProcedure, param);
            return effects;
        }
        public Dictionary<string, Decimal> Get_RemDet(string com, string pc, DateTime date)
        {
            // Decimal effects = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;

            List<OracleParameter> _outParaList = new List<OracleParameter>();
            OracleParameter _outPar_prvExc = new OracleParameter("p_prvExcess", OracleDbType.Decimal, null, ParameterDirection.Output);
            _outParaList.Add(_outPar_prvExc);

            OracleParameter _outPar_ExcRem = new OracleParameter("p_ExcessRem", OracleDbType.Decimal, null, ParameterDirection.Output);
            _outParaList.Add(_outPar_ExcRem);

            OracleParameter _outPar_CIH = new OracleParameter("p_cashInHand", OracleDbType.Decimal, null, ParameterDirection.Output);
            _outParaList.Add(_outPar_CIH);

            OracleParameter _outPar_AmtRem = new OracleParameter("p_amountRemited", OracleDbType.Decimal, null, ParameterDirection.Output);
            _outParaList.Add(_outPar_AmtRem);

            OracleParameter _outPar_Diff = new OracleParameter("p_difference", OracleDbType.Decimal, null, ParameterDirection.Output);
            _outParaList.Add(_outPar_Diff);

            List<OracleParameter> _ReturnParaList = new List<OracleParameter>();
            _ReturnParaList = ReturnSP_Many_DecimalValues("sp_RemDet", CommandType.StoredProcedure, _outParaList, param);

            Dictionary<string, Decimal> remDet_fortheDay = new Dictionary<string, decimal>();
            remDet_fortheDay.Add("PrvExcess", Convert.ToDecimal(_ReturnParaList[0].Value));
            remDet_fortheDay.Add("ExcessRem", Convert.ToDecimal(_ReturnParaList[1].Value));
            remDet_fortheDay.Add("CashInHand", Convert.ToDecimal(_ReturnParaList[2].Value));

            remDet_fortheDay.Add("AmtRemited", Convert.ToDecimal(_ReturnParaList[3].Value));
            remDet_fortheDay.Add("Defference", Convert.ToDecimal(_ReturnParaList[4].Value));
            return remDet_fortheDay;
        }
        public DataTable Get_ShortBankDocs(string com, string pc, DateTime monthYear, Int32 week, string doc_tp, string _accno, Int32 _withdtrange, DateTime _from, DateTime _to)
        {       //(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_monthYear in DATE,p_week in NUMBER,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_monthYear", OracleDbType.Date, null, ParameterDirection.Input)).Value = monthYear;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = week;
            (param[4] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;
            (param[5] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[6] = new OracleParameter("p_with_dt_range", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withdtrange;
            (param[7] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[8] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_getShortBankDocs_new1", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public ScanPhysicalDocReceiveDet Get_GNT_RCV_DSK_DOC_on_Seq(Int32 seqNum)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqNum;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "sp_getRCV_DSK_DOC_on_Seq", CommandType.StoredProcedure, false, param);

            ScanPhysicalDocReceiveDet doc = null;
            if (_dtResults.Rows.Count > 0)
            {
                doc = DataTableExtensions.ToGenericList<ScanPhysicalDocReceiveDet>(_dtResults, ScanPhysicalDocReceiveDet.Converter)[0];
            }
            return doc;
        }

        public Int32 Save_doc_GNT_RCV_DSK_DOC(ScanPhysicalDocReceiveDet _doc)
        {

            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_pc;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_month.Date;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_week;
            (param[5] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_dt.Date;
            (param[6] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_tp;
            (param[7] = new OracleParameter("p_doc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_desc;
            (param[8] = new OracleParameter("p_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_ref;
            (param[9] = new OracleParameter("p_sys_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Grdd_sys_val;
            (param[10] = new OracleParameter("p_scan_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_scan_rcv == true ? 1 : 0;
            (param[11] = new OracleParameter("p_is_realized", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_is_realized == true ? 1 : 0; ;
            (param[12] = new OracleParameter("p_realized_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_realized_dt;
            (param[13] = new OracleParameter("p_doc_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_rcv == true ? 1 : 0; ;
            (param[14] = new OracleParameter("p_doc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_val;
            (param[15] = new OracleParameter("p_doc_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank;
            (param[16] = new OracleParameter("p_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_is_extra == true ? 1 : 0; ;
            (param[17] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_rmk;
            (param[18] = new OracleParameter("p_deposit_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_deposit_bank;
            (param[19] = new OracleParameter("p_doc_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank_cd;
            (param[20] = new OracleParameter("p_doc_bank_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank_branch;
            (param[21] = new OracleParameter("p_sun_upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_sun_upload == true ? 1 : 0; ;
            (param[22] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_cre_by;
            (param[23] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_cre_dt;

            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_Gnt_rcv_dsk_doc", CommandType.StoredProcedure, param);

            //return result;

            return result; //result contains the generated seq #
        }

        public Int32 Save_doc_GNT_RCV_DSK_DOC_new(ScanPhysicalDocReceiveDet _doc)
        {

            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_seq;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_pc;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_month.Date;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_week;
            (param[5] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_dt.Date;
            (param[6] = new OracleParameter("p_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_tp;
            (param[7] = new OracleParameter("p_doc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_desc;
            (param[8] = new OracleParameter("p_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_ref;
            (param[9] = new OracleParameter("p_sys_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Grdd_sys_val;
            (param[10] = new OracleParameter("p_scan_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_scan_rcv == true ? 1 : 0;
            (param[11] = new OracleParameter("p_is_realized", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_is_realized == true ? 1 : 0; ;
            (param[12] = new OracleParameter("p_realized_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_realized_dt;
            (param[13] = new OracleParameter("p_doc_rcv", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_rcv == true ? 1 : 0; ;
            (param[14] = new OracleParameter("p_doc_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_val;
            (param[15] = new OracleParameter("p_doc_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank;
            (param[16] = new OracleParameter("p_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_is_extra == true ? 1 : 0; ;
            (param[17] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_rmk;
            (param[18] = new OracleParameter("p_deposit_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_deposit_bank;
            (param[19] = new OracleParameter("p_doc_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank_cd;
            (param[20] = new OracleParameter("p_doc_bank_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_doc_bank_branch;
            (param[21] = new OracleParameter("p_sun_upload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _doc.Grdd_sun_upload == true ? 1 : 0; ;
            (param[22] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc.Grdd_cre_by;
            (param[23] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _doc.Grdd_cre_dt;

            param[24] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_Gnt_rcv_dsk_doc_new", CommandType.StoredProcedure, param);

            //return result;

            return result; //result contains the generated seq #
        }

        public DataTable Get_GNR_RCV_DSK_DOC_Types()
        {       //'monthYear' should be the first day of the month.
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "get_GNR_RCV_DSK_DOC_Types", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable GET_pc_info_val_ONpc(string com, string pc, string code, string DocType)
        {
            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_cd in NVARCHAR2,p_tp in NVARCHAR2,c_data OUT sys_refcursor
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[3] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocType;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_pc_info_val_ONpc", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable Get_veh_ins_renewal_hdr(string com, string pc, string accno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_veh_ins_renewal_hdr", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GET_BANKS_of_PC_on_docType(string com, string pc, string doc_tp)
        {
            //p_com in NVARCHAR2,p_pc in NVARCHAR2,p_chanel in NVARCHAR2,p_docTp in NVARCHAR2,c_data OUT sys_refcursor

            DataTable dt = GET_pc_info_val_ONpc(com, pc, "CHNL", null);
            string chanel = "";
            if (dt != null)
            {
                if (dt.Rows.Count > 0)
                {
                    chanel = dt.Rows[0]["mpi_val"].ToString();
                }

            }
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[2] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chanel;
            (param[3] = new OracleParameter("p_docTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_BNK_ON_PC", CommandType.StoredProcedure, false, param);
            return _result;
        }
        #endregion Scan/Physical Document



        public Boolean IsPeriodClosed(string _com, string _pc, string type, DateTime date)
        {
            Boolean isclosed = false;
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (_para[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;

            OracleParameter _outParam = new OracleParameter("c_count", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 eff = Convert.ToInt32(ReturnSP_SingleValue("sp_IsPeriodOpen", CommandType.StoredProcedure, _outParam, _para));
            if (eff > 0)
            {
                isclosed = true;
            }
            return isclosed;
        }

        #region Monthly Summary Period Definition

        public Int32 Save_gnr_week(Int32 _Gw_year, Int32 _Gw_month, Int32 _Gw_week, DateTime _Gw_from_dt, DateTime _Gw_to_dt, string _Gw_cre_by, string _Gw_com)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Gw_year;
            (param[1] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Gw_month;
            (param[2] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Gw_week;
            (param[3] = new OracleParameter("p_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Gw_from_dt;
            (param[4] = new OracleParameter("p_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Gw_to_dt;
            (param[5] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Gw_cre_by;
            (param[6] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Gw_com;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_gnr_week", CommandType.StoredProcedure, param);

            return result;
        }

        //Shani 20-11-2012
        public List<GnrWeek> Get_ListOfWeeks_on_month(Int32 month, Int32 year, Int32 weekNo, string _com)
        {
            List<GnrWeek> Weeks = null;
            //if weekNo==(-1) then returns all records of the month.
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = month;
            (param[1] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = year;
            (param[2] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = weekNo;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_week_DAYS", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                Weeks = DataTableExtensions.ToGenericList<GnrWeek>(_result, GnrWeek.Converter);
            }

            return Weeks;
        }

        //Shani 21-11-2012
        public List<ArrearsDateDef> Get_ArrearsDateDef(string com, DateTime arrDt, string partyTp, string partyCode)
        {
            List<ArrearsDateDef> ArsDef = null;
            //(p_com in NVARCHAR2,p_arrDt in DATE,p_partyTp in NVARCHAR2,p_partyCd in NVARCHAR2,c_data OUT sys_refcursor)
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_arrDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = arrDt;
            (param[2] = new OracleParameter("p_partyTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyTp;
            (param[3] = new OracleParameter("p_partyCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = partyCode;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_ars_dt_defn", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                ArsDef = DataTableExtensions.ToGenericList<ArrearsDateDef>(_result, ArrearsDateDef.Converter);
            }

            return ArsDef;
        }

        public Int32 Save_hpr_ars_dt_defn(ArrearsDateDef _defHeader)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_pty_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _defHeader.Hadd_pty_tp;
            (param[1] = new OracleParameter("p_pty_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _defHeader.Hadd_pty_cd;
            (param[2] = new OracleParameter("p_ars_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _defHeader.Hadd_ars_dt;
            (param[3] = new OracleParameter("p_sup_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _defHeader.Hadd_sup_dt;
            (param[4] = new OracleParameter("p_grc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _defHeader.Hadd_grc_dt;
            (param[5] = new OracleParameter("p_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _defHeader.Hadd_cre_by;
            (param[6] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _defHeader.Hadd_cre_dt;

            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_save_hpr_ars_dt_defn", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 Update_hpr_ars_dt_defn(ArrearsDateDef _defHeader)
        {

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_sup_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _defHeader.Hadd_sup_dt;
            (param[1] = new OracleParameter("p_grc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _defHeader.Hadd_grc_dt;
            (param[2] = new OracleParameter("p_Hadd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _defHeader.Hadd_mod_by;
            (param[3] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _defHeader.Hadd_seq;


            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_hpr_ars_dt_defn", CommandType.StoredProcedure, param);

            return result;
        }
        #endregion End Monthly Summary Period Definition

        //kapila 19/12/2012
        public DataTable Process_Debtor_Sales_Receipts(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_Debt_sales_Rec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public List<DayEnd> GetDayEnds(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (_para[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            List<DayEnd> _end = new List<DayEnd>();
            DataTable result = QueryDataTable("tbl", "sp_check_day_end", CommandType.StoredProcedure, false, _para);
            if (result.Rows.Count > 0)
            {
                _end = DataTableExtensions.ToGenericList<DayEnd>(result, DayEnd.Converter);
            }
            return _end;
        }

        public Int32 DeleteDayEnd(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (_para[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            _para[4] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_delete_day_end", CommandType.StoredProcedure, _para);
            return result;
        }

        public DataTable GetRemSummary(string _pc, DateTime _fromDate, DateTime _toDate, string _sec)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_remit_summ", CommandType.StoredProcedure, false, param);

            return _result;
        }

        //kapila 17/1/2013
        public DataTable Process_AgeOfDebtors_Arrears_Win(DateTime _asatdate, string _com, string _pc, string _user, string _scheme, string _item, string _cat1, string _cat2, string _cat3, string _model, string _brand, Boolean _Isdetail)
        {
            DataTable _dtResults = null;

            if (_Isdetail == false)
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;

                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
                param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);



                _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_debt_arr_win1", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }

            else
            { //12-SEP-2014 Added by Nadeeka (Item Selection)
                OracleParameter[] param = new OracleParameter[12];
                (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
                (param[5] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param[6] = new OracleParameter("p_item_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
                (param[7] = new OracleParameter("p_item_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
                (param[8] = new OracleParameter("p_item_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
                (param[9] = new OracleParameter("p_item_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param[10] = new OracleParameter("p_item_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
                param[11] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_debt_arr_wini", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }

        }

        public DataTable Process_GivenPaymode_Collection(DateTime _fromdate, DateTime _todate, string _com, string _pc, string _paymode, string _user)
        {//Sanjeewa 2015-11-12
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_paymode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _paymode;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            _dtResults = QueryDataTable("tbl", "sp_get_giv_paymode_col", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getAccountServiceDetail(string _acc)
        {//Sanjeewa 2016-12-29
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;

            _dtResults = QueryDataTable("tbl", "sp_get_arrears_service_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Process_AgeOfDebtors_Arrears36(DateTime _asatdate, string _com, string _pc, string _user, string _scheme, string _item, string _cat1, string _cat2, string _cat3, string _model, string _brand, Int16 _noof_months, Boolean _Isdetail)
        {//Sanjeewa 2015-03-14
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
            (param[5] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[6] = new OracleParameter("p_item_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[7] = new OracleParameter("p_item_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[8] = new OracleParameter("p_item_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[9] = new OracleParameter("p_item_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[10] = new OracleParameter("p_item_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[11] = new OracleParameter("p_noof_months", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _noof_months;
            param[12] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_arrears_summ", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Process_No_of_pending_app()
        {//kapila 13/11/2015
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "Pkg_fin_reports.sp_print_no_of_requests", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Process_AgeOfDebtors_Arrears_Sum(DateTime _asatdate, string _com, string _pc, string _user, string _scheme, string _item, string _cat1, string _cat2, string _cat3, string _model, string _brand, Boolean _Isdetail)
        {
            DataTable _dtResults = null;


            if (_Isdetail == false)
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
                param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_debt_arr_sum1", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            else
            {//12-SEP-2014 Added by Nadeeka (Item Selection)
                OracleParameter[] param = new OracleParameter[12];
                (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
                (param[5] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param[6] = new OracleParameter("p_item_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
                (param[7] = new OracleParameter("p_item_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
                (param[8] = new OracleParameter("p_item_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
                (param[9] = new OracleParameter("p_item_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param[10] = new OracleParameter("p_item_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
                param[11] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_debt_arr_sumi", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }

        }

        public DataTable Process_AgeOfDebtors_Arrears_Chanel(DateTime _asatdate, string _com, string _pc, string _user, string _scheme, string _item, string _cat1, string _cat2, string _cat3, string _model, string _brand, Boolean _Isdetail)
        {
            DataTable _dtResults = null;

            if (_Isdetail == false)
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;

                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
                param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_debt_arr_chn1", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }

            else
            {//12-SEP-2014 Added by Nadeeka (Item Selection)
                OracleParameter[] param = new OracleParameter[12];

                (param[0] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
                (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param[4] = new OracleParameter("p_scheme", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _scheme;
                (param[5] = new OracleParameter("p_item_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
                (param[6] = new OracleParameter("p_item_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
                (param[7] = new OracleParameter("p_item_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
                (param[8] = new OracleParameter("p_item_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
                (param[9] = new OracleParameter("p_item_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param[10] = new OracleParameter("p_item_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
                param[11] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

                _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_age_anls_debt_arr_chni", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
        }

        //kapila
        public DataTable get_Rem_Sum_Rep(string _com, string _pc, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_rem_sum_rep", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable get_Trans_Variation(string _com, DateTime _from, DateTime _to, string _type, string _user, string _perm)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_perm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _perm;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_price_variation", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable get_Rem_Sum_Rep_View(DateTime _date, string _com, string _pc, string _user, string _sec, Decimal _comm, string _insTp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[6] = new OracleParameter("p_com_wd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm;
            (param[7] = new OracleParameter("p_instype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insTp;
            param[8] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_dayend.sp_view_day_end_win", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable get_Rem_Sum_Rep_View_dt_range(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _sec, Decimal _comm, string _insTp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (param[7] = new OracleParameter("p_com_wd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _comm;
            (param[8] = new OracleParameter("p_instype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _insTp;
            param[9] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_dayend.sp_view_day_end_win_dt_range", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila
        public DataTable get_Rtn_Chq(string _pc, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_rtn_chq", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public DataTable get_SignOff_Rec(string _user, string _pc, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_SignOff_Rec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable get_SignOff_less(string _pc, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_SignOff_less", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int get_SignOff_Cash_Tot(string _pc, DateTime _from, DateTime _to, out Decimal _value)
        {
            DataTable _result = null;
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_get_signoff_cash_tot", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["TOT"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[0]["TOT"]);
                }
            }

            _value = _val;
            return 1;
        }

        //kapila 11/3/2013
        public DataTable Print_RCC_Receipt(string _rccNo)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccNo;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_rcc_print", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Print_ACInsNote(string _rccNo)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccNo;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_acins_print", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //kapila 12/3/2013
        public DataTable Print_RCC_Ret_Condition(string _rccNo)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_rccno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rccNo;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_rcc_ret_condition", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public Int32 Cancel_ReturnChequesSettlement(string _ref, Int32 _seq, Decimal _reductAmt)
        {
            //PROCEDURE Cancel_retunChequeSettlement(p_refNo in NVARCHAR2,p_seq in NUMBER,p_reductAmt in NUMBER, o_effect out NUMBER)
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_refNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[2] = new OracleParameter("p_reductAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _reductAmt;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("Cancel_retunChequeSettlement", CommandType.StoredProcedure, param);

            return result;
        }
        //SHANI 19-03-2013
        public DataTable get_Rtn_Chq_DET(string _pc, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_rtn_chq_DET", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila 19/3/2013
        public Boolean IsRemLimitFound(string _ptype, string _pcode, DateTime _date, string _sec, string _code, out DateTime _from, out DateTime _to, out Decimal _val)
        {
            Boolean _IsRemLimitFound = false;
            DateTime _fromDate = Convert.ToDateTime(DateTime.Now.Date).Date;
            DateTime _toDate = Convert.ToDateTime(DateTime.Now.Date).Date;
            Decimal _Limit = 0;
            OracleParameter[] _para = new OracleParameter[6];
            (_para[0] = new OracleParameter("p_ptype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ptype;
            (_para[1] = new OracleParameter("p_pcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcode;
            (_para[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (_para[3] = new OracleParameter("p_sec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sec;
            (_para[4] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            _para[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_get_rem_limit", CommandType.StoredProcedure, false, _para);
            if (_result.Rows.Count > 0)
            {
                _IsRemLimitFound = true;
                _fromDate = Convert.ToDateTime(_result.Rows[0]["rsmd_from_dt"]);
                _toDate = Convert.ToDateTime(_result.Rows[0]["rsmd_to_dt"]);
                _Limit = Convert.ToDecimal(_result.Rows[0]["rsmd_max_val"]);
            }
            _from = _fromDate;
            _to = _toDate;
            _val = _Limit;

            return _IsRemLimitFound;
        }

        public DataTable get_rtn_chq_byBankChqNo(string p_bank, string p_chqNo)
        {//p_bank in NVARCHAR2,p_chqNo in DATE,c_data OUT sys_refcursor)
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bank;
            (param[1] = new OracleParameter("p_chqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_chqNo;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "get_rtn_chq_byBankChqNo", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public DataTable ProcessPersonalChequeStatement(string _user_id, DateTime _fromdate, DateTime _toDate, string _Company, string _pc)
        {   // Nadeeka 20-03-13
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[2] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[3] = new OracleParameter("in_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_ProcPersonalChequeStatement", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetMigrateSerialDetails(string _com, string _loc, DateTime _date)
        {   // Sanjeewa 2018-02-14
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            DataTable _dtResults = QueryDataTable("tblRcc", "sp_get_mig_bal_ser", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable ProcessSunUploadElite(string _user_id, DateTime _fromdate, DateTime _toDate, string _Company, string _Profit)
        {   // Nadeeka 25-06-13
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;
            (param[5] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Profit;
            if (_Company == "SGL" || _Company == "SGD" || _Company == "SGL" || _Company == "PNG" || _Company == "FIO" || _Company == "PSN" || _Company == "EDL")
            {
                _dtResults = QueryDataTable("tblRcc", "pkg_sunupload_elite_sgl.PROC_ELITE_SALES_UPLOAD", CommandType.StoredProcedure, false, param);
            }
            else { _dtResults = QueryDataTable("tblRcc", "pkg_sunupload_elite.PROC_ELITE_SALES_UPLOAD", CommandType.StoredProcedure, false, param); }
            return _dtResults;
        }
        public DataTable ProcessSunUploadDutyFree(string _user_id, DateTime _fromdate, DateTime _toDate, string _Company, string _Profit)
        {   // Nadeeka 25-06-13
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            (param[4] = new OracleParameter("in_Company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Company;
            (param[5] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Profit;
            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_sunupload_elite.PROC_ELITE_SALES_UPLOAD_DFS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable ProcessSunUploadLoyalty(string _user_id, DateTime _fromdate, DateTime _toDate)
        {   // Nadeeka 25-06-13
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_toDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            DataTable _dtResults = QueryDataTable("tblRcc", "pkg_sunupload_elite.PROC_LOYALTY_UPLOAD", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetESDStatement(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            // Sanjeewa 14-06-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_esd_details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetCollBonusDtl(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _status, string _User)
        {
            // Sanjeewa 09-09-2014         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_col_bon_det", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetRcvDskProcessed(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            // Sanjeewa 10-07-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_check_rcv_dsk_processed", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetESDRecon(DateTime _month, string _User, string _com, string _pc)
        {
            // kapila 16/6/2014    
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_esd_recon", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetADLoanSettDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 05-04-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_ad_load_sett", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetRcvDeskRemSumDetails(int _Year, int _Month, int NoofMonth, string _User, string _Com, string _Pc)
        {
            // Sanjeewa 27-01-2013         
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_year", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Year;
            (param[2] = new OracleParameter("in_month", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _Month;
            (param[3] = new OracleParameter("in_noofmonth", OracleDbType.Int16, null, ParameterDirection.Input)).Value = NoofMonth;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[5] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[6] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_rcv_dsk_rem_sum", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetShortSettDetails(DateTime _fromDate, DateTime _toDate, string _User, string _Com, string _Pc)
        {
            // Sanjeewa 03-02-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_short_sett_rep", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 9/4/2013
        public DataTable Process_Short_Rem_statement(string _user, string _com, DateTime _asatdate, Int32 _isAsAt, DateTime _from, DateTime _to)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[3] = new OracleParameter("p_is_asat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAsAt;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_short_rem_statement", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable Process_Excess_Rem_statement(string _user, string _com, DateTime _asatdate, Int32 _isAsAt, DateTime _from, DateTime _to)
        {// Nadeeka 31-jan-2014
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[3] = new OracleParameter("p_is_asat", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAsAt;
            (param[4] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[5] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            param[6] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_excess_rem_statement", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetClaimExpVoucherDetails(DateTime _fromDate, DateTime _toDate, string _User)
        {
            // Sanjeewa 08-04-2013         
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_claim_exp_voucher", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 10/4/2013
        public Int16 SaveShortBanking(Short_Banking _short_Banking)
        {
            OracleParameter[] param = new OracleParameter[11];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_SB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _short_Banking.SB_COM;
            (param[1] = new OracleParameter("p_SB_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _short_Banking.SB_PC;
            (param[2] = new OracleParameter("p_SB_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _short_Banking.SB_DT;
            (param[3] = new OracleParameter("p_SB_PRV_EXS_REM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _short_Banking.SB_PRV_EXS_REM;
            (param[4] = new OracleParameter("p_SB_EXS_REM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _short_Banking.SB_EXS_REM;
            (param[5] = new OracleParameter("p_SB_CIH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _short_Banking.SB_CIH;
            (param[6] = new OracleParameter("p_SB_REMITED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _short_Banking.SB_REMITED;
            (param[7] = new OracleParameter("p_SB_DIFF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _short_Banking.SB_DIFF;
            (param[8] = new OracleParameter("p_SB_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _short_Banking.SB_MONTH;
            (param[9] = new OracleParameter("p_SB_WEEK", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _short_Banking.SB_WEEK;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_save_short_bank", CommandType.StoredProcedure, param);
            return effects;
        }


        public VoucherPrintExpenseDefinition GetVoucherExpense(string _com, string _expense)
        {
            //sachith 2013/04/09
            OracleParameter[] param = new OracleParameter[3];
            VoucherPrintExpenseDefinition vou = null;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_exp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_vou_expen_def", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherPrintExpenseDefinition>(_dtResults, VoucherPrintExpenseDefinition.Converter)[0];
            }
            return vou;
        }

        public List<VoucherPrintExpenseDefinition> GetVoucherExpenseByCode(string _expense)
        {
            //sachith 2013/04/09
            OracleParameter[] param = new OracleParameter[3];
            List<VoucherPrintExpenseDefinition> vou = null;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "%";
            (param[1] = new OracleParameter("p_exp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_vou_expen_def", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherPrintExpenseDefinition>(_dtResults, VoucherPrintExpenseDefinition.Converter);
            }
            return vou;
        }

        public int SaveVoucherExpenseDefinition(VoucherPrintExpenseDefinition _expense)
        {

            OracleParameter[] param = new OracleParameter[15];

            (param[0] = new OracleParameter("p_gved_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _expense.Gved_seq;
            (param[1] = new OracleParameter("p_gved_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense.Gved_com;
            (param[2] = new OracleParameter("p_gved_expe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense.Gved_expe_cd;
            (param[3] = new OracleParameter("p_gved_expe_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense.Gved_expe_cat;
            (param[4] = new OracleParameter("p_gved_expe_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expense.Gved_expe_from_dt;
            (param[5] = new OracleParameter("p_gved_expe_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expense.Gved_expe_to_dt;
            (param[6] = new OracleParameter("p_gved_expe_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense.Gved_expe_desc;
            (param[7] = new OracleParameter("p_gved_expe_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _expense.Gved_expe_val;
            (param[8] = new OracleParameter("p_gved_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _expense.Gved_stus;
            (param[9] = new OracleParameter("p_gved_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense.Gved_cre_by;
            (param[10] = new OracleParameter("p_gved_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expense.Gved_cre_dt;
            (param[11] = new OracleParameter("p_gved_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _expense.Gved_mod_by;
            (param[12] = new OracleParameter("p_gved_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _expense.Gved_mod_dt;
            (param[13] = new OracleParameter("p_gved_vou_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _expense.Gved_vou_tp;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("save_vou_expense_def", CommandType.StoredProcedure, param);

            return result;

        }

        public List<VoucherPrintExpenseDefinition> GetAllVoucherExpense(string _com, DateTime _date)
        {
            //sachith 2013/04/09
            OracleParameter[] param = new OracleParameter[3];
            List<VoucherPrintExpenseDefinition> vou = null;
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_all_vou_expense", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherPrintExpenseDefinition>(_dtResults, VoucherPrintExpenseDefinition.Converter);
            }
            return vou;
        }

        public int SaveVoucherHeader(VoucherHeader _voucher)
        {

            OracleParameter[] param = new OracleParameter[36];

            (param[0] = new OracleParameter("p_givh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_seq;
            (param[1] = new OracleParameter("p_givh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_com;
            (param[2] = new OracleParameter("p_givh_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_vou_no;
            (param[3] = new OracleParameter("p_givh_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_dt;
            (param[4] = new OracleParameter("p_givh_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_valid_from;
            (param[5] = new OracleParameter("p_givh_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_valid_to;
            (param[6] = new OracleParameter("p_givh_emp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_emp_cd;
            (param[7] = new OracleParameter("p_givh_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.Givh_val;
            (param[8] = new OracleParameter("p_givh_print_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_print_stus;
            (param[9] = new OracleParameter("p_givh_act_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_act_stus;
            (param[10] = new OracleParameter("p_givh_claim_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_stus;
            (param[11] = new OracleParameter("p_givh_claim_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_com;
            (param[12] = new OracleParameter("p_givh_claim_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_pc;
            (param[13] = new OracleParameter("p_givh_claim_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_dt;
            (param[14] = new OracleParameter("p_givh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_cre_by;
            (param[15] = new OracleParameter("p_givh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_cre_dt;
            (param[16] = new OracleParameter("p_givh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_mod_by;
            (param[17] = new OracleParameter("p_givh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_mod_dt;
            (param[18] = new OracleParameter("p_givh_val_txt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_val_txt;
            (param[19] = new OracleParameter("p_givh_prep_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_prep_by;
            (param[20] = new OracleParameter("p_givd_acpt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_acpt_by;
            (param[21] = new OracleParameter("p_givd_auth_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_auth_by;

            (param[22] = new OracleParameter("P_givd_emp_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_emp_name;
            (param[23] = new OracleParameter("p_givd_emp_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_emp_cat;
            (param[24] = new OracleParameter("p_givd_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_chnl;
            (param[25] = new OracleParameter("p_givd_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_dept;
            (param[26] = new OracleParameter("p_givh_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_period;
            (param[27] = new OracleParameter("p_givh_issunupload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_issunupload;
            (param[28] = new OracleParameter("p_givh_vou_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_vou_tp;
            (param[29] = new OracleParameter("p_givh_bnk_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_bnk_acc;
            (param[30] = new OracleParameter("p_givh_bnk_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_bnk_cd;
            (param[31] = new OracleParameter("p_givh_brnch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_brnch_cd;
            (param[32] = new OracleParameter("p_givh_cheque_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_cheque_no;
            (param[33] = new OracleParameter("p_givh_printname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_printname;
            (param[34] = new OracleParameter("P_givh_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_Note;
            param[35] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_vou_hdr", CommandType.StoredProcedure, param);

            return result;
        }

        public int SaveVoucherDefinition(VoucherDetails _voucher)
        {

            OracleParameter[] param = new OracleParameter[14];

            (param[0] = new OracleParameter("p_givd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givd_seq;
            (param[1] = new OracleParameter("p_givd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givd_line;
            (param[2] = new OracleParameter("p_givd_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_vou_no;
            (param[3] = new OracleParameter("p_givd_expe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_expe_cd;
            (param[4] = new OracleParameter("p_givd_expe_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_expe_desc;
            (param[5] = new OracleParameter("p_givd_expe_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.Givd_expe_val;
            (param[6] = new OracleParameter("p_givd_expe_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givd_expe_direct;
            (param[7] = new OracleParameter("p_givd_prep_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_prep_by;
            (param[8] = new OracleParameter("p_givd_acpt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_acpt_by;
            (param[9] = new OracleParameter("p_givd_auth_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_auth_by;
            (param[10] = new OracleParameter("p_givd_anal1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.Givd_anal1;
            (param[11] = new OracleParameter("p_givd_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_anal2;
            (param[12] = new OracleParameter("p_gvid_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Gvid_dt;

            param[13] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_vou_det", CommandType.StoredProcedure, param);

            return result;

        }

        public VoucherHeader GetVoucher(string _com, string _vou)
        {
            //sachith 2013/04/16
            OracleParameter[] param = new OracleParameter[3];
            VoucherHeader vou = null;
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_vou_hdr", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherHeader>(_dtResults, VoucherHeader.Converter)[0];
            }
            return vou;
        }

        public List<VoucherDetails> GetVoucherDetail(string _vou)
        {
            //sachith 2013/04/16
            OracleParameter[] param = new OracleParameter[2];
            List<VoucherDetails> vou = null;
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_vou_det", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherDetails>(_dtResults, VoucherDetails.Converter);
            }
            return vou;
        }


        public int CancelVoucher(string _com, string _vou, Int32 act, Int32 print, string mod_by, DateTime mod_dt)
        {
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = act;
            (param[3] = new OracleParameter("p_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = print;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mod_by;
            (param[5] = new OracleParameter("p_mod_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = mod_dt;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_cancel_voucher", CommandType.StoredProcedure, param);

            return result;

        }

        public List<VoucherHeader> GetVoucherSearch(int cancel, int print, string _com, DateTime _from, DateTime _to, string _vou)
        {
            //sachith 2013/04/16
            OracleParameter[] param = new OracleParameter[7];
            List<VoucherHeader> vou = null;
            (param[0] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = cancel;
            (param[1] = new OracleParameter("p_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = print;

            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_all_vou", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherHeader>(_dtResults, VoucherHeader.Converter);
            }
            return vou;


        }

        //kapila
        public DataTable GetManualDocCheckListPrint(string _com, string _pc, DateTime _month, Int32 _week)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_check_list_print", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable CashControlPrint(string _user, string _com, string _pc, Int32 _year, Int32 _month, DateTime _from, DateTime _to, string _stus)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[4] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[5] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[6] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[7] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_cash_control_print", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable CashControlReconPrint(string _user, string _com, string _pc, DateTime _month)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_Cash_control_recon", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sanjeewa 2014-10-28
        public DataTable CrcdReconciliationDetails(DateTime _asatdate, string _account, string _com, string _pc, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatdate;
            (param[1] = new OracleParameter("in_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _account;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_sun_upload.sp_get_crcd_recon", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable RemitanceCheckListPrint(string _user, string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[4] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_remit_check_list_print", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila 8/5/2013
        public DataTable ProcessSUNUpload_ScanDocs(DateTime _month, Int32 _week, DateTime _fromdate, DateTime _to, string _com, string _user, string _acc_period, string _sunID, string _type, string _mnth_str, string _insuTp)
        {
            DataTable _result = null;
            DataTable result1 = null;

            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[7] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            (param[8] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[9] = new OracleParameter("p_str_month", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mnth_str;
            param[10] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (_insuTp == "DIRIYA")
                _result = QueryDataTable("tbl", "pkg_financial.sp_process_scandoc_upload", CommandType.StoredProcedure, false, param);
            else
                _result = QueryDataTable("tbl", "pkg_financial.sp_process_scandoc_upload_XYZ", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                OracleParameter[] param1 = new OracleParameter[5];
                (param1[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
                (param1[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
                (param1[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
                (param1[3] = new OracleParameter("p_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
                param1[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                result1 = QueryDataTable("tbl", "sp_update_sun_bnkchg", CommandType.StoredProcedure, false, param1);
            }

            return _result;
        }

        //kapila 22/10/2014
        public DataTable ProcessSUNUpload_BankCharge(DateTime _month, Int32 _week, DateTime _to, string _com, string _user, string _acc_period, string _sunID, string _type, string _mnth_str)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            (param[7] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[8] = new OracleParameter("p_str_month", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mnth_str;
            param[9] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_scandoc_upload", CommandType.StoredProcedure, false, param);

            return _result;
        }

        //kapila 13/5/2013
        public Boolean IsWeekDefFound(Int32 _year, Int32 _month, Int32 _week, string _com)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (_para[1] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (_para[2] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (_para[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsWeekDefFound = QueryDataTable("tbl", "sp_chk_wk_def", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsWeekDefFound;
        }

        public Boolean IsCashControlFinalized(string _com, string _pc, DateTime _month)
        {
            OracleParameter[] _para = new OracleParameter[4];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            _para[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _IsWeekDefFound = QueryDataTable("tbl", "sp_chk_ccntrl_final", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _IsWeekDefFound;
        }

        public DataTable PrintSignOff(string _com, string _pc, DateTime _from, DateTime _to, string _user, Int32 _isGroup, Int32 _isAll)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_is_group", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isGroup;
            (param[6] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            //_dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_sign_off", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "sp_print_sign_off_test", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintCancelInvs(string _com, string _pc, DateTime _from, DateTime _to, string _user, Int32 _isGroup, Int32 _isAll)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_is_group", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isGroup;
            (param[6] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_Cancel_inv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintReverseInv(string _com, string _pc, DateTime _from, DateTime _to, string _user, Int32 _isGroup, Int32 _isAll)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_is_group", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isGroup;
            (param[6] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_reverse_inv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public DataTable PrintAdvReceipts(string _com, string _pc, DateTime _from, DateTime _to, string _user, Int32 _isGroup, Int32 _isAll)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_is_group", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isGroup;
            (param[6] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_Adv_Receipt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintCashRefunds(string _com, string _pc, DateTime _from, DateTime _to, string _user, Int32 _isGroup, Int32 _isAll)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_is_group", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isGroup;
            (param[6] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_cash_refund", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetInternalPayVouDetails(DateTime _fromDate, DateTime _toDate, string _Exec, string _Com, string _Pc, string _RepTp, string _User)
        {
            // Sanjeewa 28-03-2014         
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("n_cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_exec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Exec;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[7] = new OracleParameter("in_reptp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _RepTp;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_pay_voucher", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable GetESDDetails(DateTime _fromDate, DateTime _toDate, string _Exec, string _Com, string _Pc, string _RepTp, string _User)
        {
            // Sanjeewa 13-06-2014         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_esd_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable getProductBonusDetails(string _user, DateTime _from, DateTime _to, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_pbonus_sum", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintCreditInvoices(string _com, string _pc, DateTime _from, DateTime _to, string _user, Int32 _isGroup, Int32 _isAll)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_is_group", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isGroup;
            (param[6] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAll;

            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_cred_inv", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public Boolean Is_PC_Finalized(string _com, string _pc, DateTime date)
        {
            //sp_IsPC_Finalized(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_date in DATE,c_count OUT NUMBER)
            Boolean isFinalized = false;
            OracleParameter[] _para = new OracleParameter[3];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;

            OracleParameter _outParam = new OracleParameter("c_count", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 eff = Convert.ToInt32(ReturnSP_SingleValue("sp_IsPC_Finalized", CommandType.StoredProcedure, _outParam, _para));
            if (eff > 0)
            {
                isFinalized = true;
            }
            return isFinalized;
        }

        public Int32 FinalizeDayEnd(DateTime _from, DateTime _to, string _com, string _pc, string _user)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_financial.sp_finalize_day_end", CommandType.StoredProcedure, param);

            return result;
        }

        public int GetOpenBal(string _com, string _pc, DateTime _from, DateTime _to, string _user, out Decimal _opBal, out Decimal _closeBal, string _stus)
        {
            Decimal _opval = 0;
            Decimal _closeval = 0;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _stus;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_opbal", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["totamt"].ToString()))
                {
                    _opval = _opval + Convert.ToDecimal(_result.Rows[i]["opbal"]);
                    _closeval = _closeval + Convert.ToDecimal(_result.Rows[i]["cih"]);
                }
            }

            _opBal = _opval;
            _closeBal = _closeval;

            return 1;
        }

        //kapila
        public DataTable get_SignOn(string _com, string _pc, string _user, DateTime _dt)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            param[4] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_signon", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable getPendingDenom(string _com, string _pc, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[3] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_pending_deno", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable getSignOnBySeq(Int32 _seq)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;

            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_signon_by_seq", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable get_denom_types(string _com, Int32 _isCash)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_is_cash", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isCash;

            param[2] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_denom", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable get_PrintSignOn(Int32 _seq)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[1] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_print_signon", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //kapila
        public DataTable get_non_post_txns(string _com, string _pc, DateTime _from, DateTime _to, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[5] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_get_non_posted_trans", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Boolean IsCommCalculated(string _invno)
        {
            OracleParameter[] _para = new OracleParameter[2];
            (_para[0] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            _para[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _commcalc = QueryDataTable("tbl", "sp_check_com_calc", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;

            return _commcalc;
        }

        //kapila 
        public DataTable Print_RCC_Listing_Report(string _com, string _pc, DateTime _from, DateTime _to, string _user, string _rcctp, string _agent, string _colMethod, string _closeTp, string _status, string _cat1, string _cat2, string _cat3, string _brand, string _model, string _item)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_rcc_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rcctp;
            (param[6] = new OracleParameter("p_agent", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agent;
            (param[7] = new OracleParameter("p_col_method", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _colMethod;
            (param[8] = new OracleParameter("p_close_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _closeTp;
            (param[9] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[10] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[11] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[12] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[13] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[14] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[15] = new OracleParameter("p_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;

            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_RCC_Listing", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable Print_RCC_Job_Report(string _com, string _pc, DateTime _from, DateTime _to, string _user)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            _dtResults = QueryDataTable("tbl", "sp_get_rcc_job_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 UpdatePrvDayCIH(string _user, string _com, string _pc, DateTime _date, Int32 _week)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            //Int32 result = UpdateRecords("pkg_financial.sp_update_prvday_CIH", CommandType.StoredProcedure, param);
            Int32 result = UpdateRecords("sp_update_prvday_cih", CommandType.StoredProcedure, param);

            return result;
        }

        public DataTable GetIncSch(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable GetIncSchDet(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH_DET", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable GetIncSchPerson(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH_PERSON", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable GetIncSchPC(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH_PC", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable GetIncSchSalesTp(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH_SALT_TP", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable GetIncSchInc(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH_INC", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable GetIncSchIncDt(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "pkg_fin_reports.sp_INC_SCH_INC_DET", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable GetFromCurr_to_ToCurr(string _fromCur, string to_curr, DateTime TODAY, string company)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_fromCur", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromCur;
            (param[1] = new OracleParameter("p_to_curr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = to_curr;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = TODAY.Date;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "get_BaseCurrToLKR", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public DataTable getPOS_HPAccount(string accNo, DateTime asatDt)
        {
            string _sql = string.Empty;
            _sql = "select * from HP_T_Accounts where hpa_Location  = 'RMDG'"; //RMDG-000101
            _sql = "select * from HP_T_Accounts where hpa_Number   = 'RMDG-000101' AND hpa_Location ='RMDG' AND hpa_Status <>'C' ";
            System.Data.SqlClient.SqlConnection conn = new System.Data.SqlClient.SqlConnection("");
            System.Data.SqlClient.SqlCommand sqlcommand = new System.Data.SqlClient.SqlCommand(_sql, conn);
            conn.Open();
            System.Data.SqlClient.SqlDataReader DR = sqlcommand.ExecuteReader();
            DataTable dt = new DataTable();
            dt.TableName = "tblac";
            dt.Load(DR);
            conn.Close();
            return dt;
        }

        //kapila
        public Int32 Process_OtherLocation_Selling_Comm(DateTime _from, DateTime _to, string _com, string _loc, string _defPC, Int32 _week, string _user)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[4] = new OracleParameter("p_def_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _defPC;
            (param[5] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[6] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_financial.sp_proc_oth_loc_del_sale_comm", CommandType.StoredProcedure, param);

            return effects;
        }

        public Int32 Process_group_sale_Selling_Comm(string _com, string _pc, DateTime _date)
        {

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_financial.sp_update_grp_sale_comm", CommandType.StoredProcedure, param);

            return effects;
        }

        public int IsValidWeekDataRange(Int32 _year, Int32 _month, DateTime _from, DateTime _to, string _com)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[1] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_financial.sp_check_date_range", CommandType.StoredProcedure, param);

            return effects;
        }

        //darshana on 04-09-2013
        public int SaveRtnCalIntrest(ReturnChequeCalInterest _rtnInt)
        {

            OracleParameter[] param = new OracleParameter[15];

            (param[0] = new OracleParameter("p_src_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtnInt.Src_com;
            (param[1] = new OracleParameter("p_src_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtnInt.Src_pc;
            (param[2] = new OracleParameter("p_src_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtnInt.Src_ref_no;
            (param[3] = new OracleParameter("p_src_due_days", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rtnInt.Src_due_days;
            (param[4] = new OracleParameter("p_src_due_cal_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rtnInt.Src_due_cal_dt;
            (param[5] = new OracleParameter("p_src_cal_cap", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _rtnInt.Src_cal_cap;
            (param[6] = new OracleParameter("p_src_int", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _rtnInt.Src_int;
            (param[7] = new OracleParameter("p_src_cal_from", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rtnInt.Src_cal_from;
            (param[8] = new OracleParameter("p_src_cal_to", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rtnInt.Src_cal_to;
            (param[9] = new OracleParameter("p_src_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtnInt.Src_usr;
            (param[10] = new OracleParameter("p_src_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _rtnInt.Src_cre_dt;
            (param[11] = new OracleParameter("p_src_active", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _rtnInt.Src_active;
            (param[12] = new OracleParameter("p_src_chq_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtnInt.Src_chq_bank;
            (param[13] = new OracleParameter("p_src_rtn_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rtnInt.Src_rtn_bank;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_savertnintcal", CommandType.StoredProcedure, param);

            return result;

        }

        //darshana 04-09-2013
        public List<ReturnChequeCalInterest> get_calrtn_int(string _com, string _pc, string _ref, string _bank, Int32 _from, Int32 _to, DateTime _AsAtDate)
        {
            List<ReturnChequeCalInterest> _List = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[4] = new OracleParameter("p_fromVal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _from;
            (param[5] = new OracleParameter("p_toVal", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _to;
            (param[6] = new OracleParameter("p_AsatDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _AsAtDate;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable tblDet = QueryDataTable("tbl_det", "sp_getcalrtnchqint", CommandType.StoredProcedure, false, param);
            if (tblDet.Rows.Count > 0)
            {
                _List = DataTableExtensions.ToGenericList<ReturnChequeCalInterest>(tblDet, ReturnChequeCalInterest.Converter);
            }
            return _List;

        }

        public DataTable PrintAdvReceiptRegistry(string _com, DateTime _from, DateTime _to, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_adv_rec_registry", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //kapila
        public DataTable PrintAdvReceiptRecon(string _com, string _pc, DateTime _from, DateTime _to, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_adv_rec_recon", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintDiriyaFund(string _com, DateTime _from, DateTime _to, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_diriya_fund", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintOverandShort(string _com, DateTime _date, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_excs_short_state", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintOverandShortDetail(string _pc, string _com, DateTime _dateFrom, DateTime _dateTo, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dateFrom;
            (param[4] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dateTo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_OverandShortDetail", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //dilshan on 09/11/2018
        public DataTable PrintOverandShortMovement(string _pc, string _com, DateTime _dateFrom, DateTime _dateTo, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dateFrom;
            (param[4] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dateTo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_OverandShortMovement", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintOverandShortSum(string _pc, string _com, DateTime _dateFrom, DateTime _dateTo, string _user)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("in_profit", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("in_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[2] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dateFrom;
            (param[4] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dateTo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_overandshortSum", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintCashCommDefHead(string _user, DateTime _from, DateTime _to, string _circ)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_cash_com_head", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable PrintCashCommDefDet(string _user, DateTime _from, DateTime _to, string _circ)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_cash_com_det", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        public DataTable PrintDeliveredSalesForComm(DateTime _from, DateTime _to, string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_proc_del_sales", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public DataTable PrintHPInformation(DateTime _from, DateTime _to, string _com, string _user, string _pc)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_print_hp_infor", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //29-10-2013 darshana
        public DataTable GetReturnChequesFromRemSum(string _pc, string _ref, string _bCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[2] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "sp_get_rtn_chqremsum", CommandType.StoredProcedure, false, param);

            return _dtResults;


        }

        public DataTable GetScanDocumentSummary(string _company, string _profitcenter, DateTime _fromdate, DateTime _todate)
        {
            //sp_getsummary(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_frmdt in date,p_todt in date, c_data out sys_refcursor)
            DataTable _dt = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[3] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dt = QueryDataTable("_dt", "sp_getsummary", CommandType.StoredProcedure, false, param);

            return _dt;
        }


        public int RemoveScanDocumentDetail(string _company, string _profitcenter, DateTime _fromdate, DateTime _todate)
        {
            //sp_delsummary(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_frmdt in date,p_todt in date, o_effect out NUMBER)
            int _effect = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[3] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _effect = UpdateRecords("sp_delsummary", CommandType.StoredProcedure, param); ;
            return _effect;
        }






        public Int32 GetScanDocumentID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            // sp_getscandocseq(o_serialid OUT NUMBER)
            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_getscandocseq", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 UpdateChequeTotal(string _company, string _profitcenter, DateTime _frmdate, DateTime _todate, string _chqno, string _bank, string _branch)
        {
            OracleParameter[] param = new OracleParameter[8];
            Int32 effects = 0;
            // sp_gettotalchq(p_com in NVARCHAR2,p_pc in NVARCHAR2,p_frmdt in DATE,p_todt in date,p_chq in NVARCHAR2,p_bank in NVARCHAR2,p_branch in NVARCHAR2,o_effect out NUMBER)  
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitcenter;
            (param[2] = new OracleParameter("p_frmdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _frmdate;
            (param[3] = new OracleParameter("p_todt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[4] = new OracleParameter("p_chq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chqno;
            (param[5] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[6] = new OracleParameter("p_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _branch;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_gettotalchq", CommandType.StoredProcedure, param);
            return effects;
        }

        //09-11-2013 darshana
        public DataTable GetChequesFromRemDet(string _com, string _ref)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "sp_get_chq_remdet", CommandType.StoredProcedure, false, param);

            return _dtResults;


        }





        public DataTable Get_dt_inc_sch_inc(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_dt_inc_sch_inc", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable Get_dt_inc_sch_inc_dt(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_dt_inc_sch_inc_dt", CommandType.StoredProcedure, false, param);

            return _tbl;
        }
        public DataTable Get_dt_inc_sch_dt(string _circular, string _ref)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circular;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tbl = QueryDataTable("tblPc", "sp_get_dt_inc_sch_dt", CommandType.StoredProcedure, false, param);

            return _tbl;
        }

        public Int32 confirm_inc_sch(string _circ, string _user)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
            (param[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("sp_upd_inc_sch", CommandType.StoredProcedure, param);

            return effects;
        }

        public VoucherHeader GetValidVoucher(DateTime _date, string _com, string _vou)
        {

            OracleParameter[] param = new OracleParameter[4];
            VoucherHeader vou = null;
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_int_vou", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<VoucherHeader>(_dtResults, VoucherHeader.Converter)[0];
            }
            return vou;
        }

        public Int32 UpdateIntVoucher(string _com, string _vou, Int32 _stus, string _claimcom, string _claimpc)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;
            (param[3] = new OracleParameter("p_claim_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _claimcom;
            (param[4] = new OracleParameter("p_claim_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _claimpc;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_upd_int_vou", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 UpdateColBonusVoucher(string _com, string _pc, string _vou, Int32 _stus, string _user)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[3] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_upd_colb_vou", CommandType.StoredProcedure, param);

            return result;
        }

        public DataTable ProcessSUNUpload_PayVouEntry(DateTime _from, DateTime _to, string _com, string _user, string _chanel, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chanel;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_vouEntry_upload", CommandType.StoredProcedure, false, param);


            return _result;
        }
        public DataTable ProcessSUNUpload_PayVouClaim(DateTime _from, DateTime _to, string _com, string _user, string _chanel, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_chanel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chanel;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.sp_process_vouClaim_upload", CommandType.StoredProcedure, false, param);


            return _result;
        }

        public Int32 GetReportAllowPeriod(string _com, Int32 _id)
        {
            Int32 _prd = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _id;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_rpt_alw_prd", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                _prd = Convert.ToInt32(_result.Rows[0]["rpap_prd"]);
            }
            else
            {
                _prd = 0;
            }

            return _prd;
        }

        public int getHPAccValue(string _com, string _pc, string _acc, out Decimal _val)
        {
            Decimal _hpVal = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_hp_val", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["hpa_hp_val"].ToString()))
                {
                    _hpVal = Convert.ToDecimal(_result.Rows[0]["hpa_hp_val"]);
                }
            }

            _val = _hpVal;
            return 1;
        }

        public Int16 IsHOFinalized(string _com, string _pc, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAssLoc", "sp_is_ho_finalized", CommandType.StoredProcedure, false, param);

            Int16 _isHoFinalised = 0;
            if (_dtResults.Rows.Count > 0)
            {
                _isHoFinalised = 1;
            }

            return _isHoFinalised;
        }

        public DataTable Get_PBonus_VOu(string _ref, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pbns_vou", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //public Int32 UpdatePBonusVoucher(string _com,string _pc,string _circ,string _sch, Decimal    _pbih_refund,   string _pbih_refund_rem,   string _pbih_refund_upd_by,   Decimal _pbih_acc_ded,   string _pbih_acc_rem,   string _pbih_acc_upd_by ,   Decimal _pbih_cc_ded ,   string _pbih_cc_rem ,   string _pbih_cc_upd_by ,   Decimal _pbih_crd_ded ,   string _pbih_crd_rem,   string _pbih_crd_upd_by ,   Decimal _pbih_net ,   string _pbih_prep_by,   string _pbih_chk_by ,   string  _pbih_auth_by,string _man)
        //{

        //    OracleParameter[] param = new OracleParameter[22];

        //    (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
        //    (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
        //    (param[2] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _circ;
        //    (param[3] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch;
        //    (param[4] = new OracleParameter("p_pbih_refund", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pbih_refund;
        //    (param[5] = new OracleParameter("p_pbih_refund_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_refund_rem;
        //    (param[6] = new OracleParameter("p_pbih_refund_upd_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_refund_upd_by;
        //    (param[7] = new OracleParameter("p_pbih_acc_ded", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pbih_acc_ded;
        //    (param[8] = new OracleParameter("p_pbih_acc_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_acc_rem;
        //    (param[9] = new OracleParameter("p_pbih_acc_upd_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_acc_upd_by;
        //    (param[10] = new OracleParameter("p_pbih_cc_ded", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pbih_cc_ded;
        //    (param[11] = new OracleParameter("p_pbih_cc_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_cc_rem;
        //    (param[12] = new OracleParameter("p_pbih_cc_upd_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_cc_upd_by;
        //    (param[13] = new OracleParameter("p_pbih_crd_ded", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pbih_crd_ded;
        //    (param[14] = new OracleParameter("p_pbih_crd_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_crd_rem;
        //    (param[15] = new OracleParameter("p_pbih_crd_upd_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_crd_upd_by;
        //    (param[16] = new OracleParameter("p_pbih_net", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _pbih_net;
        //    (param[17] = new OracleParameter("p_pbih_prep_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_prep_by;
        //    (param[18] = new OracleParameter("p_pbih_chk_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_chk_by;
        //    (param[19] = new OracleParameter("p_pbih_auth_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbih_auth_by;
        //    (param[20] = new OracleParameter("p_manager", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _man;

        //    param[21] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
        //    //Query Data base.         
        //    Int32 result = UpdateRecords("sp_upd_pbonus", CommandType.StoredProcedure, param);

        //    return result;
        //}


        public Int32 ConfirmPBonusVoucher(string _sch, Int32 _isAcc, Int32 _isCC, Int32 _isCrd)
        {

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_sch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sch;
            (param[1] = new OracleParameter("p_is_acc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAcc;
            (param[2] = new OracleParameter("p_is_cc", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isCC;
            (param[3] = new OracleParameter("p_is_crd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isCrd;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_confirm_pbonus", CommandType.StoredProcedure, param);

            return result;
        }

        public DataTable GetValidPBVoucher(DateTime _date, string _com, string _pc, string _vou)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_pb_voucher", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable GetValidColBonusVoucher(string _com, string _pc, string _vou)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_colb_vou", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public DataTable PrintPBonusVoucher(string _ref, string _com, string _pc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_get_pb_vou", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public Int32 Save_PBonus_Vou_Header(PBonusVouHeader _PBVouHdr)
        {
            OracleParameter[] param = new OracleParameter[31];
            (param[0] = new OracleParameter("p_PBPH_VOU_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_vou_ref;
            (param[1] = new OracleParameter("p_PBPH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_com;
            (param[2] = new OracleParameter("p_PBPH_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_pc;
            (param[3] = new OracleParameter("p_PBPH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_dt;
            (param[4] = new OracleParameter("p_PBPH_ACC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_acc_ref;
            (param[5] = new OracleParameter("p_PBPH_GROSS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_gross;
            (param[6] = new OracleParameter("p_PBPH_REFUND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_refund;
            (param[7] = new OracleParameter("p_PBPH_REFUND_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_refund_rem;
            (param[8] = new OracleParameter("p_PBPH_REFUND_UPD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_refund_upd_by;
            (param[9] = new OracleParameter("p_PBPH_ACC_DED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_acc_ded;
            (param[10] = new OracleParameter("p_PBPH_ACC_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_acc_rem;
            (param[11] = new OracleParameter("p_PBPH_ACC_UPD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_acc_upd_by;
            (param[12] = new OracleParameter("p_PBPH_CC_DED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_cc_ded;
            (param[13] = new OracleParameter("p_PBPH_CC_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_cc_rem;
            (param[14] = new OracleParameter("p_PBPH_CC_UPD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_cc_upd_by;
            (param[15] = new OracleParameter("p_PBPH_CRD_DED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_crd_ded;
            (param[16] = new OracleParameter("p_PBPH_CRD_REM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_crd_rem;
            (param[17] = new OracleParameter("p_PBPH_CRD_UPD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_crd_upd_by;
            (param[18] = new OracleParameter("p_PBPH_NET", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_net;
            (param[19] = new OracleParameter("p_PBPH_PREP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_prep_by;
            (param[20] = new OracleParameter("p_PBPH_CHK_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_chk_by;
            (param[21] = new OracleParameter("p_PBPH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_stus;
            (param[22] = new OracleParameter("p_PBPH_AUTH_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_auth_by;
            (param[23] = new OracleParameter("p_PBPH_PRINT_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_print_stus;
            (param[24] = new OracleParameter("p_PBPH_CLAIM_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_claim_stus;
            (param[25] = new OracleParameter("p_PBPH_MANAGER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_manager;
            (param[26] = new OracleParameter("p_PBPH_REFUND_1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_refund_1;
            (param[27] = new OracleParameter("p_PBPH_ADJ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_adj;
            (param[28] = new OracleParameter("p_PBPH_VALID_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_valid_from;
            (param[29] = new OracleParameter("p_PBPH_VALID_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PBVouHdr.Pbph_valid_to;

            param[30] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_save_pb_vou_hdr", CommandType.StoredProcedure, param);

            return result;
        }
        public Int32 Save_PBonus_Vou_Det(PBonusVouDetail _PBVouDet)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_PBPD_VOU_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouDet.Pbpd_vou_ref;
            (param[1] = new OracleParameter("p_PBPD_CIRC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouDet.Pbpd_circ;
            (param[2] = new OracleParameter("p_PBPD_SCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouDet.Pbpd_sch;
            (param[3] = new OracleParameter("p_PBPD_VALUE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouDet.Pbpd_value;
            param[4] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_save_pb_vou_det", CommandType.StoredProcedure, param);

            return result;
        }
        public Int32 Save_PBonus_Vou_Ded(PBonusVouDedc _PBVouDed)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_PBPDD_VOU_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouDed.Pbpdd_vou_ref;
            (param[1] = new OracleParameter("p_PBPDD_DED_CD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PBVouDed.Pbpdd_ded_cd;
            (param[2] = new OracleParameter("p_PBPDD_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PBVouDed.Pbpdd_amt;
            (param[3] = new OracleParameter("p_PBPDD_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouDed.Pbpdd_tp;
            (param[4] = new OracleParameter("p_PBPDD_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PBVouDed.Pbpdd_desc;
            param[5] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_save_pb_vou_ded", CommandType.StoredProcedure, param);

            return result;
        }

        public Int32 UpdatePBVoucherHeader(string _ref, Decimal _gross, Decimal _ccDed, string _ccRem, string _ccUpdBy, Decimal _crdDed, string _crdRem, string _crdUpdBy, Decimal _net, string _usrType)
        {
            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("P_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_gross", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gross;
            (param[2] = new OracleParameter("p_cc_ded", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ccDed;
            (param[3] = new OracleParameter("p_cc_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ccRem;
            (param[4] = new OracleParameter("p_cc_up_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ccUpdBy;
            (param[5] = new OracleParameter("p_crd_ded", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _crdDed;
            (param[6] = new OracleParameter("p_crd_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _crdRem;
            (param[7] = new OracleParameter("p_crd_updby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _crdUpdBy;
            (param[8] = new OracleParameter("p_net", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _net;
            (param[9] = new OracleParameter("p_usrType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _usrType;
            param[10] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_pb_vou_hdr", CommandType.StoredProcedure, param);

            return result;
        }


        public DataTable Get_PBVoucher_header(string voucherNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_voucherNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblvou", "sp_get_pbvou_hdr", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }
        public DataTable Get_PBVoucher_detail(string voucherNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_voucherNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = voucherNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblProfitCenter = QueryDataTable("tblvou", "sp_get_pbvou_det", CommandType.StoredProcedure, false, param);

            return _tblProfitCenter;
        }

        public DataTable ProcessSUNUpload_PBonus(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, Int32 _is_dealer, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;

            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_product_bonus.sp_process_pbonus_upload", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public Int32 UpdateShortSettlement(Int32 _seq, Decimal _val, Int32 _isSUN, string _rem, DateTime _month, Int32 _week, string _user, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_grds_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;
            (param[1] = new OracleParameter("p_grds_set_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[2] = new OracleParameter("p_grds_set_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[3] = new OracleParameter("p_grds_set_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_grds_set_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            (param[5] = new OracleParameter("p_grds_is_sun", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isSUN;
            (param[6] = new OracleParameter("p_grds_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;
            (param[7] = new OracleParameter("p_grds_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("sp_upd_short_settle", CommandType.StoredProcedure, param);

            return result;
        }

        public DataTable getDocSettle(string com, string pc, DateTime _from, DateTime _to, Int32 _week, string doc_tp)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            (param[5] = new OracleParameter("p_docType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc_tp;

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = null;
            _result = QueryDataTable("tbl", "sp_get_doc_settle", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getRevertChargeDef(string com, DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = null;
            _result = QueryDataTable("tbl", "sp_get_rvt_chg", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public Int32 Save_Short_Settlements(string createBy, DateTime createDt, string com, string pc, Int32 WEEK, DateTime frmDt, DateTime toDt, string _type)
        {

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_creBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createBy;
            (param[1] = new OracleParameter("p_creDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = createDt;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = WEEK;
            (param[5] = new OracleParameter("p_frmDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDt;
            (param[6] = new OracleParameter("p_toDt", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDt;
            (param[7] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;

            param[8] = new OracleParameter("effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_process_short_settle", CommandType.StoredProcedure, param);

            return result;
        }

        public Int16 confirmPBVoucher(string _vou, Int32 _isChk, Int32 _isAuth)
        {
            OracleParameter[] param = new OracleParameter[4];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[1] = new OracleParameter("p_is_chk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isChk;
            (param[2] = new OracleParameter("p_is_auth", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isAuth;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_pb_vou_confirm", CommandType.StoredProcedure, param);
            return effects;
        }

        public int GetTotalSettlements(string _com, string _pc, DateTime _month, Int32 _week, out Decimal _value)
        {
            Decimal _val = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;


            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_tot_set_new", CommandType.StoredProcedure, false, param);

            for (int i = 0; i < _result.Rows.Count; i++)
            {
                if (!string.IsNullOrEmpty(_result.Rows[i]["totamt"].ToString()))
                {
                    _val = Convert.ToDecimal(_result.Rows[i]["totamt"]);
                }
            }

            _value = _val;

            return 1;
        }

        public Int32 UpdateRemRtnChq(string _newChq, string _newBank, string _com, string _pc, string _rmSec, string _rmCd, string _oldChq, string _oldBank, DateTime _newDt, string _branch)
        {

            OracleParameter[] param = new OracleParameter[11];

            (param[0] = new OracleParameter("p_newChq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newChq;
            (param[1] = new OracleParameter("p_newBank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newBank;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_rmSec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmSec;
            (param[5] = new OracleParameter("p_rmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rmCd;
            (param[6] = new OracleParameter("p_oldChq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldChq;
            (param[7] = new OracleParameter("p_oldBank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _oldBank;
            (param[8] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _newDt;
            (param[9] = new OracleParameter("p_branch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _branch;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_updateremrtnchq", CommandType.StoredProcedure, param);

            return result;
        }

        //kapila 21/3/2014
        public DataTable ProcessSUNUpload_AOAInvoice(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, Int32 _is_dealer, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_is_dealer", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_dealer;
            (param[7] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[8] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_sun_upload.sp_process_aoainv_upload", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public List<RemSection> GetAuthorizeTansactions(string _user_id)
        {
            List<RemSection> _userAuthTransactions = null;
            //Query Data base.
            ConnectionOpen();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_se_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtAuthTrans = QueryDataTable("tblSystemOption", "sp_getuserapprovepermission_tp", CommandType.StoredProcedure, false, param);
            ConnectionClose();
            #region Data Access
            try
            {
                if (_dtAuthTrans.Rows.Count > 0) _userAuthTransactions = DataTableExtensions.ToGenericList<RemSection>(_dtAuthTrans, RemSection.ConverterAuthorize);
            }
            catch (Exception e)
            {
                throw e; //TODO: Throw the exception to general           
            }
            #endregion
            return _userAuthTransactions;


        }
        public List<RemSection> GetDistinctSartMainTP(string _user_id)
        {
            List<RemSection> _getDistinctSartCD = null;
            //Query Data base.
            ConnectionOpen();

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_se_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user_id;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblSystemOption", "SP_GETDISTINCT_SART_MAIN_TP", CommandType.StoredProcedure, false, param);



            ConnectionClose();

            #region Data Access
            try
            {
                if (_dtResults.Rows.Count > 0) _getDistinctSartCD = DataTableExtensions.ToGenericList<RemSection>(_dtResults, RemSection.Converter_Sart_TP);
            }
            catch (Exception e)
            {
                throw e; //TODO: Throw the exception to general           
            }
            #endregion
            return _getDistinctSartCD;


        }

        //Tharaka 09-09-2014
        public DataTable GetChequeVoucherAccount(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }
            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);
            string _code = null;
            string _NAME = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _code = _searchText;
                        break;
                    case "NAME":
                        _NAME = _searchText;
                        break;
                    default:
                        break;
                }
            }
            _code = (_code != null) ? (_code.ToUpper() + "%") : null;
            _NAME = (_NAME != null) ? (_NAME.ToUpper() + "%") : null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(searchParams[1].ToString()).Date;
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _code;
            (param[3] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _NAME;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_GET_ACCOUNT_CHQ_VOUCHER", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 09-09-2014
        public DataTable GetInvoiceForChqEntry(string _com, string _PC)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PC;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_INVOICENO_CHQENTRY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 09-09-2014
        public DataTable GET_ACC_DETAILS(string P_COM, string P_ACC)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = P_COM;
            (param[1] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = P_ACC;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_ACC_DETAILS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 11-09-2014
        public int SaveVoucherDefinitionAllDetails(InterVoucherDetails _voucher)
        {
            OracleParameter[] param = new OracleParameter[24];
            (param[0] = new OracleParameter("p_givd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_SEQ;
            (param[1] = new OracleParameter("p_givd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_LINE;
            (param[2] = new OracleParameter("p_givd_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_VOU_NO;
            (param[3] = new OracleParameter("p_givd_expe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_CD;
            (param[4] = new OracleParameter("p_givd_expe_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_DESC;
            (param[5] = new OracleParameter("p_givd_expe_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_VAL;
            (param[6] = new OracleParameter("p_givd_expe_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_DIRECT;
            (param[7] = new OracleParameter("p_givd_prep_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_PREP_BY;
            (param[8] = new OracleParameter("p_givd_acpt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ACPT_BY;
            (param[9] = new OracleParameter("p_givd_auth_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_AUTH_BY;
            (param[10] = new OracleParameter("p_givd_anal1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL1;
            (param[11] = new OracleParameter("p_givd_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL2;
            (param[12] = new OracleParameter("p_gvid_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.GVID_DT;
            (param[13] = new OracleParameter("p_givd_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL3;
            (param[14] = new OracleParameter("p_givd_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL4;
            (param[15] = new OracleParameter("p_givd_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL5;
            (param[16] = new OracleParameter("p_givd_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL6;
            (param[17] = new OracleParameter("p_givd_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL7;
            (param[18] = new OracleParameter("p_givd_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL8;
            (param[19] = new OracleParameter("p_givd_anal9", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL9;
            (param[20] = new OracleParameter("p_givd_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL10;
            (param[21] = new OracleParameter("p_givd_anal11", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL11;
            (param[22] = new OracleParameter("p_givd_anal12", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL12;
            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_save_vou_det_alldetails", CommandType.StoredProcedure, param);

            return result;
        }

        //Tharaka 16-09-2014
        public List<InterVoucherDetails> GetChequeVoucherDetail(string _vou)
        {
            //sachith 2013/04/16
            OracleParameter[] param = new OracleParameter[2];
            List<InterVoucherDetails> vou = null;
            (param[0] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_vou_det", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                vou = DataTableExtensions.ToGenericList<InterVoucherDetails>(_dtResults, InterVoucherDetails.Converter);
            }
            return vou;
        }

        public int UpdateVoucherHeader(VoucherHeader _voucher)
        {
            OracleParameter[] param = new OracleParameter[36];

            (param[0] = new OracleParameter("p_givh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_seq;
            (param[1] = new OracleParameter("p_givh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_com;
            (param[2] = new OracleParameter("p_givh_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_vou_no;
            (param[3] = new OracleParameter("p_givh_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_dt;
            (param[4] = new OracleParameter("p_givh_valid_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_valid_from;
            (param[5] = new OracleParameter("p_givh_valid_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_valid_to;
            (param[6] = new OracleParameter("p_givh_emp_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_emp_cd;
            (param[7] = new OracleParameter("p_givh_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.Givh_val;
            (param[8] = new OracleParameter("p_givh_print_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_print_stus;
            (param[9] = new OracleParameter("p_givh_act_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_act_stus;
            (param[10] = new OracleParameter("p_givh_claim_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_stus;
            (param[11] = new OracleParameter("p_givh_claim_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_com;
            (param[12] = new OracleParameter("p_givh_claim_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_pc;
            (param[13] = new OracleParameter("p_givh_claim_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_claim_dt;
            (param[14] = new OracleParameter("p_givh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_cre_by;
            (param[15] = new OracleParameter("p_givh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_cre_dt;
            (param[16] = new OracleParameter("p_givh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_mod_by;
            (param[17] = new OracleParameter("p_givh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.Givh_mod_dt;
            (param[18] = new OracleParameter("p_givh_val_txt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_val_txt;
            (param[19] = new OracleParameter("p_givh_prep_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_prep_by;
            (param[20] = new OracleParameter("p_givd_acpt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_acpt_by;
            (param[21] = new OracleParameter("p_givd_auth_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_auth_by;
            (param[22] = new OracleParameter("P_givd_emp_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_emp_name;
            (param[23] = new OracleParameter("p_givd_emp_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_emp_cat;
            (param[24] = new OracleParameter("p_givd_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_chnl;
            (param[25] = new OracleParameter("p_givd_dept", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givd_dept;
            (param[26] = new OracleParameter("p_givh_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_period;
            (param[27] = new OracleParameter("p_givh_issunupload", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_issunupload;
            (param[28] = new OracleParameter("p_givh_vou_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_vou_tp;
            (param[29] = new OracleParameter("p_givh_bnk_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_bnk_acc;
            (param[30] = new OracleParameter("p_givh_bnk_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_bnk_cd;
            (param[31] = new OracleParameter("p_givh_brnch_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_brnch_cd;
            (param[32] = new OracleParameter("p_givh_cheque_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.Givh_cheque_no;
            (param[33] = new OracleParameter("p_givh_printname", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_printname;
            (param[34] = new OracleParameter("P_givh_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_Note;
            param[35] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("SP_UPDATE_VOU_HDR", CommandType.StoredProcedure, param);

            return result;
        }

        public int UpdateChequeVoucherDetails(InterVoucherDetails _voucher)
        {
            OracleParameter[] param = new OracleParameter[24];
            (param[0] = new OracleParameter("p_givd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_SEQ;
            (param[1] = new OracleParameter("p_givd_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_LINE;
            (param[2] = new OracleParameter("p_givd_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_VOU_NO;
            (param[3] = new OracleParameter("p_givd_expe_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_CD;
            (param[4] = new OracleParameter("p_givd_expe_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_DESC;
            (param[5] = new OracleParameter("p_givd_expe_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_VAL;
            (param[6] = new OracleParameter("p_givd_expe_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_EXPE_DIRECT;
            (param[7] = new OracleParameter("p_givd_prep_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_PREP_BY;
            (param[8] = new OracleParameter("p_givd_acpt_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ACPT_BY;
            (param[9] = new OracleParameter("p_givd_auth_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_AUTH_BY;
            (param[10] = new OracleParameter("p_givd_anal1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL1;
            (param[11] = new OracleParameter("p_givd_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL2;
            (param[12] = new OracleParameter("p_gvid_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _voucher.GVID_DT;
            (param[13] = new OracleParameter("p_givd_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL3;
            (param[14] = new OracleParameter("p_givd_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL4;
            (param[15] = new OracleParameter("p_givd_anal5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL5;
            (param[16] = new OracleParameter("p_givd_anal6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL6;
            (param[17] = new OracleParameter("p_givd_anal7", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL7;
            (param[18] = new OracleParameter("p_givd_anal8", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL8;
            (param[19] = new OracleParameter("p_givd_anal9", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL9;
            (param[20] = new OracleParameter("p_givd_anal10", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL10;
            (param[21] = new OracleParameter("p_givd_anal11", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL11;
            (param[22] = new OracleParameter("p_givd_anal12", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _voucher.GIVD_ANAL12;
            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("sp_update_vou_det_chq_jnl", CommandType.StoredProcedure, param);
            return result;
        }

        public int InactiveAllVoucherDetails(VoucherHeader _voucher)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_givd_vou_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _voucher.Givh_vou_no;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            //Query Data base.         
            Int32 result = UpdateRecords("SP_INACTIVE_VOU_DET", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 23-09-2014
        public DataTable ValidateVoucherUser(string User, DateTime date)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "SP_VALIDATE_PAYUSER", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        //Tharaka 09-09-2014
        public DataTable GetChqVoucherAccount(string com, DateTime date)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Convert.ToDateTime(date.ToShortDateString()).Date;
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            (param[3] = new OracleParameter("P_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_GET_ACCOUNT_CHQ_VOUCHER", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //shalika 01/10/2014
        public Int32 Process_bank_realization_crcd(string _com, string _pc, DateTime _date, string _accno, Int32 _isall, string _user, DateTime _month, Int32 _week)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_is_all", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isall;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[7] = new OracleParameter("p_week", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _week;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_PRO_CRCD_REALIZATIONS", CommandType.StoredProcedure, param);
            return effects;
        }
        //shalika 01/10/2014
        public DataTable get_crcd_realization_det(string _com, string _pc, DateTime _date, string _accno, string _doctp, Decimal _amtfrom, Decimal _amtto, Int32 _is_real_stus, Int32 _nt_in_state, Int32 _oth_bank, Int32 _withNIS, string MID)
        {
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[5] = new OracleParameter("p_amt_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtfrom;
            (param[6] = new OracleParameter("p_amt_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtto;
            (param[7] = new OracleParameter("p_is_real_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_real_stus;
            (param[8] = new OracleParameter("p_nt_in_state", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _nt_in_state;
            (param[9] = new OracleParameter("p_oth_bnk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _oth_bank;
            (param[10] = new OracleParameter("p_withNIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withNIS;
            (param[11] = new OracleParameter("p_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MID;
            param[12] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_crcd_rls", CommandType.StoredProcedure, false, param);
            return _tblData;


        }
        public Int32 UpdateCRCDRealizationDet(BankRealDet _bnkRls)
        {
            OracleParameter[] param = new OracleParameter[17];

            (param[0] = new OracleParameter("p_BSTD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_com;
            (param[1] = new OracleParameter("p_BSTD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_pc;
            (param[2] = new OracleParameter("p_BSTD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_dt;
            (param[3] = new OracleParameter("p_BSTD_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_accno;
            (param[4] = new OracleParameter("p_BSTD_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_tp;
            (param[5] = new OracleParameter("p_BSTD_DOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_desc;
            (param[6] = new OracleParameter("p_BSTD_DOC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_ref;
            (param[7] = new OracleParameter("p_BSTD_SYS_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_sys_val;
            (param[8] = new OracleParameter("p_BSTD_IS_REALIZED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_realized;
            (param[9] = new OracleParameter("p_BSTD_REALIZED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_realized_dt;
            (param[10] = new OracleParameter("p_BSTD_DOC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_val;
            (param[11] = new OracleParameter("p_BSTD_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_rmk;
            (param[12] = new OracleParameter("p_BANK_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_bnk_val;
            (param[13] = new OracleParameter("p_NET_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_net_val;
            (param[14] = new OracleParameter("p_BSTD_HDN_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_hiddn_ref;
            (param[15] = new OracleParameter("p_bstd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_seq_no;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_crcd_rls", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka 03-10-2014
        public decimal getVoucherTotal(string Voucher)
        {
            decimal total = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Voucher;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_voucher_value", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                total = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }

            return total;
        }
        //shanuka perera 14-10-2014
        public DataTable ProcessSUNUpload_ChequePrnt(DateTime _from, DateTime _to, string _com, string _user, string accNo, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.SP_PROCESS_CHEQUEPRINTING", CommandType.StoredProcedure, false, param);


            return _result;
        }

        //kapila
        public DataTable GetLastRegDetails(string _engine, string _item, string _com, string _inv)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[1] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_inv", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbData", "sp_getlastregdet", CommandType.StoredProcedure, false, param);

            //VehicalRegistration _VehReg = new VehicalRegistration();
            //if (_dtResults.Rows.Count > 0)
            //{
            //    _VehReg = DataTableExtensions.ToGenericList<VehicalRegistration>(_dtResults, VehicalRegistration.Converter)[0];
            //}
            return _dtResults;
        }

        //shanuka perera 16-10-2014
        public DataTable ProcessSUNUpload_Fund(DateTime _from, DateTime _to, string _com, string _user, string accNo, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_accNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.SP_PROCESS_FUND", CommandType.StoredProcedure, false, param);


            return _result;
        }


        //shalika 01/10/2014
        public DataTable chkIsFinalize(string _accno, DateTime date)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_chkIsFinalize", CommandType.StoredProcedure, false, param);
            return _tblData;


        }
        //shanuka perera 16-10-2014
        public DataTable ProcessSUNUpload_Loyalty(DateTime _from, DateTime _to, string _com, string _user, string pc, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "pkg_financial.SP_PROCESS_LOYALTY", CommandType.StoredProcedure, false, param);


            return _result;
        }

        //Tharaka 2014-11-26
        public int UPDATE_VOUCHER_STATUS(string _com, string _vou, Int32 act, Int32 print, string mod_by, DateTime mod_dt)
        {
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = act;
            (param[3] = new OracleParameter("p_print", OracleDbType.Int32, null, ParameterDirection.Input)).Value = print;
            (param[4] = new OracleParameter("p_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mod_by;
            (param[5] = new OracleParameter("p_mod_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = mod_dt;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_VOUCHER_STATUS", CommandType.StoredProcedure, param);

            return result;

        }

        //kapila
        public Int32 UPDATE_VOUCHER_END(string _com, string _vou, DateTime _dt, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_vou", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _vou;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPD_VOU_END", CommandType.StoredProcedure, param);

            return result;

        }

        #region Imports

        public List<MasterBusinessEntity> GetCustomerDetailList(string company, string customerCode, string nic, string mobile, string customerType)
        {
            List<MasterBusinessEntity> _masterBusinessCompany = new List<MasterBusinessEntity>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_busetycode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customerCode;
            (param[2] = new OracleParameter("p_NIC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = nic;
            (param[3] = new OracleParameter("p_mobile", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mobile;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = customerType;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblBusinessCompany = QueryDataTable("tblBusinessCompany", "sp_GetCustomerDetail", CommandType.StoredProcedure, false, param);
            if (_tblBusinessCompany.Rows.Count > 0)
            {
                _masterBusinessCompany = DataTableExtensions.ToGenericList<MasterBusinessEntity>(_tblBusinessCompany, MasterBusinessEntity.Converter);
            }
            return _masterBusinessCompany;
        }
        /*Rukshan*/
        public ImportPIHeader GetPIByPIID(string _PIID)
        {
            ImportPIHeader _PIList = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblUser", "ems.pkg_search_imp.sp_get_pi_by_pi_id", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _PIList = DataTableExtensions.ToGenericList<ImportPIHeader>(_dtResults, ImportPIHeader.Converter)[0];
            }
            return _PIList;
        }
        /*Rukshan*/
        public DataTable GetDPIByPIID(string _PIID)
        {
            DataTable _dtResults = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIID;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tblUser", "ems.pkg_search_imp.SP_GET_PI_BY_PIID", CommandType.StoredProcedure, false, param);


            return _dtResults;
        }
        public DataTable GetSupplierPorts(string p_mspr_com, string p_mspr_cd)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_mspr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_com;
            (param[1] = new OracleParameter("p_mspr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_cd;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("mst_supp_port", "pkg_imports.sp_imp_get_sup_ports", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetSupplierETA(string p_mspr_com, string p_mspr_cd, string p_mspr_frm_port)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mspr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_com;
            (param[1] = new OracleParameter("p_mspr_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_cd;
            (param[2] = new OracleParameter("p_mspr_frm_port", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mspr_frm_port;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("mst_supp_port", "pkg_imports.sp_imp_get_Sup_eta", CommandType.StoredProcedure, false, param);
        }
        /*Rukshan*/
        public MasterAutoNumber GetAutoNumber(string _module, Int32? _direction, string _startChar, string _catType, string _catCode, DateTime? _modifyDate, Int32? _year)
        {
            OracleParameter[] param = new OracleParameter[8];
            MasterAutoNumber _masterAutoNumber = new MasterAutoNumber();

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _module;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _startChar;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catType;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _catCode;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _modifyDate;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblAuto", "sp_autonumber", CommandType.StoredProcedure, false, param);
            //   p_module IN NVARCHAR2,p_direction IN NUMBER,p_startchar IN NVARCHAR2,p_cattype in NVARCHAR2,p_catcode in NVARCHAR2,p_modifydate in DATE,p_year in NUMBER ,c_data out SYS_REFCURSOR
            if (_dtResults.Rows.Count > 0)
            {
                _masterAutoNumber = DataTableExtensions.ToGenericList<MasterAutoNumber>(_dtResults, MasterAutoNumber.ConvertTotal)[0];
            }
            else if (_dtResults.Rows.Count == 0)
            {
                //_masterAutoNumber.Aut_number = 999;//since the auto number not generated, it is hard corded.

                _masterAutoNumber.Aut_cate_cd = _catCode;
                _masterAutoNumber.Aut_cate_tp = _catType;
                _masterAutoNumber.Aut_direction = _direction;
                _masterAutoNumber.Aut_modify_dt = _modifyDate;
                _masterAutoNumber.Aut_moduleid = _module;
                _masterAutoNumber.Aut_number = 1;
                _masterAutoNumber.Aut_start_char = _startChar;
                _masterAutoNumber.Aut_year = _year;
            }


            return _masterAutoNumber;
        }
        /*Rukshan*/
        public Int16 UpdateAutoNumber(MasterAutoNumber _masterAutoNumber)
        {
            int effected = 0;
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_moduleid;
            (param[1] = new OracleParameter("p_direction", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_direction;
            (param[2] = new OracleParameter("p_startchar", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_start_char;
            (param[3] = new OracleParameter("p_cattype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_tp;
            (param[4] = new OracleParameter("p_catcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_cate_cd;
            (param[5] = new OracleParameter("p_modifydate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_modify_dt;
            (param[6] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _masterAutoNumber.Aut_year;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effected = UpdateRecords("sp_updateautonumber", CommandType.StoredProcedure, param);
            return (Int16)effected;
        }
        /*Rukshan*/
        public Tuple<int, int> SaveNewOrderFinancing(Order_Financing _OrderFinancing)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[45];
            (param[0] = new OracleParameter("p_IF_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_doc_no;
            (param[1] = new OracleParameter("p_IF_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_com;
            (param[2] = new OracleParameter("p_IF_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_sbu;
            (param[3] = new OracleParameter("p_IF_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_tp;
            (param[4] = new OracleParameter("p_IF_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_sub_tp;
            (param[5] = new OracleParameter("p_IF_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_ref_no;
            (param[6] = new OracleParameter("p_IF_FILE_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_file_no;
            (param[7] = new OracleParameter("p_IF_OTHDOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_othdoc_no;
            (param[8] = new OracleParameter("p_IF_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_doc_dt;
            (param[9] = new OracleParameter("p_IF_EXP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_exp_dt;
            (param[10] = new OracleParameter("p_IF_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_rmk;
            (param[11] = new OracleParameter("p_IF_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_supp;
            (param[12] = new OracleParameter("p_IF_TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_top_cat;
            (param[13] = new OracleParameter("p_IF_TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_top;
            (param[14] = new OracleParameter("p_IF_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_cur;
            (param[15] = new OracleParameter("p_IF_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_ex_rt;
            (param[16] = new OracleParameter("p_IF_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_tot_amt;
            (param[17] = new OracleParameter("p_IF_TOT_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_tot_amt_deal;
            (param[18] = new OracleParameter("p_IF_SET_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_set_amt_deal;
            (param[19] = new OracleParameter("p_IF_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_bank_cd;
            (param[20] = new OracleParameter("p_IF_BANK_ACC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_bank_acc_no;
            (param[21] = new OracleParameter("p_IF_FAC_LMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_fac_lmt;
            (param[22] = new OracleParameter("p_IF_UTI_LMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_uti_lmt;
            (param[23] = new OracleParameter("p_IF_INSU_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_com;
            (param[24] = new OracleParameter("p_IF_INSU_POLI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_poli_no;
            (param[25] = new OracleParameter("p_IF_INSU_POLI_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_poli_dt;
            (param[26] = new OracleParameter("p_IF_INSU_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_amt;
            (param[27] = new OracleParameter("p_IF_PREM_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_prem_amt;
            (param[28] = new OracleParameter("p_IF_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_stus;
            (param[29] = new OracleParameter("p_IF_SI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.If_si_stus;
            (param[30] = new OracleParameter("p_IP_IS_KIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.Ip_is_kit;
            (param[31] = new OracleParameter("p_IF_AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.If_amd_seq;
            (param[32] = new OracleParameter("p_IF_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_1;
            (param[33] = new OracleParameter("p_IF_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_2;
            (param[34] = new OracleParameter("p_IF_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_3;
            (param[35] = new OracleParameter("p_IF_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_4;
            (param[36] = new OracleParameter("P_IF_CRDT_PD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.If_crdt_pd;
            (param[37] = new OracleParameter("p_IF_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_cre_by;
            (param[38] = new OracleParameter("p_IF_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_cre_dt;
            (param[39] = new OracleParameter("p_IF_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_mod_by;
            (param[40] = new OracleParameter("p_IF_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_mod_dt;
            (param[41] = new OracleParameter("p_IF_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_session_id;
            (param[42] = new OracleParameter("p_IF_LATEST_SH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_latest_sh_dt;
            param[43] = new OracleParameter("o_effect2", OracleDbType.Int32, null, ParameterDirection.Output);
            param[44] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.sp_SaveOrderFinancing", CommandType.StoredProcedure, param);
            string value = param[43].Value.ToString();
            _autoNo = int.Parse(param[43].Value.ToString());
            return new Tuple<int, int>(_eff, _autoNo);
        }
        /*Rukshan*/
        public Int32 UpdateNewOrderFinancing(Order_Financing _OrderFinancing)
        {
            int _eff = 0;
            int _autoNo = 0;
            OracleParameter[] param = new OracleParameter[45];
            (param[0] = new OracleParameter("p_IF_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_doc_no;
            (param[1] = new OracleParameter("p_IF_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_com;
            (param[2] = new OracleParameter("p_IF_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_sbu;
            (param[3] = new OracleParameter("p_IF_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_tp;
            (param[4] = new OracleParameter("p_IF_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_sub_tp;
            (param[5] = new OracleParameter("p_IF_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_ref_no;
            (param[6] = new OracleParameter("p_IF_FILE_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_file_no;
            (param[7] = new OracleParameter("p_IF_OTHDOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_othdoc_no;
            (param[8] = new OracleParameter("p_IF_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_doc_dt;
            (param[9] = new OracleParameter("p_IF_EXP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_exp_dt;
            (param[10] = new OracleParameter("p_IF_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_rmk;
            (param[11] = new OracleParameter("p_IF_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_supp;
            (param[12] = new OracleParameter("p_IF_TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_top_cat;
            (param[13] = new OracleParameter("p_IF_TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_top;
            (param[14] = new OracleParameter("p_IF_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_cur;
            (param[15] = new OracleParameter("p_IF_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_ex_rt;
            (param[16] = new OracleParameter("p_IF_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_tot_amt;
            (param[17] = new OracleParameter("p_IF_TOT_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_tot_amt_deal;
            (param[18] = new OracleParameter("p_IF_SET_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_set_amt_deal;
            (param[19] = new OracleParameter("p_IF_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_bank_cd;
            (param[20] = new OracleParameter("p_IF_BANK_ACC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_bank_acc_no;
            (param[21] = new OracleParameter("p_IF_FAC_LMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_fac_lmt;
            (param[22] = new OracleParameter("p_IF_UTI_LMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_uti_lmt;
            (param[23] = new OracleParameter("p_IF_INSU_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_com;
            (param[24] = new OracleParameter("p_IF_INSU_POLI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_poli_no;
            (param[25] = new OracleParameter("p_IF_INSU_POLI_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_poli_dt;
            (param[26] = new OracleParameter("p_IF_INSU_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_insu_amt;
            (param[27] = new OracleParameter("p_IF_PREM_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _OrderFinancing.If_prem_amt;
            (param[28] = new OracleParameter("p_IF_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_stus;
            (param[29] = new OracleParameter("p_IF_SI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.If_si_stus;
            (param[30] = new OracleParameter("p_IP_IS_KIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.Ip_is_kit;
            (param[31] = new OracleParameter("p_IF_AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.If_amd_seq;
            (param[32] = new OracleParameter("p_IF_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_1;
            (param[33] = new OracleParameter("p_IF_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_2;
            (param[34] = new OracleParameter("p_IF_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_3;
            (param[35] = new OracleParameter("p_IF_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_anal_4;
            (param[36] = new OracleParameter("P_IF_CRDT_PD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _OrderFinancing.If_crdt_pd;
            (param[37] = new OracleParameter("p_IF_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_cre_by;
            (param[38] = new OracleParameter("p_IF_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_cre_dt;
            (param[39] = new OracleParameter("p_IF_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_mod_by;
            (param[40] = new OracleParameter("p_IF_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_mod_dt;
            (param[41] = new OracleParameter("p_IF_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_session_id;
            (param[42] = new OracleParameter("p_IF_LATEST_SH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _OrderFinancing.If_latest_sh_dt;
            param[43] = new OracleParameter("o_effect2", OracleDbType.Int32, null, ParameterDirection.Output);
            param[44] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.sp_SaveOrderFinancing", CommandType.StoredProcedure, param);
            return _eff;
        }
        /*Rukshan*/
        public DataTable GetExchangeRate(string _COM, string _SupplierCur, string _CompanyCur)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _COM;
            (param[1] = new OracleParameter("SCU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SupplierCur;
            (param[2] = new OracleParameter("CCUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CompanyCur;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("mst_supp_port", "pkg_imports.SP_SearchExchangeRate", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetOrderPeriod(string opNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opNo;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_IMP_GET_OrderPeriod", CommandType.StoredProcedure, false, param);
        }
        /*PEMIL 24-Sep-2015*/
        public DataTable GetOrderPeriodALL(string opNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opNo;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_IMP_GET_OrderPeriodALL", CommandType.StoredProcedure, false, param);
        }

        //Rukshan
        public DataTable GetMaxPILineNo(string _Doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_Doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Doc;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("IMP_OP_ITM", "pkg_search_imp.sp_searchMaxPINo", CommandType.StoredProcedure, false, param);
        }
        public Int32 Update_PI_ACtive(PIOrderFinancing _PIData)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_IFP_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_doc_no;
            (param[1] = new OracleParameter("p_IFP_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_no;
            (param[2] = new OracleParameter("p_IFP_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_act;
            (param[3] = new OracleParameter("p_IFP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_line;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_FIN_PI_Inactive", CommandType.StoredProcedure, param);
            return _eff;
        }

        public Int32 Update_FINPAYSTATUS(ImportFINPay _PIData)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_IFY_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_doc_no;
            (param[1] = new OracleParameter("p_IFY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_tp;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_UPDATEFINPAY_STATUS", CommandType.StoredProcedure, param);

            return _eff;
        }

        public Int32 SaveFinPay(ImportFINPay _PIData)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_IFY_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ify_seq_no;
            (param[1] = new OracleParameter("p_IFY_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_doc_no;
            (param[2] = new OracleParameter("p_IFY_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ify_line;
            (param[3] = new OracleParameter("p_IFY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_tp;
            (param[4] = new OracleParameter("p_IFY_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ify_amt;
            (param[5] = new OracleParameter("p_IFY_AMT_DEAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ify_amt_deal;
            (param[6] = new OracleParameter("p_IFY_EX_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ify_ex_rt;
            (param[7] = new OracleParameter("p_IFY_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ify_act;
            (param[8] = new OracleParameter("p_IFY_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_anal_1;
            (param[9] = new OracleParameter("p_IFY_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_anal_2;
            (param[10] = new OracleParameter("p_IFY_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_anal_3;
            (param[11] = new OracleParameter("p_IFY_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_anal_4;
            (param[12] = new OracleParameter("p_IFY_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_anal_5;
            (param[13] = new OracleParameter("p_IFY_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_cre_by;
            (param[14] = new OracleParameter("p_IFY_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ify_cre_dt;
            (param[15] = new OracleParameter("p_IFY_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ify_session_id;

            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.sp_FIN_PAY", CommandType.StoredProcedure, param);

            return _eff;
        }
        public Int32 SavePIFinanc(PIOrderFinancing _PIData)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("p_IFA_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_seq_no;
            (param[1] = new OracleParameter("p_IFP_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_doc_no;
            (param[2] = new OracleParameter("p_IFP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_line;
            (param[3] = new OracleParameter("p_IFP_PI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_seq_no;
            (param[4] = new OracleParameter("p_IFP_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_no;
            (param[5] = new OracleParameter("p_IFP_ACT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_act;
            (param[6] = new OracleParameter("p_IFP_IS_PI_AMD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_is_pi_amd;
            (param[7] = new OracleParameter("p_IFP_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_tot_amt;
            (param[8] = new OracleParameter("p_IFP_TOT_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_tot_amt_deal;
            (param[9] = new OracleParameter("p_IFP_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_ex_rt;
            (param[10] = new OracleParameter("p_IFP_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_anal_1;
            (param[11] = new OracleParameter("p_IFP_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_anal_2;
            (param[12] = new OracleParameter("p_IFP_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_cre_by;
            (param[13] = new OracleParameter("p_IFP_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_cre_dt;
            (param[14] = new OracleParameter("p_IFP_AMD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_amd_by;
            (param[15] = new OracleParameter("p_IFP_AMD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_amd_dt;
            (param[16] = new OracleParameter("p_IFP_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_mod_by;
            (param[17] = new OracleParameter("p_IFP_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_mod_dt;
            (param[18] = new OracleParameter("p_IFP_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_session_id;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_SAVEPINO", CommandType.StoredProcedure, param);

            return _eff;
        }
        public Int32 UpdatePIFinanc(PIOrderFinancing _PIData)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("p_IFA_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_seq_no;
            (param[1] = new OracleParameter("p_IFP_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_doc_no;
            (param[2] = new OracleParameter("p_IFP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_line;
            (param[3] = new OracleParameter("p_IFP_PI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_seq_no;
            (param[4] = new OracleParameter("p_IFP_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_no;
            (param[5] = new OracleParameter("p_IFP_ACT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_act;
            (param[6] = new OracleParameter("p_IFP_IS_PI_AMD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_is_pi_amd;
            (param[7] = new OracleParameter("p_IFP_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_tot_amt;
            (param[8] = new OracleParameter("p_IFP_TOT_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_tot_amt_deal;
            (param[9] = new OracleParameter("p_IFP_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_ex_rt;
            (param[10] = new OracleParameter("p_IFP_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_anal_1;
            (param[11] = new OracleParameter("p_IFP_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_anal_2;
            (param[12] = new OracleParameter("p_IFP_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_cre_by;
            (param[13] = new OracleParameter("p_IFP_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_cre_dt;
            (param[14] = new OracleParameter("p_IFP_AMD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_amd_by;
            (param[15] = new OracleParameter("p_IFP_AMD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_amd_dt;
            (param[16] = new OracleParameter("p_IFP_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_mod_by;
            (param[17] = new OracleParameter("p_IFP_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_mod_dt;
            (param[18] = new OracleParameter("p_IFP_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_session_id;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_SAVEPINO", CommandType.StoredProcedure, param);

            return _eff;
        }
        public Int32 SaveNewAmdPIFinanc(PIOrderFinancing _PIData)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("p_IFA_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_seq_no;
            (param[1] = new OracleParameter("p_IFP_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_doc_no;
            (param[2] = new OracleParameter("p_IFP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_line;
            (param[3] = new OracleParameter("p_IFP_PI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_seq_no;
            (param[4] = new OracleParameter("p_IFP_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_pi_no;
            (param[5] = new OracleParameter("p_IFP_ACT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_act;
            (param[6] = new OracleParameter("p_IFP_IS_PI_AMD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _PIData.Ifp_is_pi_amd;
            (param[7] = new OracleParameter("p_IFP_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_tot_amt;
            (param[8] = new OracleParameter("p_IFP_TOT_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_tot_amt_deal;
            (param[9] = new OracleParameter("p_IFP_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _PIData.Ifp_ex_rt;
            (param[10] = new OracleParameter("p_IFP_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_anal_1;
            (param[11] = new OracleParameter("p_IFP_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_anal_2;
            (param[12] = new OracleParameter("p_IFP_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_cre_by;
            (param[13] = new OracleParameter("p_IFP_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_cre_dt;
            (param[14] = new OracleParameter("p_IFP_AMD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_amd_by;
            (param[15] = new OracleParameter("p_IFP_AMD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_amd_dt;
            (param[16] = new OracleParameter("p_IFP_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_mod_by;
            (param[17] = new OracleParameter("p_IFP_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _PIData.Ifp_mod_dt;
            (param[18] = new OracleParameter("p_IFP_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PIData.Ifp_session_id;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_SAVEAMDPINO", CommandType.StoredProcedure, param);

            return _eff;
        }
        public Int32 SaveFinancAmendment(OrderFinancingAmd _Amendment)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_IFA_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Amendment.Ifa_seq_no;
            (param[1] = new OracleParameter("p_IFA_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_doc_no;
            (param[2] = new OracleParameter("p_IFA_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Amendment.Ifa_line;
            (param[3] = new OracleParameter("p_IFA_AMD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Amendment.Ifa_amd_dt;
            (param[4] = new OracleParameter("p_IFA_AMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Amendment.Ifa_amt;
            (param[5] = new OracleParameter("p_IFA_AMT_DEAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Amendment.Ifa_amt_deal;
            (param[6] = new OracleParameter("p_IFA_EX_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Amendment.Ifa_ex_rt;
            (param[7] = new OracleParameter("p_IFA_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_anal_1;
            (param[8] = new OracleParameter("p_IFA_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_anal_2;
            (param[9] = new OracleParameter("p_IFA_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_anal_3;
            (param[10] = new OracleParameter("p_IFA_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_anal_4;
            (param[11] = new OracleParameter("p_IFA_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_anal_5;
            (param[12] = new OracleParameter("p_IFA_ANAL_6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_anal_6;
            (param[13] = new OracleParameter("p_IFA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_cre_by;
            (param[14] = new OracleParameter("p_IFA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Amendment.Ifa_cre_dt;
            (param[15] = new OracleParameter("p_IFA_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Amendment.Ifa_session_id;
            param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_SAVEAMENDMENT", CommandType.StoredProcedure, param);
            return _eff;
        }
        public Int32 Update_Approval_Cancel(Order_Financing _OrderFinancing)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_IF_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_doc_no;
            (param[1] = new OracleParameter("P_IF_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _OrderFinancing.If_stus;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_FIN_Approve_Cancel", CommandType.StoredProcedure, param);
            return _eff;
        }
        public Int32 Update_Cost_Inactive(OrderFinancingcost _Cost)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_IFC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_doc_no;
            (param[1] = new OracleParameter("p_IFC_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_ele_cd;
            (param[2] = new OracleParameter("p_IFC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Cost.Ifc_act;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = UpdateRecords("pkg_imports.SP_FIN_Cost_Inactive", CommandType.StoredProcedure, param);

            return _eff;

        }

        public Int32 SaveFinancCost(OrderFinancingcost _Cost)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[19];
            (param[0] = new OracleParameter("p_IFC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Cost.Ifc_seq_no;
            (param[1] = new OracleParameter("p_IFC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_doc_no;
            (param[2] = new OracleParameter("p_IFC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Cost.Ifc_line;
            (param[3] = new OracleParameter("p_IFC_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_ele_cat;
            (param[4] = new OracleParameter("p_IFC_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_ele_tp;
            (param[5] = new OracleParameter("p_IFC_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_ele_cd;
            (param[6] = new OracleParameter("p_IFC_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Cost.Ifc_amt;
            (param[7] = new OracleParameter("p_IFC_AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Cost.Ifc_amt_deal;
            (param[8] = new OracleParameter("p_IFC_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Cost.Ifc_ex_rt;
            (param[9] = new OracleParameter("p_IFC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Cost.Ifc_act;
            (param[10] = new OracleParameter("p_IFC_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_anal_1;
            (param[11] = new OracleParameter("p_IFC_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_anal_2;
            (param[12] = new OracleParameter("p_IFC_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_anal_3;
            (param[13] = new OracleParameter("p_IFC_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_anal_4;
            (param[14] = new OracleParameter("p_IFC_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_anal_5;
            (param[15] = new OracleParameter("p_IFC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_cre_by;
            (param[16] = new OracleParameter("p_IFC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Cost.Ifc_cre_dt;
            (param[17] = new OracleParameter("p_IFC_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cost.Ifc_session_id;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_SAVECOST", CommandType.StoredProcedure, param);

            return _eff;
        }
        public DataTable GetOrderItem(string opNo, int year, int month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = opNo;
            (param[1] = new OracleParameter("YY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = year;
            (param[2] = new OracleParameter("MM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = month;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_IMP_GET_OrderItem", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetMaxPILine(string _PNO)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PNO;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("IMP_OP_ITM", "pkg_search_imp.SP_Search_MaxPILine", CommandType.StoredProcedure, false, param);
        }

        public Tuple<int, int> PlaceOrder(OrderPlanHeader orderplan)
        {
            int rows_affected = 0;
            int opderno = 0;
            OracleParameter[] param = new OracleParameter[35];
            try
            {
                (param[0] = new OracleParameter("p_IO_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_OP_NO;
                (param[1] = new OracleParameter("p_IO_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_REF_NO;
                (param[2] = new OracleParameter("p_IO_OP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_OP_DT;
                (param[3] = new OracleParameter("p_IO_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_COM;
                (param[4] = new OracleParameter("p_IO_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SBU;
                (param[5] = new OracleParameter("p_IO_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SUPP;
                (param[6] = new OracleParameter("p_IO_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TP;
                (param[7] = new OracleParameter("p_IO_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_RMK;
                (param[8] = new OracleParameter("p_IO_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_CUR;
                (param[9] = new OracleParameter("p_IO_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_EX_RT;
                (param[10] = new OracleParameter("p_IO_TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOP_CAT;
                (param[11] = new OracleParameter("p_IO_TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOP;
                (param[12] = new OracleParameter("p_IO_TOS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOS;
                (param[13] = new OracleParameter("p_IO_FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_FRM_PORT;
                (param[14] = new OracleParameter("p_IO_TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TO_PORT;
                (param[15] = new OracleParameter("p_IO_ETA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_ETA_DT;
                (param[16] = new OracleParameter("p_IO_IS_KIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_IS_KIT;
                (param[17] = new OracleParameter("p_IO_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_STUS;
                (param[18] = new OracleParameter("p_IO_SEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_SEND;
                (param[19] = new OracleParameter("p_IO_SEND_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_SEND_DT;
                (param[20] = new OracleParameter("p_IO_AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_AMD_SEQ;
                (param[21] = new OracleParameter("p_IO_TOT_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_TOT_QTY;
                (param[22] = new OracleParameter("p_IO_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_TOT_AMT;
                (param[23] = new OracleParameter("p_IO_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_1;
                (param[24] = new OracleParameter("p_IO_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_2;
                (param[25] = new OracleParameter("p_IO_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_3;
                (param[26] = new OracleParameter("p_IO_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_4;
                (param[27] = new OracleParameter("p_IO_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_5;
                (param[28] = new OracleParameter("p_IO_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_CRE_BY;
                (param[29] = new OracleParameter("p_IO_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_CRE_DT;
                (param[30] = new OracleParameter("p_IO_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_MOD_BY;
                (param[31] = new OracleParameter("p_IO_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_MOD_DT;
                (param[32] = new OracleParameter("p_IO_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SESSION_ID;
                param[33] = new OracleParameter("o_auto", OracleDbType.Int32, null, ParameterDirection.Output);
                param[34] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_affected = UpdateRecords("pkg_imports.sp_place_order_plan", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            string value = param[33].Value.ToString();
            opderno = int.Parse(param[33].Value.ToString());
            return new Tuple<int, int>(rows_affected, opderno);
        }

        public Int32 SaveOPItems(OrderPlanItem orderplanItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[35];
            try
            {
                (param[0] = new OracleParameter("p_IOI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_SEQ_NO;
                (param[1] = new OracleParameter("p_IOI_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_OP_NO;
                (param[2] = new OracleParameter("p_IOI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_LINE;
                (param[3] = new OracleParameter("p_IOI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_REF_LINE;
                (param[4] = new OracleParameter("p_IOI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_F_LINE;
                (param[5] = new OracleParameter("p_IOI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_STUS;
                (param[6] = new OracleParameter("p_IOI_YY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_YY;
                (param[7] = new OracleParameter("p_IOI_MM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MM;
                (param[8] = new OracleParameter("p_IOI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_CD;
                (param[9] = new OracleParameter("p_IOI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_STUS;
                (param[10] = new OracleParameter("p_IOI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MODEL;
                (param[11] = new OracleParameter("p_IOI_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_BRAND;
                (param[12] = new OracleParameter("p_IOI_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_DESC;
                (param[13] = new OracleParameter("p_IOI_ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_TP;
                (param[14] = new OracleParameter("p_IOI_COLOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_COLOR;
                (param[15] = new OracleParameter("p_IOI_MFC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MFC;
                (param[16] = new OracleParameter("p_IOI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_QTY;
                (param[17] = new OracleParameter("p_IOI_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_BAL_QTY;
                (param[18] = new OracleParameter("p_IOI_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_UOM;
                (param[19] = new OracleParameter("p_IOI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_UNIT_RT;
                (param[20] = new OracleParameter("p_IOI_PI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_PI_QTY;
                (param[21] = new OracleParameter("p_IOI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_KIT_LINE;
                (param[22] = new OracleParameter("p_IOI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_KIT_ITM_CD;
                (param[23] = new OracleParameter("p_IOI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CRE_BY;
                (param[24] = new OracleParameter("p_IOI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CRE_DT;
                (param[25] = new OracleParameter("p_IOI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MOD_BY;
                (param[26] = new OracleParameter("p_IOI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MOD_DT;
                (param[27] = new OracleParameter("p_IOI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_SESSION_ID;
                (param[28] = new OracleParameter("p_tag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_TAG;
                (param[29] = new OracleParameter("p_project_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ProjectName;
                (param[30] = new OracleParameter("p_ioi_trd_agrement", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_Trade_AgreeMent;
                (param[31] = new OracleParameter("p_ioi_itm_tot_cbm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_TOT_CBM;
                (param[32] = new OracleParameter("p_ioi_cont_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CONT_TYPE;
                (param[33] = new OracleParameter("p_ioi_cont_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CONT_QTY;
                param[34] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                //rows_affected = UpdateRecords("pkg_imports.sp_place_order_plan_itms", CommandType.StoredProcedure, param);
                rows_affected = UpdateRecords("sp_save_order_plan_itms", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }


        //Tharaka 2015-07-04
        public Order_Financing GET_IMP_FIN_HDR_BY_DOC(String Com, String DocNum)
        {
            Order_Financing oResult = null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_DOCNUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocNum;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_IMP_FIN_HDR_BY_DOC", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<Order_Financing>(dtTemp, Order_Financing.Converter)[0];
            }

            return oResult;
        }

        public Int32 UpdateOrderHeader(OrderPlanHeader orderplan)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[32];
            try
            {
                (param[0] = new OracleParameter("p_IO_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_OP_NO;
                (param[1] = new OracleParameter("p_IO_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_REF_NO;
                (param[2] = new OracleParameter("p_IO_OP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_OP_DT;
                (param[3] = new OracleParameter("p_IO_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_COM;
                (param[4] = new OracleParameter("p_IO_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SBU;
                (param[5] = new OracleParameter("p_IO_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SUPP;
                (param[6] = new OracleParameter("p_IO_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TP;
                (param[7] = new OracleParameter("p_IO_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_RMK;
                (param[8] = new OracleParameter("p_IO_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_CUR;
                (param[9] = new OracleParameter("p_IO_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_EX_RT;
                (param[10] = new OracleParameter("p_IO_TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOP_CAT;
                (param[11] = new OracleParameter("p_IO_TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOP;
                (param[12] = new OracleParameter("p_IO_TOS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOS;
                (param[13] = new OracleParameter("p_IO_FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_FRM_PORT;
                (param[14] = new OracleParameter("p_IO_TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TO_PORT;
                (param[15] = new OracleParameter("p_IO_ETA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_ETA_DT;
                (param[16] = new OracleParameter("p_IO_IS_KIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_IS_KIT;
                (param[17] = new OracleParameter("p_IO_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_STUS;
                (param[18] = new OracleParameter("p_IO_SEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_SEND;
                (param[19] = new OracleParameter("p_IO_SEND_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_SEND_DT;
                (param[20] = new OracleParameter("p_IO_AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_AMD_SEQ;
                (param[21] = new OracleParameter("p_IO_TOT_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_TOT_QTY;
                (param[22] = new OracleParameter("p_IO_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_TOT_AMT;
                (param[23] = new OracleParameter("p_IO_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_1;
                (param[24] = new OracleParameter("p_IO_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_2;
                (param[25] = new OracleParameter("p_IO_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_3;
                (param[26] = new OracleParameter("p_IO_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_4;
                (param[27] = new OracleParameter("p_IO_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_5;
                (param[28] = new OracleParameter("p_IO_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_MOD_BY;
                (param[29] = new OracleParameter("p_IO_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_MOD_DT;
                (param[30] = new OracleParameter("p_IO_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SESSION_ID;
                param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_update_op_hdr", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }
            return rows_affected;
        }

        public Int32 UpdateOPItems(OrderPlanItem orderplanItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[29];
            try
            {
                (param[0] = new OracleParameter("p_IOI_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_OP_NO;
                (param[1] = new OracleParameter("p_IOI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_LINE;
                (param[2] = new OracleParameter("p_IOI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_REF_LINE;
                (param[3] = new OracleParameter("p_IOI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_F_LINE;
                (param[4] = new OracleParameter("p_IOI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_STUS;
                (param[5] = new OracleParameter("p_IOI_YY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_YY;
                (param[6] = new OracleParameter("p_IOI_MM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MM;
                (param[7] = new OracleParameter("p_IOI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_CD;
                (param[8] = new OracleParameter("p_IOI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_STUS;
                (param[9] = new OracleParameter("p_IOI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MODEL;
                (param[10] = new OracleParameter("p_IOI_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_BRAND;
                (param[11] = new OracleParameter("p_IOI_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_DESC;
                (param[12] = new OracleParameter("p_IOI_ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_TP;
                (param[13] = new OracleParameter("p_IOI_COLOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_COLOR;
                (param[14] = new OracleParameter("p_IOI_MFC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MFC;
                (param[15] = new OracleParameter("p_IOI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_QTY;
                (param[16] = new OracleParameter("p_IOI_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_BAL_QTY;
                (param[17] = new OracleParameter("p_IOI_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_UOM;
                (param[18] = new OracleParameter("p_IOI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_UNIT_RT;
                (param[19] = new OracleParameter("p_IOI_PI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_PI_QTY;
                (param[20] = new OracleParameter("p_IOI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_KIT_LINE;
                (param[21] = new OracleParameter("p_IOI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_KIT_ITM_CD;
                (param[22] = new OracleParameter("p_IOI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MOD_BY;
                (param[23] = new OracleParameter("p_IOI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MOD_DT;
                (param[24] = new OracleParameter("p_IOI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_SESSION_ID;
                (param[25] = new OracleParameter("P_IOI_SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_SEQ_NO;
                (param[26] = new OracleParameter("p_ioi_cont_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CONT_TYPE;
                (param[27] = new OracleParameter("p_ioi_cont_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CONT_QTY;
                param[28] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("sp_update_op_itms", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        public Int32 UpdateOPStatus(OrderPlanHeader OpHeader)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[5];
            try
            {
                (param[0] = new OracleParameter("p_IO_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OpHeader.IO_STUS;
                (param[1] = new OracleParameter("P_IO_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OpHeader.IO_OP_NO;
                (param[2] = new OracleParameter("p_IO_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = OpHeader.IO_MOD_BY;
                (param[3] = new OracleParameter("p_IO_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = OpHeader.IO_MOD_DT;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_update_op_status", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        public Int32 SavePIHeader(ImportPIHeader pih)
        {
            OracleParameter[] param = new OracleParameter[37];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pih.IP_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_PI_NO;
            (param[2] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_OP_NO;
            (param[3] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_REF_NO;
            (param[4] = new OracleParameter("DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_PI_DT;
            (param[5] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_COM;
            (param[6] = new OracleParameter("SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_SBU;
            (param[7] = new OracleParameter("SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_SUPP;
            (param[8] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TP;
            (param[9] = new OracleParameter("FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_FRM_PORT;
            (param[10] = new OracleParameter("TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TO_PORT;
            (param[11] = new OracleParameter("RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_RMK;
            (param[12] = new OracleParameter("CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_CUR;
            (param[13] = new OracleParameter("EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pih.IP_EX_RT;
            (param[14] = new OracleParameter("TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TOP_CAT;
            (param[15] = new OracleParameter("TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TOP;
            (param[16] = new OracleParameter("TOS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TOS;
            (param[17] = new OracleParameter("ETA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_ETA_DT;
            (param[18] = new OracleParameter("IS_KIT", OracleDbType.Int16, null, ParameterDirection.Input)).Value = pih.IP_IS_KIT;
            (param[19] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_STUS;
            (param[20] = new OracleParameter("AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pih.IP_AMD_SEQ;
            (param[21] = new OracleParameter("TOT_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pih.IP_TOT_QTY;
            (param[22] = new OracleParameter("TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pih.IP_TOT_AMT;
            (param[23] = new OracleParameter("BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_BANK_CD;
            (param[24] = new OracleParameter("BANK_ACC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_BANK_ACC_NO;
            (param[25] = new OracleParameter("ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_ANAL_1;
            (param[26] = new OracleParameter("ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_ANAL_2;
            (param[27] = new OracleParameter("IMP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_IMP_CAT;
            (param[28] = new OracleParameter("IMP_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_IMP_TP;
            (param[29] = new OracleParameter("IMP_STP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_IMP_STP;
            (param[30] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_CRE_BY;
            (param[31] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_CRE_DT;
            (param[32] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_MOD_BY;
            (param[33] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_MOD_DT;
            (param[34] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_SESSION_ID;
            param[35] = new OracleParameter("O_AUTO", OracleDbType.Int32, null, ParameterDirection.Output);
            param[36] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_SAVE_PI", CommandType.StoredProcedure, param);
            if (result != 1)
                return -1;

            return int.Parse(param[35].Value.ToString());
        }

        public Int32 SaveKitItems(OrderPlanKitItem orderplanKitItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[16];
            try
            {
                (param[0] = new OracleParameter("p_IOK_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_SEQ_NO;
                (param[1] = new OracleParameter("p_IOK_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_OP_NO;
                (param[2] = new OracleParameter("p_IOK_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_LINE;
                (param[3] = new OracleParameter("p_IOK_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_REF_LINE;
                (param[4] = new OracleParameter("p_IOK_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_F_LINE;
                (param[5] = new OracleParameter("p_IOK_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_STUS;
                (param[6] = new OracleParameter("p_IOK_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_ITM_CD;
                (param[7] = new OracleParameter("p_IOK_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_ITM_STUS;
                (param[8] = new OracleParameter("p_IOK_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_QTY;
                (param[9] = new OracleParameter("p_IOK_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_BAL_QTY;
                (param[10] = new OracleParameter("p_IOK_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_UOM;
                (param[11] = new OracleParameter("p_IOK_UNIT_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_UNIT_RT;
                (param[12] = new OracleParameter("p_IOK_PI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_PI_QTY;
                (param[13] = new OracleParameter("p_IOK_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_CRE_BY;
                (param[14] = new OracleParameter("p_IOK_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_CRE_DT;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_save_kit_items", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        public Int32 SavePIIDetails(ImportPIDetails pid)
        {
            OracleParameter[] param = new OracleParameter[28];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_PI_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_LINE;
            (param[3] = new OracleParameter("REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_REF_LINE;
            (param[4] = new OracleParameter("F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_F_LINE;
            (param[5] = new OracleParameter("OP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_OP_LINE;
            (param[6] = new OracleParameter("STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_STUS;
            (param[7] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_ITM_CD;
            (param[8] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_ITM_STUS;
            (param[9] = new OracleParameter("MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_MODEL;
            (param[10] = new OracleParameter("BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_BRAND;
            (param[11] = new OracleParameter("DESCR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_DESC;
            (param[12] = new OracleParameter("ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_ITM_TP;
            (param[13] = new OracleParameter("COLOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_COLOR;
            (param[14] = new OracleParameter("MFC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_MFC;
            (param[15] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_QTY;
            (param[16] = new OracleParameter("BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_BAL_QTY;
            (param[17] = new OracleParameter("UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_UOM;
            (param[18] = new OracleParameter("UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_UNIT_RT;
            (param[19] = new OracleParameter("SI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_SI_QTY;
            (param[20] = new OracleParameter("KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_KIT_LINE;
            (param[21] = new OracleParameter("KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_KIT_ITM_CD;
            (param[22] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_CRE_BY;
            (param[23] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pid.IPI_CRE_DT;
            (param[24] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_MOD_BY;
            (param[25] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pid.IPI_MOD_DT;
            (param[26] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_SESSION_ID;
            param[27] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_SAVE_PIITEM", CommandType.StoredProcedure, param);
            return result;
        }

        public DataTable GetItemLines(string p_ioi_op_no, Int32 p_ioi_seq_no, Int32 p_ioi_line)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ioi_op_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ioi_op_no;
            (param[1] = new OracleParameter("p_ioi_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ioi_seq_no;
            (param[2] = new OracleParameter("p_ioi_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ioi_line;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("imp_op_itm", "pkg_search_imp.SP_Search_Itms_Lines", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetItemRowCount(string p_ioi_op_no, Int32 p_ioi_seq_no)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ioi_op_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_ioi_op_no;
            (param[1] = new OracleParameter("p_ioi_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ioi_seq_no;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("imp_op_itm", "pkg_search_imp.SP_Search_Row_Count", CommandType.StoredProcedure, false, param);
        }

        public ImportPIHeader GET_IMP_PI(String pi)
        {
            ImportPIHeader pih = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pi;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("IMP_PI_HDR", "pkg_imports.SP_IMP_GET_PI", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                pih = DataTableExtensions.ToGenericList<ImportPIHeader>(dt, ImportPIHeader.Converter)[0];
            }
            return pih;
        }

        public List<ImportPIDetails> GET_IMP_PIITEM(String pi)
        {
            List<ImportPIDetails> pid = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pi;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("IMP_PI_ITM", "pkg_imports.SP_IMP_GET_PIITEM", CommandType.StoredProcedure, false, param);

            pid = DataTableExtensions.ToGenericList<ImportPIDetails>(dt, ImportPIDetails.Converter2);

            return pid;
        }
        //rukshan
        public List<ImportPIKit> GET_IMP_PIKITITEM(String pi)
        {
            List<ImportPIKit> pid = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pi;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("IMP_PI_ITM", "pkg_imports.SP_IMP_GET_PIKITITEM", CommandType.StoredProcedure, false, param);

            pid = DataTableExtensions.ToGenericList<ImportPIKit>(dt, ImportPIKit.Converter);

            return pid;
        }

        public Int32 UpdatePIHeader(ImportPIHeader pih)
        {
            OracleParameter[] param = new OracleParameter[36];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pih.IP_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_PI_NO;
            (param[2] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_OP_NO;
            (param[3] = new OracleParameter("REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_REF_NO;
            (param[4] = new OracleParameter("DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_PI_DT;
            (param[5] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_COM;
            (param[6] = new OracleParameter("SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_SBU;
            (param[7] = new OracleParameter("SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_SUPP;
            (param[8] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TP;
            (param[9] = new OracleParameter("FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_FRM_PORT;
            (param[10] = new OracleParameter("TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TO_PORT;
            (param[11] = new OracleParameter("RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_RMK;
            (param[12] = new OracleParameter("CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_CUR;
            (param[13] = new OracleParameter("EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pih.IP_EX_RT;
            (param[14] = new OracleParameter("TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TOP_CAT;
            (param[15] = new OracleParameter("TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TOP;
            (param[16] = new OracleParameter("TOS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_TOS;
            (param[17] = new OracleParameter("ETA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_ETA_DT;
            (param[18] = new OracleParameter("IS_KIT", OracleDbType.Int16, null, ParameterDirection.Input)).Value = pih.IP_IS_KIT;
            (param[19] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_STUS;
            (param[20] = new OracleParameter("AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pih.IP_AMD_SEQ;
            (param[21] = new OracleParameter("TOT_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pih.IP_TOT_QTY;
            (param[22] = new OracleParameter("TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pih.IP_TOT_AMT;
            (param[23] = new OracleParameter("BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_BANK_CD;
            (param[24] = new OracleParameter("BANK_ACC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_BANK_ACC_NO;
            (param[25] = new OracleParameter("ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_ANAL_1;
            (param[26] = new OracleParameter("ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_ANAL_2;
            (param[27] = new OracleParameter("IMP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_IMP_CAT;
            (param[28] = new OracleParameter("IMP_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_IMP_TP;
            (param[29] = new OracleParameter("IMP_STP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_IMP_STP;
            (param[30] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_CRE_BY;
            (param[31] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_CRE_DT;
            (param[32] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_MOD_BY;
            (param[33] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pih.IP_MOD_DT;
            (param[34] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pih.IP_SESSION_ID;
            param[35] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATE_PI", CommandType.StoredProcedure, param);
            if (result != 1)
                return -1;

            return result;
        }

        public Int32 UpdatePIIDetails(ImportPIDetails pid)
        {
            OracleParameter[] param = new OracleParameter[28];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_PI_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_LINE;
            (param[3] = new OracleParameter("REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_REF_LINE;
            (param[4] = new OracleParameter("F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_F_LINE;
            (param[5] = new OracleParameter("OP_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_OP_LINE;
            (param[6] = new OracleParameter("STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_STUS;
            (param[7] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_ITM_CD;
            (param[8] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_ITM_STUS;
            (param[9] = new OracleParameter("MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_MODEL;
            (param[10] = new OracleParameter("BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_BRAND;
            (param[11] = new OracleParameter("DESCR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_DESC;
            (param[12] = new OracleParameter("ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_ITM_TP;
            (param[13] = new OracleParameter("COLOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_COLOR;
            (param[14] = new OracleParameter("MFC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_MFC;
            (param[15] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_QTY;
            (param[16] = new OracleParameter("BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_BAL_QTY;
            (param[17] = new OracleParameter("UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_UOM;
            (param[18] = new OracleParameter("UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_UNIT_RT;
            (param[19] = new OracleParameter("SI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pid.IPI_SI_QTY;
            (param[20] = new OracleParameter("KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pid.IPI_KIT_LINE;
            (param[21] = new OracleParameter("KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_KIT_ITM_CD;
            (param[22] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_CRE_BY;
            (param[23] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pid.IPI_CRE_DT;
            (param[24] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_MOD_BY;
            (param[25] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pid.IPI_MOD_DT;
            (param[26] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pid.IPI_SESSION_ID;
            param[27] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATE_PIITEM", CommandType.StoredProcedure, param);
            return result;
        }

        public DataTable ChkItem(string cd)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("CD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = cd;
            param[1] = new OracleParameter("C_DATA", OracleDbType.Int32, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("MST_ITM", "pkg_imports.SP_IMP_CHK_ITEM", CommandType.StoredProcedure, false, param);
            return dt;
        }

        public DataTable GetKitItem(string cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("imp_op_itm", "pkg_imports.SP_IMP_GET_KITITEM", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public DataTable GetItemDetails(string cd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("imp_op_itm", "pkg_imports.SP_IMP_GET_ITEMDETAILS", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public Int32 SavePIKit(ImportPIKit pikit)
        {
            OracleParameter[] param = new OracleParameter[20];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pikit.IPK_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_PI_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_LINE;
            (param[3] = new OracleParameter("REF_LINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_REF_LINE;
            (param[4] = new OracleParameter("F_LINE", OracleDbType.Date, null, ParameterDirection.Input)).Value = pikit.IPK_F_LINE;
            (param[5] = new OracleParameter("OP_LINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_OP_LINE;
            (param[6] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_STUS;
            (param[7] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_ITM_CD;
            (param[8] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_ITM_STUS;
            (param[9] = new OracleParameter("QTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_QTY;
            (param[10] = new OracleParameter("BAL_QTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_BAL_QTY;
            (param[11] = new OracleParameter("UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_UOM;
            (param[12] = new OracleParameter("UNIT_RT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_UNIT_RT;
            (param[13] = new OracleParameter("SI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pikit.IPK_SI_QTY;
            (param[14] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_CRE_BY;
            (param[15] = new OracleParameter("CRE_DT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_CRE_DT;
            (param[16] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_MOD_BY;
            (param[17] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pikit.IPK_MOD_DT;
            param[18] = new OracleParameter("O_LINE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[19] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_SAVE_PIKIT", CommandType.StoredProcedure, param);

            if (result != 1)
                return -1;

            return int.Parse(param[18].Value.ToString());
        }

        public Int32 UpdatePIKit(ImportPIKit pikit)
        {
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pikit.IPK_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_PI_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_LINE;
            (param[3] = new OracleParameter("REF_LINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_REF_LINE;
            (param[4] = new OracleParameter("F_LINE", OracleDbType.Date, null, ParameterDirection.Input)).Value = pikit.IPK_F_LINE;
            (param[5] = new OracleParameter("OP_LINE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_OP_LINE;
            (param[6] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_STUS;
            (param[7] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_ITM_CD;
            (param[8] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_ITM_STUS;
            (param[9] = new OracleParameter("QTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_QTY;
            (param[10] = new OracleParameter("BAL_QTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_BAL_QTY;
            (param[11] = new OracleParameter("UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_UOM;
            (param[12] = new OracleParameter("UNIT_RT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_UNIT_RT;
            (param[13] = new OracleParameter("SI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pikit.IPK_SI_QTY;
            (param[14] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_CRE_BY;
            (param[15] = new OracleParameter("CRE_DT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_CRE_DT;
            (param[16] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pikit.IPK_MOD_BY;
            (param[17] = new OracleParameter("MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pikit.IPK_MOD_DT;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATE_PIKIT", CommandType.StoredProcedure, param);

            return result;
        }

        //Tharaka 2015-07-07
        public List<PIOrderFinancing> GET_IMP_FIN_PI_BY_DOC(String DocNum)
        {
            List<PIOrderFinancing> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocNum;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_IMP_FIN_PI_BY_DOC", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<PIOrderFinancing>(dtTemp, PIOrderFinancing.Converter);
            }
            return oResult;
        }

        //Tharaka 2015-07-07
        public List<ImportPIDetails> GET_IMP_PI_ITM_BY_PINO(String DocNum, Int32 seq)
        {
            List<ImportPIDetails> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("P_PI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocNum;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_IMP_PI_ITM_BY_PINO", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportPIDetails>(dtTemp, ImportPIDetails.Converter1);
            }
            return oResult;
        }

        public DataTable GetCost(string com, string cat, string tp)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            (param[2] = new OracleParameter("ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tp;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("mst_cost_ele", "pkg_imports.SP_IMP_GET_COST", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public Int32 UpdateKitItems(OrderPlanKitItem orderplanKitItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[16];
            try
            {
                (param[0] = new OracleParameter("p_IOK_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_SEQ_NO;
                (param[1] = new OracleParameter("p_IOK_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_OP_NO;
                (param[2] = new OracleParameter("p_IOK_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_LINE;
                (param[3] = new OracleParameter("p_IOK_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_REF_LINE;
                (param[4] = new OracleParameter("p_IOK_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_F_LINE;
                (param[5] = new OracleParameter("p_IOK_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_STUS;
                (param[6] = new OracleParameter("p_IOK_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_ITM_CD;
                (param[7] = new OracleParameter("p_IOK_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_ITM_STUS;
                (param[8] = new OracleParameter("p_IOK_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_QTY;
                (param[9] = new OracleParameter("p_IOK_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_BAL_QTY;
                (param[10] = new OracleParameter("p_IOK_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_UOM;
                (param[11] = new OracleParameter("p_IOK_UNIT_RT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_UNIT_RT;
                (param[12] = new OracleParameter("p_IOK_PI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_PI_QTY;
                (param[13] = new OracleParameter("p_IOK_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_MOD_DT;
                (param[14] = new OracleParameter("p_IOK_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanKitItem.IOK_CRE_DT;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_update_kit_items", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }


        //Master Data 
        public Int32 SaveCostCatergoryMaster(ImportCostCatergoryMaster _ImportCostCatergoryMaster)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_MCA_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_cd;
            (param[1] = new OracleParameter("p_MCA_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_desc;
            (param[2] = new OracleParameter("p_MCA_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_act;
            (param[3] = new OracleParameter("p_MCA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_cre_by;
            (param[4] = new OracleParameter("p_MCA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_cre_dt;
            (param[5] = new OracleParameter("p_MCA_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_mod_by;
            (param[6] = new OracleParameter("p_MCA_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_mod_dt;
            (param[7] = new OracleParameter("MCA_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostCatergoryMaster.Mca_session_id;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_COSTCATERGORY_MASTER", CommandType.StoredProcedure, param);

            return _eff;
        }

        //Tharaka 2015-07-10
        public List<MST_CONTAINER_TP> GET_CONTAINER_TYPES()
        {
            List<MST_CONTAINER_TP> oResult = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_CONTAINER_TYPES", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<MST_CONTAINER_TP>(dtTemp, MST_CONTAINER_TP.Converter);
            }
            return oResult;
        }

        //Tharaka 2015-07-10
        public List<MST_COST_ELE> GET_COST_ELE(String Com, String Type)
        {
            List<MST_COST_ELE> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_COST_ELE", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<MST_COST_ELE>(dtTemp, MST_COST_ELE.Converter);
            }
            return oResult;
        }

        //Tharaka 2015-07-12
        public Int32 GetImportsBLSeq()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            param[0] = new OracleParameter("o_serialid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_imports.SP_GETIMPSEQ", CommandType.StoredProcedure, param);
            return effects;
        }

        //Tharaka 2015-07-13
        public int SaveBLHeader(ImportsBLHeader oHeader, out Int32 Seq)
        {
            Seq = -1;
            OracleParameter[] param = new OracleParameter[56];
            (param[0] = new OracleParameter("p_IB_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.Ib_seq_no;
            (param[1] = new OracleParameter("p_IB_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_com;
            (param[2] = new OracleParameter("p_IB_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_sbu;
            (param[3] = new OracleParameter("p_IB_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_doc_no;
            (param[4] = new OracleParameter("p_IB_BL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_bl_no;
            (param[5] = new OracleParameter("p_IB_BL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_bl_dt;
            (param[6] = new OracleParameter("p_IB_CLEAR_PTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (oHeader.Ib_clear_pty == true) ? 1 : 0;
            (param[7] = new OracleParameter("p_IB_IS_CUSDEC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.Ib_is_cusdec;
            (param[8] = new OracleParameter("p_IB_TOT_FOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (oHeader.Ib_tot_foc == true) ? 1 : 0;
            (param[9] = new OracleParameter("p_IB_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_ref_no;
            (param[10] = new OracleParameter("p_IB_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_rmk;
            (param[11] = new OracleParameter("p_IB_MBL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_mbl_no;
            (param[12] = new OracleParameter("p_IB_SUPP_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_supp_tp;
            (param[13] = new OracleParameter("p_IB_SUPP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_supp_cd;
            (param[14] = new OracleParameter("p_IB_CONSI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_consi_cd;
            (param[15] = new OracleParameter("p_IB_DECL_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_decl_cd;
            (param[16] = new OracleParameter("p_IB_AGENT_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_agent_tp;
            (param[17] = new OracleParameter("p_IB_AGENT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_agent_cd;
            (param[18] = new OracleParameter("p_IB_EXPO_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_expo_cnty;
            (param[19] = new OracleParameter("p_IB_ORIGIN_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_origin_cnty;
            (param[20] = new OracleParameter("p_IB_DESTI_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_desti_cnty;
            (param[21] = new OracleParameter("p_IB_TOT_PKG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_tot_pkg;
            (param[22] = new OracleParameter("p_IB_PACK_LST_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_pack_lst_no;
            (param[23] = new OracleParameter("p_IB_VESSEL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_vessel_no;
            (param[24] = new OracleParameter("p_IB_VOYAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_voyage;
            (param[25] = new OracleParameter("p_IB_LOADING_PLACE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_loading_place;
            (param[26] = new OracleParameter("p_IB_FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_frm_port;
            (param[27] = new OracleParameter("p_IB_TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_to_port;
            (param[28] = new OracleParameter("p_IB_ETD", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_etd;
            (param[29] = new OracleParameter("p_IB_ETA", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_eta;
            (param[30] = new OracleParameter("p_IB_CUR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_cur_cd;
            (param[31] = new OracleParameter("p_IB_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oHeader.Ib_ex_rt;
            (param[32] = new OracleParameter("p_IB_TOT_BL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oHeader.Ib_tot_bl_amt;
            (param[33] = new OracleParameter("p_IB_LOC_OF_GOODS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_loc_of_goods;
            (param[34] = new OracleParameter("p_IB_DOC_CLEAR_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_doc_clear_dt;
            (param[35] = new OracleParameter("p_IB_DOC_REC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_doc_rec_dt;
            (param[36] = new OracleParameter("p_IB_IGNORE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.Ib_ignore;
            (param[37] = new OracleParameter("p_IB_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_anal_1;
            (param[38] = new OracleParameter("p_IB_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_anal_2;
            (param[39] = new OracleParameter("p_IB_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_anal_3;
            (param[40] = new OracleParameter("p_IB_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_anal_4;
            (param[41] = new OracleParameter("P_IB_ENTRY_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_entry_no;
            (param[42] = new OracleParameter("p_IB_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_stus;
            (param[43] = new OracleParameter("p_IB_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_cre_by;
            (param[44] = new OracleParameter("p_IB_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_cre_dt;
            (param[45] = new OracleParameter("p_IB_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_mod_by;
            (param[46] = new OracleParameter("p_IB_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.Ib_mod_dt;
            (param[47] = new OracleParameter("p_IB_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_session_id;
            (param[48] = new OracleParameter("P_ib_bl_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_bl_ref_no;
            (param[49] = new OracleParameter("P_ib_tos", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_tos;
            (param[50] = new OracleParameter("P_ib_carry_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oHeader.Ib_carry_tp;
            (param[51] = new OracleParameter("p_Ib_si_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.Ib_si_seq_no;
            (param[52] = new OracleParameter("P_Ib_standard_lead", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oHeader.Ib_standard_lead;
            (param[53] = new OracleParameter("P_IB_CREDALOW_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oHeader.IB_CREDALOW_DT;
            param[54] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[55] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_HEADER", CommandType.StoredProcedure, param);
            // Int32 result = UpdateRecords("sp_temp_svbl_hdr", CommandType.StoredProcedure, param);
            if (result > 0)
            {
                Seq = Convert.ToInt32(param[54].Value.ToString());
            }
            return result;
        }

        //Tharaka 2015-07-13
        public int SaveBLItems(ImportsBLItems oItems)
        {
            OracleParameter[] param = new OracleParameter[32];
            (param[0] = new OracleParameter("P_IBI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_seq_no;
            (param[1] = new OracleParameter("P_IBI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_line;
            (param[2] = new OracleParameter("P_IBI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_doc_no;
            (param[3] = new OracleParameter("P_IBI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_ref_line;
            (param[4] = new OracleParameter("P_IBI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_f_line;
            (param[5] = new OracleParameter("P_IBI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_stus;
            (param[6] = new OracleParameter("P_IBI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_itm_cd;
            (param[7] = new OracleParameter("P_IBI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_itm_stus;
            (param[8] = new OracleParameter("P_IBI_HS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_hs_cd;
            (param[9] = new OracleParameter("P_IBI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_model;
            (param[10] = new OracleParameter("P_IBI_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_tp;
            (param[11] = new OracleParameter("P_IBI_TAG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_tag;
            (param[12] = new OracleParameter("P_IBI_PI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_unit_rt;
            (param[13] = new OracleParameter("P_IBI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_unit_rt;
            (param[14] = new OracleParameter("P_IBI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_qty;
            (param[15] = new OracleParameter("P_IBI_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_bal_qty;
            (param[16] = new OracleParameter("P_IBI_FIN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_fin_no;
            (param[17] = new OracleParameter("P_IBI_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_no;
            (param[18] = new OracleParameter("P_IBI_PI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_line;
            (param[19] = new OracleParameter("P_IBI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_kit_line;
            (param[20] = new OracleParameter("P_IBI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_kit_itm_cd;
            (param[21] = new OracleParameter("P_IBI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_1;
            (param[22] = new OracleParameter("P_IBI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_2;
            (param[23] = new OracleParameter("P_IBI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_3;
            (param[24] = new OracleParameter("P_IBI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_4;
            (param[25] = new OracleParameter("P_IBI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_5;
            (param[26] = new OracleParameter("P_IBI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_cre_by;
            (param[27] = new OracleParameter("P_IBI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibi_cre_dt;
            (param[28] = new OracleParameter("P_IBI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_mod_by;
            (param[29] = new OracleParameter("P_IBI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibi_mod_dt;
            (param[30] = new OracleParameter("P_IBI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_session_id;
            param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_ITMS", CommandType.StoredProcedure, param);
            //  Int32 result = UpdateRecords("SP_TEMP_BL_ITM_SAVE", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-13
        public ImportsBLHeader GET_BL_HEADER_BY_DOC(String Com, String doc, String stats)
        {
            ImportsBLHeader oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stats;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_BL_HEADER_BY_DOC", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLHeader>(dtTemp, ImportsBLHeader.Converter2)[0];
            }
            return oResult;
        }

        //Tharaka 2015-07-13
        public List<ImportsBLItems> GET_BL_ITMS_BY_SEQ(Int32 Seq)
        {
            List<ImportsBLItems> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_BL_ITMS_BY_SEQ", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLItems>(dtTemp, ImportsBLItems.Converter5);
            }
            return oResult;
        }
        public DataTable GetCostCatergoryMaster(string _searchCatergory, string _searchText)
        {
            string _CODE = null;
            string _DESCRIPTION = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        _DESCRIPTION = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _CODE = (_CODE != null) ? (_CODE + "%") : null;
            _DESCRIPTION = (_DESCRIPTION != null) ? (_DESCRIPTION + "%") : null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CODE;
            (param[1] = new OracleParameter("P_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DESCRIPTION;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblCostCatergory", "pkg_search_imp.SP_Search_CostCatergoryMaster", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public DataTable GetCostCMasterBYID(string CODE)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblCostCatergory", "pkg_search_imp.SP_Search_CostCMasterByID", CommandType.StoredProcedure, false, param);

            return dt;
        }
        public Int32 SaveCostSegmentMaster(ImportCostSegmentMaster _ImportCostSegmentMaster)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_MSSE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_cd;
            (param[1] = new OracleParameter("p_MSSE_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_desc;
            (param[2] = new OracleParameter("p_MSSE_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_act;
            (param[3] = new OracleParameter("p_MSSE_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_cre_by;
            (param[4] = new OracleParameter("p_MSSE_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_cre_dt;
            (param[5] = new OracleParameter("p_MSSE_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_mod_by;
            (param[6] = new OracleParameter("p_MSSE_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_mod_dt;
            (param[7] = new OracleParameter("p_MSSE_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostSegmentMaster.Msse_session_id;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_COSTSEGMENT_MASTER", CommandType.StoredProcedure, param);

            return _eff;
        }
        public DataTable GetCostSegmentMaster(string _searchCatergory, string _searchText)
        {
            string _CODE = null;
            string _DESCRIPTION = null;
            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CODE":
                        _CODE = _searchText;
                        break;

                    case "DESCRIPTION":
                        _DESCRIPTION = _searchText;
                        break;

                    default:
                        break;
                }
            }
            _CODE = (_CODE != null) ? (_CODE + "%") : null;
            _DESCRIPTION = (_DESCRIPTION != null) ? (_DESCRIPTION + "%") : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CODE;
            (param[1] = new OracleParameter("P_DES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DESCRIPTION;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblCostCatergory", "pkg_search_imp.SP_Search_CostSegmentMaster", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public DataTable GetCostSegmentMaster_CODE(string _searchText)
        {

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _searchText;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblCostCatergory", "pkg_search_imp.SP_Search_CostSe_Code", CommandType.StoredProcedure, false, param);

            return dt;
        }


        public Int32 SaveCostTypeMaster(ImportCostType _ImportCostType)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_MCAT_CAT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_cat_cd;
            (param[1] = new OracleParameter("p_MCAT_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_cd;
            // (param[2] = new OracleParameter("p_MCAT_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_desc;
            (param[2] = new OracleParameter("p_MCAT_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_act;
            (param[3] = new OracleParameter("p_MCAT_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_cre_by;
            (param[4] = new OracleParameter("p_MCAT_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_cre_dt;
            (param[5] = new OracleParameter("p_MCAT_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_mod_by;
            (param[6] = new OracleParameter("p_MCAT_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_mod_dt;
            (param[7] = new OracleParameter("MCAT_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImportCostType.Mcat_session_id;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_COSTSTP_MASTER", CommandType.StoredProcedure, param);

            return _eff;
        }

        public DataTable GetCostType_CODE(string _CATCD, string _CD)
        {

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CATCD;
            (param[1] = new OracleParameter("P_CODE2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CD;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblCostCatergory", "pkg_search_imp.SP_Search_CostType_Code", CommandType.StoredProcedure, false, param);

            return dt;
        }

        public DataTable GetCostELEMaster_CODE(string _initialSearchParams)
        {
            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0];
            (param[1] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1];
            (param[2] = new OracleParameter("P_SCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[2];
            param[3] = new OracleParameter("P_SCD", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblCostCatergory", "pkg_search_imp.SP_Search_CostEleMaster", CommandType.StoredProcedure, false, param);

            return dt;
        }

        //Tharaka 2015-07-14
        public int UPDATE_IMPBL_ITMS(ImportsBLItems oItems, out string status)
        {
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("P_IBI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_seq_no;
            (param[1] = new OracleParameter("P_IBI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_line;
            (param[2] = new OracleParameter("P_IBI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_doc_no;
            (param[3] = new OracleParameter("P_IBI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_ref_line;
            (param[4] = new OracleParameter("P_IBI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_f_line;
            (param[5] = new OracleParameter("P_IBI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_stus;
            (param[6] = new OracleParameter("P_IBI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_itm_cd;
            (param[7] = new OracleParameter("P_IBI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_itm_stus;
            (param[8] = new OracleParameter("P_IBI_HS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_hs_cd;
            (param[9] = new OracleParameter("P_IBI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_model;
            (param[10] = new OracleParameter("P_IBI_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_tp;
            (param[11] = new OracleParameter("P_IBI_TAG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.IsNullOrEmpty(oItems.Ibi_tag) ? "N" : oItems.Ibi_tag;
            (param[12] = new OracleParameter("P_IBI_PI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_unit_rt;
            (param[13] = new OracleParameter("P_IBI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_unit_rt;
            (param[14] = new OracleParameter("P_IBI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_qty;
            (param[15] = new OracleParameter("P_IBI_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_bal_qty;
            (param[16] = new OracleParameter("P_IBI_FIN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_fin_no;
            (param[17] = new OracleParameter("P_IBI_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_no;
            (param[18] = new OracleParameter("P_IBI_PI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_line;
            (param[19] = new OracleParameter("P_IBI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_kit_line;
            (param[20] = new OracleParameter("P_IBI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_kit_itm_cd;
            (param[21] = new OracleParameter("P_IBI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_1;
            (param[22] = new OracleParameter("P_IBI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_2;
            (param[23] = new OracleParameter("P_IBI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_3;
            (param[24] = new OracleParameter("P_IBI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_4;
            (param[25] = new OracleParameter("P_IBI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_5;
            (param[26] = new OracleParameter("P_IBI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_cre_by;
            (param[27] = new OracleParameter("P_IBI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibi_cre_dt;
            (param[28] = new OracleParameter("P_IBI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_mod_by;
            (param[29] = new OracleParameter("P_IBI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibi_mod_dt;
            (param[30] = new OracleParameter("P_IBI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_session_id;
            param[31] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[32] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_ITMS", CommandType.StoredProcedure, param);
            //Int32 result = UpdateRecords("SP_UPDATE_IMPBL_ITMS_new", CommandType.StoredProcedure, param);

            status = string.Empty;

            if (result > 0)
            {
                status = param[31].Value.ToString();
            }
            return result;
        }

        //Lakshan 2016-Mar-09
        public int UPDATE_IMPBL_ITMS_NEW(ImportsBLItems oItems, out string status)
        {
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("P_IBI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_seq_no;
            (param[1] = new OracleParameter("P_IBI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_line;
            (param[2] = new OracleParameter("P_IBI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_doc_no;
            (param[3] = new OracleParameter("P_IBI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_ref_line;
            (param[4] = new OracleParameter("P_IBI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_f_line;
            (param[5] = new OracleParameter("P_IBI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_stus;
            (param[6] = new OracleParameter("P_IBI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_itm_cd;
            (param[7] = new OracleParameter("P_IBI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_itm_stus;
            (param[8] = new OracleParameter("P_IBI_HS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_hs_cd;
            (param[9] = new OracleParameter("P_IBI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_model;
            (param[10] = new OracleParameter("P_IBI_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_tp;
            (param[11] = new OracleParameter("P_IBI_TAG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = string.IsNullOrEmpty(oItems.Ibi_tag) ? "N" : oItems.Ibi_tag;
            (param[12] = new OracleParameter("P_IBI_PI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_unit_rt;
            (param[13] = new OracleParameter("P_IBI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_unit_rt;
            (param[14] = new OracleParameter("P_IBI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_qty;
            (param[15] = new OracleParameter("P_IBI_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibi_bal_qty;
            (param[16] = new OracleParameter("P_IBI_FIN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_fin_no;
            (param[17] = new OracleParameter("P_IBI_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_no;
            (param[18] = new OracleParameter("P_IBI_PI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_pi_line;
            (param[19] = new OracleParameter("P_IBI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibi_kit_line;
            (param[20] = new OracleParameter("P_IBI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_kit_itm_cd;
            (param[21] = new OracleParameter("P_IBI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_1;
            (param[22] = new OracleParameter("P_IBI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_2;
            (param[23] = new OracleParameter("P_IBI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_3;
            (param[24] = new OracleParameter("P_IBI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_4;
            (param[25] = new OracleParameter("P_IBI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_anal_5;
            (param[26] = new OracleParameter("P_IBI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_cre_by;
            (param[27] = new OracleParameter("P_IBI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibi_cre_dt;
            (param[28] = new OracleParameter("P_IBI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_mod_by;
            (param[29] = new OracleParameter("P_IBI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibi_mod_dt;
            (param[30] = new OracleParameter("P_IBI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibi_session_id;
            param[31] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[32] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            // Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_ITMS", CommandType.StoredProcedure, param);
            Int32 result = UpdateRecords("SP_UPDATE_IMPBL_ITMS_new", CommandType.StoredProcedure, param);

            status = string.Empty;

            if (result > 0)
            {
                status = param[31].Value.ToString();
            }
            return result;
        }

        //Tharaka 2015-07-14
        public int SAVE_IMP_BL_CONTNR(ImportsBLContainer oItems)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_IBC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibc_seq_no;
            (param[1] = new OracleParameter("P_IBC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibc_line;
            (param[2] = new OracleParameter("P_IBC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_doc_no;
            (param[3] = new OracleParameter("P_IBC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_tp;
            (param[4] = new OracleParameter("P_IBC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_desc;
            (param[5] = new OracleParameter("P_IBC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibc_act;
            (param[6] = new OracleParameter("P_IBC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_cre_by;
            (param[7] = new OracleParameter("P_IBC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibc_cre_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_CONTNR", CommandType.StoredProcedure, param);
            return result;
        }
        public int SAVE_IMP_BL_CONTNRLOG(ImportsBLContainer oItems)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_IBC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibc_seq_no;
            (param[1] = new OracleParameter("P_IBC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibc_line;
            (param[2] = new OracleParameter("P_IBC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_doc_no;
            (param[3] = new OracleParameter("P_IBC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_tp;
            (param[4] = new OracleParameter("P_IBC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_desc;
            (param[5] = new OracleParameter("P_IBC_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibc_act;
            (param[6] = new OracleParameter("P_IBC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibc_cre_by;
            (param[7] = new OracleParameter("P_IBC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibc_cre_dt;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_imp_bl_contnrlognew", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-14
        public List<ImportsBLContainer> GET_IMP_BL_CONTNR_BY_SEQ(Int32 Seq)
        {
            List<ImportsBLContainer> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_IMP_BL_CONTNR_BY_SEQ", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLContainer>(dtTemp, ImportsBLContainer.Converter);
            }
            return oResult;
        }

        //Tharaka 2015-07-14
        public int SAVE_IMP_BL_SI(ImportsBLSInvoice oItems)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_IBS_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibs_seq_no;
            (param[1] = new OracleParameter("P_IBS_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibs_line;
            (param[2] = new OracleParameter("P_IBS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibs_doc_no;
            (param[3] = new OracleParameter("P_IBS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibs_dt;
            (param[4] = new OracleParameter("P_IBS_SI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibs_si_no;
            (param[5] = new OracleParameter("P_IBS_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibs_rmk;
            (param[6] = new OracleParameter("P_IBS_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibs_act;
            (param[7] = new OracleParameter("P_IBS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibs_cre_by;
            (param[8] = new OracleParameter("P_IBS_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibs_cre_dt;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_SI", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-14
        public List<ImportsBLSInvoice> GET_IMP_BL_SI_BY_SEQ(Int32 Seq)
        {
            List<ImportsBLSInvoice> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_IMP_BL_SI_BY_SEQ", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLSInvoice>(dtTemp, ImportsBLSInvoice.Converter);
            }
            return oResult;
        }

        public Int32 SaveCostElement(ImpoertCostElement _ImpoertCostElement)
        {
            int _eff = 0;

            OracleParameter[] param = new OracleParameter[18];

            (param[0] = new OracleParameter("p_MCAE_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_com;
            (param[1] = new OracleParameter("p_MCAE_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_ele_cat;
            (param[2] = new OracleParameter("p_MCAE_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_ele_tp;
            (param[3] = new OracleParameter("p_MCAE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_cd;
            (param[4] = new OracleParameter("p_MCAE_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_anal_1;
            (param[5] = new OracleParameter("p_MCAE_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_anal_2;
            (param[6] = new OracleParameter("p_MCAE_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_anal_3;
            (param[7] = new OracleParameter("p_MCAE_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_anal_4;
            (param[8] = new OracleParameter("p_MCAE_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_anal_5;
            (param[9] = new OracleParameter("p_MCAE_ANAL_6", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_anal_6;
            (param[10] = new OracleParameter("p_MCAE_IS_EDIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_is_edit;
            (param[11] = new OracleParameter("p_MCAE_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_act;
            (param[12] = new OracleParameter("p_MCAE_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_cre_by;
            (param[13] = new OracleParameter("p_MCAE_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_cre_dt;
            (param[14] = new OracleParameter("p_MCAE_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_mod_by;
            (param[15] = new OracleParameter("p_MCAE_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_mod_dt;
            (param[16] = new OracleParameter("p_MCAE_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ImpoertCostElement.Mcae_session_id;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int16)this.UpdateRecords("pkg_imports.SP_SAVECOSTELE", CommandType.StoredProcedure, param);

            return _eff;
        }

        //Tharaka 2015-07-15
        public int SAVE_IMP_BL_COST(ImportsBLCost oItems)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_IBCS_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibcs_seq_no;
            (param[1] = new OracleParameter("P_IBCS_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibcs_line;
            (param[2] = new OracleParameter("P_IBCS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_doc_no;
            (param[3] = new OracleParameter("P_IBCS_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_ele_cat;
            (param[4] = new OracleParameter("P_IBCS_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_ele_tp;
            (param[5] = new OracleParameter("P_IBCS_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_ele_cd;
            (param[6] = new OracleParameter("P_IBCS_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibcs_amt;
            (param[7] = new OracleParameter("P_IBCS_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibcs_act;
            (param[8] = new OracleParameter("P_IBCS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_cre_by;
            (param[9] = new OracleParameter("P_IBCS_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibcs_cre_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_BL_COST", CommandType.StoredProcedure, param);
            return result;
        }
        //Lakshan 2016-03-10
        public int SAVE_IMP_BL_COST_NEW(ImportsBLCost oItems)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_IBCS_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibcs_seq_no;
            (param[1] = new OracleParameter("P_IBCS_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibcs_line;
            (param[2] = new OracleParameter("P_IBCS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_doc_no;
            (param[3] = new OracleParameter("P_IBCS_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_ele_cat;
            (param[4] = new OracleParameter("P_IBCS_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_ele_tp;
            (param[5] = new OracleParameter("P_IBCS_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_ele_cd;
            (param[6] = new OracleParameter("P_IBCS_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ibcs_amt;
            (param[7] = new OracleParameter("P_IBCS_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ibcs_act;
            (param[8] = new OracleParameter("P_IBCS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ibcs_cre_by;
            (param[9] = new OracleParameter("P_IBCS_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ibcs_cre_dt;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_imp_bl_cost_new", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-15
        public List<ImportsBLCost> GET_IMP_BL_COST_BY_SEQ(Int32 Seq)
        {
            List<ImportsBLCost> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.SP_GET_IMP_BL_COST_BY_SEQ", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLCost>(dtTemp, ImportsBLCost.Converter);
            }
            return oResult;
        }

        //Tharaka 2015-07-15
        public int UPDATE_IMP_BL_STUS(String User, String Status, Int32 Seq)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            (param[2] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_UPDATE_IMP_BL_STUS", CommandType.StoredProcedure, param);
            return result;
        }

        public Int32 UpdatePRNStatus(IntReq PRNHeader)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[7];
            try
            {
                (param[0] = new OracleParameter("p_ITR_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRNHeader.ITR_STUS;
                (param[1] = new OracleParameter("P_ITR_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRNHeader.ITR_REQ_NO;
                (param[2] = new OracleParameter("p_ITR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRNHeader.ITR_MOD_BY;
                (param[3] = new OracleParameter("p_ITR_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = PRNHeader.ITR_MOD_DT;
                (param[4] = new OracleParameter("p_ITR_APP_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRNHeader.ITR_APP_BY;
                (param[5] = new OracleParameter("p_ITR_APP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = PRNHeader.ITR_APP_DT;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_update_prn_status", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        public Int32 UpdatePRNBalQty(IntReq PRNHeader, string UpdateType)
        {
            //Wimal @ 07/Jan/2018 to cancel and reset bal qty
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[5];
            try
            {
                (param[0] = new OracleParameter("P_ITR_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRNHeader.ITR_REQ_NO;
                (param[1] = new OracleParameter("p_ITR_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PRNHeader.ITR_MOD_BY;
                (param[2] = new OracleParameter("p_ITR_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = PRNHeader.ITR_MOD_DT;
                (param[3] = new OracleParameter("p_itr_update_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = UpdateType;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                ConnectionOpen();
                rows_affected = UpdateRecords("sp_update_prn_qty", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        public int UpdateStatus_QUO_HDR(String no, String stus, String mod_by, DateTime mod_when)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = no;
            (param[1] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
            (param[2] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mod_by;
            (param[3] = new OracleParameter("MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = mod_when;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATESTATUS_QUO_HDR", CommandType.StoredProcedure, param);
            return result;
        }

        public int Update_QUO_HDR(QuotationHeader qh)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_no;
            (param[1] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_sub_tp;
            (param[2] = new OracleParameter("EX_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = qh.Qh_ex_dt;
            (param[3] = new OracleParameter("REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_ref;
            (param[4] = new OracleParameter("REMARKS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_remarks;
            (param[5] = new OracleParameter("CUR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_cur_cd;
            (param[6] = new OracleParameter("EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = qh.Qh_ex_rt;
            (param[7] = new OracleParameter("STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_stus;
            (param[8] = new OracleParameter("MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_mod_by;
            (param[9] = new OracleParameter("MOD_WHEN", OracleDbType.Date, null, ParameterDirection.Input)).Value = qh.Qh_mod_when;
            (param[10] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = qh.Qh_session_id;
            param[11] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_LP_UPDATE_QUO_HDR", CommandType.StoredProcedure, param);
            return result;
        }

        public Int32 Update_QuotationDET(List<QoutationDetails> det_line_list)
        {
            Int32 count = 0;
            foreach (QoutationDetails line in det_line_list)
            {
                //save to QUO_HDR
                OracleParameter[] param = new OracleParameter[38];
                (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_seq_no;
                (param[1] = new OracleParameter("LINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_line_no;
                (param[2] = new OracleParameter("NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_no;

                (param[3] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_itm_cd;
                (param[4] = new OracleParameter("ITM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_itm_desc;
                (param[5] = new OracleParameter("ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_itm_stus == null ? "1" : line.Qd_itm_stus;


                (param[6] = new OracleParameter("UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_uom == null ? "1" : line.Qd_uom;
                (param[7] = new OracleParameter("QUO_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_quo_tp == null ? "1" : line.Qd_quo_tp;
                (param[8] = new OracleParameter("FRM_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_frm_qty == null ? 1 : line.Qd_frm_qty;
                (param[9] = new OracleParameter("TO_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_to_qty == null ? 1 : line.Qd_to_qty;
                (param[10] = new OracleParameter("UNIT_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_unit_price == null ? 1 : line.Qd_unit_price;
                (param[11] = new OracleParameter("AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_amt == null ? 1 : line.Qd_amt;

                (param[12] = new OracleParameter("DIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_dit_rt == null ? 1 : line.Qd_dit_rt;
                (param[13] = new OracleParameter("DIS_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_dis_amt == null ? 1 : line.Qd_dis_amt;
                (param[14] = new OracleParameter("ITM_TAX", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_itm_tax == null ? 1 : line.Qd_itm_tax;
                (param[15] = new OracleParameter("TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_tot_amt == null ? 1 : line.Qd_tot_amt;
                (param[16] = new OracleParameter("PBOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_pbook;
                (param[17] = new OracleParameter("PB_LVL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_pb_lvl;

                (param[18] = new OracleParameter("PB_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_pb_seq;
                (param[19] = new OracleParameter("PB_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_pb_price == null ? 1 : line.Qd_pb_price;
                (param[20] = new OracleParameter("RES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_res_no;
                (param[21] = new OracleParameter("RESREQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_resreq_no;
                (param[22] = new OracleParameter("RESLINE_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_resline_no == null ? 1 : line.Qd_resline_no;
                if (!string.IsNullOrEmpty(line.Qd_resitm_cd))
                {
                    if (line.Qd_resitm_cd.Length > 20)
                    {
                        line.Qd_resitm_cd = line.Qd_resitm_cd.Substring(0, 20).ToString();
                    }
                }
                (param[23] = new OracleParameter("RESITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_resitm_cd;

                (param[24] = new OracleParameter("RES_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_res_qty;
                (param[25] = new OracleParameter("RESBAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_resbal_qty;
                (param[26] = new OracleParameter("NITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_nitm_cd;
                (param[27] = new OracleParameter("NITM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_nitm_desc;
                (param[28] = new OracleParameter("ISSUE_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_issue_qty;
                (param[29] = new OracleParameter("UNIT_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_unit_cost;


                (param[30] = new OracleParameter("COST_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = line.Qd_cost_amt;
                (param[31] = new OracleParameter("CDOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_cdoc_no;
                (param[32] = new OracleParameter("CITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_citm_line;
                (param[33] = new OracleParameter("CBATCH_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_cbatch_line;
                (param[34] = new OracleParameter("WARR_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = line.Qd_warr_rmk;
                (param[35] = new OracleParameter("WARR_PD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_warr_pd;
                (param[36] = new OracleParameter("PICK_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line.Qd_pick_qty;
                param[37] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int16)UpdateRecords("pkg_imports.SP_LP_UPDATE_QUO_DET", CommandType.StoredProcedure, param);

                if (effects > 0)
                    count++;

            }

            return count;


        }

        //Tharaka 2015-07-16
        public int UPDATE_BAL_QTY_BY_BL(String PiNumber, Int32 PILine, Decimal BalQty, String Session, String User)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_PI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PiNumber;
            (param[1] = new OracleParameter("P_PILINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = PILine;
            (param[2] = new OracleParameter("P_BALQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = BalQty;
            (param[3] = new OracleParameter("P_SESSTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Session;
            (param[4] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_UPDATE_BAL_QTY_BY_BL", CommandType.StoredProcedure, param);
            return result;
        }

        public int UPDATE_OP_PI_QTY(String op_no, String itm_cd, int opLine, decimal qty)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = op_no;
            (param[1] = new OracleParameter("ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm_cd;
            (param[2] = new OracleParameter("OPLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = opLine;
            (param[3] = new OracleParameter("QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = qty;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATE_OP_PI_QTY", CommandType.StoredProcedure, param);
            return result;
        }

        public int UPDATE_OP_IO_STUS(String op_no)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = op_no;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATE_OP_IO_STUS", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-23
        public int SAVE_IMP_CST_HDR(ImportsCostHeader oItems, out Int32 Seq)
        {
            Seq = -1;
            OracleParameter[] param = new OracleParameter[28];
            (param[0] = new OracleParameter("P_ICH_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_seq_no;
            (param[1] = new OracleParameter("P_ICH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_com;
            (param[2] = new OracleParameter("P_ICH_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_tp;
            (param[3] = new OracleParameter("P_ICH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_doc_no;
            (param[4] = new OracleParameter("P_ICH_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_ref_no;
            (param[5] = new OracleParameter("P_ICH_PRE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_pre;
            (param[6] = new OracleParameter("P_ICH_PRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_pre_dt.Date;
            (param[7] = new OracleParameter("P_ICH_PRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_pre_by;
            (param[8] = new OracleParameter("P_ICH_PRE_SYSDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_pre_sysdt;
            (param[9] = new OracleParameter("P_ICH_ACTL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_actl;
            (param[10] = new OracleParameter("P_ICH_ACTL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_actl_dt.Date;
            (param[11] = new OracleParameter("P_ICH_ACTL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_actl_by;
            (param[12] = new OracleParameter("P_ICH_ACTL_SYSDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_actl_sysdt;
            (param[13] = new OracleParameter("P_ICH_FINL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_finl;
            (param[14] = new OracleParameter("P_ICH_FINL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_finl_dt.Date;
            (param[15] = new OracleParameter("P_ICH_FINL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_finl_by;
            (param[16] = new OracleParameter("P_ICH_FINL_SYSDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_finl_sysdt;
            (param[17] = new OracleParameter("P_ICH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_stus;
            (param[18] = new OracleParameter("P_ICH_IS_GRN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_is_grn;
            (param[19] = new OracleParameter("P_ICH_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_cur;
            (param[20] = new OracleParameter("P_ICH_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_1;
            (param[21] = new OracleParameter("P_ICH_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_2;
            (param[22] = new OracleParameter("P_ICH_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_3;
            (param[23] = new OracleParameter("P_ICH_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_4;
            (param[24] = new OracleParameter("P_ICH_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_5;
            (param[25] = new OracleParameter("P_ICH_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ich_ex_rt;
            param[26] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[27] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_CST_HDR", CommandType.StoredProcedure, param);
            if (result > 0) Seq = Convert.ToInt32(param[26].Value.ToString());
            return result;
        }

        //Tharaka 2015-07-23
        public int SAVE_IMP_CST_ITM(ImportsCostItem oItems)
        {
            OracleParameter[] param = new OracleParameter[27];
            (param[0] = new OracleParameter("P_ICI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_seq_no;
            (param[1] = new OracleParameter("P_ICI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_line;
            (param[2] = new OracleParameter("P_ICI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_doc_no;
            (param[3] = new OracleParameter("P_ICI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_ref_line;
            (param[4] = new OracleParameter("P_ICI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_stus;
            (param[5] = new OracleParameter("P_ICI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_cd;
            (param[6] = new OracleParameter("P_ICI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_stus;
            (param[7] = new OracleParameter("P_ICI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_qty;
            (param[8] = new OracleParameter("P_ICI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_rt;
            (param[9] = new OracleParameter("P_ICI_UNIT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_amt;
            (param[10] = new OracleParameter("P_ICI_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_rt;
            (param[11] = new OracleParameter("P_ICI_PRE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_amt;
            (param[12] = new OracleParameter("P_ICI_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_rt;
            (param[13] = new OracleParameter("P_ICI_ACTL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_amt;
            (param[14] = new OracleParameter("P_ICI_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_rt;
            (param[15] = new OracleParameter("P_ICI_FINL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_amt;
            (param[16] = new OracleParameter("P_ICI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_1;
            (param[17] = new OracleParameter("P_ICI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_2;
            (param[18] = new OracleParameter("P_ICI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_3;
            (param[19] = new OracleParameter("P_ICI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_4;
            (param[20] = new OracleParameter("P_ICI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_5;
            (param[21] = new OracleParameter("P_ICI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_cre_by;
            (param[22] = new OracleParameter("P_ICI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_cre_dt;
            (param[23] = new OracleParameter("P_ICI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_mod_by;
            (param[24] = new OracleParameter("P_ICI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_mod_dt;
            (param[25] = new OracleParameter("P_ICI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_session_id;
            param[26] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_IMP_CST_ITM", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-23
        public int UPDATE_IMP_CST_ITM(ImportsCostItem oItems, out String status)
        {
            OracleParameter[] param = new OracleParameter[39];
            (param[10] = new OracleParameter("P_ICI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_seq_no;
            (param[11] = new OracleParameter("P_ICI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_line;
            (param[12] = new OracleParameter("P_ICI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_doc_no;
            (param[13] = new OracleParameter("P_ICI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_ref_line;
            (param[14] = new OracleParameter("P_ICI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_f_line;
            (param[10] = new OracleParameter("P_ICI_BASE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_base_line;
            (param[15] = new OracleParameter("P_ICI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_stus;
            (param[16] = new OracleParameter("P_ICI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_cd;
            (param[17] = new OracleParameter("P_ICI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_stus;
            (param[18] = new OracleParameter("P_ICI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_qty;
            (param[19] = new OracleParameter("P_ICI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_rt;
            (param[20] = new OracleParameter("P_ICI_UNIT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_amt;
            (param[21] = new OracleParameter("P_ICI_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_rt;
            (param[22] = new OracleParameter("P_ICI_PRE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_amt;
            (param[23] = new OracleParameter("P_ICI_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_rt;
            (param[24] = new OracleParameter("P_ICI_ACTL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_amt;
            (param[25] = new OracleParameter("P_ICI_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_rt;
            (param[26] = new OracleParameter("P_ICI_FINL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_amt;
            (param[27] = new OracleParameter("P_ICI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_1;
            (param[28] = new OracleParameter("P_ICI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_2;
            (param[29] = new OracleParameter("P_ICI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_3;
            (param[30] = new OracleParameter("P_ICI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_4;
            (param[31] = new OracleParameter("P_ICI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_5;
            (param[32] = new OracleParameter("P_ICI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_cre_by;
            (param[33] = new OracleParameter("P_ICI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_cre_dt;
            (param[34] = new OracleParameter("P_ICI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_mod_by;
            (param[35] = new OracleParameter("P_ICI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_mod_dt;
            (param[36] = new OracleParameter("P_ICI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_session_id;
            param[37] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[38] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_IMP_CST_ITM", CommandType.StoredProcedure, param);

            status = string.Empty;

            if (result > 0)
            {
                status = param[37].Value.ToString();
            }

            return result;
        }

        //Tharaka 2015-07-23
        public int SAVE_IMP_CST_ELE(ImportsCostElement oItems, out String status)
        {
            OracleParameter[] param = new OracleParameter[23];
            (param[0] = new OracleParameter("P_ICET_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_seq_no;
            (param[1] = new OracleParameter("P_ICET_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_line;
            (param[2] = new OracleParameter("P_ICET_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_doc_no.Trim();
            (param[3] = new OracleParameter("P_ICET_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_stus;
            (param[4] = new OracleParameter("P_ICET_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cat;
            (param[5] = new OracleParameter("P_ICET_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_tp;
            (param[6] = new OracleParameter("P_ICET_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cd;
            (param[7] = new OracleParameter("P_ICET_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_ele_rt;
            (param[8] = new OracleParameter("P_ICET_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_pre_rt;
            (param[9] = new OracleParameter("P_ICET_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_actl_rt;
            (param[10] = new OracleParameter("P_ICET_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_finl_rt;
            (param[11] = new OracleParameter("P_ICET_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_1;
            (param[12] = new OracleParameter("P_ICET_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_2;
            (param[13] = new OracleParameter("P_ICET_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_3;
            (param[14] = new OracleParameter("P_ICET_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_4;
            (param[15] = new OracleParameter("P_ICET_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_5;
            (param[16] = new OracleParameter("P_ICET_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_cre_by;
            (param[17] = new OracleParameter("P_ICET_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_cre_dt;
            (param[18] = new OracleParameter("P_ICET_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_mod_by;
            (param[19] = new OracleParameter("P_ICET_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_mod_dt;
            (param[20] = new OracleParameter("P_ICET_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_session_id;
            param[21] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[22] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_IMP_CST_ELE", CommandType.StoredProcedure, param);
            status = string.Empty;

            if (result > 0)
            {
                status = param[21].Value.ToString();
            }
            return result;
        }

        //Tharaka 2015-07-23
        public int SAVE_IMP_CST_ELE_ITM(ImportsCostElementItem oItems, out String status)
        {
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("P_ICE_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_seq_no;
            (param[1] = new OracleParameter("P_ICE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_line;
            (param[2] = new OracleParameter("P_ICE_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_doc_no;
            (param[3] = new OracleParameter("P_ICE_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_ref_line;
            (param[4] = new OracleParameter("P_ICE_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_stus;
            (param[5] = new OracleParameter("P_ICE_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_itm_cd;
            (param[6] = new OracleParameter("P_ICE_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_itm_stus;
            (param[7] = new OracleParameter("P_ICE_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_cat;
            (param[8] = new OracleParameter("P_ICE_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_tp;
            (param[9] = new OracleParameter("P_ICE_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_cd;
            (param[10] = new OracleParameter("P_ICE_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_ele_rt;
            (param[11] = new OracleParameter("P_ICE_ELE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_ele_amnt;
            (param[12] = new OracleParameter("P_ICE_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_rt;
            (param[13] = new OracleParameter("P_ICE_PRE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_amnt;
            (param[14] = new OracleParameter("P_ICE_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_rt;
            (param[15] = new OracleParameter("P_ICE_ACTL_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_amnt;
            (param[16] = new OracleParameter("P_ICE_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_rt;
            (param[17] = new OracleParameter("P_ICE_FINL_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_amnt;
            (param[18] = new OracleParameter("P_ICE_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_1;
            (param[19] = new OracleParameter("P_ICE_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_2;
            (param[20] = new OracleParameter("P_ICE_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_3;
            (param[21] = new OracleParameter("P_ICE_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_4;
            (param[22] = new OracleParameter("P_ICE_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_5;
            (param[23] = new OracleParameter("P_ICE_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_cre_by;
            (param[24] = new OracleParameter("P_ICE_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ice_cre_dt;
            (param[25] = new OracleParameter("P_ICE_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_mod_by;
            (param[26] = new OracleParameter("P_ICE_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ice_mod_dt;
            (param[27] = new OracleParameter("P_ICE_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_session_id;
            (param[28] = new OracleParameter("P_ICE_PRE_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_amt_claim;
            (param[29] = new OracleParameter("P_ICE_ACTL_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_amt_claim;
            (param[30] = new OracleParameter("P_ICE_FINL_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_amt_claim;
            param[31] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[32] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_IMP_CST_ELE_ITM", CommandType.StoredProcedure, param);
            status = string.Empty;

            if (result > 0)
            {
                status = param[28].Value.ToString();
            }
            return result;
        }

        //Tharaka 2015-07-14
        public ImportsCostHeader GET_IMP_CST_HDR_BY_DOC(String Doc, String Type)
        {
            ImportsCostHeader oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_HDR_BY_DOC", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostHeader>(dtTemp, ImportsCostHeader.Converter)[0];
            }
            return oResult;
        }

        //Tharaka 2015-07-24
        public int INACTIVE_IMP_COST(Int32 Seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_INACTIVE_IMP_COST", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-07-24
        public ImportsBLHeader GET_IMP_BL_BY_BL(String com, String BL)
        {
            ImportsBLHeader oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_BL_BY_BL", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLHeader>(dtTemp, ImportsBLHeader.Converter)[0];
            }
            return oResult;
        }

        //Tharaka 2015-07-27
        public List<ImportsCostHeader> GET_IMP_CST_HDR_FOR_CS(String com, String BL, String Bond, String Status, DateTime From, DateTime To, string bypass)
        {
            List<ImportsCostHeader> oResult = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_BL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            (param[2] = new OracleParameter("P_BOND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Bond;
            (param[3] = new OracleParameter("P_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            (param[4] = new OracleParameter("P_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = From;
            (param[5] = new OracleParameter("P_TO", OracleDbType.Date, null, ParameterDirection.Input)).Value = To;
            (param[6] = new OracleParameter("P_BYPASS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bypass;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_HDR_FOR_CS", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostHeader>(dtTemp, ImportsCostHeader.Converter3);
            }
            return oResult;
        }

        //Tharaka 2015-07-27
        public List<ImportsCostElement> GET_IMP_CST_ELE_BY_DOC(String BL)
        {
            List<ImportsCostElement> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BL;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_ELE_BY_DOC", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostElement>(dtTemp, ImportsCostElement.Converter1);
            }
            return oResult;
        }

        //Tharaka 2015-07-29 
        public List<ImportsCostItem> GET_IMP_CST_ITM_BY_SEQ(Int32 Seq, Int32 Status)
        {
            List<ImportsCostItem> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Status;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_ITM_BY_SEQ", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostItem>(dtTemp, ImportsCostItem.Converter);
            }
            return oResult;
        }

        //Chamal 23-Mar-2016
        public ImportsCostItem GET_IMP_CST_ITM_BY_SI_ITEM(string _siNo, Int32 _lineNo)
        {
            ImportsCostItem oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _siNo;
            (param[1] = new OracleParameter("P_LINENO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMPCSTITMBYSIITEM", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImportsCostItem>(dtTemp, ImportsCostItem.Converter)[0];
            return oResult;
        }

        //Tharaka 2015-07-30
        public List<ImportsCostElementItem> GET_IMP_CST_ELE_ITM_BY_SEQ(Int32 Seq)
        {
            List<ImportsCostElementItem> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_ELE_ITM_BY_SEQ", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostElementItem>(dtTemp, ImportsCostElementItem.Converter);
            }
            return oResult;
        }

        //Chamal 2016-Mar-22
        public List<ImportsCostElementItem> GET_IMP_CST_ELE_ITM_BY_SINO(string sino)
        {
            List<ImportsCostElementItem> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_ELE_ITM_BY_SINO", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostElementItem>(dtTemp, ImportsCostElementItem.Converter);
            }
            return oResult;
        }

        //Tharaka 2015-08-03
        public List<ImportsCostElementItem> GET_IMP_CST_ELE_ITM_BY_ITM(Int32 Seq, String doc, String itemCode)
        {
            List<ImportsCostElementItem> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[2] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_IMP_CST_ELE_ITM_BY_ITM", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostElementItem>(dtTemp, ImportsCostElementItem.Converter2);
            }
            return oResult;
        }

        //Tharaka 2015-08-03
        public int UPDATE_IMP_CST_HDR_STAGE(Int32 Stage, Int32 value, String User, Int32 Seq, String Com, String Doc, DateTime Date)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_STAGE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Stage;
            (param[1] = new OracleParameter("P_VALUE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            (param[2] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            (param[3] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[4] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[5] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[6] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            param[7] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_IMP_CST_HDR_STAGE", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2015-08-04
        public int UPDATE_PUR_HDR_BY_COSTSHEET(Int32 Seq, String Status, String User)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Status;
            (param[2] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_PUR_HDR_BY_COSTSHEET", CommandType.StoredProcedure, param);
            return result;
        }

        public DataTable CheckBusentity(string com, string tp, string sub_tp, string cd)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tp;
            (param[2] = new OracleParameter("SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sub_tp;
            (param[3] = new OracleParameter("CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cd;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("MST_ITM", "pkg_imports.SP_CHECKBUSENTITY", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharaka 2015-08-24
        public DataTable GET_TRADTERMDESC_BY_DOC(String Doc, String ElectCAte)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[1] = new OracleParameter("P_ELECATE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ElectCAte;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("MST_ITM", "SP_GET_TRADTERMDESC_BY_DOC", CommandType.StoredProcedure, false, param);
            return dt;
        }

        //Tharaka 2015-09-02
        public int UPDATE_IMP_CST_ITM_VALUES(Decimal PreRate, Decimal PreAmount, Decimal ACtRate, Decimal ActAmount, Decimal FinRate, Decimal FinAmount, String Doc, String Item, Int32 Seq, Int32 Line, String User, String Session)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_PRE_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = PreRate;
            (param[1] = new OracleParameter("P_PRE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = PreAmount;
            (param[2] = new OracleParameter("P_ACT_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ACtRate;
            (param[3] = new OracleParameter("P_ACT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = ActAmount;
            (param[4] = new OracleParameter("P_FIN_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = FinRate;
            (param[5] = new OracleParameter("P_FIN_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = FinAmount;
            (param[6] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[7] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[8] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[9] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Line;
            (param[10] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = User;
            (param[11] = new OracleParameter("P_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Session;
            param[12] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_IMP_CST_ITM_VALUES", CommandType.StoredProcedure, param);
            return result;
        }

        //PEMIL 24-Sep-2015
        public Int32 Save_PI_COST(IMP_PI_COST pic)
        {
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pic.IPC_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_PI_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pic.IPC_LINE;
            (param[3] = new OracleParameter("ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ELE_CAT;
            (param[4] = new OracleParameter("ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ELE_TP;
            (param[5] = new OracleParameter("ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ELE_CD;
            (param[6] = new OracleParameter("AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pic.IPC_AMT;
            (param[7] = new OracleParameter("AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pic.IPC_AMT_DEAL;
            (param[8] = new OracleParameter("EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pic.IPC_EX_RT;
            (param[9] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pic.IPC_ACT;
            (param[10] = new OracleParameter("ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_1;
            (param[11] = new OracleParameter("ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_2;
            (param[12] = new OracleParameter("ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_4;
            (param[13] = new OracleParameter("ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_4;
            (param[14] = new OracleParameter("ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_5;
            (param[15] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_CRE_BY;
            (param[16] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pic.IPC_CRE_DT;
            (param[17] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_SESSION_ID;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_SAVE_PI_COST", CommandType.StoredProcedure, param);
            return result;
        }

        //PEMIL 24-Sep-2015
        public Int32 Update_PI_COST(IMP_PI_COST pic)
        {
            OracleParameter[] param = new OracleParameter[19];

            (param[0] = new OracleParameter("SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pic.IPC_SEQ_NO;
            (param[1] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_PI_NO;
            (param[2] = new OracleParameter("LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pic.IPC_LINE;
            (param[3] = new OracleParameter("ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ELE_CAT;
            (param[4] = new OracleParameter("ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ELE_TP;
            (param[5] = new OracleParameter("ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ELE_CD;
            (param[6] = new OracleParameter("AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pic.IPC_AMT;
            (param[7] = new OracleParameter("AMT_DEAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pic.IPC_AMT_DEAL;
            (param[8] = new OracleParameter("EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = pic.IPC_EX_RT;
            (param[9] = new OracleParameter("ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pic.IPC_ACT;
            (param[10] = new OracleParameter("ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_1;
            (param[11] = new OracleParameter("ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_2;
            (param[12] = new OracleParameter("ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_4;
            (param[13] = new OracleParameter("ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_4;
            (param[14] = new OracleParameter("ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_ANAL_5;
            (param[15] = new OracleParameter("CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_CRE_BY;
            (param[16] = new OracleParameter("CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = pic.IPC_CRE_DT;
            (param[17] = new OracleParameter("SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pic.IPC_SESSION_ID;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.SP_IMP_UPDATE_PI_COST", CommandType.StoredProcedure, param);
            return result;
        }

        //PEMIL 24-Sep-2015
        public DataTable GET_IMP_PI_COST(String pi)
        {
            List<IMP_PI_COST> pic = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pi;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("IMP_PI_HDR", "pkg_imports.SP_IMP_GET_PI_COST", CommandType.StoredProcedure, false, param);

            //if (dt.Rows.Count > 0)
            //{
            //    pic = DataTableExtensions.ToGenericList<IMP_PI_COST>(dt, IMP_PI_COST.Converter);
            //}
            return dt;
        }

        public int UPDATE_PI_STATUS(string _com, string _PINo, string _status, string mod_by)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _PINo;
            (param[1] = new OracleParameter("PI_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("PI_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (param[3] = new OracleParameter("PI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mod_by;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_UPDATE_PI_STUS", CommandType.StoredProcedure, param);

            return result;

        }

        //Sahan 01/Dec/2015
        public DataTable LoadBondNumbers(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _entryno = null;
            string _othno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT NO":
                        _docno = _searchText;
                        break;

                    case "ENTRY NO":
                        _entryno = _searchText;
                        break;

                    case "OTHER REF":
                        _othno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;
            _entryno = (_entryno != null) ? ("%" + _entryno.ToUpper() + "%") : null;
            _othno = (_othno != null) ? (_othno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cuh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[1].ToString();
            (param[2] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[3] = new OracleParameter("p_cuh_cusdec_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[4] = new OracleParameter("p_cuh_oth_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othno;
            (param[5] = new OracleParameter("p_cuh_ast_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[2].ToString();

            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.sp_load_bond_numbers", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //23 Nov/2015 Sahan
        public DataTable LoadCusDecDutySum(string p_cuds_doc_no)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_cuds_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cuds_doc_no;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_cusdec_duty_sum", "pkg_imports.sp_load_cusdec_duty_sum", CommandType.StoredProcedure, false, param);
        }

        //Sahan 02/Dec/2105
        public Tuple<int, int> SaveSettleHeader(ImpAstHeader Header)
        {
            int rows_affected = 0;
            int opderno = 0;
            string value = string.Empty;

            OracleParameter[] param = new OracleParameter[18];
            try
            {
                (param[0] = new OracleParameter("p_isth_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Header.ISTH_SEQ_NO;
                (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_DOC_NO;
                (param[2] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_COM;
                (param[3] = new OracleParameter("p_isth_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Header.ISTH_DT;
                (param[4] = new OracleParameter("p_isth_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_TP;
                (param[5] = new OracleParameter("p_isth_entry_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Header.ISTH_ENTRY_AMT;
                (param[6] = new OracleParameter("p_isth_stl_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Header.ISTH_STL_AMT;
                (param[7] = new OracleParameter("p_isth_diff_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Header.ISTH_DIFF_AMT;
                (param[8] = new OracleParameter("p_isth_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_STUS;
                (param[9] = new OracleParameter("p_isth_is_stl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Header.ISTH_IS_STL;
                (param[10] = new OracleParameter("p_isth_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_CRE_BY;
                (param[11] = new OracleParameter("p_isth_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Header.ISTH_CRE_DT;
                (param[12] = new OracleParameter("p_isth_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_CRE_SESSION;
                (param[13] = new OracleParameter("p_isth_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_MOD_BY;
                (param[14] = new OracleParameter("p_isth_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Header.ISTH_MOD_DT;
                (param[15] = new OracleParameter("p_isth_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Header.ISTH_MOD_SESSION;

                param[16] = new OracleParameter("o_auto", OracleDbType.Int32, null, ParameterDirection.Output);
                param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_affected = UpdateRecords("pkg_imports.sp_update_settle_hdr", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            value = param[16].Value.ToString();

            if (!string.IsNullOrEmpty(value))
            {
                opderno = int.Parse(value);
            }


            return new Tuple<int, int>(rows_affected, opderno);
        }

        //Sahan 02/Dec 2015
        public Int32 UpdateSettleDetails(ImpAstDet Details)
        {
            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_istd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Details.ISTD_SEQ_NO;
            (param[1] = new OracleParameter("p_istd_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Details.ISTD_LINE_NO;
            (param[2] = new OracleParameter("p_istd_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_ENTRY_NO;
            (param[3] = new OracleParameter("p_istd_cost_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_COST_CAT;
            (param[4] = new OracleParameter("p_istd_cost_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_COST_TP;
            (param[5] = new OracleParameter("p_istd_cost_ele", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_COST_ELE;
            (param[6] = new OracleParameter("p_istd_cost_ele_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Details.ISTD_COST_ELE_AMT;
            (param[7] = new OracleParameter("p_istd_cost_claim_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Details.ISTD_COST_CLAIM_AMT;
            (param[8] = new OracleParameter("p_istd_cost_unclaim_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Details.ISTD_COST_UNCLAIM_AMT;
            (param[9] = new OracleParameter("p_istd_cost_stl_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Details.ISTD_COST_STL_AMT;
            (param[10] = new OracleParameter("p_istd_diff_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Details.ISTD_DIFF_AMT;
            (param[11] = new OracleParameter("p_istd_assess_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_ASSESS_NO;
            (param[12] = new OracleParameter("p_istd_assess_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Details.ISTD_ASSESS_DT;
            (param[13] = new OracleParameter("p_istd_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_STUS;
            (param[14] = new OracleParameter("p_istd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_MOD_BY;
            (param[15] = new OracleParameter("p_istd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Details.ISTD_MOD_DT;
            (param[16] = new OracleParameter("p_istd_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_MOD_SESSION;
            (param[17] = new OracleParameter("p_istd_cncl_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_CNCL_BY;
            (param[18] = new OracleParameter("p_istd_cncl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = Details.ISTD_CNCL_DT;
            (param[19] = new OracleParameter("p_istd_cncl_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Details.ISTD_CNCL_SESSION;

            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_update_settle_details", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 02/Dec 2015
        public Int32 UpdateCusDecHeader(ImpCusdecHdr CusDecHeader)
        {
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("p_cuh_ast_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_NO;
            (param[1] = new OracleParameter("p_cuh_ast_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_DT;
            (param[2] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_COM;
            (param[3] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_DOC_NO;
            (param[4] = new OracleParameter("p_cuh_ast_noties_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_NOTIES_NO;
            (param[5] = new OracleParameter("p_cuh_ast_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_STUS;
            (param[6] = new OracleParameter("p_cuh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_BY;
            (param[7] = new OracleParameter("p_cuh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_DT;
            (param[8] = new OracleParameter("p_cuh_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_SESSION;

            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_update_cusdec_hdr", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 03/Dec/2015
        public DataTable LoadSettleDocs(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime? _fromDate, DateTime? _toDate)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.sp_load_setle_docs", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Sahan 03/Dec/2015
        public DataTable LoadSettleDocSummary(string company, string docno)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_hdr", "pkg_imports.sp_load_setle_doc_summary", CommandType.StoredProcedure, false, param);
        }

        //Sahan 03/Dec/2015
        public DataTable LoadSavedDutyDetails(string entryno, Int32 Seqno)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_istd_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            (param[1] = new OracleParameter("p_istd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seqno;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_det", "pkg_imports.sp_load_saved_duty_details", CommandType.StoredProcedure, false, param);
        }


        //Sahan 03/Dec/2015
        public DataTable LoadSavedEntryPopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _entryNo = null;
            string _docno = null;
            string _noticeno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT NO":
                        _entryNo = _searchText;
                        break;

                    case "ASSESSMENT NO":
                        _docno = _searchText;
                        break;

                    case "ASSESSMENT NOTICE NO":
                        _noticeno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _entryNo = (_entryNo != null) ? (_entryNo.ToUpper()) : null;
            _docno = (_docno != null) ? (_docno.ToUpper()) : null;
            _noticeno = (_noticeno != null) ? (_noticeno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_istd_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            (param[2] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[3] = new OracleParameter("p_istd_assess_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _noticeno;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.sp_load_saved_entry_popup", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 03/Dec/2015
        public DataTable LoadAllEntryDetails(string doc, string company)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_det", "pkg_imports.sp_load_entry_all_details", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Dec/2015
        public DataTable CalculateAmendSum(string p_istd_entry_no, Int32 p_istd_seq_no)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_istd_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_istd_entry_no;
            (param[1] = new OracleParameter("p_istd_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_istd_seq_no;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_det", "pkg_imports.sp_cal_amaned_total", CommandType.StoredProcedure, false, param);
        }

        //Sahan 04/Dec/2015
        public DataTable CalculateTotEntrySum(Int32 p_istd_seq_no)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_istd_seq_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_istd_seq_no;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_det", "pkg_imports.sp_cal_entry_total", CommandType.StoredProcedure, false, param);
        }

        //Sahan 05/Dec 2015
        public Int32 UpdateDutySumSettle(ImpCusdecDutySum DutySum)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_cuds_cost_stl_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = DutySum.CUDS_COST_STL_AMT;
            (param[1] = new OracleParameter("p_cuds_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DutySum.CUDS_DOC_NO;
            (param[2] = new OracleParameter("p_cuds_cost_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DutySum.CUDS_COST_CAT;
            (param[3] = new OracleParameter("p_cuds_cost_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DutySum.CUDS_COST_TP;
            (param[4] = new OracleParameter("p_cuds_cost_ele", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DutySum.CUDS_COST_ELE;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_update_duty_sum_settle", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 05/Dec 2015
        public Int32 UpdateAssessmentHeaderStatus(string stus, string modifiedby, DateTime modified_date, string modifysession, string docno, string company, Int32 seqno, string cancelby, DateTime canceldate, string cancelsession)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[11];

            try
            {
                (param[0] = new OracleParameter("p_isth_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
                (param[1] = new OracleParameter("p_isth_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifiedby;
                (param[2] = new OracleParameter("p_isth_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = modified_date;
                (param[3] = new OracleParameter("p_isth_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifysession;
                (param[4] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
                (param[5] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[6] = new OracleParameter("p_istd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqno;
                (param[7] = new OracleParameter("p_isth_cncl_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cancelby;
                (param[8] = new OracleParameter("p_isth_cncl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = canceldate;
                (param[9] = new OracleParameter("p_isth_cncl_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cancelsession;

                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_update_assmnt_hdr_stus", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        //Sahan 07/Dec 2015
        public Int32 ResetCusDecHeaderAndDutySum(string company, string doc, string modifiedby, DateTime modified_date, string modifysesssion)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[6];

            try
            {
                (param[0] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
                (param[2] = new OracleParameter("p_cuh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifiedby;
                (param[3] = new OracleParameter("p_cuh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = modified_date;
                (param[4] = new OracleParameter("p_cuh_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = modifysesssion;

                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.reset_cusdec_hdr_duty_sum", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }
        public DataTable getShipmentDetails(string _com, DateTime _fromDate, DateTime _toDate, string _blNo, string _manualNo, string _tobondNo)
        {

            // Wimal @ 30/11/2015
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("bl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blNo;
            (param[4] = new OracleParameter("to_bondno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobondNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_IMP_GET_SHIPMENT_DETAILS", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetSipmentStatusDetails(DateTime _fromDate, DateTime _toDate, string _com, string _item, string _blNo, string _entryno, string _user,
            string _cat1, string _cat2, string _cat3, string _model, string _brand)
        {
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[5] = new OracleParameter("in_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blNo;
            (param[6] = new OracleParameter("in_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[7] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[8] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[9] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[10] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;

            DataTable _result = QueryDataTable("tbl", "sp_get_shipment_details", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable GetPhysicalStockVerification(string _mainjobno, string _jobno, string _user)
        {
            OracleParameter[] param = new OracleParameter[4];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_main_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mainjobno;
            (param[2] = new OracleParameter("in_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _jobno;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_stock_verification", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getImpCstAnalDetails(string _com, DateTime _fromDate, DateTime _toDate, string _blNo, string _tobondNo)
        {
            // Wimal @ 30/11/2015
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("bl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blNo;
            (param[4] = new OracleParameter("to_bondno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobondNo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_imp_get_cst_anal_dtl", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Sahan 09/Dec/2015
        public DataTable LoadPendingAssesmentHeaders(ImpAstHeader header)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = header.ISTH_COM;
            (param[1] = new OracleParameter("p_isth_is_stl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = header.ISTH_IS_STL;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_ast_hdr", "pkg_imports.sp_load_ass_headers", CommandType.StoredProcedure, false, param);
        }

        //Sahan 09/Dec/2015
        public DataTable LoadDGCAccounts()
        {
            OracleParameter[] param = new OracleParameter[1];

            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("mst_dgc_acc", "pkg_imports.sp_load_dgc_acc_details", CommandType.StoredProcedure, false, param);
        }

        public DataTable getLCDetailsBankwise(DateTime _fromDate, DateTime _toDate, string _com, string _bank, string _lcno, string _type, string _all, string _user)
        {
            // Sanjeewa 07/12/2015
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[5] = new OracleParameter("in_lcno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _lcno;
            (param[6] = new OracleParameter("in_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[7] = new OracleParameter("in_all", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _all;
            (param[8] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_lc_dtl_bankwise", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getShipmentScheduleDetails(DateTime _fromDate, DateTime _toDate, string _com, string _sino, string _user)
        {
            // Sanjeewa 24/02/2016
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sino;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_shipment_schedule", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getCostInformationSummaryDetails(DateTime _fromDate, DateTime _toDate, string _com, string _user, string cat01, string cat02, string cat03, string cat04, string cat05, string items, string models, string brand)
        {
            // Sanjeewa 16/06/2016 //Edited By Dulaj 2019/Jan/09
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("in_cat01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat01;
            (param[6] = new OracleParameter("in_cat02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat02;
            (param[7] = new OracleParameter("in_cat03", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat03;
            (param[8] = new OracleParameter("in_cat04", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat04;
            (param[9] = new OracleParameter("in_cat05", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat05;
            (param[10] = new OracleParameter("in_items", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = items;
            (param[11] = new OracleParameter("in_models", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = models;
            (param[12] = new OracleParameter("in_brands", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = brand;

            DataTable _result = QueryDataTable("tbl", "sp_imp_get_cost_info", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getAODReconciliationDetails(DateTime _fromDate, DateTime _toDate, string _com, string _fromadmin, string _toadmin, string _user)
        {
            // Sanjeewa 16/06/2016
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_adminfrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromadmin;
            (param[5] = new OracleParameter("in_adminto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toadmin;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_aod_reconciliation", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getAODInOutDetails(DateTime _fromDate, DateTime _toDate, string _com, string _fromadmin, string _toadmin, string _fromloc, string _toloc, string _in_aodin, string _in_aodout, string _in_deltype, string _user)
        {
            // Wimal 25/10/2016
            OracleParameter[] param = new OracleParameter[12];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_adminfrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromadmin;
            (param[5] = new OracleParameter("in_adminto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toadmin;
            (param[6] = new OracleParameter("in_locfrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromloc;
            (param[7] = new OracleParameter("in_locto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _toloc;
            (param[8] = new OracleParameter("in_aodin", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _in_aodin;
            (param[9] = new OracleParameter("in_aodout", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _in_aodout;
            (param[10] = new OracleParameter("in_deltype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _in_deltype;
            (param[11] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_aod_inout_details", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getdialyWHStock(string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _itemModel, string _itembrand, string _brandMGR)
        {
            // Wimal 12/08/2016
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[2] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[3] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[4] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[5] = new OracleParameter("in_itemmodel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemModel;
            (param[6] = new OracleParameter("in_itembrand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itembrand;
            (param[7] = new OracleParameter("in_brndmgr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";

            DataTable _result = QueryDataTable("tbl", "sp_dialyWHStock", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getSalesOrderDetails(DateTime _fromDate, DateTime _toDate, string _com, string _otherloc, string _exec, string _pc, string _user, string _customer)
        {
            // Sanjeewa 16/06/2016
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherloc;
            (param[7] = new OracleParameter("in_exec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _exec;
            (param[8] = new OracleParameter("in_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;

            DataTable _result = QueryDataTable("tbl", "sp_get_so_detail", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getSalesOrderSummery(DateTime _fromDate, DateTime _toDate, string _com, string _otherloc, string _exec, string _pc, string _user, string _customer)
        {
            // Dilshan 16/10/2017
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherloc;
            (param[7] = new OracleParameter("in_exec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _exec;
            (param[8] = new OracleParameter("in_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;

            DataTable _result = QueryDataTable("tbl", "sp_get_so_summery", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getIntercompanySalesDetails(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _user)
        {
            // Sanjeewa 19/06/2016
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_intercompany_sale", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getIntercompanyReversalDetails(DateTime _fromDate, DateTime _toDate, string _com, string _pc, string _user)
        {
            // Sanjeewa 19/06/2016
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_intercompany_reversal", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getShipmentScheduleContainerDetails(DateTime _fromDate, DateTime _toDate, string _com, string _sino, string _user)
        {
            // Sanjeewa 24/02/2016
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sino;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_si_container", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getContainerDetailsBySI(string _sino, string _user)
        {
            // Sanjeewa 27/12/2016
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sino;
            (param[2] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_container_by_si", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getCostingSheetDetails(string _blno, string _costtype)
        {
            // Sanjeewa 24/02/2016
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            (param[2] = new OracleParameter("in_costtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costtype;

            DataTable _result = QueryDataTable("tbl", "sp_get_costsheet", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getCostingSheetSumDetails(string _blno, string _costtype)
        {
            // Sanjeewa 24/02/2016
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            (param[2] = new OracleParameter("in_costtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costtype;

            DataTable _result = QueryDataTable("tbl", "sp_get_costsheet_sum", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public DataTable getOrderStatusDetails(DateTime _fromDate, DateTime _toDate, string _com, string _user, string _supplier, string _cat1, string _cat2, string _cat3, string _item, string _brand, string _model, string _bldone)
        {
            // Sanjeewa 07/12/2015
            OracleParameter[] param = new OracleParameter[13];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("in_supplier", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _supplier;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[8] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[9] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _item;
            (param[10] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[11] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[12] = new OracleParameter("in_bldone", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bldone;

            DataTable _result = QueryDataTable("tbl", "sp_get_order_status", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getProfitabilityDetails(DateTime _fromDate, DateTime _toDate, string _com, decimal _buyrt, decimal _forcastrt, decimal _costrt, decimal _markup,
              decimal _asschg, string _sino, string _entryno, decimal _overhd, string _pb, string _pblvl, string _user)
        {
            // Sanjeewa 11/08/2016
            OracleParameter[] param = new OracleParameter[15];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_buyrt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _buyrt;
            (param[5] = new OracleParameter("in_forcastrt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _forcastrt;
            (param[6] = new OracleParameter("in_costrt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _costrt;
            (param[7] = new OracleParameter("in_markup", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _markup;
            (param[8] = new OracleParameter("in_asschrg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _asschg;
            (param[9] = new OracleParameter("in_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sino;
            (param[10] = new OracleParameter("in_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[11] = new OracleParameter("in_overhd", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _overhd;
            (param[12] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[13] = new OracleParameter("in_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pblvl;
            (param[14] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_profitability_dtl", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getItemMasterDetails(string _itmcol, string _othercol, string _othertab, string _com,
            string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _item, string _user)
        {
            // Sanjeewa 14/12/2015
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[3] = new OracleParameter("in_col_mst_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcol;
            (param[4] = new OracleParameter("in_col_other", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othercol;
            (param[5] = new OracleParameter("in_other_tab", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othertab;
            (param[6] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_mst_itm_details", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Sahan 09/Dec/2105
        public Tuple<int, int> SaveSettleMentsHeader(ImportsSettleHeader SettleHeader)
        {
            int rows_affected = 0;
            int opderno = 0;
            string value = string.Empty;

            OracleParameter[] param = new OracleParameter[15];
            try
            {
                (param[0] = new OracleParameter("p_ishd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_SEQ_NO;
                (param[1] = new OracleParameter("p_ishd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_DOC_NO;
                (param[2] = new OracleParameter("p_ishd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_COM;
                (param[3] = new OracleParameter("p_ishd_stl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_STL_DT;
                (param[4] = new OracleParameter("p_ishd_stl_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_STL_AMT;
                (param[5] = new OracleParameter("p_ishd_used_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_USED_AMT;
                (param[6] = new OracleParameter("p_ishd_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_STUS;
                (param[7] = new OracleParameter("p_ishd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_CRE_BY;
                (param[8] = new OracleParameter("p_ishd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_CRE_DT;
                (param[9] = new OracleParameter("p_ishd_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_CRE_SESSION;
                (param[10] = new OracleParameter("p_ishd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_MOD_BY;
                (param[11] = new OracleParameter("p_ishd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_MOD_DT;
                (param[12] = new OracleParameter("p_ishd_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_MOD_SESSION;

                param[13] = new OracleParameter("o_auto", OracleDbType.Int32, null, ParameterDirection.Output);
                param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                rows_affected = UpdateRecords("pkg_imports.sp_save_settle_header", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
                throw ex;
            }

            value = param[13].Value.ToString();

            if (!string.IsNullOrEmpty(value))
            {
                opderno = int.Parse(value);
            }


            return new Tuple<int, int>(rows_affected, opderno);
        }

        //Sahan 09/Dec 2015
        public Int32 SaveSettleMentsDetails(ImportsSettleDetails SettleDetails)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_isdt_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SettleDetails.ISDT_SEQ_NO;
            (param[1] = new OracleParameter("p_isdt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleDetails.ISDT_DOC_NO;
            (param[2] = new OracleParameter("p_isdt_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = SettleDetails.ISDT_LINE;
            (param[3] = new OracleParameter("p_isdt_ast_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleDetails.ISDT_AST_NO;
            (param[4] = new OracleParameter("p_isdt_ast_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = SettleDetails.ISDT_AST_AMT;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_save_settlement_details", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 09/Dec 2015
        public Int32 ChangeAssessmentHeaderStatus(ImpAstHeader AssHeader)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_isth_is_stl", OracleDbType.Int32, null, ParameterDirection.Input)).Value = AssHeader.ISTH_IS_STL;
            (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AssHeader.ISTH_DOC_NO;
            (param[2] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = AssHeader.ISTH_COM;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_change_assessment_hdr_stus", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 09/Dec 2015
        public Int32 UpdateDGCAccount(DGCAccounts Accounts)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_mda_used_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Accounts.MDA_USED_AMT;
            (param[1] = new OracleParameter("p_mda_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Accounts.MDA_COM;
            (param[2] = new OracleParameter("p_mda_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Accounts.MDA_ACC_NO;

            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_update_dgc_acc", CommandType.StoredProcedure, param);
            return result;
        }

        public DataTable getLocationsbycompany(string _com)
        {
            // Sanjeewa
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            DataTable _result = QueryDataTable("tbl", "sp_get_loc_dtl_by_com", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getProfitcentersbycompany(string _com)
        {
            // Sanjeewa
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;

            DataTable _result = QueryDataTable("tbl", "sp_get_pc_dtl_by_com", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getImpCstinfomation(string _com, DateTime _fromDate, DateTime _toDate)
        {

            // Wimal @ 09/12/2015
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_imp_get_cost_info", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getImportRegister(string _com, DateTime _fromDate, DateTime _toDate, string _blNo, string _tobondNo, string _fromfile, string _tofile)
        {

            // Wimal @ 09/12/2015
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("bl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blNo;
            (param[4] = new OracleParameter("to_bondno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tobondNo;
            (param[5] = new OracleParameter("in_filefrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fromfile;
            (param[6] = new OracleParameter("in_fileto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _tofile;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "sp_imp_get_import_register", CommandType.StoredProcedure, false, param);
            return _result;
        }

        public DataTable getSLPARegister(string _filefrom, string _fileto, string _com, string _user)
        {// Wimal @ 09/12/2015 - Modified Sanjeewa
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_filefrom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _filefrom;
            (param[2] = new OracleParameter("in_fileto", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _fileto;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _result = QueryDataTable("tbl", "sp_get_slpa_register", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Sahan 10 Dec 2015
        public DataTable LoadSavedSettlemets(string doc, string company)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_ishd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_ishd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_det", "pkg_imports.sp_load_saved_settlements", CommandType.StoredProcedure, false, param);
        }

        //Sahan 10/Dec/2015
        public DataTable LoadSavedSettlementsPopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _date = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SETTLEMENT NO ":
                        _docno = _searchText;
                        break;
                    case "DATE":
                        _date = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ishd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ishd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _date;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.sp_load_saved_settle_popup", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 10/Dec 2015
        public Int32 UpdateSettlementCurrentStatus(ImportsSettleHeader SettleHeader)
        {
            OracleParameter[] param = new OracleParameter[7];

            (param[0] = new OracleParameter("p_ishd_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_STUS;
            (param[1] = new OracleParameter("p_ishd_cncl_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_CNCL_BY;
            (param[2] = new OracleParameter("p_ishd_cncl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_CNCL_DT;
            (param[3] = new OracleParameter("p_ishd_cncl_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_CNCL_SESSION;
            (param[4] = new OracleParameter("p_ishd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_DOC_NO;
            (param[5] = new OracleParameter("p_ishd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SettleHeader.ISHD_COM;

            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_change_settle_hdr_stus", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 11 Dec 2015
        public DataTable LoadAODDocs(string doc, string company, string type)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_ith_oth_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
            (param[2] = new OracleParameter("p_ith_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "pkg_imports.sp_load_aod_docs", CommandType.StoredProcedure, false, param);

        }

        public DataTable getBondBalanceDetails1()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "sp_get_bond_balance1", CommandType.StoredProcedure, false, param);
        }

        public DataTable getBondBalanceDetails2()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "sp_get_bond_balance1_old", CommandType.StoredProcedure, false, param);
        }

        public DataTable getBondBalanceDetails1_SGL()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "sp_get_bond_balance1_SGL", CommandType.StoredProcedure, false, param);
        }

        //Sanjeewa 22-12-2015
        public DataTable getBondBalanceDetails(DateTime _asatDate, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _Stktype, string _Com, string _Loc, string _User)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[2] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[3] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[4] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[5] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[6] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[7] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[8] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[9] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[10] = new OracleParameter("in_stktype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Stktype;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[12] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[13] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            return QueryDataTable("int_hdr", "sp_get_bond_balance_curr", CommandType.StoredProcedure, false, param);
        }
        public DataTable getBondBalanceSalesDetails(DateTime _asatDate, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _Stktype, string _Com, string _Loc, string _User)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;
            (param[2] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[3] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[4] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[5] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[6] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[7] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[8] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[9] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[10] = new OracleParameter("in_stktype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Stktype;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[12] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[13] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            return QueryDataTable("int_hdr", "sp_get_bond_balance_sales", CommandType.StoredProcedure, false, param);
        }
        //Sanjeewa 14-07-2016
        public DataTable getBMSalesDetails(DateTime _FromDate, DateTime _ToDate, string _invdate, string _com, string _pc, string _user, string _cols, int _foc, int _intercom, string hpinttype, int _inthpsales, int _intcrecardsale, int _servicecharge)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_byinvdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invdate;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("in_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cols;
            (param[8] = new OracleParameter("in_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _foc;
            (param[9] = new OracleParameter("in_intercom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intercom;
            (param[10] = new OracleParameter("in_hpinttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hpinttype;
            (param[11] = new OracleParameter("in_inthpsales", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inthpsales;
            (param[12] = new OracleParameter("in_intcrecardsale", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intcrecardsale;
            (param[13] = new OracleParameter("in_servicecharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _servicecharge;

            return QueryDataTable("int_hdr", "sp_get_sales_rep_bmi", CommandType.StoredProcedure, false, param);
        }
        //Dilshan 21-05-2018
        public DataTable getBMHISalesDetails(DateTime _FromDate, DateTime _ToDate, string _invdate, string _com, string _pc, string _user, string _cols, int _foc, int _intercom, string hpinttype, int _inthpsales, int _intcrecardsale, int _servicecharge)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_byinvdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invdate;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("in_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cols;
            (param[8] = new OracleParameter("in_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _foc;
            (param[9] = new OracleParameter("in_intercom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intercom;
            (param[10] = new OracleParameter("in_hpinttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hpinttype;
            (param[11] = new OracleParameter("in_inthpsales", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inthpsales;
            (param[12] = new OracleParameter("in_intcrecardsale", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intcrecardsale;
            (param[13] = new OracleParameter("in_servicecharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _servicecharge;

            return QueryDataTable("int_hdr", "sp_get_sales_rep_hir", CommandType.StoredProcedure, false, param);
        }
        //Dilshan 21-05-2018
        public DataTable getBMItemSalesDetails(DateTime _FromDate, DateTime _ToDate, string _invdate, string _com, string _pc, string _user, string _cols, int _foc, int _intercom, string hpinttype, int _inthpsales, int _intcrecardsale, int _servicecharge)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_byinvdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invdate;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("in_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cols;
            (param[8] = new OracleParameter("in_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _foc;
            (param[9] = new OracleParameter("in_intercom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intercom;
            (param[10] = new OracleParameter("in_hpinttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hpinttype;
            (param[11] = new OracleParameter("in_inthpsales", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inthpsales;
            (param[12] = new OracleParameter("in_intcrecardsale", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intcrecardsale;
            (param[13] = new OracleParameter("in_servicecharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _servicecharge;

            return QueryDataTable("int_hdr", "sp_get_sales_rep_item", CommandType.StoredProcedure, false, param);
        }
        //Dilshan 21-05-2018
        public DataTable getBMServiceSalesDetails(DateTime _FromDate, DateTime _ToDate, string _invdate, string _com, string _pc, string _user, string _cols, int _foc, int _intercom, string hpinttype, int _inthpsales, int _intcrecardsale, int _servicecharge)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_byinvdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invdate;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("in_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cols;
            (param[8] = new OracleParameter("in_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _foc;
            (param[9] = new OracleParameter("in_intercom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intercom;
            (param[10] = new OracleParameter("in_hpinttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hpinttype;
            (param[11] = new OracleParameter("in_inthpsales", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inthpsales;
            (param[12] = new OracleParameter("in_intcrecardsale", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intcrecardsale;
            (param[13] = new OracleParameter("in_servicecharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _servicecharge;

            return QueryDataTable("int_hdr", "sp_get_sales_rep_service", CommandType.StoredProcedure, false, param);
        }
        public DataTable getBMServiceSalesItem(int _servicecharge)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_servicecharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _servicecharge;

            return QueryDataTable("int_hdr", "sp_get_sales_item_service", CommandType.StoredProcedure, false, param);
        }
        //Sanjeewa 10-01-2017
        public DataTable getBMSalesLastUpdated()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "sp_get_bi_lastupdate", CommandType.StoredProcedure, false, param);
        }

        public DataTable GetDeliveredSalesDetailsBM(DateTime _fromDate, DateTime _toDate, string _Pc, string _Com)
        {
            // Sanjeewa 10-01-2017
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("IN_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[4] = new OracleParameter("IN_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_bm_sales_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        public int InsertBMSales(DateTime _dfrom, DateTime _dto)
        {
            int _count = 0;
            int _ref = 0;
            string _sql;
            OracleCommand OCmd = new OracleCommand();

            DataTable _Sale = new DataTable();
            DataTable _Sale1 = new DataTable();
            _Sale1 = GetDeliveredSalesDetailsBM(_dfrom, _dto, "", "ABL");
            _Sale.Merge(_Sale1);
            _Sale1 = GetDeliveredSalesDetailsBM(_dfrom, _dto, "", "LRP");
            _Sale.Merge(_Sale1);

            if (_Sale.Rows.Count > 0)
            {
                foreach (DataRow drow1 in _Sale.Rows)
                {
                    _count = _count + 1;

                    _sql = "INSERT INTO BMT_SALE_CURR(bms_seq_no,bms_com_cd,bms_pc_cd,bms_pc_desc,bms_chnl,bms_inv_year,bms_inv_month,bms_do_year,bms_do_month,bms_do_loc,bms_do_loc_desc,";
                    _sql = _sql + "bms_pc_area,bms_pc_region,bms_pc_zone,bms_pc_chnl,bms_pc_sub_chnl,bms_loc_area,bms_loc_region,bms_loc_zone,bms_loc_chnl,bms_loc_sub_chnl,";
                    _sql = _sql + "bms_pc_area_desc,bms_pc_region_desc,bms_pc_zone_desc,bms_pc_chnl_desc,bms_pc_sub_chnl_desc,";
                    _sql = _sql + "bms_loc_area_desc,bms_loc_region_desc,bms_loc_zone_desc,bms_loc_chnl_desc,bms_loc_sub_chnl_desc,";
                    _sql = _sql + "bms_inv_tp,bms_inv_sub_tp,bms_inv_dt,bms_inv_no,bms_do_dt,bms_do_no,";
                    _sql = _sql + "bms_exec_cd,bms_exec_name,bms_cust_cd,bms_cust_name,bms_d_cust_cd,bms_d_cust_name,";
                    _sql = _sql + "bms_itm_cat1,bms_itm_cat2,bms_itm_cat3,bms_itm_cat4,bms_itm_cat5,";
                    _sql = _sql + "bms_itm_cat1_desc,bms_itm_cat2_desc,bms_itm_cat3_desc,bms_itm_cat4_desc,bms_itm_cat5_desc,";
                    _sql = _sql + "bms_itm_cd,bms_itm_desc,bms_itm_mdl,bms_brnd_cd,bms_brnd_name,bms_itm_stus,bms_itm_stus_desc,";
                    _sql = _sql + "bms_circular,bms_promo_tp,bms_promo_tp_desc,bms_promo_cd,bms_scheme_tp,bms_scheme_cd,bms_acc_no,bms_pb_cd,bms_pb_lvl,";
                    _sql = _sql + "bms_t_qty,bms_t_unit_rt,bms_t_unit_amt,bms_t_disc_rt,bms_t_disc_amt,bms_t_tax_amt,bms_t_net_amt,bms_t_tot_amt,";
                    _sql = _sql + "bms_d_qty,bms_d_unit_rt,bms_d_unit_amt,bms_d_disc_rt,bms_d_disc_amt,bms_d_tax_amt,bms_d_net_amt,bms_d_tot_amt,bms_d_cost,bms_d_org_cost,bms_gp,";
                    _sql = _sql + "bms_direct,bms_fwd_qty,bms_fwd_sale,bms_fitm_cost,bms_mitm_cd,bms_avg_m_sale,bms_mdl_st_dt,bms_pre_itm_mdl,bms_inv_day,bms_do_day) ";
                    _sql = _sql + "values(:bms_seq_no,:bms_com_cd,:bms_pc_cd,:bms_pc_desc,:bms_chnl,:bms_inv_year,:bms_inv_month,:bms_do_year,:bms_do_month,:bms_do_loc,:bms_do_loc_desc,";
                    _sql = _sql + ":bms_pc_area,:bms_pc_region,:bms_pc_zone,:bms_pc_chnl,:bms_pc_sub_chnl,:bms_loc_area,:bms_loc_region,:bms_loc_zone,:bms_loc_chnl,:bms_loc_sub_chnl,";
                    _sql = _sql + ":bms_pc_area_desc,:bms_pc_region_desc,:bms_pc_zone_desc,:bms_pc_chnl_desc,:bms_pc_sub_chnl_desc,";
                    _sql = _sql + ":bms_loc_area_desc,:bms_loc_region_desc,:bms_loc_zone_desc,:bms_loc_chnl_desc,:bms_loc_sub_chnl_desc,";
                    _sql = _sql + ":bms_inv_tp,:bms_inv_sub_tp,:bms_inv_dt,:bms_inv_no,:bms_do_dt,:bms_do_no,";
                    _sql = _sql + ":bms_exec_cd,:bms_exec_name,:bms_cust_cd,:bms_cust_name,:bms_d_cust_cd,:bms_d_cust_name,";
                    _sql = _sql + ":bms_itm_cat1,:bms_itm_cat2,:bms_itm_cat3,:bms_itm_cat4,:bms_itm_cat5,";
                    _sql = _sql + ":bms_itm_cat1_desc,:bms_itm_cat2_desc,:bms_itm_cat3_desc,:bms_itm_cat4_desc,:bms_itm_cat5_desc,";
                    _sql = _sql + ":bms_itm_cd,:bms_itm_desc,:bms_itm_mdl,:bms_brnd_cd,:bms_brnd_name,:bms_itm_stus,:bms_itm_stus_desc,";
                    _sql = _sql + ":bms_circular,:bms_promo_tp,:bms_promo_tp_desc,:bms_promo_cd,:bms_scheme_tp,:bms_scheme_cd,:bms_acc_no,:bms_pb_cd,:bms_pb_lvl,";
                    _sql = _sql + ":bms_t_qty,:bms_t_unit_rt,:bms_t_unit_amt,:bms_t_disc_rt,:bms_t_disc_amt,:bms_t_tax_amt,:bms_t_net_amt,:bms_t_tot_amt,";
                    _sql = _sql + ":bms_d_qty,:bms_d_unit_rt,:bms_d_unit_amt,:bms_d_disc_rt,:bms_d_disc_amt,:bms_d_tax_amt,:bms_d_net_amt,:bms_d_tot_amt,:bms_d_cost,:bms_d_org_cost,:bms_gp,";
                    _sql = _sql + ":bms_direct,:bms_fwd_qty,:bms_fwd_sale,:bms_fitm_cost,:bms_mitm_cd,:bms_avg_m_sale,:bms_mdl_st_dt,:bms_pre_itm_mdl,:bms_inv_day,:bms_do_day)";

                    OCmd = new OracleCommand(_sql, oConnection);
                    OCmd.Parameters.Add(new OracleParameter(":bms_seq_no", 1));
                    OCmd.Parameters.Add(new OracleParameter(":bms_com_cd", drow1["bm_com_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_cd", drow1["bm_pc_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_desc", drow1["bm_pc_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_chnl", drow1["bm_chnl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_year", Convert.ToInt16(drow1["bm_inv_year"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_month", Convert.ToInt16(drow1["bm_inv_month"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_year", Convert.ToInt16(drow1["bm_do_year"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_month", Convert.ToInt16(drow1["bm_do_month"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_loc", drow1["bm_do_loc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_loc_desc", drow1["bm_do_loc_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_area", drow1["bm_pc_area"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_region", drow1["bm_pc_region"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_zone", drow1["bm_pc_zone"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_chnl", drow1["bm_pc_chnl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_sub_chnl", drow1["bm_pc_sub_chnl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_area", drow1["bm_loc_area"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_region", drow1["bm_loc_region"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_zone", drow1["bm_loc_zone"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_chnl", drow1["bm_loc_chnl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_sub_chnl", drow1["bm_loc_sub_chnl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_area_desc", drow1["bm_pc_area_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_region_desc", drow1["bm_pc_region_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_zone_desc", drow1["bm_pc_zone_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_chnl_desc", drow1["bm_pc_chnl_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pc_sub_chnl_desc", drow1["bm_pc_sub_chnl_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_area_desc", drow1["bm_loc_area_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_region_desc", drow1["bm_loc_region_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_zone_desc", drow1["bm_loc_zone_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_chnl_desc", drow1["bm_loc_chnl_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_loc_sub_chnl_desc", drow1["bm_loc_sub_chnl_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_tp", drow1["bm_inv_tp"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_sub_tp", drow1["bm_inv_sub_tp"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_dt", drow1["bm_inv_dt"]));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_no", drow1["bm_inv_no"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_dt", drow1["bm_do_dt"]));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_no", drow1["bm_do_no"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_exec_cd", drow1["bm_exec_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_exec_name", drow1["bm_exec_name"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_cust_cd", drow1["bm_cust_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_cust_name", drow1["bm_cust_name"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_cust_cd", drow1["bm_d_cust_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_cust_name", drow1["bm_d_cust_name"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat1", drow1["bm_itm_cat1"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat2", drow1["bm_itm_cat2"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat3", drow1["bm_itm_cat3"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat4", drow1["bm_itm_cat4"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat5", drow1["bm_itm_cat5"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat1_desc", drow1["bm_itm_cat1_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat2_desc", drow1["bm_itm_cat2_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat3_desc", drow1["bm_itm_cat3_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat4_desc", drow1["bm_itm_cat4_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cat5_desc", drow1["bm_itm_cat5_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_cd", drow1["bm_itm_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_desc", drow1["bm_itm_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_mdl", drow1["bm_itm_mdl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_brnd_cd", drow1["bm_brnd_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_brnd_name", drow1["bm_brnd_name"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_stus", drow1["bm_itm_stus"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_itm_stus_desc", drow1["bm_itm_stus_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_circular", drow1["bm_circular"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_promo_tp", drow1["bm_promo_tp"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_promo_tp_desc", drow1["bm_promo_tp_desc"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_promo_cd", drow1["bm_promo_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_scheme_tp", drow1["bm_scheme_tp"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_scheme_cd", drow1["bm_scheme_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_acc_no", drow1["bm_acc_no"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pb_cd", drow1["bm_pb_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pb_lvl", drow1["bm_pb_lvl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_qty", Convert.ToDecimal(drow1["bm_t_qty"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_unit_rt", Convert.ToDecimal(drow1["bm_t_unit_rt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_unit_amt", Convert.ToDecimal(drow1["bm_t_unit_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_disc_rt", Convert.ToDecimal(drow1["bm_t_disc_rt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_disc_amt", Convert.ToDecimal(drow1["bm_t_disc_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_tax_amt", Convert.ToDecimal(drow1["bm_t_tax_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_net_amt", Convert.ToDecimal(drow1["bm_t_net_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_t_tot_amt", Convert.ToDecimal(drow1["bm_t_tot_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_qty", Convert.ToDecimal(drow1["bm_d_qty"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_unit_rt", Convert.ToDecimal(drow1["bm_d_unit_rt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_unit_amt", Convert.ToDecimal(drow1["bm_d_unit_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_disc_rt", Convert.ToDecimal(drow1["bm_d_disc_rt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_disc_amt", Convert.ToDecimal(drow1["bm_d_disc_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_tax_amt", Convert.ToDecimal(drow1["bm_d_tax_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_net_amt", Convert.ToDecimal(drow1["bm_d_net_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_tot_amt", Convert.ToDecimal(drow1["bm_d_tot_amt"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_cost", Convert.ToDecimal(drow1["bm_d_cost"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_d_org_cost", Convert.ToDecimal(drow1["bm_d_org_cost"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_gp", Convert.ToDecimal(drow1["bm_gp"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_direct", Convert.ToInt16(drow1["bm_direct"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_fwd_qty", Convert.ToDecimal(drow1["bm_fwd_qty"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_fwd_sale", Convert.ToDecimal(drow1["bm_fwd_sale"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_fitm_cost", Convert.ToDecimal(drow1["bm_fitm_cost"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_mitm_cd", drow1["bm_mitm_cd"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_avg_m_sale", Convert.ToDecimal(drow1["bm_avg_m_sale"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_mdl_st_dt", drow1["bm_mdl_st_dt"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_pre_itm_mdl", drow1["bm_pre_itm_mdl"].ToString()));
                    OCmd.Parameters.Add(new OracleParameter(":bms_inv_day", Convert.ToInt16(drow1["bm_inv_day"].ToString())));
                    OCmd.Parameters.Add(new OracleParameter(":bms_do_day", Convert.ToInt16(drow1["bm_do_day"].ToString())));

                    OCmd.CommandType = CommandType.Text;
                    _ref = OCmd.ExecuteNonQuery();
                }
            }
            return 1;
        }

        //Sanjeewa 14-07-2016
        public DataTable getBMReportHeading(string _report)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_report", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _report;

            return QueryDataTable("int_hdr", "sp_get_bm_report_heading", CommandType.StoredProcedure, false, param);
        }
        public DataTable getPeriodDetails(DateTime _asatDate, string _com)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate;

            return QueryDataTable("int_hdr", "sp_get_period_dtl", CommandType.StoredProcedure, false, param);
        }

        //Sanjeewa 29-12-2015
        public DataTable getValuationDetails(DateTime _fromtDate, DateTime _totDate, string _ItemClasif, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _Stktype, string _Com, string _Loc, string _User)
        {
            OracleParameter[] param = new OracleParameter[16];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromtDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _totDate;
            (param[3] = new OracleParameter("in_clasif", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemClasif;
            (param[4] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[5] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[6] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[7] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[8] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[9] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[10] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[11] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[12] = new OracleParameter("in_stktype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Stktype;
            (param[13] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[14] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[15] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            return QueryDataTable("int_hdr", "sp_get_valuation_dtl", CommandType.StoredProcedure, false, param);
        }

        //Sanjeewa 08-06-2016
        public DataTable getDispatchAppDetails(DateTime _fromtDate, DateTime _totDate, string _ItemCode, string _Brand, string _Model, string _Cat1, string _Cat2, string _Cat3, string _Cat4, string _Cat5, string _Com, string _Loc, string _User)
        {
            OracleParameter[] param = new OracleParameter[14];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromtDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _totDate;
            (param[3] = new OracleParameter("in_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[4] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Brand;
            (param[5] = new OracleParameter("in_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Model;
            (param[6] = new OracleParameter("in_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat1;
            (param[7] = new OracleParameter("in_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat2;
            (param[8] = new OracleParameter("in_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat3;
            (param[9] = new OracleParameter("in_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat4;
            (param[10] = new OracleParameter("in_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Cat5;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[12] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Loc;
            (param[13] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            return QueryDataTable("int_hdr", "sp_get_disp_app_dtl", CommandType.StoredProcedure, false, param);
        }

        //Tharaka 2015-12-14
        public Int32 DEL_BL_COST(Int32 seqNUm)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seqNUm;
            param[1] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_DEL_BL_COST", CommandType.StoredProcedure, param);
            return result;
        }

        //Chamal 2015-12-16
        public List<CustomsProcedureCodes> GetCustomsProcedureCodes(string country, string com, string consigType, string consigCode, string docType, string procCode)
        {
            List<CustomsProcedureCodes> oResult = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_cogntp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = consigType;
            (param[3] = new OracleParameter("p_cogncd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = consigCode;
            (param[4] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docType;
            (param[5] = new OracleParameter("p_proccd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = procCode;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_getcustomsprocedurecodes", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<CustomsProcedureCodes>(dtTemp, CustomsProcedureCodes.Converter);
            return oResult;
        }

        //Sahan 28/Dec 2015
        public Int32 ModifyCusDecHeader(ImpCusdecHdr CusDecHeader)
        {
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_cuh_stl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_STL_NO;
            (param[1] = new OracleParameter("p_cuh_stl_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_STL_DT;
            (param[2] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_COM;
            (param[3] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_DOC_NO;
            (param[4] = new OracleParameter("p_cuh_stl_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_STL_STUS;
            (param[5] = new OracleParameter("p_cuh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_BY;
            (param[6] = new OracleParameter("p_cuh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_DT;
            (param[7] = new OracleParameter("p_cuh_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_SESSION;

            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 result = UpdateRecords("pkg_imports.sp_modify_cusdec_hdr", CommandType.StoredProcedure, param);
            return result;
        }

        //Sahan 28/Dec 2015
        public DataTable LoadSelectedEntryNos(string assessment_no)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = assessment_no;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_ast_det", "pkg_imports.load_selected_ent_no", CommandType.StoredProcedure, false, param);
        }

        //Sahan 28/Dec 2015
        public DataTable LoadEntriesByDate(DateTime from, DateTime to, string status)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = to;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _res = QueryDataTable("imp_ast_det", "pkg_imports.load_entries_by_date", CommandType.StoredProcedure, false, param);
            return _res;
        }

        //Sahan 28/Dec 2015
        public DataTable CountAssessmentTot(string entryno)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_istd_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_ast_det", "pkg_imports.count_ass_tot", CommandType.StoredProcedure, false, param);
        }

        //Sahan 28/Dec 2015
        public DataTable CalSettleTotbyEntry(string entryno)
        {
            OracleParameter[] param = new OracleParameter[2];

            (param[0] = new OracleParameter("p_istd_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_ast_det", "pkg_imports.count_stl_tot_entry", CommandType.StoredProcedure, false, param);
        }

        //Sahan 28/Dec 2015
        public Int32 ByPassCusDec(ImpCusdecHdr CusDecHeader)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[4];

            try
            {
                (param[0] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_DOC_NO;
                (param[1] = new OracleParameter("p_cuh_ast_ignore_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_IGNORE_BY;
                (param[2] = new OracleParameter("p_cuh_ast_ignore_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_IGNORE_DT;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("pkg_imports.sp_bypass_cusdec_", CommandType.StoredProcedure, param);
            }
            catch (Exception)
            {
                rows_affected = -1;
            }
            finally
            {
                ConnectionClose();
            }

            return rows_affected;
        }

        //Sahan 28/Dec 2015
        public DataTable LoadCustomsReimbursements(ImpCusdecHdr CusDecHeaders)
        {
            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeaders.CUH_DOC_NO;
            (param[1] = new OracleParameter("p_cuh_ast_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeaders.CUH_AST_NO;
            (param[2] = new OracleParameter("p_cuh_stl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeaders.CUH_STL_NO;
            (param[3] = new OracleParameter("p_cuh_cusdec_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeaders.CUH_CUSDEC_ENTRY_NO;
            (param[4] = new OracleParameter("p_cuh_ast_noties_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeaders.CUH_AST_NOTIES_NO;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_cusdec_hdr", "pkg_imports.sp_customs_reimbursements_load", CommandType.StoredProcedure, false, param);
        }

        //Sahan 29/Dec 2015
        public DataTable LoadAODDetailsWithItem(string entry, string com, string doctype, Int32 direction)
        {
            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_ith_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entry;
            (param[1] = new OracleParameter("p_ith_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_ith_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctype;
            (param[3] = new OracleParameter("p_ith_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = direction;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("int_hdr", "pkg_imports.load_aod_details_with_itm", CommandType.StoredProcedure, false, param);
        }

        //Sahan 29/Dec/2015
        public DataTable LoadEntryPopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _cusdecentryno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ENTRY NO":
                        _docno = _searchText;
                        break;

                    case "CUSDEC ENTRY NO":
                        _cusdecentryno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_cusdec_entry", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecentryno;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.load_entry_no_popup_crt", CommandType.StoredProcedure, false, param);
            // _dtResults = QueryDataTable("imp_cusdec_hdr", "load_entry_no_popup_crt_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 29/Dec/2015
        public DataTable LoadAssementPopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ASSESSMENT NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_ast_hdr", "pkg_imports.load_ass_no_popup_crt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 29/Dec/2015
        public DataTable LoadSettlementPopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SETTLEMENT NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ishd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ishd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.load_stl_no_popup_crt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 29/Dec/2015
        public DataTable LoadCusRefPopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "CUSDEC ENTRY NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cuh_cusdec_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.load_cus_ref_popup_crt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sahan 29/Dec/2015
        public DataTable LoadAssNoticePopUp(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ASSESS NOTICE NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cuh_ast_noties_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;

            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.load_ass_note_popup_crt", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Chamal 31-Dec-2015
        public Int32 SaveCusdecHdr(ImpCusdecHdr _cusdecHdr, out int _seqNo)
        {
            _seqNo = -1;
            OracleParameter[] param = new OracleParameter[112];
            (param[0] = new OracleParameter("P_CUH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_COM;
            (param[1] = new OracleParameter("P_CUH_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SBU;
            (param[2] = new OracleParameter("P_CUH_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CNTY;
            (param[3] = new OracleParameter("P_CUH_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TP;
            (param[4] = new OracleParameter("P_CUH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DOC_NO;
            (param[5] = new OracleParameter("P_CUH_OTH_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_OTH_NO;
            (param[6] = new OracleParameter("P_CUH_FIN_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_FIN_DOC_NO;
            (param[7] = new OracleParameter("P_CUH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DT.Date;
            (param[8] = new OracleParameter("P_CUH_PROC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PROC_CD;
            (param[9] = new OracleParameter("P_CUH_DECL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_1;
            (param[10] = new OracleParameter("P_CUH_DECL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_2;
            (param[11] = new OracleParameter("P_CUH_DECL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_3;
            (param[12] = new OracleParameter("P_CUH_SUPP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUPP_CD;
            (param[13] = new OracleParameter("P_CUH_CONSI_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CONSI_CD;
            (param[14] = new OracleParameter("P_CUH_DECL_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_CD;
            (param[15] = new OracleParameter("P_CUH_VESSEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_VESSEL;
            (param[16] = new OracleParameter("P_CUH_VOYAGE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_VOYAGE;
            (param[17] = new OracleParameter("P_CUH_VOYAGE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_VOYAGE_DT.Date;
            (param[18] = new OracleParameter("P_CUH_PLACE_OF_LOADING", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PLACE_OF_LOADING;
            (param[19] = new OracleParameter("P_CUH_OFFICE_OF_ENTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_OFFICE_OF_ENTRY;
            (param[20] = new OracleParameter("P_CUH_LOCATION_OF_GOODS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_LOCATION_OF_GOODS;
            (param[21] = new OracleParameter("P_CUH_PREFERENCE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PREFERENCE;
            (param[22] = new OracleParameter("P_CUH_ACC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_ACC_NO;
            (param[23] = new OracleParameter("P_CUH_FCL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_FCL;
            (param[24] = new OracleParameter("P_CUH_PAGE_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PAGE_1;
            (param[25] = new OracleParameter("P_CUH_PAGE_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PAGE_2;
            (param[26] = new OracleParameter("P_CUH_ITEMS_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_ITEMS_QTY;
            (param[27] = new OracleParameter("P_CUH_TOT_PKG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TOT_PKG;
            (param[28] = new OracleParameter("P_CUH_TOT_PKG_UNIT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TOT_PKG_UNIT;
            (param[29] = new OracleParameter("P_CUH_TOT_GROSS_MASS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TOT_GROSS_MASS;
            (param[30] = new OracleParameter("P_CUH_TOT_NET_MASS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TOT_NET_MASS;
            (param[31] = new OracleParameter("P_CUH_CITY_OF_LAST_CONSIGNEE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CITY_OF_LAST_CONSIGNEE;
            (param[32] = new OracleParameter("P_CUH_CNTY_OF_EXPORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CNTY_OF_EXPORT;
            (param[33] = new OracleParameter("P_CUH_CNTY_OF_ORIGIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CNTY_OF_ORIGIN;
            (param[34] = new OracleParameter("P_CUH_CNTY_OF_DESTINATION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CNTY_OF_DESTINATION;
            (param[35] = new OracleParameter("P_CUH_DELIVERY_TERMS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DELIVERY_TERMS;
            (param[36] = new OracleParameter("P_CUH_CUR_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUR_CD;
            (param[37] = new OracleParameter("P_CUH_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TOT_AMT;
            (param[38] = new OracleParameter("P_CUH_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_EX_RT;
            (param[39] = new OracleParameter("P_CUH_NATURE_OF_TRANCE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_NATURE_OF_TRANCE;
            (param[40] = new OracleParameter("P_CUH_TERMS_OF_PAYMENT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TERMS_OF_PAYMENT;
            (param[41] = new OracleParameter("P_CUH_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_BANK_CD;
            (param[42] = new OracleParameter("P_CUH_BANK_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_BANK_NAME;
            (param[43] = new OracleParameter("P_CUH_COM_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_COM_CHG;
            (param[44] = new OracleParameter("P_CUH_GRN_STAUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_GRN_STAUS;
            (param[45] = new OracleParameter("P_CUH_AOD_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AOD_STUS;
            (param[46] = new OracleParameter("P_CUH_ENTRY_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_ENTRY_NO;
            (param[47] = new OracleParameter("P_CUH_BL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_BL_NO;
            (param[48] = new OracleParameter("P_CUH_LISION_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_LISION_NO;
            (param[49] = new OracleParameter("P_CUH_WH_AND_PERIOD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_WH_AND_PERIOD;
            (param[50] = new OracleParameter("P_CUH_MARKS_AND_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_MARKS_AND_NO;
            (param[51] = new OracleParameter("P_CUH_BANK_REF_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_BANK_REF_CD;
            (param[52] = new OracleParameter("P_CUH_CONTAINER_FCL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CONTAINER_FCL;
            (param[53] = new OracleParameter("P_CUH_SUN_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUN_REQ_NO;
            (param[54] = new OracleParameter("P_CUH_SUN_BOND_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUN_BOND_NO;
            (param[55] = new OracleParameter("P_CUH_DOC_REC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DOC_REC_DT.Date;
            (param[56] = new OracleParameter("P_CUH_CUSDEC_ENTRY_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUSDEC_ENTRY_NO;
            (param[57] = new OracleParameter("P_CUH_CUSDEC_ENTRY_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUSDEC_ENTRY_DT.Date;
            (param[58] = new OracleParameter("P_CUH_BANK_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_BANK_BRANCH;
            (param[59] = new OracleParameter("P_CUH_BOI_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_BOI_VAL;
            (param[60] = new OracleParameter("P_CUH_IGNORE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_IGNORE;
            (param[61] = new OracleParameter("P_CUH_CUST_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUST_CD;
            (param[62] = new OracleParameter("P_CUH_DECL_SEQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_SEQ_NO;
            (param[63] = new OracleParameter("P_CUH_PPC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PPC_NO;
            (param[64] = new OracleParameter("P_CUH_PROCE_CD_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PROCE_CD_1;
            (param[65] = new OracleParameter("P_CUH_PROCE_CD_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_PROCE_CD_2;
            (param[66] = new OracleParameter("P_CUH_AST_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_STUS;
            (param[67] = new OracleParameter("P_CUH_AST_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_NO;
            (param[68] = new OracleParameter("P_CUH_AST_NOTIES_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_NOTIES_NO;
            (param[69] = new OracleParameter("P_CUH_AST_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_DT.Date;
            (param[70] = new OracleParameter("P_CUH_AST_IGNORE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_IGNORE;
            (param[71] = new OracleParameter("P_CUH_AST_IGNORE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_IGNORE_BY;
            (param[72] = new OracleParameter("P_CUH_AST_IGNORE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_AST_IGNORE_DT.Date;
            (param[73] = new OracleParameter("P_CUH_STL_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_STL_STUS;
            (param[74] = new OracleParameter("P_CUH_STL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_STL_NO;
            (param[75] = new OracleParameter("P_CUH_STL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_STL_DT.Date;
            (param[76] = new OracleParameter("P_CUH_CUS_ENTRY_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUS_ENTRY_USER;
            (param[77] = new OracleParameter("P_CUH_CUS_ENTRY_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUS_ENTRY_DT.Date;
            (param[78] = new OracleParameter("P_CUH_ADD_SERIALS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_ADD_SERIALS;
            (param[79] = new OracleParameter("P_CUH_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_REQ_NO;
            (param[80] = new OracleParameter("P_CUH_TRADING_COUNTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_TRADING_COUNTRY;
            (param[81] = new OracleParameter("P_CUH_INSU_TEXT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_INSU_TEXT;
            (param[82] = new OracleParameter("P_CUH_FREIGHT_TEXT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_FREIGHT_TEXT;
            (param[83] = new OracleParameter("P_CUH_MAIN_HS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_MAIN_HS;
            (param[84] = new OracleParameter("P_CUH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_STUS;
            (param[85] = new OracleParameter("P_CUH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CRE_BY;
            (param[86] = new OracleParameter("P_CUH_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CRE_SESSION;
            (param[87] = new OracleParameter("P_CUH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_MOD_BY;
            (param[88] = new OracleParameter("P_CUH_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_MOD_SESSION;
            (param[89] = new OracleParameter("P_CUH_SUPP_TIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUPP_TIN;
            (param[90] = new OracleParameter("P_CUH_SUPP_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUPP_NAME;
            (param[91] = new OracleParameter("P_CUH_SUPP_ADDR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUPP_ADDR;
            (param[92] = new OracleParameter("P_CUH_CONSI_TIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CONSI_TIN;
            (param[93] = new OracleParameter("P_CUH_CONSI_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CONSI_NAME;
            (param[94] = new OracleParameter("P_CUH_CONSI_ADDR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CONSI_ADDR;
            (param[95] = new OracleParameter("P_CUH_DECL_TIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_TIN;
            (param[96] = new OracleParameter("P_CUH_DECL_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_NAME;
            (param[97] = new OracleParameter("P_CUH_DECL_ADDR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DECL_ADDR;
            (param[98] = new OracleParameter("P_CUH_EXP_CNTY_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_EXP_CNTY_NAME;
            (param[99] = new OracleParameter("P_CUH_ORIGIN_CNTY_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_ORIGIN_CNTY_NAME;
            (param[100] = new OracleParameter("P_CUH_DESTI_CNTY_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_DESTI_CNTY_NAME;

            (param[101] = new OracleParameter("P_CUH_GROSS_MASS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_GROSS_MASS;
            (param[102] = new OracleParameter("P_CUH_NET_MASS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_NET_MASS;
            (param[103] = new OracleParameter("P_CUH_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_REF_NO;
            (param[104] = new OracleParameter("P_CUH_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_RMK;

            (param[105] = new OracleParameter("P_CUH_FILE_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_FILE_NO;
            (param[106] = new OracleParameter("P_CUH_CUSTOM_LC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_CUSTOM_LC_TP;
            (param[107] = new OracleParameter("P_CUH_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SUB_TP;
            (param[108] = new OracleParameter("P_CUH_FIN_SETTLE_TEXT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_FIN_SETTLE_TEXT;

            (param[109] = new OracleParameter("P_CUH_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecHdr.CUH_SEQ_NO; //if new document insert, this must be zero (0)
            param[110] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[111] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_imp_cusdec_hdr", CommandType.StoredProcedure, param);
            if (result > 0) _seqNo = Convert.ToInt32(param[110].Value.ToString());
            return result;
        }

        //Chamal 02-Jan-2015
        public Int32 SaveCusdecItem(ImpCusdecItm _cusdecItm)
        {
            OracleParameter[] param = new OracleParameter[46];
            (param[0] = new OracleParameter("P_CUI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_anal_1;
            (param[1] = new OracleParameter("P_CUI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_anal_2;
            (param[2] = new OracleParameter("P_CUI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_anal_3;
            (param[3] = new OracleParameter("P_CUI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_anal_4;
            (param[4] = new OracleParameter("P_CUI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_anal_5;
            (param[5] = new OracleParameter("P_CUI_BAL_QTY1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_bal_qty1;
            (param[6] = new OracleParameter("P_CUI_BAL_QTY2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_bal_qty2;
            (param[7] = new OracleParameter("P_CUI_BAL_QTY3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_bal_qty3;
            (param[8] = new OracleParameter("P_CUI_BL_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_bl_no;
            (param[9] = new OracleParameter("P_CUI_BL_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_bl_unit_rt;
            (param[10] = new OracleParameter("P_CUI_CAPACITY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_capacity;
            (param[11] = new OracleParameter("P_CUI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_cre_by;
            (param[12] = new OracleParameter("P_CUI_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_cre_session;
            (param[13] = new OracleParameter("P_CUI_DEF_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_def_cnty;
            (param[14] = new OracleParameter("P_CUI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_doc_no;
            (param[15] = new OracleParameter("P_CUI_FIN_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_fin_no;
            (param[16] = new OracleParameter("P_CUI_GROSS_MASS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_gross_mass;
            (param[17] = new OracleParameter("P_CUI_HS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_hs_cd;
            (param[18] = new OracleParameter("P_CUI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_itm_cd;
            (param[19] = new OracleParameter("P_CUI_ITM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_itm_desc;
            (param[20] = new OracleParameter("P_CUI_ITM_PRICE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_itm_price;
            (param[21] = new OracleParameter("P_CUI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_itm_stus;
            (param[22] = new OracleParameter("P_CUI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_kit_itm_cd;
            (param[23] = new OracleParameter("P_CUI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_kit_line;
            (param[24] = new OracleParameter("P_CUI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_line;
            (param[25] = new OracleParameter("P_CUI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_mod_by;
            (param[26] = new OracleParameter("P_CUI_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_mod_session;
            (param[27] = new OracleParameter("P_CUI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_model;
            (param[28] = new OracleParameter("P_CUI_NET_MASS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_net_mass;
            (param[29] = new OracleParameter("P_CUI_ORGIN_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_orgin_cnty;
            (param[30] = new OracleParameter("P_CUI_OTH_DOC_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_oth_doc_line;
            (param[31] = new OracleParameter("P_CUI_OTH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_oth_doc_no;
            (param[32] = new OracleParameter("P_CUI_PI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_pi_line;
            (param[33] = new OracleParameter("P_CUI_PI_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_pi_no;
            (param[34] = new OracleParameter("P_CUI_PI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_pi_unit_rt;
            (param[35] = new OracleParameter("P_CUI_PKGS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_pkgs;
            (param[36] = new OracleParameter("P_CUI_PREFERANCE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_preferance;
            (param[37] = new OracleParameter("P_CUI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_qty;
            (param[38] = new OracleParameter("P_CUI_QUOTA", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_quota;
            (param[39] = new OracleParameter("P_CUI_REQ_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_req_qty;
            (param[40] = new OracleParameter("P_CUI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_seq_no;
            (param[41] = new OracleParameter("P_CUI_TAG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_tag;
            (param[42] = new OracleParameter("P_CUI_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_tp;
            (param[43] = new OracleParameter("P_CUI_UNIT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_unit_amt;
            (param[44] = new OracleParameter("P_CUI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItm.Cui_unit_rt;
            param[45] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_IMP_CUSDEC_ITM", CommandType.StoredProcedure, param);
        }

        //Chamal 02-Jan-2015
        public Int32 SaveCusdecCost(ImpCusdecCost _cusdecCost)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("P_CUC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecCost.Cuc_seq_no;
            (param[1] = new OracleParameter("P_CUS_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_act;
            (param[2] = new OracleParameter("P_CUS_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_amt;
            (param[3] = new OracleParameter("P_CUS_AMT_COM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_amt_com;
            (param[4] = new OracleParameter("P_CUS_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_cre_by;
            (param[5] = new OracleParameter("P_CUS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_doc_no;
            (param[6] = new OracleParameter("P_CUS_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_ele_cat;
            (param[7] = new OracleParameter("P_CUS_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_ele_cd;
            (param[8] = new OracleParameter("P_CUS_ELE_CD_NAME", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_ele_cd_name;
            (param[9] = new OracleParameter("P_CUS_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_ele_tp;
            (param[10] = new OracleParameter("P_CUS_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecCost.Cus_line;
            param[11] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_IMP_CUSDEC_COST", CommandType.StoredProcedure, param);
        }
        //UPDATE TO BON BAL QTY SUBODANA
        public Int32 UpdateToBondBalQty(String doc, Int32 line, Int32 qty)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            (param[2] = new OracleParameter("P_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = qty;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_UPDATE_BALQTY1", CommandType.StoredProcedure, param);
        }

        public Int32 SaveReportErrorLog(string _erropt, string _errform, string _error, string _user)
        {//Sanjeewa 2016-07-20
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_err_option", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _erropt;
            (param[1] = new OracleParameter("p_err_form", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _errform;
            (param[2] = new OracleParameter("p_err_error", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _error;
            (param[3] = new OracleParameter("p_err_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_save_rpt_err_msg", CommandType.StoredProcedure, param);
        }

        public Int32 SaveBMUserLog(string _user, string _sel, string _where, DateTime _fdate, DateTime _tdate)
        {//Sanjeewa 2018-01-04
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("bmu_usr_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[1] = new OracleParameter("bmu_sel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sel;
            (param[2] = new OracleParameter("bmu_where", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _where;
            (param[3] = new OracleParameter("bmu_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("bmu_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_save_bm_user_log", CommandType.StoredProcedure, param);
        }
        public Int32 DeleteCusdecElementItems(int _cusdecSeqNo, int _costsheetSeqNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cusseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecSeqNo;
            (param[1] = new OracleParameter("p_costsheetseq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _costsheetSeqNo;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_del_cusdec_ele_itm", CommandType.StoredProcedure, param);
        }

        //Chamal 02-Jan-2015
        public Int32 SaveCusdecItmCost(ImpCusdecItmCost _cusdecItmCost)
        {
            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("P_CUIC_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_anal_1;
            (param[1] = new OracleParameter("P_CUIC_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_anal_2;
            (param[2] = new OracleParameter("P_CUIC_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_anal_3;
            (param[3] = new OracleParameter("P_CUIC_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_anal_4;
            (param[4] = new OracleParameter("P_CUIC_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_cre_by;
            (param[5] = new OracleParameter("P_CUIC_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_cre_session;
            (param[6] = new OracleParameter("P_CUIC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_doc_no;
            (param[7] = new OracleParameter("P_CUIC_ELE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_amt;
            (param[8] = new OracleParameter("P_CUIC_ELE_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_amt_claim;
            (param[9] = new OracleParameter("P_CUIC_ELE_BASE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_base;
            (param[10] = new OracleParameter("P_CUIC_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_cat;
            (param[11] = new OracleParameter("P_CUIC_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_cd;
            (param[12] = new OracleParameter("P_CUIC_ELE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_line;
            (param[13] = new OracleParameter("P_CUIC_ELE_MP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_mp;
            (param[14] = new OracleParameter("P_CUIC_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_rt;
            (param[15] = new OracleParameter("P_CUIC_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_tp;
            (param[16] = new OracleParameter("P_CUIC_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_itm_cd;
            (param[17] = new OracleParameter("P_CUIC_ITM_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_itm_line;
            (param[18] = new OracleParameter("P_CUIC_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_itm_stus;
            (param[19] = new OracleParameter("P_CUIC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_mod_by;
            (param[20] = new OracleParameter("P_CUIC_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_mod_session;
            (param[21] = new OracleParameter("P_CUIC_PRINT_ORDER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_print_order;
            (param[22] = new OracleParameter("P_CUIC_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_seq_no;
            (param[23] = new OracleParameter("P_CUIC_ELE_AMT_USD", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecItmCost.Cuic_ele_amt_usd;
            param[24] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_IMP_CUSDEC_ITM_COST", CommandType.StoredProcedure, param);
        }

        //Chamal 02-Jan-2015
        public Int32 SaveCusdecDutySum(ImpCusdecDutySum _cusdecDutySum)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_CUDS_COST_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_CAT;
            (param[1] = new OracleParameter("P_CUDS_COST_CLAIM_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_CLAIM_AMT;
            (param[2] = new OracleParameter("P_CUDS_COST_ELE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_ELE;
            (param[3] = new OracleParameter("P_CUDS_COST_ELE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_ELE_AMT;
            (param[4] = new OracleParameter("P_CUDS_COST_STL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_STL_AMT;
            (param[5] = new OracleParameter("P_CUDS_COST_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_TP;
            (param[6] = new OracleParameter("P_CUDS_COST_UNCLAIM_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_COST_UNCLAIM_AMT;
            (param[7] = new OracleParameter("P_CUDS_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_DOC_NO;
            (param[8] = new OracleParameter("P_CUDS_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _cusdecDutySum.CUDS_SEQ_NO;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_IMP_CUSDEC_DUTY_SUM", CommandType.StoredProcedure, param);
        }

        //Chamal 11-Mar-2016
        public int UpdateBLItemHS(string _docNo, Int32 _lineNo, string _hs, string _gross, string _net, string preff, string entry)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _lineNo;
            (param[2] = new OracleParameter("p_hscode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hs;
            (param[3] = new OracleParameter("p_gross", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gross;
            (param[4] = new OracleParameter("p_net", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _net;
            (param[5] = new OracleParameter("p_preff", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = preff;
            (param[6] = new OracleParameter("p_entry", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entry;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_update_bl_itm_hs", CommandType.StoredProcedure, param);
        }

        public List<HsCode> GetHSCodeList(string _hsCode)
        {
            List<HsCode> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_HS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hsCode;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tblInvoiceSearch", "pkg_imports_enquiry.SP_GET_HS_DATA_BY_HS_CODE", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<HsCode>(dtTemp, HsCode.Converter);
            return oResult;
        }

        //Chamal 08-Jan-2015
        public List<HsCodeClaim> GetHSCodeClaimList(string _hsCode)
        {
            List<HsCodeClaim> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_HS_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hsCode;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tblHSClaim", "pkg_imports_enquiry.SP_GET_HS_CLAIM_BY_CODE", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<HsCodeClaim>(dtTemp, HsCodeClaim.Converter);
            return oResult;
        }

        //Tharaka 2014-11-04
        public Int32 Update_ReqHeaderStatus(string STATUS, string USER, string COM, string MRN)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = STATUS;
            (param[1] = new OracleParameter("P_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = USER;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[3] = new OracleParameter("P_MRN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = MRN;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_UPDATE_INT_HDR_STUS", CommandType.StoredProcedure, param);
            return effects;
        }

        //Chamal 10-Jan-2015
        public int UPDATE_COST_SHEET_ITEM_ELEMENT(ImportsCostElementItem oItems)
        {
            OracleParameter[] param = new OracleParameter[29];
            (param[0] = new OracleParameter("P_ICE_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_seq_no;
            (param[1] = new OracleParameter("P_ICE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_line;
            (param[2] = new OracleParameter("P_ICE_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_doc_no;
            (param[3] = new OracleParameter("P_ICE_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_ref_line;
            (param[4] = new OracleParameter("P_ICE_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_stus;
            (param[5] = new OracleParameter("P_ICE_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_itm_cd;
            (param[6] = new OracleParameter("P_ICE_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_itm_stus;
            (param[7] = new OracleParameter("P_ICE_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_cat;
            (param[8] = new OracleParameter("P_ICE_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_tp;
            (param[9] = new OracleParameter("P_ICE_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_cd;
            (param[10] = new OracleParameter("P_ICE_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_ele_rt;
            (param[11] = new OracleParameter("P_ICE_ELE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_ele_amnt;
            (param[12] = new OracleParameter("P_ICE_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_rt;
            (param[13] = new OracleParameter("P_ICE_PRE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_amnt;
            (param[14] = new OracleParameter("P_ICE_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_rt;
            (param[15] = new OracleParameter("P_ICE_ACTL_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_amnt;
            (param[16] = new OracleParameter("P_ICE_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_rt;
            (param[17] = new OracleParameter("P_ICE_FINL_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_amnt;
            (param[18] = new OracleParameter("P_ICE_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_1;
            (param[19] = new OracleParameter("P_ICE_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_2;
            (param[20] = new OracleParameter("P_ICE_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_3;
            (param[21] = new OracleParameter("P_ICE_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_4;
            (param[22] = new OracleParameter("P_ICE_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_5;
            (param[23] = new OracleParameter("P_ICE_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_cre_by;
            (param[24] = new OracleParameter("P_ICE_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ice_cre_dt;
            (param[25] = new OracleParameter("P_ICE_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_mod_by;
            (param[26] = new OracleParameter("P_ICE_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ice_mod_dt;
            (param[27] = new OracleParameter("P_ICE_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_session_id;
            param[28] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_COSTSHEETITEM_ELE", CommandType.StoredProcedure, param);
        }

        //Tharaka 2016-01-16
        public int SAVE_IMP_CST_ELE_REF(imp_cst_ele_ref oItems)
        {
            OracleParameter[] param = new OracleParameter[19];
            (param[0] = new OracleParameter("P_ICER_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_seq_no;
            (param[1] = new OracleParameter("P_ICER_ELE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_ele_line;
            (param[2] = new OracleParameter("P_ICER_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_line;
            (param[3] = new OracleParameter("P_ICER_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_doc_no;
            (param[4] = new OracleParameter("P_ICER_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_ref_no;
            (param[5] = new OracleParameter("P_ICER_REF_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icer_ref_dt;
            (param[6] = new OracleParameter("P_ICER_REF_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icer_ref_amt;
            (param[7] = new OracleParameter("P_ICER_REF_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_ref_rmk;
            (param[8] = new OracleParameter("P_ICER_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_1;
            (param[9] = new OracleParameter("P_ICER_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_2;
            (param[10] = new OracleParameter("P_ICER_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_3;
            (param[11] = new OracleParameter("P_ICER_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_4;
            (param[12] = new OracleParameter("P_ICER_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_5;
            (param[13] = new OracleParameter("P_ICER_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_cre_by;
            (param[14] = new OracleParameter("P_ICER_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icer_cre_dt;
            (param[15] = new OracleParameter("P_ICER_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_mod_by;
            (param[16] = new OracleParameter("P_ICER_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icer_mod_dt;
            (param[17] = new OracleParameter("P_ICER_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_session_id;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_IMP_CST_ELE_REF", CommandType.StoredProcedure, param);
        }

        //Tharaka 2016-01-16
        public int DELETE_BY_SEQ(imp_cst_ele_ref oItems)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ICER_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_seq_no;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_DELETE_BY_SEQ", CommandType.StoredProcedure, param);
        }

        //Tharaka 2016-01-16
        public List<imp_cst_ele_ref> GET_IMP_CST_ELE_REF_BY_SEQ(Int32 SeQ)
        {
            List<imp_cst_ele_ref> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SeQ;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tblHSClaim", "SP_GET_IMP_CST_ELE_REF_BY_SEQ", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<imp_cst_ele_ref>(dtTemp, imp_cst_ele_ref.Converter);
            return oResult;
        }

        //Chamal 16-01-2016
        public int UPDATE_COST_SHEET_ITEM(ImportsCostItem oItems)
        {
            OracleParameter[] param = new OracleParameter[27];
            (param[0] = new OracleParameter("P_ICI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_seq_no;
            (param[1] = new OracleParameter("P_ICI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_line;
            (param[2] = new OracleParameter("P_ICI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_doc_no;
            (param[3] = new OracleParameter("P_ICI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_ref_line;
            (param[4] = new OracleParameter("P_ICI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_stus;
            (param[5] = new OracleParameter("P_ICI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_cd;
            (param[6] = new OracleParameter("P_ICI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_stus;
            (param[7] = new OracleParameter("P_ICI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_qty;
            (param[8] = new OracleParameter("P_ICI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_rt;
            (param[9] = new OracleParameter("P_ICI_UNIT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_amt;
            (param[10] = new OracleParameter("P_ICI_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_rt;
            (param[11] = new OracleParameter("P_ICI_PRE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_amt;
            (param[12] = new OracleParameter("P_ICI_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_rt;
            (param[13] = new OracleParameter("P_ICI_ACTL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_amt;
            (param[14] = new OracleParameter("P_ICI_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_rt;
            (param[15] = new OracleParameter("P_ICI_FINL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_amt;
            (param[16] = new OracleParameter("P_ICI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_1;
            (param[17] = new OracleParameter("P_ICI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_2;
            (param[18] = new OracleParameter("P_ICI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_3;
            (param[19] = new OracleParameter("P_ICI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_4;
            (param[20] = new OracleParameter("P_ICI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_5;
            (param[21] = new OracleParameter("P_ICI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_cre_by;
            (param[22] = new OracleParameter("P_ICI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_cre_dt;
            (param[23] = new OracleParameter("P_ICI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_mod_by;
            (param[24] = new OracleParameter("P_ICI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_mod_dt;
            (param[25] = new OracleParameter("P_ICI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_session_id;
            param[26] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_COSTSHEETITEM", CommandType.StoredProcedure, param);
            return result;
        }

        public int UPDATE_COST_SHEET_ELE_SUM(ImportsCostElement oItems)
        {
            OracleParameter[] param = new OracleParameter[22];
            (param[0] = new OracleParameter("P_ICET_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_seq_no;
            (param[1] = new OracleParameter("P_ICET_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_line;
            (param[2] = new OracleParameter("P_ICET_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_doc_no.Trim();
            (param[3] = new OracleParameter("P_ICET_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_stus;
            (param[4] = new OracleParameter("P_ICET_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cat;
            (param[5] = new OracleParameter("P_ICET_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_tp;
            (param[6] = new OracleParameter("P_ICET_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cd;
            (param[7] = new OracleParameter("P_ICET_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_ele_rt;
            (param[8] = new OracleParameter("P_ICET_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_pre_rt;
            (param[9] = new OracleParameter("P_ICET_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_actl_rt;
            (param[10] = new OracleParameter("P_ICET_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_finl_rt;
            (param[11] = new OracleParameter("P_ICET_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_1;
            (param[12] = new OracleParameter("P_ICET_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_2;
            (param[13] = new OracleParameter("P_ICET_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_3;
            (param[14] = new OracleParameter("P_ICET_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_4;
            (param[15] = new OracleParameter("P_ICET_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_5;
            (param[16] = new OracleParameter("P_ICET_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_cre_by;
            (param[17] = new OracleParameter("P_ICET_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_cre_dt;
            (param[18] = new OracleParameter("P_ICET_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_mod_by;
            (param[19] = new OracleParameter("P_ICET_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_mod_dt;
            (param[20] = new OracleParameter("P_ICET_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_session_id;
            param[21] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_COSTSHEETCOST", CommandType.StoredProcedure, param);
            return result;
        }

        //Tharaka 2016-01-16
        public List<ComboBoxObject> GET_PKG_UOM()
        {
            List<ComboBoxObject> oResult = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblHSClaim", "SP_GET_PKG_UOM", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
            {
                oResult = new List<ComboBoxObject>();
                for (int i = 0; i < dt.Rows.Count; i++)
                {
                    ComboBoxObject oitem = new ComboBoxObject();
                    oitem.Text = dt.Rows[i]["MSU_DESC"].ToString();
                    oitem.Value = dt.Rows[i]["MSUC_CD"].ToString();
                    oResult.Add(oitem);
                }
            }
            return oResult;
        }
        public List<ComboBoxObject> GET_AGGR_REF()
        {
            List<ComboBoxObject> oResult = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("tblHSClaim", "SP_GET_AGGRREF", CommandType.StoredProcedure, false, param);
            if (dt != null)
            {
                if (dt.Rows.Count > 0)
                {
                    oResult = new List<ComboBoxObject>();
                    for (int i = 0; i < dt.Rows.Count; i++)
                    {
                        ComboBoxObject oitem = new ComboBoxObject();
                        oitem.Text = dt.Rows[i]["MA_CODE"].ToString();
                        oitem.Value = dt.Rows[i]["MA_CODE"].ToString();
                        oResult.Add(oitem);
                    }
                }
            }
            return oResult;


        }

        //Tharaka 2016-01-16
        public List<ImportsCostItem> GET_PRIVIOUS_VALUES(string DocNumber, string Item)
        {
            List<ImportsCostItem> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocNumber;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tblHSClaim", "SP_GET_PRIVIOUS_VALUES", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<ImportsCostItem>(dtTemp, ImportsCostItem.Converter);
            return oResult;
        }

        //Chamal 2016-01-20
        public ImpCusdecHdr GET_CUSDEC_HEADER_BY_DOC(String com, String country, String doctp, string docno)
        {
            ImpCusdecHdr oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_cnty", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[2] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doctp;
            (param[3] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_imports.sp_get_cusdec_hdr", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecHdr>(dtTemp, ImpCusdecHdr.Converter)[0];
            return oResult;
        }

        //Chamal 2016-01-20
        public List<ImpCusdecItm> GET_CUSDEC_ITEM_BY_DOC(String docno)
        {
            List<ImpCusdecItm> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_imports.sp_get_cusdec_itm", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecItm>(dtTemp, ImpCusdecItm.Converter);
            return oResult;
        }
        public List<ImpCusdecItm> GET_CUSDEC_ITEM_BY_DOCNEW(String docno)
        {
            List<ImpCusdecItm> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_get_cusdec_itmnew", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecItm>(dtTemp, ImpCusdecItm.ConverterNew);
            return oResult;
        }
        //Chamal 2016-01-20
        public List<ImpCusdecItmCost> GET_CUSDEC_ITEM_COST_BY_DOC(String docno)
        {
            List<ImpCusdecItmCost> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_imports.sp_get_cusdec_itm_cost", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecItmCost>(dtTemp, ImpCusdecItmCost.Converter);
            return oResult;
        }

        //Chamal 2016-01-20
        public List<ImpCusdecCost> GET_CUSDEC_COST_BY_DOC(String docno)
        {
            List<ImpCusdecCost> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_imports.sp_get_cusdec_cost", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecCost>(dtTemp, ImpCusdecCost.Converter);
            return oResult;
        }

        //Chamal 2016-01-20
        public List<ImportsBLContainer> GET_IMP_BL_CONTNR_BY_BLNO(String blno)
        {
            List<ImportsBLContainer> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_bl_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_imports.sp_get_imp_bl_contnr_by_blno", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImportsBLContainer>(dtTemp, ImportsBLContainer.Converter);
            return oResult;
        }

        //Chamal 02/01/2016
        public DataTable Get_OFFICE_ENTRY(string country, string entryType, string entrySubType)
        {
            if (entryType == null && entrySubType == null)
            {
                DataTable _dtResults = null;
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("P_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _dtResults = QueryDataTable("tbl", "SP_GET_OFFICE_ENTRYNEW", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }
            else
            {
                DataTable _dtResults = null;
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("P_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
                (param[1] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryType;
                (param[2] = new OracleParameter("P_STP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entrySubType;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _dtResults = QueryDataTable("tbl", "SP_GET_CUSDEC_OFFICE_ENTRY", CommandType.StoredProcedure, false, param);
                return _dtResults;
            }


        }

        //Chamal 02/01/2016
        public DataTable Get_LOC_OF_GOODS(string country, string entryType, string entrySubType)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            (param[1] = new OracleParameter("P_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryType;
            (param[2] = new OracleParameter("P_STP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entrySubType;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_GET_CUSDEC_LOC_GOODS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Chamal 07/02/2016
        public List<ImportCostType> GET_MST_COST_TP(string cate)
        {
            List<ImportCostType> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cate;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_get_mst_cost_tp", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImportCostType>(dtTemp, ImportCostType.Converter);
            return oResult;
        }

        //Chamal 07/02/2016
        public CusdecCommon Get_CusdecCommon(string country)
        {
            CusdecCommon oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = country;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_CUSDEC_COMMON", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<CusdecCommon>(dtTemp, CusdecCommon.Converter)[0];
            return oResult;
        }


        //Tharaka 2016-02-08
        public ImpCusdecHdr GET_CUSTDEC_HDR_BY_DOC(String docno)
        {
            ImpCusdecHdr oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_CUSTDEC_HDR_BY_DOC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecHdr>(dtTemp, ImpCusdecHdr.Converter)[0];
            return oResult;
        }

        //Tharaka 2016-02-08
        public List<ImportsBLItems> GET_BL_ITM_BY_DOC_ITM(string Doc, String Item, string status)
        {
            List<ImportsBLItems> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Item;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_IMP_GET_BL_ITM_BY_DOC_ITM", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLItems>(dtTemp, ImportsBLItems.Converter);
            }
            return oResult;
        }

        //Tharaka 2016-02-10
        public DataTable GET_IMP_OTHER_CST(string Type)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "SP_GET_IMP_OTHER_CST", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharaka 2016-02-11
        public List<ComboBoxObject> GET_REF_CARY_TYPE()
        {
            List<ComboBoxObject> oResult = null;
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_REF_CARY_TYPE", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = new List<ComboBoxObject>();
                for (int i = 0; i < dtTemp.Rows.Count; i++)
                {
                    ComboBoxObject oitem = new ComboBoxObject();
                    oitem.Text = dtTemp.Rows[i]["rcta_desc"].ToString();
                    oitem.Value = dtTemp.Rows[i]["rcta_cd"].ToString();
                    oResult.Add(oitem);
                }
            }
            return oResult;
        }

        //Chamal 14-02-2016
        public int UPDATE_BL_HSCODES(string blDocNo, string itemcode, string hscode)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_bl_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blDocNo;
            (param[1] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            (param[2] = new OracleParameter("p_hscode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hscode;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("pkg_imports.sp_update_hs_bl", CommandType.StoredProcedure, param);
        }

        //Rukshan 09-Mar-2016
        public int UPDATE_BANK_ACC_BAL(string _com, string _bank, string _acc, decimal _amount, string status)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[2] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc;
            (param[3] = new OracleParameter("p_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amount;
            (param[4] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("pkg_imports.sp_update_bankaccount", CommandType.StoredProcedure, param);
        }

        //Lakshan 2016/03/11
        public int SAVE_IMP_CST_ELE_NEW(ImportsCostElement oItems, out String status)
        {
            OracleParameter[] param = new OracleParameter[23];
            (param[0] = new OracleParameter("P_ICET_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_seq_no;
            (param[1] = new OracleParameter("P_ICET_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_line;
            (param[2] = new OracleParameter("P_ICET_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_doc_no.Trim();
            (param[3] = new OracleParameter("P_ICET_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_stus;
            (param[4] = new OracleParameter("P_ICET_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cat;
            (param[5] = new OracleParameter("P_ICET_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_tp;
            (param[6] = new OracleParameter("P_ICET_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cd;
            (param[7] = new OracleParameter("P_ICET_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_ele_rt;
            (param[8] = new OracleParameter("P_ICET_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_pre_rt;
            (param[9] = new OracleParameter("P_ICET_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_actl_rt;
            (param[10] = new OracleParameter("P_ICET_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_finl_rt;
            (param[11] = new OracleParameter("P_ICET_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_1;
            (param[12] = new OracleParameter("P_ICET_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_2;
            (param[13] = new OracleParameter("P_ICET_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_3;
            (param[14] = new OracleParameter("P_ICET_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_4;
            (param[15] = new OracleParameter("P_ICET_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_5;
            (param[16] = new OracleParameter("P_ICET_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_cre_by;
            (param[17] = new OracleParameter("P_ICET_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_cre_dt;
            (param[18] = new OracleParameter("P_ICET_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_mod_by;
            (param[19] = new OracleParameter("P_ICET_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_mod_dt;
            (param[20] = new OracleParameter("P_ICET_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_session_id;
            param[21] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[22] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_IMP_CST_ELE_NEW", CommandType.StoredProcedure, param);
            status = string.Empty;

            if (result > 0)
            {
                status = param[21].Value.ToString();
            }
            return result;
        }
        //Darshana
        public DataTable Get_PerItemCostVal(string p_docNo, string p_itmCd, Int32 p_itmLine)
        {
            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_docNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_docNo;
            (param[1] = new OracleParameter("p_itmCd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_itmCd;
            (param[2] = new OracleParameter("p_itmLine", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_itmLine;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("imp_stl_det", "pkg_imports.sp_get_costing_rate", CommandType.StoredProcedure, false, param);
        }

        //Lakshan 2016 Mar 15
        public int SAVE_IMP_CST_HDR_NEW(ImportsCostHeader oItems, out Int32 Seq)
        {
            Seq = -1;
            OracleParameter[] param = new OracleParameter[28];
            (param[0] = new OracleParameter("P_ICH_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_seq_no;
            (param[1] = new OracleParameter("P_ICH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_com;
            (param[2] = new OracleParameter("P_ICH_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_tp;
            (param[3] = new OracleParameter("P_ICH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_doc_no;
            (param[4] = new OracleParameter("P_ICH_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_ref_no;
            (param[5] = new OracleParameter("P_ICH_PRE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_pre;
            (param[6] = new OracleParameter("P_ICH_PRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_pre_dt.Date;
            (param[7] = new OracleParameter("P_ICH_PRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_pre_by;
            (param[8] = new OracleParameter("P_ICH_PRE_SYSDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_pre_sysdt;
            (param[9] = new OracleParameter("P_ICH_ACTL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_actl;
            (param[10] = new OracleParameter("P_ICH_ACTL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_actl_dt.Date;
            (param[11] = new OracleParameter("P_ICH_ACTL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_actl_by;
            (param[12] = new OracleParameter("P_ICH_ACTL_SYSDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_actl_sysdt;
            (param[13] = new OracleParameter("P_ICH_FINL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_finl;
            (param[14] = new OracleParameter("P_ICH_FINL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_finl_dt.Date;
            (param[15] = new OracleParameter("P_ICH_FINL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_finl_by;
            (param[16] = new OracleParameter("P_ICH_FINL_SYSDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ich_finl_sysdt;
            (param[17] = new OracleParameter("P_ICH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_stus;
            (param[18] = new OracleParameter("P_ICH_IS_GRN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ich_is_grn;
            (param[19] = new OracleParameter("P_ICH_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_cur;
            (param[20] = new OracleParameter("P_ICH_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_1;
            (param[21] = new OracleParameter("P_ICH_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_2;
            (param[22] = new OracleParameter("P_ICH_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_3;
            (param[23] = new OracleParameter("P_ICH_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_4;
            (param[24] = new OracleParameter("P_ICH_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ich_anal_5;
            (param[25] = new OracleParameter("P_ICH_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ich_ex_rt;
            param[26] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[27] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_CST_HDR_NEW", CommandType.StoredProcedure, param);
            if (result > 0) Seq = Convert.ToInt32(param[26].Value.ToString());
            return result;
        }

        //Lakshan 2016 Mar 15
        public int SAVE_IMP_CST_ITM_NEW(ImportsCostItem oItems)
        {
            OracleParameter[] param = new OracleParameter[27];
            (param[0] = new OracleParameter("P_ICI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_seq_no;
            (param[1] = new OracleParameter("P_ICI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_line;
            (param[2] = new OracleParameter("P_ICI_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_doc_no;
            (param[3] = new OracleParameter("P_ICI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_ref_line;
            (param[4] = new OracleParameter("P_ICI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ici_stus;
            (param[5] = new OracleParameter("P_ICI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_cd;
            (param[6] = new OracleParameter("P_ICI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_itm_stus;
            (param[7] = new OracleParameter("P_ICI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_qty;
            (param[8] = new OracleParameter("P_ICI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_rt;
            (param[9] = new OracleParameter("P_ICI_UNIT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_unit_amt;
            (param[10] = new OracleParameter("P_ICI_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_rt;
            (param[11] = new OracleParameter("P_ICI_PRE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_pre_amt;
            (param[12] = new OracleParameter("P_ICI_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_rt;
            (param[13] = new OracleParameter("P_ICI_ACTL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_actl_amt;
            (param[14] = new OracleParameter("P_ICI_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_rt;
            (param[15] = new OracleParameter("P_ICI_FINL_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ici_finl_amt;
            (param[16] = new OracleParameter("P_ICI_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_1;
            (param[17] = new OracleParameter("P_ICI_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_2;
            (param[18] = new OracleParameter("P_ICI_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_3;
            (param[19] = new OracleParameter("P_ICI_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_4;
            (param[20] = new OracleParameter("P_ICI_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_anal_5;
            (param[21] = new OracleParameter("P_ICI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_cre_by;
            (param[22] = new OracleParameter("P_ICI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_cre_dt;
            (param[23] = new OracleParameter("P_ICI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_mod_by;
            (param[24] = new OracleParameter("P_ICI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ici_mod_dt;
            (param[25] = new OracleParameter("P_ICI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ici_session_id;
            param[26] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_CST_ITM_NEW", CommandType.StoredProcedure, param);
            return result;
        }

        //Lakshan 2016 Mar 15
        public int SAVE_IMP_CST_ELE_WEB_NEW(ImportsCostElement oItems, out String status)
        {
            OracleParameter[] param = new OracleParameter[23];
            (param[0] = new OracleParameter("P_ICET_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_seq_no;
            (param[1] = new OracleParameter("P_ICET_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_line;
            (param[2] = new OracleParameter("P_ICET_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_doc_no.Trim();
            (param[3] = new OracleParameter("P_ICET_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icet_stus;
            (param[4] = new OracleParameter("P_ICET_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cat;
            (param[5] = new OracleParameter("P_ICET_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_tp;
            (param[6] = new OracleParameter("P_ICET_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_ele_cd;
            (param[7] = new OracleParameter("P_ICET_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_ele_rt;
            (param[8] = new OracleParameter("P_ICET_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_pre_rt;
            (param[9] = new OracleParameter("P_ICET_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_actl_rt;
            (param[10] = new OracleParameter("P_ICET_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icet_finl_rt;
            (param[11] = new OracleParameter("P_ICET_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_1;
            (param[12] = new OracleParameter("P_ICET_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_2;
            (param[13] = new OracleParameter("P_ICET_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_3;
            (param[14] = new OracleParameter("P_ICET_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_4;
            (param[15] = new OracleParameter("P_ICET_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_anal_5;
            (param[16] = new OracleParameter("P_ICET_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_cre_by;
            (param[17] = new OracleParameter("P_ICET_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_cre_dt;
            (param[18] = new OracleParameter("P_ICET_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_mod_by;
            (param[19] = new OracleParameter("P_ICET_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icet_mod_dt;
            (param[20] = new OracleParameter("P_ICET_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icet_session_id;
            param[21] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[22] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.SP_SAVE_IMP_CST_ELE_NEW", CommandType.StoredProcedure, param);
            status = string.Empty;

            if (result > 0)
            {
                status = param[21].Value.ToString();
            }
            return result;
        }

        //Lakshan 17 Mar 2016
        public List<MST_COST_ELE> GET_COST_ELE_DATA(MST_COST_ELE _costEle)
        {
            List<MST_COST_ELE> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_mcae_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costEle.Mcae_com;
            (param[1] = new OracleParameter("p_mcae_ele_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costEle.Mcae_ele_tp;
            (param[2] = new OracleParameter("p_mcae_ele_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costEle.Mcae_ele_cat;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_imports.sp_get_cost_ele_data", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<MST_COST_ELE>(dtTemp, MST_COST_ELE.Converter);
            }
            return oResult;
        }

        public ImportsCostElement Get_cst_eleByTp(string _doc, Int32 _seq, string _eleCat, string _eleTp, string _eleCd, Int32 _stus)
        {
            ImportsCostElement oResult = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[2] = new OracleParameter("P_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eleCat;
            (param[3] = new OracleParameter("P_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eleTp;
            (param[4] = new OracleParameter("P_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _eleCd;
            (param[5] = new OracleParameter("P_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _stus;
            param[6] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_get_cst_ele_by_tp", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImportsCostElement>(dtTemp, ImportsCostElement.Converter)[0];
            return oResult;
        }

        public int SAVE_IMP_CST_ELE_ITM_APPLY(ImportsCostElementItem oItems, out String status)
        {
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("P_ICE_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_seq_no;
            (param[1] = new OracleParameter("P_ICE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_line;
            (param[2] = new OracleParameter("P_ICE_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_doc_no;
            (param[3] = new OracleParameter("P_ICE_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_ref_line;
            (param[4] = new OracleParameter("P_ICE_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Ice_stus;
            (param[5] = new OracleParameter("P_ICE_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_itm_cd;
            (param[6] = new OracleParameter("P_ICE_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_itm_stus;
            (param[7] = new OracleParameter("P_ICE_ELE_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_cat;
            (param[8] = new OracleParameter("P_ICE_ELE_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_tp;
            (param[9] = new OracleParameter("P_ICE_ELE_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_ele_cd;
            (param[10] = new OracleParameter("P_ICE_ELE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_ele_rt;
            (param[11] = new OracleParameter("P_ICE_ELE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_ele_amnt;
            (param[12] = new OracleParameter("P_ICE_PRE_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_rt;
            (param[13] = new OracleParameter("P_ICE_PRE_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_amnt;
            (param[14] = new OracleParameter("P_ICE_ACTL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_rt;
            (param[15] = new OracleParameter("P_ICE_ACTL_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_amnt;
            (param[16] = new OracleParameter("P_ICE_FINL_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_rt;
            (param[17] = new OracleParameter("P_ICE_FINL_AMNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_amnt;
            (param[18] = new OracleParameter("P_ICE_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_1;
            (param[19] = new OracleParameter("P_ICE_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_2;
            (param[20] = new OracleParameter("P_ICE_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_3;
            (param[21] = new OracleParameter("P_ICE_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_4;
            (param[22] = new OracleParameter("P_ICE_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_anal_5;
            (param[23] = new OracleParameter("P_ICE_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_cre_by;
            (param[24] = new OracleParameter("P_ICE_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ice_cre_dt;
            (param[25] = new OracleParameter("P_ICE_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_mod_by;
            (param[26] = new OracleParameter("P_ICE_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Ice_mod_dt;
            (param[27] = new OracleParameter("P_ICE_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Ice_session_id;
            (param[28] = new OracleParameter("P_ICE_PRE_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_pre_amt_claim;
            (param[29] = new OracleParameter("P_ICE_ACTL_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_actl_amt_claim;
            (param[30] = new OracleParameter("P_ICE_FINL_AMT_CLAIM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Ice_finl_amt_claim;
            param[31] = new OracleParameter("O_UPDATE_TYPE", OracleDbType.Int32, null, ParameterDirection.Output);
            param[32] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_cst_apply", CommandType.StoredProcedure, param);
            status = string.Empty;

            if (result > 0)
            {
                status = param[28].Value.ToString();
            }
            return result;
        }
        //darshana - 24-03-2016
        public List<ImportsCostItem> GET_IMP_URATE_FOR_CHA(Int32 Seq, Int32 Status)
        {
            List<ImportsCostItem> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Status;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "sp_get_urt_cha", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostItem>(dtTemp, ImportsCostItem.Converter);
            }
            return oResult;
        }

        //darshana - 24-03-2016
        public ImportsBLItems GET_BL_ITMBYITMLINE(string _docNo, Int32 _line)
        {
            ImportsBLItems oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docNo;
            (param[1] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _line;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "sp_get_blitmdet", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsBLItems>(dtTemp, ImportsBLItems.Converter)[0];
            }
            return oResult;
        }

        //Chamal 29-Mar-2016
        public DataTable GetEntryBaseAODQty(string _com, string _entryNo)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tblInvoiceItem", "sp_get_aodcusdecqty", CommandType.StoredProcedure, false, param);
        }

        //Lakshan 04 Apr 2016
        public DataTable LoadBondNumbersNew(string _initialSearchParams, string _searchCatergory, string _searchText, DateTime _fromdate, DateTime _Todate, int _isdate)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _entryno = null;
            string _othno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOCUMENT NO":
                        _docno = _searchText;
                        break;

                    case "ENTRY NO":
                        _entryno = _searchText;
                        break;

                    case "OTHER REF":
                        _othno = _searchText;
                        break;

                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;
            _entryno = (_entryno != null) ? ("%" + _entryno.ToUpper() + "%") : null;
            _othno = (_othno != null) ? (_othno.ToUpper()) : null;
            string status = (searchParams[1].ToString() != "") ? (searchParams[1].ToString().ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("p_cuh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cuh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[2] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[3] = new OracleParameter("p_cuh_cusdec_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryno;
            (param[4] = new OracleParameter("p_cuh_oth_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _othno;
            (param[5] = new OracleParameter("p_cuh_ast_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = searchParams[2].ToString();
            (param[6] = new OracleParameter("p_cuh_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[3].ToString();
            (param[7] = new OracleParameter("p_ITH_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[4].ToString();

            (param[8] = new OracleParameter("p_Fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[9] = new OracleParameter("p_Todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Todate;
            (param[10] = new OracleParameter("p_datesearch", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _isdate;
            param[11] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.sp_load_bond_numbers_new", CommandType.StoredProcedure, false, param);
            string _doctype = searchParams[4].ToString();
            if (_doctype == "DO")
            {
                foreach (DataRow row in _dtResults.Rows)
                {
                    string _value = row[0].ToString();
                    bool _result = GetBatchByRebone(_value, searchParams[0].ToString());
                    if (!_result)
                    {
                        row.Delete();
                    }
                }
                _dtResults.AcceptChanges();
            }
            return _dtResults;
        }

        //Lakshan  23 Apr 2016
        public Int32 UpdateCusDecHeaderStatus(ImpCusdecHdr CusDecHeader)
        {
            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_DOC_NO;
            (param[1] = new OracleParameter("p_cuh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_BY;
            (param[2] = new OracleParameter("p_cuh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_DT;
            (param[3] = new OracleParameter("p_cuh_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_MOD_SESSION;
            (param[4] = new OracleParameter("p_cuh_ast_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_STUS;
            (param[5] = new OracleParameter("p_cuh_ast_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_NO;
            (param[6] = new OracleParameter("p_cuh_ast_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_DT;
            (param[7] = new OracleParameter("p_cuh_ast_noties_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusDecHeader.CUH_AST_NOTIES_NO;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_imports.sp_update_imp_cusdec_hdr_sts", CommandType.StoredProcedure, param);
            return result;
        }

        //Chamal 24/Apr/2016
        public DataTable LoadBOIRequestByCustomer(string com, string cust, string type)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_custcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cust;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "sp_search_boi_req", CommandType.StoredProcedure, false, param);
        }


        //Chamal 16/Jun/2016
        public int Get_BL_Seq()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("sp_get_seq_imp", CommandType.StoredProcedure, param);

        }

        //Tharaka 2015-07-12
        public Int32 UPDATE_BL(ImportsBLHeader _BL)
        {
            OracleParameter[] param = new OracleParameter[7];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BL.Ib_doc_no;
            (param[1] = new OracleParameter("p_gurr_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _BL.Ib_gurr_no;
            (param[2] = new OracleParameter("p_issue_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BL.Ib_issue_date;
            (param[3] = new OracleParameter("p_ex_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BL.Ib_ex_date;
            (param[4] = new OracleParameter("p_is_cancel", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_BL.Ib_is_cancel);
            (param[5] = new OracleParameter("p_can_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _BL.Ib_cancel_date;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("pkg_imports.update_bl", CommandType.StoredProcedure, param);
            return effects;
        }

        //Rukshan 2016-06-18
        public ImpCusdecHdr GET_CUSTDECHDR_DOC(String docno)
        {
            ImpCusdecHdr oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_search_imp.SP_GET_CUSTDEC_HDR_BY_DOC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecHdr>(dtTemp, ImpCusdecHdr.Converter)[0];
            return oResult;
        }

        //Rukshan 2016-06-18
        public List<ImpCusdecItm> GET_CUSTDECITM_DOC(String docno)
        {
            List<ImpCusdecItm> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_search_imp.SP_GET_CUSTDEC_ITM_BY_DOC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImpCusdecItm>(dtTemp, ImpCusdecItm.Converter);
            }
            return oResult;
        }

        //Rukshan 2016-06-19
        public List<OrderPlanItem> GET_IMP_OPBY_PI(String DocNum)
        {
            List<OrderPlanItem> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = DocNum;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "pkg_search_imp.SP_GET_OPDETAILS_PI", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<OrderPlanItem>(dtTemp, OrderPlanItem.Converter);
            }
            return oResult;
        }
        #endregion

        public DataTable GetOrderPlanRef(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "SP_ORDERPLANREF", CommandType.StoredProcedure, false, param);
        }

        //Lakshan 20 Jul 2016
        public DataTable LoadEntryPopUpNew(string _initialSearchParams, DateTime dtFrom, DateTime dtTo, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;
            string _cusdecentryno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ENTRY NO":
                        _docno = _searchText;
                        break;

                    case "CUSDEC ENTRY NO":
                        _cusdecentryno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_cusdec_entry", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecentryno;
            (param[3] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtFrom;
            (param[4] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtTo;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //_dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.load_entry_no_popup_crt", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("imp_cusdec_hdr", "pkg_imports.load_entry_no_popup_crt_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "cuh_dt DESC";
                _dtResults = dv.ToTable();
            }
            _dtResults.Columns.Remove("cuh_dt");
            return _dtResults;
        }
        //Lakshan 20 Jul 2016
        public DataTable LoadAssementPopUpNew(string _initialSearchParams, DateTime dtFrom, DateTime dtTo, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "ASSESSMENT NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtFrom;
            (param[3] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtTo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("imp_ast_hdr", "pkg_imports.load_ass_no_popup_crt_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "isth_dt DESC";
                _dtResults = dv.ToTable();
            }
            _dtResults.Columns.Remove("isth_dt");
            return _dtResults;
        }

        //Lakshan 20 Jul 2016
        public DataTable LoadSettlementPopUpNew(string _initialSearchParams, DateTime dtFrom, DateTime dtTo, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "SETTLEMENT NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ishd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_ishd_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            (param[2] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtFrom;
            (param[3] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = dtTo;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.load_stl_no_popup_crt_new", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                DataView dv = _dtResults.DefaultView;
                dv.Sort = "ishd_stl_dt DESC";
                _dtResults = dv.ToTable();
            }
            _dtResults.Columns.Remove("ishd_stl_dt");
            return _dtResults;
        }

        //subodana 2016-07-26
        public List<SUN_JURNAL> GetSunJurnalnew(String Com)
        {
            List<SUN_JURNAL> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GETGRNALDATANEW", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<SUN_JURNAL>(dtTemp, SUN_JURNAL.Converter);
            }
            return oResult;
        }
        //subodana 2016-07-27
        public List<SUNINVHDR> GetSunInvdatanew(String Com, string pc, DateTime sdate, DateTime edate)
        {
            List<SUNINVHDR> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_PROCEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ST_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = sdate;
            (param[3] = new OracleParameter("P_END_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = edate;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (Com == "AAL" && pc.Contains("502"))
            {
                dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_SALESHDRSUNUPLOADAAL", CommandType.StoredProcedure, false, param);
            }
            else
            {
                dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_SALESHDRSUNUPLOAD", CommandType.StoredProcedure, false, param);
            }


            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<SUNINVHDR>(dtTemp, SUNINVHDR.Converter);
            }
            return oResult;
        }
        //subodana 2016-07-27
        public List<SUNRECIEPTHDR> GetSunRecieptdatanew(String Com, string pc, DateTime sdate, DateTime edate, string type)
        {
            List<SUNRECIEPTHDR> oResult = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_PROCEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[3] = new OracleParameter("P_ST_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = sdate;
            (param[4] = new OracleParameter("P_END_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = edate;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_GET_RECIPTHDRSUNUPLOAD", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<SUNRECIEPTHDR>(dtTemp, SUNRECIEPTHDR.Converter);
            }
            return oResult;
        }
        //subodana 2016-07-30
        public DataTable GetCusdechdrByBL(string com, string blno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_BLNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "SP_GET_CUSDECBYBL", CommandType.StoredProcedure, false, param);
        }

        //subodana 2016-07-30
        public int UpdateBLStatus(string com, string blno, string status)
        {

            OracleParameter[] param = new OracleParameter[4];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            (param[2] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updateBLStats", CommandType.StoredProcedure, param);

            return result;

        }

        public DataTable GetEntryReportDetails(DateTime _fromDate, DateTime _toDate, string _entryType, string _cusdecNo)
        {
            // Lakshika 03/Aug/2016
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_entryType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryType;
            (param[4] = new OracleParameter("in_cusdecNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cusdecNo;

            DataTable _result = QueryDataTable("entryrep", "sp_get_entry_rpt_details", CommandType.StoredProcedure, false, param);
            return _result;
        }


        //Rukshan 2016-8-06
        public List<ImpCusdecItm> GET_CUSDEC_GRNITEM_DOC(String docno, string _type = null)
        {
            List<ImpCusdecItm> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_otherno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "pkg_imports.sp_get_cusdec_grnitm", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecItm>(dtTemp, ImpCusdecItm.ConverterITMGRN);
            return oResult;
        }
        //subodana 2016-08-08
        public DataTable CheckLoctype(string com, string loccd, string loctype)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loccd;
            (param[2] = new OracleParameter("p_loctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loctype;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "SP_CHKLOCTYPE", CommandType.StoredProcedure, false, param);
        }

        //Lakshika 2016/Aug/09 - Validate Assmnt no
        public DataTable ValidateAssessmentNo(string _initialSearchParams, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            if (_initialSearchParams.Contains(":"))
            {
                string[] arr = _initialSearchParams.Split(new string[] { ":" }, StringSplitOptions.None);
                _initialSearchParams = arr[1];
            }

            string[] seperator = new string[] { "|" };
            string[] searchParams = _initialSearchParams.Split(seperator, StringSplitOptions.None);

            string _docno = null;

            if (!string.IsNullOrEmpty(_searchCatergory))
            {
                switch (_searchCatergory.ToUpper())
                {
                    case "DOC NO":
                        _docno = _searchText;
                        break;
                    default:
                        break;
                }
            }

            _docno = (_docno != null) ? (_docno.ToUpper()) : null;

            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_isth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchParams[0].ToString();
            (param[1] = new OracleParameter("p_isth_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _docno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.sp_validate_setle_docs", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }


        public bool GetBatchByRebone(string _doc, string _com)
        {
            bool resultvalue = false;
            OracleParameter[] param = new OracleParameter[3];
            DataTable _dtResults = null;
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("imp_stl_hdr", "pkg_imports.sp_getbatch_rebone", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                resultvalue = true;
            }
            return resultvalue;
        }

        //Rukshan 2016-08-10
        public decimal GET_CST_ITM_COST(String doc, Int32 line)
        {
            decimal _cost = 0;
            OracleParameter[] param = new OracleParameter[3];
            DataTable _dtResults = null;
            (param[0] = new OracleParameter("P_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("imp_stl_hdr", "SP_GET_IMP_CST_ITM_COST", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                _cost = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return _cost;
        }

        //Rukshan 2016-8-19
        public List<ImportsCostItem> GET_CUSDEC_EX_COST(string docno, string _com)
        {
            List<ImportsCostItem> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("P_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_IMP_EX_cost", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<ImportsCostItem>(dtTemp, ImportsCostItem.ConverterITMCOST);
            return oResult;
        }

        //Rukshan 2016-08-19
        public int UPDATE_IMP_CST_ACTAMOUNT(int Seq, int line, decimal _amount, string user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_ICI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_ICI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            (param[2] = new OracleParameter("P_AMOUNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amount;
            (param[3] = new OracleParameter("P_ICI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_imp_Actcst_itm", CommandType.StoredProcedure, param);
            return result;
        }

        //subodana 2016-09-01
        public DataTable GetSunPC(string type, string Com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "SP_GetSunPC", CommandType.StoredProcedure, false, param);
        }

        //subodana 2016-07-30
        public int UpdateOtherdocline(string entryno, Int32 lineno, string itemcode, Int32 upline)
        {

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_entry", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
            (param[2] = new OracleParameter("p_upline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = upline;
            (param[3] = new OracleParameter("p_itcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updateOtherdoclineno", CommandType.StoredProcedure, param);
            return result;

        }
        //subodana 2016-09-03
        public DataTable SP_GetGRNDOC(DateTime fromdate, DateTime todate, string com)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[1] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "SP_GetGRNDOC", CommandType.StoredProcedure, false, param);
        }
        //subodana 2016-09-05
        public List<LocPurSun> SP_GetLocPerSUN(string com, string grnno)
        {
            List<LocPurSun> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_grnno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = grnno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("boireq", "SP_GetLocPerSUN", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<LocPurSun>(dt, LocPurSun.Converter);
            return oResult;
        }

        //subodana 2016-09-15
        public List<Suncreditnote> SP_SUN_CREDNOTE(string com, DateTime fromdate, DateTime todate, string pc)
        {
            List<Suncreditnote> oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate.Date;
            (param[2] = new OracleParameter("P_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate.Date;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("boireq", "SUN_CREDNOTE", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<Suncreditnote>(dt, Suncreditnote.Converter);
            return oResult;
        }

        //subodana 2016-09-16
        public Int32 UPDATE_INV_HDRENGLOG(string invNo, Int32 value, string com)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SIH_INV_NO", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = invNo;
            (param[1] = new OracleParameter("P_SIH_ANAL_10", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("UPDATE_INV_SUNUPLOAD", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UPDATE_LOCPCH_HDRENGLOG(string grnno, Int32 value, string com)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SIH_GRN_NO", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = grnno;
            (param[1] = new OracleParameter("P_SIH_ANAL_12", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("UPDATE_LPCH_SUNUPLOAD", CommandType.StoredProcedure, param);

            return effects;
        }
        public Int32 UPDATE_RECIEPT_HDRENGLOG(string recNo, Int32 value, string com)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_REC_NO", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = recNo;
            (param[1] = new OracleParameter("P_ANAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("UPDATE_REC_SUNST", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable GetSaleDetailsInvoiceMain(DateTime _fromdate, DateTime _todate, string in_Company, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;


            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SALE_DETAILS_INV_MAIN", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshika 2016-09-26
        public DataTable GetStockAdjustmentSummary(DateTime _fromdate, DateTime _todate, string in_Company, string in_ad_team, string in_sub_type, string _user)
        {
            OracleParameter[] param = new OracleParameter[7];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_ad_team", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_ad_team;
            (param[5] = new OracleParameter("in_sub_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_sub_type;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_STOCK_ADJ_SUMMARY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshika 2016-09-26
        public DataTable GetSubTypesForAdjSummary(DateTime _fromdate, DateTime _todate, string in_Company, string in_ad_team, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_ad_team", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_ad_team;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SUBTYPES_STK_ADJ_SMRY", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2016-06-17
        public DataTable GetGoodsDeclarationDetails(string entryno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_GOODSDECLARATION", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana 2016-06-17
        public DataTable GetCusdecHDRData(string entryno, string com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "GetCusDecHDRDAta", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Lakshika 2016-10-03
        public DataTable GetSaleRepDetailsCatWise(DateTime _fromdate, DateTime _todate, string in_Company, string _user, string _groupCat)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("groupCat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _groupCat;

            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SALE_RPT_CAT_WISE", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-10-05
        public int GetBOIline(string doc, Int32 line)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            float _Value = (float)QueryFunction("fn_getboilineno", CommandType.StoredProcedure, param);
            return 1;
        }
        //subodana 2016-10-05
        public DataTable GetBOIlineDT(string doc, Int32 line)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GetBOILineNoDT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        ////SUBODANA 2016-10-06
        public int SaveSunLCCost(SunLC _obsunlcdata)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_sun_db", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.sun_db;
            (param[1] = new OracleParameter("p_category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.category;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.code;
            (param[3] = new OracleParameter("p_lookup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.lookup;
            (param[4] = new OracleParameter("p_updated", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.updated;
            (param[5] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.name;
            (param[6] = new OracleParameter("p_prohb_post", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.prohb_post;
            (param[7] = new OracleParameter("p_budget_check", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.budget_check;
            (param[8] = new OracleParameter("p_budget_stop", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.budget_stop;
            (param[9] = new OracleParameter("p_data_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.data_1;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_sunLC", CommandType.StoredProcedure, param);
            return result;
        }
        // 2016-10-06 SUBODANA
        public DataTable CheckSUNLC(string COM, string CAT, string CODE)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CAT;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SUNLCCOST", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Lakshika 2016-10-07
        public DataTable GetAgeOfRevertReportDtls(DateTime _fromdate, DateTime _todate, string in_Company, string _pc, string _brand, string _cat1, string _cat2, string _itemCode, string _user)
        {
            OracleParameter[] param = new OracleParameter[10];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromdate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _todate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_Company;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[6] = new OracleParameter("in_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[7] = new OracleParameter("in_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[8] = new OracleParameter("in_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemCode;
            (param[9] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            DataTable _dtResults = QueryDataTable("tbl", "GET_AGE_OF_REVERT_DETAILS", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //subodana 2016-10-10
        public DataTable GetMIDNO(string com, string pclist)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PROCEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pclist;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("GetCRCDMID", "GetCRCDMID", CommandType.StoredProcedure, false, param);
        }

        //subodana 2016-10-10
        public DataTable GetMIDRECIEPT(string com, string mid, DateTime fdate, DateTime tdate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mid;
            (param[2] = new OracleParameter("P_FRDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("GetCRCDMID", "GetCRCDRECIEPT", CommandType.StoredProcedure, false, param);
        }

        //subodana 2017-02-24
        public DataTable GetMIDRECIEPTAll(string com, string mid, DateTime fdate, DateTime tdate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mid;
            (param[2] = new OracleParameter("P_FRDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("GetCRCDMID", "GetCRCDRECIEPTALL", CommandType.StoredProcedure, false, param);
        }

        //SUBODANA 2016-10-11
        public Int32 InsertTo_sat_Adjcrecd(SAT_ADJ_CRCD _objadjust)
        {
            OracleParameter[] param = new OracleParameter[18];
            Int32 effects = 0;

            (param[0] = new OracleParameter("p_STAJ_SEQ", OracleDbType.Double, null, ParameterDirection.Input)).Value = _objadjust.staj_seq;
            (param[1] = new OracleParameter("p_STAJ_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_com;
            (param[2] = new OracleParameter("p_STAJ_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_pc;
            (param[3] = new OracleParameter("p_STAJ_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _objadjust.staj_dt.Date;
            (param[4] = new OracleParameter("p_STAJ_DIRECT", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _objadjust.staj_direct;
            (param[5] = new OracleParameter("p_STAJ_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_tp;
            (param[6] = new OracleParameter("p_STAJ_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_sub_tp;
            (param[7] = new OracleParameter("p_STAJ_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objadjust.staj_amt;
            (param[8] = new OracleParameter("p_STAJ_ACC_DBT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_acc_dbt;
            (param[9] = new OracleParameter("p_STAJ_ACC_CRD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_acc_crd;
            (param[10] = new OracleParameter("p_STAJ_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_rmk;
            (param[11] = new OracleParameter("p_STAJ_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_ref;
            (param[12] = new OracleParameter("p_STAJ_REF_SEQ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _objadjust.staj_ref_seq;
            (param[13] = new OracleParameter("p_STAJ_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_cre_by;
            (param[14] = new OracleParameter("P_STAJ_BANKCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_bankcd;
            (param[15] = new OracleParameter("P_STAJ_MIDNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _objadjust.staj_midno;
            (param[16] = new OracleParameter("P_STAJ_IS_UPLOAD", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _objadjust.staj_is_upload;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_INSERT_SAT_ADJCRCD", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Insert_SelectedPB(string _pb, string _pbdtl, string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int32 effects = 0;

            (param[0] = new OracleParameter("in_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[1] = new OracleParameter("in_pblvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pbdtl;
            (param[2] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_insert_rpt_pb", CommandType.StoredProcedure, param);
            return effects;
        }

        public Int32 Delete_SelectedPB(string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            Int32 effects = 0;

            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("sp_delete_rpt_pb", CommandType.StoredProcedure, param);
            return effects;
        }

        public DataTable get_SelectedPB(string _com, string _user)
        {
            OracleParameter[] param = new OracleParameter[3];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;

            return QueryDataTable("GetCRCDMID", "sp_get_rpt_pb", CommandType.StoredProcedure, false, param);
        }

        //subodana 2016-10-11
        public DataTable GetMIDDETAILS(string com, string pclist, string midno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PROCEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pclist;
            (param[2] = new OracleParameter("P_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = midno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("GetCRCDMID", "GetMIDDETAILS", CommandType.StoredProcedure, false, param);
        }

        //SUBODANA 2016-10-11
        public Int32 UPDATE_RECIEPT_BANKST(string recNo, Int32 value, string com, string mid)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_REC_NO", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = recNo;
            (param[1] = new OracleParameter("P_BANKVAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("P_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mid;
            param[4] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            ConnectionOpen();
            effects = (Int16)UpdateRecords("UPDATE_REC_BNKST", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2016-10-17
        public DataTable GenAssExel(DateTime fdate, DateTime tdate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_fdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[1] = new OracleParameter("p_tdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("exel", "sp_genassessexel", CommandType.StoredProcedure, false, param);
        }
        public Int32 SaveOPContanier(ImportsBLContainer orderplancontanier)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[10];
            try
            {
                (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_seq_no;
                (param[1] = new OracleParameter("p_ioc_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_line;
                (param[2] = new OracleParameter("p_ioc_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_doc_no;
                (param[3] = new OracleParameter("p_ioc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_tp;
                (param[4] = new OracleParameter("p_ioc_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_desc;
                (param[5] = new OracleParameter("p_ioc_units", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_unit;
                (param[6] = new OracleParameter("p_ioc_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_act;
                (param[7] = new OracleParameter("p_ioc_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_cre_by;
                (param[8] = new OracleParameter("p_ioc_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplancontanier.Ibc_cre_by;
                param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                ConnectionOpen();

                rows_affected = UpdateRecords("sp_place_order_container", CommandType.StoredProcedure, param);
            }
            catch (Exception ex)
            {
                rows_affected = -1;
            }

            return rows_affected;
        }

        //Ruskahn 2016-10-29
        public List<ImportsBLContainer> GETORDER_CONTENER(string doc)
        {
            List<ImportsBLContainer> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable dt = QueryDataTable("boireq", "SP_GETORDER_CONTAINER", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<ImportsBLContainer>(dt, ImportsBLContainer.Converter_ord);
            return oResult;
        }
        //SUBODANA 2016-11-09
        public List<TobondItemQty> GetTobondQty(String docno, Int32 lineno)
        {
            List<TobondItemQty> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_CHECKTOBONDQTY", CommandType.StoredProcedure, false, param);

            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<TobondItemQty>(dtTemp, TobondItemQty.Converter);
            }
            return oResult;
        }
        //SUBODANA 2016-11-09
        public List<TobondItemQty> GetEntryQty(String docno, Int32 lineno, string com)
        {
            List<TobondItemQty> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_lineno", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineno;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("IMP_OP_ITM", "SP_CHECKENTRYQTY", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<TobondItemQty>(dtTemp, TobondItemQty.Converter);
            }
            return oResult;
        }
        //subodana
        public decimal GetResQty(String sino, Int32 siline)
        {
            decimal qty = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_si_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            (param[1] = new OracleParameter("p_si_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = siline;
            param[2] = new OracleParameter("o_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("dt", "sp_validrestobondqty", CommandType.StoredProcedure, false, param);
            if (dtTemp != null && dtTemp.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(dtTemp.Rows[0][0].ToString()))
                {
                    qty = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                }
            }
            return qty;
        }

        //Lakshan 19 Dec 2016
        public Int32 UpdateImportsCostHeaderRefSave(ImportsCostHeader _obj, string _saveTP)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_ich_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ich_doc_no;
            (param[1] = new OracleParameter("p_ich_ref_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ich_ref_stus;
            (param[2] = new OracleParameter("p_ich_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ich_app_by;
            (param[3] = new OracleParameter("p_ich_app_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Ich_app_dt;
            (param[4] = new OracleParameter("p_ich_fin_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ich_fin_by;
            (param[5] = new OracleParameter("p_ich_fin_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Ich_fin_dt;
            (param[6] = new OracleParameter("p_ich_sav_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Ich_sav_by;
            (param[7] = new OracleParameter("p_ich_sav_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.Ich_sav_dt;
            (param[8] = new OracleParameter("p_save_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saveTP;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_update_imp_cst_hdr_ref", CommandType.StoredProcedure, param);
            return _eff;
        }


        //Sanjaya De Silva 20-Dec-2016
        public DataTable GetTotMonthSalesDataTable(string _com, string _pc, int _year, int _month, string _exCode, string _custCode)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[3] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[4] = new OracleParameter("p_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _exCode;
            (param[5] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_get_month_tot_sales", CommandType.StoredProcedure, false, param);
        }

        //Sanjaya De Silva 22-Dec-2016
        public DataTable GetMonthSalesDataTable(string _com, string _pc, int _year, int _month, string _exCode, string _custCode)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _year;
            (param[3] = new OracleParameter("p_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _month;
            (param[4] = new OracleParameter("p_ex_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _exCode;
            (param[5] = new OracleParameter("p_cus_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _custCode;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_get_exc_sales_det", CommandType.StoredProcedure, false, param);
        }
        //Tharaka 2016-01-16 add service provider by Lakshan
        public int SAVE_IMP_CST_ELE_REF_NEW(imp_cst_ele_ref oItems)
        {
            OracleParameter[] param = new OracleParameter[20];
            (param[0] = new OracleParameter("P_ICER_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_seq_no;
            (param[1] = new OracleParameter("P_ICER_ELE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_ele_line;
            (param[2] = new OracleParameter("P_ICER_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = oItems.Icer_line;
            (param[3] = new OracleParameter("P_ICER_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_doc_no;
            (param[4] = new OracleParameter("P_ICER_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_ref_no;
            (param[5] = new OracleParameter("P_ICER_REF_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icer_ref_dt;
            (param[6] = new OracleParameter("P_ICER_REF_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = oItems.Icer_ref_amt;
            (param[7] = new OracleParameter("P_ICER_REF_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_ref_rmk;
            (param[8] = new OracleParameter("P_ICER_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_1;
            (param[9] = new OracleParameter("P_ICER_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_2;
            (param[10] = new OracleParameter("P_ICER_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_3;
            (param[11] = new OracleParameter("P_ICER_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_4;
            (param[12] = new OracleParameter("P_ICER_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_anal_5;
            (param[13] = new OracleParameter("P_ICER_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_cre_by;
            (param[14] = new OracleParameter("P_ICER_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icer_cre_dt;
            (param[15] = new OracleParameter("P_ICER_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_mod_by;
            (param[16] = new OracleParameter("P_ICER_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = oItems.Icer_mod_dt;
            (param[17] = new OracleParameter("P_ICER_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_session_id;
            (param[18] = new OracleParameter("P_ICER_SER_PROVIDER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = oItems.Icer_ser_provider;
            param[19] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            return UpdateRecords("SP_SAVE_IMP_CST_ELE_REF_NEW", CommandType.StoredProcedure, param);
        }
        //subodana 2016-12-29
        public DataTable CusdecCancelIsGRN(string com, string entryno, int option)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (option == 1)
            {
                return QueryDataTable("tbl", "SP_CUSDEC_ISGRN", CommandType.StoredProcedure, false, param);
            }
            else if (option == 2)
            {
                return QueryDataTable("tbl", "SP_CUSDEC_ISCST", CommandType.StoredProcedure, false, param);
            }
            else if (option == 3)
            {
                return QueryDataTable("tbl", "SP_CUSDEC_ISENTRY", CommandType.StoredProcedure, false, param);
            }
            else if (option == 4)
            {
                return QueryDataTable("tbl", "SP_CUSDEC_ISPENDING", CommandType.StoredProcedure, false, param);
            }
            else
            {
                return QueryDataTable("tbl", "SP_REEXBOICANCELCHECK", CommandType.StoredProcedure, false, param);
            }

        }
        //subodana 2016-12-29
        public int Update_tbl_cusdec_cancel1(string com, string sino)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_up_blhdr_entrycancel", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2016-12-29
        public int Update_tbl_cusdec_cancel2(string com, string sino)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_up_csthdr_entrycancel", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2016-12-29
        public int Update_tbl_cusdec_cancel3(string com, string entry, string user)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_entryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entry;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_up_cushdr_entrycancel", CommandType.StoredProcedure, param);
            return result;
        }

        //subodana 2016-12-30
        public int Update_tbl_cusdec_cancel4(string com, string entryno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_up_req_entrycancel", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2016-12-30
        public int Update_tbl_cusdec_cancel5(string com, string sino)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_up_csthdr_entrycancel2", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2016-12-30
        public int Update_tbl_cusdec_itemqty(string doc, Int32 line, Int32 qty)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("p_itmline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            (param[2] = new OracleParameter("p_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = qty;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_up_csthdr_tobondbalqty", CommandType.StoredProcedure, param);
            return result;
        }

        //Sanjaya De Silva 2017-01-23
        public DataTable GetLocationsByCompDataTable(string _com, string _cate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tbl", "sp_getlocationbycat3_comp", CommandType.StoredProcedure, false, param);
        }

        //Akila 2017/01/24
        public DataTable GetCreditNoteInfo(string _comCode, string _profitCenter, string _creditNote)
        {
            DataTable _creditNoteInfo = new DataTable();

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_profCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_credNote", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _creditNote;
            param[3] = new OracleParameter("o_creditNoteInfo", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _creditNoteInfo = QueryDataTable("tbl_CreditNoteInfo", "sp_get_creditnotedet", CommandType.StoredProcedure, false, param);
            return _creditNoteInfo;
        }

        //Akila 2017/01/25
        public DataTable ActivateCreditNote(string _CreditNoteNo, string _status, string _userId)
        {
            OracleParameter[] _parameters = new OracleParameter[4];
            (_parameters[0] = new OracleParameter("CR_NT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNoteNo;
            (_parameters[1] = new OracleParameter("REQ_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;
            (_parameters[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userId;
            _parameters[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = new DataTable();
            _result = QueryDataTable("tbl_ActiveCrnDetails", "SP_CR_NOTE_ACTIVATE", CommandType.StoredProcedure, false, _parameters);
            return _result;
        }

        //Akila 2017/01/25
        public DataTable GetCreditNotesbyInvoice(string _invoiceNo)
        {
            OracleParameter[] _parameters = new OracleParameter[2];
            (_parameters[0] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invoiceNo;
            _parameters[1] = new OracleParameter("o_creditNotes", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = new DataTable();
            _result = QueryDataTable("tbl_CreditNote", "sp_getCreditNoteNo", CommandType.StoredProcedure, false, _parameters);
            return _result;
        }
        // Hushani Dinithi 2017-01-30
        public DataTable GetSalesDealersByCompDataTable(string _com, string _chnl)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tb1", "sp_getdealers", CommandType.StoredProcedure, false, param);

        }

        // Hushani 2017-02-01

        public DataTable GetModelDataTable(string _cat1, string _cat2, string _brand)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[1] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[2] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tb1", "sp_get_model", CommandType.StoredProcedure, false, param);

        }

        // Hushani 2017-02-02

        public DataTable GetShowroomTownByCompanyDataTable(string _com)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tb1", "sp_getShowroomTownByCompany", CommandType.StoredProcedure, false, param);

        }
        //subodana 2017-02-13
        public Int32 SaveCommissionHdr(ref_comm_hdr _commhdr, out int _seqNo)
        {
            _seqNo = -1;
            OracleParameter[] param = new OracleParameter[22];
            (param[0] = new OracleParameter("P_RCH_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _commhdr.Rch_seq;
            (param[1] = new OracleParameter("P_RCH_COMM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_comm_cd;
            (param[2] = new OracleParameter("P_RCH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_com;
            (param[3] = new OracleParameter("P_RCH_FROM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _commhdr.Rch_from_dt;
            (param[4] = new OracleParameter("P_RCH_TO_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _commhdr.Rch_to_dt;
            (param[5] = new OracleParameter("P_RCH_CALC_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_calc_type;
            (param[6] = new OracleParameter("P_RCH_SALES_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_sales_type;
            (param[7] = new OracleParameter("P_RCH_SETTL_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _commhdr.Rch_settl_period;
            (param[8] = new OracleParameter("P_RCH_COMM_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_comm_type;
            (param[9] = new OracleParameter("P_RCH_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _commhdr.Rch_act;
            (param[10] = new OracleParameter("P_RCH_COMM_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _commhdr.Rch_comm_per;
            (param[11] = new OracleParameter("P_RCH_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_anal1;
            (param[12] = new OracleParameter("P_RCH_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_anal2;
            (param[13] = new OracleParameter("P_RCH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_cre_by;
            (param[14] = new OracleParameter("P_RCH_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _commhdr.Rch_cre_dt;
            (param[15] = new OracleParameter("P_RCH_CRE_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_cre_session;
            (param[16] = new OracleParameter("P_RCH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_mod_by;
            (param[17] = new OracleParameter("P_RCH_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _commhdr.Rch_mod_dt;
            (param[18] = new OracleParameter("P_RCH_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_mod_session;
            (param[19] = new OracleParameter("P_RCH_COLLECT_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _commhdr.Rch_collect_tp;
            param[20] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[21] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_HDR", CommandType.StoredProcedure, param);
            if (result > 0) _seqNo = Convert.ToInt32(param[20].Value.ToString());
            return result;
        }
        //subodana 2017/02/14
        public int SaveCommissionDetails(ref_comm_det details)
        {
            OracleParameter[] param = new OracleParameter[19];
            (param[0] = new OracleParameter("P_RCD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.Rcd_seq;
            (param[1] = new OracleParameter("P_RCD_COMM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_comm_cd;
            (param[2] = new OracleParameter("P_RCD_ITEM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_item_cd;
            (param[3] = new OracleParameter("P_RCD_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_brand;
            (param[4] = new OracleParameter("P_RCD_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_cat1;
            (param[5] = new OracleParameter("P_RCD_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_cat2;
            (param[6] = new OracleParameter("P_RCD_ST_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = details.Rcd_st_val;
            (param[7] = new OracleParameter("P_RCD_END_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = details.Rcd_end_val;
            (param[8] = new OracleParameter("P_RCD_COMM_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = details.Rcd_comm_val;
            (param[9] = new OracleParameter("P_RCD_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_anal1;
            (param[10] = new OracleParameter("P_RCD_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_anal2;
            (param[11] = new OracleParameter("P_RCD_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.Rcd_line;
            (param[12] = new OracleParameter("P_RCD_INV_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_inv_tp;
            (param[13] = new OracleParameter("P_RCD_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_cat3;
            (param[14] = new OracleParameter("P_RCD_BTU_F", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_btu_f;
            (param[15] = new OracleParameter("P_RCD_BTU_E", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_btu_e;
            (param[16] = new OracleParameter("P_RCD_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_anal3;
            (param[17] = new OracleParameter("P_RCD_ANAL4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.Rcd_anal4;
            param[18] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_DET", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/02/15
        public int SaveCommissionEmpDetails(ref_comm_emp emp)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("P_RCE_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = emp.Rce_seq;
            (param[1] = new OracleParameter("P_RCE_COMM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp.Rce_comm_cd;
            (param[2] = new OracleParameter("P_RCE_EMP_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp.Rce_emp_type;
            (param[3] = new OracleParameter("P_RCE_COMMISSION", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = emp.Rce_commission;
            (param[4] = new OracleParameter("P_RCE_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp.Rce_anal1;
            (param[5] = new OracleParameter("P_RCE_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp.Rce_anal2;
            (param[6] = new OracleParameter("P_RCE_ST_DAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = emp.Rce_st_days;
            (param[7] = new OracleParameter("P_RCE_END_DAYS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = emp.Rce_end_days;
            (param[8] = new OracleParameter("P_RCE_BTU_INV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp.Rce_btu_inv;
            (param[9] = new OracleParameter("P_RCE_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = emp.Rce_anal3;
            param[10] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_EMP", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/02/15
        public int SaveCommissionPcDetails(ref_comm_pc pc)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_RCP_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pc.Rcp_seq;
            (param[1] = new OracleParameter("P_RCP_COMM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Rcp_comm_cd;
            (param[2] = new OracleParameter("P_RCP_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Rcp_pc;
            (param[3] = new OracleParameter("P_RCP_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Rcp_anal1;
            (param[4] = new OracleParameter("P_RCP_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc.Rcp_anal2;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_PC", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/02/15
        public int DeleteCommissionDetails(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_COMM_DET", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/02/15
        public int DeleteCommissionEmpDetails(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_COMM_EMP", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/02/15
        public int DeleteCommissionPcDetails(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_COMM_PC", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/02/17
        public List<ref_comm_hdr> GetCommissionHDR(String Com, string doc)
        {
            List<ref_comm_hdr> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMM_HDR", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_hdr>(dtTemp, ref_comm_hdr.Converter);
            }
            return oResult;
        }
        //subodana 2017/02/17
        public List<ref_comm_det> GetCommissionDetails(string doc)
        {
            List<ref_comm_det> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMMISSION_DETAILS", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_det>(dtTemp, ref_comm_det.Converter);
            }
            return oResult;
        }
        //subodana 2017/02/17
        public List<ref_comm_emp> GetCommissionEmp(string doc)
        {
            List<ref_comm_emp> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMMISSION_EMP", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_emp>(dtTemp, ref_comm_emp.Converter);
            }
            return oResult;
        }
        //subodana 2017/02/17
        public List<ref_comm_pc> GetCommissionPC(string doc)
        {
            List<ref_comm_pc> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMMISSION_PC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_pc>(dtTemp, ref_comm_pc.Converter);
            }
            return oResult;
        }
        //Lakshan 18 Feb 2017
        public List<MST_CONTAINER_TP> GET_MST_CONTAINER_TP_DATA(MST_CONTAINER_TP _obj)
        {
            List<MST_CONTAINER_TP> _list = new List<MST_CONTAINER_TP>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_mct_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.Mct_tp;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("mst_container_tp", "sp_get_mst_container_tp_data", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MST_CONTAINER_TP>(dtTemp, MST_CONTAINER_TP.Converter);
            }
            return _list;
        }
        //subodana 2017/02/20
        public List<ref_comm_hdr> GetCommissionByPC(string Com, string pc, DateTime fromdate, DateTime todate)
        {
            List<ref_comm_hdr> oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[3] = new OracleParameter("P_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_TRANS_COMM_CD", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_hdr>(dtTemp, ref_comm_hdr.Converter);
            }
            return oResult;
        }
        //subodana
        public List<Comm_recinv> GetCommRecInv(string Com, string pc, DateTime fromdate, DateTime todate)
        {
            List<Comm_recinv> oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[3] = new OracleParameter("P_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GETRECINV_COMM", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<Comm_recinv>(dtTemp, Comm_recinv.Converter);
            }
            return oResult;
        }

        public DataTable GetNoOfActAccountDetails(DateTime _fromDate, DateTime _toDate, string _User, string _com, string _pc)
        {
            // Sanjeewa 19-02-2013         
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_get_bi_act_accounts", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //2017-02/20 SUBODANA
        public DataTable GET_SETTLMNT_DT(string InvoiceNo, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvoiceNo;
            (param[1] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dt", "SP_GET_SETTL_DT", CommandType.StoredProcedure, false, param);
        }
        //2017-02/20 SUBODANA
        public DataTable GET_SETTLMNT_DTSRTN(string InvoiceNo, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvoiceNo;
            (param[1] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dt", "SP_GET_SETTL_DTSRTN", CommandType.StoredProcedure, false, param);
        }
        public DataTable GET_SETTLMNT_DT_FOR_BONUS(string InvoiceNo, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvoiceNo;
            (param[1] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("dt", "SP_GET_SETTL_DT_BONUS", CommandType.StoredProcedure, false, param);
        }
        public List<SalesForecastingDetail> GET_SALES_TARGET(string com, DateTime fdate, DateTime tdate, string pc, string exc)
        {
            List<SalesForecastingDetail> oResult = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("P_EXC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exc;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_SALES_TARGET", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<SalesForecastingDetail>(dtTemp, SalesForecastingDetail.Converter);
            }
            return oResult;
        }
        public List<SalesForecastingDetail> GET_SALES_TARGET_PC(string com, DateTime fdate, DateTime tdate, string pc, string exc)
        {
            List<SalesForecastingDetail> oResult = null;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[2] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("P_EXC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exc;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_SALES_TARGET_PC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<SalesForecastingDetail>(dtTemp, SalesForecastingDetail.Converter);
            }
            return oResult;
        }
        //Lakshan 22 Feb 2017
        public ImportsCostHeader GetImpCstHdrForGrn(string doc)
        {
            ImportsCostHeader oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_ich_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "sp_get_imp_cst_hdr_for_grn", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ImportsCostHeader>(dtTemp, ImportsCostHeader.Converter)[0];
            }
            return oResult;
        }


        // Hushani 2017-02-03
        public DataTable SearchShowroomTownDataTable(string _com, string cate3, string _searchCatergory, string _searchText)
        {
            DataTable _dtResults = null;

            string _comp = _com; // company name
            string _cate3 = cate3; // cate 3 ex: HESR
            string _townName = null;
            string _townCode = null;


            switch (_searchCatergory.ToUpper())
            {

                case "NAME":
                    _townName = _searchText;
                    break;

                case "CODE":
                    _townCode = _searchText;
                    break;

                default:
                    break;
            }


            _townName = (_townName != null) ? (_townName.ToUpper() + "%") : string.Empty;
            _townCode = (_townCode != null) ? (_townCode.ToUpper() + "%") : string.Empty;

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comp;
            (param[1] = new OracleParameter("p_cate3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cate3;
            (param[2] = new OracleParameter("p_townName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _townName;
            (param[3] = new OracleParameter("p_townCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _townCode;
            param[4] = new OracleParameter("o_searchDate", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tb1", "sp_searchShowroomTownBycompany", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public int SaveCommissionInvoices(Invoice_Commission _inv, DateTime fromdate, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[18];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.ProfitCenter;
            (param[1] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "EXEC";
            (param[2] = new OracleParameter("p_saec_emp_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.ExecCode;
            (param[3] = new OracleParameter("p_saec_emp_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.ExecCode;
            (param[4] = new OracleParameter("p_saec_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.InvoiceNo;
            (param[5] = new OracleParameter("p_saec_is_rev", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.isreversal;
            (param[6] = new OracleParameter("p_saec_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.FinalCommission;
            (param[7] = new OracleParameter("p_saec_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.taxammount;
            (param[8] = new OracleParameter("p_saec_discount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.discountammount;
            (param[9] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.commissioncode;
            (param[10] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.invoicedate.Year;
            (param[11] = new OracleParameter("p_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.invoicedate.Month;
            (param[12] = new OracleParameter("p_saec_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[13] = new OracleParameter("p_saec_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[14] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Item;
            (param[15] = new OracleParameter("p_saec_inv_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.TotValue;
            (param[16] = new OracleParameter("p_saec_emp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.ExecName;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_comm_inv", CommandType.StoredProcedure, param);
            return effects;
        }
        public int SaveCommissionEmployee(Invoice_Commission _inv, DateTime fromdate, DateTime todate)
        {
            OracleParameter[] param = new OracleParameter[18];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_saec_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.ProfitCenter;
            (param[1] = new OracleParameter("p_saec_emp_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.empcat;
            (param[2] = new OracleParameter("p_saec_emp_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.empcode;
            (param[3] = new OracleParameter("p_saec_emp_epf", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.empcode;
            (param[4] = new OracleParameter("p_saec_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.InvoiceNo;
            (param[5] = new OracleParameter("p_saec_is_rev", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.isreversal;
            (param[6] = new OracleParameter("p_saec_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.EmpCommission;
            (param[7] = new OracleParameter("p_saec_vat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.taxammount;
            (param[8] = new OracleParameter("p_saec_discount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.discountammount;
            (param[9] = new OracleParameter("p_circ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.commissioncode;
            (param[10] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.invoicedate.Year;
            (param[11] = new OracleParameter("p_mon", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inv.invoicedate.Month;
            (param[12] = new OracleParameter("p_saec_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[13] = new OracleParameter("p_saec_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[14] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.Item;
            (param[15] = new OracleParameter("p_saec_inv_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inv.TotValue;
            (param[16] = new OracleParameter("p_saec_emp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inv.ExecName;
            param[17] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_comm_inv", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2017-03-25
        public int UpdateCusdecEntryData(string Entry, string CusEntry, DateTime CusEntryDt)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_entry", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Entry;
            (param[1] = new OracleParameter("p_cusentryno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CusEntry;
            (param[2] = new OracleParameter("p_cusdecentrydt", OracleDbType.Date, null, ParameterDirection.Input)).Value = CusEntryDt;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updatecusdecentryno", CommandType.StoredProcedure, param);
            return result;

        }


        public DataTable GET_Commission_Details(DateTime fdate, DateTime tdate, string commcode, string userId, string pcstring)
        {
            DataTable _datatable = null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("P_FROM_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[1] = new OracleParameter("P_TO_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            (param[2] = new OracleParameter("P_CIRCULARCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commcode;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pcstring;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _datatable = QueryDataTable("dt", "SP_GET_CMSN_RPT_DETAILSNEW", CommandType.StoredProcedure, false, param);

            return _datatable;
        }

        public DataTable GET_Bonus_Details(DateTime fdate, DateTime tdate, string commcode, string userId, string pcstring)
        {
            DataTable _datatable = null;

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("P_FROM_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[1] = new OracleParameter("P_TO_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            (param[2] = new OracleParameter("P_CIRCULARCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commcode;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pcstring;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _datatable = QueryDataTable("dt", "sp_get_coll_bonus_det", CommandType.StoredProcedure, false, param);

            return _datatable;
        }
        //Udaya 05/04/2017
        public DataTable getInvoiceValues(string commcode, string proCenter, string invNo)
        {
            DataTable _datatable = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("commcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commcode;
            (param[1] = new OracleParameter("proCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = proCenter;
            (param[2] = new OracleParameter("invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _datatable = QueryDataTable("dtInv", "getInvoiceValues", CommandType.StoredProcedure, false, param);
            return _datatable;
        }

        //Udaya 06/04/2017
        public Int32 saveCreditNoteHdr(CreditNoteHdr _CreditNotesHdr)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[39];
            (param[0] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.Item;
            (param[1] = new OracleParameter("p_Description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.Description;
            (param[2] = new OracleParameter("p_Qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.Qty;
            (param[3] = new OracleParameter("p_UnitPrice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.UnitPrice;
            (param[4] = new OracleParameter("p_Total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.Total;
            (param[5] = new OracleParameter("p_DisRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.DisRate;
            (param[6] = new OracleParameter("p_DisAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.DisAmt;

            (param[7] = new OracleParameter("p_Tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.Tax;
            (param[8] = new OracleParameter("p_LineAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.LineAmt;
            (param[9] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.ComCode;
            (param[10] = new OracleParameter("p_ProfitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.ProfitCenter;
            (param[11] = new OracleParameter("p_CusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.CusCode;
            (param[12] = new OracleParameter("p_SalesExCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.SalesExCode;
            (param[13] = new OracleParameter("p_CreditNoteNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.CreditNoteNo;

            (param[14] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _CreditNotesHdr.Date;
            (param[15] = new OracleParameter("p_InvoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvoiceNo;
            (param[16] = new OracleParameter("p_InvoiceType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvoiceType;
            (param[17] = new OracleParameter("p_InvAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvAmt;
            (param[18] = new OracleParameter("p_InvAmtPaid", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvAmtPaid;
            (param[19] = new OracleParameter("p_InvAmtBal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvAmtBal;

            (param[20] = new OracleParameter("p_sessionCrtBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.sessionCreateBy;
            (param[21] = new OracleParameter("p_sessionCrtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _CreditNotesHdr.sessionCreateDate;
            (param[22] = new OracleParameter("p_sah_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.sessionCreateBy;
            (param[23] = new OracleParameter("p_sah_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _CreditNotesHdr.sessionCreateDate;
            (param[24] = new OracleParameter("p_SessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.SessionId;

            (param[25] = new OracleParameter("p_InvoiceSeqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvoiceSeqNo;

            (param[26] = new OracleParameter("p_CusName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.CusName;
            (param[27] = new OracleParameter("p_CusAdd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.CusAdd1;
            (param[28] = new OracleParameter("p_CusAdd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.CusAdd2;
            (param[29] = new OracleParameter("p_ReceiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.ReceiptNo;
            (param[30] = new OracleParameter("p_lineNo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.lineNo;
            (param[31] = new OracleParameter("p_InvoiceSubType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.InvSubType;

            (param[32] = new OracleParameter("p_managerCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.ManagerCode;
            (param[33] = new OracleParameter("p_sah_tax_inv", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.TaxInv;
            (param[34] = new OracleParameter("p_sah_tax_exempted", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.TaxExecpted;
            (param[35] = new OracleParameter("p_sah_is_svat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNotesHdr.IsSvat;
            (param[36] = new OracleParameter("p_sah_d_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.DCustName;
            (param[37] = new OracleParameter("p_sa_other_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNotesHdr.OtherAccount;
            param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("saveCreditNoteHdr", CommandType.StoredProcedure, param);

            return _eff;
        }
        //Udaya 13/05/2017
        public Int32 saveCreditNote(CreditNotes _CreditNote)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[36];
            (param[0] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.Item;
            (param[1] = new OracleParameter("p_Description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.Description;
            (param[2] = new OracleParameter("p_Qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.Qty;
            (param[3] = new OracleParameter("p_UnitPrice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.UnitPrice;
            (param[4] = new OracleParameter("p_Total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.Total;
            (param[5] = new OracleParameter("p_DisRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.DisRate;
            (param[6] = new OracleParameter("p_DisAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.DisAmt;

            (param[7] = new OracleParameter("p_Tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.Tax;
            (param[8] = new OracleParameter("p_LineAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.LineAmt;
            (param[9] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.ComCode;
            (param[10] = new OracleParameter("p_ProfitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.ProfitCenter;
            (param[11] = new OracleParameter("p_CusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.CusCode;
            (param[12] = new OracleParameter("p_SalesExCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.SalesExCode;
            (param[13] = new OracleParameter("p_CreditNoteNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.CreditNoteNo;

            (param[14] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _CreditNote.Date;
            (param[15] = new OracleParameter("p_InvoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.InvoiceNo;
            (param[16] = new OracleParameter("p_InvoiceType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.InvoiceType;
            (param[17] = new OracleParameter("p_InvAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.InvAmt;
            (param[18] = new OracleParameter("p_InvAmtPaid", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.InvAmtPaid;
            (param[19] = new OracleParameter("p_InvAmtBal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.InvAmtBal;

            (param[20] = new OracleParameter("p_sessionCrtBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.sessionCreateBy;
            (param[21] = new OracleParameter("p_sessionCrtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _CreditNote.sessionCreateDate;
            (param[22] = new OracleParameter("p_sah_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.sessionCreateBy;
            (param[23] = new OracleParameter("p_sah_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _CreditNote.sessionCreateDate;
            (param[24] = new OracleParameter("p_SessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.SessionId;

            (param[25] = new OracleParameter("p_InvoiceSeqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.InvoiceSeqNo;

            (param[26] = new OracleParameter("p_CusName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.CusName;
            (param[27] = new OracleParameter("p_CusAdd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.CusAdd1;
            (param[28] = new OracleParameter("p_CusAdd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.CusAdd2;
            (param[29] = new OracleParameter("p_ReceiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.ReceiptNo;
            (param[30] = new OracleParameter("p_lineNo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.lineNo;

            (param[31] = new OracleParameter("p_sad_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.sad_itm_stus;
            (param[32] = new OracleParameter("p_sad_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.sad_uom;
            (param[33] = new OracleParameter("p_ItemTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _CreditNote.ItemTp;
            (param[34] = new OracleParameter("p_TaxRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _CreditNote.TaxRate;
            param[35] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("saveCreditNote", CommandType.StoredProcedure, param);

            return _eff;
        }
        //subodana 2017/04/05
        public int SaveTargetBaseCommision(ref_comm_target targets)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_RCT_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = targets.rct_seq;
            (param[1] = new OracleParameter("P_RCT_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rct_docno;
            (param[2] = new OracleParameter("P_RCT_ST_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rct_st_val;
            (param[3] = new OracleParameter("P_RCT_END_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rct_end_val;
            (param[4] = new OracleParameter("P_RCT_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rct_rate;
            (param[5] = new OracleParameter("P_RCT_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rct_anal1;
            (param[6] = new OracleParameter("P_RCT_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rct_anal2;
            param[7] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_TARGET", CommandType.StoredProcedure, param);
            return result;
        }

        //Udaya 07/04/2017
        public DataTable getComDetails(string commcode)
        {
            DataTable _datatable = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_commcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = commcode;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _datatable = QueryDataTable("dtComDetails", "getComDetails", CommandType.StoredProcedure, false, param);
            return _datatable;
        }
        //Udaya 07/04/2017
        public int CreditNoteCancel(string invoiceNo, decimal amt, string sessiomModBy, DateTime sessiomModDate, string sessionId)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = amt;
            (param[2] = new OracleParameter("p_sessiomModBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessiomModBy;
            (param[3] = new OracleParameter("p_sessiomModDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = sessiomModDate;
            (param[4] = new OracleParameter("p_sessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_CreditNoteCancel", CommandType.StoredProcedure, param);
            return result;
        }

        //subodana 2017/04/05
        public int SaveCollectionBaseCommisionOvrt(ref_comm_collect_ovrt targets)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_RCCO_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = targets.rcco_seq;
            (param[1] = new OracleParameter("P_RCCO_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcco_docno;
            (param[2] = new OracleParameter("P_RCCO_EMP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcco_emp_cd;
            (param[3] = new OracleParameter("P_RCCO_EMP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcco_emp_cat;
            (param[4] = new OracleParameter("P_RCCO_INV_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcco_inv_tp;
            (param[5] = new OracleParameter("P_RCCO_ST_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcco_st_val;
            (param[6] = new OracleParameter("P_RCCO_END_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcco_end_val;
            (param[7] = new OracleParameter("P_RCCO_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcco_rate;
            (param[8] = new OracleParameter("P_RCCO_STL_ST_DT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcco_stl_st_dt;
            (param[9] = new OracleParameter("P_RCCO_STL_END_DT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcco_stl_end_dt;
            (param[10] = new OracleParameter("P_RCCO_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcco_anal1;
            (param[11] = new OracleParameter("P_RCCO_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcco_anal2;
            param[12] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_COLLECT_OVRT", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/04/05
        public List<ref_comm_target> GetCommissionTargetDetails(string doc)
        {
            List<ref_comm_target> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMMISSION_TARGET", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_target>(dtTemp, ref_comm_target.Converter);
            }
            return oResult;
        }
        //subodana 2017/04/05
        public List<ref_comm_target_ovrt> GetCommissionTargetOvtDetails(string doc)
        {
            List<ref_comm_target_ovrt> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMMISSION_TARGET_OVRT", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_target_ovrt>(dtTemp, ref_comm_target_ovrt.Converter);
            }
            return oResult;
        }
        //subodana 2017/04/05
        public List<ref_comm_collect_ovrt> GetCommissionCollectionOvtDetails(string doc)
        {
            List<ref_comm_collect_ovrt> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_COMMISSION_COLLECT_OVRT", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_collect_ovrt>(dtTemp, ref_comm_collect_ovrt.Converter);
            }
            return oResult;
        }
        //subodana 2017/04/05
        public int DeleteCommissionTarget(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_COMM_TARGET", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/04/05
        public int DeleteCommissionTargetOvt(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_COMM_TARGET_OVT", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/04/05
        public int DeleteCommissionCollectionOvt(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_COMM_COLL_OVT", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/04/08
        public List<sat_settl_discount> GetSettleDiscountDetails(string com, string pc, string invtype)
        {
            List<sat_settl_discount> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_INV_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invtype;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_SETTL_DISCOUNT", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<sat_settl_discount>(dtTemp, sat_settl_discount.Converter);
            }
            return oResult;
        }
        //subodana 2017/04/05
        public int SaveTargetBaseCommisionOvrt(ref_comm_target_ovrt targets)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_RCTO_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = targets.rcto_seq;
            (param[1] = new OracleParameter("P_RCTO_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcto_docno;
            (param[2] = new OracleParameter("P_RCTO_EMP_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcto_emp_cd;
            (param[3] = new OracleParameter("P_RCTO_EMP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcto_emp_cat;
            (param[4] = new OracleParameter("P_RCTO_ST_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcto_st_val;
            (param[5] = new OracleParameter("P_RCTO_END_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcto_end_val;
            (param[6] = new OracleParameter("P_RCTO_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcto_rate;
            (param[7] = new OracleParameter("P_RCTO_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcto_anal1;
            (param[8] = new OracleParameter("P_RCTO_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = targets.rcto_anal2;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_COMM_TRGT_OVRT", CommandType.StoredProcedure, param);
            return result;
        }
        //Udaya 07/06/2017
        public Int32 saveDebitNoteHdr(DebitNoteHdr _DebitNotesHdr)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[39];
            (param[0] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.Item;
            (param[1] = new OracleParameter("p_Description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.Description;
            (param[2] = new OracleParameter("p_Qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.Qty;
            (param[3] = new OracleParameter("p_UnitPrice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.UnitPrice;
            (param[4] = new OracleParameter("p_Total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.Total;
            (param[5] = new OracleParameter("p_DisRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.DisRate;
            (param[6] = new OracleParameter("p_DisAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.DisAmt;

            (param[7] = new OracleParameter("p_Tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.Tax;
            (param[8] = new OracleParameter("p_LineAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.LineAmt;
            (param[9] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.ComCode;
            (param[10] = new OracleParameter("p_ProfitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.ProfitCenter;
            (param[11] = new OracleParameter("p_CusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.CusCode;
            (param[12] = new OracleParameter("p_SalesExCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.SalesExCode;
            (param[13] = new OracleParameter("p_DebitNoteNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.DebitNoteNo;

            (param[14] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _DebitNotesHdr.Date;
            (param[15] = new OracleParameter("p_InvoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvoiceNo;
            (param[16] = new OracleParameter("p_InvoiceType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvoiceType;
            (param[17] = new OracleParameter("p_InvAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvAmt;
            (param[18] = new OracleParameter("p_InvAmtPaid", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvAmtPaid;
            (param[19] = new OracleParameter("p_InvAmtBal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvAmtBal;

            (param[20] = new OracleParameter("p_sessionCrtBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.sessionCreateBy;
            (param[21] = new OracleParameter("p_sessionCrtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _DebitNotesHdr.sessionCreateDate;
            (param[22] = new OracleParameter("p_sah_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.sessionCreateBy;
            (param[23] = new OracleParameter("p_sah_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _DebitNotesHdr.sessionCreateDate;
            (param[24] = new OracleParameter("p_SessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.SessionId;

            (param[25] = new OracleParameter("p_InvoiceSeqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvoiceSeqNo;

            (param[26] = new OracleParameter("p_CusName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.CusName;
            (param[27] = new OracleParameter("p_CusAdd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.CusAdd1;
            (param[28] = new OracleParameter("p_CusAdd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.CusAdd2;
            (param[29] = new OracleParameter("p_ReceiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.ReceiptNo;
            (param[30] = new OracleParameter("p_lineNo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.lineNo;
            (param[31] = new OracleParameter("p_InvoiceSubType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.InvSubType;

            (param[32] = new OracleParameter("p_managerCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.ManagerCode;
            (param[33] = new OracleParameter("p_sah_tax_inv", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.TaxInv;
            (param[34] = new OracleParameter("p_sah_tax_exempted", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.TaxExecpted;
            (param[35] = new OracleParameter("p_sah_is_svat", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotesHdr.IsSvat;
            (param[36] = new OracleParameter("p_sah_d_cust_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.DCustName;
            (param[37] = new OracleParameter("p_sa_other_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotesHdr.OtherAccount;
            param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("saveDeditNoteHdr", CommandType.StoredProcedure, param);

            return _eff;
        }

        //Udaya 11/04/2017
        public Int32 saveDebitNote(DebitNotes _DebitNotes)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[36];
            (param[0] = new OracleParameter("p_Item", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.Item;
            (param[1] = new OracleParameter("p_Description", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.Description;
            (param[2] = new OracleParameter("p_Qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.Qty;
            (param[3] = new OracleParameter("p_UnitPrice", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.UnitPrice;
            (param[4] = new OracleParameter("p_Total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.Total;
            (param[5] = new OracleParameter("p_DisRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.DisRate;
            (param[6] = new OracleParameter("p_DisAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.DisAmt;

            (param[7] = new OracleParameter("p_Tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.Tax;
            (param[8] = new OracleParameter("p_LineAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.LineAmt;
            (param[9] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.ComCode;
            (param[10] = new OracleParameter("p_ProfitCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.ProfitCenter;
            (param[11] = new OracleParameter("p_CusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.CusCode;
            (param[12] = new OracleParameter("p_SalesExCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.SalesExCode;
            (param[13] = new OracleParameter("p_CreditNoteNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.DebitNoteNo;

            (param[14] = new OracleParameter("p_Date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _DebitNotes.Date;
            (param[15] = new OracleParameter("p_InvoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.InvoiceNo;
            (param[16] = new OracleParameter("p_InvoiceType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.InvoiceType;
            (param[17] = new OracleParameter("p_InvAmt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.InvAmt;
            (param[18] = new OracleParameter("p_InvAmtPaid", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.InvAmtPaid;
            (param[19] = new OracleParameter("p_InvAmtBal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.InvAmtBal;

            (param[20] = new OracleParameter("p_sessionCrtBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.sessionCreateBy;
            (param[21] = new OracleParameter("p_sessionCrtDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _DebitNotes.sessionCreateDate;
            (param[22] = new OracleParameter("p_sah_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.sessionCreateBy;
            (param[23] = new OracleParameter("p_sah_mod_when", OracleDbType.Date, null, ParameterDirection.Input)).Value = _DebitNotes.sessionCreateDate;
            (param[24] = new OracleParameter("p_SessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.SessionId;

            (param[25] = new OracleParameter("p_InvoiceSeqNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.InvoiceSeqNo;

            (param[26] = new OracleParameter("p_CusName", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.CusName;
            (param[27] = new OracleParameter("p_CusAdd1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.CusAdd1;
            (param[28] = new OracleParameter("p_CusAdd2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.CusAdd2;
            (param[29] = new OracleParameter("p_ReceiptNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.ReceiptNo;
            (param[30] = new OracleParameter("p_lineNo", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.lineNo;
            (param[31] = new OracleParameter("p_sad_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.sad_itm_stus;
            (param[32] = new OracleParameter("p_sad_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.sad_uom;
            (param[33] = new OracleParameter("p_ItemTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _DebitNotes.ItemTp;
            (param[34] = new OracleParameter("p_TaxRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _DebitNotes.TaxRate;
            param[35] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("saveDebitNote", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Udaya 11/04/2017
        public int DebitNoteCancel(string invoiceNo, decimal amt, string sessiomModBy, DateTime sessiomModDate, string sessionId)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_invoiceNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invoiceNo;
            (param[1] = new OracleParameter("p_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = amt;
            (param[2] = new OracleParameter("p_sessiomModBy", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessiomModBy;
            (param[3] = new OracleParameter("p_sessiomModDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = sessiomModDate;
            (param[4] = new OracleParameter("p_sessionId", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionId;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_DebitNoteCancel", CommandType.StoredProcedure, param);
            return result;
        }

        // Hushani 2017-04-17
        public DataTable GetShowroomTownByCompanyAndCat3DataTable(string _com, string _act, string _ref, string _cat2, string _cat3)
        {

            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _act;
            (param[2] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[3] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[4] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tb1", "getShowroomByCat3AndCompany", CommandType.StoredProcedure, false, param);
        }

        //SUBODANA 2017-04-20
        public List<InvoiceHeader> GET_OUTSTNDING_INVS(string com, string pc, string invtype)
        {
            List<InvoiceHeader> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_INVTYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invtype;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_OUTSTANDINGINVOICES", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<InvoiceHeader>(dtTemp, InvoiceHeader.ConvertTotal);
            }
            return oResult;
        }
        //subodana 2017/04/21
        public int SavePenaltyInvoiceLog(Penalty_Invoice inv)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_SPIL_INV_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv.spil_inv_no;
            (param[1] = new OracleParameter("P_SPIL_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = inv.spil_rate;
            (param[2] = new OracleParameter("P_SPIL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv.spil_cre_by;
            (param[3] = new OracleParameter("P_SPIL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = inv.spil_cre_dt;
            (param[4] = new OracleParameter("P_SPIL_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = inv.spil_date;
            (param[5] = new OracleParameter("P_SPIL_FROM_DT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inv.spil_from_dt;
            (param[6] = new OracleParameter("P_SPIL_TO_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = inv.spil_to_date;
            (param[7] = new OracleParameter("P_SPIL_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv.spil_session;
            param[8] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_SAT_INV_LOG", CommandType.StoredProcedure, param);
            return result;
        }
        //SUBODANA 2017-04-20
        public List<Penalty_Invoice> GET_PNLTYLOG_INVS(string inv, DateTime dt)
        {
            List<Penalty_Invoice> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INV", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = inv;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = dt;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_PENALTY_LOG", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<Penalty_Invoice>(dtTemp, Penalty_Invoice.Converter);
            }
            return oResult;
        }

        // HUSHANI - 2017- 04-26
        public DataTable GET_ALL_DISTRIC()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbldata", "sp_getAllDist", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Add by lakshan 27 Apr 2017
        public List<ImportPIDetails> GET_IMP_PI_ITM_FOR_SI_SAVE(String IPI_PI_NO, string IPI_ITM_CD)
        {
            List<ImportPIDetails> pid = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_ipi_pi_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IPI_PI_NO;
            (param[1] = new OracleParameter("p_ipi_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = IPI_ITM_CD;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = QueryDataTable("IMP_PI_ITM", "sp_get_imp_pi_itm_for_bl_save", CommandType.StoredProcedure, false, param);
            pid = DataTableExtensions.ToGenericList<ImportPIDetails>(dt, ImportPIDetails.Converter);
            return pid;
        }
        //Add by Lakshan 05 May 2017 get copy from GetReturnCheques
        public DataTable GetReturnChequesNew(string _loc, string _ref, string _bCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[1] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[2] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bCode;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "get_return_cheque_new", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //SUBODANA 2017/05/09
        public Int32 SaveProductBonusHDR(REF_BONUS_HDR _hdr, out int _seqNo)
        {
            _seqNo = -1;
            OracleParameter[] param = new OracleParameter[28];
            (param[0] = new OracleParameter("P_RBH_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_seq;
            (param[1] = new OracleParameter("P_RBH_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_doc_no;
            (param[2] = new OracleParameter("P_RBH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_com;
            (param[3] = new OracleParameter("P_RBH_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Rbh_date;
            (param[4] = new OracleParameter("P_RBH_FW_SALE_LMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_fw_sale_lmt;
            (param[5] = new OracleParameter("P_RBH_AREAS_LMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_areas_lmt;
            (param[6] = new OracleParameter("P_RBH_OUTS_LMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_outs_lmt;
            (param[7] = new OracleParameter("P_RBH_OUTS_DT_LMT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_outs_dt_lmt;
            (param[8] = new OracleParameter("P_RBH_SALES_METHD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_sales_methd;
            (param[9] = new OracleParameter("P_RBH_CALC_METHD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_calc_methd;
            (param[10] = new OracleParameter("P_RBH_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_man_circucd;
            (param[11] = new OracleParameter("P_RBH_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_anal2;
            (param[12] = new OracleParameter("P_RBH_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_anal3;
            (param[13] = new OracleParameter("P_RBH_CREATE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_create_by;
            (param[14] = new OracleParameter("P_RBH_CREATE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Rbh_create_dt;
            (param[15] = new OracleParameter("P_RBH_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_mod_by;
            (param[16] = new OracleParameter("P_RBH_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Rbh_mod_dt;
            (param[17] = new OracleParameter("P_RBH_CRE_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_cre_session_id;
            (param[18] = new OracleParameter("P_RBH_MOD_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_mod_session_id;
            (param[19] = new OracleParameter("P_RBH_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_act;
            (param[20] = new OracleParameter("P_RBH_DISC_CON", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_disc_con;
            (param[21] = new OracleParameter("P_RBH_PB_COND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hdr.Rbh_pb_cond;
            (param[22] = new OracleParameter("P_RBH_ANAL4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_anal4;
            (param[23] = new OracleParameter("P_RBH_ANAL5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_anal5;
            (param[24] = new OracleParameter("P_RBH_VALID_FROM", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hdr.Rbh_valid_from;
            (param[25] = new OracleParameter("P_RBH_REREPT_OPT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hdr.Rbh_rerept_opt;
            param[26] = new OracleParameter("O_SEQ", OracleDbType.Int32, null, ParameterDirection.Output);
            param[27] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_BONUS_HDR", CommandType.StoredProcedure, param);
            if (result > 0) _seqNo = Convert.ToInt32(param[26].Value.ToString());
            return result;
        }

        //Udesh 2018-10-11
        public DataTable Get_Product_Bonus_Header_Records(string _Com, string _User, string _bonusCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_bonusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonusCode;

            DataTable _dtResults = QueryDataTable("Header", "pkg_product_bonus_print.sp_Get_Product_Bonus_Hdr_Rec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Udesh 2018-10-11
        public DataTable Get_Product_Bonus_Detail_Records(string _Com, string _User, string _bonusCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_bonusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonusCode;

            DataTable _dtResults = QueryDataTable("Detail", "pkg_product_bonus_print.sp_Get_Product_Bonus_Det_Rec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Udesh 2018-10-11
        public DataTable Get_Product_Bonus_Location_Records(string _Com, string _User, string _bonusCode)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_bonusCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonusCode;

            DataTable _dtResults = QueryDataTable("Location", "pkg_product_bonus_print.sp_Get_Product_Bonus_Loc_Rec", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //SUBODANA 2017/05/09
        public int SaveProductBonusLoc(ref_bonus_loc loc)
        {
            OracleParameter[] param = new OracleParameter[12];
            (param[0] = new OracleParameter("P_RBL_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = loc.Rbl_seq;
            (param[1] = new OracleParameter("P_RBL_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_docno;
            (param[2] = new OracleParameter("P_RBL_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_chnl;
            (param[3] = new OracleParameter("P_RBL_SUB_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_sub_chnl;
            (param[4] = new OracleParameter("P_RBL_REGION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_region;
            (param[5] = new OracleParameter("P_RBL_ZONE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_zone;
            (param[6] = new OracleParameter("P_RBL_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_pc;
            (param[7] = new OracleParameter("P_RBL_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_anal1;
            (param[8] = new OracleParameter("P_RBL_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_anal2;
            (param[9] = new OracleParameter("P_RBL_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc.Rbl_anal3;
            (param[10] = new OracleParameter("P_RBL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = loc.Rbl_line;
            param[11] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_BONUS_LOC", CommandType.StoredProcedure, param);
            return result;
        }
        //SUBODANA 2017/05/09
        public int SaveProductBonusDetails(ref_bonus_det det)
        {
            OracleParameter[] param = new OracleParameter[27];
            (param[0] = new OracleParameter("P_RBD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = det.Rbd_seq;
            (param[1] = new OracleParameter("P_RBD_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_docno;
            (param[2] = new OracleParameter("P_RBD_ITEM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_item_cd;
            (param[3] = new OracleParameter("P_RBD_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_cat1;
            (param[4] = new OracleParameter("P_RBD_CAT2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_cat2;
            (param[5] = new OracleParameter("P_RBD_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_model;
            (param[6] = new OracleParameter("P_RDB_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rdb_brand;
            (param[7] = new OracleParameter("P_RBD_PB", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_pb;
            (param[8] = new OracleParameter("P_RBD_PL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_pl;
            (param[9] = new OracleParameter("P_RBD_PRICE_CIRCUL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_price_circul;
            (param[10] = new OracleParameter("P_RBD_CUS_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_cus_cd;
            (param[11] = new OracleParameter("P_RBD_HP_SCHM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_hp_schm;
            (param[12] = new OracleParameter("P_RBD_SALES_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_sales_tp;
            (param[13] = new OracleParameter("P_RBD_PAY_MODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_pay_mode;
            (param[14] = new OracleParameter("P_RBD_PAY_SUB_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_pay_sub_tp;
            (param[15] = new OracleParameter("P_RBD_SLAB_BASE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rbd_slab_base;
            (param[16] = new OracleParameter("P_RBD_FROM_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = det.Rbd_from_val;
            (param[17] = new OracleParameter("P_RDB_TO_VAL", OracleDbType.Int32, null, ParameterDirection.Input)).Value = det.Rdb_to_val;
            (param[18] = new OracleParameter("P_RDB_MARKS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = det.Rdb_marks;
            (param[19] = new OracleParameter("P_RDB_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rdb_anal1;
            (param[20] = new OracleParameter("P_RDB_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rdb_anal2;
            (param[21] = new OracleParameter("P_RDB_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rdb_anal3;
            (param[22] = new OracleParameter("P_RDB_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = det.Rdb_line;
            (param[23] = new OracleParameter("P_RDB_TOT_COMB_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = det.Rdb_to_val;
            (param[24] = new OracleParameter("P_RDB_ANAL4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rdb_anal4;
            (param[25] = new OracleParameter("P_RDB_ANAL5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = det.Rdb_anal5;
            param[26] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_REF_BONUS_DETAILS", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/05/12
        public int DeleteBonusDetails(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_BONUS_DET", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017/05/12
        public int DeleteBonusLoc(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_REF_BONUS_LOC", CommandType.StoredProcedure, param);
            return result;
        }
        //Udaya 15/05/2017
        public List<CreditNotes> CreditNoteDetails(string invNo, string comCode, string proCenter)
        {
            DataTable _result = null;
            List<CreditNotes> _crdNote = new List<CreditNotes>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_commcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            (param[1] = new OracleParameter("p_proCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
            (param[2] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = proCenter;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("dtcreditDetails", "get_CreditNoteDetails", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                _crdNote = DataTableExtensions.ToGenericList<CreditNotes>(_result, CreditNotes.Converter);
            }
            return _crdNote;
        }

        public List<DebitNotes> DebitNoteDetails(string invNo, string comCode, string proCenter)
        {
            DataTable _result = null;
            List<DebitNotes> _debtNote = new List<DebitNotes>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_commcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            (param[1] = new OracleParameter("p_proCenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;
            (param[2] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = proCenter;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("dtcreditDetails", "get_CreditNoteDetails", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count > 0)
            {
                _debtNote = DataTableExtensions.ToGenericList<DebitNotes>(_result, DebitNotes.Converter);
            }
            return _debtNote;
        }
        //subodana 2017/05/16
        public List<ref_bonus_loc> GetBonusLoc(string doc)
        {
            List<ref_bonus_loc> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_BONUS_LOC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_bonus_loc>(dtTemp, ref_bonus_loc.Converter);
            }
            return oResult;
        }
        //subodana 2017/05/16
        public List<ref_bonus_det> GetBonusDetails(string doc)
        {
            List<ref_bonus_det> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_BONUS_DETAILS", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_bonus_det>(dtTemp, ref_bonus_det.Converter);
            }
            return oResult;
        }
        //subodana 2017/05/16
        public List<REF_BONUS_HDR> GetBonusHDR(String doc, string Com)
        {
            List<REF_BONUS_HDR> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_BONUS_HDR", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<REF_BONUS_HDR>(dtTemp, REF_BONUS_HDR.Converter);
            }
            return oResult;
        }
        public DataTable Get_HP_Accounts_Bypc(string com, string pc, DateTime date)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("HPAcc", "SP_HPACCOUNTS_PC", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public decimal GetAreas(string account, DateTime todate, string st)
        {
            ConnectionOpen();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = account;
            (param[1] = new OracleParameter("in_asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[2] = new OracleParameter("in_rtnsamedate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = null;
            decimal _Value = (decimal)QueryFunction("fn_getaccarrears", CommandType.StoredProcedure, param);
            ConnectionClose();
            return _Value;

        }
        //subodana
        public DataTable Get_Penalty_Invoices(DateTime fromdate, DateTime todate)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[1] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("Invs", "SP_GET_PENALTY_INV", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public int CancelPenalty(string InvNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DEBTNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_CANCEL_PENALTY", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana
        public DataTable Check_Disc_Adj(string Invno)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Invno;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("Invs", "SP_CHECK_DISADJ", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public DataTable Get_HP_Accounts_Areas(string acc, DateTime date)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("HPAcc", "SP_HPAREASDETAIL", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public DataTable CheckCrCdType(string invno, string type, bool main)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (main == true)
            {
                _dtResults = QueryDataTable("chk", "SP_CHECK_CRCDMAINTP", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("chk", "SP_CHECK_CRCDTP", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }
        //subodana
        public DataTable Sp_Check_Inv_fullDo(string Invno, string item)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Invno;
            (param[1] = new OracleParameter("P_ITM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("HPAcc", "SP_CHECK_FULLDOINV", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2017-05-30
        public int SaveProductBonus(PoductBonusData _bns, string user)
        {
            OracleParameter[] param = new OracleParameter[21];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_rbf_circular", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.circular;
            (param[1] = new OracleParameter("p_rbf_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.pc;
            (param[2] = new OracleParameter("p_rbf_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.loc;
            (param[3] = new OracleParameter("p_rbf_inv_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.InvoiceNo;
            (param[4] = new OracleParameter("p_rbf_inv_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bns.InvoiceDate;
            (param[5] = new OracleParameter("p_rbf_exc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.ExecCode;
            (param[6] = new OracleParameter("p_rbf_exc_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.ExecName;
            (param[7] = new OracleParameter("p_rbf_item_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bns.ItemCode;
            (param[8] = new OracleParameter("p_rbf_qty", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bns.Qty;
            (param[9] = new OracleParameter("p_rbf_total", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bns.TotAmmount;
            (param[10] = new OracleParameter("p_rbf_marks", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bns.TotMarks;
            (param[11] = new OracleParameter("p_rbf_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = 1;
            (param[12] = new OracleParameter("p_rbf_from_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bns.frmdate;
            (param[13] = new OracleParameter("p_rbf_to_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bns.todate;
            (param[14] = new OracleParameter("p_rbf_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[15] = new OracleParameter("p_rbf_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[16] = new OracleParameter("p_rbf_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[17] = new OracleParameter("p_rbf_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now.Date;
            (param[18] = new OracleParameter("p_rbf_sales_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bns.FromsalesDate;
            (param[19] = new OracleParameter("p_rbf_sales_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bns.TosalesDate;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_product_bonus", CommandType.StoredProcedure, param);
            return effects;
        }
        //Udaya 02/06/2017
        public DataTable getInvoiceDetailsValues(string itemCode, string invNo)
        {
            DataTable _datatable = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_itemCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCode;
            (param[1] = new OracleParameter("p_invNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invNo;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _datatable = QueryDataTable("dtInvDtls", "getInvoiceDetailsValues", CommandType.StoredProcedure, false, param);
            return _datatable;
        }
        //subodana
        public DataTable Sp_GetbtuItems(string cat1, string type, string btu, string btu2)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_CAT1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat1;
            (param[1] = new OracleParameter("P_CAT3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[2] = new OracleParameter("P_BTU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = btu;
            (param[3] = new OracleParameter("P_BTU2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = btu2;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (type == "INV")
            {
                _dtResults = QueryDataTable("dt", "SP_GET_BTU_ITMS", CommandType.StoredProcedure, false, param);
            }
            else
            {
                _dtResults = QueryDataTable("dt", "SP_GET_BTU_ITMS2", CommandType.StoredProcedure, false, param);
            }

            return _dtResults;
        }
        //subodana
        public DataTable AcCat3Count(string code)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("dt", "SP_GET_BTU_CAT3LIST", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Udaya 10.07.2017
        public DataTable sp_getCommSalesTypes(string cirCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CIRCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cirCode;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("dt", "SP_GET_COMM_SALES_TYPES", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Udaya 11.07.2017
        public List<SalesTarget> GetTargetSales(string cirCode, string frmDate, string toDate)
        {
            List<SalesTarget> _lstResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_cirCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cirCode;
            (param[1] = new OracleParameter("P_frmDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = frmDate;
            (param[2] = new OracleParameter("P_toDate", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = toDate;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("dtExecuteTarget", "GET_TARGET_EXE_SLS", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _lstResults = DataTableExtensions.ToGenericList<SalesTarget>(_dtResults, SalesTarget.ConvertTarget);
            }
            return _lstResults;
        }
        //Udaya 10.07.2017
        public DataTable SalesTargetLevel(string cirCode)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CIRCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cirCode;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("dtSalesLevel", "SP_GET_Sales_Target_Level", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //Lakshan 24Jul2017
        public List<ImpCusdecHdr> GET_CUSTDEC_HDR_BY_CUSTDEC_ENTRY_NO(String _entryNo)
        {
            List<ImpCusdecHdr> _list = new List<ImpCusdecHdr>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_cuh_cusdec_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _entryNo;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_get_cuh_cusdecentryno_data", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<ImpCusdecHdr>(dtTemp, ImpCusdecHdr.Converter);
            }
            return _list;
        }
        //subodana
        public string GetAccountCodeByTp(string _company, string _type)
        {
            OracleParameter[] param = new OracleParameter[3];
            string _isValid = "";
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblvalidsupplier = QueryDataTable("tblvaliddivision", "SP_SUNTYPEACC", CommandType.StoredProcedure, false, param);
            if (_tblvalidsupplier != null)
            {
                if (_tblvalidsupplier.Rows.Count > 0)
                {
                    _isValid = _tblvalidsupplier.Rows[0][0].ToString();
                }
            }

            return _isValid;
        }
        //subodana
        public string GetShipSeqNo(string _SINO)
        {
            OracleParameter[] param = new OracleParameter[2];
            string _seq = "";
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SINO;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblval = QueryDataTable("tblvaliddivision", "SP_GET_SHIP_SEQNO", CommandType.StoredProcedure, false, param);
            if (_tblval != null && _tblval.Rows.Count > 0)
            {
                if (_tblval.Rows.Count > 0)
                {
                    _seq = _tblval.Rows[0][0].ToString();
                }
            }
            return _seq;
        }

        //Lakshan 24Jul2017
        public Int32 UpdateCusdecEntryNoDate(ImpCusdecHdr _obj)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int32 effects = 0;
            (param[0] = new OracleParameter("p_cuh_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.CUH_DOC_NO;
            (param[1] = new OracleParameter("p_cuh_cusdec_entry_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.CUH_CUSDEC_ENTRY_NO;
            (param[2] = new OracleParameter("p_cuh_cusdec_entry_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.CUH_CUSDEC_ENTRY_DT;
            (param[3] = new OracleParameter("p_cuh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.CUH_MOD_BY;
            (param[4] = new OracleParameter("p_cuh_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.CUH_MOD_SESSION;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_up_cuh_cusdec_entry_no", CommandType.StoredProcedure, param);
            return effects;
        }
        public int UpdateTargertMonth(string com, string calcd, string prcd, DateTime fdate, DateTime tdate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CALCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = calcd;
            (param[2] = new OracleParameter("P_PDCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = prcd;
            (param[3] = new OracleParameter("P_STDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[4] = new OracleParameter("P_EDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_TARGET_MONTH", CommandType.StoredProcedure, param);
            return result;
        }
        //11.08.2017 Daily Entry Details (Bond Details)
        public DataTable Bond_DaillyEntryDetails(DateTime _fromDate, DateTime _toDate, string _com, string _user, string rptType)
        {
            OracleParameter[] param = new OracleParameter[6];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("in_rptType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rptType;
            DataTable _result = QueryDataTable("tblEntryDetails", "SP_GET_DAILLY_ENTRY_DETAILS", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana 2017/08/21
        public List<ref_comm_mngr> GetCommissionExcmngrates(string doc, string exec)
        {
            List<ref_comm_mngr> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_EXC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exec;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (exec == "")
            {
                dtTemp = QueryDataTable("HDR", "SP_GET_EXC_MNG_COMM2", CommandType.StoredProcedure, false, param);
            }
            else
            {
                dtTemp = QueryDataTable("HDR", "SP_GET_EXC_MNG_COMM", CommandType.StoredProcedure, false, param);
            }
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_mngr>(dtTemp, ref_comm_mngr.Converter);
            }
            return oResult;
        }
        //subodana 2017/08/21
        public List<ref_comm_mngr> GetCommissionExcmngratesNor(string doc, string exec, Int32 days)
        {
            List<ref_comm_mngr> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_EXC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exec;
            (param[2] = new OracleParameter("P_DYAS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = days;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_EXC_NOR_COMM", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_mngr>(dtTemp, ref_comm_mngr.Converter);
            }
            return oResult;
        }
        public List<ref_comm_mngr_targt> GetCommissionExcmngrates(string pc)
        {
            List<ref_comm_mngr_targt> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_MNGR_TRGT", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_mngr_targt>(dtTemp, ref_comm_mngr_targt.Converter);
            }
            return oResult;
        }
        public List<ref_comm_spc_ovr> GetSpecialOverrideManagers(string pc, string exec)
        {
            List<ref_comm_spc_ovr> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("P_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exec;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_SPC_OVRT_MNGR", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_spc_ovr>(dtTemp, ref_comm_spc_ovr.Converter);
            }
            return oResult;
        }
        public List<mst_proc> GetProcByConsignee(string com, string type, string consin)
        {
            List<mst_proc> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_DOC_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[2] = new OracleParameter("P_CONSGN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = consin;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_CONS_PROC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<mst_proc>(dtTemp, mst_proc.Converter);
            }
            return oResult;
        }
        public List<BOIProc> GetDutyProc(string com)
        {
            List<BOIProc> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_DUTY_PROC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<BOIProc>(dtTemp, BOIProc.Converter);
            }
            return oResult;
        }
        public List<mst_proc_ele> GetProcDutyByConsignee(string com, string proc, string consin)
        {
            List<mst_proc_ele> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PROC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = proc;
            (param[2] = new OracleParameter("P_CONSIGNI", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = consin;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_DUTY_PROC_CON", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<mst_proc_ele>(dtTemp, mst_proc_ele.Converter);
            }
            return oResult;
        }
        public int SaveProcElement(mst_proc_ele ele)
        {
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_MPHE_CNTY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_cnty;
            (param[1] = new OracleParameter("P_MPHE_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_com;
            (param[2] = new OracleParameter("P_MPHE_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_doc_tp;
            (param[3] = new OracleParameter("P_MPHE_PROC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_proc_cd;
            (param[4] = new OracleParameter("P_MPHE_COST_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_cost_cat;
            (param[5] = new OracleParameter("P_MPHE_COST_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_cost_tp;
            (param[6] = new OracleParameter("P_MPHE_COST_ELE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_cost_ele;
            (param[7] = new OracleParameter("P_MPHE_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ele.Mphe_act;
            (param[8] = new OracleParameter("P_MPHE_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_cre_session;
            (param[9] = new OracleParameter("P_MPHE_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = ele.Mphe_cre_dt;
            (param[10] = new OracleParameter("P_MPHE_MOD_SESSION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_mod_session;
            (param[11] = new OracleParameter("P_MPHE_MP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = ele.Mphe_mp;
            (param[12] = new OracleParameter("P_MPHE_CONSIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ele.Mphe_consin;
            param[13] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_BOI_DUTY_PROC", CommandType.StoredProcedure, param);
            return result;
        }

        //Add by a kila 2017/08/17
        public DataTable GetInvalidReceiptsForSunUpload(string _company, string _profitCenter, DateTime _fromDate, DateTime _toDate)
        {
            DataTable _receiptDetails = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_Pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _profitCenter;
            (param[2] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[3] = new OracleParameter("p_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;

            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _receiptDetails = QueryDataTable("ReceiptDetails", "SP_GET_INVAL_SUNUPLOAD_RECS", CommandType.StoredProcedure, false, param);
            return _receiptDetails;
        }
        //Added By Udaya 08.09.207 Collect Sales Exc Contribution to WEBMCV
        public DataTable SalesEx_Contribution(string cirCode, string pcCode, DateTime frmDate, DateTime toDate, string comCode)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_cirCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cirCode;
            (param[1] = new OracleParameter("p_pcCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pcCode;
            (param[2] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDate;
            (param[3] = new OracleParameter("p_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = toDate;
            (param[4] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _SlsCon = QueryDataTable("SalesContribution", "SP_GET_EX_CONTRIBUTION", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        //2017-sep-12 subodana
        public int SaveHandOverAccounts(hpr_hand_over_ac _hnd_over)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_HHOA_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_com;
            (param[1] = new OracleParameter("P_HHOA_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_pc;
            (param[2] = new OracleParameter("P_HHOA_AC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_ac;
            (param[3] = new OracleParameter("P_HHOA_BONUS_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_bonus_month;
            (param[4] = new OracleParameter("P_HHOA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_cre_by;
            (param[5] = new OracleParameter("P_HHOA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_cre_dt;
            (param[6] = new OracleParameter("P_HHOA_REJ_LMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_rej_lmt;
            (param[7] = new OracleParameter("P_HHOA_AVL_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over.Hhoa_rej_lmt;
            param[8] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_HAND_ACCOUNTS", CommandType.StoredProcedure, param);
            return result;
        }

        //2017-sep-12 subodana
        public int SaveHandOverAccountsLog(hpr_hand_over_ac _hnd_over_log)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_HHOAL_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_com;
            (param[1] = new OracleParameter("P_HHOAL_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_pc;
            (param[2] = new OracleParameter("P_HHOAL_AC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_ac;
            (param[3] = new OracleParameter("P_HHOAL_BONUS_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_bonus_month;
            (param[4] = new OracleParameter("P_HHOAL_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_cre_by;
            (param[5] = new OracleParameter("P_HHOAL_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_cre_dt;
            (param[6] = new OracleParameter("P_HHOAL_REJ_LMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_rej_lmt;
            (param[7] = new OracleParameter("P_HHOAL_AVL_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over_log.Hhoa_rej_lmt;
            (param[8] = new OracleParameter("P_HHOAL_AVL_SETOFF", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _hnd_over_log.setoffval;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_HAND_ACCOUNTS_LOG", CommandType.StoredProcedure, param);
            return result;
        }
        public List<hpr_hand_over_ac> GetHandOverData(string com, string pc, bool availbale)
        {
            List<hpr_hand_over_ac> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PROC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            if (availbale == true)
            {
                dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVER_DET_BAL", CommandType.StoredProcedure, false, param);
            }
            else
            {
                dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVER_DET", CommandType.StoredProcedure, false, param);
            }
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_hand_over_ac>(dtTemp, hpr_hand_over_ac.Converter);
            }
            return oResult;
        }
        public List<hpr_hand_over_ac> GetHandOverDataAcc(string com, string pc, DateTime month, string acc)
        {
            List<hpr_hand_over_ac> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PROC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ACC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            (param[3] = new OracleParameter("P_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = month;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVER_DET_BALACC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_hand_over_ac>(dtTemp, hpr_hand_over_ac.Converter);
            }
            return oResult;
        }
        public List<hpr_hand_over_ac> GetHandOverDataAccAll(string com, string pc, DateTime month, string acc)
        {
            List<hpr_hand_over_ac> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PROC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ACC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            (param[3] = new OracleParameter("P_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = month;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVER_DET_ALLACC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_hand_over_ac>(dtTemp, hpr_hand_over_ac.Converter);
            }
            return oResult;
        }
        public List<ArrearsPC> GetArrearsPC()
        {
            List<ArrearsPC> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_ARREARSPC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ArrearsPC>(dtTemp, ArrearsPC.Converter);
            }
            return oResult;
        }
        public List<ArrearsAccDetails> GetArrearsBalDetails(string com, DateTime date, string pc)
        {
            List<ArrearsAccDetails> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_ARREARS_ACC", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ArrearsAccDetails>(dtTemp, ArrearsAccDetails.Converter);
            }
            return oResult;
        }
        public decimal ArrearsIgnoreLmt(string PC)
        {
            DataTable dtTemp = new DataTable();
            decimal val = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_ARR_IGNR_LMT", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    val = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                }
            }
            return val;
        }

        public decimal HOSetOffVall(string com, string acc, string pc)
        {
            DataTable dtTemp = new DataTable();
            decimal val = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_HANDOVERLOGSETOFF", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    val = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                }
            }
            return val;
        }
        public decimal ClsbalIgnoreLmt(string PC)
        {
            DataTable dtTemp = new DataTable();
            decimal val = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_CLOS_BAL_IGNR", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    val = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                }
            }
            return val;
        }
        public int UpdateHandOverBalance(string com, string pc, string acc, DateTime date, decimal balance)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc;
            (param[3] = new OracleParameter("P_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[4] = new OracleParameter("P_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = balance;
            param[5] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_HANDOVERBAL", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017-sep-16
        public int Savehpt_arr_acc_det(hpt_arr_acc_det _accdet)
        {
            OracleParameter[] param = new OracleParameter[42];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_HAAD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_com;
            (param[1] = new OracleParameter("P_HAAD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_pc;
            (param[2] = new OracleParameter("P_HAAD_PC_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_pc_cat;
            (param[3] = new OracleParameter("P_HAAD_ACC_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_acc_cd;
            (param[4] = new OracleParameter("P_HAAD_MNG_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_mng_cd;
            (param[5] = new OracleParameter("P_HAAD_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accdet.Haad_date;
            (param[6] = new OracleParameter("P_HAAD_SUPPL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accdet.Haad_suppl_dt;
            (param[7] = new OracleParameter("P_HAAD_TOT_CLOS_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.Haad_tot_clos_bal;
            (param[8] = new OracleParameter("P_HAAD_ACT_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.Haad_act_arr_amt;
            (param[9] = new OracleParameter("P_HAAD_TOT_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.Haad_tot_arr_amt;
            (param[10] = new OracleParameter("P_HAAD_TOT_NO_OF_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accdet.Haad_tot_no_of_acc;
            (param[11] = new OracleParameter("P_HAAD_TOT_NO_OF_ACT_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accdet.Haad_tot_no_of_act_acc;
            (param[12] = new OracleParameter("P_HAAD_PERI_OVR_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accdet.Haad_peri_ovr_acc;
            (param[13] = new OracleParameter("P_HAAD_TOT_NO_OF_ARR_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accdet.Haad_tot_no_of_arr_acc;
            (param[14] = new OracleParameter("P_HAAD_CURRNT_MONTH_DUE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accdet.Haad_currnt_month_due;
            (param[15] = new OracleParameter("P_HAAD_PROCE_COMPLT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _accdet.Haad_proce_complt;
            (param[16] = new OracleParameter("P_HAAD_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_anal1;
            (param[17] = new OracleParameter("P_HAAD_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_anal2;
            (param[18] = new OracleParameter("P_HAAD_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_anal3;
            (param[19] = new OracleParameter("P_HAAD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accdet.Haad_cre_dt;
            (param[20] = new OracleParameter("P_HAAD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_cre_by;
            (param[21] = new OracleParameter("P_HAAD_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accdet.Haad_mod_dt;
            (param[22] = new OracleParameter("P_HAAD_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.Haad_mod_by;
            (param[23] = new OracleParameter("P_HAAD_ADJ_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_ADJ_TOT;
            (param[24] = new OracleParameter("P_HAAD_ADJ_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_ADJ_AMT;
            (param[25] = new OracleParameter("P_HAAD_SHOP_COM_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accdet.HAAD_SHOP_COM_ACC;
            (param[26] = new OracleParameter("P_HAAD_DIRIYA_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_DIRIYA_ADJ;
            (param[27] = new OracleParameter("P_HAAD_LOD_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_LOD_ADJ;
            (param[28] = new OracleParameter("P_HAAD_SER_PROB", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_SER_PROB;
            (param[29] = new OracleParameter("P_HAAD_DISP_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_DISP_ADJ;
            (param[30] = new OracleParameter("P_HAAD_OTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_OTH;
            (param[31] = new OracleParameter("P_HAAD_TOT_GRCE_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_TOT_GRCE_SETT;
            (param[32] = new OracleParameter("P_HAAD_GRCE_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_GRCE_SETT;
            (param[33] = new OracleParameter("P_HAAD_TOT_GRCE_SETT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_TOT_GRCE_SETT_ADJ;
            (param[34] = new OracleParameter("P_HAAD_GRCE_SETT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_GRCE_SETT_ADJ;
            (param[35] = new OracleParameter("P_HAAD_HAND_OVER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_HAND_OVER;
            (param[36] = new OracleParameter("P_HAAD_ARR_RELE_MONTHS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_ARR_RELE_MONTHS;
            (param[37] = new OracleParameter("P_HAAD_EFFECT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _accdet.HAAD_EFFECT_DT;
            (param[38] = new OracleParameter("P_HAAD_ORIG_GRACE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_ORIG_GRACE_AMT;
            (param[39] = new OracleParameter("P_HAAD_SHOP_COM_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_SHOP_COM_ADJ;
            (param[40] = new OracleParameter("P_HAAD_GRCE_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _accdet.HAAD_GRCE_PER_COLL;
            param[41] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_HPT_ARR_ACC_DET", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2017-sep-16
        public int Savehpt_arr_acc(hpt_arr_acc _acc)
        {
            OracleParameter[] param = new OracleParameter[91];
            Int32 effects = 0;
            (param[0] = new OracleParameter("P_HAA_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_com;
            (param[1] = new OracleParameter("P_HAA_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_pc;
            (param[2] = new OracleParameter("P_HAA_PC_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_pc_cat;
            (param[3] = new OracleParameter("P_HAA_MNG_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_mng_cd;
            (param[4] = new OracleParameter("P_HAA_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.Haa_date;
            (param[5] = new OracleParameter("P_HAA_SUPPL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.Haa_suppl_dt;
            (param[6] = new OracleParameter("P_HAA_TOT_CLOS_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.Haa_tot_clos_bal;
            (param[7] = new OracleParameter("P_HAA_ACT_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.Haa_act_arr_amt;
            (param[8] = new OracleParameter("P_HAA_TOT_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.Haa_tot_arr_amt;
            (param[9] = new OracleParameter("P_HAA_TOT_NO_OF_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.Haa_tot_no_of_acc;
            (param[10] = new OracleParameter("P_HAA_TOT_NO_OF_ACT_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.Haa_tot_no_of_act_acc;
            (param[11] = new OracleParameter("P_HAA_PERI_OVR_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.Haa_peri_ovr_acc;
            (param[12] = new OracleParameter("P_HAA_TOT_NO_OF_ARR_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.Haa_tot_no_of_arr_acc;
            (param[13] = new OracleParameter("P_HAA_CURRNT_MONTH_DUE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.Haa_currnt_month_due;
            (param[14] = new OracleParameter("P_HAA_PROCE_COMPLT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_proce_complt;
            (param[15] = new OracleParameter("P_HAA_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_anal1;
            (param[16] = new OracleParameter("P_HAA_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_anal2;
            (param[17] = new OracleParameter("P_HAA_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_anal3;
            (param[18] = new OracleParameter("P_HAA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.Haa_cre_dt;
            (param[19] = new OracleParameter("P_HAA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_cre_by;
            (param[20] = new OracleParameter("P_HAA_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.Haa_mod_dt;
            (param[21] = new OracleParameter("P_HAA_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_mod_by;
            (param[22] = new OracleParameter("P_HAA_ADJ_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_TOT;
            (param[23] = new OracleParameter("P_HAA_ADJ_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_AMT;
            (param[24] = new OracleParameter("P_HAA_SHOP_COM_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_SHOP_COM_ACC;
            (param[25] = new OracleParameter("P_HAA_DIRIYA_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_DIRIYA_ADJ;
            (param[26] = new OracleParameter("P_HAA_LOD_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_LOD_ADJ;
            (param[27] = new OracleParameter("P_HAA_SER_PROB", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_SER_PROB;
            (param[28] = new OracleParameter("P_HAA_DISP_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_DISP_ADJ;
            (param[29] = new OracleParameter("P_HAA_OTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_OTH;
            (param[30] = new OracleParameter("P_HAA_TOT_GRCE_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_TOT_GRCE_SETT;
            (param[31] = new OracleParameter("P_HAA_GRCE_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_GRCE_SETT;
            (param[32] = new OracleParameter("P_HAA_TOT_GRCE_SETT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_TOT_GRCE_SETT_ADJ;
            (param[33] = new OracleParameter("P_HAA_CURR_DUE_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_CURR_DUE_TOT;
            (param[34] = new OracleParameter("P_HAA_GRCE_SETT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_GRCE_SETT_ADJ;
            (param[35] = new OracleParameter("P_HAA_TOT_REMITT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_TOT_REMITT;
            (param[36] = new OracleParameter("P_HAA_PRE_MON_SUP_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_PRE_MON_SUP_COLL;
            (param[37] = new OracleParameter("P_HAA_GRCE_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.HAA_GRCE_DATE;
            (param[38] = new OracleParameter("P_HAA_HAND_OVER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_HAND_OVER;
            (param[39] = new OracleParameter("P_HAA_ARR_RELE_MONTHS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ARR_RELE_MONTHS;
            (param[40] = new OracleParameter("P_HAA_EFFECT_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.HAA_EFFECT_DT;
            (param[41] = new OracleParameter("P_HAA_ORIG_GRACE_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ORIG_GRACE_AMT;
            (param[42] = new OracleParameter("P_HAA_GRCE_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_GRCE_PER_COLL;
            (param[43] = new OracleParameter("P_HAA_SHOP_COM_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_SHOP_COM_ADJ;
            (param[44] = new OracleParameter("P_HAA_ISSUE_CHQ_RTN_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ISSUE_CHQ_RTN_ADJ;
            (param[45] = new OracleParameter("P_HAA_ADJ_REMITT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_REMITT;
            (param[46] = new OracleParameter("P_HAA_SUPP_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_SUPP_COLL;
            (param[47] = new OracleParameter("P_HAA_SUPP_COLL_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_SUPP_COLL_ADJ;
            (param[48] = new OracleParameter("P_HAA_ADJ_GRA_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_GRA_PER;
            (param[49] = new OracleParameter("P_HAA_PREV_GRACE_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_PREV_GRACE_PER_COLL;
            (param[50] = new OracleParameter("P_HAA_ADJ_PRE_GR_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_PRE_GR_PER_COLL;
            (param[51] = new OracleParameter("P_HAA_ADJ_PR_MO_SUP_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_PR_MO_SUP_COLL;
            (param[52] = new OracleParameter("P_HAA_NET_REMIT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_NET_REMIT;
            (param[53] = new OracleParameter("P_HAA_TOT_REC_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_TOT_REC_BAL;
            (param[54] = new OracleParameter("P_HAA_DISREG_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_DISREG_AMT;
            (param[55] = new OracleParameter("P_HAA_GRC_PER_NT_QL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_GRC_PER_NT_QL;
            (param[56] = new OracleParameter("P_HAA_ALL_TOT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ALL_TOT_ADJ;
            (param[57] = new OracleParameter("P_HAA_ADJESMENT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJESMENT;
            (param[58] = new OracleParameter("P_HAA_NET_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_NET_ARR_AMT;
            (param[59] = new OracleParameter("P_HAA_ARRE_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ARRE_PER;
            (param[60] = new OracleParameter("P_HAA_BONUS_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_BONUS_RT;
            (param[61] = new OracleParameter("P_HAA_BONUS_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_BONUS_AMT;
            (param[62] = new OracleParameter("P_HAA_BONUS_REF_DED", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_BONUS_REF_DED;
            (param[63] = new OracleParameter("P_HAA_GRO_COLL_BONUS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_GRO_COLL_BONUS;
            (param[64] = new OracleParameter("P_HAA_EPF_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_EPF_RT;
            (param[65] = new OracleParameter("P_HAA_ESD_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ESD_RT;
            (param[66] = new OracleParameter("P_HAA_TOT_NET_BONUS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_TOT_NET_BONUS;
            (param[67] = new OracleParameter("P_HAA_GRC_PRD_COL_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_GRC_PRD_COL_ADJ;
            (param[68] = new OracleParameter("P_HAA_ADJ_DUE_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_DUE_TOT;
            (param[69] = new OracleParameter("P_HAA_PREV_ARR_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_PREV_ARR_TOT;
            (param[70] = new OracleParameter("P_HAA_ADJ_PREV_TOTARR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_PREV_TOTARR;
            (param[71] = new OracleParameter("P_HAA_ALL_DUE_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ALL_DUE_TOT;
            (param[72] = new OracleParameter("P_HAA_ADJ_CURR_ARR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_CURR_ARR;
            (param[73] = new OracleParameter("P_HAA_ADJ_GRA_PER_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ADJ_GRA_PER_SETT;
            (param[74] = new OracleParameter("P_HAA_SHORT_REMITT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_SHORT_REMITT;
            (param[75] = new OracleParameter("P_HAA_ARR_SCH_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ARR_SCH_ADJ;
            (param[76] = new OracleParameter("P_HAA_ACC_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_REFUND;
            (param[77] = new OracleParameter("P_HAA_ACC_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_REFUREMK;
            (param[78] = new OracleParameter("P_HAA_ACC_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_DEDUC;
            (param[79] = new OracleParameter("P_HAA_ACC_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_DEDUCRMK;
            (param[80] = new OracleParameter("P_HAA_INV_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_REFUND;
            (param[81] = new OracleParameter("P_HAA_INV_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_REFUREMK;
            (param[82] = new OracleParameter("P_HAA_INV_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_DEDUC;
            (param[83] = new OracleParameter("P_HAA_INV_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_DEDUCRMK;
            (param[84] = new OracleParameter("P_HAA_CRED_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_REFUND;
            (param[85] = new OracleParameter("P_HAA_CRED_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_REFUREMK;
            (param[86] = new OracleParameter("P_HAA_CRED_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_DEDUC;
            (param[87] = new OracleParameter("P_HAA_CRED_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_DEDUCRMK;
            (param[88] = new OracleParameter("P_HAA_SPC_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_SPC_RMK;
            (param[89] = new OracleParameter("P_HAA_SPC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_SPC_VAL;
            param[90] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_SAVE_HPT_ARR_ACC", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2017-sep-18
        public int getDueMonths(string schcd1, string schcd2, DateTime bonusmonth, DateTime accdate, string Pc)
        {
            int month = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_SCH_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schcd1;
            (param[1] = new OracleParameter("P_SCH_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schcd2;
            (param[2] = new OracleParameter("P_BON_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusmonth;
            (param[3] = new OracleParameter("P_ACC_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = accdate;
            (param[4] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pc;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_DUEMONTH", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    if (dtTemp.Rows[0][0].ToString() != "")
                    {
                        month = Convert.ToInt16(dtTemp.Rows[0][0].ToString());
                    }

                }
            }
            return month;
        }
        //subodana 2017-sep-18
        public int getDueMonthsforchanal(string schcd1, string schcd2, DateTime bonusmonth, DateTime accdate, string Channel)
        {
            int month = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_SCH_CD1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schcd1;
            (param[1] = new OracleParameter("P_SCH_CD2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = schcd2;
            (param[2] = new OracleParameter("P_BON_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusmonth;
            (param[3] = new OracleParameter("P_ACC_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = accdate;
            (param[4] = new OracleParameter("P_CHANNEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Channel;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_DUEMONTHCHNL", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    if (dtTemp.Rows[0][0].ToString() != "")
                    {
                        month = Convert.ToInt16(dtTemp.Rows[0][0].ToString());
                    }

                }
            }
            return month;
        }
        //subodana 2017-sep-18
        public decimal getDueValue(string accno, DateTime date, DateTime month)
        {
            decimal value = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_ACCCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[2] = new OracleParameter("P_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = month;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_DUEVALUE", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    if (dtTemp.Rows[0][0].ToString() != "")
                    {
                        value = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                    }

                }
            }
            return value;
        }
        //subodana 2017-sep-18
        public bool CheckRevert(string accno, DateTime date, string pc)
        {
            bool value = false;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_ACCCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_CHECK_REVERT", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    value = true;
                }
            }
            return value;
        }
        //subodana 2017-sep-18
        public bool CheckReversCC(string accno, DateTime date, string pc)
        {
            bool value = false;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_ACCCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_CHECK_REVERSCC", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    value = true;
                }
            }
            return value;
        }
        //add by tharanga 2017/09/16
        public DataTable ProcessSUNUpload_Cedit_note(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sunID, string _file)
        {
            DataTable _result = null;

            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[6] = new OracleParameter("p_sun_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sunID;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_pro_sun_Cerd_nte", CommandType.StoredProcedure, false, param);
            //   _result = QueryDataTable("tbl", "sp_proc_sun_upload", CommandType.StoredProcedure, false, param);


            return _result;
        }
        //subodana 2017-sep-19
        public decimal getGrageLimit(string accno, DateTime date)
        {
            decimal value = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_ACCCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GETGRACELIMIT", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    value = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                }
            }
            return value;
        }
        //hpt_arr_acc_det
        public List<hpt_arr_acc_det> GetArrBalAccDetails(string pc, DateTime date)
        {
            List<hpt_arr_acc_det> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date.Date;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_BAL_ARR_LIST", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpt_arr_acc_det>(dtTemp, hpt_arr_acc_det.Converter2);
            }
            return oResult;
        }
        //hpt_arr_acc_det
        public List<hpt_arr_acc_det> GetArrBalAccDetailsfordt(string pc, string accno, DateTime date)
        {
            List<hpt_arr_acc_det> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_BAL_ARR_LISTflt", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpt_arr_acc_det>(dtTemp, hpt_arr_acc_det.Converter);
            }
            return oResult;
        }
        //subodana
        public int UpdateARR_ACC_DET(hpt_arr_acc_det _ob)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ob.Haad_seq;
            (param[1] = new OracleParameter("P_TOT_ARR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haad_tot_arr_amt;
            (param[2] = new OracleParameter("P_DUE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haad_currnt_month_due;
            (param[3] = new OracleParameter("P_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_ADJ_AMT;
            (param[4] = new OracleParameter("P_DIRIYA", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_DIRIYA_ADJ;
            (param[5] = new OracleParameter("P_LOD", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_LOD_ADJ;
            (param[6] = new OracleParameter("P_SER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_SER_PROB;
            (param[7] = new OracleParameter("P_DISP", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_DISP_ADJ;
            (param[8] = new OracleParameter("P_OTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_OTH;
            (param[9] = new OracleParameter("P_GR_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_GRCE_SETT;
            (param[10] = new OracleParameter("P_COMADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAAD_SHOP_COM_ADJ;
            (param[11] = new OracleParameter("P_REMARK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAAD_REMARK;
            param[12] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_HPT_ARR_ACC_DET", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana
        public int UpdateARR_ACC(hpt_arr_acc _ob)
        {
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_com;
            (param[1] = new OracleParameter("P_TOT_ARR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haa_tot_arr_amt;
            (param[2] = new OracleParameter("P_DUE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haa_currnt_month_due;
            (param[3] = new OracleParameter("P_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_AMT;
            (param[4] = new OracleParameter("P_DIRIYA", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_DIRIYA_ADJ;
            (param[5] = new OracleParameter("P_LOD", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_LOD_ADJ;
            (param[6] = new OracleParameter("P_SER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SER_PROB;
            (param[7] = new OracleParameter("P_DISP", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_DISP_ADJ;
            (param[8] = new OracleParameter("P_OTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_OTH;
            (param[9] = new OracleParameter("P_GR_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_TOT_GRCE_SETT;
            (param[10] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_pc;
            (param[11] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ob.Haa_date;
            (param[12] = new OracleParameter("P_COMADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SHOP_COM_ADJ;
            (param[13] = new OracleParameter("P_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _ob.Haa_seq;
            param[14] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_HPT_ARR_ACC", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017-09-25
        public List<hpt_arr_acc> GetArrBalAccHdr(string com, string pc, DateTime date)
        {
            List<hpt_arr_acc> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_BAL_ARR_HDR", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpt_arr_acc>(dtTemp, hpt_arr_acc.Converter);
            }
            return oResult;
        }
        //subodana 2017-09-26
        public List<MgrCreation> GetManagerDetails(string com, string pc, string manager)
        {
            List<MgrCreation> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_MANAGER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = manager;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_MANAGER_DATA", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<MgrCreation>(dtTemp, MgrCreation.webConverter);
            }
            return oResult;
        }
        //subodana 2017-09-26
        public List<MgrCreation> GetManagerDetails2(string com, string pc, DateTime bonusdate)
        {
            List<MgrCreation> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusdate;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_MANAGERSATABONUS", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<MgrCreation>(dtTemp, MgrCreation.webConverter);
            }
            return oResult;
        }
        //2017-sep-30 Dilshan
        public int SaveBonusVouDetails(BonusVoucher _hnd_over)
        {
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("P_HPBV_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_seq;
            (param[1] = new OracleParameter("P_HPBV_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_month;
            (param[2] = new OracleParameter("P_HPBV_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_com;
            (param[3] = new OracleParameter("P_HPBV_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_pc;
            (param[4] = new OracleParameter("P_HPBV_VOU_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_vou_no;
            (param[5] = new OracleParameter("P_HPBV_GROSS_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_gross_bonus;
            (param[6] = new OracleParameter("P_HPBV_DEDUCT", OracleDbType.Double, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_deduct;
            (param[7] = new OracleParameter("P_HPBV_REFUND", OracleDbType.Double, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_refund;
            (param[8] = new OracleParameter("P_HPBV_NET_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_net_bonus;
            (param[9] = new OracleParameter("P_HPBV_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_cre_by;
            (param[10] = new OracleParameter("P_HPBV_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_cre_dt;
            (param[11] = new OracleParameter("P_HPBV_CLAIM_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_claim_stus;
            (param[12] = new OracleParameter("P_HPBV_CLAIM_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_claim_by;
            (param[13] = new OracleParameter("P_HPBV_CLAIM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _hnd_over.hpbv_claim_dt;
            param[14] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_bonusvou_det", CommandType.StoredProcedure, param);
            return result;
        }
        //Dilshan 30/09/2017
        public int UpdateARR_ACCNew(hpt_arr_acc _ob)
        {
            OracleParameter[] param = new OracleParameter[89];
            (param[0] = new OracleParameter("P_HAA_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_com;
            (param[1] = new OracleParameter("P_HAA_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_pc;
            (param[2] = new OracleParameter("P_HAA_PC_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_pc_cat;
            (param[3] = new OracleParameter("P_HAA_MNG_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_mng_cd;
            (param[4] = new OracleParameter("P_HAA_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ob.Haa_date;
            (param[5] = new OracleParameter("P_HAA_SUPPL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ob.Haa_suppl_dt;
            (param[6] = new OracleParameter("P_HAA_TOT_CLOS_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haa_tot_clos_bal;
            (param[7] = new OracleParameter("P_HAA_ACT_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haa_act_arr_amt;
            (param[8] = new OracleParameter("P_HAA_TOT_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haa_tot_arr_amt;
            (param[9] = new OracleParameter("P_HAA_TOT_NO_OF_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ob.Haa_tot_no_of_acc;
            (param[10] = new OracleParameter("P_HAA_TOT_NO_OF_ACT_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ob.Haa_tot_no_of_act_acc;
            (param[11] = new OracleParameter("P_HAA_PERI_OVR_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ob.Haa_peri_ovr_acc;
            (param[12] = new OracleParameter("P_HAA_TOT_NO_OF_ARR_ACC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ob.Haa_tot_no_of_arr_acc;
            (param[13] = new OracleParameter("P_HAA_CURRNT_MONTH_DUE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.Haa_currnt_month_due;
            (param[14] = new OracleParameter("P_HAA_PROCE_COMPLT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ob.Haa_proce_complt;
            (param[15] = new OracleParameter("P_HAA_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_anal1;
            (param[16] = new OracleParameter("P_HAA_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_anal2;
            (param[17] = new OracleParameter("P_HAA_ANAL3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_anal3;
            (param[18] = new OracleParameter("P_HAA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ob.Haa_cre_dt;
            (param[19] = new OracleParameter("P_HAA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_cre_by;
            (param[20] = new OracleParameter("P_HAA_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ob.Haa_mod_dt;
            (param[21] = new OracleParameter("P_HAA_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.Haa_mod_by;
            (param[22] = new OracleParameter("P_HAA_SHOP_COM_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_SHOP_COM_ACC;
            (param[23] = new OracleParameter("P_HAA_ADJ_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_TOT;
            (param[24] = new OracleParameter("P_HAA_ADJ_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_AMT;
            (param[25] = new OracleParameter("P_HAA_DIRIYA_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_DIRIYA_ADJ;
            (param[26] = new OracleParameter("P_HAA_LOD_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_LOD_ADJ;
            (param[27] = new OracleParameter("P_HAA_SER_PROB", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SER_PROB;
            (param[28] = new OracleParameter("P_HAA_DISP_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_DISP_ADJ;
            (param[29] = new OracleParameter("P_HAA_OTH", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_OTH;
            (param[30] = new OracleParameter("P_HAA_TOT_GRCE_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_TOT_GRCE_SETT;
            (param[31] = new OracleParameter("P_HAA_GRCE_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_GRCE_SETT;
            (param[32] = new OracleParameter("P_HAA_TOT_GRCE_SETT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_TOT_GRCE_SETT_ADJ;
            (param[33] = new OracleParameter("P_HAA_GRCE_SETT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_GRCE_SETT_ADJ;
            (param[34] = new OracleParameter("P_HAA_GRCE_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_GRCE_PER_COLL;
            (param[35] = new OracleParameter("P_HAA_GRCE_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ob.HAA_GRCE_DATE;
            (param[36] = new OracleParameter("P_HAA_MNG_CRE_METH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "";
            (param[37] = new OracleParameter("P_HAA_CURR_DUE_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_CURR_DUE_TOT;
            (param[38] = new OracleParameter("P_HAA_ADJ_DUE_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_DUE_TOT;
            (param[39] = new OracleParameter("P_HAA_PREV_ARR_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_PREV_ARR_TOT;
            (param[40] = new OracleParameter("P_HAA_ADJ_PREV_TOTARR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_PREV_TOTARR;
            (param[41] = new OracleParameter("P_HAA_ALL_DUE_TOT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ALL_DUE_TOT;
            (param[42] = new OracleParameter("P_HAA_ADJ_CURR_ARR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_CURR_ARR;
            (param[43] = new OracleParameter("P_HAA_ADJ_GRA_PER_SETT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_GRA_PER_SETT;
            (param[44] = new OracleParameter("P_HAA_SHORT_REMITT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SHORT_REMITT;
            (param[45] = new OracleParameter("P_HAA_ARR_SCH_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ARR_SCH_ADJ;
            (param[46] = new OracleParameter("P_HAA_SHOP_COM_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SHOP_COM_ADJ;
            (param[47] = new OracleParameter("P_HAA_ISSUE_CHQ_RTN_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ISSUE_CHQ_RTN_ADJ;
            (param[48] = new OracleParameter("P_HAA_TOT_REMITT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_TOT_REMITT;
            (param[49] = new OracleParameter("P_HAA_ADJ_REMITT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_REMITT;
            (param[50] = new OracleParameter("P_HAA_SUPP_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SUPP_COLL;
            (param[51] = new OracleParameter("P_HAA_SUPP_COLL_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SUPP_COLL_ADJ;
            (param[52] = new OracleParameter("P_HAA_ADJ_GRA_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_GRA_PER;
            (param[53] = new OracleParameter("P_HAA_PREV_GRACE_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_PREV_GRACE_PER_COLL;
            (param[54] = new OracleParameter("P_HAA_ADJ_PRE_GR_PER_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_PRE_GR_PER_COLL;
            (param[55] = new OracleParameter("P_HAA_PRE_MON_SUP_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_PRE_MON_SUP_COLL;
            (param[56] = new OracleParameter("P_HAA_ADJ_PR_MO_SUP_COLL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJ_PR_MO_SUP_COLL;
            (param[57] = new OracleParameter("P_HAA_NET_REMIT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_NET_REMIT;
            (param[58] = new OracleParameter("P_HAA_TOT_REC_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_TOT_REC_BAL;
            (param[59] = new OracleParameter("P_HAA_DISREG_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_DISREG_AMT;
            (param[60] = new OracleParameter("P_HAA_GRC_PER_NT_QL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_GRC_PER_NT_QL;
            (param[61] = new OracleParameter("P_HAA_ALL_TOT_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ALL_TOT_ADJ;
            (param[62] = new OracleParameter("P_HAA_ADJESMENT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ADJESMENT;
            (param[63] = new OracleParameter("P_HAA_NET_ARR_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_NET_ARR_AMT;
            (param[64] = new OracleParameter("P_HAA_ARRE_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ARRE_PER;
            (param[65] = new OracleParameter("P_HAA_BONUS_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_BONUS_RT;
            (param[66] = new OracleParameter("P_HAA_BONUS_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_BONUS_AMT;
            (param[67] = new OracleParameter("P_HAA_BONUS_REF_DED", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_BONUS_REF_DED;
            (param[68] = new OracleParameter("P_HAA_GRO_COLL_BONUS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_GRO_COLL_BONUS;
            (param[69] = new OracleParameter("P_HAA_EPF_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_EPF_RT;
            (param[70] = new OracleParameter("P_HAA_ESD_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ESD_RT;
            (param[71] = new OracleParameter("P_HAA_TOT_NET_BONUS", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_TOT_NET_BONUS;
            (param[72] = new OracleParameter("P_HAA_GRC_PRD_COL_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_GRC_PRD_COL_ADJ;
            (param[73] = new OracleParameter("P_HAA_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _ob.Haa_seq;
            (param[74] = new OracleParameter("P_HAA_ACC_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ACC_DEPT_REFUND;
            (param[75] = new OracleParameter("P_HAA_ACC_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_ACC_DEPT_REFUREMK;
            (param[76] = new OracleParameter("P_HAA_ACC_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_ACC_DEPT_DEDUC;
            (param[77] = new OracleParameter("P_HAA_ACC_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_ACC_DEPT_DEDUCRMK;
            (param[78] = new OracleParameter("P_HAA_INV_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_INV_DEPT_REFUND;
            (param[79] = new OracleParameter("P_HAA_INV_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_INV_DEPT_REFUREMK;
            (param[80] = new OracleParameter("P_HAA_INV_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_INV_DEPT_DEDUC;
            (param[81] = new OracleParameter("P_HAA_INV_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_INV_DEPT_DEDUCRMK;
            (param[82] = new OracleParameter("P_HAA_CRED_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_CRED_DEPT_REFUND;
            (param[83] = new OracleParameter("P_HAA_CRED_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_CRED_DEPT_REFUREMK;
            (param[84] = new OracleParameter("P_HAA_CRED_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_CRED_DEPT_DEDUC;
            (param[85] = new OracleParameter("P_HAA_CRED_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_CRED_DEPT_DEDUCRMK;
            (param[86] = new OracleParameter("P_HAA_SPC_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ob.HAA_SPC_RMK;
            (param[87] = new OracleParameter("P_HAA_SPC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _ob.HAA_SPC_VAL;
            param[88] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_HPT_ARR_ACCNEW", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017-sep-30
        public decimal getSuppliValue(string accno, string rectype, DateTime fdate, DateTime tdate, string com, string pc)
        {
            decimal value = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[1] = new OracleParameter("P_RECTP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rectype;
            (param[2] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[3] = new OracleParameter("P_LDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = tdate;
            (param[4] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[5] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[6] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_SUPPREMITTEDVAL", CommandType.StoredProcedure, false, param);
            if (dtTemp != null)
            {
                if (dtTemp.Rows.Count > 0)
                {
                    if (dtTemp.Rows[0][0].ToString() != "")
                    {
                        value = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                    }

                }
            }
            return value;
        }
        public List<hpt_arr_acc> GetArrBalAccHdrByCode(string com, string manager, DateTime date)
        {
            List<hpt_arr_acc> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_MANAGER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = manager;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date.Date;
            (param[3] = new OracleParameter("P_PREVDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = date.Date.AddMonths(-1);
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_TOT_ARR_ADJ", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpt_arr_acc>(dtTemp, hpt_arr_acc.Converter2);
            }
            return oResult;
        }
        //subodana2017-oct02
        public List<hpr_disr_val_ref> AmountDisregard(decimal closbal, Int32 tp)
        {
            List<hpr_disr_val_ref> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_CLOSBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = closbal;
            (param[1] = new OracleParameter("P_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tp;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_DISREGARD", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_disr_val_ref>(dtTemp, hpr_disr_val_ref.webConverter);
            }
            return oResult;
        }
        //subodana2017-oct02
        public List<hpr_disr_val_ref> GraceperiodnotQulified(DateTime dates, Int32 tp, string com, string pc, decimal val)
        {
            List<hpr_disr_val_ref> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_DATES", OracleDbType.Date, null, ParameterDirection.Input)).Value = dates;
            (param[1] = new OracleParameter("P_TP", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tp;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[4] = new OracleParameter("P_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = val;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_NOTQULIFIED", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpr_disr_val_ref>(dtTemp, hpr_disr_val_ref.webConverter);
            }
            return oResult;
        }
        //subodana2017-oct02
        public List<BonusDefinition> GetCollecBonusDet(string com, decimal rate, decimal yrs, string pccat, DateTime mngcrdt, Int64 NoOfAcc, decimal Avgacc, DateTime Commdate, String PC)
        {
            List<BonusDefinition> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = rate;
            (param[2] = new OracleParameter("P_YEAR", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = yrs;
            (param[3] = new OracleParameter("P_PCCAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pccat;
            (param[4] = new OracleParameter("P_CRTDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = mngcrdt;
            (param[5] = new OracleParameter("P_ACCOUNTS", OracleDbType.Int64, null, ParameterDirection.Input)).Value = NoOfAcc;
            (param[6] = new OracleParameter("P_AVGACC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Avgacc;
            (param[7] = new OracleParameter("P_COMDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = Commdate;
            (param[8] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = PC;
            param[9] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_C_BONU_DEF", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<BonusDefinition>(dtTemp, BonusDefinition.webConverter);
            }
            return oResult;
        }
        //subodana
        public DataTable GetPCType(string cat)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_GET_PC_CAT", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana
        public DataTable GetEPF_ESP(string com, string pc, DateTime date)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_GET_EPF_ESP", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //subodana
        public int FinalizCollecBonus(hpt_col_bonus_vou _bonus)
        {
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_HPBV_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bonus.hpbv_month.Date;
            (param[1] = new OracleParameter("P_HPBV_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonus.hpbv_com;
            (param[2] = new OracleParameter("P_HPBV_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonus.hpbv_pc;
            (param[3] = new OracleParameter("P_HPBV_VOU_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonus.hpbv_vou_no;
            (param[4] = new OracleParameter("P_HPBV_GROSS_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = _bonus.hpbv_gross_bonus;
            (param[5] = new OracleParameter("P_HPBV_DEDUCT", OracleDbType.Double, null, ParameterDirection.Input)).Value = _bonus.hpbv_deduct;
            (param[6] = new OracleParameter("P_HPBV_REFUND", OracleDbType.Double, null, ParameterDirection.Input)).Value = _bonus.hpbv_refund;
            (param[7] = new OracleParameter("P_HPBV_NET_BONUS", OracleDbType.Double, null, ParameterDirection.Input)).Value = _bonus.hpbv_net_bonus;
            (param[8] = new OracleParameter("P_HPBV_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonus.hpbv_cre_by;
            (param[9] = new OracleParameter("P_HPBV_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bonus.hpbv_cre_dt;
            (param[10] = new OracleParameter("P_HPBV_CLAIM_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bonus.hpbv_claim_stus;
            (param[11] = new OracleParameter("P_HPBV_CLAIM_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bonus.hpbv_claim_by;
            (param[12] = new OracleParameter("P_HPBV_CLAIM_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bonus.hpbv_claim_dt;
            param[13] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_FINLZ_COLL_BONUS", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana
        public bool CheckSunRef(string refno, string _trdt)
        {
            DataTable _result = null;
            bool _res = false;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = refno;
            (param[1] = new OracleParameter("P_TRDT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trdt;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_CHECK_SUN_REFNO", CommandType.StoredProcedure, false, param);
            if (_result != null)
            {
                if (_result.Rows.Count > 0)
                {
                    _res = true;
                }
            }
            return _res;
        }
        //subodana
        public bool CheckClosBal(string accno, DateTime date, decimal sysbal, out decimal _bal)
        {
            DataTable _result = null;
            bool _res = true;
            _bal = 0;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_CHECK_CLOSBALVAL", CommandType.StoredProcedure, false, param);
            if (_result != null)
            {
                if (_result.Rows.Count > 0 && _result.Rows[0][0].ToString() != "")
                {
                    decimal closbal = Convert.ToDecimal(_result.Rows[0][0].ToString());
                    if (sysbal > closbal)
                    {
                        _res = false;
                        _bal = closbal;
                    }

                }
            }
            return _res;
        }

        //Dilshan 04/10/2017
        public DataTable CollBonusVoucher(string pcCode, DateTime frmDate, string comCode)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_pcCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pcCode;
            (param[1] = new OracleParameter("p_FromDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDate;
            (param[2] = new OracleParameter("p_comCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = comCode;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _SlsCon = QueryDataTable("CollectionBonusVoucher", "sp_get_BonusVoucher", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        //subodana 2017-10-17
        public List<ImpCusdecItmCost> GET_CUSDEC_ITEM_COST_BY_DOCHS(String docno, string hs)
        {
            List<ImpCusdecItmCost> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_hs_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hs;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_get_cusdec_itm_hscost", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecItmCost>(dtTemp, ImpCusdecItmCost.Converter);
            return oResult;
        }
        public InventoryRequest GetInventoryRequestDataByReqNo(InventoryRequest _inputInventoryRequest)
        {
            InventoryRequest _inventoryRequest = null;

            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inputInventoryRequest.Itr_req_no;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Query Data base.
            DataTable _dtResults = QueryDataTable("tblInventoryRequestData", "sp_getinventoryrequestdata", CommandType.StoredProcedure, false, param);

            if (_dtResults.Rows.Count > 0)
            {
                //Convert datatable to relavant generic List.
                _inventoryRequest = DataTableExtensions.ToGenericList<InventoryRequest>(_dtResults, InventoryRequest.Converter)[0];
            }

            return _inventoryRequest;
        }
        public int SaveInventoryRequest(InventoryRequest _inventoryRequest)
        {
            int seqno = 0;
            OracleParameter[] param = new OracleParameter[39];
            (param[0] = new OracleParameter("p_itr_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_req_no;
            (param[1] = new OracleParameter("p_itr_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_com;
            (param[2] = new OracleParameter("p_itr_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_tp;
            (param[3] = new OracleParameter("p_itr_sub_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_sub_tp;
            (param[4] = new OracleParameter("p_itr_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_loc;
            (param[5] = new OracleParameter("p_itr_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_ref;
            (param[6] = new OracleParameter("p_itr_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_dt;
            (param[7] = new OracleParameter("p_itr_exp_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exp_dt;
            (param[8] = new OracleParameter("p_itr_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_stus;
            (param[9] = new OracleParameter("p_itr_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_no;
            (param[10] = new OracleParameter("p_itr_bus_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_bus_code;
            (param[11] = new OracleParameter("p_itr_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_note;
            (param[12] = new OracleParameter("p_itr_issue_from", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_from;
            (param[13] = new OracleParameter("p_itr_rec_to", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_rec_to;
            (param[14] = new OracleParameter("p_itr_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_direct;
            (param[15] = new OracleParameter("p_itr_country_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_country_cd;
            (param[16] = new OracleParameter("p_itr_town_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_town_cd;
            (param[17] = new OracleParameter("p_itr_cur_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cur_code;
            (param[18] = new OracleParameter("p_itr_exg_rate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_exg_rate;
            (param[19] = new OracleParameter("p_itr_collector_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_id;
            (param[20] = new OracleParameter("p_itr_collector_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_collector_name;
            (param[21] = new OracleParameter("p_itr_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_act;
            (param[22] = new OracleParameter("p_itr_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_cre_by;
            (param[23] = new OracleParameter("p_itr_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_session_id;
            (param[24] = new OracleParameter("p_itr_issue_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_issue_com; //add chamal 17-08-2012
            (param[25] = new OracleParameter("p_itr_gran_opt1", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt1; //add chamal 17-08-2012
            (param[26] = new OracleParameter("p_itr_gran_opt2", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt2; //add chamal 17-08-2012
            (param[27] = new OracleParameter("p_itr_gran_opt3", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt3; //add chamal 17-08-2012
            (param[28] = new OracleParameter("p_itr_gran_opt4", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_opt4; //add chamal 17-08-2012
            (param[29] = new OracleParameter("p_itr_gran_nstus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_nstus; //add chamal 17-08-2012
            (param[30] = new OracleParameter("p_itr_gran_app_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_by; //add chamal 17-08-2012
            (param[31] = new OracleParameter("p_itr_gran_narrt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_narrt; //add chamal 17-08-2012
            (param[32] = new OracleParameter("p_itr_gran_app_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_note; //add chamal 17-08-2012
            (param[33] = new OracleParameter("p_itr_gran_app_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_gran_app_stus; //add chamal 17-08-2012
            (param[34] = new OracleParameter("p_itr_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal1; //add scahith 2012/11/3
            (param[35] = new OracleParameter("p_itr_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_anal2; //add scahith 2013/02/15
            (param[36] = new OracleParameter("p_itr_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_seq_no; //add Prabhath 2013/02/23
            (param[37] = new OracleParameter("P_itr_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequest.Itr_job_line; //add tharaka 2014-10-30
            param[38] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            seqno = UpdateRecords("sp_updateinventoryrequest", CommandType.StoredProcedure, param);
            _inventoryRequest.Itr_seq_no = seqno;
            return seqno;
        }
        public int SaveInventoryRequestItem(InventoryRequestItem _inventoryRequestItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[31];
            (param[0] = new OracleParameter("p_itri_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_seq_no;
            (param[1] = new OracleParameter("p_itri_line_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_line_no;
            if (_inventoryRequestItem.MasterItem != null)
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.MasterItem.Mi_cd;
            }
            else
            {
                (param[2] = new OracleParameter("p_itri_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            }

            (param[3] = new OracleParameter("p_itri_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_itm_stus;
            (param[4] = new OracleParameter("p_itri_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_qty;
            (param[5] = new OracleParameter("p_itri_unit_price", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_unit_price;
            (param[6] = new OracleParameter("p_itri_app_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_app_qty;
            (param[7] = new OracleParameter("p_itri_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_no;
            (param[8] = new OracleParameter("p_itri_note", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_note;
            (param[9] = new OracleParameter("p_itri_mitm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_cd;
            (param[10] = new OracleParameter("p_itri_mitm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mitm_stus;
            (param[11] = new OracleParameter("p_itri_mqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_mqty;
            (param[12] = new OracleParameter("p_itri_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_bqty;
            (param[13] = new OracleParameter("p_itri_itm_cond", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.ITRI_ITM_COND;
            (param[14] = new OracleParameter("P_itri_job_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_job_no;//Add by Suneth 20-11-2014
            (param[15] = new OracleParameter("P_itri_job_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_job_line;//Add by Suneth 20-11-2014
            (param[16] = new OracleParameter("P_itri_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_com;
            (param[17] = new OracleParameter("P_itri_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_loc;
            (param[18] = new OracleParameter("P_itri_po_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_po_qty;
            (param[19] = new OracleParameter("P_itri_iss_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_issue_qty;
            (param[20] = new OracleParameter("P_itri_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_qty;
            (param[21] = new OracleParameter("P_itri_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_res_line;
            (param[22] = new OracleParameter("P_itri_cncl_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_cncl_qty;
            (param[23] = new OracleParameter("P_itri_shop_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_shop_qty;
            (param[24] = new OracleParameter("P_itri_fd_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_fd_qty;
            (param[25] = new OracleParameter("P_itri_git_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_git_qty;
            (param[26] = new OracleParameter("P_itri_buffer", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_buffer;
            (param[27] = new OracleParameter("P_itri_advan_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_advan_qty;
            (param[28] = new OracleParameter("P_itri_base_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_base_req_no;//Add by Rukshan 19-12-2015
            (param[29] = new OracleParameter("P_itri_base_req_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _inventoryRequestItem.Itri_base_req_line;//Add by Rukshan 19-12-2015
            param[30] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_updateinventoryrequestitem", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //Tharaka 2015-10-13
        public List<InventoryRequestItem> GET_INT_REQ_ITM_BY_SEQ(Int32 seq)
        {
            List<InventoryRequestItem> result = new List<InventoryRequestItem>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "SP_GET_INT_REQ_ITM_BY_SEQ", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<InventoryRequestItem>(_dtResults, InventoryRequestItem.Converternew);
            return result;
        }
        public bool CheckIsAutoEntry(string Com, string type)
        {
            bool _isdoc = false;
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("dt", "SP_CHECK_CUSDECAUTO", CommandType.StoredProcedure, false, param);
            if (_SlsCon != null && _SlsCon.Rows.Count > 0)
            {
                _isdoc = true;
            }

            return _isdoc;
        }
        public DateTime GetEntryDatetime(string Com, string Entry)
        {
            DateTime _date = DateTime.Now;
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ENTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Entry;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("dt", "SP_GET_CUSDECCREDATETIME", CommandType.StoredProcedure, false, param);
            if (_SlsCon != null && _SlsCon.Rows.Count > 0)
            {
                _date = Convert.ToDateTime(_SlsCon.Rows[0][0].ToString());
            }

            return _date;
        }
        public DataTable GetEntryDateSNo(string Com, string Entry)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_ENTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Entry;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("dt", "SP_GET_CUSDECCREDATETIME", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        public DataTable GetEntryNumbers(string com, string Type, DateTime frmDate, DateTime todate)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            (param[2] = new OracleParameter("P_FRMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmDate;
            (param[3] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_GET_CUSDECNUMBERS", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        // ADD BY THARANGA 2017/01/25
        public DataTable GET_TAX_BY_INV_TYPE(string p_pc, DateTime p_from, DateTime p_to, string p_inv_type)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to;
            (param[3] = new OracleParameter("p_inv_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_inv_type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_GET_TAX_BY_INV_TYPE", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        // ADD BY THARANGA 2017/01/25
        public DataTable GNT_REM_SUM(string p_pc, DateTime p_from, DateTime p_to, Int32 p_rem_dayend)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to;
            (param[3] = new OracleParameter("p_rem_dayend", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_rem_dayend;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_GNT_REM_SUM", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        // ADD BY THARANGA 2017/01/26
        public DataTable SAT_RECEIPT_ALL_DET(string p_com, string p_pc, DateTime p_from, DateTime p_to)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_SAT_RECEIPT_ALL_DET", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }
        // ADD BY THARANGA 2017/01/26
        public DataTable SAT_Collec_summery(string p_com, string p_pc, DateTime p_from, DateTime p_to, Int32 p_oth_shp)
        {
            DataTable _SlsCon = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to;
            (param[4] = new OracleParameter("p_oth_shp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_oth_shp;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _SlsCon = QueryDataTable("DT", "SP_SAT_Collec_summery", CommandType.StoredProcedure, false, param);
            return _SlsCon;
        }

        //subodana
        public int SaveTargetCommRates(ref_comm_trgt_comm _trgcomm)
        {
            OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("P_RCTC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_doc_no;
            (param[1] = new OracleParameter("P_RCTC_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_exec;
            (param[2] = new OracleParameter("P_RCTC_MONTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _trgcomm.rctc_month;
            (param[3] = new OracleParameter("P_RCTC_TARGET", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _trgcomm.rctc_target;
            (param[4] = new OracleParameter("P_RCTC_ST_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _trgcomm.rctc_st_per;
            (param[5] = new OracleParameter("P_RCTC_END_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _trgcomm.rctc_end_per;
            (param[6] = new OracleParameter("P_RCTC_EXC_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _trgcomm.rctc_exc_rate;
            (param[7] = new OracleParameter("P_RCTC_MNGR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_mngr;
            (param[8] = new OracleParameter("P_RCTC_MNGR_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _trgcomm.rctc_mngr_rate;
            (param[9] = new OracleParameter("P_RCTC_ANAL1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_anal1;
            (param[10] = new OracleParameter("P_RCTC_ANAL2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_anal2;
            (param[11] = new OracleParameter("P_RCTC_CREBY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_creby;
            (param[12] = new OracleParameter("P_RCTC_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _trgcomm.rctc_cre_dt;
            (param[13] = new OracleParameter("P_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _trgcomm.rctc_stus;
            (param[14] = new OracleParameter("P_RCTC_YEAR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _trgcomm.rctc_year;
            (param[15] = new OracleParameter("P_RCTC_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _trgcomm.rctc_modby;
            (param[16] = new OracleParameter("P_RCTC_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _trgcomm.rctc_mod_dt;
            param[17] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_DEF_TARG_COMM_RTNWNEW", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2017-10-24
        public List<ref_comm_trgt_comm> GetTargetCommRates(string docno, string exec, Int32 _month, Int32 _year)
        {
            List<ref_comm_trgt_comm> oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_RCTC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("P_RCTC_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exec;
            (param[2] = new OracleParameter("P_RCTC_MONTH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _month;
            (param[3] = new OracleParameter("P_RCTC_YEAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _year;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_TARGT_COMMINEW", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ref_comm_trgt_comm>(dtTemp, ref_comm_trgt_comm.Converter);
            return oResult;
        }
        //subodana 2017-10-24
        public List<ref_comm_trgt_comm> GetTargetCommRates(string docno, Int32 _month, Int32 _year)
        {
            List<ref_comm_trgt_comm> oResult = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_RCTC_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("P_RCTC_MONTH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _month;
            (param[2] = new OracleParameter("P_RCTC_YEAR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _year;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_TARGT_COMMIALLNEW", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ref_comm_trgt_comm>(dtTemp, ref_comm_trgt_comm.Converter);
            return oResult;
        }
        public List<INR_RES_LOG> GET_INR_RES_LOG_DATA_NEW(INR_RES_LOG _resLog)
        {
            List<INR_RES_LOG> _list = new List<INR_RES_LOG>();
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_RES_NO;
            (param[1] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_CD;
            (param[2] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ITM_STUS;
            (param[3] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_COM;
            (param[4] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_LOC;
            (param[5] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_DOC_TP;
            (param[6] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_CURT_DOC_NO;
            (param[7] = new OracleParameter("p_irl_act", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resLog.IRL_ACT;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblBalance = QueryDataTable("inr_res", "sp_get_inr_res_log_data_new", CommandType.StoredProcedure, false, param);
            if (_tblBalance.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_LOG>(_tblBalance, INR_RES_LOG.ConvertAllData);
            }
            return _list;
        }
        public Int32 InrResLogDataUpdateIssue(INR_RES_LOG _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[16];
            (param[0] = new OracleParameter("p_irl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_SEQ;
            (param[1] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_RES_NO;
            (param[2] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_CD;
            (param[3] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_STUS;
            (param[4] = new OracleParameter("p_irl_res_iqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_IQTY;
            (param[5] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_COM;
            (param[6] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_LOC;
            (param[7] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_TP;
            (param[8] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_NO;
            (param[9] = new OracleParameter("p_irl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ACT;
            (param[10] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_BY_NEW;
            (param[11] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_DT;
            (param[12] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_SESSION;
            (param[13] = new OracleParameter("p_IRL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_LINE;
            (param[14] = new OracleParameter("p_irl_res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_WP;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_upd_inr_res_log_issue_new", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Lakshan 04 Nov 2016
        public Int32 InrResLogDataSave(INR_RES_LOG _obj)
        {
            int _eff = 0;
            OracleParameter[] param = new OracleParameter[33];
            (param[0] = new OracleParameter("p_irl_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_SEQ;
            (param[1] = new OracleParameter("p_irl_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_RES_NO;
            (param[2] = new OracleParameter("p_irl_res_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_LINE;
            (param[3] = new OracleParameter("p_irl_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_LINE;
            (param[4] = new OracleParameter("p_irl_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_CD;
            (param[5] = new OracleParameter("p_irl_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ITM_STUS;
            (param[6] = new OracleParameter("p_irl_res_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_QTY;
            (param[7] = new OracleParameter("p_irl_res_bqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_BQTY;
            (param[8] = new OracleParameter("p_irl_res_iqty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _obj.IRL_RES_IQTY;
            (param[9] = new OracleParameter("p_irl_orig_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_TP;
            (param[10] = new OracleParameter("p_irl_orig_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_NO;
            (param[11] = new OracleParameter("p_irl_orig_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_DOC_DT;
            (param[12] = new OracleParameter("p_irl_orig_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_ITM_LINE;
            (param[13] = new OracleParameter("p_irl_orig_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_BATCH_LINE;
            (param[14] = new OracleParameter("p_irl_orig_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_COM;
            (param[15] = new OracleParameter("p_irl_orig_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_ORIG_LOC;
            (param[16] = new OracleParameter("p_irl_curt_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_TP;
            (param[17] = new OracleParameter("p_irl_curt_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_NO;
            (param[18] = new OracleParameter("p_irl_curt_doc_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_DOC_DT;
            (param[19] = new OracleParameter("p_irl_curt_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_ITM_LINE;
            (param[20] = new OracleParameter("p_irl_curt_batch_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_BATCH_LINE;
            (param[21] = new OracleParameter("p_irl_curt_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_COM;
            (param[22] = new OracleParameter("p_irl_curt_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CURT_LOC;
            (param[23] = new OracleParameter("p_irl_base_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_BASE_LINE;
            (param[24] = new OracleParameter("p_irl_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_ACT;
            (param[25] = new OracleParameter("p_irl_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_BY;
            (param[26] = new OracleParameter("p_irl_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_DT;
            (param[27] = new OracleParameter("p_irl_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_CRE_SESSION;
            (param[28] = new OracleParameter("p_irl_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_BY_NEW;
            (param[29] = new OracleParameter("p_irl_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_DT;
            (param[30] = new OracleParameter("p_irl_mod_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRL_MOD_SESSION;
            (param[31] = new OracleParameter("p_irl_res_wp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _obj.IRL_RES_WP;
            param[32] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            _eff = (Int32)UpdateRecords("sp_save_inr_inr_res_log", CommandType.StoredProcedure, param);
            return _eff;
        }
        //Lakshan 24 Sep 2016
        public List<INR_RES> GET_INR_RES_DATA(INR_RES _obj)
        {
            List<INR_RES> _list = new List<INR_RES>();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_irs_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_COM;
            (param[1] = new OracleParameter("p_irs_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_RES_NO;
            (param[2] = new OracleParameter("p_irs_anal_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_ANAL_2;
            (param[3] = new OracleParameter("p_irs_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obj.IRS_STUS;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req", "sp_get_inr_res_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES>(_dtResults, INR_RES.ConverterNew);
            }
            return _list;
        }
        //Lakshan 2016  Oct 28
        public List<INR_RES_DET> GET_INR_RES_DET_DATA(INR_RES_DET _resDet)
        {
            List<INR_RES_DET> _list = new List<INR_RES_DET>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_ird_res_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_RES_NO;
            (param[1] = new OracleParameter("p_ird_itm_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_ITM_CD;
            (param[2] = new OracleParameter("p_ird_itm_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _resDet.IRD_ITM_STUS;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("int_req_itm", "sp_get_inr_res_det_data", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<INR_RES_DET>(_dtResults, INR_RES_DET.ConverterNew);
            }
            return _list;
        }
        //subodana
        public string GetRecAccount(string InvNo)
        {
            DataTable _result = null;
            string _acc = "";
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_GET_REC_ACCNT", CommandType.StoredProcedure, false, param);
            if (_result != null && _result.Rows.Count > 0)
            {
                _acc = _result.Rows[0][0].ToString();
            }
            return _acc;
        }
        //subodana
        public decimal GetBDLTransINV(string InvNo)
        {
            DataTable _result = null;
            decimal _acc = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_GET_TRANINV", CommandType.StoredProcedure, false, param);
            if (_result != null && _result.Rows.Count > 0)
            {
                _acc = Convert.ToDecimal(_result.Rows[0][0].ToString());
            }
            return _acc;
        }
        //subodana
        public string GetRecChassisNo(string InvNo)
        {
            DataTable _result = null;
            string _chassis = "";
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _result = QueryDataTable("tbl", "SP_GET_REC_CHASSIS", CommandType.StoredProcedure, false, param);
            if (_result != null && _result.Rows.Count > 0)
            {
                _chassis = _result.Rows[0][0].ToString();
            }
            return _chassis;
        }
        //subodana
        public List<MST_COST_ELE> GetCostEleSubType(String com, string code)
        {
            List<MST_COST_ELE> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[1] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_COSTELE_SUB", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<MST_COST_ELE>(dtTemp, MST_COST_ELE.Converter);
            return oResult;
        }
        //subodana
        public List<ImportsBLContainer> GetCostContainers(string sino)
        {
            List<ImportsBLContainer> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_COSTCONTAINER", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImportsBLContainer>(dtTemp, ImportsBLContainer.Converter);
            return oResult;
        }
        //subodana
        public List<IMP_CST_ELEREF_DET> GetCostEleSubDetails(Int64 seq, Int32 refline)
        {
            List<IMP_CST_ELEREF_DET> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = seq;
            (param[1] = new OracleParameter("P_REFLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = refline;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_COSTELE_SUBDET", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<IMP_CST_ELEREF_DET>(dtTemp, IMP_CST_ELEREF_DET.Converter);
            return oResult;
        }
        //subodana
        public List<IMP_CST_ELEREF_DET> GetCostEleSubDetailsAll(Int64 seq)
        {
            List<IMP_CST_ELEREF_DET> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_COSTELE_SUBDETALL", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<IMP_CST_ELEREF_DET>(dtTemp, IMP_CST_ELEREF_DET.Converter);
            return oResult;
        }
        //subodana 2017/11/02
        public int SaveCostRefDetails(IMP_CST_ELEREF_DET details)
        {
            OracleParameter[] param = new OracleParameter[14];
            (param[0] = new OracleParameter("P_ICED_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.iced_seq;
            (param[1] = new OracleParameter("P_ICED_ELE_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.iced_ele_line;
            (param[2] = new OracleParameter("P_ICED_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.iced_ref_line;
            (param[3] = new OracleParameter("P_ICED_DET_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.iced_det_line;
            (param[4] = new OracleParameter("P_ICED_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.iced_ref;
            (param[5] = new OracleParameter("P_ICED_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.iced_cd;
            (param[6] = new OracleParameter("P_ICED_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = details.iced_amt;
            (param[7] = new OracleParameter("P_ICED_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = details.iced_act;
            (param[8] = new OracleParameter("P_ICED_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.iced_cre_by;
            (param[9] = new OracleParameter("P_ICED_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = details.iced_cre_dt;
            (param[10] = new OracleParameter("P_ICED_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.iced_mod_by;
            (param[11] = new OracleParameter("P_ICED_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = details.iced_mod_dt;
            (param[12] = new OracleParameter("P_ICED_VEH_REG", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = details.iced_veh_reg;
            param[13] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_IMP_CST_ELEREF_DET", CommandType.StoredProcedure, param);
            return result;

        }
        public List<SunAALRec> GET_SUNRECREF(string InvNo)
        {
            List<SunAALRec> result = new List<SunAALRec>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = new DataTable();
            _dtResults = QueryDataTable("tblSerial", "SP_GET_SUN_RECREF", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
                result = DataTableExtensions.ToGenericList<SunAALRec>(_dtResults, SunAALRec.Converter);
            return result;
        }

        //Tharindu 2017/11/08
        public DataTable GetSales_with_InvoiceBalance(DateTime _fromDate, DateTime _toDate, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode, string _pc, string _loc)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[3] = new OracleParameter("cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[4] = new OracleParameter("cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[5] = new OracleParameter("cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[6] = new OracleParameter("cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[7] = new OracleParameter("brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[10] = new OracleParameter("pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[11] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tbl", "SP_SALES_WITH_CUR_INV_BAL_EXCL", CommandType.StoredProcedure, false, param);
        }
        public DataTable Process_Age_Anal_Debt_Outstand_veh_re(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _cust, Int32 _tp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_process_Age_Debt_Out_new", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public List<ImportsBLContainer> GetSIByContainer(string _container)
        {
            List<ImportsBLContainer> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_CONTAIN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _container;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_SIBYCONTAIN", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImportsBLContainer>(dtTemp, ImportsBLContainer.Converter);
            return oResult;
        }
        //subodana
        public decimal CostTransCost(string _com, string _type, string _costtype, string loc)
        {
            decimal cost = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            if (_costtype == "TRAN")
            {
                dtTemp = QueryDataTable("tbl", "SP_GET_TRANSCOST", CommandType.StoredProcedure, false, param);
            }
            else if (_costtype == "DOC")
            {
                dtTemp = QueryDataTable("tbl", "SP_GET_DOCUMCOST", CommandType.StoredProcedure, false, param);
            }


            if (dtTemp != null && dtTemp.Rows.Count > 0)
            {
                cost = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
            }
            return cost;
        }
        //subodana
        public decimal Ship_BankCost(string _com, string _bank, Int32 _foc, Int32 _garrent, string _type)
        {
            decimal cost = 0;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[2] = new OracleParameter("P_FOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _foc;
            (param[3] = new OracleParameter("P_GARR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _garrent;
            (param[4] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("tbl", "SP_GET_SHPBNKCOST", CommandType.StoredProcedure, false, param);
            if (dtTemp != null && dtTemp.Rows.Count > 0)
            {
                cost = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
            }
            return cost;
        }
        //Written by Rukshan 09/Nov/2015
        public Int32 Update_BI_Rqty(Int32 _number, string _ItemCode, int _ItemLine, decimal _qty, int _type)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _number;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            (param[4] = new OracleParameter("p_type", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _type;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updateBL_Item", CommandType.StoredProcedure, param);
            return effects;
        }
        //Written by Rukshan 11/Nov/2015
        public Int32 Update_Cusdec_Bqty(string _rno, string _ItemCode, int _ItemLine, decimal _qty)
        {
            OracleParameter[] param = new OracleParameter[5];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_Rno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rno;
            (param[1] = new OracleParameter("p_icode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ItemCode;
            (param[2] = new OracleParameter("p_itemline", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _ItemLine;
            (param[3] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _qty;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("pkg_inventory.sp_updateCusdec_bqty", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana 2016-08-01
        public Int32 UPDATE_RES_BQTYNew(String resNum, Int32 lineNum, decimal Qty)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_RES", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = resNum;
            (param[1] = new OracleParameter("P_LINENUM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNum;
            (param[2] = new OracleParameter("P_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Qty;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_RES_BQTYsi", CommandType.StoredProcedure, param);
            return result;
        }
        //add by tharanga 2017/11/23
        public DataTable GET_HP_Acc_Resc_His(string p_pc, DateTime _fromDate, DateTime _toDate, Int32 as_at_date)
        {
            //    
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[1] = new OracleParameter("p_from_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[2] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[3] = new OracleParameter("as_at_date", OracleDbType.Int32, null, ParameterDirection.Input)).Value = as_at_date;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_HP_Acc_Resc_His", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //add by Dilshan 2017/11/23
        public DataTable Get_rejectAccBalance_New(string _com, string _loc, DateTime _asatDate, string _userID)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[3] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_getRejectAcc_Bal", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //add by tharanga 2017/11/24
        public decimal Isurance_balance(string p_acc)
        {
            decimal cost = 0;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_acc;
            param[1] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "SP_GET_Isurance_balance", CommandType.StoredProcedure, false, param);
            if (dtTemp != null && dtTemp.Rows.Count > 0)
            {
                cost = Convert.ToDecimal(dtTemp.Rows[0][0].ToString());
                if (cost <= 0)
                {
                    cost = 0;
                }
            }
            return cost;
        }
        //add by tharanga 2017/11/24 // add service charge Tharindu 01-07
        public DataTable Collection_det(string p_pc, string accno, DateTime _Date, decimal _amount, out decimal _ins, out decimal _diriya, out decimal _collection, out decimal _servicecharge, Int32 p_ecd)
        { //p_pc IN NVARCHAR2, p_acc IN NVARCHAR2, p_date in Date, p_amount in number,
            decimal _insnew = 0;
            decimal _diriyanew = 0;
            decimal _collectionnew = 0;
            decimal _servicecharge_new = 0;
            _ins = 0;
            _diriya = 0;
            _collection = 0;
            _servicecharge = 0;
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[1] = new OracleParameter("p_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accno;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Date;
            (param[3] = new OracleParameter("p_amount", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amount;
            (param[4] = new OracleParameter("p_ecd", OracleDbType.Int32, null, ParameterDirection.Input)).Value = p_ecd;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_collection", CommandType.StoredProcedure, false, param);

            if (_dtResults != null)
            {
                if (_dtResults.Rows.Count > 0)
                {
                    _insnew = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
                    _diriyanew = Convert.ToDecimal(_dtResults.Rows[0][1].ToString());
                    _collectionnew = Convert.ToDecimal(_dtResults.Rows[0][2].ToString());
                    _servicecharge_new = Convert.ToDecimal(_dtResults.Rows[0][3].ToString());

                    _ins = _insnew;
                    _diriya = _diriyanew;
                    _collection = _collectionnew;
                    _servicecharge = _servicecharge_new;
                }
            }
            return _dtResults;
        }
        public string GetBOICUSANo(string entryno, string jobno, Int32 jobline, string resno)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_ENTRY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            (param[1] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            (param[2] = new OracleParameter("P_JOBLINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = jobline;
            (param[3] = new OracleParameter("P_RESNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = resno;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BOICUSANO", CommandType.StoredProcedure, false, param);
            string boino = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                boino = _dtResults.Rows[0][0].ToString();
            }
            return boino;
        }

        public string InvSINo(string jobno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_JOBNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = jobno;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_INVSI", CommandType.StoredProcedure, false, param);
            string sino = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                sino = _dtResults.Rows[0][0].ToString();
            }
            return sino;
        }
        public string ToBondSINo(string Sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TOBONDSI", CommandType.StoredProcedure, false, param);
            string tobond = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                tobond = _dtResults.Rows[0][0].ToString();
            }
            return tobond;
        }
        public decimal PendinResQtyFTobond(string tobond, Int32 line)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_TOBOND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tobond;
            (param[1] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_RESQTYTOBOND", CommandType.StoredProcedure, false, param);
            decimal qty = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                qty = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return qty;
        }
        public List<INT_REQ_SER> _INT_REQ_SER(Int32 _seqNo)
        {
            List<INT_REQ_SER> oResult = new List<INT_REQ_SER>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_itrs_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seqNo;

            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dt = new DataTable();
            dt = QueryDataTable("tbl_serials", "sp_getreqSerByseqNo", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<INT_REQ_SER>(dt, INT_REQ_SER.ConverterNEW);
            return oResult;
        }
        //Add by lakshan remove try catech 03Dec2017
        public Int32 SaveOPItemsWeb(OrderPlanItem orderplanItem)
        {
            int rows_affected = 0;
            OracleParameter[] param = new OracleParameter[35];
            (param[0] = new OracleParameter("p_IOI_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_SEQ_NO;
            (param[1] = new OracleParameter("p_IOI_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_OP_NO;
            (param[2] = new OracleParameter("p_IOI_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_LINE;
            (param[3] = new OracleParameter("p_IOI_REF_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_REF_LINE;
            (param[4] = new OracleParameter("p_IOI_F_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_F_LINE;
            (param[5] = new OracleParameter("p_IOI_STUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_STUS;
            (param[6] = new OracleParameter("p_IOI_YY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_YY;
            (param[7] = new OracleParameter("p_IOI_MM", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MM;
            (param[8] = new OracleParameter("p_IOI_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_CD;
            (param[9] = new OracleParameter("p_IOI_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_STUS;
            (param[10] = new OracleParameter("p_IOI_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MODEL;
            (param[11] = new OracleParameter("p_IOI_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_BRAND;
            (param[12] = new OracleParameter("p_IOI_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_DESC;
            (param[13] = new OracleParameter("p_IOI_ITM_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_TP;
            (param[14] = new OracleParameter("p_IOI_COLOR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_COLOR;
            (param[15] = new OracleParameter("p_IOI_MFC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MFC;
            (param[16] = new OracleParameter("p_IOI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_QTY;
            (param[17] = new OracleParameter("p_IOI_BAL_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_BAL_QTY;
            (param[18] = new OracleParameter("p_IOI_UOM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_UOM;
            (param[19] = new OracleParameter("p_IOI_UNIT_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_UNIT_RT;
            (param[20] = new OracleParameter("p_IOI_PI_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_PI_QTY;
            (param[21] = new OracleParameter("p_IOI_KIT_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_KIT_LINE;
            (param[22] = new OracleParameter("p_IOI_KIT_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_KIT_ITM_CD;
            (param[23] = new OracleParameter("p_IOI_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CRE_BY;
            (param[24] = new OracleParameter("p_IOI_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CRE_DT;
            (param[25] = new OracleParameter("p_IOI_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MOD_BY;
            (param[26] = new OracleParameter("p_IOI_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplanItem.IOI_MOD_DT;
            (param[27] = new OracleParameter("p_IOI_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_SESSION_ID;
            (param[28] = new OracleParameter("p_tag", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_TAG;
            (param[29] = new OracleParameter("p_project_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ProjectName;
            (param[30] = new OracleParameter("p_ioi_itm_tot_cbm", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_ITM_TOT_CBM;
            (param[31] = new OracleParameter("p_ioi_trd_agrement", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplanItem.IOI_Trade_AgreeMent;
            (param[32] = new OracleParameter("p_ioi_cont_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CONT_TYPE;
            (param[33] = new OracleParameter("p_ioi_cont_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplanItem.IOI_CONT_QTY;
            param[34] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("sp_save_order_plan_itms", CommandType.StoredProcedure, param);
            return rows_affected;
        }
        //Add by lakshan remove try catch PlaceOrder 03Dec2017
        public Tuple<int, int> PlaceOrderWeb(OrderPlanHeader orderplan)
        {
            int rows_affected = 0;
            int opderno = 0;
            OracleParameter[] param = new OracleParameter[35];
            (param[0] = new OracleParameter("p_IO_OP_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_OP_NO;
            (param[1] = new OracleParameter("p_IO_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_REF_NO;
            (param[2] = new OracleParameter("p_IO_OP_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_OP_DT;
            (param[3] = new OracleParameter("p_IO_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_COM;
            (param[4] = new OracleParameter("p_IO_SBU", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SBU;
            (param[5] = new OracleParameter("p_IO_SUPP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SUPP;
            (param[6] = new OracleParameter("p_IO_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TP;
            (param[7] = new OracleParameter("p_IO_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_RMK;
            (param[8] = new OracleParameter("p_IO_CUR", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_CUR;
            (param[9] = new OracleParameter("p_IO_EX_RT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_EX_RT;
            (param[10] = new OracleParameter("p_IO_TOP_CAT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOP_CAT;
            (param[11] = new OracleParameter("p_IO_TOP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOP;
            (param[12] = new OracleParameter("p_IO_TOS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TOS;
            (param[13] = new OracleParameter("p_IO_FRM_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_FRM_PORT;
            (param[14] = new OracleParameter("p_IO_TO_PORT", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_TO_PORT;
            (param[15] = new OracleParameter("p_IO_ETA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_ETA_DT;
            (param[16] = new OracleParameter("p_IO_IS_KIT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_IS_KIT;
            (param[17] = new OracleParameter("p_IO_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_STUS;
            (param[18] = new OracleParameter("p_IO_SEND", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_SEND;
            (param[19] = new OracleParameter("p_IO_SEND_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_SEND_DT;
            (param[20] = new OracleParameter("p_IO_AMD_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = orderplan.IO_AMD_SEQ;
            (param[21] = new OracleParameter("p_IO_TOT_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_TOT_QTY;
            (param[22] = new OracleParameter("p_IO_TOT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = orderplan.IO_TOT_AMT;
            (param[23] = new OracleParameter("p_IO_ANAL_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_1;
            (param[24] = new OracleParameter("p_IO_ANAL_2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_2;
            (param[25] = new OracleParameter("p_IO_ANAL_3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_3;
            (param[26] = new OracleParameter("p_IO_ANAL_4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_4;
            (param[27] = new OracleParameter("p_IO_ANAL_5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_ANAL_5;
            (param[28] = new OracleParameter("p_IO_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_CRE_BY;
            (param[29] = new OracleParameter("p_IO_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_CRE_DT;
            (param[30] = new OracleParameter("p_IO_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_MOD_BY;
            (param[31] = new OracleParameter("p_IO_MOD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = orderplan.IO_MOD_DT;
            (param[32] = new OracleParameter("p_IO_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = orderplan.IO_SESSION_ID;
            param[33] = new OracleParameter("o_auto", OracleDbType.Int32, null, ParameterDirection.Output);
            param[34] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            rows_affected = UpdateRecords("pkg_imports.sp_place_order_plan", CommandType.StoredProcedure, param);
            string value = param[33].Value.ToString();
            opderno = int.Parse(param[33].Value.ToString());
            return new Tuple<int, int>(rows_affected, opderno);
        }
        //subodana
        public decimal PendingResQty(string com, string item, string status, string tobond)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("P_TOBOND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tobond;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_GRNSTUSQTY", CommandType.StoredProcedure, false, param);
            decimal qty = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                if (_dtResults.Rows[0][0].ToString() != "")
                {
                    qty = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
                }

            }
            return qty;
        }
        //subodana
        public decimal AvalableGRNStatusQty(string com, string item, string status, string tobond)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = item;
            (param[2] = new OracleParameter("P_STATUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = status;
            (param[3] = new OracleParameter("P_TOBOND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tobond;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_GRNSTUSQTY2", CommandType.StoredProcedure, false, param);
            decimal qty = -1;
            decimal loopqty = 0;
            int i = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                foreach (var _dt in _dtResults.Rows)
                {
                    loopqty = loopqty + Convert.ToDecimal(_dtResults.Rows[i]["inb_free_qty"].ToString());
                    i++;
                }
                qty = loopqty;
            }
            return qty;
        }
        //subodana
        public string GetFinBankCode(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SIBANKCD", CommandType.StoredProcedure, false, param);
            string bankcd = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                bankcd = _dtResults.Rows[0][0].ToString();
            }
            return bankcd;
        }

        //Add by lakshan 03Dec2017
        public Int32 SaveItemModelInOrderPlan(MasterItemModel _model)
        {
            OracleParameter[] param = new OracleParameter[19];
            Int32 effects = -1;
            (param[0] = new OracleParameter("p_MM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cd;
            (param[1] = new OracleParameter("p_MM_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_desc;
            (param[2] = new OracleParameter("p_MM_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mm_act);
            (param[3] = new OracleParameter("p_MM_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cre_by;
            (param[4] = new OracleParameter("p_MM_MOD_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_mod_by;
            (param[5] = new OracleParameter("p_mm_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat1;
            (param[6] = new OracleParameter("p_mm_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat2;
            (param[7] = new OracleParameter("p_mm_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat3;
            (param[8] = new OracleParameter("p_mm_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat4;
            (param[9] = new OracleParameter("p_mm_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cat5;
            (param[10] = new OracleParameter("p_MM_IS_DIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = Convert.ToInt32(_model.Mm_is_dis);
            (param[11] = new OracleParameter("p_MM_DIS_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mm_dis_dt;
            (param[12] = new OracleParameter("p_Mm_taxstruc_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_taxstruc_cd;
            (param[13] = new OracleParameter("p_Mm_uom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_uom;
            (param[14] = new OracleParameter("p_mm_intro_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _model.Mm_intro_dt;
            (param[15] = new OracleParameter("p_mm_lifes", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _model.Mm_lifes;
            (param[16] = new OracleParameter("p_mm_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_brand;
            (param[17] = new OracleParameter("p_mm_cntry_of_orgn", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model.Mm_cntry_of_orgn;
            param[18] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("sp_save_item_model_op", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana
        public string GetFinPaytype(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SIBANKCD", CommandType.StoredProcedure, false, param);
            string type = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                type = _dtResults.Rows[0][1].ToString();
            }
            return type;
        }
        //subodana
        public string GetFinPaySubtype(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SIBANKCD", CommandType.StoredProcedure, false, param);
            string type = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                type = _dtResults.Rows[0][2].ToString();
            }
            return type;
        }

        //subodana
        public bool IsfocSI(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISFOCSI", CommandType.StoredProcedure, false, param);
            bool foc = true;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                foc = false;
            }
            return foc;
        }
        public bool IsShipGrnty(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISSHIPGARRNTY", CommandType.StoredProcedure, false, param);
            bool _garrnt = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                _garrnt = true;
            }
            return _garrnt;
        }
        //Rukshan 2015-08-13 copied to Finacial dal by lakshan 12Dec2017
        public Int32 SaveStockAllocate(MasterItemAllocate _MasterItemAllocate)
        {
            OracleParameter[] param = new OracleParameter[25];
            (param[0] = new OracleParameter("p_ISA_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_seq;
            (param[1] = new OracleParameter("p_ISA_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_dt;
            (param[2] = new OracleParameter("p_ISA_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_com;
            (param[3] = new OracleParameter("p_ISA_CHNL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_chnl;
            (param[4] = new OracleParameter("p_ISA_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_loc;
            (param[5] = new OracleParameter("p_ISA_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_tp;
            (param[6] = new OracleParameter("p_ISA_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_doc_tp;
            (param[7] = new OracleParameter("p_ISA_DOC_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_doc_no;
            (param[8] = new OracleParameter("p_ISA_DOC_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_doc_dt;
            (param[9] = new OracleParameter("p_ISA_ITM_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_itm_cd;
            (param[10] = new OracleParameter("p_ISA_ITM_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_itm_stus;
            (param[11] = new OracleParameter("p_ISA_ALOC_QTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_aloc_qty;
            (param[12] = new OracleParameter("p_ISA_ALOC_BQTY", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_aloc_bqty;
            (param[13] = new OracleParameter("p_ISA_ITM_CHANGED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_itm_changed;
            (param[14] = new OracleParameter("p_ISA_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_ref_no;
            (param[15] = new OracleParameter("p_ISA_REQ_QTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_req_qty;
            (param[16] = new OracleParameter("p_ISA_REQ_BQTY", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_req_bqty;
            (param[17] = new OracleParameter("p_ISA_ACT", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_act;
            (param[18] = new OracleParameter("p_ISA_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cre_by;
            (param[19] = new OracleParameter("p_ISA_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cre_dt;
            (param[20] = new OracleParameter("p_ISA_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_session_id;
            (param[21] = new OracleParameter("p_ISA_CNL_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_by;
            (param[22] = new OracleParameter("p_ISA_CNL_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_dt;
            (param[23] = new OracleParameter("p_ISA_CNL_SESSION_ID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterItemAllocate.Isa_cnl_session_id;
            param[24] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("pkg_inventory.SP_Save_stock_aloc", CommandType.StoredProcedure, param);
            return result;
        }
        public decimal GetLCVal(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SILCVAL", CommandType.StoredProcedure, false, param);
            decimal _val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                _val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return _val;
        }
        public decimal GetLCValFin(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SILCVALFIN", CommandType.StoredProcedure, false, param);
            decimal _val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                _val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return _val;
        }
        //subodana
        public Int32 GetExpiryMonths(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_EXPIRYMONTHS", CommandType.StoredProcedure, false, param);
            Int32 months = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                string expdate = _dtResults.Rows[0][0].ToString();
                string issuedate = _dtResults.Rows[0][1].ToString();

                if (expdate != "" && issuedate != "")
                {
                    months = Convert.ToDateTime(expdate).Subtract(Convert.ToDateTime(issuedate)).Days;
                }
            }
            return months;
        }
        public List<imp_cst_shp_bnk> GetAllBankData(string _com, string _bank, Int32 _foc, Int32 _garrent, string _type, string term, string subterm)
        {
            List<imp_cst_shp_bnk> oResult = new List<imp_cst_shp_bnk>();
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[2] = new OracleParameter("P_FOC", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _foc;
            (param[3] = new OracleParameter("P_GARR", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _garrent;
            (param[4] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[5] = new OracleParameter("P_TERM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = term;
            (param[6] = new OracleParameter("P_STERM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subterm;
            param[7] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbl_serials", "SP_GET_SHPBNKCOSTALL", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<imp_cst_shp_bnk>(dt, imp_cst_shp_bnk.Converter);
            return oResult;
        }
        //subodana 2017-12-19
        public bool Check_ele_license(string elecd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = elecd;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_CHECK_ISELELICENSE", CommandType.StoredProcedure, false, param);
            Int32 _val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                _val = Convert.ToInt32(_dtResults.Rows[0][0].ToString());
            }
            if (_val == 1)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
        //subodana 2017-12-20
        public bool Check_ele_license_cat(string com, string elecd, string itmcd)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = elecd;
            (param[2] = new OracleParameter("P_ITEMCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmcd;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_ELE_ITM_CAT", CommandType.StoredProcedure, false, param);
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
        //subodana 2017-12-20
        public decimal GetTotalDeliTarget(string com, string pc, DateTime fdate, DateTime todate, string exec)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_FDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = fdate;
            (param[3] = new OracleParameter("P_TDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            (param[4] = new OracleParameter("P_EXEC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = exec;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TOT_DEL_TARGET", CommandType.StoredProcedure, false, param);
            decimal _target = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                _target = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return _target;
        }
        //subodana
        public bool IsTOTFOC(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISTOTFOC", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                if (_dtResults.Rows[0][0].ToString() == "1")
                {
                    type = true;
                }
            }
            return type;
        }
        //subodana
        public string GetGRNno(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GRNNOSI", CommandType.StoredProcedure, false, param);
            string grn = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                grn = _dtResults.Rows[0][0].ToString();
            }
            return grn;
        }

        //subodana
        public string GetGRNnoSBU(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GRNNOSBU", CommandType.StoredProcedure, false, param);
            string SBU = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                SBU = _dtResults.Rows[0][0].ToString();
            }
            return SBU;
        }
        //subodana
        public DateTime GetGRNDate(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GRNNODATE", CommandType.StoredProcedure, false, param);
            DateTime grndate = DateTime.Now.Date;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                grndate = Convert.ToDateTime(_dtResults.Rows[0][0].ToString());
            }
            return grndate;
        }
        ////SUBODANA 2017-jan-03
        public int SaveSunAccountsAll(SunAccountall _sundata)
        {
            OracleParameter[] param = new OracleParameter[48];
            (param[0] = new OracleParameter("P_ACCNT_CODE", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.accnt_code;
            (param[1] = new OracleParameter("P_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.period;
            (param[2] = new OracleParameter("P_TRANS_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.trans_date;
            (param[3] = new OracleParameter("P_JRNAL_NO", OracleDbType.Int64, null, ParameterDirection.Input)).Value = _sundata.jrnal_no;
            (param[4] = new OracleParameter("P_JRNAL_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.jrnal_line;
            (param[5] = new OracleParameter("P_AMOUNT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _sundata.amount;
            (param[6] = new OracleParameter("P_D_C", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.d_c;
            (param[7] = new OracleParameter("P_ALLOCATION", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.allocation;
            (param[8] = new OracleParameter("P_JRNAL_TYPE", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.jrnal_type;
            (param[9] = new OracleParameter("P_JRNAL_SRCE", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.jrnal_srce;
            (param[10] = new OracleParameter("P_TREFERENCE", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.treference;
            (param[11] = new OracleParameter("P_DESCRIPTN", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.descriptn;
            (param[12] = new OracleParameter("P_ENTRY_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.entry_date;
            (param[13] = new OracleParameter("P_ENTRY_PRD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.entry_prd;
            (param[14] = new OracleParameter("P_DUE_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.due_date;
            (param[15] = new OracleParameter("P_ALLOC_REF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.alloc_ref;
            (param[16] = new OracleParameter("P_ALLOC_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.alloc_date;
            (param[17] = new OracleParameter("P_ALLOC_PERIOD", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.alloc_period;
            (param[18] = new OracleParameter("P_ASSET_IND", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.asset_ind;
            (param[19] = new OracleParameter("P_ASSET_CODE", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.asset_code;
            (param[20] = new OracleParameter("P_ASSET_SUB", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.asset_sub;
            (param[21] = new OracleParameter("P_CONV_CODE", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.conv_code;
            (param[22] = new OracleParameter("P_CONV_RATE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _sundata.conv_rate;
            (param[23] = new OracleParameter("P_OTHER_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _sundata.other_amt;
            (param[24] = new OracleParameter("P_OTHER_DP", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.other_dp;
            (param[25] = new OracleParameter("P_CLEARDOWN", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.cleardown;
            (param[26] = new OracleParameter("P_REVERSAL", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.reversal;
            (param[27] = new OracleParameter("P_LOSS_GAIN", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.loss_gain;
            (param[28] = new OracleParameter("P_ROUGH_FLAG", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.rough_flag;
            (param[29] = new OracleParameter("P_IN_USE_FLAG", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.in_use_flag;
            (param[30] = new OracleParameter("P_ANAL_T0", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t0;
            (param[31] = new OracleParameter("P_ANAL_T1", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t1;
            (param[32] = new OracleParameter("P_ANAL_T2", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t2;
            (param[33] = new OracleParameter("P_ANAL_T3", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t3;
            (param[34] = new OracleParameter("P_ANAL_T4", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t4;
            (param[35] = new OracleParameter("P_ANAL_T5", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t5;
            (param[36] = new OracleParameter("P_ANAL_T6", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t6;
            (param[37] = new OracleParameter("P_ANAL_T7", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t7;
            (param[38] = new OracleParameter("P_ANAL_T8", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t8;
            (param[39] = new OracleParameter("P_ANAL_T9", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.anal_t9;
            (param[40] = new OracleParameter("P_POSTING_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.posting_date;
            (param[41] = new OracleParameter("P_ALLOC_IN_PROGRESS", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.alloc_in_progress;
            (param[42] = new OracleParameter("P_HOLD_REF", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.hold_ref;
            (param[43] = new OracleParameter("P_HOLD_OP_ID", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.hold_op_id;
            (param[44] = new OracleParameter("P_LAST_CHANGE_USER_ID", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.last_change_user_id;
            (param[45] = new OracleParameter("P_LAST_CHANGE_DATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _sundata.last_change_date;
            (param[46] = new OracleParameter("P_ORIGINATOR_ID", OracleDbType.Char, null, ParameterDirection.Input)).Value = _sundata.originator_id;
            param[47] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_SUNIMPSCHEDULE", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana
        public DataTable GetCanibalizeHdrData(string docno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_CANILIZEDATA", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //add by lakshan
        public Int32 SaveBufferLevelOrderPlan(MasterBufferChannel _MasterBufferChannel)
        {
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_COM;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_CHNL;
            (param[2] = new OracleParameter("p_grad", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_GRADE;
            (param[3] = new OracleParameter("p_season", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_SEASON;
            (param[4] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_ITM_CD;
            (param[5] = new OracleParameter("p_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_ITM_STUS;
            (param[6] = new OracleParameter("p_qty", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_DEC_QTY;
            (param[7] = new OracleParameter("p_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_ACT;
            (param[8] = new OracleParameter("p_creby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_CRE_BY;
            (param[9] = new OracleParameter("p_cresession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_CRE_SESSION;
            (param[10] = new OracleParameter("p_modby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_MOD_BY;
            (param[11] = new OracleParameter("p_modsession", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _MasterBufferChannel.MBC_MOD_SESSION;

            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("pkg_inventory.sp_save_BufferLevel", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<SAT_ADJ_CRCD> GetAdjDetByCirc(string _com, string _ref, string _type)
        {
            List<SAT_ADJ_CRCD> oResult = new List<SAT_ADJ_CRCD>();
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_CIRCUL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[2] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbl_serials", "SP_GET_SATADjBYCODE", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<SAT_ADJ_CRCD>(dt, SAT_ADJ_CRCD.Converter);
            return oResult;
        }
        //subodana
        public bool IsSunAcc(string acccode, string com)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_ACCCODE", OracleDbType.Char, null, ParameterDirection.Input)).Value = acccode;
            (param[1] = new OracleParameter("P_COM", OracleDbType.Char, null, ParameterDirection.Input)).Value = com;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISSUNACC", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                type = true;
            }
            return type;
        }
        //subodana
        public bool IsTodayStatemant(string com, string pc, DateTime date, string bank)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.Char, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_STDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
            (param[3] = new OracleParameter("P_BANK", OracleDbType.Char, null, ParameterDirection.Input)).Value = bank;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISTodayState", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                type = true;
            }
            return type;
        }

        // Tharindu 2018-01-22
        public DataTable GetCreditCardPayDetails(string _Com, string _Pc, DateTime _FromDate, DateTime _ToDate, string _Bank, string _Mid, string _ReceiptNo, string _Userid)
        {
            DataTable _dtResults;
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Pc;
            (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[4] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bank;
            (param[5] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Mid;
            (param[6] = new OracleParameter("p_reciptno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ReceiptNo;
            (param[7] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Userid;
            param[8] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResults = QueryDataTable("tbl", "sp_get_crd_card_rec_details", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana 2018-01-25
        public List<SAT_ADJ_CRCD> GetCreditCardSunData(string _com, string _pc, string _type, DateTime _fdate, DateTime _tdate)
        {
            List<SAT_ADJ_CRCD> oResult = new List<SAT_ADJ_CRCD>();
            DataTable dt = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("P_FROMDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fdate;
            (param[4] = new OracleParameter("P_TODATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _tdate;
            param[5] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dt = QueryDataTable("tbl_serials", "SP_GET_CRCDSUN", CommandType.StoredProcedure, false, param);
            if (dt.Rows.Count > 0)
                oResult = DataTableExtensions.ToGenericList<SAT_ADJ_CRCD>(dt, SAT_ADJ_CRCD.Converter);
            return oResult;
        }
        public Int32 UPDATE_ADJSUN(string doc, Int32 value, string com)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_CIRCULNO", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = doc;
            (param[1] = new OracleParameter("P_STATUS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = value;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("UPDATE_SAT_ADJ_SUN", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 upd_bank_REALIZED(BankRealDet _bnkRls)
        {
            OracleParameter[] param = new OracleParameter[24];

            (param[0] = new OracleParameter("p_BSTD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_com;
            (param[1] = new OracleParameter("p_BSTD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_pc;
            (param[2] = new OracleParameter("p_BSTD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_dt;
            (param[3] = new OracleParameter("p_BSTD_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_accno;
            (param[4] = new OracleParameter("p_BSTD_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_tp;
            (param[5] = new OracleParameter("p_BSTD_DOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_desc;
            (param[6] = new OracleParameter("p_BSTD_DOC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_ref;
            (param[7] = new OracleParameter("p_BSTD_SYS_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_sys_val;
            (param[8] = new OracleParameter("p_BSTD_IS_REALIZED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_realized;
            (param[9] = new OracleParameter("p_BSTD_REALIZED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_realized_dt;
            (param[10] = new OracleParameter("p_BSTD_DOC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_val;
            (param[11] = new OracleParameter("p_BSTD_DOC_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank;
            (param[12] = new OracleParameter("p_BSTD_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_rmk;
            (param[13] = new OracleParameter("p_BSTD_DEPOSIT_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_deposit_bank;
            (param[14] = new OracleParameter("p_BSTD_DOC_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank_cd;
            (param[15] = new OracleParameter("p_BSTD_DOC_BANK_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_doc_bank_branch;
            (param[16] = new OracleParameter("p_BSTD_IS_NO_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_no_sun;
            (param[17] = new OracleParameter("p_BSTD_IS_NO_STATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_no_state;
            (param[18] = new OracleParameter("p_BSTD_IS_SCAN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_scan;
            (param[19] = new OracleParameter("p_BSTD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_by;
            //  (param[20] = new OracleParameter("p_BSTD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_dt;
            (param[20] = new OracleParameter("p_BSTD_IS_NEW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_is_new;
            (param[21] = new OracleParameter("p_bstd_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.bstd_is_extra;
            (param[22] = new OracleParameter("p_bstd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_seq_no;

            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_bank_REALIZED", CommandType.StoredProcedure, param);
            return effects;
        }
        //subodana
        public decimal GetFinINSVal(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_INSUVAL", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetFinWOFOCVal(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_WOFOCVAL", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetBLCostVal(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BL_COSTVAL", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetBLInsuVal(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BL_COSTVALINSU", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetBLOTHAmtVal(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BLOTHAMT", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetTaxValForCode(string invno, string taxcode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_INVNUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = invno;
            (param[1] = new OracleParameter("P_TAXCODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = taxcode;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TAXVALSUN", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana 2018-02-05
        public DateTime GetPCComGraceDate(string type, string code, DateTime month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            (param[1] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[2] = new OracleParameter("P_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = month;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_PCGRACEDT", CommandType.StoredProcedure, false, param);
            DateTime date = DateTime.Now.Date;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                date = Convert.ToDateTime(_dtResults.Rows[0][0].ToString()).Date;
            }
            return date;
        }
        //subodana
        public string GetSchemePeriod(string Acccd)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Acccd;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SCHEMEPER", CommandType.StoredProcedure, false, param);
            string val = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = _dtResults.Rows[0][0].ToString();
            }
            return val;
        }
        //subodana
        public string GetBondType(string Doc)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_DOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Doc;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BONDTYPE", CommandType.StoredProcedure, false, param);
            string val = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = _dtResults.Rows[0][0].ToString();
            }
            return val;
        }
        //subodana
        public string GetFinRefNo(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_FINREFNO", CommandType.StoredProcedure, false, param);
            string val = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = _dtResults.Rows[0][0].ToString();
            }
            return val;
        }
        //subodana 2018-02-06
        public DataTable LoadBonusAdjResons()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BONUSREASON", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public DataTable CheckSUNLC2(string COM, string CAT, string CODE)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = COM;
            (param[1] = new OracleParameter("p_cat", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CAT;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = CODE;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_SUNLCCOST2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        ////SUBODANA 2018-02-07
        public int SaveSunT4web(SunLC _obsunlcdata)
        {
            OracleParameter[] param = new OracleParameter[11];
            (param[0] = new OracleParameter("p_sun_db", OracleDbType.Char, null, ParameterDirection.Input)).Value = _obsunlcdata.sun_db;
            (param[1] = new OracleParameter("p_category", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.category;
            (param[2] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.code;
            (param[3] = new OracleParameter("p_lookup", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.lookup;
            (param[4] = new OracleParameter("p_updated", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.updated;
            (param[5] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.name;
            (param[6] = new OracleParameter("p_prohb_post", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.prohb_post;
            (param[7] = new OracleParameter("p_budget_check", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.budget_check;
            (param[8] = new OracleParameter("p_budget_stop", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.budget_stop;
            (param[9] = new OracleParameter("p_data_1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _obsunlcdata.data_1;
            param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_sunLC2", CommandType.StoredProcedure, param);
            return result;
        }
        //Add lakshan 13Nov2017
        public List<ImpCusdecItm> GET_CUSDEC_GRNITEM_DOC_WEB(String docno, string _type = null)
        {
            List<ImpCusdecItm> oResult = null;
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = docno;
            (param[1] = new OracleParameter("p_otherno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("tbl", "sp_get_cusdec_grnitm_web", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0) oResult = DataTableExtensions.ToGenericList<ImpCusdecItm>(dtTemp, ImpCusdecItm.Converter5);
            return oResult;
        }
        //subodana 2018/02/19
        public int DeleteArrearsDetails(string com, string pc, DateTime bonusdate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusdate;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_ARR_DET", CommandType.StoredProcedure, param);
            return result;
        }
        //Dulaj 2018/02/19
        public Int32 CheckReturnCheque(string srcq_chq, string chq_rtn_bank)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_srcq_chq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = srcq_chq;
                (param[1] = new OracleParameter("p_srcq_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chq_rtn_bank;

                OracleParameter orP = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                return ReturnSP_SingleValue("sp_chck_rtn_chq", CommandType.StoredProcedure, orP, param);
            }
            catch (Exception) { return 0; }
        }
        //Dulaj 2018/02/20
        public string GetRefNumber(string srcq_chq, string chq_rtn_bank)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                string _seq = "";
                (param[0] = new OracleParameter("p_srcq_chq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = srcq_chq;
                (param[1] = new OracleParameter("p_srcq_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chq_rtn_bank;
                param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _tblval = QueryDataTable("sat_rtn_chq", "sp_get_ref_number", CommandType.StoredProcedure, false, param);
                if (_tblval != null && _tblval.Rows.Count > 0)
                {
                    if (_tblval.Rows.Count > 0)
                    {
                        _seq = _tblval.Rows[0][0].ToString();
                    }
                }
                return _seq;


            }
            catch (Exception) { return ""; }
        }
        //Dulaj 2018/02/22
        public DataTable GetReturnChequeCountWithoutPc(string _ref, string _bCode)
        {

            OracleParameter[] param = new OracleParameter[3];
            DataTable _dtResults = null;
            (param[0] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[1] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bCode;
            // (param[2] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tblReturnCheque", "sp_getrtncheues_without_pc", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }



        //Tharindu 07-02-2018
        public DataTable Age_Anal_Debt_Outstand_Adv(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _cust, Int32 _tp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[6] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            // _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_Age_Debt_Out_new", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "sp_get_age_ana_dtr_advnc", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }

        //Tharindu 07-02-2018
        public DataTable Age_Anal_Debt_Outstand_Credit(DateTime _from, DateTime _to, string _com, string _pc, string _user, string _cust, Int32 _tp)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[5] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cust;
            (param[6] = new OracleParameter("p_tp", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _tp;
            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            // _dtResults = QueryDataTable("tbl", "pkg_fin_reports.sp_process_Age_Debt_Out_new", CommandType.StoredProcedure, false, param);
            _dtResults = QueryDataTable("tbl", "sp_get_age_dtr_creditbal", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public decimal GetTotLicenceQty(string sinum, string elecode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = elecode;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TOTLISEQTY", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        public decimal GetTotLicenceFocVal(string sinum, string elecode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = elecode;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TOTLISEFOCVAL", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        public decimal GetTotLicenceFocValUnit(string sinum, string elecode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = elecode;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TOTLISEFOCVALUNIT", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetCostItemQty(string sinum, Int32 line)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_COSTITEMQTY", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetCostItemValAmt(string sinum, Int32 line)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = line;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_COSTITEMAMOUNT", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //subodana
        public decimal GetCostItemValAmtUnit(string sinum, string itemcode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_ITEMCD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemcode;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_COSTITEMAMOUNTUNIT", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        public decimal GetTotLicenceVal(string sinum, string elecode)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            (param[1] = new OracleParameter("P_ELECD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = elecode;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_TOTLISEVAL", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        //  subodana 2018-03-09 
        public Int64 GetEffectiveCollSeq(string com, string pc, string account, DateTime bonusdate, DateTime effectivedate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = account;
            (param[3] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusdate.Date;
            (param[4] = new OracleParameter("P_EFFECTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = effectivedate;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_EFFECTADJSEQ", CommandType.StoredProcedure, false, param);
            Int64 val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                if (_dtResults.Rows.Count > 1)
                {
                    val = Convert.ToInt64(_dtResults.Rows[0][0].ToString());
                }

            }
            return val;
        }
        //  subodana 2018-03-09 
        public Int64 GetAllCollSeq(string com, string pc, string account, DateTime bonusdate, DateTime effectivedate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = account;
            (param[3] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusdate.Date;
            (param[4] = new OracleParameter("P_EFFECTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = effectivedate.Date;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_ALLMONTHADJSEQ", CommandType.StoredProcedure, false, param);
            Int64 val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                if (_dtResults.Rows.Count > 1)
                {

                    int i = 0;
                    foreach (var _row in _dtResults.Rows)
                    {
                        if (Convert.ToDateTime(_dtResults.Rows[i][1].ToString()) == effectivedate)
                        {
                            val = Convert.ToInt64(_dtResults.Rows[i][0].ToString());
                            return val;
                        }
                        i++;
                    }
                }

            }
            return val;
        }
        //  subodana 2018-03-09 
        public bool IsEffectiveColl(string com, string pc, string account, DateTime bonusdate, DateTime effectivedate)
        {
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = account;
            (param[3] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusdate.Date;
            (param[4] = new OracleParameter("P_EFFECTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = effectivedate;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_IS_EFFECTADJ", CommandType.StoredProcedure, false, param);
            bool val = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                if (_dtResults.Rows.Count > 0)
                {
                    val = true;
                }
            }
            return val;
        }

        //Tharindu 2018-03-06
        public DataTable getSalesOrderSummaryDetails(DateTime _fromDate, DateTime _toDate, string _com, string _otherloc, string _exec, string _pc, string _user, string _customer)
        {
            // Sanjeewa 16/06/2016
            OracleParameter[] param = new OracleParameter[9];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherloc;
            (param[7] = new OracleParameter("in_exec", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _exec;
            (param[8] = new OracleParameter("in_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;

            DataTable _result = QueryDataTable("tbl", "SP_GET_SO_DETAIL_SUM", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //  subodana 2018-03-12
        public Int64 GetEffectiveCollHDRSeq(string com, string pc, DateTime bonusdate, DateTime effectivedate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bonusdate.Date;
            (param[3] = new OracleParameter("P_EFFECTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = effectivedate;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_EFFECTADJSEQHDR", CommandType.StoredProcedure, false, param);
            Int64 val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                if (_dtResults.Rows.Count > 1)
                {
                    int i = 0;
                    foreach (var _row in _dtResults.Rows)
                    {
                        if (Convert.ToDateTime(_dtResults.Rows[i][1].ToString()) == effectivedate)
                        {
                            val = Convert.ToInt64(_dtResults.Rows[i][0].ToString());
                            return val;
                        }
                        i++;
                    }
                }

            }
            return val;
        }
        //subodana
        public decimal GetCostExchangeRAte(string sinum)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_COSTEXCHANGERATE", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return val;
        }
        public Int32 DeleteCommissionTrackData(string _com, string _pc, DateTime _from, DateTime _to)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (_para[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (_para[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            _para[4] = new OracleParameter("oeffect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_delete_commission_track", CommandType.StoredProcedure, _para);
            return result;
        }
        //  subodana 2018-03-15
        public bool IsOverCollAccount(string account, DateTime firstdate)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_ACC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = account;
            (param[1] = new OracleParameter("P_FIRSTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = firstdate.Date;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_IS_COLLECTOVERACC", CommandType.StoredProcedure, false, param);
            bool val = true;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                //if (_dtResults.Rows.Count > 0)
                //{
                //    val = false;
                //}
                val =  Convert.ToBoolean(_dtResults.Rows[0][0]);
                }
            return val;
        }
        public Decimal get_advance_count_itm_wise(string _itm, string _com, string _pc)
        {
            Decimal _totcount = 0;

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;

            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _result = QueryDataTable("tbl", "sp_get_advance_count", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                if (!string.IsNullOrEmpty(_result.Rows[0]["tot_count"].ToString()))
                {
                    _totcount = Convert.ToInt32(_result.Rows[0]["tot_count"]);
                }
            }
            return _totcount;
        }
        //  subodana 2018-03-21
        public Int64 GetJournalMaxSeq(string com, string type)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_MAXJOURNAL", CommandType.StoredProcedure, false, param);
            Int64 val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToInt64(_dtResults.Rows[0][0].ToString());

            }
            return val;
        }
        //  subodana 2018-03-21
        public Int64 UpdateMaxJournalNo(string _com, string _type, Int64 number)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[2] = new OracleParameter("p_number", OracleDbType.Int64, null, ParameterDirection.Input)).Value = number;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int64 result = UpdateRecords("sp_update_journmax", CommandType.StoredProcedure, param);
            return result;
        }
        //  subodana 2018-03-21
        public decimal GetGraceCollection(string Accno, DateTime supplydate, DateTime gracedate, string Com, string Pc, DateTime _bonusdt)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Accno;
            (param[1] = new OracleParameter("P_SUPDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = supplydate;
            (param[2] = new OracleParameter("P_GRACEDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = gracedate;
            (param[3] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[4] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pc;
            (param[5] = new OracleParameter("P_ASAT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bonusdt;
            param[6] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_ECDAMT", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());

            }
            return val;
        }


        //Akila 2018/02/26
        public List<MasterSalesPriorityHierarchy> GetPcInfo(string com, string pc, string code, string type)
        {
            List<MasterSalesPriorityHierarchy> _list = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            (param[3] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tbl", "sp_get_AllPc_info", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<MasterSalesPriorityHierarchy>(_dtResults, MasterSalesPriorityHierarchy.Converter);
            }
            return _list;
        }

        //Akila 2018/02/26
        public DataTable GetSunAccountDefinition(string _comCode, string _chnl, string _subChnl, string accNo, string _journalTp, string _journalSource)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_ComCode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _comCode;
            (param[1] = new OracleParameter("p_chnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chnl;
            (param[2] = new OracleParameter("p_SubChnl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _subChnl;
            (param[3] = new OracleParameter("p_AccNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = accNo;
            (param[4] = new OracleParameter("p_journalTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _journalTp;
            (param[5] = new OracleParameter("p_JournalSrs", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _journalSource;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("AccountDefinition", "SP_GET_SUN_ACC_DEF", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Akila 2018/02/27
        public Int16 UpdateGlbSosUpload(string _acoountNo, string journalTp, string _journalSource, string txnRef, string txnDesc)
        {
            OracleParameter[] param = new OracleParameter[6];
            Int16 effects = 0;
            (param[0] = new OracleParameter("p_AccountNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acoountNo;
            (param[1] = new OracleParameter("p_JournalTp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = journalTp;
            (param[2] = new OracleParameter("p_JournalSource", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _journalSource;
            (param[3] = new OracleParameter("p_TxnRef", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txnRef;
            (param[4] = new OracleParameter("p_TxnDesc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = txnDesc;

            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            effects = (Int16)UpdateRecords("SP_UPDATE_GLB_SOS_UPLOADE", CommandType.StoredProcedure, param);
            return effects;
        }

        //Akila 2018/02/27
        public DataTable GetGlbSosSummery()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("o_Result", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("Sos_Summery", "SP_GET_GLB_SOS_SUMMERY", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //subodana
        public string GetSICurrency(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_SICURRENCY", CommandType.StoredProcedure, false, param);
            string val = "";
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = _dtResults.Rows[0][0].ToString();
            }
            return val;
        }
        //  subodana 2018-03-27
        public decimal GetPrevMonthAdj(string Pc, DateTime bondate, DateTime effecdate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pc;
            (param[1] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bondate;
            (param[2] = new OracleParameter("P_EFFECDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = effecdate;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_PREV_ADJ", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());

            }
            return val;
        }
        //  subodana 2018-03-27
        public DataTable GetPrevMonthActArrears(string Pc, DateTime bondate, DateTime effecdate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pc;
            (param[1] = new OracleParameter("P_BONUSDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = bondate;
            (param[2] = new OracleParameter("P_EFFECDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = effecdate;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_PREV_Act_Arrears", CommandType.StoredProcedure, false, param);
            decimal val = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                val = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());

            }
            return _dtResults;
        }
        //subodana 2018-04-02 Modified 2018/Jun/02 By Dulaj add freightRate and remarks
        public int UpdateBuyingRates(string SINo, decimal Buying, decimal Costing, decimal frieghtRate, string remarks, decimal exRate)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_sino", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SINo;
            (param[1] = new OracleParameter("p_buyng", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Buying;
            (param[2] = new OracleParameter("p_costing", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = Costing;
            (param[3] = new OracleParameter("p_freigtRate", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = frieghtRate;
            (param[4] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remarks;
            (param[5] = new OracleParameter("p_ich_ex_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = exRate;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updatebuyngrates", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana
        public DataTable GetBuyingRates(string sinum)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sinum;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_BUYRATES", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //  subodana 2018-04-02
        public DataTable GetForcastRate(string SiNo, string Type)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_SINUM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SiNo;
            (param[1] = new OracleParameter("P_TYPE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Type;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GET_FORCSTRT", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public bool IsTOTOItem(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISTOTOItem", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {

                type = true;
            }
            return type;
        }
        //subodana
        public bool IsHUGOItem(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISHUGOItem", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {

                type = true;
            }
            return type;
        }
        //subodana
        public bool IsMotoBike(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISMotoBikeItem", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {

                type = true;
            }
            return type;
        }
        //dilshan
        public DataTable EvaluationSUNUpload2(string _month, DateTime _from, DateTime _to, string _com, string _pc, string _user, string _acc_period, string _sun_user, string _doctype)
        {
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_month", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _month;
            (param[1] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _from;
            (param[2] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _to;
            (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[6] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[7] = new OracleParameter("p_sun_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sun_user;
            (param[8] = new OracleParameter("p_doctype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctype;
            param[9] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //_result = QueryDataTable("tbl", "sp_getsunupload_valuation", CommandType.StoredProcedure, false, param);
            _result = QueryDataTable("tbl", "sp_getsunupload_valuation_2", CommandType.StoredProcedure, false, param);

            //if (_insuTp == "DIRIYA")
            //    _result = QueryDataTable("tbl", "pkg_financial.sp_process_sun_upload", CommandType.StoredProcedure, false, param);
            //else
            //    _result = QueryDataTable("tbl", "pkg_financial.sp_process_sun_upload_XYZ", CommandType.StoredProcedure, false, param);

            return _result;
        }

        public DataTable GetUploadForwardSalesDetails(DateTime _asAtDate, string _User, string _brand, string _model, string _itemcode, string _itemcat1, string _itemcat2, string _itemcat3, string _agetp, decimal _age, string _com, string _pc, string _latestcost, string _otherloc, string _customer, string _user, string _acc_period, string _sun_user)
        {
            // Sanjeewa 28-03-2013         
            OracleParameter[] param = new OracleParameter[19];
            param[0] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("asat_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asAtDate.Date;
            (param[2] = new OracleParameter("IN_USER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _User;
            (param[3] = new OracleParameter("in_Brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[4] = new OracleParameter("in_Model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[5] = new OracleParameter("in_Itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[6] = new OracleParameter("in_Itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat1;
            (param[7] = new OracleParameter("in_Itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat2;
            (param[8] = new OracleParameter("in_Itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcat3;
            (param[9] = new OracleParameter("in_agetp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _agetp;
            (param[10] = new OracleParameter("in_age", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _age;
            (param[11] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[12] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[13] = new OracleParameter("in_latestcost", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _latestcost;
            (param[14] = new OracleParameter("in_othloc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _otherloc;
            (param[15] = new OracleParameter("in_customer", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _customer;
            (param[16] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[17] = new OracleParameter("p_acc_period", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_period;
            (param[18] = new OracleParameter("p_sun_user_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sun_user;

            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_getsunupload_valuation_2", CommandType.StoredProcedure, false, param);
            //_dtResults = QueryDataTable("tbl", "pkg_forward_sales1.proc_fwd_sales2", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        //subodana
        public bool IsHEROMotoBike(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISHEROMotoBikeItem", CommandType.StoredProcedure, false, param);
            bool type = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {

                type = true;
            }
            return type;
        }
        //subodana
        public decimal HEROMotoBikeQTY(string sino)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sino;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_GETHERO_MOTOBIKE", CommandType.StoredProcedure, false, param);
            decimal qty = 0;
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                qty = Convert.ToDecimal(_dtResults.Rows[0][0].ToString());
            }
            return qty;
        }
        //tharanga 2018/04/05
        public List<Deposit_Bank_Pc_wise> get_Deposit_Bank_Pc_wise_det(string p_com, string p_prof_cen, string p_mid_no, DateTime p_frm_date, DateTime p_to_date)
        {
            List<Deposit_Bank_Pc_wise> _list = new List<Deposit_Bank_Pc_wise>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_prof_cen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_prof_cen;
            (param[2] = new OracleParameter("p_mid_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_mid_no;
            (param[3] = new OracleParameter("p_frm_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_frm_date;
            (param[4] = new OracleParameter("p_to_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to_date;

            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_1", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;
            DataTable _result = QueryDataTable("tbl", "SP_GET_MID_DETAILS", CommandType.StoredProcedure, false, param);

            if (_result.Rows.Count > 0)
            {
                //_list = DataTableExtensions.ToGenericList<Deposit_Bank_Pc_wise>(_result, Deposit_Bank_Pc_wise.Converter);
                _list = DataTableExtensions.ToGenericList<Deposit_Bank_Pc_wise>(_result, Deposit_Bank_Pc_wise.Converter1);
            }
            return _list;
        }
        //tharanga 2018/04/05
        public List<Deposit_Bank_Pc_wise> get_mid_details(string p_com, string p_prof_cen, string p_mid_no, string p_bandk, int p_period, string p_price_book, string p_price_level, string p_item, string p_promotion, string p_cat, string p_brand, DateTime p_to_date)
        {
            List<Deposit_Bank_Pc_wise> _list = new List<Deposit_Bank_Pc_wise>();
            DataTable _result = new DataTable();
            OracleParameter[] param = new OracleParameter[13];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("P_PROF_CEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_prof_cen;
            (param[2] = new OracleParameter("P_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bandk;
            (param[3] = new OracleParameter("P_PERIOD", OracleDbType.Int16, null, ParameterDirection.Input)).Value = p_period;
            (param[4] = new OracleParameter("P_P_BOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_price_book;
            (param[5] = new OracleParameter("P_P_LEVEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_price_level;
            (param[6] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_item;
            (param[7] = new OracleParameter("P_PROMOTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_promotion;
            (param[8] = new OracleParameter("P_CATEGORY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat;
            (param[9] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_brand;
            (param[10] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to_date;
            (param[11] = new OracleParameter("P_MPM_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "PC";
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //Boolean _isInvalidDayEndDate = QueryDataTable("tblItem", "sp_invalid_day_end_1", CommandType.StoredProcedure, false, param).Rows.Count > 0 ? true : false;
            _result = QueryDataTable("tbl", "SP_MID_VALIDATE", CommandType.StoredProcedure, false, param);
            if (_result.Rows.Count == 0)
            {
                SalesDAL _SalesDAL = new SalesDAL();
                DataTable odt = _SalesDAL.GetChanelOnPC(p_com, p_prof_cen, "SCHNL");
                if (odt.Rows.Count > 0)
                {
                    p_prof_cen = odt.Rows[0]["mpi_val"].ToString();
                }
                OracleParameter[] paramN = new OracleParameter[13];
                (paramN[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
                (paramN[1] = new OracleParameter("P_PROF_CEN", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_prof_cen;
                (paramN[2] = new OracleParameter("P_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bandk;
                (paramN[3] = new OracleParameter("P_PERIOD", OracleDbType.Int16, null, ParameterDirection.Input)).Value = p_period;
                (paramN[4] = new OracleParameter("P_P_BOOK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_price_book;
                (paramN[5] = new OracleParameter("P_P_LEVEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_price_level;
                (paramN[6] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_item;
                (paramN[7] = new OracleParameter("P_PROMOTION", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_promotion;
                (paramN[8] = new OracleParameter("P_CATEGORY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cat;
                (paramN[9] = new OracleParameter("P_BRAND", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_brand;
                (paramN[10] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to_date;
                (paramN[11] = new OracleParameter("P_MPM_PTY_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = "SCHNL";
                paramN[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _result = QueryDataTable("tbl", "SP_MID_VALIDATE", CommandType.StoredProcedure, false, paramN);
            }
            if (_result.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<Deposit_Bank_Pc_wise>(_result, Deposit_Bank_Pc_wise.Converter_new);
            }
            return _list;
        }
        //  subodana 2018-04-17
        public String GetEXPBOISunReqNo(string BondNo, string Loc)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_BONDNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = BondNo;
            (param[1] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Loc;
            param[2] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            string sunreq = "";
            _dtResults = QueryDataTable("tbl", "SP_GET_BOISUNREQ", CommandType.StoredProcedure, false, param);
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                sunreq = _dtResults.Rows[0][0].ToString();
            }
            return sunreq;
        }
        //subodana 2018-04-17
        public int UpdateBondLoc(string sunreq, string bondno, string loc)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SUNREQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sunreq;
            (param[1] = new OracleParameter("P_BONDNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bondno;
            (param[2] = new OracleParameter("P_LOC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updateBondLoc", CommandType.StoredProcedure, param);
            return result;
        }
        public DataTable get_cred_realization_Hdr(string _com, string _mid, string p_bank, DateTime _date, string p_user, string p_session, string p_account)
        {
            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            (param[2] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_bank;
            (param[3] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_user;
            (param[5] = new OracleParameter("p_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_session;
            (param[6] = new OracleParameter("p_account", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_account;

            param[7] = new OracleParameter("n_Cursor", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_cred_rls_hdr", CommandType.StoredProcedure, false, param);
            return _tblData;
        }
        public DataTable get_advance_dete(string _itm, string _loc)
        {
            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_advance_recept_det", CommandType.StoredProcedure, false, param);
            return _tblData;
        }

        //Tharindu 2018-04-24
        public DataTable GetAgeAnalysisDebotrsExecl(DateTime p_from, DateTime p_to, string p_com, string p_pc, string p_user, string p_cust, string p_tp, string p_excel)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_from.Date;
            (param[1] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_to.Date;
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[3] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[4] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_user;
            (param[5] = new OracleParameter("p_cust", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_cust;
            (param[6] = new OracleParameter("p_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_tp;
            param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[8] = new OracleParameter("in_excel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_excel;
            return QueryDataTable("tbl", "sp_get_age_analyis_adv_crd", CommandType.StoredProcedure, false, param);
        }
        //Subodana
        public List<hpt_arr_acc> GetAllBonusPCData(string pc, DateTime date, string com, string mnger)
        {
            List<hpt_arr_acc> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date.Date;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("P_MNGER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mnger;
            param[4] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_ARR_ALLCHNGES", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpt_arr_acc>(dtTemp, hpt_arr_acc.Converter);
            }
            return oResult;
        }
        //Subodana
        public List<hpt_arr_acc> GetMonthlyBonusPCData(string pc, DateTime date, string com, string mnger, DateTime effectdt)
        {
            List<hpt_arr_acc> oResult = null;
            DataTable dtTemp = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            (param[1] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = date.Date;
            (param[2] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[3] = new OracleParameter("P_MNGER", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mnger;
            (param[4] = new OracleParameter("P_EFDT", OracleDbType.Date, null, ParameterDirection.Input)).Value = effectdt.Date;
            param[5] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            dtTemp = QueryDataTable("HDR", "SP_GET_MONTHARRDATA", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<hpt_arr_acc>(dtTemp, hpt_arr_acc.Converter);
            }
            return oResult;


        }

        //add by tharanga 2018/04/24
        public DataTable Process_cred_realization(string in_com, string in_pc, DateTime in_recept_date, DateTime in_date, string in_user, string in_session, Int32 in_seq, string in_bank_cd, string in_mid_cd, string in_acc_no)
        {
            OracleParameter[] param = new OracleParameter[10];

            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_com;
            (param[1] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_pc;
            (param[2] = new OracleParameter("in_recept_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = in_recept_date;

            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_user;
            (param[4] = new OracleParameter("in_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_session;

            (param[5] = new OracleParameter("in_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = in_seq;
            (param[6] = new OracleParameter("in_bank_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_bank_cd;
            (param[7] = new OracleParameter("in_mid_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_mid_cd;
            (param[8] = new OracleParameter("in_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = in_acc_no;
            param[9] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_Process_cred_realization", CommandType.StoredProcedure, false, param);
            return _tblData;

        }
        public int GetCCRecTot_cred(string _com, DateTime _date, string _accno, out decimal _val)
        {
            Decimal _value = 0;
            DataTable _result = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _result = QueryDataTable("tbl", "sp_getcc_rectot_cred", CommandType.StoredProcedure, false, param);


            if (_result.Rows.Count > 0)
            {
                _value = Convert.ToDecimal(_result.Rows[0]["TOTCC"]);
            }
            _val = _value;
            return 1;
        }
        public Int32 UpdatecredRealizationDetails(gnt_cred_stmnt_det _bnkRls)
        {
            OracleParameter[] param = new OracleParameter[28];

            (param[0] = new OracleParameter("P_BSTD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_com;
            (param[1] = new OracleParameter("P_BSTD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_pc;
            (param[2] = new OracleParameter("P_BSTD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.cred_sth_dt;
            (param[3] = new OracleParameter("P_BSTD_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_accno;
            (param[4] = new OracleParameter("P_BSTD_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_tp;
            (param[5] = new OracleParameter("P_BSTD_DOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_desc;
            (param[6] = new OracleParameter("P_BSTD_DOC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_ref;
            (param[7] = new OracleParameter("P_BSTD_SYS_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_sys_val;
            (param[8] = new OracleParameter("P_BSTD_IS_REALIZED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_realized;
            (param[9] = new OracleParameter("P_BSTD_REALIZED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_realized_dt;
            (param[10] = new OracleParameter("P_BSTD_DOC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_val;
            (param[11] = new OracleParameter("P_BSTD_DOC_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_bank;
            (param[12] = new OracleParameter("P_BSTD_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_rmk;
            (param[13] = new OracleParameter("P_BSTD_DEPOSIT_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_deposit_bank;
            (param[14] = new OracleParameter("P_BSTD_DOC_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_bank_cd;
            (param[15] = new OracleParameter("P_BSTD_DOC_BANK_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_bank_branch;
            (param[16] = new OracleParameter("P_BSTD_IS_NO_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_no_sun;
            (param[17] = new OracleParameter("P_BSTD_IS_NO_STATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_no_state;
            (param[18] = new OracleParameter("P_BSTD_IS_SCAN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_scan;
            (param[19] = new OracleParameter("P_BSTD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_cre_by;
            //  (param[20] = new OracleParameter("p_BSTD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_dt;
            (param[20] = new OracleParameter("P_BSTD_IS_NEW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_new;
            (param[21] = new OracleParameter("P_BSTD_IS_EXTRA", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_extra;
            (param[22] = new OracleParameter("P_BSTD_SEQ_NO", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_seq;
            (param[23] = new OracleParameter("P_CRED_STD_BNK_CHG", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_bnk_chg;
            (param[24] = new OracleParameter("P_CRED_STD_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_mid;
            (param[25] = new OracleParameter("P_CRED_SETTLEMENT_AMT", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.cred_settlement_amt;
            (param[26] = new OracleParameter("P_CRED_SEQ_LINE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_seq_line;
            param[27] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("SP_UPD_CRED_RLS", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 UpdatecredRealizationHdr(string _Bsth_com, DateTime _Bsth_dt, string _Bsth_accno, Decimal _Bsth_opbal, Decimal _Bsth_realizes, Decimal _Bsth_prv_realize, Decimal _Bsth_cc, Decimal _Bsth_adj, Decimal _Bsth_clbal, Decimal _Bsth_state_bal, string _Bsth_stus, string _Bsth_cre_by, string _STH_MID, string _sessionid)
        {
            OracleParameter[] param = new OracleParameter[15];


            (param[0] = new OracleParameter("p_BSTH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_com;
            (param[1] = new OracleParameter("p_BSTH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Bsth_dt;
            (param[2] = new OracleParameter("p_BSTH_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_accno;
            (param[3] = new OracleParameter("p_BSTH_OPBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_opbal;
            (param[4] = new OracleParameter("p_BSTH_REALIZES", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_realizes;
            (param[5] = new OracleParameter("p_BSTH_PRV_REALIZE", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_prv_realize;
            (param[6] = new OracleParameter("p_BSTH_CC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_cc;
            (param[7] = new OracleParameter("p_BSTH_ADJ", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_adj;
            (param[8] = new OracleParameter("p_BSTH_CLBAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_clbal;
            (param[9] = new OracleParameter("p_BSTH_STATE_BAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _Bsth_state_bal;
            (param[10] = new OracleParameter("p_BSTH_STUS", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_stus;
            (param[11] = new OracleParameter("p_BSTH_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_cre_by;
            (param[12] = new OracleParameter("P_BSTH_MIDP_BSTH_MID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _STH_MID;
            (param[13] = new OracleParameter("P_sessionid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sessionid;

            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_cred_rls_hdr", CommandType.StoredProcedure, param);
            return effects;
        }
        //add by tharanga 2018/05/02
        public DataTable get_cred_serch_det(string _com, string _pc, DateTime _date, string _accno, string _doctp, Decimal _amtfrom, Decimal _amtto, Int32 _is_real_stus, Int32 _nt_in_state, Int32 _oth_bank, Int32 _withNIS, string _ref, string _bank, string _mid)
        {

            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (param[5] = new OracleParameter("p_amt_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtfrom;
            (param[6] = new OracleParameter("p_amt_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtto;
            (param[7] = new OracleParameter("p_is_real_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_real_stus;
            (param[8] = new OracleParameter("p_nt_in_state", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _nt_in_state;
            (param[9] = new OracleParameter("p_oth_bnk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _oth_bank;
            (param[10] = new OracleParameter("p_withNIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withNIS;
            (param[11] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblData = QueryDataTable("tbl", "sp_get_cred_rls_new1", CommandType.StoredProcedure, false, param);
            return _tblData;

            // OracleParameter[] param = new OracleParameter[15];

            // (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            // (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            // (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            // (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            // (param[4] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            // (param[5] = new OracleParameter("p_doctp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            // (param[6] = new OracleParameter("p_amt_from", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtfrom;
            // (param[7] = new OracleParameter("p_amt_to", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _amtto;
            // (param[8] = new OracleParameter("p_is_real_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _is_real_stus;
            // (param[9] = new OracleParameter("p_nt_in_state", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _nt_in_state;
            // (param[10] = new OracleParameter("p_oth_bnk", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _oth_bank;
            // (param[11] = new OracleParameter("p_withNIS", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _withNIS;
            // (param[12] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            // (param[13] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            // param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            //DataTable _tblData = QueryDataTable("tbl", "sp_get_cred_det", CommandType.StoredProcedure, false, param);//sp_get_cred_rls_new
            //// DataTable _tblData = QueryDataTable("tbl", "sp_get_cred_rls_new", CommandType.StoredProcedure, false, param);//

            // return _tblData;


        }
        public Boolean checkDoc_credk_State(string _pc, DateTime _dt, string _doctp, string _ref)
        {
            OracleParameter[] _para = new OracleParameter[5];
            (_para[0] = new OracleParameter("p_bstd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (_para[1] = new OracleParameter("p_bstd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _dt;
            (_para[2] = new OracleParameter("p_bstd_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doctp;
            (_para[3] = new OracleParameter("p_bstd_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            _para[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            Boolean _Found = QueryDataTable("tbl", "sp_chk_ref_bnkstate", CommandType.StoredProcedure, false, _para).Rows.Count > 0 ? true : false;
            return _Found;
        }
        public Int32 SavecredAdj(string _bsta_com, string _bsta_pc, DateTime _bsta_dt, string _bsta_accno, string _bsta_adj_tp, Decimal _bsta_amt, string _bsta_refno, string _bsta_rem, string _bsta_cre_by, string _mid, Int32 _seq, string _bankcd)
        {
            OracleParameter[] param = new OracleParameter[13];

            (param[0] = new OracleParameter("p_bsta_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_com;
            (param[1] = new OracleParameter("p_bsta_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_pc;
            (param[2] = new OracleParameter("p_bsta_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bsta_dt;
            (param[3] = new OracleParameter("p_bsta_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_accno;
            (param[4] = new OracleParameter("p_bsta_adj_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_adj_tp;
            (param[5] = new OracleParameter("p_bsta_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bsta_amt;
            (param[6] = new OracleParameter("p_bsta_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_refno;
            (param[7] = new OracleParameter("p_bsta_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_rem;
            (param[8] = new OracleParameter("p_bsta_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_cre_by;
            (param[9] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            (param[10] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            (param[11] = new OracleParameter("p_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bankcd;
            param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_save_cred_adj", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Save_cred_AdjDet(string _bsta_com, string _bsta_pc, DateTime _bsta_dt, string _bsta_accno, string _bsta_adj_tp, string _bsta_adj_tp_desc, string _bsta_refno, Decimal _bsta_amt, Int32 _is_realize, DateTime _is_realize_dt, Int32 _is_extra, string _user, DateTime _month, Int32 _week, string _bnk_id, string _bnk_cd, string _rem, string _mid, Int32 _seq, decimal _cred_std_bnk_chg)
        {
            OracleParameter[] param = new OracleParameter[21];

            (param[0] = new OracleParameter("p_bsta_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_com;
            (param[1] = new OracleParameter("p_bsta_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_pc;
            (param[2] = new OracleParameter("p_bsta_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bsta_dt;
            (param[3] = new OracleParameter("p_bsta_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_accno;
            (param[4] = new OracleParameter("p_bsta_adj_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_adj_tp;
            (param[5] = new OracleParameter("p_bsta_adj_tp_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_adj_tp_desc;
            (param[6] = new OracleParameter("p_bsta_refno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bsta_refno;
            (param[7] = new OracleParameter("p_bsta_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bsta_amt;
            (param[8] = new OracleParameter("p_is_realize", OracleDbType.Int32, 0, ParameterDirection.Input)).Value = _is_realize;
            (param[9] = new OracleParameter("p_is_realize_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _is_realize_dt;
            (param[10] = new OracleParameter("p_is_extra", OracleDbType.Int32, 0, ParameterDirection.Input)).Value = _is_extra;
            (param[11] = new OracleParameter("p_bsta_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[12] = new OracleParameter("p_month", OracleDbType.Date, null, ParameterDirection.Input)).Value = _month;
            (param[13] = new OracleParameter("p_week", OracleDbType.Int32, 0, ParameterDirection.Input)).Value = _week;
            (param[14] = new OracleParameter("p_bnk_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnk_id;
            (param[15] = new OracleParameter("p_bnk_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnk_cd;
            (param[16] = new OracleParameter("p_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _rem;
            (param[17] = new OracleParameter("p_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            (param[18] = new OracleParameter("p_seq", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _seq;
            (param[19] = new OracleParameter("p_cred_std_bnk_chg", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _cred_std_bnk_chg;
            param[20] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_save_cred_adj_dt", CommandType.StoredProcedure, param);
            return effects;
        }
        //add by tharanga 2018/05/02
        public DataTable Get_cred_Adj(string _com, DateTime _date, string _accno)
        {

            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_get_cred_adj", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        //add by tharanga 2018/05/02
        public Int32 update_cred_REALIZED(gnt_cred_stmnt_det _bnkRls)
        {
            OracleParameter[] param = new OracleParameter[24];

            (param[0] = new OracleParameter("p_BSTD_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_com;
            (param[1] = new OracleParameter("p_BSTD_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_pc;
            (param[2] = new OracleParameter("p_BSTD_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.cred_sth_dt;
            (param[3] = new OracleParameter("p_BSTD_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_accno;
            (param[4] = new OracleParameter("p_BSTD_DOC_TP", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_tp;
            (param[5] = new OracleParameter("p_BSTD_DOC_DESC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_desc;
            (param[6] = new OracleParameter("p_BSTD_DOC_REF", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_ref;
            (param[7] = new OracleParameter("p_BSTD_SYS_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_sys_val;
            (param[8] = new OracleParameter("p_BSTD_IS_REALIZED", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_realized;
            (param[9] = new OracleParameter("p_BSTD_REALIZED_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_realized_dt;
            (param[10] = new OracleParameter("p_BSTD_DOC_VAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_val;
            (param[11] = new OracleParameter("p_BSTD_DOC_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_bank;
            (param[12] = new OracleParameter("p_BSTD_RMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_rmk;
            (param[13] = new OracleParameter("p_BSTD_DEPOSIT_BANK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_deposit_bank;
            (param[14] = new OracleParameter("p_BSTD_DOC_BANK_CD", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_bank_cd;
            (param[15] = new OracleParameter("p_BSTD_DOC_BANK_BRANCH", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_doc_bank_branch;
            (param[16] = new OracleParameter("p_BSTD_IS_NO_SUN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_no_sun;
            (param[17] = new OracleParameter("p_BSTD_IS_NO_STATE", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_no_state;
            (param[18] = new OracleParameter("p_BSTD_IS_SCAN", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_scan;
            (param[19] = new OracleParameter("p_BSTD_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_cre_by;
            //  (param[20] = new OracleParameter("p_BSTD_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _bnkRls.Bstd_cre_dt;
            (param[20] = new OracleParameter("p_BSTD_IS_NEW", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_new;
            (param[21] = new OracleParameter("p_bstd_is_extra", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_std_is_extra;
            (param[22] = new OracleParameter("p_bstd_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _bnkRls.cred_seq;

            param[23] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_upd_bank_REALIZED", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Finalize_cred_Realization_final(string _Bsth_com, DateTime _Bsth_dt, string _Bsth_accno, string _user, string _session, string _mid)
        {
            OracleParameter[] param = new OracleParameter[6];


            (param[0] = new OracleParameter("p_BSTH_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_com;
            (param[1] = new OracleParameter("p_BSTH_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = _Bsth_dt;
            (param[2] = new OracleParameter("p_BSTH_ACCNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Bsth_accno;
            (param[3] = new OracleParameter("p_bsth_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[3] = new OracleParameter("p_bsth_mod_ses", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _session;
            (param[4] = new OracleParameter("p_cred_sth_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            Int32 effects;
            effects = (Int16)UpdateRecords("sp_fin_cred_rls", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_cred_AdjPC(string _com, string _pc, DateTime _date, string _accno, string _adjtp, string _ref, string _newpc, Decimal _val, string _newrem)
        {

            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_adjtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adjtp;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[6] = new OracleParameter("p_newpc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newpc;
            (param[7] = new OracleParameter("p_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _val;
            (param[8] = new OracleParameter("p_rem", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _newrem;
            param[9] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_upd_adj_cred_pc_new", CommandType.StoredProcedure, param);

            return result;
        }

        public int Update_bank_recon_remark(string _com, string _pc, DateTime _date, string _accno, string _adjtp, string _ref, string remark, Int32 _seq)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_adjtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adjtp;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[6] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remark;
            (param[7] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_upd_adj_remark", CommandType.StoredProcedure, param);

            return result;
        }
        public Int32 Update_bank_recon_hdr_status(string _com, DateTime _date, string _accno, string _status)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_bsth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bsth_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_bsth_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[3] = new OracleParameter("p_bsth_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_gnt_bnk_stmnt_hdr_status", CommandType.StoredProcedure, param);

            return result;
        }
        //add by tharanga 2018/05/08
        public DataTable chk_cheque_realized(string _com, string _pc, DateTime _date, string _doc_tp, string _doc_ref, string _acc_no)
        {

            OracleParameter[] param = new OracleParameter[6];

            (param[0] = new OracleParameter("p_bstd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bstd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            //(param[2] = new OracleParameter("p_bstd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_bstd_doc_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc_tp;
            (param[3] = new OracleParameter("p_bstd_doc_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _doc_ref;
            (param[4] = new OracleParameter("p_bstd_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc_no;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_chk_cheque_realized", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public DataTable LOAD_MID_DET(string _bank, string _mid)
        {

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_bstd_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _bank;
            (param[1] = new OracleParameter("p_bstd_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _mid;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblremsumhead", "SP_LOAD_MID_DET", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }


        public List<REF_TMPLT_HED> getTemplateHeaderDetails(bool withdeleted, int pgeNum, int pgeSize, string searchFld, string searchVal)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[6];
                if (!String.IsNullOrEmpty(searchVal))
                {
                    searchVal = "%" + searchVal + "%";
                }
                List<REF_TMPLT_HED> _list = new List<REF_TMPLT_HED>();
                (param[0] = new OracleParameter("p_withdeleted", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withdeleted;
                (param[1] = new OracleParameter("p_pgeNum", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pgeNum;
                (param[2] = new OracleParameter("p_pgeSize", OracleDbType.Int32, null, ParameterDirection.Input)).Value = pgeSize;
                (param[3] = new OracleParameter("p_searchFld", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchFld;
                (param[4] = new OracleParameter("p_searchVal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = searchVal;
                param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_FIELDTEMPLATES", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_TMPLT_HED>(_dtResults, REF_TMPLT_HED.ConverterSearch);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateStusTemplateHeader(int hedid, int stus, string updateby)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hedid;
                (param[1] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = stus;
                (param[2] = new OracleParameter("p_updateby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = updateby;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_UPDATE_FIELDTEMPLATESSTUS", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public REF_TMPLT_HED getTemplateHedDet(int hedid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                REF_TMPLT_HED _list = new REF_TMPLT_HED();
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hedid;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPHEDITM", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_TMPLT_HED>(_dtResults, REF_TMPLT_HED.Converter)[0];
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<REF_TMP_OBJHEDDET> getTemplateHedItemDet(int hedid)
        {

            try
            {
                OracleParameter[] param = new OracleParameter[2];
                List<REF_TMP_OBJHEDDET> _list = new List<REF_TMP_OBJHEDDET>();
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hedid;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPLATEFIELDLIST", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_TMP_OBJHEDDET>(_dtResults, REF_TMP_OBJHEDDET.Converter);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<REF_OBJ_LIST_DET> getTemplateComboDet(int detid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                List<REF_OBJ_LIST_DET> _list = new List<REF_OBJ_LIST_DET>();
                (param[0] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = detid;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPDROPDOWNDET", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_OBJ_LIST_DET>(_dtResults, REF_OBJ_LIST_DET.Converter);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateItemListStatus(int detid, string userid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = detid;
                (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_UPDATE_TEMPITMSTUS", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<REF_OBJ> getAllTemplateItemDetails()
        {
            try
            {
                OracleParameter[] param = new OracleParameter[1];
                List<REF_OBJ> _list = new List<REF_OBJ>();
                param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPLAEITEMS", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_OBJ>(_dtResults, REF_OBJ.Converter);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<REF_OBJ_LIST_DET> getTemplateComboDetItmDet(int itmid)
        {
            OracleParameter[] param = new OracleParameter[2];
            List<REF_OBJ_LIST_DET> _list = new List<REF_OBJ_LIST_DET>();
            (param[0] = new OracleParameter("p_itmid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itmid;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPDROPDOWNDETITEM", CommandType.StoredProcedure, false, param);
            if (_dtResults.Rows.Count > 0)
            {
                _list = DataTableExtensions.ToGenericList<REF_OBJ_LIST_DET>(_dtResults, REF_OBJ_LIST_DET.Converter);
            }
            return _list;
        }

        public int addTemplateField(int hedid, int detid, string name, string creby)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hedid;
                (param[1] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = detid;
                (param[2] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
                (param[3] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creby;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_ADD_TEMPLATEFIELD", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateLabelText(int id, string name, string userId)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_itmid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = id;
                (param[1] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
                (param[2] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_UPDATE_ITEMLABELTEXT", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public Int32 GetHeaderSeqID()
        {
            OracleParameter[] param = new OracleParameter[1];
            Int32 effects = 0;
            param[0] = new OracleParameter("o_hedid", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int32)UpdateRecords("SP_GET_TEMPLATEHEDSEQ", CommandType.StoredProcedure, param);
            return effects;
        }

        //Pasindu 15/05/2019
        public Int32 SAVE_RENT_PAYMENT_DETAILS(string p_autonumber, string p_paymenttype, string p_paymentsubtype, string psh_com, string psh_pc, string psh_add1, string psh_add2, string psh_dist, string psh_prv, string p_creditaccount, string p_debitaccount, string psh_frm_dt, string
psh_to_dt, string psh_ref_no, string psh_rmk, string psh_trm, string psh_cre_by, string p_sqfeet, string p_psh_no)
        {
            OracleParameter[] param = new OracleParameter[20];

            (param[0] = new OracleParameter("p_autonumber", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_autonumber;
            (param[1] = new OracleParameter("p_paymenttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_paymenttype;
            (param[2] = new OracleParameter("p_paymentsubtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_paymentsubtype;
            (param[3] = new OracleParameter("psh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_com;
            (param[4] = new OracleParameter("p_profitcen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_pc;
            (param[5] = new OracleParameter("p_address1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_add1;
            (param[6] = new OracleParameter("p_address2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_add2;
            (param[7] = new OracleParameter("p_sqfeet", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_sqfeet;
            (param[8] = new OracleParameter("p_isterminated", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_trm;
            (param[9] = new OracleParameter("p_district", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_dist;
            (param[10] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_rmk;
            (param[11] = new OracleParameter("p_provision", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_prv;
            (param[12] = new OracleParameter("p_creditaccount", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_creditaccount;
            (param[13] = new OracleParameter("p_debitaccount", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_debitaccount;
            (param[14] = new OracleParameter("p_agreementref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_ref_no;
            (param[15] = new OracleParameter("p_rentfromdt", OracleDbType.Date, null, ParameterDirection.Input)).Value = psh_frm_dt;
            (param[16] = new OracleParameter("p_renttodt", OracleDbType.Date, null, ParameterDirection.Input)).Value = psh_to_dt;
            (param[17] = new OracleParameter("p_createdby", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = psh_cre_by;
            (param[18] = new OracleParameter("p_psh_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psh_no;
            param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("SP_SAVE_PAYMENT_RENT", CommandType.StoredProcedure, param);
            return effects;
        }


        public List<SCH_PAY_COLUMN> getSCHColumns(string p_type)
        {
            try
            {
                List<SCH_PAY_COLUMN> columntypes = null;
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblcolumns", "SP_GET_PAYMENT_TYPE_COLUMNS", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    columntypes = DataTableExtensions.ToGenericList<SCH_PAY_COLUMN>(_dtResults, SCH_PAY_COLUMN.Converter);
                }
                return columntypes;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int32 SAVE_SCH_OWNER_DETAILS(string p_psa_fld_cd, string p_psa_hed_cd, string p_psa_clm_id, string p_psa_rec_id, string p_psa_value, string p_user)
        {
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_psa_fld_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_fld_cd;
            (param[1] = new OracleParameter("p_psa_hed_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_hed_cd;
            (param[2] = new OracleParameter("p_psa_clm_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_clm_id;
            (param[3] = new OracleParameter("p_psa_rec_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_rec_id;
            (param[4] = new OracleParameter("p_psa_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_value;
            (param[5] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_user;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("SP_UPDATE_SCH_OWNER_DETAILS", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<PAY_SCH_OWNERS_DET> getSCHOwnerDetails(string p_schid, string p_type)
        {
            try
            {
                List<PAY_SCH_OWNERS_DET> columntypes = null;
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_schid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_schid;
                (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblOwners", "SP_GET_SCH_OWNER_DETAILS", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    columntypes = DataTableExtensions.ToGenericList<PAY_SCH_OWNERS_DET>(_dtResults, PAY_SCH_OWNERS_DET.Converter);
                }
                return columntypes;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public Int32 REMOVE_SCH_OWNER(string p_psa_fld_cd, string p_psa_hed_cd, string p_psa_rec_id, string p_user)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_psa_fld_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_fld_cd;
            (param[1] = new OracleParameter("p_psa_hed_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_hed_cd;
            (param[2] = new OracleParameter("p_psa_rec_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psa_rec_id;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_user;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("SP_DELETE_SCH_OWNER", CommandType.StoredProcedure, param);
            return effects;
        }


        public Int32 SAVE_PAY_SCH_DETAILS(string p_psd_no, string p_psd_line, DateTime p_psd_due, string p_psd_amt, string p_psd_ded_amt, string p_psd_net_amt, string p_userid)
        {
            OracleParameter[] param = new OracleParameter[8];
            (param[0] = new OracleParameter("p_psd_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psd_no;
            (param[1] = new OracleParameter("p_psd_line", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psd_line;
            (param[2] = new OracleParameter("p_psd_due", OracleDbType.Date, null, ParameterDirection.Input)).Value = p_psd_due;
            (param[3] = new OracleParameter("p_psd_amt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psd_amt;
            (param[4] = new OracleParameter("p_psd_ded_amt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psd_ded_amt;
            (param[5] = new OracleParameter("p_psd_net_amt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psd_net_amt;
            (param[6] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_userid;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("SP_UPDATE_PAY_SCH_DET", CommandType.StoredProcedure, param);
            return effects;
        }
        //Pasindu 2018/05/28
        public Int32 UPDATE_SCH_STATUS(string p_psh_no, string p_userid)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_psh_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psh_no;
            (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_userid;
            param[2] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 effects;
            effects = (Int16)UpdateRecords("SP_UPDATE_SCH_STATUS", CommandType.StoredProcedure, param);
            return effects;
        }

        public List<PAY_SCHEDULE_DETAILS> getScheduleDetails(string p_psh_no)
        {
            try
            {
                List<PAY_SCHEDULE_DETAILS> columntypes = null;
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_psh_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_psh_no;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tblOwners", "SP_GET_SCH_SCHEDULE_DET", CommandType.StoredProcedure, false, param);

                if (_dtResults.Rows.Count > 0)
                {
                    columntypes = DataTableExtensions.ToGenericList<PAY_SCHEDULE_DETAILS>(_dtResults, PAY_SCHEDULE_DETAILS.Converter);
                }
                return columntypes;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }



        public int createTemplateHdr(int seq, string createby, string name, string desc)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[1] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = name;
                (param[2] = new OracleParameter("p_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = desc;
                (param[3] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = createby;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_ADD_TEMPLATEHDR", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        public int createTemplateDet(int seq, REF_TMPLT_DET_SIN itm)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[1] = new OracleParameter("p_itmid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itm.RTD_OBJ_ID;
                (param[2] = new OracleParameter("p_isval", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itm.RTD_IS_VALUE;
                (param[3] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.RTD_CRE_BY;
                (param[4] = new OracleParameter("p_name", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.RTD_NAME;
                (param[5] = new OracleParameter("p_srch", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.RTD_SRCH_FLD;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_ADD_TEMPLATEDET", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<REF_OBJ_TEMPITMFRM> getTemplateDetailtoFrom(int hedid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[2];
                List<REF_OBJ_TEMPITMFRM> _list = new List<REF_OBJ_TEMPITMFRM>();
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hedid;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPLATEITMFORFORM", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_OBJ_TEMPITMFRM>(_dtResults, REF_OBJ_TEMPITMFRM.Converter);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int commonSaveDynamicFieldValue(REF_TMPLT_VALUE itemVal, string uniqFieldValue)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[6];
                (param[0] = new OracleParameter("p_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = uniqFieldValue;
                (param[1] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itemVal.RTV_HED_ID;
                (param[2] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itemVal.RTV_DET_ID;
                (param[3] = new OracleParameter("p_usrid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemVal.RTV_CRE_BY;
                (param[4] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemVal.RTV_COM;
                param[5] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_UPDATE_DYNAMICFELDVALUE", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }

        }

        public List<REF_OBJ_TEMPITMFRM> getTeplateSavedData(string code, string company)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[3];
                List<REF_OBJ_TEMPITMFRM> _list = new List<REF_OBJ_TEMPITMFRM>();
                (param[0] = new OracleParameter("p_unqcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dtResults = QueryDataTable("tbl", "SP_GET_TEMPLATEITMFORFORMVALUE", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    _list = DataTableExtensions.ToGenericList<REF_OBJ_TEMPITMFRM>(_dtResults, REF_OBJ_TEMPITMFRM.ConverterWithVal);
                }
                return _list;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int removeDocumentTepllate(int hed, string assigncode, string userid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = assigncode;
                (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userid;
                (param[2] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hed;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects = (Int32)UpdateRecords("SP_UPDATE_FORMTEPLATEDET", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Wimal 18/May/2018
        public int Allocate_SUNReceipt(string p_comcode, string p_receiptno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_comcode;
            (param[1] = new OracleParameter("in_receipt_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_receiptno.Trim();
            param[2] = new OracleParameter("O_DATA", OracleDbType.Int16, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_allocate_sun_inv_rec", CommandType.StoredProcedure, false, param);
            int type = 1;
            return type;

        }
        //Wimal 18/May/2018
        public bool SUNPeriodclose(string p_comcode, string p_db, DateTime chkDate)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_comcode;
            (param[1] = new OracleParameter("in_sundb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_db;
            (param[2] = new OracleParameter("in_chkDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = chkDate.Date;
            param[3] = new OracleParameter("out_prcls", OracleDbType.Boolean, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_chk_sun_periodclose", CommandType.StoredProcedure, false, param);
            bool type = false;
            type = Convert.ToBoolean(param[3].Value.ToString());
            //if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            //{
            //    type = Convert.ToBoolean(_dtResults.Rows[0][0].ToString());

            //}
            return type;
        }
        //Wimal 18/May/2018
        public bool validateSUNACC(string p_comcode, string p_db, string p_accno)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_comcode;
            (param[1] = new OracleParameter("in_sundb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_db;
            (param[2] = new OracleParameter("in_acccode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_accno;
            param[3] = new OracleParameter("out_validAcc", OracleDbType.Boolean, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "sp_chk_sun_acccode", CommandType.StoredProcedure, false, param);
            bool type = false;
            //if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            //{
            //    type = Convert.ToBoolean(_dtResults.Rows[0][0].ToString());

            //}          
            type = Convert.ToBoolean(param[3].Value.ToString());
            return type;
        }


        //Tharindu
        public Int32 SaveFineChargesExecl(List<FineCharges> _lstfinecharges)
        {
            Int32 effects = 0;
            foreach (FineCharges _item in _lstfinecharges)
            {
                OracleParameter[] param = new OracleParameter[17];

                (param[0] = new OracleParameter("p_com_code", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.comcode;
                (param[1] = new OracleParameter("p_pc_code,", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.pccode;
                (param[2] = new OracleParameter("p_fine_code,", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.finecode;
                (param[3] = new OracleParameter("p_fine_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.finedate;
                (param[4] = new OracleParameter("p_fine_des", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.remarks;
                (param[5] = new OracleParameter("p_fine_amt,", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.amount;
                (param[6] = new OracleParameter("p_fine_rate,", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.rate;
                (param[7] = new OracleParameter("p_fine_bal,", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.balance;
                (param[8] = new OracleParameter("p_is_mail_send", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.ismailsend;
                (param[9] = new OracleParameter("p_stus", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.status;
                (param[10] = new OracleParameter("p_cre_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.createby;
                (param[11] = new OracleParameter("p_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.createdate;
                (param[12] = new OracleParameter("p_cre_by_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.createsession;
                (param[13] = new OracleParameter("p_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.modby;
                (param[14] = new OracleParameter("p_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.moddt;
                (param[15] = new OracleParameter("p_mod_by_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.modifysession;
                param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_fine_charges_execl", CommandType.StoredProcedure, param);

            }

            return effects;
        }

        //Tharindu 2018-05-08
        public Int32 SaveFineSetOff(string com, string pc, DateTime setdt, int status, string creby, DateTime credt, decimal setoffval, int seqno)
        {
            Int32 effects = 0;

            OracleParameter[] param = new OracleParameter[9];

            (param[0] = new OracleParameter("p_com_code", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc_code", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = pc;
            (param[2] = new OracleParameter("p_setoff_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = setdt;
            (param[3] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[4] = new OracleParameter("p_crd_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = creby;
            (param[5] = new OracleParameter("p_crd_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = credt;
            (param[6] = new OracleParameter("p_set_off_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = setoffval;
            (param[7] = new OracleParameter("p_seq_no", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seqno;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

            // effects = (Int16)UpdateRecords("sp_save_fine_setoff", CommandType.StoredProcedure, param);
            effects = (Int16)UpdateRecords("sp_save_fine_setoff_N", CommandType.StoredProcedure, param);

            return effects;
        }

        public DataTable chekSchemeValidCode(string p_type, string p_term)
        {

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_type;
            (param[1] = new OracleParameter("p_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_term;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_check_scheme_code", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Tharindu 2018-05-08
        public Int32 SaveTradingInterestDetails(List<TradingInterest> _lstTradingInterest)
        {
            Int32 effects = 0;
            foreach (TradingInterest _item in _lstTradingInterest)
            {
                OracleParameter[] param = new OracleParameter[16];

                (param[0] = new OracleParameter("p_mti_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_com;
                (param[1] = new OracleParameter("p_mti_sch_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_sch_cd;
                (param[2] = new OracleParameter("p_mti_sch_cat", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_sch_cat;
                (param[3] = new OracleParameter("p_mti_sch_trm", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.mti_sch_trm;
                (param[4] = new OracleParameter("p_mti_itm", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_itm;
                (param[5] = new OracleParameter("p_mti_cat1", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_cat1;
                (param[6] = new OracleParameter("p_mti_cat2", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_cat2;
                (param[7] = new OracleParameter("p_mti_cat3", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_cat3;
                (param[8] = new OracleParameter("p_mti_brnd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_brnd;
                (param[9] = new OracleParameter("p_mti_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _item.mti_rt;
                (param[10] = new OracleParameter("p_mti_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _item.mti_act;
                (param[11] = new OracleParameter("p_mti_frm", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.mti_frm;
                (param[12] = new OracleParameter("p_mti_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _item.mti_to;
                (param[13] = new OracleParameter("p_mti_cre_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_cre_by;
                (param[14] = new OracleParameter("p_mti_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _item.mti_mod_by;
                param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                effects = (Int16)UpdateRecords("sp_save_trading_details", CommandType.StoredProcedure, param);
            }

            return effects;
        }

        public DataTable GetTradingdetails(DateTime frmdte, DateTime todte)
        {

            OracleParameter[] param = new OracleParameter[3];

            (param[0] = new OracleParameter("fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = frmdte;
            (param[1] = new OracleParameter("todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todte;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults = QueryDataTable("tblremsumhead", "sp_get_trade_int_details", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public List<ref_acc_sgrp> GetAccMainType(string _company, string mtype)
        {
            List<ref_acc_sgrp> _acc = new List<ref_acc_sgrp>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_mtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mtype;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getaccmaintype", CommandType.StoredProcedure, false, param);
            if (_tblPriceBook.Rows.Count > 0)
            {
                _acc = DataTableExtensions.ToGenericList<ref_acc_sgrp>(_tblPriceBook, ref_acc_sgrp.Converter);
            }
            return _acc;
        }


        public DataTable GetSubTypes(string _company, string subgrp)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_subgrp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subgrp;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getaccsubtype", CommandType.StoredProcedure, false, param);
            return _tblPriceBook;
        }
        public DataTable GetAccountFMainTypes(string _company)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getaccmmtype", CommandType.StoredProcedure, false, param);
            return _tblPriceBook;
        }
        public Int32 UPDATE_ClosingBalAccounts(Int64 accounts, decimal closingbal, Int64 Seq)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = Seq;
            (param[1] = new OracleParameter("P_CLOSING", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = closingbal;
            (param[2] = new OracleParameter("P_ACCOUNTS", OracleDbType.Int64, null, ParameterDirection.Input)).Value = accounts;
            param[3] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_UPDATE_CLOSINGBAL", CommandType.StoredProcedure, param);
            return result;
        }
        //  subodana 2018-06-01
        public String GetSIItemCat1(string Itemcode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Itemcode;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            string cat = "";
            _dtResults = QueryDataTable("tbl", "SP_GET_SIITEMCAT1", CommandType.StoredProcedure, false, param);
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                cat = _dtResults.Rows[0][0].ToString();
            }
            return cat;
        }
        //  subodana 2018-06-01
        public String GetSIItemCat2(string Itemcode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Itemcode;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            string cat = "";
            _dtResults = QueryDataTable("tbl", "SP_GET_SIITEMCAT2", CommandType.StoredProcedure, false, param);
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                cat = _dtResults.Rows[0][0].ToString();
            }
            return cat;
        }
        public String GetModelHScode(string Itemcode)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Itemcode;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            string hs = "NULL";
            _dtResults = QueryDataTable("tbl", "SP_GET_MODELHSCODE", CommandType.StoredProcedure, false, param);
            if (_dtResults != null && _dtResults.Rows.Count > 0 && _dtResults.Rows[0][0].ToString() != "")
            {
                hs = _dtResults.Rows[0][0].ToString();
            }
            return hs;
        }
        public Int32 SaveAccountGrpDetails(ref_acc_sgrp GrpOb)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_ras_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_com;
            (param[1] = new OracleParameter("p_ras_mgrp_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_mgrp_cd;
            (param[2] = new OracleParameter("p_ras_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_cd;
            (param[3] = new OracleParameter("p_ras_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_desc;
            (param[4] = new OracleParameter("p_ras_sgrp_ord", OracleDbType.Int32, null, ParameterDirection.Input)).Value = GrpOb.ras_sgrp_ord;
            (param[5] = new OracleParameter("p_ras_hed_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_hed_cd;
            (param[6] = new OracleParameter("p_ras_hed_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_hed_desc;
            (param[7] = new OracleParameter("p_ras_hed_ord", OracleDbType.Int32, null, ParameterDirection.Input)).Value = GrpOb.ras_hed_ord;
            (param[8] = new OracleParameter("p_ras_is_sbtp", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_is_sbtp;
            (param[9] = new OracleParameter("p_ras_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = GrpOb.ras_act;
            (param[10] = new OracleParameter("p_ras_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_cre_by;
            (param[11] = new OracleParameter("p_ras_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = GrpOb.ras_cre_dt;
            (param[12] = new OracleParameter("p_ras_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = GrpOb.ras_mod_by;
            (param[13] = new OracleParameter("p_ras_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = GrpOb.ras_mod_dt;
            param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_CREATE_ACCOUNTGRP", CommandType.StoredProcedure, param);
            return effects;
        }

        //add by tharanga 2018/05/08
        public Int32 save_cred_rls_hdr(gnt_cred_stmnt_hdr _gnt_cred_stmnt_hdr)
        //_com, string _cred_sth_bank, string _cred_sth_mid, string _cred_sth_accno, Decimal _cred_sth_opbal, Decimal _cred_sth_realizes,
        //Decimal _cred_sth_prv_realize,
        //Decimal _cred_sth_cc,
        //Decimal _cred_sth_clbal,
        //Decimal _cred_sth_state_bal,
        //Decimal _cred_sth_adj,
        //string _cred_sth_cre_by, string _cred_sth_stus, string _cre_session)
        {

            OracleParameter[] param = new OracleParameter[16];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_com;
            (param[1] = new OracleParameter("p_sth_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_dt;
            (param[2] = new OracleParameter("p_cred_sth_bank", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_bank;
            (param[3] = new OracleParameter("p_cred_sth_mid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_mid;
            (param[4] = new OracleParameter("p_cred_sth_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_accno;
            (param[5] = new OracleParameter("p_cred_sth_opbal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_opbal;
            (param[6] = new OracleParameter("p_cred_sth_realizes", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_prv_realize;
            (param[7] = new OracleParameter("p_cred_sth_prv_realize", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_prv_realize;
            (param[8] = new OracleParameter("p_cred_sth_cc", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_cc;
            (param[9] = new OracleParameter("p_cred_sth_adj", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_adj;
            (param[10] = new OracleParameter("p_cred_sth_clbal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_clbal;
            (param[11] = new OracleParameter("p_cred_sth_state_bal", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_state_bal;
            (param[12] = new OracleParameter("p_cred_sth_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_cre_by;

            (param[13] = new OracleParameter("p_cred_sth_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_stus;
            (param[14] = new OracleParameter("p_cre_session", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _gnt_cred_stmnt_hdr.cred_sth_cre_session;
            param[15] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_cred_rls_hdr", CommandType.StoredProcedure, param);
            return result;
        }
        public Int32 SaveChartAccountDetails(ref_cht_acc _acc)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[32];
            (param[0] = new OracleParameter("p_rca_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_com;
            (param[1] = new OracleParameter("p_rca_sbu", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_sbu;
            (param[2] = new OracleParameter("p_rca_mgrp_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_mgrp_cd;
            (param[3] = new OracleParameter("p_rca_hed_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_hed_cd;
            (param[4] = new OracleParameter("p_rca_hed_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_hed_desc;
            (param[5] = new OracleParameter("p_rca_hed_ord", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_hed_ord;
            (param[6] = new OracleParameter("p_rca_sgrp_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_sgrp_cd;
            (param[7] = new OracleParameter("p_rca_sgrp_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_sgrp_desc;
            (param[8] = new OracleParameter("p_rca_sgrp_ord", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.rca_sgrp_ord;
            (param[9] = new OracleParameter("p_rca_ssub_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_ssub_cd;
            (param[10] = new OracleParameter("p_rca_ssub_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.rca_ssub_desc;
            (param[11] = new OracleParameter("p_rca_ssub_ord", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.rca_ssub_ord;
            (param[12] = new OracleParameter("p_rca_acc_no", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_no;
            (param[13] = new OracleParameter("p_rca_acc_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_desc;
            (param[14] = new OracleParameter("p_rca_acc_rmk", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_rmk;
            (param[15] = new OracleParameter("p_rca_acc_fmu", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_fmu;
            (param[16] = new OracleParameter("p_rca_cre_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_cre_by;
            (param[17] = new OracleParameter("p_rca_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.rca_cre_dt;
            (param[18] = new OracleParameter("p_rca_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_mod_by;
            (param[19] = new OracleParameter("p_rca_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.rca_mod_dt;
            (param[20] = new OracleParameter("p_rca_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_session;
            (param[21] = new OracleParameter("p_rca_anal1", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal1;
            (param[22] = new OracleParameter("p_rca_anal2", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal2;
            (param[23] = new OracleParameter("p_rca_anal3", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal3;
            (param[24] = new OracleParameter("p_rca_anal4", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal4;
            (param[25] = new OracleParameter("p_rca_anal5", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal5;
            (param[26] = new OracleParameter("p_rca_anal6", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal6;
            (param[27] = new OracleParameter("p_rca_anal7", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal7;
            (param[28] = new OracleParameter("p_rca_anal8", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal8;
            (param[29] = new OracleParameter("p_rca_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.rca_act;
            (param[30] = new OracleParameter("p_rca_grp_acc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_grp_acc;
            param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_CREATE_CHTACCOUNT", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 SaveChartAccountGRPDetails(ref_cht_acc _acc)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[32];
            (param[0] = new OracleParameter("p_rcg_com", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_com;
            (param[1] = new OracleParameter("p_rcg_sbu", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_sbu;
            (param[2] = new OracleParameter("p_rcg_mgrp_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_mgrp_cd;
            (param[3] = new OracleParameter("p_rcg_hed_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_hed_cd;
            (param[4] = new OracleParameter("p_rcg_hed_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_hed_desc;
            (param[5] = new OracleParameter("p_rcg_hed_ord", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_hed_ord;
            (param[6] = new OracleParameter("p_rcg_sgrp_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_sgrp_cd;
            (param[7] = new OracleParameter("p_rcg_sgrp_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_sgrp_desc;
            (param[8] = new OracleParameter("p_rcg_sgrp_ord", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.rca_sgrp_ord;
            (param[9] = new OracleParameter("p_rcg_ssub_cd", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_ssub_cd;
            (param[10] = new OracleParameter("p_rcg_ssub_desc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.rca_ssub_desc;
            (param[11] = new OracleParameter("p_rcg_ssub_ord", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.rca_ssub_ord;
            (param[12] = new OracleParameter("p_rcg_acc_no", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_no;
            (param[13] = new OracleParameter("p_rcg_acc_desc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_desc;
            (param[14] = new OracleParameter("p_rcg_acc_rmk", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_rmk;
            (param[15] = new OracleParameter("p_rcg_acc_fmu", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_acc_fmu;
            (param[16] = new OracleParameter("p_rcg_cre_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_cre_by;
            (param[17] = new OracleParameter("p_rcg_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.rca_cre_dt;
            (param[18] = new OracleParameter("p_rcg_mod_by", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_mod_by;
            (param[19] = new OracleParameter("p_rcg_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.rca_mod_dt;
            (param[20] = new OracleParameter("p_rcg_session", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_session;
            (param[21] = new OracleParameter("p_rcg_anal1", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal1;
            (param[22] = new OracleParameter("p_rcg_anal2", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal2;
            (param[23] = new OracleParameter("p_rcg_anal3", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal3;
            (param[24] = new OracleParameter("p_rcg_anal4", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal4;
            (param[25] = new OracleParameter("p_rcg_anal5", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal5;
            (param[26] = new OracleParameter("p_rcg_anal6", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal6;
            (param[27] = new OracleParameter("p_rcg_anal7", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal7;
            (param[28] = new OracleParameter("p_rcg_anal8", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_anal8;
            (param[29] = new OracleParameter("p_rcg_act", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _acc.rca_act;
            (param[30] = new OracleParameter("p_rcg_grp_acc", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.rca_grp_acc;
            param[31] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_CREATE_CHTACCOUNTGRP", CommandType.StoredProcedure, param);
            return effects;
        }
        public List<ref_cht_accgrp> GetAccGroup(string Code)
        {
            List<ref_cht_accgrp> _grp = new List<ref_cht_accgrp>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _gr = QueryDataTable("tblPb", "sp_getaccgroup", CommandType.StoredProcedure, false, param);
            if (_gr.Rows.Count > 0)
            {
                _grp = DataTableExtensions.ToGenericList<ref_cht_accgrp>(_gr, ref_cht_accgrp.Converter);
            }
            return _grp;
        }
        public List<ref_cht_acc> GetAcc(string Code)
        {
            List<ref_cht_acc> _grp = new List<ref_cht_acc>();
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _gr = QueryDataTable("tblPb", "sp_getacc", CommandType.StoredProcedure, false, param);
            if (_gr.Rows.Count > 0)
            {
                _grp = DataTableExtensions.ToGenericList<ref_cht_acc>(_gr, ref_cht_acc.Converter);
            }
            return _grp;
        }
        public DataTable GetAccHeading()
        {
            OracleParameter[] param = new OracleParameter[1];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tblPb", "sp_getacched", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        // add by Hushani 08/06/2018
        public DataTable GetHeroIntColors(string _type, string _cat1, string _cat2, string _brand)
        {
           // _type = "INT";

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[1] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[2] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[3] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("tb1", "SP_GET_ITEM_COLOR_BRAND", CommandType.StoredProcedure, false, param);
        }
        //subodana 2018-06-14
        public bool IsCollectFinalize(string com, string pc, DateTime month)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_MONTH", OracleDbType.Date, null, ParameterDirection.Input)).Value = month.Date;
            (param[2] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pc;
            param[3] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dtResults;
            _dtResults = QueryDataTable("tbl", "SP_ISCOLLFINALYZE", CommandType.StoredProcedure, false, param);
            bool correct = false;
            if (_dtResults != null && _dtResults.Rows.Count > 0)
            {
                correct = true;
            }
            return correct;
        }
        public DataTable GetAccHeadingDetails(string code)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tbl = QueryDataTable("tblPb", "sp_getaccheddet", CommandType.StoredProcedure, false, param);
            return _tbl;
        }

        public List<ref_acc_sgrp> GetAccMainTypeDet(string _company, string mtype, string Subtp)
        {
            List<ref_acc_sgrp> _acc = new List<ref_acc_sgrp>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_mtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = mtype;
            (param[2] = new OracleParameter("p_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Subtp;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getaccmaintypedet", CommandType.StoredProcedure, false, param);
            if (_tblPriceBook.Rows.Count > 0)
            {
                _acc = DataTableExtensions.ToGenericList<ref_acc_sgrp>(_tblPriceBook, ref_acc_sgrp.Converter);
            }
            return _acc;
        }
        public DataTable GetSubTypesDetails(string _company, string subgrp, string tsub)
        {
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _company;
            (param[1] = new OracleParameter("p_subgrp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = subgrp;
            (param[2] = new OracleParameter("p_subtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tsub;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _tblPriceBook = QueryDataTable("tblPb", "sp_getaccsubtypeDetails", CommandType.StoredProcedure, false, param);
            return _tblPriceBook;
        }
        //Dulaj 2018/May/31
        public DataTable getCostingSheetParms(string _blno)
        {

            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            //  (param[2] = new OracleParameter("in_costtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costtype;
            //sp_get_costsheet_sum
            DataTable _result = QueryDataTable("tbl", "sp_get_costsheet_params", CommandType.StoredProcedure, false, param);
            return _result;
        }
        //Dulaj 2018/Jun/21
        public DataTable getCostingParms(string _blno)
        {

            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _blno;
            //  (param[2] = new OracleParameter("in_costtype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _costtype;
            //sp_get_costsheet_sum
            DataTable _result = QueryDataTable("tbl", "sp_get_cost_params", CommandType.StoredProcedure, false, param);
            return _result;
        }

        //Tharindu 2018/06/19
        public DataTable GetSales_with_InvoiceBalance_new(DateTime _fromDate, DateTime _toDate, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode, string _pc, string _loc, string _isasatdate, string _user, string _channel, string _itmstatus, Int32 withcost, Int32 withserial, Int32 withdiscount, Int32 status, string isasatdate, string pricebook, string pblevel)
        {
            OracleParameter[] param = new OracleParameter[24];
            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[3] = new OracleParameter("cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[4] = new OracleParameter("cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[5] = new OracleParameter("cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[6] = new OracleParameter("cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[7] = new OracleParameter("brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[10] = new OracleParameter("pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[11] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            (param[12] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _isasatdate;
            (param[13] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[14] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _channel;
            (param[15] = new OracleParameter("p_item_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmstatus;
            (param[16] = new OracleParameter("p_with_cost", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withcost;
            (param[17] = new OracleParameter("p_with_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withserial;
            (param[18] = new OracleParameter("p_with_discount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withdiscount;
            (param[19] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[20] = new OracleParameter("p_is_as_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isasatdate;
            (param[21] = new OracleParameter("p_price_book", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pricebook;
            (param[22] = new OracleParameter("p_price_level", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = pblevel;
            param[23] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            return QueryDataTable("tbl", "sp_sales_cur_inv_bal_new", CommandType.StoredProcedure, false, param);

        }

        //Tharindu 2018-07-03
        public DataTable GetSalesWithInv_Bal_loc_wise(DateTime _fromDate, DateTime _toDate, string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode, string _pc, string _loc, string _isasatdate, string _user, string loclist, string _itmstatus, Int32 withcost, Int32 withserial, Int32 withdiscount, Int32 status, string isasatdate)
        {
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[22];
            (param[0] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[1] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[2] = new OracleParameter("cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[3] = new OracleParameter("cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[4] = new OracleParameter("cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[5] = new OracleParameter("cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[6] = new OracleParameter("cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[7] = new OracleParameter("brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[8] = new OracleParameter("model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[9] = new OracleParameter("itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
            (param[10] = new OracleParameter("pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[11] = new OracleParameter("com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            (param[12] = new OracleParameter("asatdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _isasatdate;
            (param[13] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[14] = new OracleParameter("p_channel", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loclist;
            (param[15] = new OracleParameter("p_item_status", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmstatus;
            (param[16] = new OracleParameter("p_with_cost", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withcost;
            (param[17] = new OracleParameter("p_with_serial", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withserial;
            (param[18] = new OracleParameter("p_with_discount", OracleDbType.Int32, null, ParameterDirection.Input)).Value = withdiscount;
            (param[19] = new OracleParameter("p_status", OracleDbType.Int32, null, ParameterDirection.Input)).Value = status;
            (param[20] = new OracleParameter("p_is_as_date", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = isasatdate;

            param[21] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);


            tbldata = QueryDataTable("tbl", "sp_sales_inv_bal_abstract", CommandType.StoredProcedure, false, param);

            return tbldata;
        }
        public DataTable GetQuerystringdata(string query)
        {
            DataTable _dtResultsN = new DataTable();

            OracleParameter[] param1 = new OracleParameter[2];
            param1[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param1[1] = new OracleParameter("p_query", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = query;
            _dtResultsN = QueryDataTable("tbl", "SP_GET_COSTANALYSTDATA", CommandType.StoredProcedure, false, param1);

            return _dtResultsN;
        }

        public DataTable DelTmpbyid(string user)
        {
            DataTable _dtResultsN = new DataTable();

            OracleParameter[] param1 = new OracleParameter[2];
            param1[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param1[1] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;

            _dtResultsN = QueryDataTable("tbl", "sp_del_tmp_by_id", CommandType.StoredProcedure, false, param1);

            return _dtResultsN;

        }


        //subodana
        public Boolean IsCosting(string SINO)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SINO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SINO;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tbl", "SP_CHK_ISCOSTING", CommandType.StoredProcedure, false, param);
            bool iscst = false;
            if (_dt != null && _dt.Rows.Count > 0)
            {
                iscst = true;
            }
            return iscst;
        }
        //subodana
        public string GetCreditNoteNo(string InvNo)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_INVNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = InvNo;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tbl", "SP_GETSRTNREVCN", CommandType.StoredProcedure, false, param);
            string crno = "";
            if (_dt != null && _dt.Rows.Count > 0)
            {
                crno = _dt.Rows[0][0].ToString();
            }
            return crno;
        }
        //subodana
        public DateTime GetCreditNoteInvDate(string SRNNO)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SRNNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = SRNNO;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tbl", "SP_GETCREDIT_INVDT", CommandType.StoredProcedure, false, param);
            DateTime crnodt = DateTime.Now;
            if (_dt != null && _dt.Rows.Count > 0)
            {
                crnodt = Convert.ToDateTime(_dt.Rows[0][0].ToString());
            }
            return crnodt;
        }

        //Tharindu

        public DataTable GetLocationCount(string _pcom, string _pid)
        {
            DataTable _dtResultsN = new DataTable();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pcom;
            (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pid;
            param[2] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);

            _dtResultsN = QueryDataTable("tbl", "sp_get_loc_count", CommandType.StoredProcedure, false, param);

            return _dtResultsN;
        }

        public List<REF_OBJ_TEMPITMFRM> getSavedItemTemplateVal(string module, string code, string company, string savedVal)
        {
            try
            {
                List<REF_OBJ_TEMPITMFRM> lst = new List<REF_OBJ_TEMPITMFRM>();
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = module;
                (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
                (param[2] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[3] = new OracleParameter("p_savedVal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = savedVal;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblPriceBook = QueryDataTable("tblPb", "SP_GET_SAVEDTEMPITEMDET", CommandType.StoredProcedure, false, param);
                if (_tblPriceBook.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<REF_OBJ_TEMPITMFRM>(_tblPriceBook, REF_OBJ_TEMPITMFRM.ConverterVal);
                }
                return lst;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //tHARINDU 2018-07-23
        public DataTable GetBnkdetails(string _com, string _loc, string _chkref, string _accno)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("chkref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chkref;
            (param[3] = new OracleParameter("in_acc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tbl", "sp_get_bnkdetails", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }
        public List<TABLE_HED> getTemplateTableColum(string company, string code)
        {
            try
            {
                List<TABLE_HED> lst = new List<TABLE_HED>();
                DataTable _dtResults = new DataTable();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_unqval", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                //Query Data base.         
                _dtResults = QueryDataTable("tbl", "SP_GET_TEMPLTTBLCOLUMN", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<TABLE_HED>(_dtResults, TABLE_HED.Converter);
                }
                return lst;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<REF_TMPLT_ITM_VALUE_TABLE> getItemSavedValues(string module, string code, string company, string savedVal)
        {
            try
            {
                List<REF_TMPLT_ITM_VALUE_TABLE> lst = new List<REF_TMPLT_ITM_VALUE_TABLE>();
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = module;
                (param[1] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
                (param[2] = new OracleParameter("p_company", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[3] = new OracleParameter("p_savedVal", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = savedVal;
                param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tblPriceBook = QueryDataTable("tblPb", "SP_GET_SAVEDTEMPLATEVALUES", CommandType.StoredProcedure, false, param);
                if (_tblPriceBook.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<REF_TMPLT_ITM_VALUE_TABLE>(_tblPriceBook, REF_TMPLT_ITM_VALUE_TABLE.Converter);
                }
                return lst;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //tHARINDU 2018-07-23
        public DataTable getcurrfinecharges(string com, string p_pc, DateTime _date)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_pc;
            (param[2] = new OracleParameter("p_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tbl", "sp_get_curr_fine_chg", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        public string getFieldType(int hedid, int detid)
        {
            try
            {
                string output = "";
                DataTable _dtResults = new DataTable();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_hedid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hedid;
                (param[1] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = detid;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                //Query Data base.         
                _dtResults = QueryDataTable("tbl", "SP_GET_TEMPLATEFIELDTYPE", CommandType.StoredProcedure, false, param);
                if (_dtResults.Rows.Count > 0)
                {
                    if (_dtResults.Rows[0]["RO_TYPE"] != DBNull.Value)
                    {
                        output = _dtResults.Rows[0]["RO_TYPE"].ToString();
                    }
                }
                return output;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int savePeymentRequestHdr(MST_PAY_REQ_HDR hdr)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[17];
                (param[0] = new OracleParameter("p_mprh_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_REQ_NO;
                (param[1] = new OracleParameter("p_mprh_req_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.MPRH_REQ_DT;
                (param[2] = new OracleParameter("p_mprh_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_PAY_TP;
                (param[3] = new OracleParameter("p_mprh_creditor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_CREDITOR;
                (param[4] = new OracleParameter("p_mprh_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_RMK;
                (param[5] = new OracleParameter("p_mprh_gros_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPRH_GROS_AMT;
                (param[6] = new OracleParameter("p_mprh_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPRH_TAX;
                (param[7] = new OracleParameter("p_mprh_net_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPRH_NET_AMT;
                (param[8] = new OracleParameter("p_mprh_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_STUS;
                (param[9] = new OracleParameter("p_mprh_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_CRE_BY;
                (param[10] = new OracleParameter("p_mprh_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.MPRH_CRE_DT;
                (param[11] = new OracleParameter("p_mprh_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hdr.MPRH_SEQ;
                (param[12] = new OracleParameter("p_mprh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_COM;
                (param[13] = new OracleParameter("p_mprh_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_SESSION_ID;
                (param[14] = new OracleParameter("p_mprh_req_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_REQ_TP;
                (param[15] = new OracleParameter("p_mprh_ref_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_REF_NO;
                param[16] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_PAYREQHDR", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int savePeymentRequestDtl(MST_PAY_REQ_DET dt)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("p_mprd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dt.MPRD_SEQ;
                (param[1] = new OracleParameter("p_mprd_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dt.MPRD_REQ_NO;
                (param[2] = new OracleParameter("p_mprd_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dt.MPRD_ACC_NO;
                (param[3] = new OracleParameter("p_mprd_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = dt.MPRD_AMT;
                (param[4] = new OracleParameter("p_mprd_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = dt.MPRD_ITM_LINE;
                (param[5] = new OracleParameter("p_mprd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = dt.MPRD_CRE_BY;
                (param[6] = new OracleParameter("p_mprd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = dt.MPRD_CRE_DT;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_PAYREQDTL", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int savePeymentRequestTempDet(REF_TMPLT_ITM_VALUE_TABLE tempitm, Int32 seq, Int32 stus, string unqval, string creby, DateTime credt, string _documentNo)
        {
            try
            {

                OracleParameter[] param = new OracleParameter[13];
                (param[0] = new OracleParameter("p_rtiv_hed_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tempitm.RTIV_HED_ID;
                (param[1] = new OracleParameter("p_rtiv_det_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tempitm.RTIV_DET_ID;
                (param[2] = new OracleParameter("p_rtiv_unq_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = unqval;
                (param[3] = new OracleParameter("p_rtiv_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tempitm.RTIV_COM;
                (param[4] = new OracleParameter("p_rtiv_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = stus;
                (param[5] = new OracleParameter("p_rtiv_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[6] = new OracleParameter("p_rtiv_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creby;
                (param[7] = new OracleParameter("p_rtiv_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = credt;
                (param[8] = new OracleParameter("p_rtiv_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tempitm.RTIV_VALUE;
                (param[9] = new OracleParameter("p_rtiv_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tempitm.RTIV_MODULE;
                (param[10] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentNo;
                (param[11] = new OracleParameter("p_rtiv_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tempitm.RTIV_DIRECT;
                param[12] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_TEMPDYNVALUE", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public MST_PAY_REQ_HDR getPaymentreqHdr(string reqno, string com, string reqtp)
        {
            try
            {
                MST_PAY_REQ_HDR lst = new MST_PAY_REQ_HDR();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[2] = new OracleParameter("p_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqtp;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _tbl = QueryDataTable("tblPb", "SP_GET_SAVEPAYMTREQHDR", CommandType.StoredProcedure, false, param);
                if (_tbl.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<MST_PAY_REQ_HDR>(_tbl, MST_PAY_REQ_HDR.Converter)[0];
                }
                return lst;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<MST_PAY_REQ_DET> getPayReqdetails(string com, string type, string reqno)
        {
            try
            {
                List<MST_PAY_REQ_DET> lst = new List<MST_PAY_REQ_DET>();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[1] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
                (param[2] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

                DataTable _tbl = QueryDataTable("tblPb", "SP_GET_SAVEPAYMTREQDET", CommandType.StoredProcedure, false, param);
                if (_tbl.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<MST_PAY_REQ_DET>(_tbl, MST_PAY_REQ_DET.ConverterSum);
                }
                return lst;

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //Dilshan 16/07/2018
        public DataTable getHPBMSalesDetails(DateTime _FromDate, DateTime _ToDate, string _invdate, string _com, string _pc, string _user, string _cols, int _foc, int _intercom, string hpinttype, int _inthpsales, int _intcrecardsale, int _servicecharge, int _arrsAmt, int _collPeriod, int _term, DateTime _FromDateOne, DateTime _ToDateOne, DateTime _FromDateTwo, DateTime _ToDateTwo, int _Revert, int _Close, DateTime _FromDateThree, DateTime _ToDateThree, int _Revrel)
        {
            OracleParameter[] param = new OracleParameter[26];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDate;
            (param[2] = new OracleParameter("in_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDate;
            (param[3] = new OracleParameter("in_byinvdt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invdate;
            (param[4] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[5] = new OracleParameter("in_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[6] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[7] = new OracleParameter("in_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cols;
            (param[8] = new OracleParameter("in_foc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _foc;
            (param[9] = new OracleParameter("in_intercom", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intercom;
            (param[10] = new OracleParameter("in_hpinttype", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hpinttype;
            (param[11] = new OracleParameter("in_inthpsales", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _inthpsales;
            (param[12] = new OracleParameter("in_intcrecardsale", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _intcrecardsale;
            (param[13] = new OracleParameter("in_servicecharge", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _servicecharge;
            (param[14] = new OracleParameter("in_arrsAmt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _arrsAmt;
            (param[15] = new OracleParameter("in_collPeriod", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _collPeriod;
            (param[16] = new OracleParameter("in_term", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _term;
            (param[17] = new OracleParameter("in_fdateRev", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDateOne;
            (param[18] = new OracleParameter("in_tdateRev", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDateOne;
            (param[19] = new OracleParameter("in_fdateClo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDateTwo;
            (param[20] = new OracleParameter("in_tdateClo", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDateTwo;
            (param[21] = new OracleParameter("in_revert", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Revert;
            (param[22] = new OracleParameter("in_close", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Close;
            (param[23] = new OracleParameter("in_fdateRel", OracleDbType.Date, null, ParameterDirection.Input)).Value = _FromDateThree;
            (param[24] = new OracleParameter("in_tdateRel", OracleDbType.Date, null, ParameterDirection.Input)).Value = _ToDateThree;
            (param[25] = new OracleParameter("in_revrl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _Revrel;

            return QueryDataTable("int_hdr", "SP_GET_SALES_REP_HPBMI", CommandType.StoredProcedure, false, param);
        }

        public DataTable RankAccountTransfferingReport(DateTime fromdate, DateTime todate, string loc, string com)
        {
            DataTable _dtResults = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
            (param[2] = new OracleParameter("p_fromdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = fromdate;
            (param[3] = new OracleParameter("p_todate", OracleDbType.Date, null, ParameterDirection.Input)).Value = todate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            //Query Data base.         
            _dtResults = QueryDataTable("tbl", "sp_RankAccTransdet", CommandType.StoredProcedure, false, param);

            return _dtResults;
        }

        //Sanjeewa 21-08-2018
        public DataTable getHPBMReportHeading(string _report)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_report", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _report;

            return QueryDataTable("int_hdr", "sp_get_hpbm_report_heading", CommandType.StoredProcedure, false, param);
        }

        //Sanjeewa 21-08-2018
        public DataTable getBMHPDetails(int _Year, int _Month, string _user, string _cols)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("in_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Year;
            (param[2] = new OracleParameter("in_month", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _Month;
            (param[3] = new OracleParameter("in_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("in_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cols;

            return QueryDataTable("int_hdr", "sp_get_hp_rep_bmi", CommandType.StoredProcedure, false, param);
        }
        //add by tharanga 2018/08/24
        public DataTable _chk_vreg_available(string _com, string _pc, string _invno, string _sal_tp, string _itm, string _engine, string _chasi)
        {
            OracleParameter[] param = new OracleParameter[8];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[2] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[3] = new OracleParameter("p_invno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _invno;
            (param[4] = new OracleParameter("p_sal_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _sal_tp;
            (param[5] = new OracleParameter("p_itm", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itm;
            (param[6] = new OracleParameter("p_engine", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _engine;
            (param[7] = new OracleParameter("p_chasi", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _chasi;

            return QueryDataTable("int_hdr", "sp_chk_vreg_available", CommandType.StoredProcedure, false, param);
        }
        //subodana 2018-08-29
        public Int32 UpdateHPRAccRemks(hpt_arr_acc _acc)
        {
            Int32 effects = 0;
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("P_HAA_ACC_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_REFUND;
            (param[1] = new OracleParameter("P_HAA_ACC_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_REFUREMK;
            (param[2] = new OracleParameter("P_HAA_ACC_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_DEDUC;
            (param[3] = new OracleParameter("P_HAA_ACC_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_ACC_DEPT_DEDUCRMK;
            (param[4] = new OracleParameter("P_HAA_INV_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_REFUND;
            (param[5] = new OracleParameter("P_HAA_INV_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_REFUREMK;
            (param[6] = new OracleParameter("P_HAA_INV_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_DEDUC;
            (param[7] = new OracleParameter("P_HAA_INV_DEPT_DEDUCRMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_INV_DEPT_DEDUCRMK;
            (param[8] = new OracleParameter("P_HAA_CRED_DEPT_REFUND", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_REFUND;
            (param[9] = new OracleParameter("P_HAA_CRED_DEPT_REFUREMK", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_REFUREMK;
            (param[10] = new OracleParameter("P_HAA_CRED_DEPT_DEDUC", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_DEDUC;
            (param[11] = new OracleParameter("P_HAA_CRED_DEPT_DEDUCRMK", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = _acc.HAA_CRED_DEPT_DEDUCRMK;
            (param[12] = new OracleParameter("P_HAA_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _acc.Haa_date;
            (param[13] = new OracleParameter("P_HAA_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _acc.Haa_pc;
            param[14] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            effects = (Int16)UpdateRecords("SP_UPDATE_ACCREMKS", CommandType.StoredProcedure, param);
            return effects;
        }
        public Int32 Update_cred_recon_hdr_status(string _com, DateTime _date, string _accno, string _status)
        {

            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_bsth_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_bsth_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("p_bsth_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[3] = new OracleParameter("p_bsth_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _status;

            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_gnt_crd_stmnt_hdr_status", CommandType.StoredProcedure, param);

            return result;
        }
        public int Update_cred_recon_remark(string _com, string _pc, DateTime _date, string _accno, string _adjtp, string _ref, string remark, Int32 _seq)
        {

            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[3] = new OracleParameter("p_accno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _accno;
            (param[4] = new OracleParameter("p_adjtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _adjtp;
            (param[5] = new OracleParameter("p_ref", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ref;
            (param[6] = new OracleParameter("p_remark", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remark;
            (param[7] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[8] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_cred_adj_remark", CommandType.StoredProcedure, param);

            return result;
        }

        public string GetShowRoomChnl(string Com, String Pc, String Code, DateTime Date)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("P_PC", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pc;
            (param[2] = new OracleParameter("P_CODE", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Code;
            (param[3] = new OracleParameter("P_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date;
            param[4] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tbl", "SP_GET_CHANALNAMES", CommandType.StoredProcedure, false, param);
            string name = "";
            if (_dt != null && _dt.Rows.Count > 0)
            {
                name = _dt.Rows[0][0].ToString();
            }

            return name;
        }
        public int updateTempFiledDefNumber(int detid, bool value, string user)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = detid;
                (param[1] = new OracleParameter("p_value", OracleDbType.Int32, null, ParameterDirection.Input)).Value = (value) ? 1 : 0;
                (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_DEFAULTNUMFLD", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updateTempFiledSrch(int objid, string value, string userId)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[4];
                Int32 effects = 0;
                (param[0] = new OracleParameter("p_detid", OracleDbType.Int32, null, ParameterDirection.Input)).Value = objid;
                (param[1] = new OracleParameter("p_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = value;
                (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                param[3] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                effects = (Int16)UpdateRecords("SP_UPDATE_FLSSEARCHVAL", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updatePayreqHdr(MST_PAY_REQ_HDR hdr)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[11];
                (param[0] = new OracleParameter("p_mprh_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_REQ_NO;
                (param[1] = new OracleParameter("p_mprh_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_RMK;
                (param[2] = new OracleParameter("p_mprh_gros_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPRH_GROS_AMT;
                (param[3] = new OracleParameter("p_mprh_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPRH_TAX;
                (param[4] = new OracleParameter("p_mprh_net_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPRH_NET_AMT;
                (param[5] = new OracleParameter("p_mprh_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_MOD_BY;
                (param[6] = new OracleParameter("p_mprh_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.MPRH_MOD_DT;
                (param[7] = new OracleParameter("p_mprh_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_COM;
                (param[8] = new OracleParameter("p_mprh_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_SESSION_ID;
                (param[9] = new OracleParameter("p_mprh_req_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPRH_REQ_TP;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_EXISTSPAYREQHDR", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updatePayreqDtl(MST_PAY_REQ_DET acc)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[11];
                (param[0] = new OracleParameter("p_mprd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = acc.MPRD_SEQ;
                (param[1] = new OracleParameter("p_mprd_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc.MPRD_REQ_NO;
                (param[2] = new OracleParameter("p_mprd_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc.MPRD_ACC_NO;
                (param[3] = new OracleParameter("p_mprd_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = acc.MPRD_AMT;
                (param[4] = new OracleParameter("p_updated", OracleDbType.Int32, null, ParameterDirection.Input)).Value = acc.UPDATED;
                (param[5] = new OracleParameter("p_newadded", OracleDbType.Int32, null, ParameterDirection.Input)).Value = acc.NEW_ADDED;
                (param[6] = new OracleParameter("p_mprd_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = acc.MPRD_MOD_BY;
                (param[7] = new OracleParameter("p_mprd_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = acc.MPRD_MOD_DT;
                (param[8] = new OracleParameter("p_mprd_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = acc.MPRD_ITM_LINE;
                (param[9] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = acc.MPRD_STUS;
                param[10] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_EXISTSPAYREQDTL", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public SAR_PAY_TP getAccountPayTpDet(string code, string company)
        {
            try
            {
                SAR_PAY_TP lst = new SAR_PAY_TP();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _tbl = QueryDataTable("tblPb", "SP_GET_ACCPAYTYPE", CommandType.StoredProcedure, false, param);
                if (_tbl.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<SAR_PAY_TP>(_tbl, SAR_PAY_TP.Converter)[0];
                }
                return lst;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public REF_CHT_ACC getAccountDetail(string code, string company)
        {
            try
            {
                REF_CHT_ACC lst = new REF_CHT_ACC();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_code", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = code;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _tbl = QueryDataTable("tblPb", "SP_GET_ACCACCOUNTDET", CommandType.StoredProcedure, false, param);
                if (_tbl.Rows.Count > 0)
                {
                    lst = DataTableExtensions.ToGenericList<REF_CHT_ACC>(_tbl, REF_CHT_ACC.Converter)[0];
                }
                return lst;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int updatePeymentRequestTempDet(REF_TMPLT_ITM_VALUE_TABLE tempitm, Int32 seq, Int32 stus, string unqval, string creby, DateTime credt, Int32 updated, Int32 newAdded, string _documentNo, Int32 direct)
        {
            try
            {

                OracleParameter[] param = new OracleParameter[15];
                (param[0] = new OracleParameter("p_rtiv_hed_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tempitm.RTIV_HED_ID;
                (param[1] = new OracleParameter("p_rtiv_det_id", OracleDbType.Int32, null, ParameterDirection.Input)).Value = tempitm.RTIV_DET_ID;
                (param[2] = new OracleParameter("p_rtiv_unq_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = unqval;
                (param[3] = new OracleParameter("p_rtiv_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tempitm.RTIV_COM;
                (param[4] = new OracleParameter("p_rtiv_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = stus;
                (param[5] = new OracleParameter("p_rtiv_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[6] = new OracleParameter("p_rtiv_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creby;
                (param[7] = new OracleParameter("p_rtiv_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = credt;
                (param[8] = new OracleParameter("p_rtiv_value", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tempitm.RTIV_VALUE;
                (param[9] = new OracleParameter("p_rtiv_module", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = tempitm.RTIV_MODULE;
                (param[10] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentNo;
                (param[11] = new OracleParameter("p_updated", OracleDbType.Int32, null, ParameterDirection.Input)).Value = updated;
                (param[12] = new OracleParameter("p_newAdded", OracleDbType.Int32, null, ParameterDirection.Input)).Value = newAdded;
                (param[13] = new OracleParameter("p_rtiv_direct", OracleDbType.Int32, null, ParameterDirection.Input)).Value = direct;
                param[14] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_UPDYTEMPDYNVALUE", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //subodana 2018/09/14
        public int SaveEliteCommTargets(ref_eli_comm_targ targets)
        {
            OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("P_RECT_COM", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_com;
            (param[1] = new OracleParameter("P_RECT_PC", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_pc;
            (param[2] = new OracleParameter("P_RECT_TP", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_tp;
            (param[3] = new OracleParameter("P_RECT_MONTH", OracleDbType.Int32, null, ParameterDirection.Input)).Value = targets.rect_month;
            (param[4] = new OracleParameter("P_RECT_TARGET", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_target;
            (param[5] = new OracleParameter("P_RECT_FRM_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_frm_per;
            (param[6] = new OracleParameter("P_RECT_TO_PER", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_to_per;
            (param[7] = new OracleParameter("P_RECT_MNG_COMM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_mng_comm;
            (param[8] = new OracleParameter("P_RECT_EXC_COMM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_exc_comm;
            (param[9] = new OracleParameter("P_RECT_CASHI_COMM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_cashi_comm;
            (param[10] = new OracleParameter("P_RECT_HELP_COMM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rect_help_comm;
            (param[11] = new OracleParameter("P_RECT_ANAL1", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_anal1;
            (param[12] = new OracleParameter("P_RECT_ANAL2", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_anal2;
            (param[13] = new OracleParameter("P_RECT_ANAL3", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_anal3;
            (param[14] = new OracleParameter("P_RECT_CRE_BY", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rect_cre_by;
            (param[15] = new OracleParameter("P_RECT_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = targets.rect_cre_dt;
            (param[16] = new OracleParameter("P_RECT_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = targets.rect_seq;
            param[17] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_ELITE_COMM_TRGT", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2018/09/14
        public int SaveEliteAdditnal(ref_comm_add_trgt targets)
        {
            OracleParameter[] param = new OracleParameter[9];
            (param[0] = new OracleParameter("P_RCAT_PC", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rcat_pc;
            (param[1] = new OracleParameter("P_RCAT_SLAB", OracleDbType.Int32, null, ParameterDirection.Input)).Value = targets.rcat_slab;
            (param[2] = new OracleParameter("P_RCAT_FROM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcat_from;
            (param[3] = new OracleParameter("P_RCAT_TO", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcat_to;
            (param[4] = new OracleParameter("P_RCAT_COMM", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcat_comm;
            (param[5] = new OracleParameter("P_RCAT_TYPE", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = targets.rcat_type;
            (param[6] = new OracleParameter("P_RCAT_GAPVAL", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = targets.rcat_gapval;
            (param[7] = new OracleParameter("P_RCAT_SEQ", OracleDbType.Int64, null, ParameterDirection.Input)).Value = targets.rcat_seq;
            param[8] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_SAVE_ELITE_ADDI_COMM", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2018/09/14
        public int DeleteEliteCommissionTarget(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_ELITE_COMM_TARGET", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2018/09/14
        public int DeleteEliteCommissionAdditional(int seq)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("SP_REMOVE_ELITE_COMM_ADDI", CommandType.StoredProcedure, param);
            return result;
        }
        //subodana 2018/09/14
        public List<ref_eli_comm_targ> GetEliteCommTargets(Int64 seq)
        {
            List<ref_eli_comm_targ> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_ELITE_COMM_TRGT", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_eli_comm_targ>(dtTemp, ref_eli_comm_targ.Converter);
            }
            return oResult;
        }
        //subodana 2018/09/14
        public List<ref_comm_add_trgt> GetEliteCommAdditional(Int64 seq)
        {
            List<ref_comm_add_trgt> oResult = null;
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("P_SEQ", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = seq;
            param[1] = new OracleParameter("O_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "SP_GET_ELITE_ADD_COMM", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ref_comm_add_trgt>(dtTemp, ref_comm_add_trgt.Converter);
            }
            return oResult;
        }

        //Wimal 28/08/2018 Abstract Sales Stock Bal report
        public DataTable Get_ABT_sales_W_StkBal(string _com, string _loc, DateTime _fromDate, DateTime _toDate, DateTime _asatDate
            , string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _model, string _brand, string _itmcode, string _itmStatus,
            string _userID, bool _isWhbal)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[9] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcode;
            (param[13] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStatus;
            (param[14] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            (param[15] = new OracleParameter("P_isWhbal", OracleDbType.Boolean, null, ParameterDirection.Input)).Value = _isWhbal;
            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_ABT_salesWithStockBal", CommandType.StoredProcedure, false, param);
            return tbldata;
        }

        public int getTepmplateUsedCount(int hedid)
        {
            try
            {
                Int32 cnt = 0;
                OracleParameter[] param = new OracleParameter[2];
                (param[0] = new OracleParameter("p_hedid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hedid;
                param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable dtTemp = QueryDataTable("dea", "SP_GET_TEMPLATEUSEDCOUNT", CommandType.StoredProcedure, false, param);
                if (dtTemp.Rows.Count > 0 && dtTemp.Rows[0]["CNT"] != DBNull.Value)
                {
                    cnt = Convert.ToInt32(dtTemp.Rows[0]["CNT"].ToString());
                }
                return cnt;

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int approvePaymentRequet(string ReqNo, string company, string userId, string stus, string remark, string sessionid)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("p_ReqNo", OracleDbType.Varchar2, null, ParameterDirection.Input)).Value = ReqNo;
                (param[1] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[2] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                (param[3] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
                (param[4] = new OracleParameter("p_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remark;
                (param[5] = new OracleParameter("p_sesid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = sessionid;
                param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_UPDATE_PAYREQAPPROVESTUS", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int savePaymentHdr(MST_PAY_HDR hdr)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[20];
                (param[0] = new OracleParameter("p_mph_pay_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_PAY_NO;
                (param[1] = new OracleParameter("p_mph_req_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.MPH_PAY_DT;
                (param[2] = new OracleParameter("p_mph_pay_tp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_PAY_TP;
                (param[3] = new OracleParameter("p_mph_creditor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_CREDITOR;
                (param[4] = new OracleParameter("p_mph_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_RMK;
                (param[5] = new OracleParameter("p_mph_gros_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPH_GROS_AMT;
                (param[6] = new OracleParameter("p_mph_tax", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPH_TAX;
                (param[7] = new OracleParameter("p_mph_net_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPH_NET_AMT;
                (param[8] = new OracleParameter("p_mph_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_STUS;
                (param[9] = new OracleParameter("p_mph_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_CRE_BY;
                (param[10] = new OracleParameter("p_mph_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = hdr.MPH_CRE_DT;
                (param[11] = new OracleParameter("p_mph_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = hdr.MPH_SEQ;
                (param[12] = new OracleParameter("p_mph_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_COM;
                (param[13] = new OracleParameter("p_oth_doc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_OTHDOC_NO;
                (param[14] = new OracleParameter("p_anal1", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPH_ANAL1;
                (param[15] = new OracleParameter("p_anal2", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = hdr.MPH_ANAL2;
                (param[16] = new OracleParameter("p_anal3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_ANAL3;
                (param[17] = new OracleParameter("p_anal4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_ANAL4;
                (param[18] = new OracleParameter("p_sessid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = hdr.MPH_SESSION_ID;
                param[19] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);

                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_PAYMENTHDR", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int savePaymentDtl(MST_PAY_REQ_DET im, string userId, Int32 seq, string _documentNo)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("p_mpd_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = seq;
                (param[1] = new OracleParameter("p_mpd_pay_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentNo;
                (param[2] = new OracleParameter("p_mpd_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = im.MPRD_ACC_NO;
                (param[3] = new OracleParameter("p_mpd_amt", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = im.MPRD_AMT;
                (param[4] = new OracleParameter("p_mpd_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                (param[5] = new OracleParameter("p_mpd_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
                (param[6] = new OracleParameter("p_mpd_itm_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = im.MPRD_ITM_LINE;
                param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_UPDPAYDETAILS", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int saveTempItemValue(string ReqNo, string userId, string _documentNo, string company)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[5];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = ReqNo;
                (param[1] = new OracleParameter("p_userid", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = userId;
                (param[2] = new OracleParameter("p_payno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentNo;
                (param[3] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 effects;
                effects = (Int16)UpdateRecords("SP_UPDATE_PAYMENTTEMPITM", CommandType.StoredProcedure, param);
                return effects;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Wimal 17/Sep/2018
        public DataTable Get_rejectAccBalance(string _com, string _loc, DateTime _asatDate, string _userID)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[3] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_getRejectAcc_Bal", CommandType.StoredProcedure, false, param);
            return tbldata;
        }
        //Dulaj 2018/Oct/05
        public DataTable GetAssemblyAmountProfitability(string com, string itemCd, string model, string cat01, string cat02)
        {
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("P_COM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_CURRNTDATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = DateTime.Now;
            (param[2] = new OracleParameter("P_ITEM", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itemCd;
            (param[3] = new OracleParameter("P_MODEL", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            (param[4] = new OracleParameter("P_CAT01", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat01;
            (param[5] = new OracleParameter("P_CAT02", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = cat02;
            param[6] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "SP_AssemblyCharges", CommandType.StoredProcedure, false, param);
            return tbldata;
        }
        public DataTable BLItm(string siNO)
        {
            OracleParameter[] param = new OracleParameter[2];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("p_siNo", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = siNO;

            return QueryDataTable("items", "SP_Get_Itm_Si", CommandType.StoredProcedure, false, param);
        }

        public DataTable get_InvRoll_Fwd(string _com, string _loc, DateTime _fromDate, DateTime _toDate, DateTime _asatDate
           , string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _model, string _brand, string _itmcode, string _itmStatus,
           string _userID, bool _isWhbal)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[9] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcode;
            (param[13] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStatus;
            (param[14] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            (param[15] = new OracleParameter("P_isWhbal", OracleDbType.Boolean, null, ParameterDirection.Input)).Value = _isWhbal;
            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_getInv_Roll_FWD", CommandType.StoredProcedure, false, param);
            return tbldata;
        }

        public DataTable get_Inv_WSelPrice(string _com, string _loc, DateTime _fromDate, DateTime _toDate, DateTime _asatDate
           , string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _model, string _brand, string _itmcode, string _itmStatus,
           string _userID, string _pb, string _pb_lvl)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[18];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[9] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcode;
            (param[13] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStatus;
            (param[14] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            (param[15] = new OracleParameter("p_pb", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb;
            (param[16] = new OracleParameter("p_pb_lvl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pb_lvl;
            param[17] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_getInv_price", CommandType.StoredProcedure, false, param);
            return tbldata;
        }

        //add  by tharanga 2018/10/22
        public List<ChequeReturn> Getreturn_cheq_cout_data(string _pc, DateTime rtndt, string _com, Int16 _datecount)
        {
            List<ChequeReturn> oResult = null;
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[1] = new OracleParameter("retrndt", OracleDbType.Date, null, ParameterDirection.Input)).Value = rtndt;//p_com
            (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;//p_com
            (param[3] = new OracleParameter("date_count", OracleDbType.Int16, null, ParameterDirection.Input)).Value = _datecount;//p_com
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable dtTemp = QueryDataTable("HDR", "sp_get_chq_datecount", CommandType.StoredProcedure, false, param);
            if (dtTemp.Rows.Count > 0)
            {
                oResult = DataTableExtensions.ToGenericList<ChequeReturn>(dtTemp, ChequeReturn.Converter);
            }
            return oResult;
        }
        public List<Ref_Bill_Collet> GetRef_Bill_Collet_dayend(string Com, string Pc, DateTime Date)
        {
            List<Ref_Bill_Collet> _Ref_Bill_Collet = new List<Ref_Bill_Collet>();
            OracleParameter[] param = new OracleParameter[4];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Com;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = Pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = Date.Date;
            param[3] = new OracleParameter("C_DATA", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tbl", "sp_get_ref_collect_dayend", CommandType.StoredProcedure, false, param);

            if (_dt.Rows.Count > 0)
            {
                _Ref_Bill_Collet = DataTableExtensions.ToGenericList<Ref_Bill_Collet>(_dt, Ref_Bill_Collet.Converter);
            }


            return _Ref_Bill_Collet;

        }
        public Int32 ref_bill_collect_conform(string _com, string _pc, DateTime _date, string _user, Int32 conf_stus, Int32 _seq)
        {

            OracleParameter[] param = new OracleParameter[7];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pcenter", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_date", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date.Date;
            (param[3] = new OracleParameter("p_user", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _user;
            (param[4] = new OracleParameter("p_conf_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = conf_stus;
            (param[5] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = _seq;
            param[6] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_ref_bill_collect_conform", CommandType.StoredProcedure, param);

            return result;
        }
        //Dulaj 2018/Oct/22
        public int UpdateBLItmRemarks(string blNo, string itmCd, Int32 lineNo, string remarks)
        {

            OracleParameter[] param = new OracleParameter[5];

            (param[0] = new OracleParameter("p_blno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blNo;
            (param[1] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itmCd;
            (param[2] = new OracleParameter("p_line", OracleDbType.Int32, null, ParameterDirection.Input)).Value = lineNo;
            (param[3] = new OracleParameter("p_remarks", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = remarks;
            param[4] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_updateblitmremark", CommandType.StoredProcedure, param);

            return result;

        }


        public DataTable get_voucherDetl(string _com, string _loc, DateTime _fromDate, DateTime _toDate, DateTime _asatDate
         , string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _model, string _brand, string _itmcode, string _itmStatus,
         string _userID, string _redeemType)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _asatDate.Date;
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[9] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcode;
            (param[13] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStatus;
            (param[14] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            (param[15] = new OracleParameter("p_redeemType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _redeemType;
            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_getvoucherDetl", CommandType.StoredProcedure, false, param);
            return tbldata;
        }

        //Wimal 31/10/2018
        public DataTable get_BinCardReport(string _com, string _loc, DateTime _fromDate, DateTime _toDate, DateTime _asatDate
          , string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _model, string _brand, string _itmcode, string _itmStatus,
          string _userID, string _reportType)
        {
            //DateTime _fromDate, DateTime _toDate, DateTime _asatDate,string _whLoc, string _user
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[17];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_asap_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date.AddDays(-1);
            (param[5] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[6] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[7] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[8] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[9] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[10] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[11] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[12] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcode;
            (param[13] = new OracleParameter("p_itmstatus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmStatus;
            (param[14] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            (param[15] = new OracleParameter("p_rpt_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _reportType;
            param[16] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_getbincard_dtl", CommandType.StoredProcedure, false, param);
            return tbldata;
        }

        public DataTable get_commissionComparison(string _com, string _pc, DateTime _fromDate, DateTime _toDate, DateTime _asatDate
   , string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _model, string _brand, string _itmcode, string _saleType,
   string _userID)
        {
            //Wimal @ 05/Nov/2018
            DataTable tbldata = new DataTable();
            OracleParameter[] param = new OracleParameter[15];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_cat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
            (param[5] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[6] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            (param[7] = new OracleParameter("p_cat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
            (param[8] = new OracleParameter("p_cat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
            (param[9] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
            (param[10] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
            (param[11] = new OracleParameter("p_itemcode", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itmcode;
            (param[12] = new OracleParameter("p_saleType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _saleType;
            (param[13] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            param[14] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            tbldata = QueryDataTable("tbl", "sp_getcommsion_comparison", CommandType.StoredProcedure, false, param);
            return tbldata;
        }

        //Wimal @ 26/Nov/2018 temp comment to publish on 12/Dec/2018
        public DataTable getExpireItem(string com, DateTime chkDt1, DateTime chkDt2, string loc,
                                        string _cat1, string _cat2, string _cat3, string _cat4, string _cat5, string _brand, string _model, string _itemcode)
        {
            try
            {
                //OpenEMS();
                DataTable _dtResultsItm = new DataTable("fintbl");
                OracleParameter[] param = new OracleParameter[13];

                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[1] = new OracleParameter("p_chkDt1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chkDt1.ToString("dd/MMM/yyyy");
                (param[2] = new OracleParameter("p_chkDt2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = chkDt2.ToString("dd/MMM/yyyy");
                (param[3] = new OracleParameter("p_chkDt2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = loc;
                (param[4] = new OracleParameter("p_itmcd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _itemcode;
                (param[5] = new OracleParameter("p_brand", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _brand;
                (param[6] = new OracleParameter("p_model", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _model;
                (param[7] = new OracleParameter("p_itemcat1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat1;
                (param[8] = new OracleParameter("p_itemcat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
                (param[9] = new OracleParameter("p_itemcat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
                (param[10] = new OracleParameter("p_itemcat4", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat4;
                (param[11] = new OracleParameter("p_itemcat5", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat5;
                param[12] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                _dtResultsItm = QueryDataTable("tbl", "SP_GET_EXPIRE_ITEMS", CommandType.StoredProcedure, false, param);
                // _dtResultsItm.Columns.Add("invdate3", typeof(int));
                //  int i = 0;
                //foreach (var data in _dtResultsItm.Rows)
                //{
                //    if (_dtResultsItm.Rows[i]["INB_EXP_DT"].ToString() == "")
                //    {
                //        _dtResultsItm.Rows[i]["invdate3"] = 0;
                //    }
                //    else
                //    {
                //        DateTime invdate = Convert.ToDateTime(_dtResultsItm.Rows[i]["INB_EXP_DT"].ToString());
                //        DateTime invdate2 = DateTime.Now;
                //        int invdate3 = invdate.Subtract(invdate2).Days;
                //        _dtResultsItm.Rows[i]["invdate3"] = invdate3.ToString();
                //    }

                //    i++;
                //}

                ///ConnectionCloseEMS();
                return _dtResultsItm;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<MST_PAY_REQ_HDR> getAllRequestDetails(string company, string stus, string type)
        {
            try
            {
                List<MST_PAY_REQ_HDR> dtl = new List<MST_PAY_REQ_HDR>();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("p_stus", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = stus;
                (param[2] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = type;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _dt = QueryDataTable("tbl", "SP_GET_ALLPAYMENTREQUEST", CommandType.StoredProcedure, false, param);

                if (_dt.Rows.Count > 0)
                {
                    dtl = DataTableExtensions.ToGenericList<MST_PAY_REQ_HDR>(_dt, MST_PAY_REQ_HDR.Converter);
                }
                return dtl;


            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Wimal 2018/11/28
        public DataTable get_DepositBank_Pc_wise(string p_com, string p_prof_cen)
        {
            List<Deposit_Bank_Pc_wise> _list = new List<Deposit_Bank_Pc_wise>();
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_com;
            (param[1] = new OracleParameter("p_prof_cen", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = p_prof_cen;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "SP_GET_PCWISE_BANK", CommandType.StoredProcedure, false, param);

            //if (_result.Rows.Count > 0)
            //{                
            //    _list = DataTableExtensions.ToGenericList<Deposit_Bank_Pc_wise>(_result, Deposit_Bank_Pc_wise.Converter1);
            //}
            return _result;
        }

        public Int32 save_log_sunupload(log_sunupload _log_sunupload)
        {

            OracleParameter[] param = new OracleParameter[8];

            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.loc;
            (param[2] = new OracleParameter("p_dt_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log_sunupload.dt_from;
            (param[3] = new OracleParameter("p_dt_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log_sunupload.dt_to;
            (param[4] = new OracleParameter("p_create_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.create_by;
            (param[5] = new OracleParameter("p_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.session_id;
            (param[6] = new OracleParameter("p_upload_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.upload_type;
            param[7] = new OracleParameter("o_effect", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_save_log_sunupload", CommandType.StoredProcedure, param);

            return result;

        }
        public List<log_sunupload> getlog_sunupload(log_sunupload _log_sunupload)
        {
            List<log_sunupload> dtl = new List<log_sunupload>();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.com;
            (param[1] = new OracleParameter("p_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.loc;
            (param[2] = new OracleParameter("p_dtfrom", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log_sunupload.dt_from;
            (param[3] = new OracleParameter("p_dtto", OracleDbType.Date, null, ParameterDirection.Input)).Value = _log_sunupload.dt_to;
            (param[4] = new OracleParameter("p_type", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _log_sunupload.upload_type;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            DataTable _dt = QueryDataTable("tbl", "sp_get_log_sunupload", CommandType.StoredProcedure, false, param);

            if (_dt.Rows.Count > 0)
            {
                dtl = DataTableExtensions.ToGenericList<log_sunupload>(_dt, log_sunupload.Converter);
            }
            return dtl;


        }
        public DataTable GetCusdecHDRDataShipment(string entryno)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("p_docno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entryno;
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);

            DataTable _result = QueryDataTable("tbl", "GetCusDecHDRDataShipment", CommandType.StoredProcedure, false, param);
            return _result;
        }
        public int UPDATE_CUS_DEC_HDR(string bondNo, string model, string clrBy, decimal cif, string rmk, string user, string entry, DateTime actulaDate, DateTime filereceidDate)
        {
            OracleParameter[] param = new OracleParameter[10];
            (param[0] = new OracleParameter("p_doc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = bondNo;
            (param[1] = new OracleParameter("p_cuh_main_modl", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = model;
            (param[2] = new OracleParameter("p_cuh_clr_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = clrBy;
            (param[3] = new OracleParameter("p_cuh_cif_val", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = cif;
            (param[4] = new OracleParameter("p_cuh_clr_rmk", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = rmk;
            (param[5] = new OracleParameter("p_cuh_clr_usr", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = user;
            (param[6] = new OracleParameter("p_entry", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = entry;
            (param[7] = new OracleParameter("p_actual", OracleDbType.Date, null, ParameterDirection.Input)).Value = actulaDate;
            (param[8] = new OracleParameter("p_fileRec", OracleDbType.Date, null, ParameterDirection.Input)).Value = filereceidDate;
            param[9] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
            Int32 result = UpdateRecords("sp_update_shipment_cusdec", CommandType.StoredProcedure, param);
            return result;
        }



        public int saveRequetTaxDetails(MST_ACC_TAX itm)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[20];
                (param[0] = new OracleParameter("p_mat_req_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_REQ_NO;
                (param[1] = new OracleParameter("p_mat_tax_amt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = itm.MAT_TAX_AMT;
                (param[2] = new OracleParameter("p_mat_tax_rt", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = itm.MAT_TAX_RT;
                (param[3] = new OracleParameter("p_mat_acc_no", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_ACC_NO;
                (param[4] = new OracleParameter("p_mat_anal1", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_ANAL1;
                (param[5] = new OracleParameter("p_mat_anal2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_ANAL2;
                (param[6] = new OracleParameter("p_mat_anal3", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = itm.MAT_ANAL3;
                (param[7] = new OracleParameter("p_mat_anal4", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = itm.MAT_ANAL4;
                (param[8] = new OracleParameter("p_mat_cre_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_CRE_BY;
                (param[9] = new OracleParameter("p_mat_cre_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = itm.MAT_MOD_DT;
                (param[10] = new OracleParameter("p_mat_mod_by", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_MOD_BY;
                (param[11] = new OracleParameter("p_mat_mod_dt", OracleDbType.Date, null, ParameterDirection.Input)).Value = itm.MAT_CRE_DT;
                (param[12] = new OracleParameter("p_mat_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_COM;
                (param[13] = new OracleParameter("p_mat_tax_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_TAX_CD;
                (param[14] = new OracleParameter("p_mat_session_id", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.MAT_SESSION_ID;
                (param[15] = new OracleParameter("p_updated", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itm.UPDATED;
                (param[16] = new OracleParameter("p_newaded", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itm.NEW_ADDED;
                (param[17] = new OracleParameter("p_stus", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itm.MAT_STUS;
                (param[18] = new OracleParameter("p_seq", OracleDbType.Int32, null, ParameterDirection.Input)).Value = itm.MAT_SEQ;

                param[19] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);


                Int32 result = UpdateRecords("SP_UPDATE_REQTAXDET", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public List<MST_ACC_TAX> getRequestTax(string com, string reqno)
        {
            try
            {
                List<MST_ACC_TAX> dtl = new List<MST_ACC_TAX>();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
                (param[1] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _result = QueryDataTable("tbl", "SP_GET_ITMTAXDETAILS", CommandType.StoredProcedure, false, param);
                if (_result.Rows.Count > 0)
                {
                    dtl = DataTableExtensions.ToGenericList<MST_ACC_TAX>(_result, MST_ACC_TAX.Converter);
                }
                return dtl;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }



        public List<MST_BUSENTITY_TAX> getCreditorTaxStructure(string creditor, string company)
        {
            try
            {
                List<MST_BUSENTITY_TAX> dtl = new List<MST_BUSENTITY_TAX>();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("p_creditor", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creditor;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _result = QueryDataTable("tbl", "SP_GET_CREDITORTAXDETAILS", CommandType.StoredProcedure, false, param);
                if (_result.Rows.Count > 0)
                {
                    dtl = DataTableExtensions.ToGenericList<MST_BUSENTITY_TAX>(_result, MST_BUSENTITY_TAX.Converter);
                }
                return dtl;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getPurCostAndTax(string purno, string company)
        {
            try
            {
                List<Deposit_Bank_Pc_wise> _list = new List<Deposit_Bank_Pc_wise>();
                OracleParameter[] param = new OracleParameter[3];
                (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                (param[1] = new OracleParameter("p_purno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = purno;
                param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _result = QueryDataTable("tbl", "SP_GET_PURCOSTANDTAX", CommandType.StoredProcedure, false, param);
                return _result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        //Wimal 13/Dec/2018
        public DataTable Get_RevertReconDetl(string _com, string _pc, DateTime _fromDate, DateTime _toDate, string _userID)
        {

            DataTable _dtResults = new DataTable();
            OracleParameter[] param = new OracleParameter[6];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_from", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromDate.Date;
            (param[3] = new OracleParameter("p_to", OracleDbType.Date, null, ParameterDirection.Input)).Value = _toDate.Date;
            (param[4] = new OracleParameter("p_userID", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _userID;
            param[5] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            _dtResults = QueryDataTable("tbl", "sp_getRevertRecon_dtl", CommandType.StoredProcedure, false, param);
            return _dtResults;
        }
        public List<MST_PAY_REQ_REF> getPayReqPoDet(string reqno, string company, string reqtp)
        {
            try
            {
                List<MST_PAY_REQ_REF> dtl = new List<MST_PAY_REQ_REF>();
                OracleParameter[] param = new OracleParameter[4];
                (param[0] = new OracleParameter("p_reqno", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqno;
                (param[1] = new OracleParameter("p_reqtp", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = reqtp;
                (param[2] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = company;
                param[3] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _result = QueryDataTable("tbl", "SP_GET_PAYREQPURDET", CommandType.StoredProcedure, false, param);
                if (_result.Rows.Count > 0)
                {
                    dtl = DataTableExtensions.ToGenericList<MST_PAY_REQ_REF>(_result, MST_PAY_REQ_REF.Converter);
                }
                return dtl;

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public int saveRequetPoDetails(PUR_SELECTED itm, string _documentNo, string creby, DateTime date)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[7];
                (param[0] = new OracleParameter("P_PRR_REQ_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _documentNo;
                (param[1] = new OracleParameter("P_PRR_REF_NO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = itm.PURNO;
                (param[2] = new OracleParameter("P_PRR_COST", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = itm.COST;
                (param[3] = new OracleParameter("P_PRR_TAX", OracleDbType.Decimal, null, ParameterDirection.Input)).Value = itm.TAX;
                (param[4] = new OracleParameter("P_PRR_CRE_BY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = creby;
                (param[5] = new OracleParameter("P_PRR_CRE_DT", OracleDbType.Date, null, ParameterDirection.Input)).Value = date;
                param[6] = new OracleParameter("O_EFFECT", OracleDbType.Int32, null, ParameterDirection.Output);
                Int32 result = UpdateRecords("SP_INSERT_REQPODETAILS", CommandType.StoredProcedure, param);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public DataTable getUserDefinedTargetDetails(int stmonth, Int32 endmonth, int year, string _SelCols, string _SelectValues, string group, string where)
        {
            try
            {
                OracleParameter[] param = new OracleParameter[8];
                (param[0] = new OracleParameter("p_stmonth", OracleDbType.Int32, null, ParameterDirection.Input)).Value = stmonth;
                (param[1] = new OracleParameter("p_endmonth", OracleDbType.Int32, null, ParameterDirection.Input)).Value = endmonth;
                (param[2] = new OracleParameter("p_year", OracleDbType.Int32, null, ParameterDirection.Input)).Value = year;
                (param[3] = new OracleParameter("p_cols", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SelCols;
                (param[4] = new OracleParameter("p_values", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _SelectValues;
                (param[5] = new OracleParameter("p_group", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = group;
                (param[6] = new OracleParameter("p_where", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = where;
                param[7] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
                DataTable _result = QueryDataTable("tbl", "SP_GET_USRDEFINETARGETDATA", CommandType.StoredProcedure, false, param);
                return _result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        //dulaj 2019-01-02
        public DataTable GetCusdechdrByBond(string com, string blno)
        {
            OracleParameter[] param = new OracleParameter[3];
            (param[0] = new OracleParameter("P_COMPANY", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = com;
            (param[1] = new OracleParameter("P_BLNO", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = blno;
            param[2] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("boireq", "SP_GET_CUSTDEC_HDR_BY_BOND", CommandType.StoredProcedure, false, param);
        }

        // Hushani 2019-01-31
        public DataTable GetAutoShowroomForEMS(string _com, string _ope_cd, string _cat2, string _cat3)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_ope_cd", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _ope_cd;
            (param[2] = new OracleParameter("p_cat2", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat2;
            (param[3] = new OracleParameter("p_cat3", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _cat3;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("EMS", "SP_GET_AUTO_SHOWROOM_FOR_EMS", CommandType.StoredProcedure, false, param);
        }
        public DataTable BonusCalculation_process(DateTime _date)
        {
            OracleParameter[] param = new OracleParameter[2];
            (param[0] = new OracleParameter("in_ToDate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
         
            param[1] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("EMS", "sp_BonusCalculation_process", CommandType.StoredProcedure, false, param);
        }
                
        public DataTable updateLastnoSeq(DateTime _date,string _type, string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_AS_AT_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("DocType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            return QueryDataTable("EMS", "sp_audit_lastno_seq", CommandType.StoredProcedure, false, param);
        }

        public DataTable updateLastnoSeqpages(DateTime _date, string _type, string _com, string _loc)
        {
            OracleParameter[] param = new OracleParameter[5];
            param[0] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            (param[1] = new OracleParameter("IN_AS_AT_DATE", OracleDbType.Date, null, ParameterDirection.Input)).Value = _date;
            (param[2] = new OracleParameter("DocType", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _type;
            (param[3] = new OracleParameter("in_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[4] = new OracleParameter("in_loc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _loc;

            return QueryDataTable("EMS", "sp_audit_lastno_seq_pages", CommandType.StoredProcedure, false, param);
        }
        public DataTable getSalesRegistor(string _com, string _pc, DateTime _fromtDate, DateTime _totDate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromtDate;
            (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _totDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("EMS", "SP_GET_SALES_REGISTOR", CommandType.StoredProcedure, false, param);
        }
        public DataTable getExciseSchedules(string _com, string _pc, DateTime _fromtDate, DateTime _totDate)
        {
            OracleParameter[] param = new OracleParameter[5];
            (param[0] = new OracleParameter("p_com", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _com;
            (param[1] = new OracleParameter("p_pc", OracleDbType.NVarchar2, null, ParameterDirection.Input)).Value = _pc;
            (param[2] = new OracleParameter("p_fdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _fromtDate;
            (param[3] = new OracleParameter("p_tdate", OracleDbType.Date, null, ParameterDirection.Input)).Value = _totDate;
            param[4] = new OracleParameter("c_data", OracleDbType.RefCursor, null, ParameterDirection.Output);
            return QueryDataTable("EMS", "SP_GET_EXCISE_SCHEDULES", CommandType.StoredProcedure, false, param);
        }
    }
}


